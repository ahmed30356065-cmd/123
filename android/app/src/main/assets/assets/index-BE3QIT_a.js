(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function gD(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var wy={exports:{}},Jh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hS;function pD(){if(hS)return Jh;hS=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var d in a)d!=="key"&&(l[d]=a[d])}else l=a;return a=l.ref,{$$typeof:s,type:n,key:c,ref:a!==void 0?a:null,props:l}}return Jh.Fragment=e,Jh.jsx=t,Jh.jsxs=t,Jh}var fS;function xD(){return fS||(fS=1,wy.exports=pD()),wy.exports}var r=xD(),vy={exports:{}},ht={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mS;function bD(){if(mS)return ht;mS=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),w=Symbol.iterator;function v(L){return L===null||typeof L!="object"?null:(L=w&&L[w]||L["@@iterator"],typeof L=="function"?L:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,N={};function P(L,G,ee){this.props=L,this.context=G,this.refs=N,this.updater=ee||T}P.prototype.isReactComponent={},P.prototype.setState=function(L,G){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,G,"setState")},P.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function U(){}U.prototype=P.prototype;function V(L,G,ee){this.props=L,this.context=G,this.refs=N,this.updater=ee||T}var q=V.prototype=new U;q.constructor=V,I(q,P.prototype),q.isPureReactComponent=!0;var W=Array.isArray;function z(){}var k={H:null,A:null,T:null,S:null},M=Object.prototype.hasOwnProperty;function B(L,G,ee){var ne=ee.ref;return{$$typeof:s,type:L,key:G,ref:ne!==void 0?ne:null,props:ee}}function D(L,G){return B(L.type,G,L.props)}function S(L){return typeof L=="object"&&L!==null&&L.$$typeof===s}function F(L){var G={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(ee){return G[ee]})}var E=/\/+/g;function Y(L,G){return typeof L=="object"&&L!==null&&L.key!=null?F(""+L.key):G.toString(36)}function X(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(z,z):(L.status="pending",L.then(function(G){L.status==="pending"&&(L.status="fulfilled",L.value=G)},function(G){L.status==="pending"&&(L.status="rejected",L.reason=G)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function R(L,G,ee,ne,je){var se=typeof L;(se==="undefined"||se==="boolean")&&(L=null);var _e=!1;if(L===null)_e=!0;else switch(se){case"bigint":case"string":case"number":_e=!0;break;case"object":switch(L.$$typeof){case s:case e:_e=!0;break;case x:return _e=L._init,R(_e(L._payload),G,ee,ne,je)}}if(_e)return je=je(L),_e=ne===""?"."+Y(L,0):ne,W(je)?(ee="",_e!=null&&(ee=_e.replace(E,"$&/")+"/"),R(je,G,ee,"",function(ye){return ye})):je!=null&&(S(je)&&(je=D(je,ee+(je.key==null||L&&L.key===je.key?"":(""+je.key).replace(E,"$&/")+"/")+_e)),G.push(je)),1;_e=0;var Te=ne===""?".":ne+":";if(W(L))for(var be=0;be<L.length;be++)ne=L[be],se=Te+Y(ne,be),_e+=R(ne,G,ee,se,je);else if(be=v(L),typeof be=="function")for(L=be.call(L),be=0;!(ne=L.next()).done;)ne=ne.value,se=Te+Y(ne,be++),_e+=R(ne,G,ee,se,je);else if(se==="object"){if(typeof L.then=="function")return R(X(L),G,ee,ne,je);throw G=String(L),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return _e}function J(L,G,ee){if(L==null)return L;var ne=[],je=0;return R(L,ne,"","",function(se){return G.call(ee,se,je++)}),ne}function O(L){if(L._status===-1){var G=L._result;G=G(),G.then(function(ee){(L._status===0||L._status===-1)&&(L._status=1,L._result=ee)},function(ee){(L._status===0||L._status===-1)&&(L._status=2,L._result=ee)}),L._status===-1&&(L._status=0,L._result=G)}if(L._status===1)return L._result.default;throw L._result}var K=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},Q={map:J,forEach:function(L,G,ee){J(L,function(){G.apply(this,arguments)},ee)},count:function(L){var G=0;return J(L,function(){G++}),G},toArray:function(L){return J(L,function(G){return G})||[]},only:function(L){if(!S(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return ht.Activity=y,ht.Children=Q,ht.Component=P,ht.Fragment=t,ht.Profiler=a,ht.PureComponent=V,ht.StrictMode=n,ht.Suspense=f,ht.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,ht.__COMPILER_RUNTIME={__proto__:null,c:function(L){return k.H.useMemoCache(L)}},ht.cache=function(L){return function(){return L.apply(null,arguments)}},ht.cacheSignal=function(){return null},ht.cloneElement=function(L,G,ee){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var ne=I({},L.props),je=L.key;if(G!=null)for(se in G.key!==void 0&&(je=""+G.key),G)!M.call(G,se)||se==="key"||se==="__self"||se==="__source"||se==="ref"&&G.ref===void 0||(ne[se]=G[se]);var se=arguments.length-2;if(se===1)ne.children=ee;else if(1<se){for(var _e=Array(se),Te=0;Te<se;Te++)_e[Te]=arguments[Te+2];ne.children=_e}return B(L.type,je,ne)},ht.createContext=function(L){return L={$$typeof:c,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:l,_context:L},L},ht.createElement=function(L,G,ee){var ne,je={},se=null;if(G!=null)for(ne in G.key!==void 0&&(se=""+G.key),G)M.call(G,ne)&&ne!=="key"&&ne!=="__self"&&ne!=="__source"&&(je[ne]=G[ne]);var _e=arguments.length-2;if(_e===1)je.children=ee;else if(1<_e){for(var Te=Array(_e),be=0;be<_e;be++)Te[be]=arguments[be+2];je.children=Te}if(L&&L.defaultProps)for(ne in _e=L.defaultProps,_e)je[ne]===void 0&&(je[ne]=_e[ne]);return B(L,se,je)},ht.createRef=function(){return{current:null}},ht.forwardRef=function(L){return{$$typeof:d,render:L}},ht.isValidElement=S,ht.lazy=function(L){return{$$typeof:x,_payload:{_status:-1,_result:L},_init:O}},ht.memo=function(L,G){return{$$typeof:m,type:L,compare:G===void 0?null:G}},ht.startTransition=function(L){var G=k.T,ee={};k.T=ee;try{var ne=L(),je=k.S;je!==null&&je(ee,ne),typeof ne=="object"&&ne!==null&&typeof ne.then=="function"&&ne.then(z,K)}catch(se){K(se)}finally{G!==null&&ee.types!==null&&(G.types=ee.types),k.T=G}},ht.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},ht.use=function(L){return k.H.use(L)},ht.useActionState=function(L,G,ee){return k.H.useActionState(L,G,ee)},ht.useCallback=function(L,G){return k.H.useCallback(L,G)},ht.useContext=function(L){return k.H.useContext(L)},ht.useDebugValue=function(){},ht.useDeferredValue=function(L,G){return k.H.useDeferredValue(L,G)},ht.useEffect=function(L,G){return k.H.useEffect(L,G)},ht.useEffectEvent=function(L){return k.H.useEffectEvent(L)},ht.useId=function(){return k.H.useId()},ht.useImperativeHandle=function(L,G,ee){return k.H.useImperativeHandle(L,G,ee)},ht.useInsertionEffect=function(L,G){return k.H.useInsertionEffect(L,G)},ht.useLayoutEffect=function(L,G){return k.H.useLayoutEffect(L,G)},ht.useMemo=function(L,G){return k.H.useMemo(L,G)},ht.useOptimistic=function(L,G){return k.H.useOptimistic(L,G)},ht.useReducer=function(L,G,ee){return k.H.useReducer(L,G,ee)},ht.useRef=function(L){return k.H.useRef(L)},ht.useState=function(L){return k.H.useState(L)},ht.useSyncExternalStore=function(L,G,ee){return k.H.useSyncExternalStore(L,G,ee)},ht.useTransition=function(){return k.H.useTransition()},ht.version="19.2.3",ht}var gS;function Tv(){return gS||(gS=1,vy.exports=bD()),vy.exports}var j=Tv();const Ar=gD(j);var _y={exports:{}},Xh={},jy={exports:{}},Ny={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pS;function yD(){return pS||(pS=1,(function(s){function e(R,J){var O=R.length;R.push(J);e:for(;0<O;){var K=O-1>>>1,Q=R[K];if(0<a(Q,J))R[K]=J,R[O]=Q,O=K;else break e}}function t(R){return R.length===0?null:R[0]}function n(R){if(R.length===0)return null;var J=R[0],O=R.pop();if(O!==J){R[0]=O;e:for(var K=0,Q=R.length,L=Q>>>1;K<L;){var G=2*(K+1)-1,ee=R[G],ne=G+1,je=R[ne];if(0>a(ee,O))ne<Q&&0>a(je,ee)?(R[K]=je,R[ne]=O,K=ne):(R[K]=ee,R[G]=O,K=G);else if(ne<Q&&0>a(je,O))R[K]=je,R[ne]=O,K=ne;else break e}}return J}function a(R,J){var O=R.sortIndex-J.sortIndex;return O!==0?O:R.id-J.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;s.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();s.unstable_now=function(){return c.now()-d}}var f=[],m=[],x=1,y=null,w=3,v=!1,T=!1,I=!1,N=!1,P=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;function q(R){for(var J=t(m);J!==null;){if(J.callback===null)n(m);else if(J.startTime<=R)n(m),J.sortIndex=J.expirationTime,e(f,J);else break;J=t(m)}}function W(R){if(I=!1,q(R),!T)if(t(f)!==null)T=!0,z||(z=!0,F());else{var J=t(m);J!==null&&X(W,J.startTime-R)}}var z=!1,k=-1,M=5,B=-1;function D(){return N?!0:!(s.unstable_now()-B<M)}function S(){if(N=!1,z){var R=s.unstable_now();B=R;var J=!0;try{e:{T=!1,I&&(I=!1,U(k),k=-1),v=!0;var O=w;try{t:{for(q(R),y=t(f);y!==null&&!(y.expirationTime>R&&D());){var K=y.callback;if(typeof K=="function"){y.callback=null,w=y.priorityLevel;var Q=K(y.expirationTime<=R);if(R=s.unstable_now(),typeof Q=="function"){y.callback=Q,q(R),J=!0;break t}y===t(f)&&n(f),q(R)}else n(f);y=t(f)}if(y!==null)J=!0;else{var L=t(m);L!==null&&X(W,L.startTime-R),J=!1}}break e}finally{y=null,w=O,v=!1}J=void 0}}finally{J?F():z=!1}}}var F;if(typeof V=="function")F=function(){V(S)};else if(typeof MessageChannel<"u"){var E=new MessageChannel,Y=E.port2;E.port1.onmessage=S,F=function(){Y.postMessage(null)}}else F=function(){P(S,0)};function X(R,J){k=P(function(){R(s.unstable_now())},J)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(R){R.callback=null},s.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<R?Math.floor(1e3/R):5},s.unstable_getCurrentPriorityLevel=function(){return w},s.unstable_next=function(R){switch(w){case 1:case 2:case 3:var J=3;break;default:J=w}var O=w;w=J;try{return R()}finally{w=O}},s.unstable_requestPaint=function(){N=!0},s.unstable_runWithPriority=function(R,J){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var O=w;w=R;try{return J()}finally{w=O}},s.unstable_scheduleCallback=function(R,J,O){var K=s.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?K+O:K):O=K,R){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=O+Q,R={id:x++,callback:J,priorityLevel:R,startTime:O,expirationTime:Q,sortIndex:-1},O>K?(R.sortIndex=O,e(m,R),t(f)===null&&R===t(m)&&(I?(U(k),k=-1):I=!0,X(W,O-K))):(R.sortIndex=Q,e(f,R),T||v||(T=!0,z||(z=!0,F()))),R},s.unstable_shouldYield=D,s.unstable_wrapCallback=function(R){var J=w;return function(){var O=w;w=J;try{return R.apply(this,arguments)}finally{w=O}}}})(Ny)),Ny}var xS;function wD(){return xS||(xS=1,jy.exports=yD()),jy.exports}var Sy={exports:{}},In={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bS;function vD(){if(bS)return In;bS=1;var s=Tv();function e(f){var m="https://react.dev/errors/"+f;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)m+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+f+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(f,m,x){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:y==null?null:""+y,children:f,containerInfo:m,implementation:x}}var c=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,m){if(f==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return In.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,In.createPortal=function(f,m){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(f,m,null,x)},In.flushSync=function(f){var m=c.T,x=n.p;try{if(c.T=null,n.p=2,f)return f()}finally{c.T=m,n.p=x,n.d.f()}},In.preconnect=function(f,m){typeof f=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,n.d.C(f,m))},In.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},In.preinit=function(f,m){if(typeof f=="string"&&m&&typeof m.as=="string"){var x=m.as,y=d(x,m.crossOrigin),w=typeof m.integrity=="string"?m.integrity:void 0,v=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;x==="style"?n.d.S(f,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:y,integrity:w,fetchPriority:v}):x==="script"&&n.d.X(f,{crossOrigin:y,integrity:w,fetchPriority:v,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},In.preinitModule=function(f,m){if(typeof f=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var x=d(m.as,m.crossOrigin);n.d.M(f,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&n.d.M(f)},In.preload=function(f,m){if(typeof f=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var x=m.as,y=d(x,m.crossOrigin);n.d.L(f,x,{crossOrigin:y,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},In.preloadModule=function(f,m){if(typeof f=="string")if(m){var x=d(m.as,m.crossOrigin);n.d.m(f,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else n.d.m(f)},In.requestFormReset=function(f){n.d.r(f)},In.unstable_batchedUpdates=function(f,m){return f(m)},In.useFormState=function(f,m,x){return c.H.useFormState(f,m,x)},In.useFormStatus=function(){return c.H.useHostTransitionStatus()},In.version="19.2.3",In}var yS;function M5(){if(yS)return Sy.exports;yS=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Sy.exports=vD(),Sy.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wS;function _D(){if(wS)return Xh;wS=1;var s=wD(),e=Tv(),t=M5();function n(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function l(i){var o=i,u=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(u=o.return),i=o.return;while(i)}return o.tag===3?u:null}function c(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function d(i){if(i.tag===31){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function f(i){if(l(i)!==i)throw Error(n(188))}function m(i){var o=i.alternate;if(!o){if(o=l(i),o===null)throw Error(n(188));return o!==i?null:i}for(var u=i,h=o;;){var p=u.return;if(p===null)break;var b=p.alternate;if(b===null){if(h=p.return,h!==null){u=h;continue}break}if(p.child===b.child){for(b=p.child;b;){if(b===u)return f(p),i;if(b===h)return f(p),o;b=b.sibling}throw Error(n(188))}if(u.return!==h.return)u=p,h=b;else{for(var A=!1,$=p.child;$;){if($===u){A=!0,u=p,h=b;break}if($===h){A=!0,h=p,u=b;break}$=$.sibling}if(!A){for($=b.child;$;){if($===u){A=!0,u=b,h=p;break}if($===h){A=!0,h=b,u=p;break}$=$.sibling}if(!A)throw Error(n(189))}}if(u.alternate!==h)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?i:o}function x(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=x(i),o!==null)return o;i=i.sibling}return null}var y=Object.assign,w=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),V=Symbol.for("react.context"),q=Symbol.for("react.forward_ref"),W=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),D=Symbol.for("react.memo_cache_sentinel"),S=Symbol.iterator;function F(i){return i===null||typeof i!="object"?null:(i=S&&i[S]||i["@@iterator"],typeof i=="function"?i:null)}var E=Symbol.for("react.client.reference");function Y(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===E?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case I:return"Fragment";case P:return"Profiler";case N:return"StrictMode";case W:return"Suspense";case z:return"SuspenseList";case B:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case T:return"Portal";case V:return i.displayName||"Context";case U:return(i._context.displayName||"Context")+".Consumer";case q:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case k:return o=i.displayName||null,o!==null?o:Y(i.type)||"Memo";case M:o=i._payload,i=i._init;try{return Y(i(o))}catch{}}return null}var X=Array.isArray,R=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,O={pending:!1,data:null,method:null,action:null},K=[],Q=-1;function L(i){return{current:i}}function G(i){0>Q||(i.current=K[Q],K[Q]=null,Q--)}function ee(i,o){Q++,K[Q]=i.current,i.current=o}var ne=L(null),je=L(null),se=L(null),_e=L(null);function Te(i,o){switch(ee(se,o),ee(je,i),ee(ne,null),o.nodeType){case 9:case 11:i=(i=o.documentElement)&&(i=i.namespaceURI)?P2(i):0;break;default:if(i=o.tagName,o=o.namespaceURI)o=P2(o),i=M2(o,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}G(ne),ee(ne,i)}function be(){G(ne),G(je),G(se)}function ye(i){i.memoizedState!==null&&ee(_e,i);var o=ne.current,u=M2(o,i.type);o!==u&&(ee(je,i),ee(ne,u))}function et(i){je.current===i&&(G(ne),G(je)),_e.current===i&&(G(_e),Wh._currentValue=O)}var Je,bt;function yt(i){if(Je===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);Je=o&&o[1]||"",bt=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Je+i+bt}var Ae=!1;function fe(i,o){if(!i||Ae)return"";Ae=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(o){var Ee=function(){throw Error()};if(Object.defineProperty(Ee.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ee,[])}catch(xe){var de=xe}Reflect.construct(i,[],Ee)}else{try{Ee.call()}catch(xe){de=xe}i.call(Ee.prototype)}}else{try{throw Error()}catch(xe){de=xe}(Ee=i())&&typeof Ee.catch=="function"&&Ee.catch(function(){})}}catch(xe){if(xe&&de&&typeof xe.stack=="string")return[xe.stack,de.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=h.DetermineComponentFrameRoot(),A=b[0],$=b[1];if(A&&$){var Z=A.split(`
`),le=$.split(`
`);for(p=h=0;h<Z.length&&!Z[h].includes("DetermineComponentFrameRoot");)h++;for(;p<le.length&&!le[p].includes("DetermineComponentFrameRoot");)p++;if(h===Z.length||p===le.length)for(h=Z.length-1,p=le.length-1;1<=h&&0<=p&&Z[h]!==le[p];)p--;for(;1<=h&&0<=p;h--,p--)if(Z[h]!==le[p]){if(h!==1||p!==1)do if(h--,p--,0>p||Z[h]!==le[p]){var ve=`
`+Z[h].replace(" at new "," at ");return i.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",i.displayName)),ve}while(1<=h&&0<=p);break}}}finally{Ae=!1,Error.prepareStackTrace=u}return(u=i?i.displayName||i.name:"")?yt(u):""}function $e(i,o){switch(i.tag){case 26:case 27:case 5:return yt(i.type);case 16:return yt("Lazy");case 13:return i.child!==o&&o!==null?yt("Suspense Fallback"):yt("Suspense");case 19:return yt("SuspenseList");case 0:case 15:return fe(i.type,!1);case 11:return fe(i.type.render,!1);case 1:return fe(i.type,!0);case 31:return yt("Activity");default:return""}}function ce(i){try{var o="",u=null;do o+=$e(i,u),u=i,i=i.return;while(i);return o}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var Oe=Object.prototype.hasOwnProperty,Pe=s.unstable_scheduleCallback,Ge=s.unstable_cancelCallback,Ke=s.unstable_shouldYield,Ie=s.unstable_requestPaint,Le=s.unstable_now,Lt=s.unstable_getCurrentPriorityLevel,bs=s.unstable_ImmediatePriority,Zt=s.unstable_UserBlockingPriority,Ws=s.unstable_NormalPriority,Ds=s.unstable_LowPriority,En=s.unstable_IdlePriority,hr=s.log,we=s.unstable_setDisableYieldValue,pe=null,Re=null;function he(i){if(typeof hr=="function"&&we(i),Re&&typeof Re.setStrictMode=="function")try{Re.setStrictMode(pe,i)}catch{}}var Me=Math.clz32?Math.clz32:Se,ze=Math.log,tt=Math.LN2;function Se(i){return i>>>=0,i===0?32:31-(ze(i)/tt|0)|0}var Fe=256,it=262144,at=4194304;function Gt(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Ks(i,o,u){var h=i.pendingLanes;if(h===0)return 0;var p=0,b=i.suspendedLanes,A=i.pingedLanes;i=i.warmLanes;var $=h&134217727;return $!==0?(h=$&~b,h!==0?p=Gt(h):(A&=$,A!==0?p=Gt(A):u||(u=$&~i,u!==0&&(p=Gt(u))))):($=h&~b,$!==0?p=Gt($):A!==0?p=Gt(A):u||(u=h&~i,u!==0&&(p=Gt(u)))),p===0?0:o!==0&&o!==p&&(o&b)===0&&(b=p&-p,u=o&-o,b>=u||b===32&&(u&4194048)!==0)?o:p}function Mn(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function $c(i,o){switch(i){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gl(){var i=at;return at<<=1,(at&62914560)===0&&(at=4194304),i}function fr(i){for(var o=[],u=0;31>u;u++)o.push(i);return o}function Ln(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function pl(i,o,u,h,p,b){var A=i.pendingLanes;i.pendingLanes=u,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=u,i.entangledLanes&=u,i.errorRecoveryDisabledLanes&=u,i.shellSuspendCounter=0;var $=i.entanglements,Z=i.expirationTimes,le=i.hiddenUpdates;for(u=A&~u;0<u;){var ve=31-Me(u),Ee=1<<ve;$[ve]=0,Z[ve]=-1;var de=le[ve];if(de!==null)for(le[ve]=null,ve=0;ve<de.length;ve++){var xe=de[ve];xe!==null&&(xe.lane&=-536870913)}u&=~Ee}h!==0&&ja(i,h,0),b!==0&&p===0&&i.tag!==0&&(i.suspendedLanes|=b&~(A&~o))}function ja(i,o,u){i.pendingLanes|=o,i.suspendedLanes&=~o;var h=31-Me(o);i.entangledLanes|=o,i.entanglements[h]=i.entanglements[h]|1073741824|u&261930}function Na(i,o){var u=i.entangledLanes|=o;for(i=i.entanglements;u;){var h=31-Me(u),p=1<<h;p&o|i[h]&o&&(i[h]|=o),u&=~p}}function Zd(i,o){var u=o&-o;return u=(u&42)!==0?1:xl(u),(u&(i.suspendedLanes|o))!==0?0:u}function xl(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function li(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function qm(){var i=J.p;return i!==0?i:(i=window.event,i===void 0?32:aS(i.type))}function ea(i,o){var u=J.p;try{return J.p=i,o()}finally{J.p=u}}var ta=Math.random().toString(36).slice(2),Os="__reactFiber$"+ta,en="__reactProps$"+ta,Sa="__reactContainer$"+ta,Bc="__reactEvents$"+ta,Tx="__reactListeners$"+ta,Hm="__reactHandles$"+ta,Gm="__reactResources$"+ta,Ta="__reactMarker$"+ta;function zc(i){delete i[Os],delete i[en],delete i[Bc],delete i[Tx],delete i[Hm]}function Ea(i){var o=i[Os];if(o)return o;for(var u=i.parentNode;u;){if(o=u[Sa]||u[Os]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(i=z2(i);i!==null;){if(u=i[Os])return u;i=z2(i)}return o}i=u,u=i.parentNode}return null}function Pr(i){if(i=i[Os]||i[Sa]){var o=i.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return i}return null}function mr(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(n(33))}function Ia(i){var o=i[Gm];return o||(o=i[Gm]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Ps(i){i[Ta]=!0}var eh=new Set,th={};function Aa(i,o){ka(i,o),ka(i+"Capture",o)}function ka(i,o){for(th[i]=o,i=0;i<o.length;i++)eh.add(o[i])}var sh=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),nh={},rh={};function Wm(i){return Oe.call(rh,i)?!0:Oe.call(nh,i)?!1:sh.test(i)?rh[i]=!0:(nh[i]=!0,!1)}function qc(i,o,u){if(Wm(o))if(u===null)i.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var h=o.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+u)}}function gr(i,o,u){if(u===null)i.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+u)}}function Ms(i,o,u,h){if(h===null)i.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttributeNS(o,u,""+h)}}function tn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function eo(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function ah(i,o,u){var h=Object.getOwnPropertyDescriptor(i.constructor.prototype,o);if(!i.hasOwnProperty(o)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var p=h.get,b=h.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return p.call(this)},set:function(A){u=""+A,b.call(this,A)}}),Object.defineProperty(i,o,{enumerable:h.enumerable}),{getValue:function(){return u},setValue:function(A){u=""+A},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Vt(i){if(!i._valueTracker){var o=eo(i)?"checked":"value";i._valueTracker=ah(i,o,""+i[o])}}function bl(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var u=o.getValue(),h="";return i&&(h=eo(i)?i.checked?"true":"false":i.value),i=h,i!==u?(o.setValue(i),!0):!1}function Ca(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var yl=/[\n"\\]/g;function Yn(i){return i.replace(yl,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Hc(i,o,u,h,p,b,A,$){i.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?i.type=A:i.removeAttribute("type"),o!=null?A==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+tn(o)):i.value!==""+tn(o)&&(i.value=""+tn(o)):A!=="submit"&&A!=="reset"||i.removeAttribute("value"),o!=null?ih(i,A,tn(o)):u!=null?ih(i,A,tn(u)):h!=null&&i.removeAttribute("value"),p==null&&b!=null&&(i.defaultChecked=!!b),p!=null&&(i.checked=p&&typeof p!="function"&&typeof p!="symbol"),$!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"?i.name=""+tn($):i.removeAttribute("name")}function Km(i,o,u,h,p,b,A,$){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(i.type=b),o!=null||u!=null){if(!(b!=="submit"&&b!=="reset"||o!=null)){Vt(i);return}u=u!=null?""+tn(u):"",o=o!=null?""+tn(o):u,$||o===i.value||(i.value=o),i.defaultValue=o}h=h??p,h=typeof h!="function"&&typeof h!="symbol"&&!!h,i.checked=$?i.checked:!!h,i.defaultChecked=!!h,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(i.name=A),Vt(i)}function ih(i,o,u){o==="number"&&Ca(i.ownerDocument)===i||i.defaultValue===""+u||(i.defaultValue=""+u)}function to(i,o,u,h){if(i=i.options,o){o={};for(var p=0;p<u.length;p++)o["$"+u[p]]=!0;for(u=0;u<i.length;u++)p=o.hasOwnProperty("$"+i[u].value),i[u].selected!==p&&(i[u].selected=p),p&&h&&(i[u].defaultSelected=!0)}else{for(u=""+tn(u),o=null,p=0;p<i.length;p++){if(i[p].value===u){i[p].selected=!0,h&&(i[p].defaultSelected=!0);return}o!==null||i[p].disabled||(o=i[p])}o!==null&&(o.selected=!0)}}function Qm(i,o,u){if(o!=null&&(o=""+tn(o),o!==i.value&&(i.value=o),u==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=u!=null?""+tn(u):""}function so(i,o,u,h){if(o==null){if(h!=null){if(u!=null)throw Error(n(92));if(X(h)){if(1<h.length)throw Error(n(93));h=h[0]}u=h}u==null&&(u=""),o=u}u=tn(o),i.defaultValue=u,h=i.textContent,h===u&&h!==""&&h!==null&&(i.value=h),Vt(i)}function Jn(i,o){if(o){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=o;return}}i.textContent=o}var Ym=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function oh(i,o,u){var h=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?h?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":h?i.setProperty(o,u):typeof u!="number"||u===0||Ym.has(o)?o==="float"?i.cssFloat=u:i[o]=(""+u).trim():i[o]=u+"px"}function lh(i,o,u){if(o!=null&&typeof o!="object")throw Error(n(62));if(i=i.style,u!=null){for(var h in u)!u.hasOwnProperty(h)||o!=null&&o.hasOwnProperty(h)||(h.indexOf("--")===0?i.setProperty(h,""):h==="float"?i.cssFloat="":i[h]="");for(var p in o)h=o[p],o.hasOwnProperty(p)&&u[p]!==h&&oh(i,p,h)}else for(var b in o)o.hasOwnProperty(b)&&oh(i,b,o[b])}function Gc(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jm=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),no=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Wc(i){return no.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function sa(){}var ch=null;function Mr(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ro=null,Ra=null;function wl(i){var o=Pr(i);if(o&&(i=o.stateNode)){var u=i[en]||null;e:switch(i=o.stateNode,o.type){case"input":if(Hc(i,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Yn(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var h=u[o];if(h!==i&&h.form===i.form){var p=h[en]||null;if(!p)throw Error(n(90));Hc(h,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(o=0;o<u.length;o++)h=u[o],h.form===i.form&&bl(h)}break e;case"textarea":Qm(i,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&to(i,!!u.multiple,o,!1)}}}var Kc=!1;function ao(i,o,u){if(Kc)return i(o,u);Kc=!0;try{var h=i(o);return h}finally{if(Kc=!1,(ro!==null||Ra!==null)&&(qg(),ro&&(o=ro,i=Ra,Ra=ro=null,wl(o),i)))for(o=0;o<i.length;o++)wl(i[o])}}function na(i,o){var u=i.stateNode;if(u===null)return null;var h=u[en]||null;if(h===null)return null;u=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(n(231,o,typeof u));return u}var Lr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vl=!1;if(Lr)try{var Wt={};Object.defineProperty(Wt,"passive",{get:function(){vl=!0}}),window.addEventListener("test",Wt,Wt),window.removeEventListener("test",Wt,Wt)}catch{vl=!1}var Da=null,uh=null,_l=null;function dh(){if(_l)return _l;var i,o=uh,u=o.length,h,p="value"in Da?Da.value:Da.textContent,b=p.length;for(i=0;i<u&&o[i]===p[i];i++);var A=u-i;for(h=1;h<=A&&o[u-h]===p[b-h];h++);return _l=p.slice(i,1<h?1-h:void 0)}function jl(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function ci(){return!0}function ra(){return!1}function dn(i){function o(u,h,p,b,A){this._reactName=u,this._targetInst=p,this.type=h,this.nativeEvent=b,this.target=A,this.currentTarget=null;for(var $ in i)i.hasOwnProperty($)&&(u=i[$],this[$]=u?u(b):b[$]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?ci:ra,this.isPropagationStopped=ra,this}return y(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=ci)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=ci)},persist:function(){},isPersistent:ci}),o}var ui={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Oa=dn(ui),io=y({},ui,{view:0,detail:0}),hh=dn(io),oo,Qc,Pa,Yc=y({},io,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lo,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Pa&&(Pa&&i.type==="mousemove"?(oo=i.screenX-Pa.screenX,Qc=i.screenY-Pa.screenY):Qc=oo=0,Pa=i),oo)},movementY:function(i){return"movementY"in i?i.movementY:Qc}}),fh=dn(Yc),Nl=y({},Yc,{dataTransfer:0}),Xm=dn(Nl),Zm=y({},io,{relatedTarget:0}),Sl=dn(Zm),mh=y({},ui,{animationName:0,elapsedTime:0,pseudoElement:0}),eg=dn(mh),Jc=y({},ui,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),tg=dn(Jc),sg=y({},ui,{data:0}),Ma=dn(sg),ng={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ag={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ig(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=ag[i])?!!o[i]:!1}function lo(){return ig}var Vn=y({},io,{key:function(i){if(i.key){var o=ng[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=jl(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?rg[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lo,charCode:function(i){return i.type==="keypress"?jl(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?jl(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),og=dn(Vn),lg=y({},Yc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),di=dn(lg),g=y({},io,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lo}),_=dn(g),C=y({},ui,{propertyName:0,elapsedTime:0,pseudoElement:0}),H=dn(C),ie=y({},Yc,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),ge=dn(ie),Ve=y({},ui,{newState:0,oldState:0}),ft=dn(Ve),Ss=[9,13,27,32],Dt=Lr&&"CompositionEvent"in window,cs=null;Lr&&"documentMode"in document&&(cs=document.documentMode);var Vr=Lr&&"TextEvent"in window&&!cs,La=Lr&&(!Dt||cs&&8<cs&&11>=cs),aa=" ",ia=!1;function Tl(i,o){switch(i){case"keyup":return Ss.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xc(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Zc=!1;function UR(i,o){switch(i){case"compositionend":return Xc(o);case"keypress":return o.which!==32?null:(ia=!0,aa);case"textInput":return i=o.data,i===aa&&ia?null:i;default:return null}}function FR(i,o){if(Zc)return i==="compositionend"||!Dt&&Tl(i,o)?(i=dh(),_l=uh=Da=null,Zc=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return La&&o.locale!=="ko"?null:o.data;default:return null}}var $R={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gj(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!$R[i.type]:o==="textarea"}function Wj(i,o,u,h){ro?Ra?Ra.push(h):Ra=[h]:ro=h,o=Jg(o,"onChange"),0<o.length&&(u=new Oa("onChange","change",null,u,h),i.push({event:u,listeners:o}))}var gh=null,ph=null;function BR(i){A2(i,0)}function cg(i){var o=mr(i);if(bl(o))return i}function Kj(i,o){if(i==="change")return o}var Qj=!1;if(Lr){var Ex;if(Lr){var Ix="oninput"in document;if(!Ix){var Yj=document.createElement("div");Yj.setAttribute("oninput","return;"),Ix=typeof Yj.oninput=="function"}Ex=Ix}else Ex=!1;Qj=Ex&&(!document.documentMode||9<document.documentMode)}function Jj(){gh&&(gh.detachEvent("onpropertychange",Xj),ph=gh=null)}function Xj(i){if(i.propertyName==="value"&&cg(ph)){var o=[];Wj(o,ph,i,Mr(i)),ao(BR,o)}}function zR(i,o,u){i==="focusin"?(Jj(),gh=o,ph=u,gh.attachEvent("onpropertychange",Xj)):i==="focusout"&&Jj()}function qR(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return cg(ph)}function HR(i,o){if(i==="click")return cg(o)}function GR(i,o){if(i==="input"||i==="change")return cg(o)}function WR(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var pr=typeof Object.is=="function"?Object.is:WR;function xh(i,o){if(pr(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var u=Object.keys(i),h=Object.keys(o);if(u.length!==h.length)return!1;for(h=0;h<u.length;h++){var p=u[h];if(!Oe.call(o,p)||!pr(i[p],o[p]))return!1}return!0}function Zj(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function e1(i,o){var u=Zj(i);i=0;for(var h;u;){if(u.nodeType===3){if(h=i+u.textContent.length,i<=o&&h>=o)return{node:u,offset:o-i};i=h}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Zj(u)}}function t1(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?t1(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function s1(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=Ca(i.document);o instanceof i.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)i=o.contentWindow;else break;o=Ca(i.document)}return o}function Ax(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}var KR=Lr&&"documentMode"in document&&11>=document.documentMode,eu=null,kx=null,bh=null,Cx=!1;function n1(i,o,u){var h=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Cx||eu==null||eu!==Ca(h)||(h=eu,"selectionStart"in h&&Ax(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),bh&&xh(bh,h)||(bh=h,h=Jg(kx,"onSelect"),0<h.length&&(o=new Oa("onSelect","select",null,o,u),i.push({event:o,listeners:h}),o.target=eu)))}function El(i,o){var u={};return u[i.toLowerCase()]=o.toLowerCase(),u["Webkit"+i]="webkit"+o,u["Moz"+i]="moz"+o,u}var tu={animationend:El("Animation","AnimationEnd"),animationiteration:El("Animation","AnimationIteration"),animationstart:El("Animation","AnimationStart"),transitionrun:El("Transition","TransitionRun"),transitionstart:El("Transition","TransitionStart"),transitioncancel:El("Transition","TransitionCancel"),transitionend:El("Transition","TransitionEnd")},Rx={},r1={};Lr&&(r1=document.createElement("div").style,"AnimationEvent"in window||(delete tu.animationend.animation,delete tu.animationiteration.animation,delete tu.animationstart.animation),"TransitionEvent"in window||delete tu.transitionend.transition);function Il(i){if(Rx[i])return Rx[i];if(!tu[i])return i;var o=tu[i],u;for(u in o)if(o.hasOwnProperty(u)&&u in r1)return Rx[i]=o[u];return i}var a1=Il("animationend"),i1=Il("animationiteration"),o1=Il("animationstart"),QR=Il("transitionrun"),YR=Il("transitionstart"),JR=Il("transitioncancel"),l1=Il("transitionend"),c1=new Map,Dx="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Dx.push("scrollEnd");function oa(i,o){c1.set(i,o),Aa(o,[i])}var ug=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Ur=[],su=0,Ox=0;function dg(){for(var i=su,o=Ox=su=0;o<i;){var u=Ur[o];Ur[o++]=null;var h=Ur[o];Ur[o++]=null;var p=Ur[o];Ur[o++]=null;var b=Ur[o];if(Ur[o++]=null,h!==null&&p!==null){var A=h.pending;A===null?p.next=p:(p.next=A.next,A.next=p),h.pending=p}b!==0&&u1(u,p,b)}}function hg(i,o,u,h){Ur[su++]=i,Ur[su++]=o,Ur[su++]=u,Ur[su++]=h,Ox|=h,i.lanes|=h,i=i.alternate,i!==null&&(i.lanes|=h)}function Px(i,o,u,h){return hg(i,o,u,h),fg(i)}function Al(i,o){return hg(i,null,null,o),fg(i)}function u1(i,o,u){i.lanes|=u;var h=i.alternate;h!==null&&(h.lanes|=u);for(var p=!1,b=i.return;b!==null;)b.childLanes|=u,h=b.alternate,h!==null&&(h.childLanes|=u),b.tag===22&&(i=b.stateNode,i===null||i._visibility&1||(p=!0)),i=b,b=b.return;return i.tag===3?(b=i.stateNode,p&&o!==null&&(p=31-Me(u),i=b.hiddenUpdates,h=i[p],h===null?i[p]=[o]:h.push(o),o.lane=u|536870912),b):null}function fg(i){if(50<Fh)throw Fh=0,qb=null,Error(n(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var nu={};function XR(i,o,u,h){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xr(i,o,u,h){return new XR(i,o,u,h)}function Mx(i){return i=i.prototype,!(!i||!i.isReactComponent)}function hi(i,o){var u=i.alternate;return u===null?(u=xr(i.tag,o,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=o,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&65011712,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,o=i.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u.refCleanup=i.refCleanup,u}function d1(i,o){i.flags&=65011714;var u=i.alternate;return u===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=u.childLanes,i.lanes=u.lanes,i.child=u.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=u.memoizedProps,i.memoizedState=u.memoizedState,i.updateQueue=u.updateQueue,i.type=u.type,o=u.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function mg(i,o,u,h,p,b){var A=0;if(h=i,typeof i=="function")Mx(i)&&(A=1);else if(typeof i=="string")A=nD(i,u,ne.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case B:return i=xr(31,u,o,p),i.elementType=B,i.lanes=b,i;case I:return kl(u.children,p,b,o);case N:A=8,p|=24;break;case P:return i=xr(12,u,o,p|2),i.elementType=P,i.lanes=b,i;case W:return i=xr(13,u,o,p),i.elementType=W,i.lanes=b,i;case z:return i=xr(19,u,o,p),i.elementType=z,i.lanes=b,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case V:A=10;break e;case U:A=9;break e;case q:A=11;break e;case k:A=14;break e;case M:A=16,h=null;break e}A=29,u=Error(n(130,i===null?"null":typeof i,"")),h=null}return o=xr(A,u,o,p),o.elementType=i,o.type=h,o.lanes=b,o}function kl(i,o,u,h){return i=xr(7,i,h,o),i.lanes=u,i}function Lx(i,o,u){return i=xr(6,i,null,o),i.lanes=u,i}function h1(i){var o=xr(18,null,null,0);return o.stateNode=i,o}function Vx(i,o,u){return o=xr(4,i.children!==null?i.children:[],i.key,o),o.lanes=u,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}var f1=new WeakMap;function Fr(i,o){if(typeof i=="object"&&i!==null){var u=f1.get(i);return u!==void 0?u:(o={value:i,source:o,stack:ce(o)},f1.set(i,o),o)}return{value:i,source:o,stack:ce(o)}}var ru=[],au=0,gg=null,yh=0,$r=[],Br=0,co=null,Va=1,Ua="";function fi(i,o){ru[au++]=yh,ru[au++]=gg,gg=i,yh=o}function m1(i,o,u){$r[Br++]=Va,$r[Br++]=Ua,$r[Br++]=co,co=i;var h=Va;i=Ua;var p=32-Me(h)-1;h&=~(1<<p),u+=1;var b=32-Me(o)+p;if(30<b){var A=p-p%5;b=(h&(1<<A)-1).toString(32),h>>=A,p-=A,Va=1<<32-Me(o)+p|u<<p|h,Ua=b+i}else Va=1<<b|u<<p|h,Ua=i}function Ux(i){i.return!==null&&(fi(i,1),m1(i,1,0))}function Fx(i){for(;i===gg;)gg=ru[--au],ru[au]=null,yh=ru[--au],ru[au]=null;for(;i===co;)co=$r[--Br],$r[Br]=null,Ua=$r[--Br],$r[Br]=null,Va=$r[--Br],$r[Br]=null}function g1(i,o){$r[Br++]=Va,$r[Br++]=Ua,$r[Br++]=co,Va=o.id,Ua=o.overflow,co=i}var hn=null,ns=null,It=!1,uo=null,zr=!1,$x=Error(n(519));function ho(i){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw wh(Fr(o,i)),$x}function p1(i){var o=i.stateNode,u=i.type,h=i.memoizedProps;switch(o[Os]=i,o[en]=h,u){case"dialog":_t("cancel",o),_t("close",o);break;case"iframe":case"object":case"embed":_t("load",o);break;case"video":case"audio":for(u=0;u<Bh.length;u++)_t(Bh[u],o);break;case"source":_t("error",o);break;case"img":case"image":case"link":_t("error",o),_t("load",o);break;case"details":_t("toggle",o);break;case"input":_t("invalid",o),Km(o,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":_t("invalid",o);break;case"textarea":_t("invalid",o),so(o,h.value,h.defaultValue,h.children)}u=h.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||h.suppressHydrationWarning===!0||D2(o.textContent,u)?(h.popover!=null&&(_t("beforetoggle",o),_t("toggle",o)),h.onScroll!=null&&_t("scroll",o),h.onScrollEnd!=null&&_t("scrollend",o),h.onClick!=null&&(o.onclick=sa),o=!0):o=!1,o||ho(i,!0)}function x1(i){for(hn=i.return;hn;)switch(hn.tag){case 5:case 31:case 13:zr=!1;return;case 27:case 3:zr=!0;return;default:hn=hn.return}}function iu(i){if(i!==hn)return!1;if(!It)return x1(i),It=!0,!1;var o=i.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=i.type,u=!(u!=="form"&&u!=="button")||ay(i.type,i.memoizedProps)),u=!u),u&&ns&&ho(i),x1(i),o===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));ns=B2(i)}else if(o===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));ns=B2(i)}else o===27?(o=ns,To(i.type)?(i=uy,uy=null,ns=i):ns=o):ns=hn?Hr(i.stateNode.nextSibling):null;return!0}function Cl(){ns=hn=null,It=!1}function Bx(){var i=uo;return i!==null&&(tr===null?tr=i:tr.push.apply(tr,i),uo=null),i}function wh(i){uo===null?uo=[i]:uo.push(i)}var zx=L(null),Rl=null,mi=null;function fo(i,o,u){ee(zx,o._currentValue),o._currentValue=u}function gi(i){i._currentValue=zx.current,G(zx)}function qx(i,o,u){for(;i!==null;){var h=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),i===u)break;i=i.return}}function Hx(i,o,u,h){var p=i.child;for(p!==null&&(p.return=i);p!==null;){var b=p.dependencies;if(b!==null){var A=p.child;b=b.firstContext;e:for(;b!==null;){var $=b;b=p;for(var Z=0;Z<o.length;Z++)if($.context===o[Z]){b.lanes|=u,$=b.alternate,$!==null&&($.lanes|=u),qx(b.return,u,i),h||(A=null);break e}b=$.next}}else if(p.tag===18){if(A=p.return,A===null)throw Error(n(341));A.lanes|=u,b=A.alternate,b!==null&&(b.lanes|=u),qx(A,u,i),A=null}else A=p.child;if(A!==null)A.return=p;else for(A=p;A!==null;){if(A===i){A=null;break}if(p=A.sibling,p!==null){p.return=A.return,A=p;break}A=A.return}p=A}}function ou(i,o,u,h){i=null;for(var p=o,b=!1;p!==null;){if(!b){if((p.flags&524288)!==0)b=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var A=p.alternate;if(A===null)throw Error(n(387));if(A=A.memoizedProps,A!==null){var $=p.type;pr(p.pendingProps.value,A.value)||(i!==null?i.push($):i=[$])}}else if(p===_e.current){if(A=p.alternate,A===null)throw Error(n(387));A.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(i!==null?i.push(Wh):i=[Wh])}p=p.return}i!==null&&Hx(o,i,u,h),o.flags|=262144}function pg(i){for(i=i.firstContext;i!==null;){if(!pr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Dl(i){Rl=i,mi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function fn(i){return b1(Rl,i)}function xg(i,o){return Rl===null&&Dl(i),b1(i,o)}function b1(i,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},mi===null){if(i===null)throw Error(n(308));mi=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else mi=mi.next=o;return u}var ZR=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(u,h){i.push(h)}};this.abort=function(){o.aborted=!0,i.forEach(function(u){return u()})}},e3=s.unstable_scheduleCallback,t3=s.unstable_NormalPriority,Ls={$$typeof:V,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Gx(){return{controller:new ZR,data:new Map,refCount:0}}function vh(i){i.refCount--,i.refCount===0&&e3(t3,function(){i.controller.abort()})}var _h=null,Wx=0,lu=0,cu=null;function s3(i,o){if(_h===null){var u=_h=[];Wx=0,lu=Yb(),cu={status:"pending",value:void 0,then:function(h){u.push(h)}}}return Wx++,o.then(y1,y1),o}function y1(){if(--Wx===0&&_h!==null){cu!==null&&(cu.status="fulfilled");var i=_h;_h=null,lu=0,cu=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function n3(i,o){var u=[],h={status:"pending",value:null,reason:null,then:function(p){u.push(p)}};return i.then(function(){h.status="fulfilled",h.value=o;for(var p=0;p<u.length;p++)(0,u[p])(o)},function(p){for(h.status="rejected",h.reason=p,p=0;p<u.length;p++)(0,u[p])(void 0)}),h}var w1=R.S;R.S=function(i,o){n2=Le(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&s3(i,o),w1!==null&&w1(i,o)};var Ol=L(null);function Kx(){var i=Ol.current;return i!==null?i:Xt.pooledCache}function bg(i,o){o===null?ee(Ol,Ol.current):ee(Ol,o.pool)}function v1(){var i=Kx();return i===null?null:{parent:Ls._currentValue,pool:i}}var uu=Error(n(460)),Qx=Error(n(474)),yg=Error(n(542)),wg={then:function(){}};function _1(i){return i=i.status,i==="fulfilled"||i==="rejected"}function j1(i,o,u){switch(u=i[u],u===void 0?i.push(o):u!==o&&(o.then(sa,sa),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,S1(i),i;default:if(typeof o.status=="string")o.then(sa,sa);else{if(i=Xt,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=o,i.status="pending",i.then(function(h){if(o.status==="pending"){var p=o;p.status="fulfilled",p.value=h}},function(h){if(o.status==="pending"){var p=o;p.status="rejected",p.reason=h}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,S1(i),i}throw Ml=o,uu}}function Pl(i){try{var o=i._init;return o(i._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(Ml=u,uu):u}}var Ml=null;function N1(){if(Ml===null)throw Error(n(459));var i=Ml;return Ml=null,i}function S1(i){if(i===uu||i===yg)throw Error(n(483))}var du=null,jh=0;function vg(i){var o=jh;return jh+=1,du===null&&(du=[]),j1(du,i,o)}function Nh(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function _g(i,o){throw o.$$typeof===w?Error(n(525)):(i=Object.prototype.toString.call(o),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function T1(i){function o(re,te){if(i){var oe=re.deletions;oe===null?(re.deletions=[te],re.flags|=16):oe.push(te)}}function u(re,te){if(!i)return null;for(;te!==null;)o(re,te),te=te.sibling;return null}function h(re){for(var te=new Map;re!==null;)re.key!==null?te.set(re.key,re):te.set(re.index,re),re=re.sibling;return te}function p(re,te){return re=hi(re,te),re.index=0,re.sibling=null,re}function b(re,te,oe){return re.index=oe,i?(oe=re.alternate,oe!==null?(oe=oe.index,oe<te?(re.flags|=67108866,te):oe):(re.flags|=67108866,te)):(re.flags|=1048576,te)}function A(re){return i&&re.alternate===null&&(re.flags|=67108866),re}function $(re,te,oe,Ne){return te===null||te.tag!==6?(te=Lx(oe,re.mode,Ne),te.return=re,te):(te=p(te,oe),te.return=re,te)}function Z(re,te,oe,Ne){var st=oe.type;return st===I?ve(re,te,oe.props.children,Ne,oe.key):te!==null&&(te.elementType===st||typeof st=="object"&&st!==null&&st.$$typeof===M&&Pl(st)===te.type)?(te=p(te,oe.props),Nh(te,oe),te.return=re,te):(te=mg(oe.type,oe.key,oe.props,null,re.mode,Ne),Nh(te,oe),te.return=re,te)}function le(re,te,oe,Ne){return te===null||te.tag!==4||te.stateNode.containerInfo!==oe.containerInfo||te.stateNode.implementation!==oe.implementation?(te=Vx(oe,re.mode,Ne),te.return=re,te):(te=p(te,oe.children||[]),te.return=re,te)}function ve(re,te,oe,Ne,st){return te===null||te.tag!==7?(te=kl(oe,re.mode,Ne,st),te.return=re,te):(te=p(te,oe),te.return=re,te)}function Ee(re,te,oe){if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return te=Lx(""+te,re.mode,oe),te.return=re,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case v:return oe=mg(te.type,te.key,te.props,null,re.mode,oe),Nh(oe,te),oe.return=re,oe;case T:return te=Vx(te,re.mode,oe),te.return=re,te;case M:return te=Pl(te),Ee(re,te,oe)}if(X(te)||F(te))return te=kl(te,re.mode,oe,null),te.return=re,te;if(typeof te.then=="function")return Ee(re,vg(te),oe);if(te.$$typeof===V)return Ee(re,xg(re,te),oe);_g(re,te)}return null}function de(re,te,oe,Ne){var st=te!==null?te.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return st!==null?null:$(re,te,""+oe,Ne);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case v:return oe.key===st?Z(re,te,oe,Ne):null;case T:return oe.key===st?le(re,te,oe,Ne):null;case M:return oe=Pl(oe),de(re,te,oe,Ne)}if(X(oe)||F(oe))return st!==null?null:ve(re,te,oe,Ne,null);if(typeof oe.then=="function")return de(re,te,vg(oe),Ne);if(oe.$$typeof===V)return de(re,te,xg(re,oe),Ne);_g(re,oe)}return null}function xe(re,te,oe,Ne,st){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return re=re.get(oe)||null,$(te,re,""+Ne,st);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case v:return re=re.get(Ne.key===null?oe:Ne.key)||null,Z(te,re,Ne,st);case T:return re=re.get(Ne.key===null?oe:Ne.key)||null,le(te,re,Ne,st);case M:return Ne=Pl(Ne),xe(re,te,oe,Ne,st)}if(X(Ne)||F(Ne))return re=re.get(oe)||null,ve(te,re,Ne,st,null);if(typeof Ne.then=="function")return xe(re,te,oe,vg(Ne),st);if(Ne.$$typeof===V)return xe(re,te,oe,xg(te,Ne),st);_g(te,Ne)}return null}function He(re,te,oe,Ne){for(var st=null,kt=null,Ye=te,xt=te=0,Tt=null;Ye!==null&&xt<oe.length;xt++){Ye.index>xt?(Tt=Ye,Ye=null):Tt=Ye.sibling;var Ct=de(re,Ye,oe[xt],Ne);if(Ct===null){Ye===null&&(Ye=Tt);break}i&&Ye&&Ct.alternate===null&&o(re,Ye),te=b(Ct,te,xt),kt===null?st=Ct:kt.sibling=Ct,kt=Ct,Ye=Tt}if(xt===oe.length)return u(re,Ye),It&&fi(re,xt),st;if(Ye===null){for(;xt<oe.length;xt++)Ye=Ee(re,oe[xt],Ne),Ye!==null&&(te=b(Ye,te,xt),kt===null?st=Ye:kt.sibling=Ye,kt=Ye);return It&&fi(re,xt),st}for(Ye=h(Ye);xt<oe.length;xt++)Tt=xe(Ye,re,xt,oe[xt],Ne),Tt!==null&&(i&&Tt.alternate!==null&&Ye.delete(Tt.key===null?xt:Tt.key),te=b(Tt,te,xt),kt===null?st=Tt:kt.sibling=Tt,kt=Tt);return i&&Ye.forEach(function(Co){return o(re,Co)}),It&&fi(re,xt),st}function ot(re,te,oe,Ne){if(oe==null)throw Error(n(151));for(var st=null,kt=null,Ye=te,xt=te=0,Tt=null,Ct=oe.next();Ye!==null&&!Ct.done;xt++,Ct=oe.next()){Ye.index>xt?(Tt=Ye,Ye=null):Tt=Ye.sibling;var Co=de(re,Ye,Ct.value,Ne);if(Co===null){Ye===null&&(Ye=Tt);break}i&&Ye&&Co.alternate===null&&o(re,Ye),te=b(Co,te,xt),kt===null?st=Co:kt.sibling=Co,kt=Co,Ye=Tt}if(Ct.done)return u(re,Ye),It&&fi(re,xt),st;if(Ye===null){for(;!Ct.done;xt++,Ct=oe.next())Ct=Ee(re,Ct.value,Ne),Ct!==null&&(te=b(Ct,te,xt),kt===null?st=Ct:kt.sibling=Ct,kt=Ct);return It&&fi(re,xt),st}for(Ye=h(Ye);!Ct.done;xt++,Ct=oe.next())Ct=xe(Ye,re,xt,Ct.value,Ne),Ct!==null&&(i&&Ct.alternate!==null&&Ye.delete(Ct.key===null?xt:Ct.key),te=b(Ct,te,xt),kt===null?st=Ct:kt.sibling=Ct,kt=Ct);return i&&Ye.forEach(function(mD){return o(re,mD)}),It&&fi(re,xt),st}function Yt(re,te,oe,Ne){if(typeof oe=="object"&&oe!==null&&oe.type===I&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case v:e:{for(var st=oe.key;te!==null;){if(te.key===st){if(st=oe.type,st===I){if(te.tag===7){u(re,te.sibling),Ne=p(te,oe.props.children),Ne.return=re,re=Ne;break e}}else if(te.elementType===st||typeof st=="object"&&st!==null&&st.$$typeof===M&&Pl(st)===te.type){u(re,te.sibling),Ne=p(te,oe.props),Nh(Ne,oe),Ne.return=re,re=Ne;break e}u(re,te);break}else o(re,te);te=te.sibling}oe.type===I?(Ne=kl(oe.props.children,re.mode,Ne,oe.key),Ne.return=re,re=Ne):(Ne=mg(oe.type,oe.key,oe.props,null,re.mode,Ne),Nh(Ne,oe),Ne.return=re,re=Ne)}return A(re);case T:e:{for(st=oe.key;te!==null;){if(te.key===st)if(te.tag===4&&te.stateNode.containerInfo===oe.containerInfo&&te.stateNode.implementation===oe.implementation){u(re,te.sibling),Ne=p(te,oe.children||[]),Ne.return=re,re=Ne;break e}else{u(re,te);break}else o(re,te);te=te.sibling}Ne=Vx(oe,re.mode,Ne),Ne.return=re,re=Ne}return A(re);case M:return oe=Pl(oe),Yt(re,te,oe,Ne)}if(X(oe))return He(re,te,oe,Ne);if(F(oe)){if(st=F(oe),typeof st!="function")throw Error(n(150));return oe=st.call(oe),ot(re,te,oe,Ne)}if(typeof oe.then=="function")return Yt(re,te,vg(oe),Ne);if(oe.$$typeof===V)return Yt(re,te,xg(re,oe),Ne);_g(re,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,te!==null&&te.tag===6?(u(re,te.sibling),Ne=p(te,oe),Ne.return=re,re=Ne):(u(re,te),Ne=Lx(oe,re.mode,Ne),Ne.return=re,re=Ne),A(re)):u(re,te)}return function(re,te,oe,Ne){try{jh=0;var st=Yt(re,te,oe,Ne);return du=null,st}catch(Ye){if(Ye===uu||Ye===yg)throw Ye;var kt=xr(29,Ye,null,re.mode);return kt.lanes=Ne,kt.return=re,kt}finally{}}}var Ll=T1(!0),E1=T1(!1),mo=!1;function Yx(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jx(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function go(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function po(i,o,u){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(Ot&2)!==0){var p=h.pending;return p===null?o.next=o:(o.next=p.next,p.next=o),h.pending=o,o=fg(i),u1(i,null,u),o}return hg(i,h,o,u),fg(i)}function Sh(i,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var h=o.lanes;h&=i.pendingLanes,u|=h,o.lanes=u,Na(i,u)}}function Xx(i,o){var u=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,u===h)){var p=null,b=null;if(u=u.firstBaseUpdate,u!==null){do{var A={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};b===null?p=b=A:b=b.next=A,u=u.next}while(u!==null);b===null?p=b=o:b=b.next=o}else p=b=o;u={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:b,shared:h.shared,callbacks:h.callbacks},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=o:i.next=o,u.lastBaseUpdate=o}var Zx=!1;function Th(){if(Zx){var i=cu;if(i!==null)throw i}}function Eh(i,o,u,h){Zx=!1;var p=i.updateQueue;mo=!1;var b=p.firstBaseUpdate,A=p.lastBaseUpdate,$=p.shared.pending;if($!==null){p.shared.pending=null;var Z=$,le=Z.next;Z.next=null,A===null?b=le:A.next=le,A=Z;var ve=i.alternate;ve!==null&&(ve=ve.updateQueue,$=ve.lastBaseUpdate,$!==A&&($===null?ve.firstBaseUpdate=le:$.next=le,ve.lastBaseUpdate=Z))}if(b!==null){var Ee=p.baseState;A=0,ve=le=Z=null,$=b;do{var de=$.lane&-536870913,xe=de!==$.lane;if(xe?(St&de)===de:(h&de)===de){de!==0&&de===lu&&(Zx=!0),ve!==null&&(ve=ve.next={lane:0,tag:$.tag,payload:$.payload,callback:null,next:null});e:{var He=i,ot=$;de=o;var Yt=u;switch(ot.tag){case 1:if(He=ot.payload,typeof He=="function"){Ee=He.call(Yt,Ee,de);break e}Ee=He;break e;case 3:He.flags=He.flags&-65537|128;case 0:if(He=ot.payload,de=typeof He=="function"?He.call(Yt,Ee,de):He,de==null)break e;Ee=y({},Ee,de);break e;case 2:mo=!0}}de=$.callback,de!==null&&(i.flags|=64,xe&&(i.flags|=8192),xe=p.callbacks,xe===null?p.callbacks=[de]:xe.push(de))}else xe={lane:de,tag:$.tag,payload:$.payload,callback:$.callback,next:null},ve===null?(le=ve=xe,Z=Ee):ve=ve.next=xe,A|=de;if($=$.next,$===null){if($=p.shared.pending,$===null)break;xe=$,$=xe.next,xe.next=null,p.lastBaseUpdate=xe,p.shared.pending=null}}while(!0);ve===null&&(Z=Ee),p.baseState=Z,p.firstBaseUpdate=le,p.lastBaseUpdate=ve,b===null&&(p.shared.lanes=0),vo|=A,i.lanes=A,i.memoizedState=Ee}}function I1(i,o){if(typeof i!="function")throw Error(n(191,i));i.call(o)}function A1(i,o){var u=i.callbacks;if(u!==null)for(i.callbacks=null,i=0;i<u.length;i++)I1(u[i],o)}var hu=L(null),jg=L(0);function k1(i,o){i=Ni,ee(jg,i),ee(hu,o),Ni=i|o.baseLanes}function eb(){ee(jg,Ni),ee(hu,hu.current)}function tb(){Ni=jg.current,G(hu),G(jg)}var br=L(null),qr=null;function xo(i){var o=i.alternate;ee(Ts,Ts.current&1),ee(br,i),qr===null&&(o===null||hu.current!==null||o.memoizedState!==null)&&(qr=i)}function sb(i){ee(Ts,Ts.current),ee(br,i),qr===null&&(qr=i)}function C1(i){i.tag===22?(ee(Ts,Ts.current),ee(br,i),qr===null&&(qr=i)):bo()}function bo(){ee(Ts,Ts.current),ee(br,br.current)}function yr(i){G(br),qr===i&&(qr=null),G(Ts)}var Ts=L(0);function Ng(i){for(var o=i;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||ly(u)||cy(u)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var pi=0,mt=null,Kt=null,Vs=null,Sg=!1,fu=!1,Vl=!1,Tg=0,Ih=0,mu=null,r3=0;function ys(){throw Error(n(321))}function nb(i,o){if(o===null)return!1;for(var u=0;u<o.length&&u<i.length;u++)if(!pr(i[u],o[u]))return!1;return!0}function rb(i,o,u,h,p,b){return pi=b,mt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,R.H=i===null||i.memoizedState===null?mN:yb,Vl=!1,b=u(h,p),Vl=!1,fu&&(b=D1(o,u,h,p)),R1(i),b}function R1(i){R.H=Ch;var o=Kt!==null&&Kt.next!==null;if(pi=0,Vs=Kt=mt=null,Sg=!1,Ih=0,mu=null,o)throw Error(n(300));i===null||Us||(i=i.dependencies,i!==null&&pg(i)&&(Us=!0))}function D1(i,o,u,h){mt=i;var p=0;do{if(fu&&(mu=null),Ih=0,fu=!1,25<=p)throw Error(n(301));if(p+=1,Vs=Kt=null,i.updateQueue!=null){var b=i.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}R.H=gN,b=o(u,h)}while(fu);return b}function a3(){var i=R.H,o=i.useState()[0];return o=typeof o.then=="function"?Ah(o):o,i=i.useState()[0],(Kt!==null?Kt.memoizedState:null)!==i&&(mt.flags|=1024),o}function ab(){var i=Tg!==0;return Tg=0,i}function ib(i,o,u){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~u}function ob(i){if(Sg){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}Sg=!1}pi=0,Vs=Kt=mt=null,fu=!1,Ih=Tg=0,mu=null}function Un(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vs===null?mt.memoizedState=Vs=i:Vs=Vs.next=i,Vs}function Es(){if(Kt===null){var i=mt.alternate;i=i!==null?i.memoizedState:null}else i=Kt.next;var o=Vs===null?mt.memoizedState:Vs.next;if(o!==null)Vs=o,Kt=i;else{if(i===null)throw mt.alternate===null?Error(n(467)):Error(n(310));Kt=i,i={memoizedState:Kt.memoizedState,baseState:Kt.baseState,baseQueue:Kt.baseQueue,queue:Kt.queue,next:null},Vs===null?mt.memoizedState=Vs=i:Vs=Vs.next=i}return Vs}function Eg(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ah(i){var o=Ih;return Ih+=1,mu===null&&(mu=[]),i=j1(mu,i,o),o=mt,(Vs===null?o.memoizedState:Vs.next)===null&&(o=o.alternate,R.H=o===null||o.memoizedState===null?mN:yb),i}function Ig(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Ah(i);if(i.$$typeof===V)return fn(i)}throw Error(n(438,String(i)))}function lb(i){var o=null,u=mt.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var h=mt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(o={data:h.data.map(function(p){return p.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=Eg(),mt.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(i),h=0;h<i;h++)u[h]=D;return o.index++,u}function xi(i,o){return typeof o=="function"?o(i):o}function Ag(i){var o=Es();return cb(o,Kt,i)}function cb(i,o,u){var h=i.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=u;var p=i.baseQueue,b=h.pending;if(b!==null){if(p!==null){var A=p.next;p.next=b.next,b.next=A}o.baseQueue=p=b,h.pending=null}if(b=i.baseState,p===null)i.memoizedState=b;else{o=p.next;var $=A=null,Z=null,le=o,ve=!1;do{var Ee=le.lane&-536870913;if(Ee!==le.lane?(St&Ee)===Ee:(pi&Ee)===Ee){var de=le.revertLane;if(de===0)Z!==null&&(Z=Z.next={lane:0,revertLane:0,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),Ee===lu&&(ve=!0);else if((pi&de)===de){le=le.next,de===lu&&(ve=!0);continue}else Ee={lane:0,revertLane:le.revertLane,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},Z===null?($=Z=Ee,A=b):Z=Z.next=Ee,mt.lanes|=de,vo|=de;Ee=le.action,Vl&&u(b,Ee),b=le.hasEagerState?le.eagerState:u(b,Ee)}else de={lane:Ee,revertLane:le.revertLane,gesture:le.gesture,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},Z===null?($=Z=de,A=b):Z=Z.next=de,mt.lanes|=Ee,vo|=Ee;le=le.next}while(le!==null&&le!==o);if(Z===null?A=b:Z.next=$,!pr(b,i.memoizedState)&&(Us=!0,ve&&(u=cu,u!==null)))throw u;i.memoizedState=b,i.baseState=A,i.baseQueue=Z,h.lastRenderedState=b}return p===null&&(h.lanes=0),[i.memoizedState,h.dispatch]}function ub(i){var o=Es(),u=o.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=i;var h=u.dispatch,p=u.pending,b=o.memoizedState;if(p!==null){u.pending=null;var A=p=p.next;do b=i(b,A.action),A=A.next;while(A!==p);pr(b,o.memoizedState)||(Us=!0),o.memoizedState=b,o.baseQueue===null&&(o.baseState=b),u.lastRenderedState=b}return[b,h]}function O1(i,o,u){var h=mt,p=Es(),b=It;if(b){if(u===void 0)throw Error(n(407));u=u()}else u=o();var A=!pr((Kt||p).memoizedState,u);if(A&&(p.memoizedState=u,Us=!0),p=p.queue,fb(L1.bind(null,h,p,i),[i]),p.getSnapshot!==o||A||Vs!==null&&Vs.memoizedState.tag&1){if(h.flags|=2048,gu(9,{destroy:void 0},M1.bind(null,h,p,u,o),null),Xt===null)throw Error(n(349));b||(pi&127)!==0||P1(h,o,u)}return u}function P1(i,o,u){i.flags|=16384,i={getSnapshot:o,value:u},o=mt.updateQueue,o===null?(o=Eg(),mt.updateQueue=o,o.stores=[i]):(u=o.stores,u===null?o.stores=[i]:u.push(i))}function M1(i,o,u,h){o.value=u,o.getSnapshot=h,V1(o)&&U1(i)}function L1(i,o,u){return u(function(){V1(o)&&U1(i)})}function V1(i){var o=i.getSnapshot;i=i.value;try{var u=o();return!pr(i,u)}catch{return!0}}function U1(i){var o=Al(i,2);o!==null&&sr(o,i,2)}function db(i){var o=Un();if(typeof i=="function"){var u=i;if(i=u(),Vl){he(!0);try{u()}finally{he(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xi,lastRenderedState:i},o}function F1(i,o,u,h){return i.baseState=u,cb(i,Kt,typeof h=="function"?h:xi)}function i3(i,o,u,h,p){if(Rg(i))throw Error(n(485));if(i=o.action,i!==null){var b={payload:p,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){b.listeners.push(A)}};R.T!==null?u(!0):b.isTransition=!1,h(b),u=o.pending,u===null?(b.next=o.pending=b,$1(o,b)):(b.next=u.next,o.pending=u.next=b)}}function $1(i,o){var u=o.action,h=o.payload,p=i.state;if(o.isTransition){var b=R.T,A={};R.T=A;try{var $=u(p,h),Z=R.S;Z!==null&&Z(A,$),B1(i,o,$)}catch(le){hb(i,o,le)}finally{b!==null&&A.types!==null&&(b.types=A.types),R.T=b}}else try{b=u(p,h),B1(i,o,b)}catch(le){hb(i,o,le)}}function B1(i,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(h){z1(i,o,h)},function(h){return hb(i,o,h)}):z1(i,o,u)}function z1(i,o,u){o.status="fulfilled",o.value=u,q1(o),i.state=u,o=i.pending,o!==null&&(u=o.next,u===o?i.pending=null:(u=u.next,o.next=u,$1(i,u)))}function hb(i,o,u){var h=i.pending;if(i.pending=null,h!==null){h=h.next;do o.status="rejected",o.reason=u,q1(o),o=o.next;while(o!==h)}i.action=null}function q1(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function H1(i,o){return o}function G1(i,o){if(It){var u=Xt.formState;if(u!==null){e:{var h=mt;if(It){if(ns){t:{for(var p=ns,b=zr;p.nodeType!==8;){if(!b){p=null;break t}if(p=Hr(p.nextSibling),p===null){p=null;break t}}b=p.data,p=b==="F!"||b==="F"?p:null}if(p){ns=Hr(p.nextSibling),h=p.data==="F!";break e}}ho(h)}h=!1}h&&(o=u[0])}}return u=Un(),u.memoizedState=u.baseState=o,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:H1,lastRenderedState:o},u.queue=h,u=dN.bind(null,mt,h),h.dispatch=u,h=db(!1),b=bb.bind(null,mt,!1,h.queue),h=Un(),p={state:o,dispatch:null,action:i,pending:null},h.queue=p,u=i3.bind(null,mt,p,b,u),p.dispatch=u,h.memoizedState=i,[o,u,!1]}function W1(i){var o=Es();return K1(o,Kt,i)}function K1(i,o,u){if(o=cb(i,o,H1)[0],i=Ag(xi)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var h=Ah(o)}catch(A){throw A===uu?yg:A}else h=o;o=Es();var p=o.queue,b=p.dispatch;return u!==o.memoizedState&&(mt.flags|=2048,gu(9,{destroy:void 0},o3.bind(null,p,u),null)),[h,b,i]}function o3(i,o){i.action=o}function Q1(i){var o=Es(),u=Kt;if(u!==null)return K1(o,u,i);Es(),o=o.memoizedState,u=Es();var h=u.queue.dispatch;return u.memoizedState=i,[o,h,!1]}function gu(i,o,u,h){return i={tag:i,create:u,deps:h,inst:o,next:null},o=mt.updateQueue,o===null&&(o=Eg(),mt.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=i.next=i:(h=u.next,u.next=i,i.next=h,o.lastEffect=i),i}function Y1(){return Es().memoizedState}function kg(i,o,u,h){var p=Un();mt.flags|=i,p.memoizedState=gu(1|o,{destroy:void 0},u,h===void 0?null:h)}function Cg(i,o,u,h){var p=Es();h=h===void 0?null:h;var b=p.memoizedState.inst;Kt!==null&&h!==null&&nb(h,Kt.memoizedState.deps)?p.memoizedState=gu(o,b,u,h):(mt.flags|=i,p.memoizedState=gu(1|o,b,u,h))}function J1(i,o){kg(8390656,8,i,o)}function fb(i,o){Cg(2048,8,i,o)}function l3(i){mt.flags|=4;var o=mt.updateQueue;if(o===null)o=Eg(),mt.updateQueue=o,o.events=[i];else{var u=o.events;u===null?o.events=[i]:u.push(i)}}function X1(i){var o=Es().memoizedState;return l3({ref:o,nextImpl:i}),function(){if((Ot&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function Z1(i,o){return Cg(4,2,i,o)}function eN(i,o){return Cg(4,4,i,o)}function tN(i,o){if(typeof o=="function"){i=i();var u=o(i);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function sN(i,o,u){u=u!=null?u.concat([i]):null,Cg(4,4,tN.bind(null,o,i),u)}function mb(){}function nN(i,o){var u=Es();o=o===void 0?null:o;var h=u.memoizedState;return o!==null&&nb(o,h[1])?h[0]:(u.memoizedState=[i,o],i)}function rN(i,o){var u=Es();o=o===void 0?null:o;var h=u.memoizedState;if(o!==null&&nb(o,h[1]))return h[0];if(h=i(),Vl){he(!0);try{i()}finally{he(!1)}}return u.memoizedState=[h,o],h}function gb(i,o,u){return u===void 0||(pi&1073741824)!==0&&(St&261930)===0?i.memoizedState=o:(i.memoizedState=u,i=a2(),mt.lanes|=i,vo|=i,u)}function aN(i,o,u,h){return pr(u,o)?u:hu.current!==null?(i=gb(i,u,h),pr(i,o)||(Us=!0),i):(pi&42)===0||(pi&1073741824)!==0&&(St&261930)===0?(Us=!0,i.memoizedState=u):(i=a2(),mt.lanes|=i,vo|=i,o)}function iN(i,o,u,h,p){var b=J.p;J.p=b!==0&&8>b?b:8;var A=R.T,$={};R.T=$,bb(i,!1,o,u);try{var Z=p(),le=R.S;if(le!==null&&le($,Z),Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var ve=n3(Z,h);kh(i,o,ve,_r(i))}else kh(i,o,h,_r(i))}catch(Ee){kh(i,o,{then:function(){},status:"rejected",reason:Ee},_r())}finally{J.p=b,A!==null&&$.types!==null&&(A.types=$.types),R.T=A}}function c3(){}function pb(i,o,u,h){if(i.tag!==5)throw Error(n(476));var p=oN(i).queue;iN(i,p,o,O,u===null?c3:function(){return lN(i),u(h)})}function oN(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:O,baseState:O,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xi,lastRenderedState:O},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xi,lastRenderedState:u},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function lN(i){var o=oN(i);o.next===null&&(o=i.alternate.memoizedState),kh(i,o.next.queue,{},_r())}function xb(){return fn(Wh)}function cN(){return Es().memoizedState}function uN(){return Es().memoizedState}function u3(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var u=_r();i=go(u);var h=po(o,i,u);h!==null&&(sr(h,o,u),Sh(h,o,u)),o={cache:Gx()},i.payload=o;return}o=o.return}}function d3(i,o,u){var h=_r();u={lane:h,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Rg(i)?hN(o,u):(u=Px(i,o,u,h),u!==null&&(sr(u,i,h),fN(u,o,h)))}function dN(i,o,u){var h=_r();kh(i,o,u,h)}function kh(i,o,u,h){var p={lane:h,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(Rg(i))hN(o,p);else{var b=i.alternate;if(i.lanes===0&&(b===null||b.lanes===0)&&(b=o.lastRenderedReducer,b!==null))try{var A=o.lastRenderedState,$=b(A,u);if(p.hasEagerState=!0,p.eagerState=$,pr($,A))return hg(i,o,p,0),Xt===null&&dg(),!1}catch{}finally{}if(u=Px(i,o,p,h),u!==null)return sr(u,i,h),fN(u,o,h),!0}return!1}function bb(i,o,u,h){if(h={lane:2,revertLane:Yb(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Rg(i)){if(o)throw Error(n(479))}else o=Px(i,u,h,2),o!==null&&sr(o,i,2)}function Rg(i){var o=i.alternate;return i===mt||o!==null&&o===mt}function hN(i,o){fu=Sg=!0;var u=i.pending;u===null?o.next=o:(o.next=u.next,u.next=o),i.pending=o}function fN(i,o,u){if((u&4194048)!==0){var h=o.lanes;h&=i.pendingLanes,u|=h,o.lanes=u,Na(i,u)}}var Ch={readContext:fn,use:Ig,useCallback:ys,useContext:ys,useEffect:ys,useImperativeHandle:ys,useLayoutEffect:ys,useInsertionEffect:ys,useMemo:ys,useReducer:ys,useRef:ys,useState:ys,useDebugValue:ys,useDeferredValue:ys,useTransition:ys,useSyncExternalStore:ys,useId:ys,useHostTransitionStatus:ys,useFormState:ys,useActionState:ys,useOptimistic:ys,useMemoCache:ys,useCacheRefresh:ys};Ch.useEffectEvent=ys;var mN={readContext:fn,use:Ig,useCallback:function(i,o){return Un().memoizedState=[i,o===void 0?null:o],i},useContext:fn,useEffect:J1,useImperativeHandle:function(i,o,u){u=u!=null?u.concat([i]):null,kg(4194308,4,tN.bind(null,o,i),u)},useLayoutEffect:function(i,o){return kg(4194308,4,i,o)},useInsertionEffect:function(i,o){kg(4,2,i,o)},useMemo:function(i,o){var u=Un();o=o===void 0?null:o;var h=i();if(Vl){he(!0);try{i()}finally{he(!1)}}return u.memoizedState=[h,o],h},useReducer:function(i,o,u){var h=Un();if(u!==void 0){var p=u(o);if(Vl){he(!0);try{u(o)}finally{he(!1)}}}else p=o;return h.memoizedState=h.baseState=p,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:p},h.queue=i,i=i.dispatch=d3.bind(null,mt,i),[h.memoizedState,i]},useRef:function(i){var o=Un();return i={current:i},o.memoizedState=i},useState:function(i){i=db(i);var o=i.queue,u=dN.bind(null,mt,o);return o.dispatch=u,[i.memoizedState,u]},useDebugValue:mb,useDeferredValue:function(i,o){var u=Un();return gb(u,i,o)},useTransition:function(){var i=db(!1);return i=iN.bind(null,mt,i.queue,!0,!1),Un().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,u){var h=mt,p=Un();if(It){if(u===void 0)throw Error(n(407));u=u()}else{if(u=o(),Xt===null)throw Error(n(349));(St&127)!==0||P1(h,o,u)}p.memoizedState=u;var b={value:u,getSnapshot:o};return p.queue=b,J1(L1.bind(null,h,b,i),[i]),h.flags|=2048,gu(9,{destroy:void 0},M1.bind(null,h,b,u,o),null),u},useId:function(){var i=Un(),o=Xt.identifierPrefix;if(It){var u=Ua,h=Va;u=(h&~(1<<32-Me(h)-1)).toString(32)+u,o="_"+o+"R_"+u,u=Tg++,0<u&&(o+="H"+u.toString(32)),o+="_"}else u=r3++,o="_"+o+"r_"+u.toString(32)+"_";return i.memoizedState=o},useHostTransitionStatus:xb,useFormState:G1,useActionState:G1,useOptimistic:function(i){var o=Un();o.memoizedState=o.baseState=i;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=bb.bind(null,mt,!0,u),u.dispatch=o,[i,o]},useMemoCache:lb,useCacheRefresh:function(){return Un().memoizedState=u3.bind(null,mt)},useEffectEvent:function(i){var o=Un(),u={impl:i};return o.memoizedState=u,function(){if((Ot&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}},yb={readContext:fn,use:Ig,useCallback:nN,useContext:fn,useEffect:fb,useImperativeHandle:sN,useInsertionEffect:Z1,useLayoutEffect:eN,useMemo:rN,useReducer:Ag,useRef:Y1,useState:function(){return Ag(xi)},useDebugValue:mb,useDeferredValue:function(i,o){var u=Es();return aN(u,Kt.memoizedState,i,o)},useTransition:function(){var i=Ag(xi)[0],o=Es().memoizedState;return[typeof i=="boolean"?i:Ah(i),o]},useSyncExternalStore:O1,useId:cN,useHostTransitionStatus:xb,useFormState:W1,useActionState:W1,useOptimistic:function(i,o){var u=Es();return F1(u,Kt,i,o)},useMemoCache:lb,useCacheRefresh:uN};yb.useEffectEvent=X1;var gN={readContext:fn,use:Ig,useCallback:nN,useContext:fn,useEffect:fb,useImperativeHandle:sN,useInsertionEffect:Z1,useLayoutEffect:eN,useMemo:rN,useReducer:ub,useRef:Y1,useState:function(){return ub(xi)},useDebugValue:mb,useDeferredValue:function(i,o){var u=Es();return Kt===null?gb(u,i,o):aN(u,Kt.memoizedState,i,o)},useTransition:function(){var i=ub(xi)[0],o=Es().memoizedState;return[typeof i=="boolean"?i:Ah(i),o]},useSyncExternalStore:O1,useId:cN,useHostTransitionStatus:xb,useFormState:Q1,useActionState:Q1,useOptimistic:function(i,o){var u=Es();return Kt!==null?F1(u,Kt,i,o):(u.baseState=i,[i,u.queue.dispatch])},useMemoCache:lb,useCacheRefresh:uN};gN.useEffectEvent=X1;function wb(i,o,u,h){o=i.memoizedState,u=u(h,o),u=u==null?o:y({},o,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var vb={enqueueSetState:function(i,o,u){i=i._reactInternals;var h=_r(),p=go(h);p.payload=o,u!=null&&(p.callback=u),o=po(i,p,h),o!==null&&(sr(o,i,h),Sh(o,i,h))},enqueueReplaceState:function(i,o,u){i=i._reactInternals;var h=_r(),p=go(h);p.tag=1,p.payload=o,u!=null&&(p.callback=u),o=po(i,p,h),o!==null&&(sr(o,i,h),Sh(o,i,h))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var u=_r(),h=go(u);h.tag=2,o!=null&&(h.callback=o),o=po(i,h,u),o!==null&&(sr(o,i,u),Sh(o,i,u))}};function pN(i,o,u,h,p,b,A){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,b,A):o.prototype&&o.prototype.isPureReactComponent?!xh(u,h)||!xh(p,b):!0}function xN(i,o,u,h){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,h),o.state!==i&&vb.enqueueReplaceState(o,o.state,null)}function Ul(i,o){var u=o;if("ref"in o){u={};for(var h in o)h!=="ref"&&(u[h]=o[h])}if(i=i.defaultProps){u===o&&(u=y({},u));for(var p in i)u[p]===void 0&&(u[p]=i[p])}return u}function bN(i){ug(i)}function yN(i){console.error(i)}function wN(i){ug(i)}function Dg(i,o){try{var u=i.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(h){setTimeout(function(){throw h})}}function vN(i,o,u){try{var h=i.onCaughtError;h(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function _b(i,o,u){return u=go(u),u.tag=3,u.payload={element:null},u.callback=function(){Dg(i,o)},u}function _N(i){return i=go(i),i.tag=3,i}function jN(i,o,u,h){var p=u.type.getDerivedStateFromError;if(typeof p=="function"){var b=h.value;i.payload=function(){return p(b)},i.callback=function(){vN(o,u,h)}}var A=u.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(i.callback=function(){vN(o,u,h),typeof p!="function"&&(_o===null?_o=new Set([this]):_o.add(this));var $=h.stack;this.componentDidCatch(h.value,{componentStack:$!==null?$:""})})}function h3(i,o,u,h,p){if(u.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(o=u.alternate,o!==null&&ou(o,u,p,!0),u=br.current,u!==null){switch(u.tag){case 31:case 13:return qr===null?Hg():u.alternate===null&&ws===0&&(ws=3),u.flags&=-257,u.flags|=65536,u.lanes=p,h===wg?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([h]):o.add(h),Wb(i,h,p)),!1;case 22:return u.flags|=65536,h===wg?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([h])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([h]):u.add(h)),Wb(i,h,p)),!1}throw Error(n(435,u.tag))}return Wb(i,h,p),Hg(),!1}if(It)return o=br.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=p,h!==$x&&(i=Error(n(422),{cause:h}),wh(Fr(i,u)))):(h!==$x&&(o=Error(n(423),{cause:h}),wh(Fr(o,u))),i=i.current.alternate,i.flags|=65536,p&=-p,i.lanes|=p,h=Fr(h,u),p=_b(i.stateNode,h,p),Xx(i,p),ws!==4&&(ws=2)),!1;var b=Error(n(520),{cause:h});if(b=Fr(b,u),Uh===null?Uh=[b]:Uh.push(b),ws!==4&&(ws=2),o===null)return!0;h=Fr(h,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,i=p&-p,u.lanes|=i,i=_b(u.stateNode,h,i),Xx(u,i),!1;case 1:if(o=u.type,b=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(_o===null||!_o.has(b))))return u.flags|=65536,p&=-p,u.lanes|=p,p=_N(p),jN(p,i,u,h),Xx(u,p),!1}u=u.return}while(u!==null);return!1}var jb=Error(n(461)),Us=!1;function mn(i,o,u,h){o.child=i===null?E1(o,null,u,h):Ll(o,i.child,u,h)}function NN(i,o,u,h,p){u=u.render;var b=o.ref;if("ref"in h){var A={};for(var $ in h)$!=="ref"&&(A[$]=h[$])}else A=h;return Dl(o),h=rb(i,o,u,A,b,p),$=ab(),i!==null&&!Us?(ib(i,o,p),bi(i,o,p)):(It&&$&&Ux(o),o.flags|=1,mn(i,o,h,p),o.child)}function SN(i,o,u,h,p){if(i===null){var b=u.type;return typeof b=="function"&&!Mx(b)&&b.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=b,TN(i,o,b,h,p)):(i=mg(u.type,null,h,o,o.mode,p),i.ref=o.ref,i.return=o,o.child=i)}if(b=i.child,!Cb(i,p)){var A=b.memoizedProps;if(u=u.compare,u=u!==null?u:xh,u(A,h)&&i.ref===o.ref)return bi(i,o,p)}return o.flags|=1,i=hi(b,h),i.ref=o.ref,i.return=o,o.child=i}function TN(i,o,u,h,p){if(i!==null){var b=i.memoizedProps;if(xh(b,h)&&i.ref===o.ref)if(Us=!1,o.pendingProps=h=b,Cb(i,p))(i.flags&131072)!==0&&(Us=!0);else return o.lanes=i.lanes,bi(i,o,p)}return Nb(i,o,u,h,p)}function EN(i,o,u,h){var p=h.children,b=i!==null?i.memoizedState:null;if(i===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((o.flags&128)!==0){if(b=b!==null?b.baseLanes|u:u,i!==null){for(h=o.child=i.child,p=0;h!==null;)p=p|h.lanes|h.childLanes,h=h.sibling;h=p&~b}else h=0,o.child=null;return IN(i,o,b,u,h)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&bg(o,b!==null?b.cachePool:null),b!==null?k1(o,b):eb(),C1(o);else return h=o.lanes=536870912,IN(i,o,b!==null?b.baseLanes|u:u,u,h)}else b!==null?(bg(o,b.cachePool),k1(o,b),bo(),o.memoizedState=null):(i!==null&&bg(o,null),eb(),bo());return mn(i,o,p,u),o.child}function Rh(i,o){return i!==null&&i.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function IN(i,o,u,h,p){var b=Kx();return b=b===null?null:{parent:Ls._currentValue,pool:b},o.memoizedState={baseLanes:u,cachePool:b},i!==null&&bg(o,null),eb(),C1(o),i!==null&&ou(i,o,h,!0),o.childLanes=p,null}function Og(i,o){return o=Mg({mode:o.mode,children:o.children},i.mode),o.ref=i.ref,i.child=o,o.return=i,o}function AN(i,o,u){return Ll(o,i.child,null,u),i=Og(o,o.pendingProps),i.flags|=2,yr(o),o.memoizedState=null,i}function f3(i,o,u){var h=o.pendingProps,p=(o.flags&128)!==0;if(o.flags&=-129,i===null){if(It){if(h.mode==="hidden")return i=Og(o,h),o.lanes=536870912,Rh(null,i);if(sb(o),(i=ns)?(i=$2(i,zr),i=i!==null&&i.data==="&"?i:null,i!==null&&(o.memoizedState={dehydrated:i,treeContext:co!==null?{id:Va,overflow:Ua}:null,retryLane:536870912,hydrationErrors:null},u=h1(i),u.return=o,o.child=u,hn=o,ns=null)):i=null,i===null)throw ho(o);return o.lanes=536870912,null}return Og(o,h)}var b=i.memoizedState;if(b!==null){var A=b.dehydrated;if(sb(o),p)if(o.flags&256)o.flags&=-257,o=AN(i,o,u);else if(o.memoizedState!==null)o.child=i.child,o.flags|=128,o=null;else throw Error(n(558));else if(Us||ou(i,o,u,!1),p=(u&i.childLanes)!==0,Us||p){if(h=Xt,h!==null&&(A=Zd(h,u),A!==0&&A!==b.retryLane))throw b.retryLane=A,Al(i,A),sr(h,i,A),jb;Hg(),o=AN(i,o,u)}else i=b.treeContext,ns=Hr(A.nextSibling),hn=o,It=!0,uo=null,zr=!1,i!==null&&g1(o,i),o=Og(o,h),o.flags|=4096;return o}return i=hi(i.child,{mode:h.mode,children:h.children}),i.ref=o.ref,o.child=i,i.return=o,i}function Pg(i,o){var u=o.ref;if(u===null)i!==null&&i.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(i===null||i.ref!==u)&&(o.flags|=4194816)}}function Nb(i,o,u,h,p){return Dl(o),u=rb(i,o,u,h,void 0,p),h=ab(),i!==null&&!Us?(ib(i,o,p),bi(i,o,p)):(It&&h&&Ux(o),o.flags|=1,mn(i,o,u,p),o.child)}function kN(i,o,u,h,p,b){return Dl(o),o.updateQueue=null,u=D1(o,h,u,p),R1(i),h=ab(),i!==null&&!Us?(ib(i,o,b),bi(i,o,b)):(It&&h&&Ux(o),o.flags|=1,mn(i,o,u,b),o.child)}function CN(i,o,u,h,p){if(Dl(o),o.stateNode===null){var b=nu,A=u.contextType;typeof A=="object"&&A!==null&&(b=fn(A)),b=new u(h,b),o.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=vb,o.stateNode=b,b._reactInternals=o,b=o.stateNode,b.props=h,b.state=o.memoizedState,b.refs={},Yx(o),A=u.contextType,b.context=typeof A=="object"&&A!==null?fn(A):nu,b.state=o.memoizedState,A=u.getDerivedStateFromProps,typeof A=="function"&&(wb(o,u,A,h),b.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(A=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),A!==b.state&&vb.enqueueReplaceState(b,b.state,null),Eh(o,h,b,p),Th(),b.state=o.memoizedState),typeof b.componentDidMount=="function"&&(o.flags|=4194308),h=!0}else if(i===null){b=o.stateNode;var $=o.memoizedProps,Z=Ul(u,$);b.props=Z;var le=b.context,ve=u.contextType;A=nu,typeof ve=="object"&&ve!==null&&(A=fn(ve));var Ee=u.getDerivedStateFromProps;ve=typeof Ee=="function"||typeof b.getSnapshotBeforeUpdate=="function",$=o.pendingProps!==$,ve||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||($||le!==A)&&xN(o,b,h,A),mo=!1;var de=o.memoizedState;b.state=de,Eh(o,h,b,p),Th(),le=o.memoizedState,$||de!==le||mo?(typeof Ee=="function"&&(wb(o,u,Ee,h),le=o.memoizedState),(Z=mo||pN(o,u,Z,h,de,le,A))?(ve||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(o.flags|=4194308)):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=le),b.props=h,b.state=le,b.context=A,h=Z):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{b=o.stateNode,Jx(i,o),A=o.memoizedProps,ve=Ul(u,A),b.props=ve,Ee=o.pendingProps,de=b.context,le=u.contextType,Z=nu,typeof le=="object"&&le!==null&&(Z=fn(le)),$=u.getDerivedStateFromProps,(le=typeof $=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(A!==Ee||de!==Z)&&xN(o,b,h,Z),mo=!1,de=o.memoizedState,b.state=de,Eh(o,h,b,p),Th();var xe=o.memoizedState;A!==Ee||de!==xe||mo||i!==null&&i.dependencies!==null&&pg(i.dependencies)?(typeof $=="function"&&(wb(o,u,$,h),xe=o.memoizedState),(ve=mo||pN(o,u,ve,h,de,xe,Z)||i!==null&&i.dependencies!==null&&pg(i.dependencies))?(le||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(h,xe,Z),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(h,xe,Z)),typeof b.componentDidUpdate=="function"&&(o.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof b.componentDidUpdate!="function"||A===i.memoizedProps&&de===i.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&de===i.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=xe),b.props=h,b.state=xe,b.context=Z,h=ve):(typeof b.componentDidUpdate!="function"||A===i.memoizedProps&&de===i.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&de===i.memoizedState||(o.flags|=1024),h=!1)}return b=h,Pg(i,o),h=(o.flags&128)!==0,b||h?(b=o.stateNode,u=h&&typeof u.getDerivedStateFromError!="function"?null:b.render(),o.flags|=1,i!==null&&h?(o.child=Ll(o,i.child,null,p),o.child=Ll(o,null,u,p)):mn(i,o,u,p),o.memoizedState=b.state,i=o.child):i=bi(i,o,p),i}function RN(i,o,u,h){return Cl(),o.flags|=256,mn(i,o,u,h),o.child}var Sb={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Tb(i){return{baseLanes:i,cachePool:v1()}}function Eb(i,o,u){return i=i!==null?i.childLanes&~u:0,o&&(i|=vr),i}function DN(i,o,u){var h=o.pendingProps,p=!1,b=(o.flags&128)!==0,A;if((A=b)||(A=i!==null&&i.memoizedState===null?!1:(Ts.current&2)!==0),A&&(p=!0,o.flags&=-129),A=(o.flags&32)!==0,o.flags&=-33,i===null){if(It){if(p?xo(o):bo(),(i=ns)?(i=$2(i,zr),i=i!==null&&i.data!=="&"?i:null,i!==null&&(o.memoizedState={dehydrated:i,treeContext:co!==null?{id:Va,overflow:Ua}:null,retryLane:536870912,hydrationErrors:null},u=h1(i),u.return=o,o.child=u,hn=o,ns=null)):i=null,i===null)throw ho(o);return cy(i)?o.lanes=32:o.lanes=536870912,null}var $=h.children;return h=h.fallback,p?(bo(),p=o.mode,$=Mg({mode:"hidden",children:$},p),h=kl(h,p,u,null),$.return=o,h.return=o,$.sibling=h,o.child=$,h=o.child,h.memoizedState=Tb(u),h.childLanes=Eb(i,A,u),o.memoizedState=Sb,Rh(null,h)):(xo(o),Ib(o,$))}var Z=i.memoizedState;if(Z!==null&&($=Z.dehydrated,$!==null)){if(b)o.flags&256?(xo(o),o.flags&=-257,o=Ab(i,o,u)):o.memoizedState!==null?(bo(),o.child=i.child,o.flags|=128,o=null):(bo(),$=h.fallback,p=o.mode,h=Mg({mode:"visible",children:h.children},p),$=kl($,p,u,null),$.flags|=2,h.return=o,$.return=o,h.sibling=$,o.child=h,Ll(o,i.child,null,u),h=o.child,h.memoizedState=Tb(u),h.childLanes=Eb(i,A,u),o.memoizedState=Sb,o=Rh(null,h));else if(xo(o),cy($)){if(A=$.nextSibling&&$.nextSibling.dataset,A)var le=A.dgst;A=le,h=Error(n(419)),h.stack="",h.digest=A,wh({value:h,source:null,stack:null}),o=Ab(i,o,u)}else if(Us||ou(i,o,u,!1),A=(u&i.childLanes)!==0,Us||A){if(A=Xt,A!==null&&(h=Zd(A,u),h!==0&&h!==Z.retryLane))throw Z.retryLane=h,Al(i,h),sr(A,i,h),jb;ly($)||Hg(),o=Ab(i,o,u)}else ly($)?(o.flags|=192,o.child=i.child,o=null):(i=Z.treeContext,ns=Hr($.nextSibling),hn=o,It=!0,uo=null,zr=!1,i!==null&&g1(o,i),o=Ib(o,h.children),o.flags|=4096);return o}return p?(bo(),$=h.fallback,p=o.mode,Z=i.child,le=Z.sibling,h=hi(Z,{mode:"hidden",children:h.children}),h.subtreeFlags=Z.subtreeFlags&65011712,le!==null?$=hi(le,$):($=kl($,p,u,null),$.flags|=2),$.return=o,h.return=o,h.sibling=$,o.child=h,Rh(null,h),h=o.child,$=i.child.memoizedState,$===null?$=Tb(u):(p=$.cachePool,p!==null?(Z=Ls._currentValue,p=p.parent!==Z?{parent:Z,pool:Z}:p):p=v1(),$={baseLanes:$.baseLanes|u,cachePool:p}),h.memoizedState=$,h.childLanes=Eb(i,A,u),o.memoizedState=Sb,Rh(i.child,h)):(xo(o),u=i.child,i=u.sibling,u=hi(u,{mode:"visible",children:h.children}),u.return=o,u.sibling=null,i!==null&&(A=o.deletions,A===null?(o.deletions=[i],o.flags|=16):A.push(i)),o.child=u,o.memoizedState=null,u)}function Ib(i,o){return o=Mg({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function Mg(i,o){return i=xr(22,i,null,o),i.lanes=0,i}function Ab(i,o,u){return Ll(o,i.child,null,u),i=Ib(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function ON(i,o,u){i.lanes|=o;var h=i.alternate;h!==null&&(h.lanes|=o),qx(i.return,o,u)}function kb(i,o,u,h,p,b){var A=i.memoizedState;A===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:u,tailMode:p,treeForkCount:b}:(A.isBackwards=o,A.rendering=null,A.renderingStartTime=0,A.last=h,A.tail=u,A.tailMode=p,A.treeForkCount=b)}function PN(i,o,u){var h=o.pendingProps,p=h.revealOrder,b=h.tail;h=h.children;var A=Ts.current,$=(A&2)!==0;if($?(A=A&1|2,o.flags|=128):A&=1,ee(Ts,A),mn(i,o,h,u),h=It?yh:0,!$&&i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&ON(i,u,o);else if(i.tag===19)ON(i,u,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(p){case"forwards":for(u=o.child,p=null;u!==null;)i=u.alternate,i!==null&&Ng(i)===null&&(p=u),u=u.sibling;u=p,u===null?(p=o.child,o.child=null):(p=u.sibling,u.sibling=null),kb(o,!1,p,u,b,h);break;case"backwards":case"unstable_legacy-backwards":for(u=null,p=o.child,o.child=null;p!==null;){if(i=p.alternate,i!==null&&Ng(i)===null){o.child=p;break}i=p.sibling,p.sibling=u,u=p,p=i}kb(o,!0,u,null,b,h);break;case"together":kb(o,!1,null,null,void 0,h);break;default:o.memoizedState=null}return o.child}function bi(i,o,u){if(i!==null&&(o.dependencies=i.dependencies),vo|=o.lanes,(u&o.childLanes)===0)if(i!==null){if(ou(i,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(n(153));if(o.child!==null){for(i=o.child,u=hi(i,i.pendingProps),o.child=u,u.return=o;i.sibling!==null;)i=i.sibling,u=u.sibling=hi(i,i.pendingProps),u.return=o;u.sibling=null}return o.child}function Cb(i,o){return(i.lanes&o)!==0?!0:(i=i.dependencies,!!(i!==null&&pg(i)))}function m3(i,o,u){switch(o.tag){case 3:Te(o,o.stateNode.containerInfo),fo(o,Ls,i.memoizedState.cache),Cl();break;case 27:case 5:ye(o);break;case 4:Te(o,o.stateNode.containerInfo);break;case 10:fo(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,sb(o),null;break;case 13:var h=o.memoizedState;if(h!==null)return h.dehydrated!==null?(xo(o),o.flags|=128,null):(u&o.child.childLanes)!==0?DN(i,o,u):(xo(o),i=bi(i,o,u),i!==null?i.sibling:null);xo(o);break;case 19:var p=(i.flags&128)!==0;if(h=(u&o.childLanes)!==0,h||(ou(i,o,u,!1),h=(u&o.childLanes)!==0),p){if(h)return PN(i,o,u);o.flags|=128}if(p=o.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),ee(Ts,Ts.current),h)break;return null;case 22:return o.lanes=0,EN(i,o,u,o.pendingProps);case 24:fo(o,Ls,i.memoizedState.cache)}return bi(i,o,u)}function MN(i,o,u){if(i!==null)if(i.memoizedProps!==o.pendingProps)Us=!0;else{if(!Cb(i,u)&&(o.flags&128)===0)return Us=!1,m3(i,o,u);Us=(i.flags&131072)!==0}else Us=!1,It&&(o.flags&1048576)!==0&&m1(o,yh,o.index);switch(o.lanes=0,o.tag){case 16:e:{var h=o.pendingProps;if(i=Pl(o.elementType),o.type=i,typeof i=="function")Mx(i)?(h=Ul(i,h),o.tag=1,o=CN(null,o,i,h,u)):(o.tag=0,o=Nb(null,o,i,h,u));else{if(i!=null){var p=i.$$typeof;if(p===q){o.tag=11,o=NN(null,o,i,h,u);break e}else if(p===k){o.tag=14,o=SN(null,o,i,h,u);break e}}throw o=Y(i)||i,Error(n(306,o,""))}}return o;case 0:return Nb(i,o,o.type,o.pendingProps,u);case 1:return h=o.type,p=Ul(h,o.pendingProps),CN(i,o,h,p,u);case 3:e:{if(Te(o,o.stateNode.containerInfo),i===null)throw Error(n(387));h=o.pendingProps;var b=o.memoizedState;p=b.element,Jx(i,o),Eh(o,h,null,u);var A=o.memoizedState;if(h=A.cache,fo(o,Ls,h),h!==b.cache&&Hx(o,[Ls],u,!0),Th(),h=A.element,b.isDehydrated)if(b={element:h,isDehydrated:!1,cache:A.cache},o.updateQueue.baseState=b,o.memoizedState=b,o.flags&256){o=RN(i,o,h,u);break e}else if(h!==p){p=Fr(Error(n(424)),o),wh(p),o=RN(i,o,h,u);break e}else{switch(i=o.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(ns=Hr(i.firstChild),hn=o,It=!0,uo=null,zr=!0,u=E1(o,null,h,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Cl(),h===p){o=bi(i,o,u);break e}mn(i,o,h,u)}o=o.child}return o;case 26:return Pg(i,o),i===null?(u=W2(o.type,null,o.pendingProps,null))?o.memoizedState=u:It||(u=o.type,i=o.pendingProps,h=Xg(se.current).createElement(u),h[Os]=o,h[en]=i,gn(h,u,i),Ps(h),o.stateNode=h):o.memoizedState=W2(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return ye(o),i===null&&It&&(h=o.stateNode=q2(o.type,o.pendingProps,se.current),hn=o,zr=!0,p=ns,To(o.type)?(uy=p,ns=Hr(h.firstChild)):ns=p),mn(i,o,o.pendingProps.children,u),Pg(i,o),i===null&&(o.flags|=4194304),o.child;case 5:return i===null&&It&&((p=h=ns)&&(h=q3(h,o.type,o.pendingProps,zr),h!==null?(o.stateNode=h,hn=o,ns=Hr(h.firstChild),zr=!1,p=!0):p=!1),p||ho(o)),ye(o),p=o.type,b=o.pendingProps,A=i!==null?i.memoizedProps:null,h=b.children,ay(p,b)?h=null:A!==null&&ay(p,A)&&(o.flags|=32),o.memoizedState!==null&&(p=rb(i,o,a3,null,null,u),Wh._currentValue=p),Pg(i,o),mn(i,o,h,u),o.child;case 6:return i===null&&It&&((i=u=ns)&&(u=H3(u,o.pendingProps,zr),u!==null?(o.stateNode=u,hn=o,ns=null,i=!0):i=!1),i||ho(o)),null;case 13:return DN(i,o,u);case 4:return Te(o,o.stateNode.containerInfo),h=o.pendingProps,i===null?o.child=Ll(o,null,h,u):mn(i,o,h,u),o.child;case 11:return NN(i,o,o.type,o.pendingProps,u);case 7:return mn(i,o,o.pendingProps,u),o.child;case 8:return mn(i,o,o.pendingProps.children,u),o.child;case 12:return mn(i,o,o.pendingProps.children,u),o.child;case 10:return h=o.pendingProps,fo(o,o.type,h.value),mn(i,o,h.children,u),o.child;case 9:return p=o.type._context,h=o.pendingProps.children,Dl(o),p=fn(p),h=h(p),o.flags|=1,mn(i,o,h,u),o.child;case 14:return SN(i,o,o.type,o.pendingProps,u);case 15:return TN(i,o,o.type,o.pendingProps,u);case 19:return PN(i,o,u);case 31:return f3(i,o,u);case 22:return EN(i,o,u,o.pendingProps);case 24:return Dl(o),h=fn(Ls),i===null?(p=Kx(),p===null&&(p=Xt,b=Gx(),p.pooledCache=b,b.refCount++,b!==null&&(p.pooledCacheLanes|=u),p=b),o.memoizedState={parent:h,cache:p},Yx(o),fo(o,Ls,p)):((i.lanes&u)!==0&&(Jx(i,o),Eh(o,null,null,u),Th()),p=i.memoizedState,b=o.memoizedState,p.parent!==h?(p={parent:h,cache:h},o.memoizedState=p,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=p),fo(o,Ls,h)):(h=b.cache,fo(o,Ls,h),h!==p.cache&&Hx(o,[Ls],u,!0))),mn(i,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function yi(i){i.flags|=4}function Rb(i,o,u,h,p){if((o=(i.mode&32)!==0)&&(o=!1),o){if(i.flags|=16777216,(p&335544128)===p)if(i.stateNode.complete)i.flags|=8192;else if(c2())i.flags|=8192;else throw Ml=wg,Qx}else i.flags&=-16777217}function LN(i,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!X2(o))if(c2())i.flags|=8192;else throw Ml=wg,Qx}function Lg(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?gl():536870912,i.lanes|=o,yu|=o)}function Dh(i,o){if(!It)switch(i.tailMode){case"hidden":o=i.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function rs(i){var o=i.alternate!==null&&i.alternate.child===i.child,u=0,h=0;if(o)for(var p=i.child;p!==null;)u|=p.lanes|p.childLanes,h|=p.subtreeFlags&65011712,h|=p.flags&65011712,p.return=i,p=p.sibling;else for(p=i.child;p!==null;)u|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=i,p=p.sibling;return i.subtreeFlags|=h,i.childLanes=u,o}function g3(i,o,u){var h=o.pendingProps;switch(Fx(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rs(o),null;case 1:return rs(o),null;case 3:return u=o.stateNode,h=null,i!==null&&(h=i.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),gi(Ls),be(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(i===null||i.child===null)&&(iu(o)?yi(o):i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Bx())),rs(o),null;case 26:var p=o.type,b=o.memoizedState;return i===null?(yi(o),b!==null?(rs(o),LN(o,b)):(rs(o),Rb(o,p,null,h,u))):b?b!==i.memoizedState?(yi(o),rs(o),LN(o,b)):(rs(o),o.flags&=-16777217):(i=i.memoizedProps,i!==h&&yi(o),rs(o),Rb(o,p,i,h,u)),null;case 27:if(et(o),u=se.current,p=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==h&&yi(o);else{if(!h){if(o.stateNode===null)throw Error(n(166));return rs(o),null}i=ne.current,iu(o)?p1(o):(i=q2(p,h,u),o.stateNode=i,yi(o))}return rs(o),null;case 5:if(et(o),p=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==h&&yi(o);else{if(!h){if(o.stateNode===null)throw Error(n(166));return rs(o),null}if(b=ne.current,iu(o))p1(o);else{var A=Xg(se.current);switch(b){case 1:b=A.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:b=A.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":b=A.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":b=A.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":b=A.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild);break;case"select":b=typeof h.is=="string"?A.createElement("select",{is:h.is}):A.createElement("select"),h.multiple?b.multiple=!0:h.size&&(b.size=h.size);break;default:b=typeof h.is=="string"?A.createElement(p,{is:h.is}):A.createElement(p)}}b[Os]=o,b[en]=h;e:for(A=o.child;A!==null;){if(A.tag===5||A.tag===6)b.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===o)break e;for(;A.sibling===null;){if(A.return===null||A.return===o)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}o.stateNode=b;e:switch(gn(b,p,h),p){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&yi(o)}}return rs(o),Rb(o,o.type,i===null?null:i.memoizedProps,o.pendingProps,u),null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==h&&yi(o);else{if(typeof h!="string"&&o.stateNode===null)throw Error(n(166));if(i=se.current,iu(o)){if(i=o.stateNode,u=o.memoizedProps,h=null,p=hn,p!==null)switch(p.tag){case 27:case 5:h=p.memoizedProps}i[Os]=o,i=!!(i.nodeValue===u||h!==null&&h.suppressHydrationWarning===!0||D2(i.nodeValue,u)),i||ho(o,!0)}else i=Xg(i).createTextNode(h),i[Os]=o,o.stateNode=i}return rs(o),null;case 31:if(u=o.memoizedState,i===null||i.memoizedState!==null){if(h=iu(o),u!==null){if(i===null){if(!h)throw Error(n(318));if(i=o.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(557));i[Os]=o}else Cl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;rs(o),i=!1}else u=Bx(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=u),i=!0;if(!i)return o.flags&256?(yr(o),o):(yr(o),null);if((o.flags&128)!==0)throw Error(n(558))}return rs(o),null;case 13:if(h=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(p=iu(o),h!==null&&h.dehydrated!==null){if(i===null){if(!p)throw Error(n(318));if(p=o.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(n(317));p[Os]=o}else Cl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;rs(o),p=!1}else p=Bx(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=p),p=!0;if(!p)return o.flags&256?(yr(o),o):(yr(o),null)}return yr(o),(o.flags&128)!==0?(o.lanes=u,o):(u=h!==null,i=i!==null&&i.memoizedState!==null,u&&(h=o.child,p=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(p=h.alternate.memoizedState.cachePool.pool),b=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(b=h.memoizedState.cachePool.pool),b!==p&&(h.flags|=2048)),u!==i&&u&&(o.child.flags|=8192),Lg(o,o.updateQueue),rs(o),null);case 4:return be(),i===null&&ey(o.stateNode.containerInfo),rs(o),null;case 10:return gi(o.type),rs(o),null;case 19:if(G(Ts),h=o.memoizedState,h===null)return rs(o),null;if(p=(o.flags&128)!==0,b=h.rendering,b===null)if(p)Dh(h,!1);else{if(ws!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(b=Ng(i),b!==null){for(o.flags|=128,Dh(h,!1),i=b.updateQueue,o.updateQueue=i,Lg(o,i),o.subtreeFlags=0,i=u,u=o.child;u!==null;)d1(u,i),u=u.sibling;return ee(Ts,Ts.current&1|2),It&&fi(o,h.treeForkCount),o.child}i=i.sibling}h.tail!==null&&Le()>Bg&&(o.flags|=128,p=!0,Dh(h,!1),o.lanes=4194304)}else{if(!p)if(i=Ng(b),i!==null){if(o.flags|=128,p=!0,i=i.updateQueue,o.updateQueue=i,Lg(o,i),Dh(h,!0),h.tail===null&&h.tailMode==="hidden"&&!b.alternate&&!It)return rs(o),null}else 2*Le()-h.renderingStartTime>Bg&&u!==536870912&&(o.flags|=128,p=!0,Dh(h,!1),o.lanes=4194304);h.isBackwards?(b.sibling=o.child,o.child=b):(i=h.last,i!==null?i.sibling=b:o.child=b,h.last=b)}return h.tail!==null?(i=h.tail,h.rendering=i,h.tail=i.sibling,h.renderingStartTime=Le(),i.sibling=null,u=Ts.current,ee(Ts,p?u&1|2:u&1),It&&fi(o,h.treeForkCount),i):(rs(o),null);case 22:case 23:return yr(o),tb(),h=o.memoizedState!==null,i!==null?i.memoizedState!==null!==h&&(o.flags|=8192):h&&(o.flags|=8192),h?(u&536870912)!==0&&(o.flags&128)===0&&(rs(o),o.subtreeFlags&6&&(o.flags|=8192)):rs(o),u=o.updateQueue,u!==null&&Lg(o,u.retryQueue),u=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),h=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),h!==u&&(o.flags|=2048),i!==null&&G(Ol),null;case 24:return u=null,i!==null&&(u=i.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),gi(Ls),rs(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function p3(i,o){switch(Fx(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return gi(Ls),be(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return et(o),null;case 31:if(o.memoizedState!==null){if(yr(o),o.alternate===null)throw Error(n(340));Cl()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 13:if(yr(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(n(340));Cl()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return G(Ts),null;case 4:return be(),null;case 10:return gi(o.type),null;case 22:case 23:return yr(o),tb(),i!==null&&G(Ol),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return gi(Ls),null;case 25:return null;default:return null}}function VN(i,o){switch(Fx(o),o.tag){case 3:gi(Ls),be();break;case 26:case 27:case 5:et(o);break;case 4:be();break;case 31:o.memoizedState!==null&&yr(o);break;case 13:yr(o);break;case 19:G(Ts);break;case 10:gi(o.type);break;case 22:case 23:yr(o),tb(),i!==null&&G(Ol);break;case 24:gi(Ls)}}function Oh(i,o){try{var u=o.updateQueue,h=u!==null?u.lastEffect:null;if(h!==null){var p=h.next;u=p;do{if((u.tag&i)===i){h=void 0;var b=u.create,A=u.inst;h=b(),A.destroy=h}u=u.next}while(u!==p)}}catch($){Ft(o,o.return,$)}}function yo(i,o,u){try{var h=o.updateQueue,p=h!==null?h.lastEffect:null;if(p!==null){var b=p.next;h=b;do{if((h.tag&i)===i){var A=h.inst,$=A.destroy;if($!==void 0){A.destroy=void 0,p=o;var Z=u,le=$;try{le()}catch(ve){Ft(p,Z,ve)}}}h=h.next}while(h!==b)}}catch(ve){Ft(o,o.return,ve)}}function UN(i){var o=i.updateQueue;if(o!==null){var u=i.stateNode;try{A1(o,u)}catch(h){Ft(i,i.return,h)}}}function FN(i,o,u){u.props=Ul(i.type,i.memoizedProps),u.state=i.memoizedState;try{u.componentWillUnmount()}catch(h){Ft(i,o,h)}}function Ph(i,o){try{var u=i.ref;if(u!==null){switch(i.tag){case 26:case 27:case 5:var h=i.stateNode;break;case 30:h=i.stateNode;break;default:h=i.stateNode}typeof u=="function"?i.refCleanup=u(h):u.current=h}}catch(p){Ft(i,o,p)}}function Fa(i,o){var u=i.ref,h=i.refCleanup;if(u!==null)if(typeof h=="function")try{h()}catch(p){Ft(i,o,p)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(p){Ft(i,o,p)}else u.current=null}function $N(i){var o=i.type,u=i.memoizedProps,h=i.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&h.focus();break e;case"img":u.src?h.src=u.src:u.srcSet&&(h.srcset=u.srcSet)}}catch(p){Ft(i,i.return,p)}}function Db(i,o,u){try{var h=i.stateNode;V3(h,i.type,u,o),h[en]=o}catch(p){Ft(i,i.return,p)}}function BN(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&To(i.type)||i.tag===4}function Ob(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||BN(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&To(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Pb(i,o,u){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(i,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(i),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=sa));else if(h!==4&&(h===27&&To(i.type)&&(u=i.stateNode,o=null),i=i.child,i!==null))for(Pb(i,o,u),i=i.sibling;i!==null;)Pb(i,o,u),i=i.sibling}function Vg(i,o,u){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?u.insertBefore(i,o):u.appendChild(i);else if(h!==4&&(h===27&&To(i.type)&&(u=i.stateNode),i=i.child,i!==null))for(Vg(i,o,u),i=i.sibling;i!==null;)Vg(i,o,u),i=i.sibling}function zN(i){var o=i.stateNode,u=i.memoizedProps;try{for(var h=i.type,p=o.attributes;p.length;)o.removeAttributeNode(p[0]);gn(o,h,u),o[Os]=i,o[en]=u}catch(b){Ft(i,i.return,b)}}var wi=!1,Fs=!1,Mb=!1,qN=typeof WeakSet=="function"?WeakSet:Set,sn=null;function x3(i,o){if(i=i.containerInfo,ny=ap,i=s1(i),Ax(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var h=u.getSelection&&u.getSelection();if(h&&h.rangeCount!==0){u=h.anchorNode;var p=h.anchorOffset,b=h.focusNode;h=h.focusOffset;try{u.nodeType,b.nodeType}catch{u=null;break e}var A=0,$=-1,Z=-1,le=0,ve=0,Ee=i,de=null;t:for(;;){for(var xe;Ee!==u||p!==0&&Ee.nodeType!==3||($=A+p),Ee!==b||h!==0&&Ee.nodeType!==3||(Z=A+h),Ee.nodeType===3&&(A+=Ee.nodeValue.length),(xe=Ee.firstChild)!==null;)de=Ee,Ee=xe;for(;;){if(Ee===i)break t;if(de===u&&++le===p&&($=A),de===b&&++ve===h&&(Z=A),(xe=Ee.nextSibling)!==null)break;Ee=de,de=Ee.parentNode}Ee=xe}u=$===-1||Z===-1?null:{start:$,end:Z}}else u=null}u=u||{start:0,end:0}}else u=null;for(ry={focusedElem:i,selectionRange:u},ap=!1,sn=o;sn!==null;)if(o=sn,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,sn=i;else for(;sn!==null;){switch(o=sn,b=o.alternate,i=o.flags,o.tag){case 0:if((i&4)!==0&&(i=o.updateQueue,i=i!==null?i.events:null,i!==null))for(u=0;u<i.length;u++)p=i[u],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&b!==null){i=void 0,u=o,p=b.memoizedProps,b=b.memoizedState,h=u.stateNode;try{var He=Ul(u.type,p);i=h.getSnapshotBeforeUpdate(He,b),h.__reactInternalSnapshotBeforeUpdate=i}catch(ot){Ft(u,u.return,ot)}}break;case 3:if((i&1024)!==0){if(i=o.stateNode.containerInfo,u=i.nodeType,u===9)oy(i);else if(u===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":oy(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=o.sibling,i!==null){i.return=o.return,sn=i;break}sn=o.return}}function HN(i,o,u){var h=u.flags;switch(u.tag){case 0:case 11:case 15:_i(i,u),h&4&&Oh(5,u);break;case 1:if(_i(i,u),h&4)if(i=u.stateNode,o===null)try{i.componentDidMount()}catch(A){Ft(u,u.return,A)}else{var p=Ul(u.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(p,o,i.__reactInternalSnapshotBeforeUpdate)}catch(A){Ft(u,u.return,A)}}h&64&&UN(u),h&512&&Ph(u,u.return);break;case 3:if(_i(i,u),h&64&&(i=u.updateQueue,i!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{A1(i,o)}catch(A){Ft(u,u.return,A)}}break;case 27:o===null&&h&4&&zN(u);case 26:case 5:_i(i,u),o===null&&h&4&&$N(u),h&512&&Ph(u,u.return);break;case 12:_i(i,u);break;case 31:_i(i,u),h&4&&KN(i,u);break;case 13:_i(i,u),h&4&&QN(i,u),h&64&&(i=u.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(u=T3.bind(null,u),G3(i,u))));break;case 22:if(h=u.memoizedState!==null||wi,!h){o=o!==null&&o.memoizedState!==null||Fs,p=wi;var b=Fs;wi=h,(Fs=o)&&!b?ji(i,u,(u.subtreeFlags&8772)!==0):_i(i,u),wi=p,Fs=b}break;case 30:break;default:_i(i,u)}}function GN(i){var o=i.alternate;o!==null&&(i.alternate=null,GN(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&zc(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var us=null,Xn=!1;function vi(i,o,u){for(u=u.child;u!==null;)WN(i,o,u),u=u.sibling}function WN(i,o,u){if(Re&&typeof Re.onCommitFiberUnmount=="function")try{Re.onCommitFiberUnmount(pe,u)}catch{}switch(u.tag){case 26:Fs||Fa(u,o),vi(i,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Fs||Fa(u,o);var h=us,p=Xn;To(u.type)&&(us=u.stateNode,Xn=!1),vi(i,o,u),qh(u.stateNode),us=h,Xn=p;break;case 5:Fs||Fa(u,o);case 6:if(h=us,p=Xn,us=null,vi(i,o,u),us=h,Xn=p,us!==null)if(Xn)try{(us.nodeType===9?us.body:us.nodeName==="HTML"?us.ownerDocument.body:us).removeChild(u.stateNode)}catch(b){Ft(u,o,b)}else try{us.removeChild(u.stateNode)}catch(b){Ft(u,o,b)}break;case 18:us!==null&&(Xn?(i=us,U2(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,u.stateNode),Eu(i)):U2(us,u.stateNode));break;case 4:h=us,p=Xn,us=u.stateNode.containerInfo,Xn=!0,vi(i,o,u),us=h,Xn=p;break;case 0:case 11:case 14:case 15:yo(2,u,o),Fs||yo(4,u,o),vi(i,o,u);break;case 1:Fs||(Fa(u,o),h=u.stateNode,typeof h.componentWillUnmount=="function"&&FN(u,o,h)),vi(i,o,u);break;case 21:vi(i,o,u);break;case 22:Fs=(h=Fs)||u.memoizedState!==null,vi(i,o,u),Fs=h;break;default:vi(i,o,u)}}function KN(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Eu(i)}catch(u){Ft(o,o.return,u)}}}function QN(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Eu(i)}catch(u){Ft(o,o.return,u)}}function b3(i){switch(i.tag){case 31:case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new qN),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new qN),o;default:throw Error(n(435,i.tag))}}function Ug(i,o){var u=b3(i);o.forEach(function(h){if(!u.has(h)){u.add(h);var p=E3.bind(null,i,h);h.then(p,p)}})}function Zn(i,o){var u=o.deletions;if(u!==null)for(var h=0;h<u.length;h++){var p=u[h],b=i,A=o,$=A;e:for(;$!==null;){switch($.tag){case 27:if(To($.type)){us=$.stateNode,Xn=!1;break e}break;case 5:us=$.stateNode,Xn=!1;break e;case 3:case 4:us=$.stateNode.containerInfo,Xn=!0;break e}$=$.return}if(us===null)throw Error(n(160));WN(b,A,p),us=null,Xn=!1,b=p.alternate,b!==null&&(b.return=null),p.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)YN(o,i),o=o.sibling}var la=null;function YN(i,o){var u=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Zn(o,i),er(i),h&4&&(yo(3,i,i.return),Oh(3,i),yo(5,i,i.return));break;case 1:Zn(o,i),er(i),h&512&&(Fs||u===null||Fa(u,u.return)),h&64&&wi&&(i=i.updateQueue,i!==null&&(h=i.callbacks,h!==null&&(u=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=u===null?h:u.concat(h))));break;case 26:var p=la;if(Zn(o,i),er(i),h&512&&(Fs||u===null||Fa(u,u.return)),h&4){var b=u!==null?u.memoizedState:null;if(h=i.memoizedState,u===null)if(h===null)if(i.stateNode===null){e:{h=i.type,u=i.memoizedProps,p=p.ownerDocument||p;t:switch(h){case"title":b=p.getElementsByTagName("title")[0],(!b||b[Ta]||b[Os]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=p.createElement(h),p.head.insertBefore(b,p.querySelector("head > title"))),gn(b,h,u),b[Os]=i,Ps(b),h=b;break e;case"link":var A=Y2("link","href",p).get(h+(u.href||""));if(A){for(var $=0;$<A.length;$++)if(b=A[$],b.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&b.getAttribute("rel")===(u.rel==null?null:u.rel)&&b.getAttribute("title")===(u.title==null?null:u.title)&&b.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){A.splice($,1);break t}}b=p.createElement(h),gn(b,h,u),p.head.appendChild(b);break;case"meta":if(A=Y2("meta","content",p).get(h+(u.content||""))){for($=0;$<A.length;$++)if(b=A[$],b.getAttribute("content")===(u.content==null?null:""+u.content)&&b.getAttribute("name")===(u.name==null?null:u.name)&&b.getAttribute("property")===(u.property==null?null:u.property)&&b.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&b.getAttribute("charset")===(u.charSet==null?null:u.charSet)){A.splice($,1);break t}}b=p.createElement(h),gn(b,h,u),p.head.appendChild(b);break;default:throw Error(n(468,h))}b[Os]=i,Ps(b),h=b}i.stateNode=h}else J2(p,i.type,i.stateNode);else i.stateNode=Q2(p,h,i.memoizedProps);else b!==h?(b===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):b.count--,h===null?J2(p,i.type,i.stateNode):Q2(p,h,i.memoizedProps)):h===null&&i.stateNode!==null&&Db(i,i.memoizedProps,u.memoizedProps)}break;case 27:Zn(o,i),er(i),h&512&&(Fs||u===null||Fa(u,u.return)),u!==null&&h&4&&Db(i,i.memoizedProps,u.memoizedProps);break;case 5:if(Zn(o,i),er(i),h&512&&(Fs||u===null||Fa(u,u.return)),i.flags&32){p=i.stateNode;try{Jn(p,"")}catch(He){Ft(i,i.return,He)}}h&4&&i.stateNode!=null&&(p=i.memoizedProps,Db(i,p,u!==null?u.memoizedProps:p)),h&1024&&(Mb=!0);break;case 6:if(Zn(o,i),er(i),h&4){if(i.stateNode===null)throw Error(n(162));h=i.memoizedProps,u=i.stateNode;try{u.nodeValue=h}catch(He){Ft(i,i.return,He)}}break;case 3:if(tp=null,p=la,la=Zg(o.containerInfo),Zn(o,i),la=p,er(i),h&4&&u!==null&&u.memoizedState.isDehydrated)try{Eu(o.containerInfo)}catch(He){Ft(i,i.return,He)}Mb&&(Mb=!1,JN(i));break;case 4:h=la,la=Zg(i.stateNode.containerInfo),Zn(o,i),er(i),la=h;break;case 12:Zn(o,i),er(i);break;case 31:Zn(o,i),er(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,Ug(i,h)));break;case 13:Zn(o,i),er(i),i.child.flags&8192&&i.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&($g=Le()),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,Ug(i,h)));break;case 22:p=i.memoizedState!==null;var Z=u!==null&&u.memoizedState!==null,le=wi,ve=Fs;if(wi=le||p,Fs=ve||Z,Zn(o,i),Fs=ve,wi=le,er(i),h&8192)e:for(o=i.stateNode,o._visibility=p?o._visibility&-2:o._visibility|1,p&&(u===null||Z||wi||Fs||Fl(i)),u=null,o=i;;){if(o.tag===5||o.tag===26){if(u===null){Z=u=o;try{if(b=Z.stateNode,p)A=b.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{$=Z.stateNode;var Ee=Z.memoizedProps.style,de=Ee!=null&&Ee.hasOwnProperty("display")?Ee.display:null;$.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch(He){Ft(Z,Z.return,He)}}}else if(o.tag===6){if(u===null){Z=o;try{Z.stateNode.nodeValue=p?"":Z.memoizedProps}catch(He){Ft(Z,Z.return,He)}}}else if(o.tag===18){if(u===null){Z=o;try{var xe=Z.stateNode;p?F2(xe,!0):F2(Z.stateNode,!1)}catch(He){Ft(Z,Z.return,He)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break e;for(;o.sibling===null;){if(o.return===null||o.return===i)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}h&4&&(h=i.updateQueue,h!==null&&(u=h.retryQueue,u!==null&&(h.retryQueue=null,Ug(i,u))));break;case 19:Zn(o,i),er(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,Ug(i,h)));break;case 30:break;case 21:break;default:Zn(o,i),er(i)}}function er(i){var o=i.flags;if(o&2){try{for(var u,h=i.return;h!==null;){if(BN(h)){u=h;break}h=h.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var p=u.stateNode,b=Ob(i);Vg(i,b,p);break;case 5:var A=u.stateNode;u.flags&32&&(Jn(A,""),u.flags&=-33);var $=Ob(i);Vg(i,$,A);break;case 3:case 4:var Z=u.stateNode.containerInfo,le=Ob(i);Pb(i,le,Z);break;default:throw Error(n(161))}}catch(ve){Ft(i,i.return,ve)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function JN(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;JN(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function _i(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)HN(i,o.alternate,o),o=o.sibling}function Fl(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:yo(4,o,o.return),Fl(o);break;case 1:Fa(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&FN(o,o.return,u),Fl(o);break;case 27:qh(o.stateNode);case 26:case 5:Fa(o,o.return),Fl(o);break;case 22:o.memoizedState===null&&Fl(o);break;case 30:Fl(o);break;default:Fl(o)}i=i.sibling}}function ji(i,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var h=o.alternate,p=i,b=o,A=b.flags;switch(b.tag){case 0:case 11:case 15:ji(p,b,u),Oh(4,b);break;case 1:if(ji(p,b,u),h=b,p=h.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(le){Ft(h,h.return,le)}if(h=b,p=h.updateQueue,p!==null){var $=h.stateNode;try{var Z=p.shared.hiddenCallbacks;if(Z!==null)for(p.shared.hiddenCallbacks=null,p=0;p<Z.length;p++)I1(Z[p],$)}catch(le){Ft(h,h.return,le)}}u&&A&64&&UN(b),Ph(b,b.return);break;case 27:zN(b);case 26:case 5:ji(p,b,u),u&&h===null&&A&4&&$N(b),Ph(b,b.return);break;case 12:ji(p,b,u);break;case 31:ji(p,b,u),u&&A&4&&KN(p,b);break;case 13:ji(p,b,u),u&&A&4&&QN(p,b);break;case 22:b.memoizedState===null&&ji(p,b,u),Ph(b,b.return);break;case 30:break;default:ji(p,b,u)}o=o.sibling}}function Lb(i,o){var u=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==u&&(i!=null&&i.refCount++,u!=null&&vh(u))}function Vb(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&vh(i))}function ca(i,o,u,h){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)XN(i,o,u,h),o=o.sibling}function XN(i,o,u,h){var p=o.flags;switch(o.tag){case 0:case 11:case 15:ca(i,o,u,h),p&2048&&Oh(9,o);break;case 1:ca(i,o,u,h);break;case 3:ca(i,o,u,h),p&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&vh(i)));break;case 12:if(p&2048){ca(i,o,u,h),i=o.stateNode;try{var b=o.memoizedProps,A=b.id,$=b.onPostCommit;typeof $=="function"&&$(A,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Z){Ft(o,o.return,Z)}}else ca(i,o,u,h);break;case 31:ca(i,o,u,h);break;case 13:ca(i,o,u,h);break;case 23:break;case 22:b=o.stateNode,A=o.alternate,o.memoizedState!==null?b._visibility&2?ca(i,o,u,h):Mh(i,o):b._visibility&2?ca(i,o,u,h):(b._visibility|=2,pu(i,o,u,h,(o.subtreeFlags&10256)!==0||!1)),p&2048&&Lb(A,o);break;case 24:ca(i,o,u,h),p&2048&&Vb(o.alternate,o);break;default:ca(i,o,u,h)}}function pu(i,o,u,h,p){for(p=p&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var b=i,A=o,$=u,Z=h,le=A.flags;switch(A.tag){case 0:case 11:case 15:pu(b,A,$,Z,p),Oh(8,A);break;case 23:break;case 22:var ve=A.stateNode;A.memoizedState!==null?ve._visibility&2?pu(b,A,$,Z,p):Mh(b,A):(ve._visibility|=2,pu(b,A,$,Z,p)),p&&le&2048&&Lb(A.alternate,A);break;case 24:pu(b,A,$,Z,p),p&&le&2048&&Vb(A.alternate,A);break;default:pu(b,A,$,Z,p)}o=o.sibling}}function Mh(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=i,h=o,p=h.flags;switch(h.tag){case 22:Mh(u,h),p&2048&&Lb(h.alternate,h);break;case 24:Mh(u,h),p&2048&&Vb(h.alternate,h);break;default:Mh(u,h)}o=o.sibling}}var Lh=8192;function xu(i,o,u){if(i.subtreeFlags&Lh)for(i=i.child;i!==null;)ZN(i,o,u),i=i.sibling}function ZN(i,o,u){switch(i.tag){case 26:xu(i,o,u),i.flags&Lh&&i.memoizedState!==null&&rD(u,la,i.memoizedState,i.memoizedProps);break;case 5:xu(i,o,u);break;case 3:case 4:var h=la;la=Zg(i.stateNode.containerInfo),xu(i,o,u),la=h;break;case 22:i.memoizedState===null&&(h=i.alternate,h!==null&&h.memoizedState!==null?(h=Lh,Lh=16777216,xu(i,o,u),Lh=h):xu(i,o,u));break;default:xu(i,o,u)}}function e2(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function Vh(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var h=o[u];sn=h,s2(h,i)}e2(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)t2(i),i=i.sibling}function t2(i){switch(i.tag){case 0:case 11:case 15:Vh(i),i.flags&2048&&yo(9,i,i.return);break;case 3:Vh(i);break;case 12:Vh(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&2&&(i.return===null||i.return.tag!==13)?(o._visibility&=-3,Fg(i)):Vh(i);break;default:Vh(i)}}function Fg(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var h=o[u];sn=h,s2(h,i)}e2(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:yo(8,o,o.return),Fg(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,Fg(o));break;default:Fg(o)}i=i.sibling}}function s2(i,o){for(;sn!==null;){var u=sn;switch(u.tag){case 0:case 11:case 15:yo(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var h=u.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:vh(u.memoizedState.cache)}if(h=u.child,h!==null)h.return=u,sn=h;else e:for(u=i;sn!==null;){h=sn;var p=h.sibling,b=h.return;if(GN(h),h===u){sn=null;break e}if(p!==null){p.return=b,sn=p;break e}sn=b}}}var y3={getCacheForType:function(i){var o=fn(Ls),u=o.data.get(i);return u===void 0&&(u=i(),o.data.set(i,u)),u},cacheSignal:function(){return fn(Ls).controller.signal}},w3=typeof WeakMap=="function"?WeakMap:Map,Ot=0,Xt=null,vt=null,St=0,Ut=0,wr=null,wo=!1,bu=!1,Ub=!1,Ni=0,ws=0,vo=0,$l=0,Fb=0,vr=0,yu=0,Uh=null,tr=null,$b=!1,$g=0,n2=0,Bg=1/0,zg=null,_o=null,Qs=0,jo=null,wu=null,Si=0,Bb=0,zb=null,r2=null,Fh=0,qb=null;function _r(){return(Ot&2)!==0&&St!==0?St&-St:R.T!==null?Yb():qm()}function a2(){if(vr===0)if((St&536870912)===0||It){var i=it;it<<=1,(it&3932160)===0&&(it=262144),vr=i}else vr=536870912;return i=br.current,i!==null&&(i.flags|=32),vr}function sr(i,o,u){(i===Xt&&(Ut===2||Ut===9)||i.cancelPendingCommit!==null)&&(vu(i,0),No(i,St,vr,!1)),Ln(i,u),((Ot&2)===0||i!==Xt)&&(i===Xt&&((Ot&2)===0&&($l|=u),ws===4&&No(i,St,vr,!1)),$a(i))}function i2(i,o,u){if((Ot&6)!==0)throw Error(n(327));var h=!u&&(o&127)===0&&(o&i.expiredLanes)===0||Mn(i,o),p=h?j3(i,o):Gb(i,o,!0),b=h;do{if(p===0){bu&&!h&&No(i,o,0,!1);break}else{if(u=i.current.alternate,b&&!v3(u)){p=Gb(i,o,!1),b=!1;continue}if(p===2){if(b=o,i.errorRecoveryDisabledLanes&b)var A=0;else A=i.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){o=A;e:{var $=i;p=Uh;var Z=$.current.memoizedState.isDehydrated;if(Z&&(vu($,A).flags|=256),A=Gb($,A,!1),A!==2){if(Ub&&!Z){$.errorRecoveryDisabledLanes|=b,$l|=b,p=4;break e}b=tr,tr=p,b!==null&&(tr===null?tr=b:tr.push.apply(tr,b))}p=A}if(b=!1,p!==2)continue}}if(p===1){vu(i,0),No(i,o,0,!0);break}e:{switch(h=i,b=p,b){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:No(h,o,vr,!wo);break e;case 2:tr=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(p=$g+300-Le(),10<p)){if(No(h,o,vr,!wo),Ks(h,0,!0)!==0)break e;Si=o,h.timeoutHandle=L2(o2.bind(null,h,u,tr,zg,$b,o,vr,$l,yu,wo,b,"Throttled",-0,0),p);break e}o2(h,u,tr,zg,$b,o,vr,$l,yu,wo,b,null,-0,0)}}break}while(!0);$a(i)}function o2(i,o,u,h,p,b,A,$,Z,le,ve,Ee,de,xe){if(i.timeoutHandle=-1,Ee=o.subtreeFlags,Ee&8192||(Ee&16785408)===16785408){Ee={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:sa},ZN(o,b,Ee);var He=(b&62914560)===b?$g-Le():(b&4194048)===b?n2-Le():0;if(He=aD(Ee,He),He!==null){Si=b,i.cancelPendingCommit=He(g2.bind(null,i,o,b,u,h,p,A,$,Z,ve,Ee,null,de,xe)),No(i,b,A,!le);return}}g2(i,o,b,u,h,p,A,$,Z)}function v3(i){for(var o=i;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var h=0;h<u.length;h++){var p=u[h],b=p.getSnapshot;p=p.value;try{if(!pr(b(),p))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function No(i,o,u,h){o&=~Fb,o&=~$l,i.suspendedLanes|=o,i.pingedLanes&=~o,h&&(i.warmLanes|=o),h=i.expirationTimes;for(var p=o;0<p;){var b=31-Me(p),A=1<<b;h[b]=-1,p&=~A}u!==0&&ja(i,u,o)}function qg(){return(Ot&6)===0?($h(0),!1):!0}function Hb(){if(vt!==null){if(Ut===0)var i=vt.return;else i=vt,mi=Rl=null,ob(i),du=null,jh=0,i=vt;for(;i!==null;)VN(i.alternate,i),i=i.return;vt=null}}function vu(i,o){var u=i.timeoutHandle;u!==-1&&(i.timeoutHandle=-1,$3(u)),u=i.cancelPendingCommit,u!==null&&(i.cancelPendingCommit=null,u()),Si=0,Hb(),Xt=i,vt=u=hi(i.current,null),St=o,Ut=0,wr=null,wo=!1,bu=Mn(i,o),Ub=!1,yu=vr=Fb=$l=vo=ws=0,tr=Uh=null,$b=!1,(o&8)!==0&&(o|=o&32);var h=i.entangledLanes;if(h!==0)for(i=i.entanglements,h&=o;0<h;){var p=31-Me(h),b=1<<p;o|=i[p],h&=~b}return Ni=o,dg(),u}function l2(i,o){mt=null,R.H=Ch,o===uu||o===yg?(o=N1(),Ut=3):o===Qx?(o=N1(),Ut=4):Ut=o===jb?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,wr=o,vt===null&&(ws=1,Dg(i,Fr(o,i.current)))}function c2(){var i=br.current;return i===null?!0:(St&4194048)===St?qr===null:(St&62914560)===St||(St&536870912)!==0?i===qr:!1}function u2(){var i=R.H;return R.H=Ch,i===null?Ch:i}function d2(){var i=R.A;return R.A=y3,i}function Hg(){ws=4,wo||(St&4194048)!==St&&br.current!==null||(bu=!0),(vo&134217727)===0&&($l&134217727)===0||Xt===null||No(Xt,St,vr,!1)}function Gb(i,o,u){var h=Ot;Ot|=2;var p=u2(),b=d2();(Xt!==i||St!==o)&&(zg=null,vu(i,o)),o=!1;var A=ws;e:do try{if(Ut!==0&&vt!==null){var $=vt,Z=wr;switch(Ut){case 8:Hb(),A=6;break e;case 3:case 2:case 9:case 6:br.current===null&&(o=!0);var le=Ut;if(Ut=0,wr=null,_u(i,$,Z,le),u&&bu){A=0;break e}break;default:le=Ut,Ut=0,wr=null,_u(i,$,Z,le)}}_3(),A=ws;break}catch(ve){l2(i,ve)}while(!0);return o&&i.shellSuspendCounter++,mi=Rl=null,Ot=h,R.H=p,R.A=b,vt===null&&(Xt=null,St=0,dg()),A}function _3(){for(;vt!==null;)h2(vt)}function j3(i,o){var u=Ot;Ot|=2;var h=u2(),p=d2();Xt!==i||St!==o?(zg=null,Bg=Le()+500,vu(i,o)):bu=Mn(i,o);e:do try{if(Ut!==0&&vt!==null){o=vt;var b=wr;t:switch(Ut){case 1:Ut=0,wr=null,_u(i,o,b,1);break;case 2:case 9:if(_1(b)){Ut=0,wr=null,f2(o);break}o=function(){Ut!==2&&Ut!==9||Xt!==i||(Ut=7),$a(i)},b.then(o,o);break e;case 3:Ut=7;break e;case 4:Ut=5;break e;case 7:_1(b)?(Ut=0,wr=null,f2(o)):(Ut=0,wr=null,_u(i,o,b,7));break;case 5:var A=null;switch(vt.tag){case 26:A=vt.memoizedState;case 5:case 27:var $=vt;if(A?X2(A):$.stateNode.complete){Ut=0,wr=null;var Z=$.sibling;if(Z!==null)vt=Z;else{var le=$.return;le!==null?(vt=le,Gg(le)):vt=null}break t}}Ut=0,wr=null,_u(i,o,b,5);break;case 6:Ut=0,wr=null,_u(i,o,b,6);break;case 8:Hb(),ws=6;break e;default:throw Error(n(462))}}N3();break}catch(ve){l2(i,ve)}while(!0);return mi=Rl=null,R.H=h,R.A=p,Ot=u,vt!==null?0:(Xt=null,St=0,dg(),ws)}function N3(){for(;vt!==null&&!Ke();)h2(vt)}function h2(i){var o=MN(i.alternate,i,Ni);i.memoizedProps=i.pendingProps,o===null?Gg(i):vt=o}function f2(i){var o=i,u=o.alternate;switch(o.tag){case 15:case 0:o=kN(u,o,o.pendingProps,o.type,void 0,St);break;case 11:o=kN(u,o,o.pendingProps,o.type.render,o.ref,St);break;case 5:ob(o);default:VN(u,o),o=vt=d1(o,Ni),o=MN(u,o,Ni)}i.memoizedProps=i.pendingProps,o===null?Gg(i):vt=o}function _u(i,o,u,h){mi=Rl=null,ob(o),du=null,jh=0;var p=o.return;try{if(h3(i,p,o,u,St)){ws=1,Dg(i,Fr(u,i.current)),vt=null;return}}catch(b){if(p!==null)throw vt=p,b;ws=1,Dg(i,Fr(u,i.current)),vt=null;return}o.flags&32768?(It||h===1?i=!0:bu||(St&536870912)!==0?i=!1:(wo=i=!0,(h===2||h===9||h===3||h===6)&&(h=br.current,h!==null&&h.tag===13&&(h.flags|=16384))),m2(o,i)):Gg(o)}function Gg(i){var o=i;do{if((o.flags&32768)!==0){m2(o,wo);return}i=o.return;var u=g3(o.alternate,o,Ni);if(u!==null){vt=u;return}if(o=o.sibling,o!==null){vt=o;return}vt=o=i}while(o!==null);ws===0&&(ws=5)}function m2(i,o){do{var u=p3(i.alternate,i);if(u!==null){u.flags&=32767,vt=u;return}if(u=i.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(i=i.sibling,i!==null)){vt=i;return}vt=i=u}while(i!==null);ws=6,vt=null}function g2(i,o,u,h,p,b,A,$,Z){i.cancelPendingCommit=null;do Wg();while(Qs!==0);if((Ot&6)!==0)throw Error(n(327));if(o!==null){if(o===i.current)throw Error(n(177));if(b=o.lanes|o.childLanes,b|=Ox,pl(i,u,b,A,$,Z),i===Xt&&(vt=Xt=null,St=0),wu=o,jo=i,Si=u,Bb=b,zb=p,r2=h,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,I3(Ws,function(){return w2(),null})):(i.callbackNode=null,i.callbackPriority=0),h=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||h){h=R.T,R.T=null,p=J.p,J.p=2,A=Ot,Ot|=4;try{x3(i,o,u)}finally{Ot=A,J.p=p,R.T=h}}Qs=1,p2(),x2(),b2()}}function p2(){if(Qs===1){Qs=0;var i=jo,o=wu,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=R.T,R.T=null;var h=J.p;J.p=2;var p=Ot;Ot|=4;try{YN(o,i);var b=ry,A=s1(i.containerInfo),$=b.focusedElem,Z=b.selectionRange;if(A!==$&&$&&$.ownerDocument&&t1($.ownerDocument.documentElement,$)){if(Z!==null&&Ax($)){var le=Z.start,ve=Z.end;if(ve===void 0&&(ve=le),"selectionStart"in $)$.selectionStart=le,$.selectionEnd=Math.min(ve,$.value.length);else{var Ee=$.ownerDocument||document,de=Ee&&Ee.defaultView||window;if(de.getSelection){var xe=de.getSelection(),He=$.textContent.length,ot=Math.min(Z.start,He),Yt=Z.end===void 0?ot:Math.min(Z.end,He);!xe.extend&&ot>Yt&&(A=Yt,Yt=ot,ot=A);var re=e1($,ot),te=e1($,Yt);if(re&&te&&(xe.rangeCount!==1||xe.anchorNode!==re.node||xe.anchorOffset!==re.offset||xe.focusNode!==te.node||xe.focusOffset!==te.offset)){var oe=Ee.createRange();oe.setStart(re.node,re.offset),xe.removeAllRanges(),ot>Yt?(xe.addRange(oe),xe.extend(te.node,te.offset)):(oe.setEnd(te.node,te.offset),xe.addRange(oe))}}}}for(Ee=[],xe=$;xe=xe.parentNode;)xe.nodeType===1&&Ee.push({element:xe,left:xe.scrollLeft,top:xe.scrollTop});for(typeof $.focus=="function"&&$.focus(),$=0;$<Ee.length;$++){var Ne=Ee[$];Ne.element.scrollLeft=Ne.left,Ne.element.scrollTop=Ne.top}}ap=!!ny,ry=ny=null}finally{Ot=p,J.p=h,R.T=u}}i.current=o,Qs=2}}function x2(){if(Qs===2){Qs=0;var i=jo,o=wu,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=R.T,R.T=null;var h=J.p;J.p=2;var p=Ot;Ot|=4;try{HN(i,o.alternate,o)}finally{Ot=p,J.p=h,R.T=u}}Qs=3}}function b2(){if(Qs===4||Qs===3){Qs=0,Ie();var i=jo,o=wu,u=Si,h=r2;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Qs=5:(Qs=0,wu=jo=null,y2(i,i.pendingLanes));var p=i.pendingLanes;if(p===0&&(_o=null),li(u),o=o.stateNode,Re&&typeof Re.onCommitFiberRoot=="function")try{Re.onCommitFiberRoot(pe,o,void 0,(o.current.flags&128)===128)}catch{}if(h!==null){o=R.T,p=J.p,J.p=2,R.T=null;try{for(var b=i.onRecoverableError,A=0;A<h.length;A++){var $=h[A];b($.value,{componentStack:$.stack})}}finally{R.T=o,J.p=p}}(Si&3)!==0&&Wg(),$a(i),p=i.pendingLanes,(u&261930)!==0&&(p&42)!==0?i===qb?Fh++:(Fh=0,qb=i):Fh=0,$h(0)}}function y2(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,vh(o)))}function Wg(){return p2(),x2(),b2(),w2()}function w2(){if(Qs!==5)return!1;var i=jo,o=Bb;Bb=0;var u=li(Si),h=R.T,p=J.p;try{J.p=32>u?32:u,R.T=null,u=zb,zb=null;var b=jo,A=Si;if(Qs=0,wu=jo=null,Si=0,(Ot&6)!==0)throw Error(n(331));var $=Ot;if(Ot|=4,t2(b.current),XN(b,b.current,A,u),Ot=$,$h(0,!1),Re&&typeof Re.onPostCommitFiberRoot=="function")try{Re.onPostCommitFiberRoot(pe,b)}catch{}return!0}finally{J.p=p,R.T=h,y2(i,o)}}function v2(i,o,u){o=Fr(u,o),o=_b(i.stateNode,o,2),i=po(i,o,2),i!==null&&(Ln(i,2),$a(i))}function Ft(i,o,u){if(i.tag===3)v2(i,i,u);else for(;o!==null;){if(o.tag===3){v2(o,i,u);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(_o===null||!_o.has(h))){i=Fr(u,i),u=_N(2),h=po(o,u,2),h!==null&&(jN(u,h,o,i),Ln(h,2),$a(h));break}}o=o.return}}function Wb(i,o,u){var h=i.pingCache;if(h===null){h=i.pingCache=new w3;var p=new Set;h.set(o,p)}else p=h.get(o),p===void 0&&(p=new Set,h.set(o,p));p.has(u)||(Ub=!0,p.add(u),i=S3.bind(null,i,o,u),o.then(i,i))}function S3(i,o,u){var h=i.pingCache;h!==null&&h.delete(o),i.pingedLanes|=i.suspendedLanes&u,i.warmLanes&=~u,Xt===i&&(St&u)===u&&(ws===4||ws===3&&(St&62914560)===St&&300>Le()-$g?(Ot&2)===0&&vu(i,0):Fb|=u,yu===St&&(yu=0)),$a(i)}function _2(i,o){o===0&&(o=gl()),i=Al(i,o),i!==null&&(Ln(i,o),$a(i))}function T3(i){var o=i.memoizedState,u=0;o!==null&&(u=o.retryLane),_2(i,u)}function E3(i,o){var u=0;switch(i.tag){case 31:case 13:var h=i.stateNode,p=i.memoizedState;p!==null&&(u=p.retryLane);break;case 19:h=i.stateNode;break;case 22:h=i.stateNode._retryCache;break;default:throw Error(n(314))}h!==null&&h.delete(o),_2(i,u)}function I3(i,o){return Pe(i,o)}var Kg=null,ju=null,Kb=!1,Qg=!1,Qb=!1,So=0;function $a(i){i!==ju&&i.next===null&&(ju===null?Kg=ju=i:ju=ju.next=i),Qg=!0,Kb||(Kb=!0,k3())}function $h(i,o){if(!Qb&&Qg){Qb=!0;do for(var u=!1,h=Kg;h!==null;){if(i!==0){var p=h.pendingLanes;if(p===0)var b=0;else{var A=h.suspendedLanes,$=h.pingedLanes;b=(1<<31-Me(42|i)+1)-1,b&=p&~(A&~$),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(u=!0,T2(h,b))}else b=St,b=Ks(h,h===Xt?b:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(b&3)===0||Mn(h,b)||(u=!0,T2(h,b));h=h.next}while(u);Qb=!1}}function A3(){j2()}function j2(){Qg=Kb=!1;var i=0;So!==0&&F3()&&(i=So);for(var o=Le(),u=null,h=Kg;h!==null;){var p=h.next,b=N2(h,o);b===0?(h.next=null,u===null?Kg=p:u.next=p,p===null&&(ju=u)):(u=h,(i!==0||(b&3)!==0)&&(Qg=!0)),h=p}Qs!==0&&Qs!==5||$h(i),So!==0&&(So=0)}function N2(i,o){for(var u=i.suspendedLanes,h=i.pingedLanes,p=i.expirationTimes,b=i.pendingLanes&-62914561;0<b;){var A=31-Me(b),$=1<<A,Z=p[A];Z===-1?(($&u)===0||($&h)!==0)&&(p[A]=$c($,o)):Z<=o&&(i.expiredLanes|=$),b&=~$}if(o=Xt,u=St,u=Ks(i,i===o?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h=i.callbackNode,u===0||i===o&&(Ut===2||Ut===9)||i.cancelPendingCommit!==null)return h!==null&&h!==null&&Ge(h),i.callbackNode=null,i.callbackPriority=0;if((u&3)===0||Mn(i,u)){if(o=u&-u,o===i.callbackPriority)return o;switch(h!==null&&Ge(h),li(u)){case 2:case 8:u=Zt;break;case 32:u=Ws;break;case 268435456:u=En;break;default:u=Ws}return h=S2.bind(null,i),u=Pe(u,h),i.callbackPriority=o,i.callbackNode=u,o}return h!==null&&h!==null&&Ge(h),i.callbackPriority=2,i.callbackNode=null,2}function S2(i,o){if(Qs!==0&&Qs!==5)return i.callbackNode=null,i.callbackPriority=0,null;var u=i.callbackNode;if(Wg()&&i.callbackNode!==u)return null;var h=St;return h=Ks(i,i===Xt?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h===0?null:(i2(i,h,o),N2(i,Le()),i.callbackNode!=null&&i.callbackNode===u?S2.bind(null,i):null)}function T2(i,o){if(Wg())return null;i2(i,o,!0)}function k3(){B3(function(){(Ot&6)!==0?Pe(bs,A3):j2()})}function Yb(){if(So===0){var i=lu;i===0&&(i=Fe,Fe<<=1,(Fe&261888)===0&&(Fe=256)),So=i}return So}function E2(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Wc(""+i)}function I2(i,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,i.id&&u.setAttribute("form",i.id),o.parentNode.insertBefore(u,o),i=new FormData(i),u.parentNode.removeChild(u),i}function C3(i,o,u,h,p){if(o==="submit"&&u&&u.stateNode===p){var b=E2((p[en]||null).action),A=h.submitter;A&&(o=(o=A[en]||null)?E2(o.formAction):A.getAttribute("formAction"),o!==null&&(b=o,A=null));var $=new Oa("action","action",null,h,p);i.push({event:$,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(So!==0){var Z=A?I2(p,A):new FormData(p);pb(u,{pending:!0,data:Z,method:p.method,action:b},null,Z)}}else typeof b=="function"&&($.preventDefault(),Z=A?I2(p,A):new FormData(p),pb(u,{pending:!0,data:Z,method:p.method,action:b},b,Z))},currentTarget:p}]})}}for(var Jb=0;Jb<Dx.length;Jb++){var Xb=Dx[Jb],R3=Xb.toLowerCase(),D3=Xb[0].toUpperCase()+Xb.slice(1);oa(R3,"on"+D3)}oa(a1,"onAnimationEnd"),oa(i1,"onAnimationIteration"),oa(o1,"onAnimationStart"),oa("dblclick","onDoubleClick"),oa("focusin","onFocus"),oa("focusout","onBlur"),oa(QR,"onTransitionRun"),oa(YR,"onTransitionStart"),oa(JR,"onTransitionCancel"),oa(l1,"onTransitionEnd"),ka("onMouseEnter",["mouseout","mouseover"]),ka("onMouseLeave",["mouseout","mouseover"]),ka("onPointerEnter",["pointerout","pointerover"]),ka("onPointerLeave",["pointerout","pointerover"]),Aa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Aa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Aa("onBeforeInput",["compositionend","keypress","textInput","paste"]),Aa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Aa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Aa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),O3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bh));function A2(i,o){o=(o&4)!==0;for(var u=0;u<i.length;u++){var h=i[u],p=h.event;h=h.listeners;e:{var b=void 0;if(o)for(var A=h.length-1;0<=A;A--){var $=h[A],Z=$.instance,le=$.currentTarget;if($=$.listener,Z!==b&&p.isPropagationStopped())break e;b=$,p.currentTarget=le;try{b(p)}catch(ve){ug(ve)}p.currentTarget=null,b=Z}else for(A=0;A<h.length;A++){if($=h[A],Z=$.instance,le=$.currentTarget,$=$.listener,Z!==b&&p.isPropagationStopped())break e;b=$,p.currentTarget=le;try{b(p)}catch(ve){ug(ve)}p.currentTarget=null,b=Z}}}}function _t(i,o){var u=o[Bc];u===void 0&&(u=o[Bc]=new Set);var h=i+"__bubble";u.has(h)||(k2(o,i,2,!1),u.add(h))}function Zb(i,o,u){var h=0;o&&(h|=4),k2(u,i,h,o)}var Yg="_reactListening"+Math.random().toString(36).slice(2);function ey(i){if(!i[Yg]){i[Yg]=!0,eh.forEach(function(u){u!=="selectionchange"&&(O3.has(u)||Zb(u,!1,i),Zb(u,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Yg]||(o[Yg]=!0,Zb("selectionchange",!1,o))}}function k2(i,o,u,h){switch(aS(o)){case 2:var p=lD;break;case 8:p=cD;break;default:p=gy}u=p.bind(null,o,u,i),p=void 0,!vl||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(p=!0),h?p!==void 0?i.addEventListener(o,u,{capture:!0,passive:p}):i.addEventListener(o,u,!0):p!==void 0?i.addEventListener(o,u,{passive:p}):i.addEventListener(o,u,!1)}function ty(i,o,u,h,p){var b=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var A=h.tag;if(A===3||A===4){var $=h.stateNode.containerInfo;if($===p)break;if(A===4)for(A=h.return;A!==null;){var Z=A.tag;if((Z===3||Z===4)&&A.stateNode.containerInfo===p)return;A=A.return}for(;$!==null;){if(A=Ea($),A===null)return;if(Z=A.tag,Z===5||Z===6||Z===26||Z===27){h=b=A;continue e}$=$.parentNode}}h=h.return}ao(function(){var le=b,ve=Mr(u),Ee=[];e:{var de=c1.get(i);if(de!==void 0){var xe=Oa,He=i;switch(i){case"keypress":if(jl(u)===0)break e;case"keydown":case"keyup":xe=og;break;case"focusin":He="focus",xe=Sl;break;case"focusout":He="blur",xe=Sl;break;case"beforeblur":case"afterblur":xe=Sl;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xe=fh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xe=Xm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xe=_;break;case a1:case i1:case o1:xe=eg;break;case l1:xe=H;break;case"scroll":case"scrollend":xe=hh;break;case"wheel":xe=ge;break;case"copy":case"cut":case"paste":xe=tg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xe=di;break;case"toggle":case"beforetoggle":xe=ft}var ot=(o&4)!==0,Yt=!ot&&(i==="scroll"||i==="scrollend"),re=ot?de!==null?de+"Capture":null:de;ot=[];for(var te=le,oe;te!==null;){var Ne=te;if(oe=Ne.stateNode,Ne=Ne.tag,Ne!==5&&Ne!==26&&Ne!==27||oe===null||re===null||(Ne=na(te,re),Ne!=null&&ot.push(zh(te,Ne,oe))),Yt)break;te=te.return}0<ot.length&&(de=new xe(de,He,null,u,ve),Ee.push({event:de,listeners:ot}))}}if((o&7)===0){e:{if(de=i==="mouseover"||i==="pointerover",xe=i==="mouseout"||i==="pointerout",de&&u!==ch&&(He=u.relatedTarget||u.fromElement)&&(Ea(He)||He[Sa]))break e;if((xe||de)&&(de=ve.window===ve?ve:(de=ve.ownerDocument)?de.defaultView||de.parentWindow:window,xe?(He=u.relatedTarget||u.toElement,xe=le,He=He?Ea(He):null,He!==null&&(Yt=l(He),ot=He.tag,He!==Yt||ot!==5&&ot!==27&&ot!==6)&&(He=null)):(xe=null,He=le),xe!==He)){if(ot=fh,Ne="onMouseLeave",re="onMouseEnter",te="mouse",(i==="pointerout"||i==="pointerover")&&(ot=di,Ne="onPointerLeave",re="onPointerEnter",te="pointer"),Yt=xe==null?de:mr(xe),oe=He==null?de:mr(He),de=new ot(Ne,te+"leave",xe,u,ve),de.target=Yt,de.relatedTarget=oe,Ne=null,Ea(ve)===le&&(ot=new ot(re,te+"enter",He,u,ve),ot.target=oe,ot.relatedTarget=Yt,Ne=ot),Yt=Ne,xe&&He)t:{for(ot=P3,re=xe,te=He,oe=0,Ne=re;Ne;Ne=ot(Ne))oe++;Ne=0;for(var st=te;st;st=ot(st))Ne++;for(;0<oe-Ne;)re=ot(re),oe--;for(;0<Ne-oe;)te=ot(te),Ne--;for(;oe--;){if(re===te||te!==null&&re===te.alternate){ot=re;break t}re=ot(re),te=ot(te)}ot=null}else ot=null;xe!==null&&C2(Ee,de,xe,ot,!1),He!==null&&Yt!==null&&C2(Ee,Yt,He,ot,!0)}}e:{if(de=le?mr(le):window,xe=de.nodeName&&de.nodeName.toLowerCase(),xe==="select"||xe==="input"&&de.type==="file")var kt=Kj;else if(Gj(de))if(Qj)kt=GR;else{kt=qR;var Ye=zR}else xe=de.nodeName,!xe||xe.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?le&&Gc(le.elementType)&&(kt=Kj):kt=HR;if(kt&&(kt=kt(i,le))){Wj(Ee,kt,u,ve);break e}Ye&&Ye(i,de,le),i==="focusout"&&le&&de.type==="number"&&le.memoizedProps.value!=null&&ih(de,"number",de.value)}switch(Ye=le?mr(le):window,i){case"focusin":(Gj(Ye)||Ye.contentEditable==="true")&&(eu=Ye,kx=le,bh=null);break;case"focusout":bh=kx=eu=null;break;case"mousedown":Cx=!0;break;case"contextmenu":case"mouseup":case"dragend":Cx=!1,n1(Ee,u,ve);break;case"selectionchange":if(KR)break;case"keydown":case"keyup":n1(Ee,u,ve)}var xt;if(Dt)e:{switch(i){case"compositionstart":var Tt="onCompositionStart";break e;case"compositionend":Tt="onCompositionEnd";break e;case"compositionupdate":Tt="onCompositionUpdate";break e}Tt=void 0}else Zc?Tl(i,u)&&(Tt="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(Tt="onCompositionStart");Tt&&(La&&u.locale!=="ko"&&(Zc||Tt!=="onCompositionStart"?Tt==="onCompositionEnd"&&Zc&&(xt=dh()):(Da=ve,uh="value"in Da?Da.value:Da.textContent,Zc=!0)),Ye=Jg(le,Tt),0<Ye.length&&(Tt=new Ma(Tt,i,null,u,ve),Ee.push({event:Tt,listeners:Ye}),xt?Tt.data=xt:(xt=Xc(u),xt!==null&&(Tt.data=xt)))),(xt=Vr?UR(i,u):FR(i,u))&&(Tt=Jg(le,"onBeforeInput"),0<Tt.length&&(Ye=new Ma("onBeforeInput","beforeinput",null,u,ve),Ee.push({event:Ye,listeners:Tt}),Ye.data=xt)),C3(Ee,i,le,u,ve)}A2(Ee,o)})}function zh(i,o,u){return{instance:i,listener:o,currentTarget:u}}function Jg(i,o){for(var u=o+"Capture",h=[];i!==null;){var p=i,b=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||b===null||(p=na(i,u),p!=null&&h.unshift(zh(i,p,b)),p=na(i,o),p!=null&&h.push(zh(i,p,b))),i.tag===3)return h;i=i.return}return[]}function P3(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function C2(i,o,u,h,p){for(var b=o._reactName,A=[];u!==null&&u!==h;){var $=u,Z=$.alternate,le=$.stateNode;if($=$.tag,Z!==null&&Z===h)break;$!==5&&$!==26&&$!==27||le===null||(Z=le,p?(le=na(u,b),le!=null&&A.unshift(zh(u,le,Z))):p||(le=na(u,b),le!=null&&A.push(zh(u,le,Z)))),u=u.return}A.length!==0&&i.push({event:o,listeners:A})}var M3=/\r\n?/g,L3=/\u0000|\uFFFD/g;function R2(i){return(typeof i=="string"?i:""+i).replace(M3,`
`).replace(L3,"")}function D2(i,o){return o=R2(o),R2(i)===o}function Qt(i,o,u,h,p,b){switch(u){case"children":typeof h=="string"?o==="body"||o==="textarea"&&h===""||Jn(i,h):(typeof h=="number"||typeof h=="bigint")&&o!=="body"&&Jn(i,""+h);break;case"className":gr(i,"class",h);break;case"tabIndex":gr(i,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":gr(i,u,h);break;case"style":lh(i,h,b);break;case"data":if(o!=="object"){gr(i,"data",h);break}case"src":case"href":if(h===""&&(o!=="a"||u!=="href")){i.removeAttribute(u);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(u);break}h=Wc(""+h),i.setAttribute(u,h);break;case"action":case"formAction":if(typeof h=="function"){i.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(u==="formAction"?(o!=="input"&&Qt(i,o,"name",p.name,p,null),Qt(i,o,"formEncType",p.formEncType,p,null),Qt(i,o,"formMethod",p.formMethod,p,null),Qt(i,o,"formTarget",p.formTarget,p,null)):(Qt(i,o,"encType",p.encType,p,null),Qt(i,o,"method",p.method,p,null),Qt(i,o,"target",p.target,p,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(u);break}h=Wc(""+h),i.setAttribute(u,h);break;case"onClick":h!=null&&(i.onclick=sa);break;case"onScroll":h!=null&&_t("scroll",i);break;case"onScrollEnd":h!=null&&_t("scrollend",i);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(u=h.__html,u!=null){if(p.children!=null)throw Error(n(60));i.innerHTML=u}}break;case"multiple":i.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":i.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){i.removeAttribute("xlink:href");break}u=Wc(""+h),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(u,""+h):i.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(u,""):i.removeAttribute(u);break;case"capture":case"download":h===!0?i.setAttribute(u,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(u,h):i.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?i.setAttribute(u,h):i.removeAttribute(u);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?i.removeAttribute(u):i.setAttribute(u,h);break;case"popover":_t("beforetoggle",i),_t("toggle",i),qc(i,"popover",h);break;case"xlinkActuate":Ms(i,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Ms(i,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Ms(i,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Ms(i,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Ms(i,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Ms(i,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Ms(i,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Ms(i,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Ms(i,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":qc(i,"is",h);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Jm.get(u)||u,qc(i,u,h))}}function sy(i,o,u,h,p,b){switch(u){case"style":lh(i,h,b);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(u=h.__html,u!=null){if(p.children!=null)throw Error(n(60));i.innerHTML=u}}break;case"children":typeof h=="string"?Jn(i,h):(typeof h=="number"||typeof h=="bigint")&&Jn(i,""+h);break;case"onScroll":h!=null&&_t("scroll",i);break;case"onScrollEnd":h!=null&&_t("scrollend",i);break;case"onClick":h!=null&&(i.onclick=sa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!th.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(p=u.endsWith("Capture"),o=u.slice(2,p?u.length-7:void 0),b=i[en]||null,b=b!=null?b[u]:null,typeof b=="function"&&i.removeEventListener(o,b,p),typeof h=="function")){typeof b!="function"&&b!==null&&(u in i?i[u]=null:i.hasAttribute(u)&&i.removeAttribute(u)),i.addEventListener(o,h,p);break e}u in i?i[u]=h:h===!0?i.setAttribute(u,""):qc(i,u,h)}}}function gn(i,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_t("error",i),_t("load",i);var h=!1,p=!1,b;for(b in u)if(u.hasOwnProperty(b)){var A=u[b];if(A!=null)switch(b){case"src":h=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:Qt(i,o,b,A,u,null)}}p&&Qt(i,o,"srcSet",u.srcSet,u,null),h&&Qt(i,o,"src",u.src,u,null);return;case"input":_t("invalid",i);var $=b=A=p=null,Z=null,le=null;for(h in u)if(u.hasOwnProperty(h)){var ve=u[h];if(ve!=null)switch(h){case"name":p=ve;break;case"type":A=ve;break;case"checked":Z=ve;break;case"defaultChecked":le=ve;break;case"value":b=ve;break;case"defaultValue":$=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(n(137,o));break;default:Qt(i,o,h,ve,u,null)}}Km(i,b,$,Z,le,A,p,!1);return;case"select":_t("invalid",i),h=A=b=null;for(p in u)if(u.hasOwnProperty(p)&&($=u[p],$!=null))switch(p){case"value":b=$;break;case"defaultValue":A=$;break;case"multiple":h=$;default:Qt(i,o,p,$,u,null)}o=b,u=A,i.multiple=!!h,o!=null?to(i,!!h,o,!1):u!=null&&to(i,!!h,u,!0);return;case"textarea":_t("invalid",i),b=p=h=null;for(A in u)if(u.hasOwnProperty(A)&&($=u[A],$!=null))switch(A){case"value":h=$;break;case"defaultValue":p=$;break;case"children":b=$;break;case"dangerouslySetInnerHTML":if($!=null)throw Error(n(91));break;default:Qt(i,o,A,$,u,null)}so(i,h,p,b);return;case"option":for(Z in u)if(u.hasOwnProperty(Z)&&(h=u[Z],h!=null))switch(Z){case"selected":i.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Qt(i,o,Z,h,u,null)}return;case"dialog":_t("beforetoggle",i),_t("toggle",i),_t("cancel",i),_t("close",i);break;case"iframe":case"object":_t("load",i);break;case"video":case"audio":for(h=0;h<Bh.length;h++)_t(Bh[h],i);break;case"image":_t("error",i),_t("load",i);break;case"details":_t("toggle",i);break;case"embed":case"source":case"link":_t("error",i),_t("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(le in u)if(u.hasOwnProperty(le)&&(h=u[le],h!=null))switch(le){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:Qt(i,o,le,h,u,null)}return;default:if(Gc(o)){for(ve in u)u.hasOwnProperty(ve)&&(h=u[ve],h!==void 0&&sy(i,o,ve,h,u,void 0));return}}for($ in u)u.hasOwnProperty($)&&(h=u[$],h!=null&&Qt(i,o,$,h,u,null))}function V3(i,o,u,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,b=null,A=null,$=null,Z=null,le=null,ve=null;for(xe in u){var Ee=u[xe];if(u.hasOwnProperty(xe)&&Ee!=null)switch(xe){case"checked":break;case"value":break;case"defaultValue":Z=Ee;default:h.hasOwnProperty(xe)||Qt(i,o,xe,null,h,Ee)}}for(var de in h){var xe=h[de];if(Ee=u[de],h.hasOwnProperty(de)&&(xe!=null||Ee!=null))switch(de){case"type":b=xe;break;case"name":p=xe;break;case"checked":le=xe;break;case"defaultChecked":ve=xe;break;case"value":A=xe;break;case"defaultValue":$=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(n(137,o));break;default:xe!==Ee&&Qt(i,o,de,xe,h,Ee)}}Hc(i,A,$,Z,le,ve,b,p);return;case"select":xe=A=$=de=null;for(b in u)if(Z=u[b],u.hasOwnProperty(b)&&Z!=null)switch(b){case"value":break;case"multiple":xe=Z;default:h.hasOwnProperty(b)||Qt(i,o,b,null,h,Z)}for(p in h)if(b=h[p],Z=u[p],h.hasOwnProperty(p)&&(b!=null||Z!=null))switch(p){case"value":de=b;break;case"defaultValue":$=b;break;case"multiple":A=b;default:b!==Z&&Qt(i,o,p,b,h,Z)}o=$,u=A,h=xe,de!=null?to(i,!!u,de,!1):!!h!=!!u&&(o!=null?to(i,!!u,o,!0):to(i,!!u,u?[]:"",!1));return;case"textarea":xe=de=null;for($ in u)if(p=u[$],u.hasOwnProperty($)&&p!=null&&!h.hasOwnProperty($))switch($){case"value":break;case"children":break;default:Qt(i,o,$,null,h,p)}for(A in h)if(p=h[A],b=u[A],h.hasOwnProperty(A)&&(p!=null||b!=null))switch(A){case"value":de=p;break;case"defaultValue":xe=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(n(91));break;default:p!==b&&Qt(i,o,A,p,h,b)}Qm(i,de,xe);return;case"option":for(var He in u)if(de=u[He],u.hasOwnProperty(He)&&de!=null&&!h.hasOwnProperty(He))switch(He){case"selected":i.selected=!1;break;default:Qt(i,o,He,null,h,de)}for(Z in h)if(de=h[Z],xe=u[Z],h.hasOwnProperty(Z)&&de!==xe&&(de!=null||xe!=null))switch(Z){case"selected":i.selected=de&&typeof de!="function"&&typeof de!="symbol";break;default:Qt(i,o,Z,de,h,xe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ot in u)de=u[ot],u.hasOwnProperty(ot)&&de!=null&&!h.hasOwnProperty(ot)&&Qt(i,o,ot,null,h,de);for(le in h)if(de=h[le],xe=u[le],h.hasOwnProperty(le)&&de!==xe&&(de!=null||xe!=null))switch(le){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(n(137,o));break;default:Qt(i,o,le,de,h,xe)}return;default:if(Gc(o)){for(var Yt in u)de=u[Yt],u.hasOwnProperty(Yt)&&de!==void 0&&!h.hasOwnProperty(Yt)&&sy(i,o,Yt,void 0,h,de);for(ve in h)de=h[ve],xe=u[ve],!h.hasOwnProperty(ve)||de===xe||de===void 0&&xe===void 0||sy(i,o,ve,de,h,xe);return}}for(var re in u)de=u[re],u.hasOwnProperty(re)&&de!=null&&!h.hasOwnProperty(re)&&Qt(i,o,re,null,h,de);for(Ee in h)de=h[Ee],xe=u[Ee],!h.hasOwnProperty(Ee)||de===xe||de==null&&xe==null||Qt(i,o,Ee,de,h,xe)}function O2(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function U3(){if(typeof performance.getEntriesByType=="function"){for(var i=0,o=0,u=performance.getEntriesByType("resource"),h=0;h<u.length;h++){var p=u[h],b=p.transferSize,A=p.initiatorType,$=p.duration;if(b&&$&&O2(A)){for(A=0,$=p.responseEnd,h+=1;h<u.length;h++){var Z=u[h],le=Z.startTime;if(le>$)break;var ve=Z.transferSize,Ee=Z.initiatorType;ve&&O2(Ee)&&(Z=Z.responseEnd,A+=ve*(Z<$?1:($-le)/(Z-le)))}if(--h,o+=8*(b+A)/(p.duration/1e3),i++,10<i)break}}if(0<i)return o/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var ny=null,ry=null;function Xg(i){return i.nodeType===9?i:i.ownerDocument}function P2(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function M2(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function ay(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var iy=null;function F3(){var i=window.event;return i&&i.type==="popstate"?i===iy?!1:(iy=i,!0):(iy=null,!1)}var L2=typeof setTimeout=="function"?setTimeout:void 0,$3=typeof clearTimeout=="function"?clearTimeout:void 0,V2=typeof Promise=="function"?Promise:void 0,B3=typeof queueMicrotask=="function"?queueMicrotask:typeof V2<"u"?function(i){return V2.resolve(null).then(i).catch(z3)}:L2;function z3(i){setTimeout(function(){throw i})}function To(i){return i==="head"}function U2(i,o){var u=o,h=0;do{var p=u.nextSibling;if(i.removeChild(u),p&&p.nodeType===8)if(u=p.data,u==="/$"||u==="/&"){if(h===0){i.removeChild(p),Eu(o);return}h--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")h++;else if(u==="html")qh(i.ownerDocument.documentElement);else if(u==="head"){u=i.ownerDocument.head,qh(u);for(var b=u.firstChild;b;){var A=b.nextSibling,$=b.nodeName;b[Ta]||$==="SCRIPT"||$==="STYLE"||$==="LINK"&&b.rel.toLowerCase()==="stylesheet"||u.removeChild(b),b=A}}else u==="body"&&qh(i.ownerDocument.body);u=p}while(u);Eu(o)}function F2(i,o){var u=i;i=0;do{var h=u.nextSibling;if(u.nodeType===1?o?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(o?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),h&&h.nodeType===8)if(u=h.data,u==="/$"){if(i===0)break;i--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||i++;u=h}while(u)}function oy(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":oy(u),zc(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}i.removeChild(u)}}function q3(i,o,u,h){for(;i.nodeType===1;){var p=u;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!h&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(h){if(!i[Ta])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(b=i.getAttribute("rel"),b==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(b!==p.rel||i.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||i.getAttribute("title")!==(p.title==null?null:p.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(b=i.getAttribute("src"),(b!==(p.src==null?null:p.src)||i.getAttribute("type")!==(p.type==null?null:p.type)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&b&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var b=p.name==null?null:""+p.name;if(p.type==="hidden"&&i.getAttribute("name")===b)return i}else return i;if(i=Hr(i.nextSibling),i===null)break}return null}function H3(i,o,u){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=Hr(i.nextSibling),i===null))return null;return i}function $2(i,o){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!o||(i=Hr(i.nextSibling),i===null))return null;return i}function ly(i){return i.data==="$?"||i.data==="$~"}function cy(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function G3(i,o){var u=i.ownerDocument;if(i.data==="$~")i._reactRetry=o;else if(i.data!=="$?"||u.readyState!=="loading")o();else{var h=function(){o(),u.removeEventListener("DOMContentLoaded",h)};u.addEventListener("DOMContentLoaded",h),i._reactRetry=h}}function Hr(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return i}var uy=null;function B2(i){i=i.nextSibling;for(var o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"||u==="/&"){if(o===0)return Hr(i.nextSibling);o--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||o++}i=i.nextSibling}return null}function z2(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(o===0)return i;o--}else u!=="/$"&&u!=="/&"||o++}i=i.previousSibling}return null}function q2(i,o,u){switch(o=Xg(u),i){case"html":if(i=o.documentElement,!i)throw Error(n(452));return i;case"head":if(i=o.head,!i)throw Error(n(453));return i;case"body":if(i=o.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function qh(i){for(var o=i.attributes;o.length;)i.removeAttributeNode(o[0]);zc(i)}var Gr=new Map,H2=new Set;function Zg(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ti=J.d;J.d={f:W3,r:K3,D:Q3,C:Y3,L:J3,m:X3,X:eD,S:Z3,M:tD};function W3(){var i=Ti.f(),o=qg();return i||o}function K3(i){var o=Pr(i);o!==null&&o.tag===5&&o.type==="form"?lN(o):Ti.r(i)}var Nu=typeof document>"u"?null:document;function G2(i,o,u){var h=Nu;if(h&&typeof o=="string"&&o){var p=Yn(o);p='link[rel="'+i+'"][href="'+p+'"]',typeof u=="string"&&(p+='[crossorigin="'+u+'"]'),H2.has(p)||(H2.add(p),i={rel:i,crossOrigin:u,href:o},h.querySelector(p)===null&&(o=h.createElement("link"),gn(o,"link",i),Ps(o),h.head.appendChild(o)))}}function Q3(i){Ti.D(i),G2("dns-prefetch",i,null)}function Y3(i,o){Ti.C(i,o),G2("preconnect",i,o)}function J3(i,o,u){Ti.L(i,o,u);var h=Nu;if(h&&i&&o){var p='link[rel="preload"][as="'+Yn(o)+'"]';o==="image"&&u&&u.imageSrcSet?(p+='[imagesrcset="'+Yn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(p+='[imagesizes="'+Yn(u.imageSizes)+'"]')):p+='[href="'+Yn(i)+'"]';var b=p;switch(o){case"style":b=Su(i);break;case"script":b=Tu(i)}Gr.has(b)||(i=y({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:i,as:o},u),Gr.set(b,i),h.querySelector(p)!==null||o==="style"&&h.querySelector(Hh(b))||o==="script"&&h.querySelector(Gh(b))||(o=h.createElement("link"),gn(o,"link",i),Ps(o),h.head.appendChild(o)))}}function X3(i,o){Ti.m(i,o);var u=Nu;if(u&&i){var h=o&&typeof o.as=="string"?o.as:"script",p='link[rel="modulepreload"][as="'+Yn(h)+'"][href="'+Yn(i)+'"]',b=p;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=Tu(i)}if(!Gr.has(b)&&(i=y({rel:"modulepreload",href:i},o),Gr.set(b,i),u.querySelector(p)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Gh(b)))return}h=u.createElement("link"),gn(h,"link",i),Ps(h),u.head.appendChild(h)}}}function Z3(i,o,u){Ti.S(i,o,u);var h=Nu;if(h&&i){var p=Ia(h).hoistableStyles,b=Su(i);o=o||"default";var A=p.get(b);if(!A){var $={loading:0,preload:null};if(A=h.querySelector(Hh(b)))$.loading=5;else{i=y({rel:"stylesheet",href:i,"data-precedence":o},u),(u=Gr.get(b))&&dy(i,u);var Z=A=h.createElement("link");Ps(Z),gn(Z,"link",i),Z._p=new Promise(function(le,ve){Z.onload=le,Z.onerror=ve}),Z.addEventListener("load",function(){$.loading|=1}),Z.addEventListener("error",function(){$.loading|=2}),$.loading|=4,ep(A,o,h)}A={type:"stylesheet",instance:A,count:1,state:$},p.set(b,A)}}}function eD(i,o){Ti.X(i,o);var u=Nu;if(u&&i){var h=Ia(u).hoistableScripts,p=Tu(i),b=h.get(p);b||(b=u.querySelector(Gh(p)),b||(i=y({src:i,async:!0},o),(o=Gr.get(p))&&hy(i,o),b=u.createElement("script"),Ps(b),gn(b,"link",i),u.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},h.set(p,b))}}function tD(i,o){Ti.M(i,o);var u=Nu;if(u&&i){var h=Ia(u).hoistableScripts,p=Tu(i),b=h.get(p);b||(b=u.querySelector(Gh(p)),b||(i=y({src:i,async:!0,type:"module"},o),(o=Gr.get(p))&&hy(i,o),b=u.createElement("script"),Ps(b),gn(b,"link",i),u.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},h.set(p,b))}}function W2(i,o,u,h){var p=(p=se.current)?Zg(p):null;if(!p)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Su(u.href),u=Ia(p).hoistableStyles,h=u.get(o),h||(h={type:"style",instance:null,count:0,state:null},u.set(o,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){i=Su(u.href);var b=Ia(p).hoistableStyles,A=b.get(i);if(A||(p=p.ownerDocument||p,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(i,A),(b=p.querySelector(Hh(i)))&&!b._p&&(A.instance=b,A.state.loading=5),Gr.has(i)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Gr.set(i,u),b||sD(p,i,u,A.state))),o&&h===null)throw Error(n(528,""));return A}if(o&&h!==null)throw Error(n(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Tu(u),u=Ia(p).hoistableScripts,h=u.get(o),h||(h={type:"script",instance:null,count:0,state:null},u.set(o,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function Su(i){return'href="'+Yn(i)+'"'}function Hh(i){return'link[rel="stylesheet"]['+i+"]"}function K2(i){return y({},i,{"data-precedence":i.precedence,precedence:null})}function sD(i,o,u,h){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?h.loading=1:(o=i.createElement("link"),h.preload=o,o.addEventListener("load",function(){return h.loading|=1}),o.addEventListener("error",function(){return h.loading|=2}),gn(o,"link",u),Ps(o),i.head.appendChild(o))}function Tu(i){return'[src="'+Yn(i)+'"]'}function Gh(i){return"script[async]"+i}function Q2(i,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var h=i.querySelector('style[data-href~="'+Yn(u.href)+'"]');if(h)return o.instance=h,Ps(h),h;var p=y({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return h=(i.ownerDocument||i).createElement("style"),Ps(h),gn(h,"style",p),ep(h,u.precedence,i),o.instance=h;case"stylesheet":p=Su(u.href);var b=i.querySelector(Hh(p));if(b)return o.state.loading|=4,o.instance=b,Ps(b),b;h=K2(u),(p=Gr.get(p))&&dy(h,p),b=(i.ownerDocument||i).createElement("link"),Ps(b);var A=b;return A._p=new Promise(function($,Z){A.onload=$,A.onerror=Z}),gn(b,"link",h),o.state.loading|=4,ep(b,u.precedence,i),o.instance=b;case"script":return b=Tu(u.src),(p=i.querySelector(Gh(b)))?(o.instance=p,Ps(p),p):(h=u,(p=Gr.get(b))&&(h=y({},u),hy(h,p)),i=i.ownerDocument||i,p=i.createElement("script"),Ps(p),gn(p,"link",h),i.head.appendChild(p),o.instance=p);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(h=o.instance,o.state.loading|=4,ep(h,u.precedence,i));return o.instance}function ep(i,o,u){for(var h=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=h.length?h[h.length-1]:null,b=p,A=0;A<h.length;A++){var $=h[A];if($.dataset.precedence===o)b=$;else if(b!==p)break}b?b.parentNode.insertBefore(i,b.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(i,o.firstChild))}function dy(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function hy(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var tp=null;function Y2(i,o,u){if(tp===null){var h=new Map,p=tp=new Map;p.set(u,h)}else p=tp,h=p.get(u),h||(h=new Map,p.set(u,h));if(h.has(i))return h;for(h.set(i,null),u=u.getElementsByTagName(i),p=0;p<u.length;p++){var b=u[p];if(!(b[Ta]||b[Os]||i==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var A=b.getAttribute(o)||"";A=i+A;var $=h.get(A);$?$.push(b):h.set(A,[b])}}return h}function J2(i,o,u){i=i.ownerDocument||i,i.head.insertBefore(u,o==="title"?i.querySelector("head > title"):null)}function nD(i,o,u){if(u===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function X2(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function rD(i,o,u,h){if(u.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var p=Su(h.href),b=o.querySelector(Hh(p));if(b){o=b._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(i.count++,i=sp.bind(i),o.then(i,i)),u.state.loading|=4,u.instance=b,Ps(b);return}b=o.ownerDocument||o,h=K2(h),(p=Gr.get(p))&&dy(h,p),b=b.createElement("link"),Ps(b);var A=b;A._p=new Promise(function($,Z){A.onload=$,A.onerror=Z}),gn(b,"link",h),u.instance=b}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(i.count++,u=sp.bind(i),o.addEventListener("load",u),o.addEventListener("error",u))}}var fy=0;function aD(i,o){return i.stylesheets&&i.count===0&&rp(i,i.stylesheets),0<i.count||0<i.imgCount?function(u){var h=setTimeout(function(){if(i.stylesheets&&rp(i,i.stylesheets),i.unsuspend){var b=i.unsuspend;i.unsuspend=null,b()}},6e4+o);0<i.imgBytes&&fy===0&&(fy=62500*U3());var p=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&rp(i,i.stylesheets),i.unsuspend)){var b=i.unsuspend;i.unsuspend=null,b()}},(i.imgBytes>fy?50:800)+o);return i.unsuspend=u,function(){i.unsuspend=null,clearTimeout(h),clearTimeout(p)}}:null}function sp(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)rp(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var np=null;function rp(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,np=new Map,o.forEach(iD,i),np=null,sp.call(i))}function iD(i,o){if(!(o.state.loading&4)){var u=np.get(i);if(u)var h=u.get(null);else{u=new Map,np.set(i,u);for(var p=i.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<p.length;b++){var A=p[b];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(u.set(A.dataset.precedence,A),h=A)}h&&u.set(null,h)}p=o.instance,A=p.getAttribute("data-precedence"),b=u.get(A)||h,b===h&&u.set(null,p),u.set(A,p),this.count++,h=sp.bind(this),p.addEventListener("load",h),p.addEventListener("error",h),b?b.parentNode.insertBefore(p,b.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(p,i.firstChild)),o.state.loading|=4}}var Wh={$$typeof:V,Provider:null,Consumer:null,_currentValue:O,_currentValue2:O,_threadCount:0};function oD(i,o,u,h,p,b,A,$,Z){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=fr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fr(0),this.hiddenUpdates=fr(null),this.identifierPrefix=h,this.onUncaughtError=p,this.onCaughtError=b,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Z,this.incompleteTransitions=new Map}function Z2(i,o,u,h,p,b,A,$,Z,le,ve,Ee){return i=new oD(i,o,u,A,Z,le,ve,Ee,$),o=1,b===!0&&(o|=24),b=xr(3,null,null,o),i.current=b,b.stateNode=i,o=Gx(),o.refCount++,i.pooledCache=o,o.refCount++,b.memoizedState={element:h,isDehydrated:u,cache:o},Yx(b),i}function eS(i){return i?(i=nu,i):nu}function tS(i,o,u,h,p,b){p=eS(p),h.context===null?h.context=p:h.pendingContext=p,h=go(o),h.payload={element:u},b=b===void 0?null:b,b!==null&&(h.callback=b),u=po(i,h,o),u!==null&&(sr(u,i,o),Sh(u,i,o))}function sS(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<o?u:o}}function my(i,o){sS(i,o),(i=i.alternate)&&sS(i,o)}function nS(i){if(i.tag===13||i.tag===31){var o=Al(i,67108864);o!==null&&sr(o,i,67108864),my(i,67108864)}}function rS(i){if(i.tag===13||i.tag===31){var o=_r();o=xl(o);var u=Al(i,o);u!==null&&sr(u,i,o),my(i,o)}}var ap=!0;function lD(i,o,u,h){var p=R.T;R.T=null;var b=J.p;try{J.p=2,gy(i,o,u,h)}finally{J.p=b,R.T=p}}function cD(i,o,u,h){var p=R.T;R.T=null;var b=J.p;try{J.p=8,gy(i,o,u,h)}finally{J.p=b,R.T=p}}function gy(i,o,u,h){if(ap){var p=py(h);if(p===null)ty(i,o,h,ip,u),iS(i,h);else if(dD(p,i,o,u,h))h.stopPropagation();else if(iS(i,h),o&4&&-1<uD.indexOf(i)){for(;p!==null;){var b=Pr(p);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var A=Gt(b.pendingLanes);if(A!==0){var $=b;for($.pendingLanes|=2,$.entangledLanes|=2;A;){var Z=1<<31-Me(A);$.entanglements[1]|=Z,A&=~Z}$a(b),(Ot&6)===0&&(Bg=Le()+500,$h(0))}}break;case 31:case 13:$=Al(b,2),$!==null&&sr($,b,2),qg(),my(b,2)}if(b=py(h),b===null&&ty(i,o,h,ip,u),b===p)break;p=b}p!==null&&h.stopPropagation()}else ty(i,o,h,null,u)}}function py(i){return i=Mr(i),xy(i)}var ip=null;function xy(i){if(ip=null,i=Ea(i),i!==null){var o=l(i);if(o===null)i=null;else{var u=o.tag;if(u===13){if(i=c(o),i!==null)return i;i=null}else if(u===31){if(i=d(o),i!==null)return i;i=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return ip=i,null}function aS(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Lt()){case bs:return 2;case Zt:return 8;case Ws:case Ds:return 32;case En:return 268435456;default:return 32}default:return 32}}var by=!1,Eo=null,Io=null,Ao=null,Kh=new Map,Qh=new Map,ko=[],uD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function iS(i,o){switch(i){case"focusin":case"focusout":Eo=null;break;case"dragenter":case"dragleave":Io=null;break;case"mouseover":case"mouseout":Ao=null;break;case"pointerover":case"pointerout":Kh.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qh.delete(o.pointerId)}}function Yh(i,o,u,h,p,b){return i===null||i.nativeEvent!==b?(i={blockedOn:o,domEventName:u,eventSystemFlags:h,nativeEvent:b,targetContainers:[p]},o!==null&&(o=Pr(o),o!==null&&nS(o)),i):(i.eventSystemFlags|=h,o=i.targetContainers,p!==null&&o.indexOf(p)===-1&&o.push(p),i)}function dD(i,o,u,h,p){switch(o){case"focusin":return Eo=Yh(Eo,i,o,u,h,p),!0;case"dragenter":return Io=Yh(Io,i,o,u,h,p),!0;case"mouseover":return Ao=Yh(Ao,i,o,u,h,p),!0;case"pointerover":var b=p.pointerId;return Kh.set(b,Yh(Kh.get(b)||null,i,o,u,h,p)),!0;case"gotpointercapture":return b=p.pointerId,Qh.set(b,Yh(Qh.get(b)||null,i,o,u,h,p)),!0}return!1}function oS(i){var o=Ea(i.target);if(o!==null){var u=l(o);if(u!==null){if(o=u.tag,o===13){if(o=c(u),o!==null){i.blockedOn=o,ea(i.priority,function(){rS(u)});return}}else if(o===31){if(o=d(u),o!==null){i.blockedOn=o,ea(i.priority,function(){rS(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function op(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var u=py(i.nativeEvent);if(u===null){u=i.nativeEvent;var h=new u.constructor(u.type,u);ch=h,u.target.dispatchEvent(h),ch=null}else return o=Pr(u),o!==null&&nS(o),i.blockedOn=u,!1;o.shift()}return!0}function lS(i,o,u){op(i)&&u.delete(o)}function hD(){by=!1,Eo!==null&&op(Eo)&&(Eo=null),Io!==null&&op(Io)&&(Io=null),Ao!==null&&op(Ao)&&(Ao=null),Kh.forEach(lS),Qh.forEach(lS)}function lp(i,o){i.blockedOn===o&&(i.blockedOn=null,by||(by=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,hD)))}var cp=null;function cS(i){cp!==i&&(cp=i,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){cp===i&&(cp=null);for(var o=0;o<i.length;o+=3){var u=i[o],h=i[o+1],p=i[o+2];if(typeof h!="function"){if(xy(h||u)===null)continue;break}var b=Pr(u);b!==null&&(i.splice(o,3),o-=3,pb(b,{pending:!0,data:p,method:u.method,action:h},h,p))}}))}function Eu(i){function o(Z){return lp(Z,i)}Eo!==null&&lp(Eo,i),Io!==null&&lp(Io,i),Ao!==null&&lp(Ao,i),Kh.forEach(o),Qh.forEach(o);for(var u=0;u<ko.length;u++){var h=ko[u];h.blockedOn===i&&(h.blockedOn=null)}for(;0<ko.length&&(u=ko[0],u.blockedOn===null);)oS(u),u.blockedOn===null&&ko.shift();if(u=(i.ownerDocument||i).$$reactFormReplay,u!=null)for(h=0;h<u.length;h+=3){var p=u[h],b=u[h+1],A=p[en]||null;if(typeof b=="function")A||cS(u);else if(A){var $=null;if(b&&b.hasAttribute("formAction")){if(p=b,A=b[en]||null)$=A.formAction;else if(xy(p)!==null)continue}else $=A.action;typeof $=="function"?u[h+1]=$:(u.splice(h,3),h-=3),cS(u)}}}function uS(){function i(b){b.canIntercept&&b.info==="react-transition"&&b.intercept({handler:function(){return new Promise(function(A){return p=A})},focusReset:"manual",scroll:"manual"})}function o(){p!==null&&(p(),p=null),h||setTimeout(u,20)}function u(){if(!h&&!navigation.transition){var b=navigation.currentEntry;b&&b.url!=null&&navigation.navigate(b.url,{state:b.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,p=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(u,100),function(){h=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),p!==null&&(p(),p=null)}}}function yy(i){this._internalRoot=i}up.prototype.render=yy.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(n(409));var u=o.current,h=_r();tS(u,h,i,o,null,null)},up.prototype.unmount=yy.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;tS(i.current,2,null,i,null,null),qg(),o[Sa]=null}};function up(i){this._internalRoot=i}up.prototype.unstable_scheduleHydration=function(i){if(i){var o=qm();i={blockedOn:null,target:i,priority:o};for(var u=0;u<ko.length&&o!==0&&o<ko[u].priority;u++);ko.splice(u,0,i),u===0&&oS(i)}};var dS=e.version;if(dS!=="19.2.3")throw Error(n(527,dS,"19.2.3"));J.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=m(o),i=i!==null?x(i):null,i=i===null?null:i.stateNode,i};var fD={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:R,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dp.isDisabled&&dp.supportsFiber)try{pe=dp.inject(fD),Re=dp}catch{}}return Xh.createRoot=function(i,o){if(!a(i))throw Error(n(299));var u=!1,h="",p=bN,b=yN,A=wN;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onUncaughtError!==void 0&&(p=o.onUncaughtError),o.onCaughtError!==void 0&&(b=o.onCaughtError),o.onRecoverableError!==void 0&&(A=o.onRecoverableError)),o=Z2(i,1,!1,null,null,u,h,null,p,b,A,uS),i[Sa]=o.current,ey(i),new yy(o)},Xh.hydrateRoot=function(i,o,u){if(!a(i))throw Error(n(299));var h=!1,p="",b=bN,A=yN,$=wN,Z=null;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(p=u.identifierPrefix),u.onUncaughtError!==void 0&&(b=u.onUncaughtError),u.onCaughtError!==void 0&&(A=u.onCaughtError),u.onRecoverableError!==void 0&&($=u.onRecoverableError),u.formState!==void 0&&(Z=u.formState)),o=Z2(i,1,!0,o,u??null,h,p,Z,b,A,$,uS),o.context=eS(null),u=o.current,h=_r(),h=xl(h),p=go(h),p.callback=null,po(u,p,h),u=h,o.current.lanes=u,Ln(o,u),$a(o),i[Sa]=o.current,ey(i),new up(o)},Xh.version="19.2.3",Xh}var vS;function jD(){if(vS)return _y.exports;vS=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),_y.exports=_D(),_y.exports}var ND=jD(),ue=(s=>(s.WaitingMerchant=" ",s.Preparing=" ",s.Pending=" ",s.InTransit=" ",s.Delivered=" ",s.Cancelled="",s))(ue||{});const SD=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"m4.9 4.9 14.2 14.2"})]}),TD=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),ED=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"}),r.jsx("circle",{cx:"7",cy:"17",r:"2"}),r.jsx("path",{d:"M9 17h6"}),r.jsx("circle",{cx:"17",cy:"17",r:"2"})]}),ff=s=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:r.jsx("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"})}),an=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),r.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),rt=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Vd=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),nt=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"m9 11 3 3L22 4"})]}),wt=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),pt=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),L5=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3v1a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h14"}),r.jsx("path",{d:"M3 5v14"})]}),k0=s=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:r.jsx("path",{d:"m6 9 6 6 6-6"})}),Pt=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M10 11v6"}),r.jsx("path",{d:"M14 11v6"})]}),bm=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}),r.jsx("path",{d:"m10 17 5-5-5-5"}),r.jsx("path",{d:"M15 12H3"})]}),Ev=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("path",{d:"M9 22V12h6v10"})]}),Pc=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),r.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]}),Bt=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11"}),r.jsx("path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2"}),r.jsx("circle",{cx:"7.5",cy:"18.5",r:"2.5"}),r.jsx("circle",{cx:"17.5",cy:"18.5",r:"2.5"})]}),C0=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}),r.jsx("path",{d:"m3.29 7 8.71 5 8.71-5"}),r.jsx("path",{d:"m12 22 8.71-5"}),r.jsx("path",{d:"M12 12v10"})]}),ma=s=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:r.jsx("path",{d:"m9 18 6-6-6-6"})}),Gs=s=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:r.jsx("path",{d:"m15 18-6-6 6-6"})}),Js=s=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:r.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})}),cc=s=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...s,children:r.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"})}),cr=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"}),r.jsx("path",{d:"m15 5 4 4"})]}),Wn=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),r.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M12 11h4"}),r.jsx("path",{d:"M12 16h4"}),r.jsx("path",{d:"M8 11h.01"}),r.jsx("path",{d:"M8 16h.01"})]}),ID=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("line",{x1:"19",x2:"19",y1:"8",y2:"14"}),r.jsx("line",{x1:"22",x2:"16",y1:"11",y2:"11"})]}),V5=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("circle",{cx:"6",cy:"19",r:"3"}),r.jsx("path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"}),r.jsx("circle",{cx:"18",cy:"5",r:"3"})]}),AD=s=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:r.jsx("path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"})}),kr=s=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),Kn=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),sd=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M5 3v4"}),r.jsx("path",{d:"M19 17v4"}),r.jsx("path",{d:"M3 5h4"}),r.jsx("path",{d:"M17 19h4"}),r.jsx("path",{d:"M9 21a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2"}),r.jsx("path",{d:"M15 3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2"})]}),jn=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"}),r.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),Qo=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7"}),r.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),r.jsx("path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4"}),r.jsx("path",{d:"M2 7h20"}),r.jsx("path",{d:"M12 7v5"})]}),U5=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1Z"}),r.jsx("path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"}),r.jsx("path",{d:"M12 17.5v-11"})]}),_S=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),r.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),r.jsx("path",{d:"M12 11v6"}),r.jsx("path",{d:"M9 14h6"})]}),Qp=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}),r.jsx("path",{d:"M21 3v5h-5"}),r.jsx("path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}),r.jsx("path",{d:"M3 21v-5h5"})]}),on=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),r.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),hp=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M17.5 19c0-3.037-2.463-5.5-5.5-5.5S6.5 15.963 6.5 19"}),r.jsx("path",{d:"M20 16.95a6 6 0 0 0-5.34-9.98"}),r.jsx("path",{d:"M4 16.95A6 6 0 0 1 9.34 6.97"}),r.jsx("path",{d:"M12 3v1"})]}),ur=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),r.jsx("polyline",{points:"17 8 12 3 7 8"}),r.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),ym=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),r.jsx("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),r.jsx("line",{x1:"6",y1:"20",x2:"6",y2:"14"})]}),il=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),r.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),r.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),r.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),Ci=s=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),kD=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("line",{x1:"2",y1:"2",x2:"22",y2:"22"}),r.jsx("path",{d:"M8.5 16.429a5 5 0 0 1 7 0"}),r.jsx("path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69"}),r.jsx("path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523"}),r.jsx("path",{d:"M2 8.82a15 15 0 0 1 4.17-2.692"}),r.jsx("path",{d:"M22 8.82a15 15 0 0 0-11.288-3.136"}),r.jsx("path",{d:"M12 20h.01"})]}),Iv=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),r.jsx("path",{d:"M12 9v4"}),r.jsx("path",{d:"M12 17h.01"})]}),Nn=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("circle",{cx:"8",cy:"21",r:"1"}),r.jsx("circle",{cx:"19",cy:"21",r:"1"}),r.jsx("path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"})]}),Xr=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"}),r.jsx("path",{d:"M7 2v20"}),r.jsx("path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"})]}),Qr=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),r.jsx("circle",{cx:"9",cy:"9",r:"2"}),r.jsx("path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"})]}),ln=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M5 12h14"}),r.jsx("path",{d:"M12 5v14"})]}),F5=s=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:r.jsx("path",{d:"M5 12h14"})}),Sn=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("rect",{width:"7",height:"7",x:"3",y:"3",rx:"1"}),r.jsx("rect",{width:"7",height:"7",x:"14",y:"3",rx:"1"}),r.jsx("rect",{width:"7",height:"7",x:"14",y:"14",rx:"1"}),r.jsx("rect",{width:"7",height:"7",x:"3",y:"14",rx:"1"})]}),ga=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]}),wa=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"}),r.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),Ui=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24"}),r.jsx("path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"}),r.jsx("path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"}),r.jsx("line",{x1:"2",x2:"22",y1:"2",y2:"22"})]}),CD=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2"}),r.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]}),_w=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("rect",{width:"20",height:"16",x:"2",y:"4",rx:"2"}),r.jsx("path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"})]}),$f=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),r.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),RD=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("polyline",{points:"9 11 12 14 22 4"}),r.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})]}),DD=s=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:r.jsx("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"})}),lr=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7"}),r.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),r.jsx("path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4"})]}),Rr=s=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:r.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})}),Av=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("circle",{cx:"13.5",cy:"6.5",r:".5"}),r.jsx("circle",{cx:"17.5",cy:"10.5",r:".5"}),r.jsx("circle",{cx:"8.5",cy:"7.5",r:".5"}),r.jsx("circle",{cx:"6.5",cy:"12.5",r:".5"}),r.jsx("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"})]}),zt=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"}),r.jsx("path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"}),r.jsx("path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"}),r.jsx("path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"})]}),Bf=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"}),r.jsx("path",{d:"M13 5v2"}),r.jsx("path",{d:"M13 17v2"}),r.jsx("path",{d:"M13 11v2"})]}),Yr=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}),r.jsx("path",{d:"m9 12 2 2 4-4"})]}),R0=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("circle",{cx:"8",cy:"8",r:"6"}),r.jsx("path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18"}),r.jsx("path",{d:"M7 6h1v4"}),r.jsx("path",{d:"m16.71 13.88.7 .71-2.82 2.82"})]}),$5=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),r.jsx("polyline",{points:"17 6 23 6 23 12"})]}),OD=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("polyline",{points:"23 18 13.5 8.5 8.5 13.5 1 6"}),r.jsx("polyline",{points:"17 18 23 18 23 12"})]}),Dr=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3"}),r.jsx("path",{d:"M14 19a6 6 0 0 0-9.33-5"})]}),B5=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),kv=s=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:r.jsx("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"})}),va=s=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:r.jsx("path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14"})}),qi=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),jw=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),r.jsx("polyline",{points:"7 10 12 15 17 10"}),r.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),nd=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("polyline",{points:"9 17 4 12 9 7"}),r.jsx("path",{d:"M20 18v-2a4 4 0 0 0-4-4H4"})]}),jS=s=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:r.jsx("path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"})}),PD=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),MD=s=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),r.jsx("polyline",{points:"12 5 19 12 12 19"})]}),z5=({status:s})=>{const t=(()=>{switch(s){case ue.WaitingMerchant:return{style:"bg-purple-500/10 text-purple-400 border-purple-500/20 shadow-[0_0_10px_rgba(168,85,247,0.15)]",icon:r.jsx(wt,{className:"w-3.5 h-3.5"})};case ue.Preparing:return{style:"bg-orange-500/10 text-orange-400 border-orange-500/20 shadow-[0_0_10px_rgba(249,115,22,0.15)]",icon:r.jsx(Xr,{className:"w-3.5 h-3.5"})};case ue.Pending:return{style:"bg-yellow-500/10 text-yellow-400 border-yellow-500/20 shadow-[0_0_10px_rgba(234,179,8,0.15)]",icon:r.jsx(Nn,{className:"w-3.5 h-3.5"})};case ue.InTransit:return{style:"bg-blue-500/10 text-blue-400 border-blue-500/20 shadow-[0_0_10px_rgba(59,130,246,0.15)]",icon:r.jsx(Bt,{className:"w-3.5 h-3.5"})};case ue.Delivered:return{style:"bg-teal-500/10 text-teal-400 border-teal-500/20 shadow-[0_0_10px_rgba(45,212,191,0.15)]",icon:r.jsx(nt,{className:"w-3.5 h-3.5"})};case ue.Cancelled:return{style:"bg-red-500/10 text-red-400 border-red-500/20 shadow-[0_0_10px_rgba(239,68,68,0.15)]",icon:r.jsx(rt,{className:"w-3.5 h-3.5"})};default:return{style:"bg-gray-500/10 text-gray-400 border-gray-500/20",icon:r.jsx(wt,{className:"w-3.5 h-3.5"})}}})();return r.jsxs("span",{className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg border text-[10px] font-bold tracking-wide transition-all duration-300 backdrop-blur-sm ${t.style}`,children:[t.icon,s]})},LD=Ar.memo(({order:s,users:e,onEdit:t,onDelete:n,onOpenStatusModal:a})=>{var w,v,T,I;const l=j.useMemo(()=>e.find(N=>N.id===s.driverId),[e,s.driverId]),c=j.useMemo(()=>e.find(N=>N.id===s.merchantId),[e,s.merchantId]),d=s.type==="shopping_order",f=N=>{try{if(!N)return null;let P;return typeof N.toDate=="function"?P=N.toDate():N.seconds?P=new Date(N.seconds*1e3):P=new Date(N),isNaN(P.getTime())?null:P}catch{return null}},m=j.useMemo(()=>{const N=f(s.createdAt);if(!N)return{date:"---",time:"---",day:"---"};const P=N.toLocaleDateString("ar-EG-u-nu-latn",{weekday:"long"}),U=N.toLocaleDateString("ar-EG-u-nu-latn",{day:"numeric",month:"numeric",year:"numeric"}),V=N.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric",hour12:!0});return{day:P,date:U,time:V}},[s.createdAt]),x=j.useMemo(()=>{if(s.status!==ue.Delivered||!s.deliveredAt)return null;const N=f(s.deliveredAt);return N?N.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric",hour12:!0}):null},[s.status,s.deliveredAt]),y=()=>{if(d)return"border-orange-500";switch(s.status){case ue.Delivered:return"border-teal-500";case ue.InTransit:return"border-blue-500";case ue.Cancelled:return"border-red-500";case ue.Pending:return"border-yellow-500";default:return"border-gray-500"}};return r.jsxs("div",{className:`relative bg-gray-800 rounded-xl shadow-lg border-r-4 ${y()} overflow-hidden admin-order-card transform-gpu will-change-transform`,children:[r.jsxs("div",{className:"p-4 border-b border-gray-700/50 flex justify-between items-start bg-gray-900/30",children:[r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-mono text-xl font-black text-red-500 tracking-tighter",children:s.id}),d&&r.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 rounded text-[10px] font-bold bg-orange-500/20 text-orange-400 border border-orange-500/20",children:[r.jsx(zt,{className:"w-3 h-3"})," "]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-700/60 px-2 py-1 rounded border border-white/5 shadow-inner",children:[r.jsx(il,{className:"w-3.5 h-3.5 text-blue-400"}),r.jsxs("span",{className:"text-[11px] font-black text-white",children:[m.day," ",m.date]})]}),r.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-700/60 px-2 py-1 rounded border border-white/5 shadow-inner",children:[r.jsx(wt,{className:"w-3.5 h-3.5 text-yellow-400"}),r.jsx("span",{className:"text-[11px] font-black text-white font-mono",children:m.time})]}),x&&r.jsxs("div",{className:"flex items-center gap-1.5 bg-teal-500/10 px-2 py-1 rounded border border-teal-500/20 shadow-inner animate-fadeIn",children:[r.jsx(nt,{className:"w-3.5 h-3.5 text-teal-400"}),r.jsxs("span",{className:"text-[11px] font-black text-teal-400 font-mono",children:[": ",x]})]})]})]}),r.jsx("div",{className:"flex flex-col items-end gap-1",children:r.jsx(z5,{status:s.status})})]}),r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex flex-col bg-gray-900/20 rounded-xl p-3 border border-white/5",children:[r.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[r.jsx("div",{className:"mt-1 p-1.5 rounded-full bg-blue-500/10 text-blue-400 flex-shrink-0",children:r.jsx(pt,{className:"w-4 h-4"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("p",{className:"text-[10px] text-gray-500 mb-0.5 flex items-center gap-1",children:[r.jsx(jn,{className:"w-3 h-3"}),"  "]}),r.jsx("p",{className:"text-white font-bold text-sm leading-snug break-words",children:((w=s.customer)==null?void 0:w.address)||"  "})]})]}),r.jsx("div",{className:"flex justify-end pt-2 border-t border-gray-700/30",children:r.jsxs("div",{className:"flex items-center gap-2",dir:"ltr",children:[((v=s.customer)==null?void 0:v.phone)&&r.jsx("a",{href:`https://wa.me/2${s.customer.phone}`,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 flex-shrink-0 bg-green-500/10 text-green-400 rounded-lg hover:bg-green-500/20 transition-all border border-green-500/10 clickable",title:"",children:r.jsx(cc,{className:"w-3.5 h-3.5"})}),r.jsx("a",{href:`tel:${(T=s.customer)==null?void 0:T.phone}`,className:"p-1.5 flex-shrink-0 bg-blue-500/10 text-blue-400 rounded-lg hover:bg-blue-500/20 transition-all border border-blue-500/10 clickable",title:"",children:r.jsx(Js,{className:"w-3.5 h-3.5"})}),r.jsx("span",{className:"text-xs text-gray-300 font-mono bg-black/20 px-2 py-1 rounded border border-gray-700 selectable font-bold tracking-wide",children:((I=s.customer)==null?void 0:I.phone)||""})]})})]}),r.jsxs("div",{className:"flex flex-col bg-orange-900/10 p-3 rounded-xl border border-orange-500/10",children:[r.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[r.jsx("div",{className:"mt-1 p-1.5 rounded-full bg-orange-500/10 text-orange-400 flex-shrink-0",children:r.jsx(lr,{className:"w-4 h-4"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-[10px] text-orange-400 font-bold mb-0.5",children:" ()"}),r.jsx("p",{className:"text-white font-black text-sm truncate",children:s.merchantId==="delinow"?"  ":(c==null?void 0:c.name)||s.merchantName||"   "})]})]}),r.jsx("div",{className:"mt-2 text-sm text-gray-300 border-t border-orange-500/10 pt-2 space-y-1",children:s.merchantId==="delinow"?r.jsxs("div",{className:"bg-gray-900/40 p-2 rounded-lg border border-gray-700/30",children:[r.jsx("p",{className:"text-[10px] text-gray-500 font-bold mb-1",children:"  :"}),r.jsx("p",{className:"text-white leading-relaxed whitespace-pre-wrap text-xs",children:s.notes||"  "})]}):r.jsxs("div",{className:"space-y-1.5",children:[s.notes&&r.jsxs("div",{className:"bg-gray-900/40 p-2 rounded-lg border border-gray-700/30 mb-2",children:[r.jsx("p",{className:"text-[10px] text-orange-400 font-bold mb-1",children:" :"}),r.jsx("p",{className:"text-white leading-relaxed whitespace-pre-wrap text-xs",children:s.notes})]}),s.items&&s.items.length>0?r.jsxs(r.Fragment,{children:[s.items.map((N,P)=>r.jsxs("div",{className:"flex justify-between items-center text-xs bg-gray-900/40 p-1.5 rounded border border-gray-700/30",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"font-bold text-orange-400 font-mono",children:["x",N.quantity]}),r.jsx("span",{className:"text-white",children:N.name}),N.selectedSize&&r.jsxs("span",{className:"text-[9px] text-gray-500",children:["(",N.selectedSize.name,")"]})]}),r.jsxs("span",{className:"text-gray-400 font-mono font-bold",children:[(N.price*N.quantity).toLocaleString()," ."]})]},P)),r.jsxs("div",{className:"flex justify-between items-center pt-1 mt-1 border-t border-gray-700/30 font-bold text-xs",children:[r.jsx("span",{className:"text-gray-400",children:":"}),r.jsxs("span",{className:"text-white",children:[s.items.reduce((N,P)=>N+P.price*P.quantity,0).toLocaleString()," ."]})]})]}):null]})}),s.merchantId!=="delinow"&&((c==null?void 0:c.phone)||s.merchantId)&&r.jsx("div",{className:"flex justify-end pt-2 border-t border-orange-500/10 mt-1",children:r.jsxs("div",{className:"flex items-center gap-2",dir:"ltr",children:[r.jsx("a",{href:`https://wa.me/2${(c==null?void 0:c.phone)||s.merchantId}`,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 flex-shrink-0 bg-green-500/10 text-green-400 rounded-lg hover:bg-green-500/20 transition-all border border-green-500/10 clickable",title:"",children:r.jsx(cc,{className:"w-3.5 h-3.5"})}),r.jsx("a",{href:`tel:${(c==null?void 0:c.phone)||s.merchantId}`,className:"p-1.5 flex-shrink-0 bg-blue-500/10 text-blue-400 rounded-lg hover:bg-blue-500/20 transition-all border border-blue-500/10 clickable",title:"",children:r.jsx(Js,{className:"w-3.5 h-3.5"})}),r.jsx("span",{className:"text-xs text-gray-300 font-mono bg-black/20 px-2 py-1 rounded border border-gray-700 selectable font-bold tracking-wide",children:(c==null?void 0:c.phone)||s.merchantId})]})})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-5 bg-gray-900/40 p-2 rounded-lg border border-gray-700/30",children:[r.jsx("div",{className:"flex flex-col justify-center pl-2",children:l?r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-7 h-7 rounded-full bg-gray-700 border border-gray-600 flex items-center justify-center overflow-hidden flex-shrink-0",children:l.storeImage?r.jsx("img",{src:l.storeImage,alt:l.name,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-3.5 h-3.5 text-gray-400"})}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-[9px] text-gray-500 mb-0.5",children:""}),r.jsx("p",{className:"text-white text-xs font-bold truncate leading-tight",children:l.name})]})]}),l.phone&&r.jsxs("div",{className:"flex items-center gap-1.5 pt-1.5 mt-1 border-t border-gray-700/30 w-fit",dir:"ltr",children:[r.jsx("a",{href:`https://wa.me/2${l.phone}`,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 flex-shrink-0 bg-green-500/10 text-green-400 rounded-lg hover:bg-green-500/20 transition-all border border-green-500/10 clickable",title:"",children:r.jsx(cc,{className:"w-3.5 h-3.5"})}),r.jsx("a",{href:`tel:${l.phone}`,className:"p-1.5 flex-shrink-0 bg-blue-500/10 text-blue-400 rounded-lg hover:bg-blue-500/20 transition-all border border-blue-500/10 clickable",title:"",children:r.jsx(Js,{className:"w-3.5 h-3.5"})}),r.jsx("span",{className:"text-[10px] text-gray-300 font-mono bg-black/20 px-2 py-1 rounded border border-gray-700 selectable font-bold tracking-wide",children:l.phone})]})]}):r.jsxs("div",{className:"flex items-center gap-2 h-full",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 border border-gray-700 flex items-center justify-center flex-shrink-0",children:r.jsx(Bt,{className:"w-4 h-4 text-gray-500"})}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-[9px] text-gray-500 mb-0.5",children:""}),r.jsx("p",{className:"text-white text-xs font-bold truncate",children:" "})]})]})}),r.jsxs("div",{className:"flex items-center gap-2 border-r border-gray-700 pr-6 pl-1",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-amber-500/10 border border-amber-500/20 flex items-center justify-center flex-shrink-0",children:r.jsx(Pc,{className:"w-4 h-4 text-amber-500"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-[9px] text-gray-500",children:" "}),r.jsx("p",{className:"text-amber-400 text-xs font-bold",children:s.deliveryFee?`${s.deliveryFee.toLocaleString("en-US")} .`:"-"})]})]})]})]}),r.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-900/80 border-t border-gray-700/50",children:[a?r.jsxs("button",{onClick:N=>{N.stopPropagation(),a(s)},className:"text-[10px] font-bold bg-gray-700 hover:bg-gray-600 text-white border border-gray-600 rounded-lg px-3 py-1.5 flex items-center transition-all clickable",children:[r.jsx(cr,{className:"w-3.5 h-3.5 ml-1 text-gray-300"}),r.jsx("span",{children:" "})]}):r.jsx("div",{}),r.jsxs("div",{className:"flex items-center gap-1",children:[t&&r.jsx("button",{onClick:N=>{N.stopPropagation(),t(s)},className:"p-2 text-blue-400 hover:text-white hover:bg-blue-600 rounded-lg transition-colors border border-blue-500/20 bg-blue-500/10 clickable",children:r.jsx(cr,{className:"w-4 h-4"})}),n&&r.jsx("button",{onClick:N=>{N.stopPropagation(),N.preventDefault(),n(s)},className:"p-2 text-red-400 hover:bg-red-600 hover:text-white rounded-lg transition-colors border border-red-500/20 bg-red-500/10 clickable",children:r.jsx(Pt,{className:"w-4 h-4"})})]})]})]})}),VD=({order:s,merchants:e,drivers:t,onClose:n,onSave:a})=>{const[l,c]=j.useState(s.customer||{phone:"",address:""}),[d,f]=j.useState(s.notes||""),[m,x]=j.useState(s.merchantId),[y,w]=j.useState(s.driverId||""),[v,T]=j.useState(s.deliveryFee!==void 0&&s.deliveryFee!==null?s.deliveryFee:""),[I,N]=j.useState(s.items||[]),[P,U]=j.useState(s.totalPrice||0),[V,q]=j.useState(""),W=s.type==="shopping_order"&&I.length>0?"products":"details",[z,k]=j.useState(W),M="w-full px-4 py-3 border border-gray-600 bg-[#111] text-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors text-sm";j.useEffect(()=>{if(I.length>0){const Y=I.reduce((X,R)=>X+R.price*R.quantity,0);U(Y)}else U(0)},[I]);const B=j.useMemo(()=>{const Y=v===""?0:parseFloat(String(v)),X=isNaN(Y)?0:Y;return P+X},[P,v]),D=(Y,X)=>{const R=parseFloat(X);if(isNaN(R))return;const J=[...I];J[Y]={...J[Y],price:R},N(J)},S=()=>{if(!l.phone||!l.address||!m){q("    ."),(!l.phone||!l.address||!m)&&k("details");return}if(!/^\d{11}$/.test(l.phone)){q("      11 ."),k("details");return}const Y=v!==""?parseFloat(String(v)):null;if(s.status===ue.Pending&&y&&(Y==null||Y<=0)){q("          ."),k("delivery");return}const X=e.find(O=>O.id===m),R=X?X.name:s.merchantName||"Unknown";q("");const J={customer:l,notes:d,merchantId:m,merchantName:R,driverId:y||null,deliveryFee:Y};s.type==="shopping_order"&&(J.items=I,J.totalPrice=P),a(J)},F=Y=>{c({...l,[Y.target.name]:Y.target.value})},E=(Y,X,R,J=!0)=>{if(!J)return null;const O=z===Y;return r.jsxs("button",{onClick:()=>k(Y),className:`flex-1 py-3 px-2 text-center text-xs font-bold transition-all border-b-2 flex items-center justify-center gap-2 ${O?"border-blue-500 text-blue-400 bg-[#1f2937]":"border-transparent text-gray-500 hover:text-gray-300 hover:bg-[#1f2937]/50"}`,children:[R,X]})};return r.jsxs("div",{className:"fixed inset-0 z-[200] bg-[#111827] flex flex-col",children:[r.jsxs("div",{className:"flex-none bg-[#1f2937] border-b border-gray-700 flex items-center justify-between px-4 pt-8 pb-4 min-h-[90px] shadow-xl z-20",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:n,className:"bg-gray-800 p-2 rounded-full text-gray-400 hover:text-white transition-colors border border-gray-700",children:r.jsx(Gs,{className:"w-5 h-5 rotate-180"})}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-base font-bold text-white flex items-center gap-2",children:[r.jsx(cr,{className:"w-4 h-4 text-blue-400"})," "]}),r.jsxs("p",{className:"font-mono text-[10px] text-blue-300 opacity-80 tracking-wider",children:["#",s.id.slice(0,8)]})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("div",{className:"hidden md:block text-right",children:[r.jsx("p",{className:"text-[10px] text-gray-400",children:""}),r.jsxs("p",{className:"text-sm font-bold text-green-400 font-mono",children:[B.toLocaleString()," ."]})]}),r.jsxs("button",{onClick:S,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-xl transition-all shadow-lg active:scale-95 text-sm flex items-center gap-2",children:[r.jsx(nt,{className:"w-4 h-4"}),""]})]})]}),r.jsxs("div",{className:"flex-none bg-[#111] border-b border-gray-800 flex sticky top-0 z-10",children:[E("details","",r.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"})),E("products","",r.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500"}),s.type==="shopping_order"),E("delivery","",r.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}))]}),r.jsx("div",{className:"flex-1 overflow-y-auto bg-[#111827] relative",children:r.jsxs("div",{className:"p-4 pb-12 space-y-4",children:[V&&r.jsx("div",{className:"bg-red-900/20 p-3 rounded-xl border border-red-500/50 text-center animate-bounce mb-4",children:r.jsx("p",{className:"text-red-400 text-xs font-bold",children:V})}),z==="details"&&r.jsx("div",{className:"space-y-4 animate-fadeIn",children:r.jsxs("div",{className:"bg-[#1f2937] p-4 rounded-2xl border border-gray-700",children:[r.jsx("h4",{className:"text-xs font-bold text-gray-400 mb-4 uppercase tracking-wider",children:"  "}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-500 mb-1.5 font-bold",children:""}),r.jsxs("select",{value:m,onChange:Y=>x(Y.target.value),className:M,required:!0,children:[r.jsx("option",{value:"",disabled:!0,children:"--   --"}),e.map(Y=>r.jsx("option",{value:Y.id,children:Y.name},Y.id))]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-500 mb-1.5 font-bold",children:" "}),r.jsx("input",{type:"tel",name:"phone",value:l.phone,onChange:F,className:`${M} font-mono text-center text-lg tracking-widest`,required:!0,dir:"ltr"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-500 mb-1.5 font-bold",children:" "}),r.jsx("input",{type:"text",name:"address",value:l.address,onChange:F,className:M,required:!0})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-500 mb-1.5 font-bold",children:" "}),r.jsx("textarea",{value:d,onChange:Y=>f(Y.target.value),rows:3,className:`${M} resize-none`})]})]})]})}),z==="products"&&r.jsxs("div",{className:"space-y-3 animate-fadeIn",children:[r.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/20 p-3 rounded-xl flex justify-between items-center mb-2",children:[r.jsx("span",{className:"text-yellow-500 text-xs font-bold",children:"    "}),r.jsxs("span",{className:"text-white font-mono text-sm font-bold bg-yellow-500/20 px-2 py-1 rounded",children:[P.toLocaleString()," ."]})]}),I.map((Y,X)=>r.jsxs("div",{className:"flex items-center gap-3 bg-[#1f2937] p-3 rounded-xl border border-gray-700 shadow-sm",children:[r.jsx("div",{className:"w-14 h-14 bg-[#111] rounded-lg overflow-hidden flex-shrink-0 border border-gray-600",children:Y.image?r.jsx("img",{src:Y.image,alt:Y.name,className:"w-full h-full object-cover"}):r.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:r.jsx(Qr,{className:"w-5 h-5"})})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-white text-sm font-bold truncate",children:Y.name}),r.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[": ",r.jsx("span",{className:"text-blue-300 font-mono font-bold",children:Y.quantity})]})]}),r.jsxs("div",{className:"w-24",children:[r.jsx("label",{className:"text-[9px] text-gray-500 block mb-1 text-center",children:""}),r.jsx("input",{type:"number",value:Y.price,onChange:R=>D(X,R.target.value),className:"w-full bg-[#111] border border-gray-600 text-white text-sm rounded-lg py-2 text-center focus:border-yellow-500 focus:outline-none font-bold"})]})]},X))]}),z==="delivery"&&r.jsxs("div",{className:"space-y-4 animate-fadeIn",children:[r.jsxs("div",{className:"bg-[#1f2937] p-4 rounded-xl border border-gray-700",children:[r.jsx("label",{className:"block text-xs text-gray-400 mb-2 font-bold uppercase",children:"  (EGP)"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"number",value:v,onChange:Y=>T(Y.target.value),placeholder:"0",className:"w-full bg-[#111] border border-gray-600 text-white text-xl font-bold py-3 px-4 pl-12 rounded-xl focus:border-blue-500 focus:outline-none font-mono"}),r.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-bold text-xs",children:"EGP"})]})]}),r.jsxs("div",{className:"bg-[#1f2937] p-4 rounded-xl border border-gray-700 flex-1 flex flex-col",children:[r.jsxs("h4",{className:"text-xs font-bold text-gray-400 mb-3 uppercase tracking-wider flex justify-between items-center",children:[r.jsx("span",{children:" "}),r.jsxs("span",{className:"text-[10px] bg-gray-700 px-2 py-0.5 rounded-full text-white",children:[t.length," "]})]}),r.jsxs("div",{className:"space-y-2 max-h-[400px] overflow-y-auto custom-scrollbar",children:[r.jsxs("button",{onClick:()=>w(""),className:`w-full flex justify-between items-center text-right p-3 rounded-xl transition-all border ${y===""?"bg-red-500/10 border-red-500/50":"bg-[#111] border-gray-800 hover:border-gray-600"}`,children:[r.jsx("span",{className:`text-sm font-bold ${y===""?"text-red-400":"text-gray-400"}`,children:"  ()"}),y===""&&r.jsx(nt,{className:"w-5 h-5 text-red-500"})]}),t.map(Y=>r.jsxs("button",{onClick:()=>w(Y.id),className:`w-full flex justify-between items-center text-right p-3 rounded-xl transition-all border ${y===Y.id?"bg-blue-600 border-blue-500 shadow-lg scale-[1.01]":"bg-[#111] border-gray-800 hover:border-gray-500"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs ${y===Y.id?"bg-white text-blue-600":"bg-gray-800 text-gray-400"}`,children:Y.name.charAt(0)}),r.jsxs("div",{children:[r.jsx("span",{className:`font-bold text-sm block ${y===Y.id?"text-white":"text-gray-200"}`,children:Y.name}),r.jsx("span",{className:`text-[10px] font-mono ${y===Y.id?"text-blue-100":"text-gray-500"}`,children:Y.phone})]})]}),y===Y.id&&r.jsx(nt,{className:"w-5 h-5 text-white"})]},Y.id))]})]})]})]})})]})};var Cv=M5();const Pi=s=>{try{const e=new Set;return JSON.stringify(s,(t,n)=>{if(typeof n=="object"&&n!==null){if(e.has(n))return"[Circular]";e.add(n)}return n})}catch{return"{}"}},Bl=[],Is={isAndroid:()=>typeof window<"u"&&!!window.Android,subscribeBackHandler:s=>{const e=Bl.indexOf(s);return e>-1&&Bl.splice(e,1),Bl.push(s),()=>{const t=Bl.indexOf(s);t>-1&&Bl.splice(t,1)}},handleBackPress:()=>{for(let s=Bl.length-1;s>=0;s--){const e=Bl[s];if(e&&typeof e=="function"&&e())return console.log(`[NativeBridge] Back press handled by listener at index ${s}`),!0}return console.log("[NativeBridge] Back press NOT handled by any listener. Default Android behavior."),!1},showNotification:(s,e)=>{var t;if(Is.isAndroid())try{(t=window.Android)==null||t.showAndroidNotification(s,e)}catch{}},playSound:()=>{var s,e;Is.isAndroid()&&((e=(s=window.Android)==null?void 0:s.playNotificationSound)==null||e.call(s))},reportContext:s=>{var e,t;Is.isAndroid()&&((t=(e=window.Android)==null?void 0:e.onContextChange)==null||t.call(e,s))},loginSuccess:s=>{var e,t;Is.isAndroid()&&(console.log("[NativeBridge] Reporting Login Success to Android"),(t=(e=window.Android)==null?void 0:e.onLoginSuccess)==null||t.call(e,Pi(s)))},hideSplashScreen:()=>{console.log("NativeBridge: Requesting Splash Hide"),typeof window<"u"&&window.AndroidSplash&&(console.log("[NativeBridge] Hiding Native Splash Screen"),window.AndroidSplash.hideSplash())}};typeof window<"u"&&(window.handleAndroidBack=Is.handleBackPress,window.onBackPressed=Is.handleBackPress);const wm=(s,e)=>{var t,n,a,l,c,d,f,m,x,y,w,v,T,I;if(Is.isAndroid()){console.log(`[NativeBridge] Configuring Role: ${s}, ID: ${e}`),(n=(t=window.Android)==null?void 0:t.setAppRole)==null||n.call(t,s);let N=s;if(s==="customer"&&(N="user"),["admin","drivers","merchants","users","driver","merchant","user","supervisor","supervisors"].forEach(q=>{var W;if((W=window.Android)!=null&&W.unsubscribeFromTopic)try{window.Android.unsubscribeFromTopic(q)}catch{}}),N==="merchant"&&e){const q=`driver_${e}`;(l=(a=window.Android)==null?void 0:a.unsubscribeFromTopic)==null||l.call(a,q)}if(N==="driver"&&e){const q=`merchant_${e}`;(d=(c=window.Android)==null?void 0:c.unsubscribeFromTopic)==null||d.call(c,q)}const U=[];let V="";if(N==="admin"?V="admin_v2":V=N+"s_v2",V&&((m=(f=window.Android)==null?void 0:f.subscribeToTopic)==null||m.call(f,V),U.push(V)),e){const q=`${N}_${e}_v2`;(y=(x=window.Android)==null?void 0:x.subscribeToTopic)==null||y.call(x,q),(v=(w=window.Android)==null?void 0:w.setActiveNotificationChannel)==null||v.call(w,q),U.push(q)}(I=(T=window.Android)==null?void 0:T.subscribeToTopic)==null||I.call(T,"all_users_v2"),U.push("all_users_v2"),console.log(`[NativeBridge] Active Notification Channels: ${U.join(", ")}`)}},Hu=(s,e)=>{var t,n;Is.isAndroid()&&(console.log(`[NativeBridge] Logging out from Android Native layer. ID: ${s}, Role: ${e}`),(n=(t=window.Android)==null?void 0:t.onLogout)==null||n.call(t,s,e))},Ht=(s,e=[])=>{const t=j.useRef(s);j.useEffect(()=>{t.current=s},[s]),j.useEffect(()=>{const n=()=>t.current(),a=Is.subscribeBackHandler(n);return()=>{a()}},e)},os=({title:s,message:e,onClose:t,onConfirm:n,confirmButtonText:a="",cancelButtonText:l="",confirmVariant:c="primary"})=>{const[d,f]=j.useState(!1);j.useEffect(()=>{requestAnimationFrame(()=>f(!0))},[]),Ht(()=>(m(),!0));const m=()=>{f(!1),setTimeout(t,200)},x=()=>{f(!1),setTimeout(n,200)},y=()=>{switch(c){case"danger":return r.jsx(Pt,{className:"w-8 h-8 text-red-500 animate-bounce"});case"success":return r.jsx(nt,{className:"w-8 h-8 text-green-500 animate-pulse"});default:return r.jsx(Iv,{className:"w-8 h-8 text-blue-500 animate-pulse"})}},w=()=>{switch(c){case"danger":return"bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 shadow-red-900/30";case"success":return"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-500 hover:to-green-600 shadow-green-900/30";default:return"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 shadow-blue-900/30"}};return Cv.createPortal(r.jsx("div",{className:`fixed inset-0 z-[100] flex items-center justify-center p-4 transition-all duration-300 ease-out ${d?"backdrop-blur-[2px] bg-black/5":"opacity-0 pointer-events-none"}`,onClick:m,style:{touchAction:"none"},children:r.jsxs("div",{className:`
            w-full max-w-sm bg-[#1e293b] rounded-2xl border border-gray-700/50 shadow-2xl 
            transform transition-all duration-300 ease-[cubic-bezier(0.34,1.56,0.64,1)] relative overflow-hidden
            ${d?"scale-100 translate-y-0 opacity-100":"scale-90 translate-y-10 opacity-0"}
        `,onClick:v=>v.stopPropagation(),children:[r.jsx("div",{className:`absolute top-0 left-0 w-full h-1 bg-gradient-to-r ${c==="danger"?"from-red-500 via-orange-500 to-red-500":c==="success"?"from-green-500 via-emerald-500 to-green-500":"from-blue-500 via-cyan-500 to-blue-500"}`}),r.jsxs("div",{className:"p-6 text-center",children:[r.jsx("div",{className:"flex justify-center mb-4",children:r.jsx("div",{className:"p-4 rounded-full bg-[#0f172a] border border-gray-700 shadow-inner",children:y()})}),r.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:s}),r.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-6",children:e}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{type:"button",onClick:x,className:`flex-1 py-3 px-4 rounded-xl text-white font-bold text-sm shadow-lg transform transition-transform active:scale-95 ${w()}`,children:a}),r.jsx("button",{type:"button",onClick:m,className:"flex-1 py-3 px-4 rounded-xl bg-gray-700/50 hover:bg-gray-700 text-gray-300 font-bold text-sm border border-gray-600/50 transition-colors active:scale-95",children:l})]})]})]})}),document.body)},Iu=Ar.memo(({label:s,count:e,icon:t,isActive:n,onClick:a,colorClasses:l,disabled:c})=>r.jsxs("button",{onClick:c?void 0:a,className:`p-3 rounded-xl flex flex-col items-center justify-center text-center w-full transition-all duration-200 border-2 min-h-[90px] ${c?"opacity-40 cursor-not-allowed bg-gray-800 border-transparent grayscale":n?"border-red-500 bg-gray-700/50 shadow-lg scale-105 z-10":"border-transparent bg-gray-800 hover:bg-gray-700/70"}`,children:[r.jsx("div",{className:`p-2 rounded-full mb-1 ${l.split(" ")[0]}`,children:Ar.cloneElement(t,{className:`w-5 h-5 ${l.split(" ")[1]}`})}),r.jsx("p",{className:"text-gray-400 text-[10px] font-bold mb-1 line-clamp-1",children:s}),e!==void 0&&r.jsx("p",{className:"text-white text-lg font-black leading-none",children:e})]})),q5=Ar.memo(({orders:s,users:e,deleteOrder:t,editOrder:n,onNavigateToAdd:a,permissions:l,onOpenStatusModal:c,onBulkAssign:d,onBulkStatusUpdate:f,onBulkDelete:m,appName:x})=>{const[y,w]=j.useState(null),[v,T]=j.useState(null),[I,N]=j.useState(""),[P,U]=j.useState(1),[V,q]=j.useState("all"),[W,z]=j.useState("all"),[k,M]=j.useState(!1),[B,D]=j.useState(!1),[S,F]=j.useState(!1),[E,Y]=j.useState(null),[X,R]=j.useState(!1),[J,O]=j.useState(""),[K,Q]=j.useState(null),[L,G]=j.useState(null),[ee,ne]=j.useState(""),[je,se]=j.useState(""),_e=!l||l.includes("manage_orders"),Te=!l||l.includes("delete_orders");Ht(()=>X?(R(!1),!0):K?(Q(null),!0):E?(Y(null),!0):k?(M(!1),!0):B?(D(!1),!0):S?(F(!1),!0):y?(w(null),!0):v?(T(null),!0):W!=="all"?(z("all"),q("all"),!0):P>1?(U(P-1),!0):!1,[y,v,k,B,K,X,S,E,P,W]);const be=j.useMemo(()=>{const Ie=s.filter(Le=>W==="merchant"?Le.type==="shopping_order"&&Le.merchantId!=="delinow":W==="special"?Le.merchantId==="delinow":!0);return{all:Ie.length,[ue.Pending]:Ie.filter(Le=>Le.status===ue.Pending).length,[ue.InTransit]:Ie.filter(Le=>Le.status===ue.InTransit).length,[ue.Delivered]:Ie.filter(Le=>Le.status===ue.Delivered).length,[ue.Cancelled]:Ie.filter(Le=>Le.status===ue.Cancelled).length,totalMerchantOrders:s.filter(Le=>Le.type==="shopping_order"&&Le.merchantId!=="delinow").length,totalSpecialRequests:s.filter(Le=>Le.merchantId==="delinow").length,pendingUnassigned:Ie.filter(Le=>Le.status===ue.Pending&&!Le.driverId).length}},[s,W]),ye=[{value:"all",label:"",icon:r.jsx(Bt,{}),colorClasses:"bg-blue-500/20 text-blue-400"},{value:ue.Pending,label:" ",icon:r.jsx(wt,{}),colorClasses:"bg-yellow-500/20 text-yellow-400"},{value:ue.InTransit,label:" ",icon:r.jsx(V5,{}),colorClasses:"bg-sky-500/20 text-sky-400"},{value:ue.Delivered,label:" ",icon:r.jsx(nt,{}),colorClasses:"bg-green-500/20 text-green-400"},{value:ue.Cancelled,label:"",icon:r.jsx(rt,{}),colorClasses:"bg-red-500/20 text-red-400"}],et=()=>{!ee||!je||(d==null||d(ee,parseFloat(je)),M(!1),ne(""),se(""))},Je=Ie=>{switch(Ie){case ue.Pending:return{title:"   ",message:"         (   ).   "};case ue.InTransit:return{title:"   ",message:":      !     "};case ue.Delivered:return{title:"  ",message:"      .   "};case ue.Cancelled:return{title:"  ",message:"       ."};case"all":return{title:"   ",message:" :       !      .",variant:"danger"};default:return{title:"",message:""}}},bt=Ie=>{switch(Ie){case ue.Pending:return{title:'    " "',message:'     (  )   " "   .   ',variant:"primary"};case ue.Delivered:return{title:"  ",message:'     ( )   " "   .   ',variant:"success"};default:return{title:" ",message:"",variant:"primary"}}},yt=K?Je(K):null,Ae=E?bt(E):null,fe=50;Ar.useEffect(()=>{U(1)},[V,W,I]),Ar.useEffect(()=>{const Ie=document.querySelector("main");Ie?Ie.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},[P]);const $e=j.useMemo(()=>{let Ie=[...s];if(W==="merchant"?Ie=Ie.filter(Le=>Le.type==="shopping_order"&&Le.merchantId!=="delinow"):W==="special"&&(Ie=Ie.filter(Le=>Le.merchantId==="delinow")),V!=="all"&&(Ie=Ie.filter(Le=>Le.status===V)),I){const Le=I.toLowerCase();Ie=Ie.filter(Lt=>{var bs,Zt;return Lt.id&&Lt.id.toString().includes(Le)||((bs=Lt.customer)==null?void 0:bs.phone)&&Lt.customer.phone.includes(Le)||((Zt=Lt.customer)==null?void 0:Zt.address)&&Lt.customer.address.toLowerCase().includes(Le)||Lt.notes&&Lt.notes.toLowerCase().includes(Le)})}return Ie.sort((Le,Lt)=>{const bs=Zt=>Zt?Zt.seconds?Zt.seconds*1e3:new Date(Zt).getTime():0;return bs(Lt.createdAt)-bs(Le.createdAt)})},[s,W,V,I]),ce=j.useMemo(()=>e.filter(Ie=>Ie.role==="merchant"),[e]),Oe=j.useMemo(()=>e.filter(Ie=>Ie.role==="driver"),[e]),Pe=j.useMemo(()=>{if(!J)return Oe;const Ie=J.toLowerCase();return Oe.filter(Le=>Le.name.toLowerCase().includes(Ie)||Le.phone&&Le.phone.includes(Ie))},[Oe,J]),Ge=j.useMemo(()=>Oe.find(Ie=>Ie.id===ee),[Oe,ee]),Ke=j.useMemo(()=>{const Ie=P*fe,Le=Ie-fe;return $e.slice(Le,Ie)},[$e,P,fe]);return r.jsxs("div",{className:"space-y-6 pb-32",children:[r.jsxs("div",{className:"grid grid-cols-4 lg:grid-cols-8 gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[ye.map(Ie=>r.jsx(Iu,{label:Ie.label,count:be[Ie.value],icon:Ie.icon,isActive:W==="all"&&V===Ie.value,onClick:()=>{z("all"),q(Ie.value)},colorClasses:Ie.colorClasses},Ie.value)),r.jsx(Iu,{label:x||"GOO NOW",count:be.totalMerchantOrders,icon:r.jsx(Nn,{}),isActive:W==="merchant",onClick:()=>{q("all"),z("merchant")},colorClasses:"bg-orange-500/20 text-orange-400"}),r.jsx(Iu,{label:" ",count:be.totalSpecialRequests,icon:r.jsx(zt,{}),isActive:W==="special",onClick:()=>{q("all"),z("special")},colorClasses:"bg-purple-500/20 text-purple-400"}),_e&&r.jsxs(r.Fragment,{children:[r.jsx(Iu,{label:`  (${be.pendingUnassigned})`,icon:r.jsx(ln,{}),isActive:k,onClick:()=>{be.pendingUnassigned===0?(G("      "),setTimeout(()=>G(null),3e3)):M(!0)},colorClasses:"bg-indigo-500/20 text-indigo-400 border-indigo-500/30"}),r.jsx(Iu,{label:"  ",icon:r.jsx(Qp,{}),isActive:S,onClick:()=>F(!0),colorClasses:"bg-emerald-500/20 text-emerald-400 border-emerald-500/30"})]}),Te&&r.jsx(Iu,{label:" ",icon:r.jsx(Pt,{}),isActive:B,onClick:()=>D(!0),colorClasses:"bg-red-500/20 text-red-400 border-red-500/30"})]}),L&&r.jsx("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-lg shadow-xl border border-gray-700 z-50 animate-fadeIn",children:L}),r.jsxs("div",{className:"bg-gray-800 p-4 rounded-xl shadow-sm flex flex-col md:flex-row gap-4 items-center border border-gray-700",children:[r.jsxs("div",{className:"relative flex-1 w-full",children:[r.jsx(Kn,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 w-5 h-5"}),r.jsx("input",{type:"text",placeholder:"     ...",value:I,onChange:Ie=>N(Ie.target.value),className:"w-full px-4 py-2 pr-10 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-1 focus:ring-red-500 outline-none"})]}),_e&&a&&r.jsxs("button",{onClick:a,className:"w-full md:w-auto flex justify-center items-center bg-red-600 text-white font-black px-6 py-2.5 rounded-lg shadow-lg hover:bg-red-700 transition-all active:scale-95",children:[r.jsx(ln,{className:"w-5 h-5 ml-2"}),r.jsx("span",{children:" "})]})]}),W!=="all"&&r.jsxs("div",{className:"flex items-center gap-2 px-2",children:[r.jsx("span",{className:`w-2 h-6 rounded-full ${W==="merchant"?"bg-orange-500":"bg-purple-500"}`}),r.jsx("h3",{className:"text-xl font-bold text-white",children:W==="merchant"?"  ":"  "})]}),r.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:Ke.length>0?Ke.map(Ie=>r.jsx(LD,{order:Ie,users:e,onEdit:_e?w:void 0,onDelete:Te?T:void 0,onOpenStatusModal:c},Ie.id)):r.jsxs("div",{className:"col-span-full py-20 text-center flex flex-col items-center justify-center bg-gray-800/30 rounded-3xl border border-dashed border-gray-700",children:[r.jsx(Bt,{className:"w-16 h-16 text-gray-700 mb-4 opacity-20"}),r.jsx("p",{className:"text-gray-500 font-bold",children:"   "})]})}),$e.length>fe&&r.jsxs("div",{className:"flex justify-center items-center gap-4 mt-8 pt-4 border-t border-gray-700",children:[r.jsx("button",{onClick:()=>U(Ie=>Math.max(1,Ie-1)),disabled:P===1,className:"px-4 py-2 bg-gray-800 text-white rounded-lg disabled:opacity-50 hover:bg-gray-700 transition",children:""}),r.jsxs("span",{className:"text-gray-400 font-mono",children:[" ",P,"  ",Math.ceil($e.length/fe)]}),r.jsx("button",{onClick:()=>U(Ie=>Math.min(Math.ceil($e.length/fe),Ie+1)),disabled:P===Math.ceil($e.length/fe),className:"px-4 py-2 bg-gray-800 text-white rounded-lg disabled:opacity-50 hover:bg-gray-700 transition",children:""})]}),y&&r.jsx(VD,{order:y,merchants:ce,drivers:Oe,onClose:()=>w(null),onSave:Ie=>{n(y.id,Ie),w(null)}}),v&&r.jsx(os,{title:" ",message:`       ${v.id} `,onClose:()=>T(null),onConfirm:()=>{t(v.id),T(null)},confirmButtonText:" ",confirmVariant:"danger"}),k&&r.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>M(!1),children:r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-2xl border border-gray-700 shadow-2xl p-6 animate-pop-in",onClick:Ie=>Ie.stopPropagation(),children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsxs("h3",{className:"text-xl font-black text-white flex items-center gap-2",children:[r.jsx(Bt,{className:"w-6 h-6 text-indigo-400"}),"  "]}),r.jsx("button",{onClick:()=>M(!1),className:"text-gray-500 hover:text-white",children:r.jsx(rt,{className:"w-6 h-6"})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("p",{className:"text-sm text-gray-400",children:["  ",r.jsx("span",{className:"text-yellow-500 font-bold",children:be.pendingUnassigned}),"  ( )  ."]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-2",children:" "}),r.jsxs("button",{onClick:()=>R(!0),className:"w-full bg-[#0f172a] border border-gray-700 rounded-xl p-4 flex justify-between items-center text-white hover:border-gray-500 transition-colors",children:[Ge?r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border border-gray-600",children:Ge.storeImage?r.jsx("img",{src:Ge.storeImage,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-4 h-4 text-gray-400"})}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"font-bold text-sm",children:Ge.name}),r.jsx("p",{className:"text-xs text-gray-500 font-mono",children:Ge.phone})]})]}):r.jsx("span",{className:"text-gray-400 text-sm",children:" ..."}),r.jsx(k0,{className:"w-5 h-5 text-gray-500"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-2",children:"  "}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"number",placeholder:"0",value:je,onChange:Ie=>se(Ie.target.value),className:"w-full bg-[#0f172a] border border-gray-700 rounded-xl py-3 pl-10 pr-4 text-white font-bold outline-none focus:border-indigo-500"}),r.jsx("span",{className:"absolute left-3 top-3.5 text-gray-500 text-xs font-bold",children:"."})]})]}),r.jsx("button",{onClick:et,disabled:!ee||!je,className:"w-full bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-700 disabled:text-gray-500 text-white font-bold py-3.5 rounded-xl shadow-lg transition-all active:scale-95 mt-2",children:" "})]})]})}),X&&r.jsx("div",{className:"fixed inset-0 z-[110] bg-black/90 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>R(!1),children:r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-gray-700 shadow-2xl overflow-hidden flex flex-col max-h-[60vh]",onClick:Ie=>Ie.stopPropagation(),children:[r.jsx("div",{className:"p-4 border-b border-gray-700",children:r.jsxs("div",{className:"relative",children:[r.jsx(Kn,{className:"absolute right-3 top-3 w-4 h-4 text-gray-500"}),r.jsx("input",{type:"text",placeholder:"  ...",value:J,onChange:Ie=>O(Ie.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-2.5 pr-9 pl-3 text-white text-sm outline-none focus:border-blue-500",autoFocus:!0})]})}),r.jsx("div",{className:"flex-1 overflow-y-auto p-2 custom-scrollbar",children:Pe.length>0?Pe.map(Ie=>r.jsxs("button",{onClick:()=>{ne(Ie.id),R(!1)},className:`w-full flex items-center gap-3 p-3 rounded-xl transition-colors ${ee===Ie.id?"bg-blue-900/20 border border-blue-500/30":"hover:bg-gray-800 border border-transparent"}`,children:[r.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden flex-shrink-0",children:Ie.storeImage?r.jsx("img",{src:Ie.storeImage,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-5 h-5 text-gray-400"})}),r.jsxs("div",{className:"text-right flex-1",children:[r.jsx("p",{className:`font-bold text-sm ${ee===Ie.id?"text-blue-400":"text-white"}`,children:Ie.name}),r.jsx("p",{className:"text-xs text-gray-500 font-mono",children:Ie.phone})]}),ee===Ie.id&&r.jsx(nt,{className:"w-5 h-5 text-blue-500"})]},Ie.id)):r.jsx("p",{className:"text-center text-gray-500 py-4 text-xs",children:"  "})})]})}),S&&r.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>F(!1),children:r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-gray-700 shadow-2xl p-6 animate-pop-in text-center",onClick:Ie=>Ie.stopPropagation(),children:[r.jsx("div",{className:"w-16 h-16 bg-emerald-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-emerald-500/20",children:r.jsx(Qp,{className:"w-8 h-8 text-emerald-500"})}),r.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),r.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"       ."}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("button",{onClick:()=>{F(!1),Y(ue.Pending)},className:"w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-xl py-3 text-sm font-bold text-yellow-400 transition-colors flex items-center justify-center gap-2",children:[r.jsx(wt,{className:"w-4 h-4"}),"  "]}),r.jsxs("button",{onClick:()=>{F(!1),Y(ue.Delivered)},className:"w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-xl py-3 text-sm font-bold text-green-400 transition-colors flex items-center justify-center gap-2",children:[r.jsx(nt,{className:"w-4 h-4"}),'  " "']})]}),r.jsx("button",{onClick:()=>F(!1),className:"mt-4 text-gray-500 text-xs hover:text-white transition-colors",children:""})]})}),B&&r.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>D(!1),children:r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-gray-700 shadow-2xl p-6 animate-pop-in text-center",onClick:Ie=>Ie.stopPropagation(),children:[r.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-red-500/20",children:r.jsx(Pt,{className:"w-8 h-8 text-red-500"})}),r.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),r.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"       ."}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("button",{onClick:()=>{D(!1),Q(ue.Pending)},className:"w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-xl py-3 text-sm font-bold text-yellow-400 transition-colors",children:["    (",be[ue.Pending],")"]}),r.jsxs("button",{onClick:()=>{D(!1),Q(ue.Cancelled)},className:"w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-xl py-3 text-sm font-bold text-red-400 transition-colors",children:["    (",be[ue.Cancelled],")"]}),r.jsxs("button",{onClick:()=>{D(!1),Q(ue.Delivered)},className:"w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-xl py-3 text-sm font-bold text-green-400 transition-colors",children:["    (",be[ue.Delivered],")"]}),r.jsx("div",{className:"h-px bg-gray-700 my-2"}),r.jsx("button",{onClick:()=>{D(!1),Q("all")},className:"w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 rounded-xl shadow-lg transition-colors",children:"   "})]})]})}),E&&Ae&&r.jsx(os,{title:Ae.title,message:Ae.message,onClose:()=>Y(null),onConfirm:()=>{f==null||f(E),Y(null)},confirmButtonText:" ",confirmVariant:Ae.variant}),K&&yt&&r.jsx(os,{title:yt.title,message:yt.message,onClose:()=>Q(null),onConfirm:()=>{m==null||m(K),Q(null)},confirmButtonText:"  ",confirmVariant:yt.variant||"danger"})]})}),UD=[{id:"restaurant",label:""},{id:"market",label:" "},{id:"pharmacy",label:""},{id:"bakery",label:"/"},{id:"electronics",label:""},{id:"fashion",label:""},{id:"logistics",label:" "},{id:"other",label:""}],FD=({onClose:s,onSave:e,initialRole:t,appName:n,currentUserRole:a,currentUserPermissions:l})=>{const[c,d]=j.useState(""),[f,m]=j.useState(""),[x,y]=j.useState(""),[w,v]=j.useState(""),[T,I]=j.useState(""),[N,P]=j.useState(t),[U,V]=j.useState(25),[q,W]=j.useState("percentage"),[z,k]=j.useState("always_open"),[M,B]=j.useState(!0),[D,S]=j.useState(1),[F,E]=j.useState("restaurant"),[Y,X]=j.useState(!1),[R,J]=j.useState(!0),[O,K]=j.useState([]),[Q,L]=j.useState(""),[G,ee]=j.useState(!1),[ne,je]=j.useState(null),[se,_e]=j.useState(!1),Te=j.useRef(null),be=n||"GOO NOW";Ht(()=>(s(),!0),[s]);const ye="w-full px-4 py-3 bg-[#252525] border border-[#333] text-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors",et=[{id:"view_orders",label:" "},{id:"manage_orders",label:" "},{id:"view_reports",label:" "},{id:"view_users",label:" "},{id:"manage_users",label:" "},{id:"view_wallet",label:" "},{id:"manage_supervisors",label:" "}],Je=fe=>{K($e=>$e.includes(fe)?$e.filter(ce=>ce!==fe):[...$e,fe])},bt=fe=>{var ce;const $e=(ce=fe.target.files)==null?void 0:ce[0];if($e){_e(!0);const Oe=new FileReader;Oe.onloadend=()=>{const Pe=new Image;Pe.src=Oe.result,Pe.onload=()=>{const Ge=document.createElement("canvas"),Ke=1024,Ie=Ke/Pe.width;Ge.width=Ke,Ge.height=Pe.height*Ie;const Le=Ge.getContext("2d");Le&&(Le.imageSmoothingEnabled=!0,Le.imageSmoothingQuality="high",Le.drawImage(Pe,0,0,Ge.width,Ge.height),setTimeout(()=>{je(Ge.toDataURL("image/jpeg",.9)),_e(!1)},800))}},Oe.readAsDataURL($e)}},yt=async()=>{if(!c||!f||!w||!N){L("    .");return}if(!/^\d{11}$/.test(f)){L("      11 .");return}if(w.length<6){L("     6     .");return}if(w!==T){L("   .");return}L("");const fe={name:c,phone:f,password:w,role:N,storeImage:ne||void 0,address:N!=="driver"&&x?x:void 0};N==="driver"&&(fe.commissionRate=U,fe.commissionType=q,fe.dailyLogMode=z,fe.maxConcurrentOrders=M?void 0:D),N==="merchant"&&(fe.storeCategory=F,fe.canShowDeliveryTime=Y,fe.canManageMenu=R),N==="supervisor"&&(fe.permissions=O),ee(!0);try{await e(fe),s()}catch{ee(!1)}},Ae=j.useMemo(()=>{const fe=[{id:"driver",label:""},{id:"merchant",label:""},{id:"customer",label:""},{id:"supervisor",label:""},{id:"admin",label:""}];if(a==="supervisor"){const $e=l==null?void 0:l.includes("manage_supervisors");return fe.filter(ce=>ce.id!=="admin"&&($e||ce.id!=="supervisor"))}return fe},[a,l]);return r.jsxs("div",{className:"fixed inset-0 bg-[#111] z-[60] overflow-y-auto animate-fadeIn flex flex-col",children:[r.jsxs("div",{className:"flex-none bg-[#1a1a1a] border-b border-[#333] px-4 pt-safe h-16 box-content flex items-center justify-between sticky top-0 z-20 shadow-lg",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:s,className:"bg-[#252525] p-2 rounded-full text-gray-400 hover:text-white transition-colors",children:r.jsx(Gs,{className:"w-6 h-6 rotate-180"})}),r.jsx("h2",{className:"text-xl font-bold text-white",children:"  "})]}),r.jsx("button",{onClick:yt,disabled:G,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-lg transition-colors shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:G?" ...":""})]}),r.jsxs("div",{className:"flex-1 max-w-4xl mx-auto w-full p-4 sm:p-8 space-y-8 pb-20",children:[r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsxs("div",{onClick:()=>{var fe;return!se&&((fe=Te.current)==null?void 0:fe.click())},className:"relative cursor-pointer border-2 border-dashed border-gray-600 hover:border-red-500 transition-colors bg-[#252525] w-32 h-32 rounded-full flex items-center justify-center overflow-hidden group shadow-xl",children:[se&&r.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 z-50 backdrop-blur-sm",children:r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full opacity-75 animate-ping absolute top-0 left-0"}),r.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center relative z-10 shadow-lg shadow-blue-500/50",children:r.jsx(ur,{className:"w-6 h-6 text-white animate-bounce"})}),r.jsx("div",{className:"w-20 h-20 border-4 border-blue-400/30 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"})]})}),ne?r.jsx("img",{src:ne,alt:"Profile",className:"w-full h-full object-cover"}):r.jsxs("div",{className:"flex flex-col items-center text-gray-400",children:[r.jsx(ga,{className:"w-10 h-10 mb-1"}),r.jsx("span",{className:"text-xs",children:""})]}),r.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:r.jsx(ur,{className:"w-8 h-8 text-white"})})]}),r.jsx("p",{className:"text-gray-500 text-xs mt-2",children:"     "}),r.jsx("input",{ref:Te,type:"file",accept:"image/*",className:"hidden",onChange:bt})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm h-fit",children:[r.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"w-1 h-5 bg-red-500 rounded-full"})," "]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" (Role)"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:Ae.map(fe=>r.jsx("button",{type:"button",onClick:()=>P(fe.id),className:`px-4 py-2 text-sm font-bold rounded-xl border transition-all ${N===fe.id?"bg-red-600 border-red-600 text-white shadow-lg shadow-red-900/20":"bg-transparent border-gray-600 text-gray-400 hover:border-gray-400"}`,children:fe.label},fe.id))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),r.jsx("input",{type:"text",value:c,onChange:fe=>d(fe.target.value),className:ye,placeholder:N==="merchant"?" ":":  "})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),r.jsx("input",{type:"tel",value:f,onChange:fe=>m(fe.target.value),className:`${ye} text-right placeholder:text-right`,placeholder:"01xxxxxxxxx",dir:"rtl"})]}),N!=="driver"&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:""}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"text",value:x,onChange:fe=>y(fe.target.value),className:`${ye} pl-10`,placeholder:" "}),r.jsx(jn,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500"})]})]}),N==="merchant"&&r.jsxs("div",{className:"space-y-4 pt-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),r.jsxs("div",{className:"relative",children:[r.jsx("select",{value:F,onChange:fe=>E(fe.target.value),className:`${ye} appearance-none`,children:UD.map(fe=>r.jsx("option",{value:fe.id,children:fe.label},fe.id))}),r.jsx(Sn,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500 pointer-events-none"})]})]}),r.jsxs("div",{className:"bg-[#252525] p-3 rounded-xl border border-[#333] space-y-3",children:[r.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:R,onChange:fe=>J(fe.target.checked),className:"w-5 h-5 rounded bg-gray-700 border-gray-600 text-red-600 focus:ring-red-500"}),r.jsxs("span",{className:"flex items-center gap-2 text-sm text-gray-200",children:[r.jsx(Xr,{className:"w-4 h-4 text-orange-400"}),"  "]})]}),r.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:Y,onChange:fe=>X(fe.target.checked),className:"w-5 h-5 rounded bg-gray-700 border-gray-600 text-red-600 focus:ring-red-500"}),r.jsxs("span",{className:"flex items-center gap-2 text-sm text-gray-200",children:[r.jsx(wt,{className:"w-4 h-4 text-blue-400"}),"    "]})]})]})]})]}),r.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm h-fit",children:[r.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"w-1 h-5 bg-blue-500 rounded-full"})," "]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),r.jsx("input",{type:"password",value:w,onChange:fe=>v(fe.target.value),className:ye,placeholder:"******"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"  "}),r.jsx("input",{type:"password",value:T,onChange:fe=>I(fe.target.value),className:ye,placeholder:"******"})]})]}),N==="driver"&&r.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-6 shadow-sm md:col-span-2",children:[r.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[r.jsx(on,{className:"w-5 h-5 text-orange-500"})," "]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),r.jsx("div",{className:"flex bg-[#252525] p-1 rounded-xl border border-[#333]",children:[{value:"12_hour",label:" 12 "},{value:"always_open",label:" "}].map(fe=>r.jsx("button",{type:"button",onClick:()=>k(fe.value),className:`flex-1 py-2.5 text-sm font-bold rounded-lg transition-all ${z===fe.value?"bg-orange-500 text-white shadow-md":"text-gray-400 hover:text-white"}`,children:fe.label},fe.value))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"    ( )"}),r.jsxs("div",{className:"bg-[#252525] p-4 rounded-xl border border-[#333]",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("span",{className:"text-sm text-white font-medium",children:"  "}),r.jsx("button",{onClick:()=>B(!M),className:`w-12 h-6 rounded-full p-1 transition-colors duration-300 ${M?"bg-green-600":"bg-gray-600"}`,children:r.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-300 ${M?"translate-x-0":"-translate-x-6"}`})})]}),r.jsxs("div",{className:`overflow-hidden transition-all duration-300 ${M?"max-h-0 opacity-50":"max-h-20 opacity-100"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"range",min:"1",max:"10",value:D,onChange:fe=>S(parseInt(fe.target.value)),className:"flex-1 accent-orange-500 h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer",disabled:M}),r.jsx("div",{className:"bg-black/30 px-3 py-1 rounded-lg border border-[#444] min-w-[3rem] text-center font-bold text-white",children:D})]}),r.jsx("p",{className:"text-[10px] text-gray-500 mt-2",children:"        ."})]})]})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:["  ",be]}),r.jsxs("div",{className:"bg-[#252525] p-4 rounded-xl border border-[#333] space-y-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-2",children:" "}),r.jsx("div",{className:"flex gap-2",children:[0,25,50].map(fe=>r.jsxs("button",{type:"button",onClick:()=>{W("percentage"),V(fe)},className:`px-4 py-2 text-sm font-bold rounded-lg border transition-all ${q==="percentage"&&U===fe?"bg-orange-500 border-orange-500 text-white":"bg-transparent border-gray-600 text-gray-400"}`,children:[fe,"%"]},`perc-${fe}`))})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"  (.)"}),r.jsx("div",{className:"flex gap-2",children:[5,10,15,20].map(fe=>r.jsx("button",{type:"button",onClick:()=>{W("fixed"),V(fe)},className:`px-4 py-2 text-sm font-bold rounded-lg border transition-all ${q==="fixed"&&U===fe?"bg-orange-500 border-orange-500 text-white":"bg-transparent border-gray-600 text-gray-400"}`,children:fe},`fixed-${fe}`))})]})]})]})]})]}),N==="supervisor"&&r.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm md:col-span-2",children:[r.jsx("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2",children:" "}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:et.map(fe=>r.jsxs("label",{className:"flex items-center space-x-3 space-x-reverse p-4 bg-[#252525] rounded-xl cursor-pointer hover:bg-[#303030] transition-colors border border-transparent hover:border-gray-600",children:[r.jsx("input",{type:"checkbox",checked:O.includes(fe.id),onChange:()=>Je(fe.id),className:"h-5 w-5 rounded bg-gray-700 border-gray-600 text-red-600 focus:ring-red-500 accent-red-600"}),r.jsx("span",{className:"text-sm font-bold text-gray-200",children:fe.label})]},fe.id))})]})]}),Q&&r.jsx("div",{className:"bg-red-900/20 border border-red-500/50 text-red-400 p-4 rounded-xl text-center font-bold",children:Q})]})]})},$D=s=>{switch(s){case"active":return"";case"pending":return" ";case"inactive":return" ";case"blocked":return"";default:return s}},BD=s=>{switch(s){case"active":return"green";case"pending":return"yellow";case"inactive":return"gray";case"blocked":return"red";default:return"gray"}},zD=s=>{switch(s){case"driver":return{label:"",bg:"bg-orange-500/10",text:"text-orange-400",border:"border-orange-500/20"};case"merchant":return{label:"",bg:"bg-purple-500/10",text:"text-purple-400",border:"border-purple-500/20"};case"admin":return{label:"",bg:"bg-red-500/10",text:"text-red-400",border:"border-red-500/20"};case"supervisor":return{label:"",bg:"bg-yellow-500/10",text:"text-yellow-400",border:"border-yellow-500/20"};case"customer":return{label:"",bg:"bg-blue-500/10",text:"text-blue-400",border:"border-blue-500/20"};default:return{label:"",bg:"bg-gray-500/10",text:"text-gray-400",border:"border-gray-500/20"}}},qD=s=>{if(s!=null&&s.startsWith("data:")||s!=null&&s.startsWith("http"))return"p-0";switch(s){case"gold":return"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[2px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[2px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-0"}},HD=s=>{if(!s||s==="none")return null;if(s!=null&&s.startsWith("data:")||s!=null&&s.startsWith("http"))return r.jsx("div",{className:"w-6 h-6 min-w-[1.5rem] rounded bg-white/5 border border-white/10 flex items-center justify-center p-0.5 ml-1",children:r.jsx("img",{src:s,className:"w-full h-full object-contain",alt:"badge"})});switch(s){case"verified":return r.jsx(qi,{className:"w-3 h-3 text-blue-400"});case"vip":return r.jsx(va,{className:"w-3 h-3 text-yellow-400"});case"star":return r.jsx(Rr,{className:"w-3 h-3 text-purple-400"});case"popular":return r.jsx(zt,{className:"w-3 h-3 text-red-400"});case"shield":case"tier-1":case"tier-2":case"tier-3":case"tier-4":case"tier-5":return r.jsx(Yr,{className:"w-3 h-3 text-orange-400"});case"admin-badge":return r.jsx(on,{className:"w-3 h-3 text-red-500"});case"mod-badge":return r.jsx(Yr,{className:"w-3 h-3 text-green-500"});case"driver-badge":return r.jsx(Bt,{className:"w-3 h-3 text-orange-500"});case"merchant-badge":return r.jsx(lr,{className:"w-3 h-3 text-purple-500"});case"support-badge":return r.jsx(Dr,{className:"w-3 h-3 text-blue-500"});case"flash":return r.jsx(Ci,{className:"w-3 h-3 text-yellow-400"});case"love":return r.jsx(ff,{className:"w-3 h-3 text-pink-400"});case"cool":return r.jsx(Rr,{className:"w-3 h-3 text-cyan-400"});case"fire-b":return r.jsx(zt,{className:"w-3 h-3 text-red-500"});case"check":return r.jsx(nt,{className:"w-3 h-3 text-green-500"});case"money":return r.jsx(Pc,{className:"w-3 h-3 text-emerald-400"});case"let-a":return r.jsx("span",{className:"text-[10px] font-bold font-mono text-white",children:"A"});case"let-b":return r.jsx("span",{className:"text-[10px] font-bold font-mono text-white",children:"B"});case"let-s":return r.jsx("span",{className:"text-[10px] font-bold font-mono text-yellow-400",children:"S"});case"let-x":return r.jsx("span",{className:"text-[10px] font-bold font-mono text-red-400",children:"X"});case"pro":return r.jsx("span",{className:"text-[8px] font-black text-white bg-black px-1 rounded border border-white/50",children:"PRO"});case"max":return r.jsx("span",{className:"text-[8px] font-black text-white bg-red-600 px-1 rounded",children:"MAX"});case"top":return r.jsx(zt,{className:"w-3 h-3 text-blue-500"});default:return null}},Ty=s=>(s==null?void 0:s.startsWith("data:"))||(s==null?void 0:s.startsWith("http")),GD=({user:s,onEdit:e,onDelete:t,onApprove:n,onBlock:a,onUnblock:l,isPrimaryAdmin:c})=>{const{dateStr:d,timeStr:f,dayStr:m}=(()=>{try{const T=new Date(s.createdAt);if(isNaN(T.getTime()))return{dateStr:"--",timeStr:"--",dayStr:""};const I=T.toLocaleDateString("ar-EG-u-nu-latn",{weekday:"long"}),N=T.toLocaleDateString("ar-EG-u-nu-latn",{year:"numeric",month:"short",day:"numeric"}),P=T.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric"});return{dateStr:N,timeStr:P,dayStr:I}}catch{return{dateStr:"--",timeStr:"--",dayStr:""}}})(),x=BD(s.status),y=zD(s.role),w=qD(s.specialFrame),v=s.status==="blocked";return r.jsxs("div",{className:`group relative rounded-2xl border shadow-lg transition-all duration-300 overflow-hidden flex flex-col h-full ${v?"bg-red-950/20 border-red-500/30":"bg-gray-800 border-gray-700/50 hover:border-gray-600 hover:shadow-xl"}`,children:[r.jsx("div",{className:`absolute top-0 right-0 w-1.5 h-full bg-${x}-500 opacity-80`}),r.jsxs("div",{className:"p-5 flex-1",children:[r.jsxs("div",{className:"flex justify-between items-start mb-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:`relative w-14 h-14 flex items-center justify-center rounded-full ${Ty(s.specialFrame)?"":w} ${v?"grayscale":""}`,children:[Ty(s.specialFrame)&&r.jsx("img",{src:s.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.6] pointer-events-none",alt:"frame"}),r.jsx("div",{className:`${Ty(s.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border border-gray-800 relative z-0`,children:s.storeImage?r.jsx("img",{src:s.storeImage,alt:s.name,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-7 h-7 text-gray-400"})})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("h3",{className:"font-bold text-white text-lg leading-tight truncate max-w-[120px]",title:s.name,children:s.name}),HD(s.specialBadge)]}),r.jsx("div",{className:`inline-flex items-center px-2 py-0.5 mt-1 rounded text-[10px] font-bold border ${y.bg} ${y.text} ${y.border}`,children:y.label})]})]}),r.jsx("div",{className:`px-2.5 py-1 rounded-lg text-[10px] font-bold bg-${x}-500/10 text-${x}-400 border border-${x}-500/20`,children:$D(s.status)})]}),r.jsxs("div",{className:`rounded-xl p-3 space-y-2.5 border ${v?"bg-red-900/10 border-red-500/20":"bg-[#1a1a1a]/60 border-gray-700/30"}`,children:[r.jsxs("div",{className:"flex items-center text-gray-300 text-xs font-medium",children:[r.jsx(Js,{className:"w-3.5 h-3.5 text-gray-500 ml-2"}),r.jsx("span",{className:"font-mono dir-ltr selectable",children:s.phone||" "})]}),s.address&&r.jsxs("div",{className:"flex items-start text-gray-400 text-[11px] leading-snug",children:[r.jsx(jn,{className:"w-3.5 h-3.5 text-gray-600 ml-2 mt-0.5 flex-shrink-0"}),r.jsx("span",{className:"truncate",children:s.address})]}),r.jsx("div",{className:"pt-2 mt-2 border-t border-gray-700/50 flex flex-col gap-1.5",children:r.jsx("div",{className:"flex items-center justify-between text-[10px] text-gray-400",children:r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(il,{className:"w-3 h-3 text-gray-500"}),r.jsxs("span",{children:[m," ",d]})]})})})]})]}),r.jsxs("div",{className:`px-4 py-3 border-t flex justify-between items-center ${v?"bg-red-900/30 border-red-500/30":"bg-[#151515] border-gray-700/50"}`,children:[r.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[s.status==="pending"&&n&&r.jsxs("button",{onClick:()=>n(s.id),className:"flex-1 flex items-center justify-center text-xs bg-green-600 hover:bg-green-500 text-white font-bold px-3 py-2 rounded-lg shadow-lg shadow-green-900/20 transition-all active:scale-95 clickable",children:[r.jsx(nt,{className:"w-3.5 h-3.5 ml-1.5"}),""]}),v?l&&!c&&r.jsxs("button",{onClick:()=>l(s),className:"flex-1 flex items-center justify-center text-xs bg-green-500/10 hover:bg-green-500/20 text-green-400 border border-green-500/20 font-bold px-3 py-2 rounded-lg transition-all active:scale-95 clickable",title:" ",children:[r.jsx(TD,{className:"w-3.5 h-3.5 ml-1.5"})," "]}):a&&!c&&r.jsx("button",{onClick:()=>a(s),className:"p-2 text-gray-400 hover:text-white hover:bg-red-600 rounded-lg transition-colors border border-gray-600 hover:border-red-500 clickable",title:" ",children:r.jsx(SD,{className:"w-4 h-4"})}),e&&r.jsx("button",{onClick:()=>e(s),className:"p-2 text-blue-400 hover:text-white hover:bg-blue-600 rounded-lg transition-colors border border-blue-500/20 bg-blue-500/10 clickable",title:"",children:r.jsx(cr,{className:"w-4 h-4"})})]}),t&&!c&&r.jsx("button",{onClick:()=>t(s),className:"p-2 text-red-400 hover:text-white hover:bg-red-600 rounded-lg transition-colors border border-blue-500/20 bg-red-500/10 mr-2 clickable",title:"",children:r.jsx(Pt,{className:"w-4 h-4"})})]})]})},H5=({users:s,updateUser:e,onDeleteUser:t,onAdminAddUser:n,setEditingUser:a,onViewUser:l,permissions:c,appName:d,currentUser:f})=>{const[m,x]=j.useState(null),[y,w]=j.useState(null),[v,T]=j.useState(null),[I,N]=j.useState(!1),[P,U]=j.useState("drivers"),[V,q]=j.useState(""),W=!c||c.includes("manage_users"),z=(f==null?void 0:f.role)==="supervisor",{drivers:k,merchants:M,customers:B,supervisors:D,admins:S,blocked:F}=j.useMemo(()=>{const ne=s.filter(Je=>Je.status!=="blocked"),je=s.filter(Je=>Je.status==="blocked"),se=!z||c&&c.includes("manage_supervisors"),_e=ne.filter(Je=>Je.role==="driver"),Te=ne.filter(Je=>Je.role==="merchant"),be=ne.filter(Je=>Je.role==="customer"),ye=ne.filter(Je=>Je.role==="supervisor"&&se),et=ne.filter(Je=>Je.role==="admin");return{drivers:_e,merchants:Te,customers:be,supervisors:ye,admins:et,blocked:je}},[s,z,c]),E=j.useMemo(()=>{const ne=!z||c&&c.includes("manage_supervisors"),je=[{id:"drivers",label:"",data:k,color:"text-orange-400"},{id:"merchants",label:"",data:M,color:"text-purple-400"},{id:"customers",label:"",data:B,color:"text-blue-400"}];return ne&&je.push({id:"supervisors",label:"",data:D,color:"text-yellow-400"}),z||je.push({id:"admins",label:"",data:S,color:"text-red-400"}),je.push({id:"blocked",label:"",data:F,color:"text-red-500"}),je},[k,M,B,D,S,F,z,c]),Y=E.find(ne=>ne.id===P)||E[0],X=j.useMemo(()=>{const ne=Y.data;return V?ne.filter(je=>je.name.toLowerCase().includes(V.toLowerCase())||je.phone&&je.phone.includes(V)||je.id.includes(V)):ne},[Y,V]),R=Y.label,J=ne=>W?!f||f.role==="admin"?!0:f.role==="supervisor"?!(ne.id===f.id||ne.role==="admin"||ne.role==="supervisor"):!1:!1;Ht(()=>I?(N(!1),!0):m?(x(null),!0):y?(w(null),!0):v?(T(null),!0):!1,[I,m,y,v]);const O=ne=>{try{window.history.pushState({view:"users",modal:ne},"",window.location.pathname)}catch{}},K=()=>{var ne;(ne=window.history.state)!=null&&ne.modal?window.history.back():(N(!1),x(null),w(null),T(null))};j.useEffect(()=>{const ne=je=>{var se;(se=je.state)!=null&&se.modal||(N(!1),x(null),w(null),T(null))};return window.addEventListener("popstate",ne),()=>window.removeEventListener("popstate",ne)},[]);const Q=()=>{m&&t(m.id),K()},L=()=>{y&&e(y.id,{status:"blocked"}),K()},G=()=>{v&&e(v.id,{status:"active"}),K()},ee=async ne=>{const je=await n(ne);K(),je&&l&&setTimeout(()=>{l(je)},100)};return r.jsxs("div",{className:"space-y-6 pb-32 animate-fadeIn relative",children:[r.jsxs("div",{className:"pb-2 -mx-4 px-4 sm:-mx-6 sm:px-6 lg:-mx-8 lg:px-8 transition-all",children:[r.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-gray-800/60 backdrop-blur-md p-4 rounded-2xl border border-gray-700/50 shadow-lg mb-4 mt-1",children:[r.jsxs("div",{className:"relative w-full md:w-auto md:flex-1 max-w-md",children:[r.jsx(Kn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 w-5 h-5"}),r.jsx("input",{type:"text",placeholder:`  ${R}...`,value:V,onChange:ne=>q(ne.target.value),className:"w-full bg-gray-900/80 text-white text-sm rounded-xl py-2.5 pr-10 pl-4 border border-gray-700 focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all placeholder-gray-500"})]}),W&&P!=="blocked"&&r.jsxs("button",{onClick:()=>{O("addUser"),N(!0)},className:"w-full md:w-auto flex items-center justify-center gap-2 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white px-6 py-2.5 rounded-xl shadow-lg shadow-red-900/30 transition-all active:scale-95 group",children:[r.jsx("div",{className:"bg-white/20 p-1 rounded-full group-hover:rotate-90 transition-transform duration-300",children:r.jsx(ID,{className:"w-4 h-4"})}),r.jsx("span",{className:"font-bold text-sm",children:" "})]})]}),r.jsx("div",{className:"relative",children:r.jsx("div",{className:"flex overflow-x-auto pb-2 scrollbar-hide gap-2 sm:gap-3 bg-gray-900/95",children:E.map(ne=>{const je=P===ne.id,se=ne.id==="blocked";return r.jsxs("button",{onClick:()=>U(ne.id),className:`
                        relative flex-shrink-0 flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-bold transition-all duration-300 border
                        ${je?se?"bg-red-900/40 text-red-200 border-red-500 shadow-md transform scale-105 z-10":"bg-gray-800 text-white border-gray-600 shadow-md transform scale-105 z-10":"bg-gray-800/40 text-gray-400 border-transparent hover:bg-gray-800/80 hover:text-gray-200"}
                      `,children:[r.jsx("span",{className:`w-2 h-2 rounded-full ${je?"bg-red-500 animate-pulse":"bg-gray-600"}`}),ne.label,r.jsx("span",{className:`mr-1 px-1.5 py-0.5 rounded-md text-[10px] ${je?"bg-white/10 text-white":"bg-black/20 text-gray-500"}`,children:ne.data.length}),je&&r.jsx("div",{className:"absolute bottom-0 left-3 right-3 h-0.5 bg-red-500 rounded-full shadow-[0_0_10px_rgba(239,68,68,0.5)]"})]},ne.id)})})})]}),X.length>0?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 animate-slide-up mt-2",children:X.map((ne,je)=>{const se=J(ne);return r.jsx("div",{style:{animationDelay:`${je*50}ms`},className:"animate-fade-slide-up",children:r.jsx(GD,{user:ne,onEdit:se?a:void 0,onDelete:se?_e=>{O("deleteUser"),x(_e)}:void 0,onApprove:se?_e=>e(_e,{status:"active"}):void 0,onBlock:se?_e=>{O("blockUser"),w(_e)}:void 0,onUnblock:se?_e=>{O("unblockUser"),T(_e)}:void 0,isPrimaryAdmin:ne.id==="5"})},ne.id)})}):r.jsxs("div",{className:"flex flex-col items-center justify-center py-24 bg-gray-800/30 rounded-3xl border border-dashed border-gray-700/50 mt-4",children:[r.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4 shadow-inner",children:r.jsx(Vd,{className:"w-10 h-10 text-gray-600 opacity-50"})}),r.jsx("h3",{className:"text-xl font-bold text-gray-300",children:"  "}),r.jsx("p",{className:"text-gray-500 text-sm mt-1",children:V?`     "${V}"`:` ${R}  .`}),W&&!V&&P!=="blocked"&&r.jsxs("button",{onClick:()=>{O("addUser"),N(!0)},className:"mt-6 text-red-400 hover:text-red-300 text-sm font-bold underline underline-offset-4",children:[" ",R.slice(0,-1)," "]})]}),m&&r.jsx(os,{title:"  ",message:`     ${WD(m.role)}: ${m.name}.   `,onConfirm:Q,onClose:K,confirmButtonText:" ",cancelButtonText:"",confirmVariant:"danger"}),y&&r.jsx(os,{title:" ",message:`      ${y.name}       .`,onConfirm:L,onClose:K,confirmButtonText:" ",cancelButtonText:"",confirmVariant:"danger"}),v&&r.jsx(os,{title:" ",message:`        ${v.name}      .`,onConfirm:G,onClose:K,confirmButtonText:" ",cancelButtonText:"",confirmVariant:"success"}),I&&r.jsx(FD,{onClose:K,onSave:ee,initialRole:P==="customers"?"customer":P==="admins"?"admin":P.slice(0,-1),appName:d,currentUserRole:f==null?void 0:f.role,currentUserPermissions:c})]})},WD=s=>{switch(s){case"driver":return"";case"merchant":return"";case"admin":return"";case"supervisor":return"";case"customer":return"";default:return""}},KD=[{id:"restaurant",label:""},{id:"market",label:" "},{id:"pharmacy",label:""},{id:"bakery",label:"/"},{id:"electronics",label:""},{id:"fashion",label:""},{id:"logistics",label:" "},{id:"other",label:""}],QD=[{title:" ",icon:r.jsx(Bt,{className:"w-5 h-5 text-blue-400"}),permissions:[{id:"view_orders",label:" ",desc:"   "},{id:"manage_orders",label:" ",desc:"   "},{id:"delete_orders",label:" ",desc:"    "}]},{title:" ",icon:r.jsx(Vd,{className:"w-5 h-5 text-purple-400"}),permissions:[{id:"view_users",label:" ",desc:"   "},{id:"manage_users",label:" ",desc:"   "},{id:"manage_stores",label:" ",desc:"   "},{id:"manage_supervisors",label:" ",desc:"   "}]},{title:" ",icon:r.jsx(ym,{className:"w-5 h-5 text-green-400"}),permissions:[{id:"view_reports",label:" ",desc:"  "},{id:"view_wallet",label:" ",desc:"   "},{id:"view_logs",label:" ",desc:"  "}]},{title:" ",icon:r.jsx(Bf,{className:"w-5 h-5 text-yellow-400"}),permissions:[{id:"manage_promo",label:" ",desc:"  "},{id:"manage_slider",label:" ",desc:"   "},{id:"send_messages",label:" ",desc:"  "},{id:"manage_decorations",label:"  ",desc:"    "}]},{title:" ",icon:r.jsx(Dr,{className:"w-5 h-5 text-indigo-400"}),permissions:[{id:"manage_support",label:"  ",desc:"    "},{id:"delete_support_messages",label:" ",desc:"   "}]}],Rv=({user:s,onClose:e,onSave:t,isLastAdmin:n,isPrimaryAdmin:a,appName:l,currentUser:c})=>{var hr,we;const d=(c==null?void 0:c.role)==="admin",[f,m]=j.useState(s.name),[x,y]=j.useState(s.phone||""),[w,v]=j.useState(s.address||""),[T,I]=j.useState(s.status),[N,P]=j.useState(s.role),[U,V]=j.useState(d&&s.password||""),[q,W]=j.useState(""),[z,k]=j.useState(!1),[M,B]=j.useState(s.commissionRate||0),[D,S]=j.useState(s.commissionType||"percentage"),[F,E]=j.useState(s.incentivesActive||!1),[Y,X]=j.useState(s.dailyLogMode||"12_hour"),[R,J]=j.useState(s.maxConcurrentOrders===void 0||s.maxConcurrentOrders===null),[O,K]=j.useState(s.maxConcurrentOrders||1),[Q,L]=j.useState(s.permissions||[]),[G,ee]=j.useState(((hr=s.workingHours)==null?void 0:hr.start)||"09:00"),[ne,je]=j.useState(((we=s.workingHours)==null?void 0:we.end)||"23:00"),[se,_e]=j.useState(s.hasFreeDelivery||!1),[Te,be]=j.useState(s.responseTime||""),[ye,et]=j.useState(s.storeCategory||"restaurant"),[Je,bt]=j.useState(s.canShowDeliveryTime||!1),[yt,Ae]=j.useState(s.canManageMenu!==!1),[fe,$e]=j.useState(""),[ce,Oe]=j.useState(s.storeImage||null),[Pe,Ge]=j.useState(!1),Ke=j.useRef(null),Ie=l||"GOO NOW";Ht(()=>(e(),!0),[e]);const Le="w-full px-4 py-3 bg-[#252525] border border-[#333] text-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors",Lt=j.useMemo(()=>{var Re;const pe=[{id:"customer",label:""},{id:"driver",label:""},{id:"merchant",label:""},{id:"supervisor",label:""},{id:"admin",label:""}];if((c==null?void 0:c.role)==="supervisor"){const he=(Re=c.permissions)==null?void 0:Re.includes("manage_supervisors");return pe.filter(Me=>Me.id!=="admin"&&(he||Me.id!=="supervisor"))}return pe},[c==null?void 0:c.role,c==null?void 0:c.permissions]),bs=pe=>{L(Re=>Re.includes(pe)?Re.filter(he=>he!==pe):[...Re,pe])},Zt=pe=>{var he;const Re=(he=pe.target.files)==null?void 0:he[0];if(Re){Ge(!0);const Me=new FileReader;Me.onloadend=()=>{const ze=new Image;ze.src=Me.result,ze.onload=()=>{const tt=document.createElement("canvas"),Se=1024,Fe=Se/ze.width;tt.width=Se,tt.height=ze.height*Fe;const it=tt.getContext("2d");it&&(it.imageSmoothingEnabled=!0,it.imageSmoothingQuality="high",it.drawImage(ze,0,0,tt.width,tt.height),setTimeout(()=>{Oe(tt.toDataURL("image/jpeg",.9)),Ge(!1)},800))}},Me.readAsDataURL(Re)}},Ws=()=>{if(!f){$e("      .");return}if(String(s.id)==="5"||s.role==="admin"){if(!x||x.trim().length<1){$e("   .");return}if(U!==void 0&&U!==""&&U.length<1){$e("      .");return}}else{if(x&&!/^\d{11}$/.test(x)){$e("      11 .");return}if(U&&U.length<6){$e("     6     .");return}}if(U&&U!==q&&!d&&(U!==(s.password||"")||!d)&&U!==q){$e("   .");return}$e("");const Re={name:f,phone:x,status:T,role:N,storeImage:ce||void 0,address:N!=="driver"&&w?w:void 0};U&&(Re.password=U),N==="driver"&&(Re.commissionRate=M,Re.commissionType=D,Re.incentivesActive=F,Re.dailyLogMode=Y,Re.maxConcurrentOrders=R?null:O),N==="merchant"&&(Re.workingHours={start:G,end:ne},Re.hasFreeDelivery=se,Re.responseTime=Te,Re.storeCategory=ye,Re.canShowDeliveryTime=Je,Re.canManageMenu=yt),N==="supervisor"&&(Re.permissions=Q),N==="driver"&&R&&(Re.maxConcurrentOrders=null),t(s.id,Re),e()},Ds=String(s.id)==="5"||s.role==="admin",En=(c==null?void 0:c.role)==="supervisor"&&(c==null?void 0:c.id)===s.id;return r.jsxs("div",{className:"fixed inset-0 bg-[#111] z-[60] overflow-y-auto animate-fadeIn flex flex-col",children:[r.jsxs("div",{className:"flex-none bg-[#1a1a1a] border-b border-[#333] px-4 pt-safe h-16 box-content flex items-center justify-between sticky top-0 z-20 shadow-lg",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:e,className:"bg-[#252525] p-2 rounded-full text-gray-400 hover:text-white transition-colors",children:r.jsx(Gs,{className:"w-6 h-6 rotate-180"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-white",children:" "}),r.jsx("p",{className:"text-xs text-gray-500 font-mono",children:s.id})]})]}),r.jsx("button",{onClick:Ws,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-lg transition-colors shadow-md",children:" "})]}),r.jsxs("div",{className:"flex-1 max-w-4xl mx-auto w-full p-4 sm:p-8 space-y-8 pb-20",children:[r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("div",{onClick:()=>{var pe;return!Pe&&((pe=Ke.current)==null?void 0:pe.click())},className:"relative cursor-pointer rounded-full flex items-center justify-center overflow-hidden group shadow-xl transition-all duration-300 w-36 h-36 border-2 border-gray-700",children:r.jsxs("div",{className:"w-full h-full rounded-full overflow-hidden bg-[#252525] relative border-2 border-[#111]",children:[Pe&&r.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 z-50 backdrop-blur-sm",children:r.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})}),ce?r.jsx("img",{src:ce,alt:"Profile",className:"w-full h-full object-cover"}):r.jsx("div",{className:"flex flex-col items-center justify-center h-full w-full text-gray-400",children:r.jsx(ga,{className:"w-10 h-10 mb-1"})}),r.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:r.jsx(ur,{className:"w-8 h-8 text-white"})})]})}),r.jsx("input",{ref:Ke,type:"file",accept:"image/*",className:"absolute opacity-0 w-0 h-0 pointer-events-none",onChange:Zt})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm h-fit",children:[r.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"w-1 h-5 bg-red-500 rounded-full"})," "]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),r.jsx("input",{type:"text",value:f,onChange:pe=>m(pe.target.value),className:Le})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:Ds?"  ()":" "}),r.jsx("input",{type:Ds?"text":"tel",value:x,onChange:pe=>y(pe.target.value),className:`${Le} ${Ds?"":"text-right placeholder:text-right"}`,dir:"rtl",placeholder:Ds?"     (: 5)":"01xxxxxxxxx"})]}),!En&&N!=="driver"&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:""}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"text",value:w,onChange:pe=>v(pe.target.value),className:`${Le} pl-10`,placeholder:" "}),r.jsx(jn,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500"})]})]}),!En&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" (Role)"}),r.jsx("div",{className:`flex flex-wrap gap-2 ${n||a?"opacity-50 cursor-not-allowed":""}`,children:Lt.map(pe=>r.jsx("button",{type:"button",onClick:()=>P(pe.id),disabled:n||a,className:`px-4 py-2 text-sm font-bold rounded-xl border transition-all ${N===pe.id?"bg-red-600 border-red-600 text-white shadow-lg":"bg-transparent border-gray-600 text-gray-400 hover:border-gray-400"}`,children:pe.label},pe.id))})]}),!En&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),r.jsx("div",{className:`flex bg-[#252525] p-1 rounded-xl border border-[#333] ${a?"opacity-50 pointer-events-none":""}`,children:[{value:"active",label:""},{value:"pending",label:" "},{value:"inactive",label:" "}].map(pe=>r.jsx("button",{type:"button",onClick:()=>I(pe.value),disabled:a,className:`flex-1 py-2 text-xs font-bold rounded-lg transition-colors ${T===pe.value?"bg-white text-black shadow-sm":"text-gray-400 hover:text-white"}`,children:pe.label},pe.value))})]})]}),r.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm h-fit",children:[r.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"w-1 h-5 bg-blue-500 rounded-full"}),"  "]}),r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:d?"  ":"   "}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:z?"text":"password",value:U,onChange:pe=>V(pe.target.value),className:`${Le} pr-10`,placeholder:d?Ds?"    ":"******":"   "}),r.jsx("button",{type:"button",onClick:()=>k(!z),className:"absolute inset-y-0 left-0 px-3 flex items-center text-gray-400 hover:text-white",children:z?r.jsx(Ui,{className:"w-5 h-5"}):r.jsx(wa,{className:"w-5 h-5"})})]}),Ds&&d&&r.jsx("p",{className:"text-[10px] text-green-400 mt-2 font-bold",children:" :        ."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"  "}),r.jsx("input",{type:"password",value:q,onChange:pe=>W(pe.target.value),className:Le,placeholder:d?"******":"    "})]})]}),N==="merchant"&&r.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm md:col-span-2",children:[r.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"w-1 h-5 bg-purple-500 rounded-full"})," "]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"text-xs text-gray-500 mb-1 block text-center",children:" "}),r.jsx("input",{type:"time",value:G,onChange:pe=>ee(pe.target.value),className:"w-full bg-[#252525] border border-[#333] rounded-xl p-3 text-white text-center font-mono text-lg focus:border-purple-500 outline-none"})]}),r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"text-xs text-gray-500 mb-1 block text-center",children:" "}),r.jsx("input",{type:"time",value:ne,onChange:pe=>je(pe.target.value),className:"w-full bg-[#252525] border border-[#333] rounded-xl p-3 text-white text-center font-mono text-lg focus:border-purple-500 outline-none"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),r.jsxs("div",{className:"relative",children:[r.jsx("select",{value:ye,onChange:pe=>et(pe.target.value),className:`${Le} appearance-none`,children:KD.map(pe=>r.jsx("option",{value:pe.id,children:pe.label},pe.id))}),r.jsx(Sn,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500 pointer-events-none"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"  ()"}),r.jsx("input",{type:"text",value:Te,onChange:pe=>be(pe.target.value),className:Le,placeholder:": 15 "})]})]}),r.jsxs("div",{className:"space-y-2 mt-4 pt-2 border-t border-[#333]",children:[r.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#252525] rounded-xl border border-[#333]",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Bt,{className:"w-4 h-4 text-green-500"}),r.jsx("label",{htmlFor:"freeDelivery",className:"text-sm font-bold text-white",children:"  "})]}),r.jsx("input",{id:"freeDelivery",type:"checkbox",checked:se,onChange:pe=>_e(pe.target.checked),className:"h-5 w-5 text-green-600 bg-gray-700 border-gray-600 rounded focus:ring-green-500"})]}),r.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#252525] rounded-xl border border-[#333]",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Xr,{className:"w-4 h-4 text-orange-400"}),r.jsx("label",{className:"text-sm font-bold text-white",children:"  "})]}),r.jsx("input",{type:"checkbox",checked:yt,onChange:pe=>Ae(pe.target.checked),className:"h-5 w-5 text-orange-600 bg-gray-700 border-gray-600 rounded focus:ring-orange-500"})]}),r.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#252525] rounded-xl border border-[#333]",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(wt,{className:"w-4 h-4 text-blue-400"}),r.jsx("label",{className:"text-sm font-bold text-white",children:"   ( )"})]}),r.jsx("input",{type:"checkbox",checked:Je,onChange:pe=>bt(pe.target.checked),className:"h-5 w-5 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500"})]})]})]}),N==="driver"&&r.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-6 shadow-sm md:col-span-2",children:[r.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"w-1 h-5 bg-orange-500 rounded-full"}),"  "]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),r.jsx("div",{className:"flex bg-[#252525] p-1 rounded-xl border border-[#333]",children:[{value:"12_hour",label:""},{value:"always_open",label:""}].map(pe=>r.jsx("button",{type:"button",onClick:()=>X(pe.value),className:`flex-1 py-2.5 text-sm font-bold rounded-lg transition-all ${Y===pe.value?"bg-orange-500 text-white shadow-md":"text-gray-400 hover:text-white"}`,children:pe.label},pe.value))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"  "}),r.jsxs("div",{className:"bg-[#252525] p-4 rounded-xl border border-[#333] flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-white font-medium",children:R?" ":O}),r.jsx("button",{onClick:()=>J(!R),className:`w-12 h-6 rounded-full p-1 transition-colors duration-300 ${R?"bg-green-600":"bg-gray-600"}`,children:r.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-300 ${R?"translate-x-0":"-translate-x-6"}`})})]}),!R&&r.jsx("input",{type:"range",min:"1",max:"10",value:O,onChange:pe=>K(parseInt(pe.target.value)),className:"w-full mt-2 accent-orange-500 h-2 bg-gray-700 rounded-lg appearance-none"})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsxs("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:["  ",Ie]}),r.jsxs("div",{className:"bg-[#252525] p-4 rounded-xl border border-[#333] space-y-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-2",children:" "}),r.jsx("div",{className:"flex gap-2",children:[0,25,50].map(pe=>r.jsxs("button",{type:"button",onClick:()=>{S("percentage"),B(pe)},className:`px-4 py-2 text-sm font-bold rounded-lg border transition-all ${D==="percentage"&&M===pe?"bg-orange-500 border-orange-500 text-white":"bg-transparent border-gray-600 text-gray-400"}`,children:[pe,"%"]},`perc-${pe}`))})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"  (.)"}),r.jsx("div",{className:"flex gap-2",children:[5,10,15,20].map(pe=>r.jsx("button",{type:"button",onClick:()=>{S("fixed"),B(pe)},className:`px-4 py-2 text-sm font-bold rounded-lg border transition-all ${D==="fixed"&&M===pe?"bg-orange-500 border-orange-500 text-white":"bg-transparent border-gray-600 text-gray-400"}`,children:pe},`fixed-${pe}`))})]})]})]})]})]}),N==="supervisor"&&!En&&r.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm md:col-span-2",children:[r.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-4 flex items-center gap-2",children:[r.jsx(Yr,{className:"w-5 h-5 text-yellow-500"})," "]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:QD.map((pe,Re)=>r.jsxs("div",{className:"bg-[#222] p-4 rounded-xl border border-[#333]",children:[r.jsxs("h4",{className:"text-sm font-bold text-gray-300 mb-3 flex items-center gap-2",children:[pe.icon,pe.title]}),r.jsx("div",{className:"space-y-2",children:pe.permissions.map(he=>r.jsxs("label",{className:"flex items-start gap-3 p-2 hover:bg-[#2a2a2a] rounded-lg transition-colors cursor-pointer group",children:[r.jsxs("div",{className:"relative flex items-center mt-0.5",children:[r.jsx("input",{type:"checkbox",checked:Q.includes(he.id),onChange:()=>bs(he.id),className:"peer h-5 w-5 cursor-pointer appearance-none rounded-md border-2 border-gray-600 bg-gray-800 transition-all checked:border-yellow-500 checked:bg-yellow-500"}),r.jsx(nt,{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-3.5 h-3.5 text-black opacity-0 peer-checked:opacity-100 pointer-events-none"})]}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"text-sm font-bold text-gray-200 group-hover:text-white transition-colors",children:he.label}),he.desc&&r.jsx("p",{className:"text-[10px] text-gray-500",children:he.desc})]})]},he.id))})]},Re))})]})]}),fe&&r.jsx("p",{className:"text-red-400 font-bold text-center bg-red-900/20 p-3 rounded-xl border border-red-500/30",children:fe})]})]})},YD=s=>{switch(s){case"merchant":return"";case"driver":return" ";case"customer":return"";case"admin":return" ";case"supervisor":return"";default:return s}},JD=s=>{switch(s){case"restaurant":return"";case"market":return" ";case"pharmacy":return"";case"other":return"";default:return s||" "}},Ba=({label:s,value:e,icon:t,fullWidth:n,highlight:a})=>r.jsxs("div",{className:`bg-[#252525] p-4 rounded-xl border ${a?"border-red-500/30 bg-red-900/10":"border-[#333]"} flex flex-col justify-center ${n?"col-span-2":""} shadow-sm`,children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[t&&Ar.cloneElement(t,{className:`w-4 h-4 ${a?"text-red-400":"text-gray-500"}`}),r.jsx("span",{className:`text-xs font-bold ${a?"text-red-300":"text-gray-400"}`,children:s})]}),r.jsx("p",{className:"font-bold text-white text-base break-words tracking-wide",children:e})]}),Dv=({user:s,onClose:e,onApprove:t,onDelete:n})=>{const a=()=>{t(s.id,{status:"active"})},l=()=>{window.confirm("       ")&&n(s.id)},c=(()=>{try{const f=new Date(s.createdAt);return isNaN(f.getTime())?" ":f.toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return" "}})(),d=()=>{switch(s.role){case"driver":return"from-orange-900/80 to-gray-900";case"merchant":return"from-purple-900/80 to-gray-900";case"admin":return"from-red-900/80 to-gray-900";default:return"from-blue-900/80 to-gray-900"}};return r.jsx("div",{className:"fixed inset-0 bg-black/95 backdrop-blur-md flex justify-center items-end sm:items-center z-50 p-0 sm:p-4 animate-fadeIn",onClick:e,children:r.jsxs("div",{className:"bg-[#1a1a1a] w-full sm:max-w-lg h-[95vh] sm:h-auto sm:max-h-[90vh] rounded-t-3xl sm:rounded-3xl border-t sm:border border-[#333] shadow-2xl flex flex-col relative overflow-hidden",onClick:f=>f.stopPropagation(),children:[r.jsxs("div",{className:`h-40 bg-gradient-to-br ${d()} relative`,children:[r.jsx("div",{className:"absolute inset-0 opacity-20 bg-[radial-gradient(#ffffff_1px,transparent_1px)] [background-size:16px_16px]"}),r.jsx("button",{onClick:e,className:"absolute top-4 left-4 bg-black/40 hover:bg-black/60 text-white p-2 rounded-full backdrop-blur-md transition-colors z-20 border border-white/10",children:r.jsx(rt,{className:"w-6 h-6"})}),r.jsx("div",{className:"absolute top-4 right-4 z-20",children:r.jsx("span",{className:`px-3 py-1.5 rounded-full text-xs font-bold border backdrop-blur-md shadow-lg ${s.status==="active"?"bg-green-500/20 text-green-400 border-green-500/30":s.status==="pending"?"bg-yellow-500/20 text-yellow-400 border-yellow-500/30":"bg-red-500/20 text-red-400 border-red-500/30"}`,children:s.status==="active"?"  ":s.status==="pending"?"  ":" "})})]}),r.jsxs("div",{className:"px-6 relative -mt-16 flex flex-col items-center z-10",children:[r.jsxs("div",{className:"w-32 h-32 rounded-3xl bg-[#252525] p-1 shadow-2xl relative group",children:[r.jsx("div",{className:"w-full h-full rounded-2xl overflow-hidden border-4 border-[#1a1a1a] relative bg-gray-800 flex items-center justify-center",children:s.storeImage?r.jsx("img",{src:s.storeImage,alt:s.name,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-12 h-12 text-gray-500"})}),r.jsxs("div",{className:"absolute -bottom-2 -right-2 bg-gray-800 text-[10px] px-2 py-1 rounded-lg font-bold text-white border border-[#444] shadow-md flex items-center gap-1",children:[r.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"}),"ID: ",s.id]})]}),r.jsx("h2",{className:"text-3xl font-black text-white mt-4 text-center tracking-tight",children:s.name}),r.jsxs("div",{className:"flex items-center gap-2 mt-2 bg-[#252525] px-4 py-1.5 rounded-full border border-[#333]",children:[r.jsx("span",{className:"text-gray-400 text-sm font-medium",children:YD(s.role)}),s.role==="driver"&&r.jsx("span",{className:"text-gray-600",children:""}),s.role==="driver"&&r.jsx("span",{className:"text-orange-400 text-xs font-bold",children:"Driver App"})]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8 scrollbar-hide",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[r.jsx(pt,{className:"w-4 h-4 text-red-500"})," "]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(Ba,{label:" ",value:s.phone||" ",icon:r.jsx(Js,{}),fullWidth:!0,highlight:!0}),r.jsx(Ba,{label:" ",value:c,icon:r.jsx(il,{}),fullWidth:!0}),s.email&&r.jsx(Ba,{label:" ",value:s.email,icon:r.jsx(_w,{}),fullWidth:!0}),s.addresses&&s.addresses.length>0&&r.jsx(Ba,{label:" ",value:s.addresses[0],icon:r.jsx(jn,{}),fullWidth:!0})]})]}),s.role==="merchant"&&r.jsxs("div",{children:[r.jsx("div",{className:"h-px bg-[#333] mb-6"}),r.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[r.jsx(Sn,{className:"w-4 h-4 text-purple-500"})," "]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(Ba,{label:" ",value:JD(s.storeCategory)}),s.workingHours?r.jsx(Ba,{label:" ",value:`${s.workingHours.start} - ${s.workingHours.end}`,icon:r.jsx(wt,{})}):r.jsx(Ba,{label:" ",value:" ",icon:r.jsx(wt,{})})]})]}),s.role==="driver"&&r.jsxs("div",{children:[r.jsx("div",{className:"h-px bg-[#333] mb-6"}),r.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[r.jsx(on,{className:"w-4 h-4 text-orange-500"}),"  "]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(Ba,{label:" ",value:s.commissionType==="fixed"?" ":" "}),r.jsx(Ba,{label:"",value:s.commissionType==="fixed"?`${s.commissionRate} .`:`${s.commissionRate}%`,highlight:!0}),r.jsx(Ba,{label:" ",value:s.dailyLogMode==="always_open"?" ":" (12 )",fullWidth:!0})]})]})]}),r.jsx("div",{className:"p-5 bg-[#1a1a1a] border-t border-[#333] flex gap-4 pb-8 sm:pb-5",children:s.status==="pending"?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:a,className:"flex-[2] bg-green-600 hover:bg-green-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-green-900/20 active:scale-95 transition-all flex items-center justify-center gap-2",children:[r.jsx(nt,{className:"w-5 h-5"})," "]}),r.jsxs("button",{onClick:l,className:"flex-1 bg-red-900/20 hover:bg-red-900/30 text-red-500 border border-red-500/20 font-bold py-4 rounded-xl active:scale-95 transition-all flex items-center justify-center gap-2",children:[r.jsx(Pt,{className:"w-5 h-5"}),""]})]}):r.jsxs("div",{className:"w-full flex gap-3",children:[r.jsx("button",{onClick:e,className:"flex-1 bg-gray-800 hover:bg-gray-700 text-gray-200 font-bold py-4 rounded-xl transition-colors border border-gray-700",children:""}),r.jsx("button",{onClick:l,className:"w-16 bg-red-900/10 hover:bg-red-900/20 text-red-500 border border-red-500/10 font-bold py-4 rounded-xl active:scale-95 transition-all flex items-center justify-center",title:" ",children:r.jsx(Pt,{className:"w-5 h-5"})})]})})]})})},G5=({merchant:s,onUpdateMerchant:e})=>{const[t,n]=j.useState(s.products||[]),[a,l]=j.useState(!1),[c,d]=j.useState({}),[f,m]=j.useState([]),[x,y]=j.useState(""),[w,v]=j.useState(""),[T,I]=j.useState(""),[N,P]=j.useState(!1),[U,V]=j.useState(null),[q,W]=j.useState(null),z=j.useRef(null);Ht(()=>q?(W(null),!0):U?(V(null),!0):a?(l(!1),!0):!1,[U,a,q]);const k=j.useMemo(()=>{const R=new Set(t.map(J=>J.category||""));return["",...Array.from(R)]},[t]),M=j.useMemo(()=>T===""?t:t.filter(R=>(R.category||"")===T),[t,T]),B=R=>new Promise((J,O)=>{const K=new FileReader;K.readAsDataURL(R),K.onload=Q=>{var G;const L=new Image;L.src=(G=Q.target)==null?void 0:G.result,L.onload=()=>{const ee=document.createElement("canvas"),ne=1200,je=1200;let se=L.width,_e=L.height;se>_e?se>ne&&(_e*=ne/se,se=ne):_e>je&&(se*=je/_e,_e=je),ee.width=se,ee.height=_e;const Te=ee.getContext("2d");Te?(Te.imageSmoothingEnabled=!0,Te.imageSmoothingQuality="high",Te.drawImage(L,0,0,se,_e),J(ee.toDataURL("image/jpeg",.9))):O(new Error("Canvas context failed"))},L.onerror=ee=>O(ee)},K.onerror=Q=>O(Q)}),D=async R=>{var O;const J=(O=R.target.files)==null?void 0:O[0];if(J){P(!0);try{const K=await B(J);setTimeout(()=>{d(Q=>({...Q,image:K})),P(!1)},800)}catch{P(!1),alert("  .")}}},S=()=>{x&&w&&(m([...f,{name:x,price:parseFloat(w)}]),y(""),v(""))},F=R=>{m(f.filter((J,O)=>O!==R))},E=()=>{var K;if(!c.name||!c.price&&f.length===0)return;let R=[...t];const J=((K=c.category)==null?void 0:K.trim())||"",O={id:c.id||`PROD-${Date.now()}`,name:c.name,description:c.description||"",price:Number(c.price)||0,image:c.image,available:c.available??!0,category:J,sizes:f.length>0?f:void 0};c.id?R=R.map(Q=>Q.id===c.id?O:Q):R.push(O),n(R),e(s.id,{products:R}),l(!1),d({}),m([]),I(J)},Y=()=>{if(!q)return;const R=t.filter(J=>J.id!==q);n(R),e(s.id,{products:R}),W(null)},X=R=>{d(R||{available:!0,category:T!==""?T:""}),m((R==null?void 0:R.sizes)||[]),l(!0)};return r.jsxs("div",{className:"space-y-4 pb-20",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4 px-1",children:[r.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[r.jsx(Sn,{className:"w-6 h-6 text-red-500"})," "]}),r.jsxs("button",{onClick:()=>X(),className:"flex items-center bg-red-600 text-white px-4 py-2 rounded-xl text-sm font-bold shadow-lg hover:bg-red-700 transition-colors",children:[r.jsx(ln,{className:"w-4 h-4 ml-1"})," "]})]}),!a&&r.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide mb-4 px-1",children:k.map(R=>r.jsx("button",{onClick:()=>I(R),className:`px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap transition-colors border ${T===R?"bg-red-600 text-white border-red-600 shadow-md":"bg-gray-800 text-gray-400 border-gray-700 hover:bg-gray-700"}`,children:R},R))}),a&&r.jsxs("div",{className:"bg-gray-800 p-5 rounded-xl border border-gray-700 space-y-4 mb-6 shadow-2xl animate-fadeIn",children:[r.jsxs("div",{className:"flex justify-between items-center border-b border-gray-700 pb-3",children:[r.jsx("h3",{className:"text-lg font-bold text-gray-200",children:c.id?" ":" "}),r.jsx("button",{onClick:()=>l(!1),children:r.jsx(rt,{className:"w-5 h-5 text-gray-400 hover:text-white"})})]}),r.jsx("div",{className:"flex justify-center mb-4",children:r.jsxs("div",{onClick:()=>{var R;return!N&&((R=z.current)==null?void 0:R.click())},className:`w-full h-40 bg-gray-900 rounded-xl flex items-center justify-center cursor-pointer border-2 border-dashed border-gray-600 hover:border-red-500 overflow-hidden relative group transition-colors ${N?"opacity-50 cursor-wait":""}`,children:[N&&r.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 z-50 backdrop-blur-sm",children:r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full opacity-75 animate-ping absolute top-0 left-0"}),r.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center relative z-10 shadow-lg shadow-blue-500/50",children:r.jsx(ur,{className:"w-6 h-6 text-white animate-bounce"})}),r.jsx("div",{className:"w-20 h-20 border-4 border-blue-400/30 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"})]})}),c.image?r.jsx("img",{src:c.image,alt:"Preview",className:"w-full h-full object-cover"}):r.jsxs("div",{className:"flex flex-col items-center text-gray-500",children:[r.jsx(Qr,{className:"w-10 h-10 mb-2"}),r.jsx("span",{className:"text-xs",children:"  "})]}),r.jsx("input",{ref:z,type:"file",className:"hidden",accept:"image/*",onChange:D})]})}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:" "}),r.jsx("input",{type:"text",value:c.name||"",onChange:R=>d({...c,name:R.target.value}),className:"w-full bg-gray-700 text-white p-3 rounded-lg border border-gray-600 focus:border-red-500 outline-none"})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsxs("div",{className:"w-1/2",children:[r.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"  (.)"}),r.jsx("input",{type:"number",value:c.price||"",onChange:R=>d({...c,price:Number(R.target.value)}),className:"w-full bg-gray-700 text-white p-3 rounded-lg border border-gray-600 focus:border-red-500 outline-none font-bold",placeholder:"0"})]}),r.jsxs("div",{className:"w-1/2",children:[r.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:""}),r.jsx("input",{type:"text",list:"category-suggestions",value:c.category||"",onChange:R=>d({...c,category:R.target.value}),className:"w-full bg-gray-700 text-white p-3 rounded-lg border border-gray-600 focus:border-red-500 outline-none",placeholder:": "}),r.jsx("datalist",{id:"category-suggestions",children:k.filter(R=>R!=="").map(R=>r.jsx("option",{value:R},R))})]})]}),r.jsxs("div",{className:"bg-[#1a1a1a] p-3 rounded-lg border border-gray-700",children:[r.jsx("label",{className:"block text-xs font-bold text-gray-300 mb-2",children:"  ()"}),r.jsx("div",{className:"space-y-2 mb-3",children:f.map((R,J)=>r.jsxs("div",{className:"flex items-center gap-2 bg-gray-800 p-2 rounded-md border border-gray-600",children:[r.jsx("span",{className:"flex-1 text-sm text-white",children:R.name}),r.jsxs("span",{className:"text-sm font-bold text-green-400",children:[R.price.toLocaleString("en-US")," ."]}),r.jsx("button",{onClick:()=>F(J),className:"text-red-400 hover:bg-red-500/10 p-1 rounded",children:r.jsx(Pt,{className:"w-4 h-4"})})]},J))}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"text",placeholder:" (: )",value:x,onChange:R=>y(R.target.value),className:"flex-[2] bg-gray-700 text-white text-xs p-2 rounded border border-gray-600 focus:border-blue-500 outline-none"}),r.jsx("input",{type:"number",placeholder:"",value:w,onChange:R=>v(R.target.value),className:"flex-1 bg-gray-700 text-white text-xs p-2 rounded border border-gray-600 focus:border-blue-500 outline-none"}),r.jsx("button",{onClick:S,className:"bg-blue-600 text-white p-2 rounded hover:bg-blue-500",children:r.jsx(ln,{className:"w-4 h-4"})})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:""}),r.jsx("textarea",{value:c.description||"",onChange:R=>d({...c,description:R.target.value}),className:"w-full bg-gray-700 text-white p-3 rounded-lg border border-gray-600 focus:border-red-500 outline-none resize-none",rows:3})]}),r.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[r.jsx("input",{type:"checkbox",id:"available",checked:c.available!==!1,onChange:R=>d({...c,available:R.target.checked}),className:"w-5 h-5 rounded bg-gray-700 border-gray-600 text-red-600 focus:ring-red-500"}),r.jsx("label",{htmlFor:"available",className:"text-sm text-gray-300",children:"  "})]}),r.jsxs("div",{className:"flex justify-end gap-3 mt-4 pt-4 border-t border-gray-700",children:[r.jsx("button",{onClick:()=>l(!1),className:"px-6 py-2.5 rounded-lg border border-gray-600 text-gray-300 hover:bg-gray-700 transition-colors font-bold",children:""}),r.jsx("button",{onClick:E,disabled:N,className:"px-8 py-2.5 bg-red-600 text-white rounded-lg hover:bg-red-700 shadow-lg transition-colors font-bold disabled:bg-gray-600 disabled:cursor-not-allowed",children:N?" ...":" "})]})]}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 animate-fadeIn",children:M.map(R=>r.jsxs("div",{className:"group bg-gray-800 rounded-2xl overflow-hidden border border-gray-700 shadow-sm hover:shadow-xl hover:border-gray-500 transition-all duration-300 flex flex-col",children:[r.jsxs("div",{className:"relative aspect-square w-full bg-gray-900 overflow-hidden cursor-pointer",onClick:()=>R.image&&V(R.image),children:[R.image?r.jsx("img",{src:R.image,alt:R.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}):r.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:r.jsx(Qr,{className:"w-10 h-10 opacity-30"})}),!R.available&&r.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center backdrop-blur-[1px]",children:r.jsx("span",{className:"text-[10px] bg-red-600 text-white px-3 py-1 rounded-full font-bold shadow-md",children:" "})})]}),r.jsxs("div",{className:"p-3 flex-1 flex flex-col",children:[r.jsx("h4",{className:"font-bold text-white text-sm mb-1 line-clamp-1",title:R.name,children:R.name}),r.jsx("p",{className:"text-[10px] text-gray-400 line-clamp-2 leading-relaxed mb-2 flex-1",children:R.description}),r.jsxs("div",{className:"flex justify-between items-center mt-auto",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsxs("span",{className:"text-red-400 font-black text-sm",children:[R.price.toLocaleString("en-US")," ",r.jsx("span",{className:"text-[9px]",children:"."})]}),R.sizes&&R.sizes.length>0&&r.jsxs("span",{className:"text-[9px] text-green-400",children:["+ ",R.sizes.length," "]})]}),r.jsx("span",{className:"text-[9px] font-mono bg-gray-700 text-gray-300 px-1.5 py-0.5 rounded border border-gray-600 truncate max-w-[60px]",children:R.category||""})]})]}),r.jsxs("div",{className:"grid grid-cols-2 divide-x divide-x-reverse divide-gray-700 border-t border-gray-700 bg-gray-800/80 backdrop-blur-sm",children:[r.jsx("button",{onClick:()=>X(R),className:"py-2.5 flex items-center justify-center text-blue-400 hover:bg-blue-500/10 transition-colors",children:r.jsx(cr,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>W(R.id),className:"py-2.5 flex items-center justify-center text-red-400 hover:bg-red-500/10 transition-colors",children:r.jsx(Pt,{className:"w-4 h-4"})})]})]},R.id))}),M.length===0&&!a&&r.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500 bg-gray-800/30 rounded-3xl border border-dashed border-gray-700 mx-1",children:[r.jsx(Sn,{className:"w-16 h-16 mb-4 opacity-20"}),r.jsx("p",{className:"text-lg font-bold text-gray-400",children:" "})]}),U&&r.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex items-center justify-center p-4 animate-fadeIn",onClick:()=>V(null),children:[r.jsx("button",{onClick:()=>V(null),className:"absolute top-4 right-4 p-2 bg-gray-800/50 rounded-full text-white hover:bg-gray-700 transition-colors z-20",children:r.jsx(rt,{className:"w-6 h-6"})}),r.jsx("img",{src:U,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl animate-pop-in",onClick:R=>R.stopPropagation()})]}),q&&r.jsx(os,{title:" ",message:"         ",onClose:()=>W(null),onConfirm:Y,confirmButtonText:"",confirmVariant:"danger"})]})},W5=({users:s,orders:e,updateUser:t})=>{var T;const[n,a]=j.useState(""),[l,c]=j.useState(null),[d,f]=j.useState(null),[m,x]=j.useState(null);Ht(()=>m?(x(null),!0):l?(c(null),!0):d?(f(null),!0):!1,[m,l,d]);const y=s.filter(I=>I.role==="merchant"),w=y.filter(I=>I.name.toLowerCase().includes(n.toLowerCase())||I.phone&&I.phone.includes(n)),v=I=>{t(I.id,{hasFreeDelivery:!I.hasFreeDelivery})};return r.jsxs("div",{className:"space-y-6 pb-32 animate-fadeIn relative",children:[r.jsxs("div",{className:"bg-gray-800 p-4 rounded-2xl shadow-lg border border-gray-700/50 flex flex-col md:flex-row gap-4 items-center",children:[r.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[r.jsx("div",{className:"p-3 bg-purple-500/20 rounded-xl text-purple-400",children:r.jsx(lr,{className:"w-6 h-6"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-white",children:" "}),r.jsxs("p",{className:"text-xs text-gray-400",children:[y.length,"  "]})]})]}),r.jsxs("div",{className:"relative flex-1 w-full",children:[r.jsx(Kn,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 w-5 h-5"}),r.jsx("input",{type:"text",placeholder:"  ...",value:n,onChange:I=>a(I.target.value),className:"w-full bg-gray-900 text-white rounded-xl py-3 pr-12 pl-4 border border-gray-600 focus:border-purple-500 focus:ring-1 focus:ring-purple-500 outline-none transition-all placeholder-gray-500"})]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.length>0?w.map((I,N)=>{const P=e.filter(U=>U.merchantId===I.id&&U.status===ue.Delivered).length;return r.jsxs("div",{className:"bg-[#1e293b] rounded-2xl overflow-hidden border border-gray-700 shadow-md group hover:border-gray-500 transition-all flex flex-col",children:[r.jsxs("div",{className:"h-24 bg-gray-800 relative overflow-hidden",children:[I.storeImage?r.jsx("img",{src:I.storeImage,className:"w-full h-full object-cover opacity-60 group-hover:opacity-80 transition-opacity",alt:I.name}):r.jsx("div",{className:"w-full h-full flex items-center justify-center",children:r.jsx(lr,{className:"w-12 h-12 text-gray-600 opacity-50"})}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#1e293b] to-transparent"}),r.jsxs("div",{className:"absolute bottom-3 right-4",children:[r.jsx("h3",{className:"text-lg font-bold text-white shadow-sm",children:I.name}),r.jsx("p",{className:"text-xs text-gray-400 font-mono",children:I.phone})]}),r.jsxs("div",{className:"absolute top-2 left-2 flex gap-2",children:[r.jsx("button",{onClick:()=>f(I),className:"bg-black/40 hover:bg-black/60 p-2 rounded-full text-white backdrop-blur-sm transition-colors border border-white/5",title:"",children:r.jsx(wa,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>c(I),className:"bg-black/40 hover:bg-black/60 p-2 rounded-full text-white backdrop-blur-sm transition-colors border border-white/5",title:"",children:r.jsx(cr,{className:"w-4 h-4"})})]})]}),r.jsxs("div",{className:"p-4 space-y-4 flex-1 flex flex-col",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("div",{className:"flex-1 bg-gray-900/50 p-2 rounded-lg text-center border border-gray-700",children:[r.jsx("p",{className:"text-[10px] text-gray-500 mb-1",children:" "}),r.jsx("p",{className:"font-bold text-white text-lg",children:P})]}),r.jsxs("div",{className:"flex-1 bg-gray-900/50 p-2 rounded-lg text-center border border-gray-700",children:[r.jsx("p",{className:"text-[10px] text-gray-500 mb-1",children:" "}),r.jsx("p",{className:"font-bold text-blue-400 text-sm mt-1",children:I.responseTime||"--"})]})]}),r.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-700/50",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:`p-1.5 rounded-lg ${I.hasFreeDelivery?"bg-green-500/20 text-green-400":"bg-gray-700 text-gray-500"}`,children:r.jsx(Bt,{className:"w-4 h-4"})}),r.jsx("span",{className:"text-sm font-medium text-gray-300",children:" "})]}),r.jsx("button",{onClick:()=>v(I),className:`w-10 h-5 rounded-full relative transition-colors duration-300 ${I.hasFreeDelivery?"bg-green-500":"bg-gray-600"}`,children:r.jsx("div",{className:`w-3 h-3 bg-white rounded-full absolute top-1 transition-all duration-300 ${I.hasFreeDelivery?"left-1":"left-6"}`})})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"p-1.5 rounded-lg bg-blue-500/20 text-blue-400",children:r.jsx(wt,{className:"w-4 h-4"})}),r.jsx("span",{className:"text-sm font-medium text-gray-300",children:" "})]}),r.jsx("span",{className:"text-xs text-gray-400 bg-gray-800 px-2 py-1 rounded",children:I.responseTime||" "})]})]}),r.jsx("div",{className:"pt-3 mt-auto",children:r.jsxs("button",{onClick:()=>x(I),className:"w-full bg-purple-600/10 hover:bg-purple-600/20 text-purple-400 font-bold py-2.5 rounded-xl border border-purple-500/20 transition-all flex items-center justify-center gap-2 active:scale-95",children:[r.jsx(Xr,{className:"w-4 h-4"}),r.jsx("span",{children:"   ()"})]})})]})]},I.id)}):r.jsxs("div",{className:"col-span-full py-12 text-center text-gray-500",children:[r.jsx(lr,{className:"w-16 h-16 mx-auto mb-4 opacity-20"}),r.jsx("p",{children:"    ."})]})}),l&&r.jsx(Rv,{user:l,onClose:()=>c(null),onSave:(I,N)=>{t(I,N),c(null)},isLastAdmin:!1}),d&&r.jsx(Dv,{user:d,onClose:()=>f(null),onApprove:()=>{},onDelete:()=>{}}),m&&r.jsx("div",{className:"fixed inset-0 z-[100] bg-black/90 backdrop-blur-sm flex justify-center items-end sm:items-center animate-fadeIn p-0 sm:p-4",onClick:()=>x(null),children:r.jsxs("div",{className:"bg-[#1a1a1a] w-full max-w-4xl h-[95vh] sm:h-[85vh] rounded-t-3xl sm:rounded-3xl border border-gray-700 shadow-2xl flex flex-col relative overflow-hidden",onClick:I=>I.stopPropagation(),children:[r.jsxs("div",{className:"flex-none p-4 border-b border-gray-700 bg-gray-900 flex justify-between items-center",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg text-purple-400",children:r.jsx(Xr,{className:"w-6 h-6"})}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-lg font-bold text-white",children:["  ",m.name]}),r.jsxs("p",{className:"text-xs text-gray-400",children:[" : ",((T=m.products)==null?void 0:T.length)||0]})]})]}),r.jsx("button",{onClick:()=>x(null),className:"text-gray-400 hover:text-white p-2 rounded-full hover:bg-gray-800 transition-colors",children:r.jsx(rt,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar bg-[#111]",children:r.jsx(G5,{merchant:m,onUpdateMerchant:(I,N)=>t(I,N)})})]})})]})},K5=({users:s,updateUser:e,onDeleteUser:t,passwordResetRequests:n,resolvePasswordResetRequest:a,setEditingUser:l,pendingOrders:c=[],onNavigateToOrders:d,unreadChats:f=[],onNavigateToSupport:m})=>{const[x,y]=j.useState(null),[w,v]=j.useState(null),T=s.filter(z=>z.status==="pending"&&z.role!=="admin"),I=j.useMemo(()=>s.filter(z=>z.role==="merchant"&&z.hasFreeDelivery),[s]);j.useEffect(()=>{const z=k=>{var M;(M=k.state)!=null&&M.modal||(y(null),v(null))};return window.addEventListener("popstate",z),()=>window.removeEventListener("popstate",z)},[]);const N=()=>{try{window.history.pushState({view:"notifications",modal:"userDetails"},"",window.location.pathname)}catch{}},P=()=>{var z;(z=window.history.state)!=null&&z.modal?window.history.back():(y(null),v(null))},U=z=>{switch(z){case"merchant":return"";case"driver":return"";default:return z}},V=z=>{const k=s.find(M=>M.phone===z);k&&(l(k),a(z))},q=()=>{w&&(t(w.id),P())};return T.length>0||n.length>0||c.length>0||f.length>0||I.length>0?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"space-y-8 max-w-5xl mx-auto px-2 animate-fadeIn pb-24",children:[r.jsxs("div",{className:"flex items-center gap-4 pb-4 border-b border-gray-700/50",children:[r.jsx("div",{className:"p-3.5 bg-gradient-to-br from-red-500 to-red-700 rounded-2xl shadow-lg shadow-red-900/20",children:r.jsx(an,{className:"w-7 h-7 text-white"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-black text-white tracking-wide",children:" "}),r.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"    "})]})]}),f.length>0&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("h2",{className:"text-lg font-bold text-green-400 flex items-center gap-2",children:[r.jsx("span",{className:"w-2.5 h-2.5 bg-green-400 rounded-full animate-pulse shadow-[0_0_10px_rgba(74,222,128,0.5)]"}),r.jsx(Dr,{className:"w-5 h-5"}),"  (",f.length,")"]}),m&&r.jsxs("button",{onClick:m,className:"text-xs font-bold text-green-500 hover:text-green-400 bg-green-500/10 hover:bg-green-500/20 px-3 py-1.5 rounded-full transition-colors flex items-center gap-1",children:[" ",r.jsx(Gs,{className:"w-3 h-3"})]})]}),r.jsx("div",{className:"grid gap-3",children:f.map(z=>r.jsxs("div",{onClick:m,className:"relative bg-[#1a1a1a] rounded-2xl p-4 shadow-lg border-r-4 border-r-green-500 border-y border-l border-gray-700 hover:border-gray-500 transition-all cursor-pointer group overflow-hidden",children:[r.jsx("div",{className:"absolute top-0 right-0 w-20 h-full bg-gradient-to-l from-green-500/10 to-transparent pointer-events-none"}),r.jsxs("div",{className:"flex items-start gap-4 relative z-10",children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border-2 border-gray-600 group-hover:border-green-500 transition-colors",children:r.jsx(pt,{className:"w-6 h-6 text-gray-400"})}),r.jsx("div",{className:"absolute -bottom-1 -right-1 bg-green-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full border border-[#1a1a1a]",children:z.unreadCount})]}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsx("h3",{className:"font-bold text-white text-base truncate",children:z.userName}),r.jsx("span",{className:"text-[10px] text-gray-500 font-mono bg-black/30 px-2 py-0.5 rounded",children:new Date(z.lastUpdated).toLocaleTimeString("ar-EG",{hour:"2-digit",minute:"2-digit"})})]}),r.jsx("div",{className:"mt-2 bg-[#252525] p-2 rounded-lg rounded-tr-none border border-gray-700 inline-block max-w-full",children:r.jsxs("p",{className:"text-gray-300 text-sm line-clamp-1 flex items-center gap-2",children:[r.jsx(kv,{className:"w-3 h-3 text-green-400 flex-shrink-0"}),z.lastMessage||"    "]})})]})]}),r.jsx("div",{className:"absolute bottom-3 left-3 opacity-0 group-hover:opacity-100 transition-opacity",children:r.jsx("button",{className:"bg-green-600 text-white p-1.5 rounded-full shadow-lg",children:r.jsx(Gs,{className:"w-4 h-4"})})})]},z.id))})]}),I.length>0&&r.jsxs("div",{className:"space-y-4 animate-fade-slide-up",children:[r.jsxs("h2",{className:"text-lg font-bold text-purple-400 flex items-center gap-2",children:[r.jsx("span",{className:"w-2.5 h-2.5 bg-purple-400 rounded-full animate-pulse shadow-[0_0_10px_rgba(192,132,252,0.5)]"}),r.jsx(Bt,{className:"w-5 h-5"}),"    (",I.length,")"]}),r.jsx("div",{className:"grid gap-3",children:I.map(z=>r.jsxs("div",{className:"relative bg-gradient-to-r from-[#2c1a36] to-[#1a1a1a] rounded-2xl p-0.5 shadow-lg group",children:[r.jsx("div",{className:"absolute top-0 right-0 w-1.5 h-full bg-purple-500 rounded-r-full"}),r.jsxs("div",{className:"bg-[#1a1a1a] rounded-[14px] p-4 flex flex-col sm:flex-row items-center justify-between gap-4 h-full",children:[r.jsxs("div",{className:"flex items-center gap-4 w-full",children:[r.jsx("div",{className:"w-14 h-14 rounded-xl bg-purple-500/10 flex items-center justify-center border border-purple-500/20 text-purple-400 shadow-inner",children:z.storeImage?r.jsx("img",{src:z.storeImage,className:"w-full h-full object-cover rounded-xl",alt:"Store"}):r.jsx(lr,{className:"w-7 h-7"})}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("h3",{className:"font-bold text-white text-lg",children:z.name}),r.jsx("span",{className:"bg-purple-600 text-white text-[9px] px-2 py-0.5 rounded font-bold",children:" "})]}),r.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["   ",r.jsx("span",{className:"text-white font-bold",children:" "})," ."]})]})]}),r.jsxs("div",{className:"flex gap-2 w-full sm:w-auto mt-2 sm:mt-0",children:[r.jsx("button",{onClick:()=>{N(),y(z)},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-xs font-bold transition-colors border border-gray-600",children:" "}),r.jsx("button",{onClick:()=>e(z.id,{hasFreeDelivery:!1}),className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-400 rounded-lg text-xs font-bold transition-colors border border-red-500/10",children:" "})]})]})]},z.id))})]}),c.length>0&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("h2",{className:"text-lg font-bold text-yellow-400 flex items-center gap-2",children:[r.jsx("span",{className:"w-2.5 h-2.5 bg-yellow-400 rounded-full animate-pulse shadow-[0_0_10px_rgba(250,204,21,0.5)]"}),r.jsx(Bt,{className:"w-5 h-5"}),"   (",c.length,")"]}),d&&r.jsxs("button",{onClick:d,className:"text-xs font-bold text-yellow-500 hover:text-yellow-400 bg-yellow-500/10 hover:bg-yellow-500/20 px-3 py-1.5 rounded-full transition-colors flex items-center gap-1",children:[" ",r.jsx(Gs,{className:"w-3 h-3"})]})]}),r.jsx("div",{className:"grid gap-3",children:c.map(z=>{const k=z.type==="shopping_order",M=(()=>{try{const E=new Date(z.createdAt);return isNaN(E.getTime())?"":E.toLocaleString("ar-EG",{hour:"numeric",minute:"numeric"})}catch{return""}})(),B=k?"bg-[#2a1b2e]":"bg-[#1a1a1a]",D=k?"border-purple-500/30":"border-yellow-500/20",S=k?"bg-purple-500/20":"bg-yellow-500/10",F=k?"shadow-purple-900/10":"shadow-yellow-900/10";return r.jsxs("div",{className:`group relative p-0.5 rounded-2xl shadow-lg hover:${F} transition-all duration-300 ${k?"bg-gradient-to-br from-purple-900/40 to-[#252525]":"bg-gradient-to-br from-[#1e1e1e] to-[#252525]"}`,children:[r.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${k?"from-purple-500/20":"from-yellow-500/20"} to-transparent opacity-0 group-hover:opacity-100 transition-opacity rounded-2xl pointer-events-none`}),r.jsxs("div",{className:`relative ${B} rounded-[14px] p-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 h-full border ${D}`,children:[r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center text-2xl shadow-inner border border-white/5 flex-shrink-0 ${S}`,children:k?r.jsx(sd,{className:"w-6 h-6 text-purple-400 animate-pulse"}):""}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx("span",{className:`font-bold text-lg ${k?"text-purple-300":"text-white"}`,children:k?"  ":z.merchantName}),r.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded font-mono tracking-wider border ${k?"bg-purple-500/10 text-purple-200 border-purple-500/20":"bg-yellow-500/10 text-yellow-200 border-yellow-500/20"}`,children:z.id})]}),r.jsxs("p",{className:"text-gray-400 text-sm mt-1 flex items-center gap-1.5 leading-tight",children:[r.jsx(jn,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),z.customer.address]}),k&&r.jsx("p",{className:"text-[10px] text-purple-400 mt-1 bg-purple-900/20 px-2 py-0.5 rounded inline-block",children:"    "})]})]}),r.jsxs("div",{className:"flex flex-row sm:flex-col items-center sm:items-end justify-between w-full sm:w-auto gap-3",children:[r.jsxs("div",{className:"text-xs font-bold text-gray-400 bg-black/40 px-3 py-1.5 rounded-lg flex items-center gap-1.5 border border-white/5",children:[r.jsx(wt,{className:"w-3.5 h-3.5"})," ",M]}),d&&r.jsx("button",{onClick:d,className:`${k?"bg-purple-600 hover:bg-purple-500 shadow-purple-500/20":"bg-yellow-500 hover:bg-yellow-400 shadow-yellow-500/20"} text-white text-xs font-bold px-5 py-2 rounded-lg shadow-lg transition-all active:scale-95 whitespace-nowrap`,children:" "})]})]})]},z.id)})})]}),T.length>0&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h2",{className:"text-lg font-bold text-blue-400 flex items-center gap-2",children:[r.jsx("span",{className:"w-2.5 h-2.5 bg-blue-400 rounded-full animate-pulse shadow-[0_0_10px_rgba(96,165,250,0.5)]"}),r.jsx(pt,{className:"w-5 h-5"}),"   (",T.length,")"]}),r.jsx("div",{className:"grid gap-3",children:T.map(z=>r.jsxs("div",{className:"relative overflow-hidden bg-[#1a1a1a] rounded-2xl border border-blue-500/20 p-0.5 group shadow-lg",children:[r.jsx("div",{className:"absolute top-0 right-0 w-1.5 h-full bg-blue-500 z-10"}),r.jsx("div",{className:"absolute inset-0 bg-blue-500/5 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"}),r.jsxs("div",{className:"bg-[#1e1e1e] rounded-xl p-4 flex flex-col sm:flex-row items-center justify-between gap-4 relative z-0",children:[r.jsxs("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"w-14 h-14 rounded-full bg-gray-800 flex items-center justify-center overflow-hidden border-2 border-blue-500/30 shadow-md",children:r.jsx(pt,{className:"w-6 h-6 text-blue-400"})}),r.jsx("div",{className:"absolute -bottom-1 -right-1 bg-blue-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-md shadow-sm border border-[#1e1e1e]",children:U(z.role)})]}),r.jsxs("div",{className:"text-right flex-1",children:[r.jsx("h3",{className:"font-bold text-white text-lg",children:z.name}),r.jsx("p",{className:"text-gray-400 font-mono text-sm tracking-wide bg-black/20 inline-block px-2 rounded mt-1",children:z.phone})]})]}),r.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[r.jsx("button",{onClick:()=>{N(),y(z)},className:"flex-1 sm:flex-none px-4 py-2.5 bg-gray-700 hover:bg-gray-600 text-white rounded-xl text-sm font-bold transition-colors border border-gray-600",children:""}),r.jsxs("button",{onClick:()=>e(z.id,{status:"active"}),className:"flex-1 sm:flex-none px-5 py-2.5 bg-green-600 hover:bg-green-500 text-white rounded-xl text-sm font-bold shadow-lg shadow-green-900/20 transition-all active:scale-95 flex items-center justify-center gap-1.5",children:[r.jsx(nt,{className:"w-4 h-4"})," "]}),r.jsx("button",{onClick:()=>{N(),v(z)},className:"px-3.5 py-2.5 bg-red-500/10 hover:bg-red-500/20 text-red-500 rounded-xl transition-colors border border-red-500/10",children:r.jsx(Pt,{className:"w-5 h-5"})})]})]})]},z.id))})]}),n.length>0&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h2",{className:"text-lg font-bold text-red-400 flex items-center gap-2",children:[r.jsx("span",{className:"w-2.5 h-2.5 bg-red-400 rounded-full animate-pulse shadow-[0_0_10px_rgba(248,113,113,0.5)]"}),r.jsx(cr,{className:"w-5 h-5"}),"    "]}),r.jsx("div",{className:"grid gap-3",children:n.map(z=>{const k=s.find(M=>M.phone===z.phone);return k?r.jsxs("div",{className:"bg-gradient-to-r from-red-900/20 to-[#1a1a1a] border border-red-500/30 p-4 rounded-2xl flex justify-between items-center shadow-sm",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"p-3 bg-red-500/10 rounded-full text-red-400 border border-red-500/20",children:r.jsx(cr,{className:"w-6 h-6"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-bold text-white text-lg",children:k.name}),r.jsx("p",{className:"text-xs text-red-300 font-mono mt-0.5",children:k.phone})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>V(z.phone),className:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg text-xs font-bold shadow-md shadow-red-900/20 transition-all active:scale-95",children:""}),r.jsx("button",{onClick:()=>a(z.phone),className:"p-2 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-lg transition-colors border border-gray-700",children:r.jsx(Pt,{className:"w-5 h-5"})})]})]},z.phone):null})})]})]}),x&&r.jsx(Dv,{user:x,onClose:P,onApprove:(z,k)=>{e(z,k),P()},onDelete:z=>{v(x)}}),w&&r.jsx(os,{title:"   ",message:`       "${w.name}"    .`,onClose:()=>v(null),onConfirm:q,confirmButtonText:"  ",confirmVariant:"danger",cancelButtonText:""})]}):r.jsxs("div",{className:"flex flex-col items-center justify-center text-center h-[calc(100vh-15rem)]",children:[r.jsx("div",{className:"w-24 h-24 bg-gray-800/50 rounded-full flex items-center justify-center mb-6 shadow-inner animate-pulse ring-1 ring-white/10",children:r.jsx(an,{className:"w-12 h-12 text-gray-600"})}),r.jsx("h3",{className:"text-2xl font-bold text-gray-300",children:"  !"}),r.jsx("p",{className:"text-gray-500 mt-2",children:"     ."})]})},XD=({driver:s,payments:e,orders:t,onBack:n,onDeletePayment:a,currentUser:l})=>{const c=v=>{const T=v.reconciledOrderIds.map(V=>t.find(q=>q.id===V)).filter(V=>!!V&&V.status!==ue.Cancelled),I=T.length,N=T.reduce((V,q)=>V+(q.deliveryFee||0),0);let P=0;s.commissionType==="fixed"?P=I*(s.commissionRate||0):P=N*((s.commissionRate||0)/100);const U=N-P;return{...v,verifiedCount:I,companyShare:P,driverShare:U,verifiedTotalCollected:N,verifiedAmount:v.amount,isValid:I>0}},d=j.useMemo(()=>e.filter(v=>v.driverId===s.id).map(c).filter(v=>v.isValid).sort((v,T)=>new Date(T.createdAt).getTime()-new Date(v.createdAt).getTime()),[e,s.id,t]),[f,m]=Ar.useState(!1),x=v=>{let T;return typeof v=="string"||typeof v=="number"?T=new Date(v):v!=null&&v.seconds?T=new Date(v.seconds*1e3):T=new Date(v),T.getHours()<6&&T.setDate(T.getDate()-1),T},[y,w]=Ar.useState(null);return r.jsxs("div",{className:"fixed inset-0 bg-[#0f172a] z-50 animate-fadeIn pb-safe flex flex-col",children:[" ",r.jsx("div",{className:"flex-1 overflow-y-auto pt-[160px] md:pt-[120px]",onScroll:v=>{const T=v.currentTarget.scrollTop;m(T>20)},children:r.jsxs("div",{className:"max-w-5xl mx-auto p-4 md:p-6 min-h-screen flex flex-col",children:[r.jsx("div",{className:"flex-1 bg-[#1e293b] rounded-xl shadow-2xl border border-blue-800/50 overflow-hidden flex flex-col relative z-0",children:d.length>0?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full text-right",children:[r.jsx("thead",{className:"bg-[#1e293b] border-b border-blue-800",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-4 text-xs font-bold text-blue-300 uppercase tracking-wider",children:" "}),r.jsx("th",{className:"px-6 py-4 text-xs font-bold text-blue-300 uppercase tracking-wider",children:""}),r.jsx("th",{className:"px-6 py-4 text-xs font-bold text-blue-300 uppercase tracking-wider",children:""}),r.jsx("th",{className:"px-6 py-4 text-xs font-bold text-green-400 uppercase tracking-wider",children:" "}),r.jsx("th",{className:"px-6 py-4 text-xs font-bold text-red-400 uppercase tracking-wider",children:" "}),r.jsx("th",{className:"px-6 py-4 text-xs font-bold text-white uppercase tracking-wider",children:" "}),(l==null?void 0:l.role)==="admin"&&r.jsx("th",{className:"px-6 py-4 text-xs font-bold text-red-400 uppercase tracking-wider",children:""})]})}),r.jsx("tbody",{className:"divide-y divide-blue-900/50",children:d.map(v=>r.jsxs("tr",{className:"hover:bg-blue-900/10 transition-colors",children:[r.jsxs("td",{className:"px-6 py-4 text-sm text-gray-400 font-mono",children:["#",v.id.slice(-6)]}),r.jsx("td",{className:"px-6 py-4 text-sm text-gray-300",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{children:x(v.createdAt).toLocaleDateString("ar-EG-u-nu-latn",{year:"numeric",month:"short",day:"numeric"})}),r.jsx("span",{className:"text-[10px] text-gray-500",children:new Date(v.createdAt).toLocaleTimeString("ar-EG-u-nu-latn",{hour:"2-digit",minute:"2-digit"})})]})}),r.jsx("td",{className:"px-6 py-4 text-sm text-gray-300 font-medium",children:v.verifiedCount}),r.jsx("td",{className:"px-6 py-4 text-sm text-green-400",children:v.driverShare.toLocaleString("en-US",{minimumFractionDigits:1})}),r.jsx("td",{className:"px-6 py-4 text-sm text-red-400",children:v.companyShare.toLocaleString("en-US",{minimumFractionDigits:1})}),r.jsxs("td",{className:"px-6 py-4 text-sm text-white font-bold",children:[v.amount.toLocaleString("en-US",{minimumFractionDigits:1})," ."]}),(l==null?void 0:l.role)==="admin"&&r.jsx("td",{className:"px-6 py-4",children:r.jsx("button",{onClick:()=>w(v.id),className:"p-2 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500 hover:text-white transition-colors",children:r.jsx(rt,{className:"w-4 h-4"})})})]},v.id))})]})}),r.jsx("div",{className:"md:hidden divide-y divide-blue-900/50",children:d.map(v=>r.jsxs("div",{className:"bg-[#1e293b] rounded-xl shadow-lg border-r-4 border-green-500 overflow-hidden mb-4",children:[r.jsxs("div",{className:"p-4 border-b border-gray-700/50 flex justify-between items-start bg-gray-900/30",children:[r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"font-mono text-lg font-black text-green-400 tracking-tighter",children:["#",v.id.slice(-6)]}),r.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 rounded text-[10px] font-bold bg-green-500/20 text-green-400 border border-green-500/20",children:[r.jsx(nt,{className:"w-3 h-3"})," "]})]}),r.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[r.jsx("span",{className:"text-[10px] text-gray-400",children:x(v.createdAt).toLocaleDateString("ar-EG-u-nu-latn")}),r.jsx("span",{className:"text-[10px] text-gray-500 font-mono",children:new Date(v.createdAt).toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric",hour12:!0})})]})]}),(l==null?void 0:l.role)==="admin"&&r.jsx("button",{onClick:()=>w(v.id),className:"p-2 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500 hover:text-white transition-colors",children:r.jsx(rt,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"p-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900/50 rounded-lg border border-gray-700/50",children:[r.jsx("span",{className:"text-xs text-gray-400",children:" "}),r.jsxs("span",{className:"text-sm font-bold text-white",children:[v.verifiedCount," "]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"p-2 bg-green-500/5 rounded-lg border border-green-500/10",children:[r.jsx("p",{className:"text-[9px] text-green-500/70 mb-1",children:" "}),r.jsx("p",{className:"text-sm font-black text-green-400",children:v.driverShare.toLocaleString("en-US",{maximumFractionDigits:1})})]}),r.jsxs("div",{className:"p-2 bg-red-500/5 rounded-lg border border-red-500/10",children:[r.jsx("p",{className:"text-[9px] text-red-500/70 mb-1",children:" "}),r.jsx("p",{className:"text-sm font-black text-red-400",children:v.companyShare.toLocaleString("en-US",{maximumFractionDigits:1})})]})]})]}),r.jsxs("div",{className:"bg-gray-900/80 p-3 border-t border-gray-700/50 flex justify-between items-center",children:[r.jsx("span",{className:"text-xs text-gray-400",children:" "}),r.jsxs("span",{className:"text-lg font-black text-white",children:[v.amount.toLocaleString("en-US")," ",r.jsx("span",{className:"text-[10px] font-normal text-gray-500",children:"."})]})]})]},v.id))})]}):r.jsxs("div",{className:"flex flex-col items-center justify-center h-full min-h-[400px] text-gray-400 p-6 text-center",children:[r.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4",children:r.jsx(U5,{className:"w-10 h-10 text-gray-600"})}),r.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"  "}),r.jsx("p",{className:"text-sm text-gray-500 max-w-xs mx-auto",children:"               ."})]})}),r.jsxs("div",{className:"mt-6 flex items-start gap-3 bg-blue-900/20 p-4 rounded-lg border border-blue-500/10",children:[r.jsx(PD,{className:"w-5 h-5 text-blue-400 shrink-0 mt-0.5"}),r.jsx("p",{className:"text-xs md:text-sm text-blue-300 leading-relaxed",children:'      .          .    "" ( 6 ).'})]})]})}),r.jsx("div",{className:`
                fixed top-0 left-0 right-0 z-20 pt-safe
                bg-[#0f172a]/95 backdrop-blur-md border-b border-blue-800/50 
                transition-all duration-300 ease-in-out
                ${f?"pb-2 shadow-lg":"pb-4 md:pb-6 shadow-none"}
            `,children:r.jsx("div",{className:"max-w-5xl mx-auto px-4 md:px-6 w-full pt-4 md:pt-6",children:r.jsxs("div",{className:"flex flex-row items-center justify-between gap-4",children:[r.jsxs("div",{className:"flex items-center gap-3 md:gap-4 overflow-hidden",children:[r.jsx("button",{onClick:n,className:`
                                    rounded-full bg-blue-900/50 hover:bg-blue-800 text-blue-200 transition-all border border-blue-700/50 flex-shrink-0
                                    ${f?"p-2":"p-3"}
                                `,children:r.jsx(MD,{className:`${f?"w-5 h-5":"w-6 h-6"}`})}),r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsx("h2",{className:`font-bold text-white leading-tight truncate transition-all ${f?"text-lg":"text-xl md:text-2xl"}`,children:" "}),r.jsx("p",{className:`text-blue-400 truncate transition-all ${f?"text-[10px]":"text-xs md:text-sm mt-1"}`,children:s.name})]})]}),r.jsxs("div",{className:`
                            bg-blue-900/30 rounded-xl border border-blue-500/20 text-center flex-shrink-0 flex items-center gap-2 transition-all
                            ${f?"px-3 py-1.5":"px-4 py-3"}
                        `,children:[r.jsx("span",{className:`text-blue-300 block ${f?"text-[10px]":"text-xs md:text-sm"}`,children:" "}),r.jsx("p",{className:`font-bold text-white ${f?"text-sm":"text-lg md:text-xl"}`,children:d.length})]})]})})}),y&&r.jsx("div",{className:"fixed inset-0 z-[60] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>w(null),children:r.jsx("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-red-500/30 shadow-2xl p-6",onClick:v=>v.stopPropagation(),children:r.jsxs("div",{className:"flex flex-col items-center text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mb-4",children:r.jsx(rt,{className:"w-8 h-8 text-red-500"})}),r.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:" "}),r.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"                  ."}),r.jsxs("div",{className:"flex gap-3 w-full",children:[r.jsx("button",{className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 rounded-xl transition-all",onClick:()=>w(null),children:""}),r.jsx("button",{className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-3 rounded-xl transition-all",onClick:()=>{a&&y&&a(y),w(null)},children:" "})]})]})})})]})},Ey=({label:s,value:e,currency:t=".",colorClass:n="text-white"})=>r.jsxs("div",{className:"flex justify-between items-baseline bg-gray-700/50 p-3 rounded-lg border border-gray-600/50",children:[r.jsx("span",{className:"text-sm font-medium text-gray-400",children:s}),r.jsxs("span",{className:`text-lg font-bold ${n}`,children:[e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})," ",t]})]}),ZD=({status:s,mode:e,onChange:t})=>{if(e==="always_open")return r.jsxs("div",{className:"flex items-center gap-2 bg-blue-500/10 border border-blue-500/20 px-3 py-2 rounded-lg w-full justify-center",children:[r.jsx(wt,{className:"w-4 h-4 text-blue-400"}),r.jsx("span",{className:"text-xs font-bold text-blue-300",children:"  "})]});const n=s==="active";return r.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-xs text-gray-400 font-medium",children:" "}),r.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded ${n?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:n?" ":""})]}),r.jsx("button",{onClick:t,className:`
                    relative group w-full py-2 px-1 rounded-lg flex items-center justify-center gap-2 transition-all duration-300 border
                    ${n?"bg-green-600 hover:bg-green-700 border-green-500 text-white shadow-lg shadow-green-900/20":"bg-[#1a1a1a] hover:bg-[#222] border-gray-600 text-gray-400 hover:text-white"}
                `,children:n?r.jsxs(r.Fragment,{children:[r.jsx(nt,{className:"w-4 h-4"}),r.jsx("span",{className:"text-xs font-bold",children:" "})]}):r.jsxs(r.Fragment,{children:[r.jsx(rt,{className:"w-4 h-4"}),r.jsx("span",{className:"text-xs font-bold",children:"  -  "})]})})]})},Q5=({orders:s,users:e,payments:t,updateUser:n,handleDriverPayment:a,onDeletePayment:l,currentUser:c})=>{const[d,f]=j.useState(null),[m,x]=j.useState(null),[y,w]=j.useState(!1),[v,T]=j.useState(!1),I=e.filter(V=>V.role==="driver"),N=V=>{try{window.history.pushState({view:"wallet",modal:V},"",window.location.pathname)}catch{}},P=()=>{var V;f(null),x(null),(V=window.history.state)!=null&&V.modal&&window.history.back()};if(j.useEffect(()=>{const V=q=>{var W;(W=q.state)!=null&&W.modal||(f(null),x(null))};return window.addEventListener("popstate",V),()=>window.removeEventListener("popstate",V)},[]),I.length===0)return r.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 h-[calc(100vh-15rem)]",children:[r.jsx(L5,{className:"w-16 h-16 text-gray-600 mb-4"}),r.jsx("h3",{className:"text-xl font-semibold",children:"   "}),r.jsx("p",{className:"text-gray-400",children:"    ."})]});const U=()=>{var V;if(m){const q=m.driver.id;x(null),((V=window.history.state)==null?void 0:V.modal)==="pay"&&window.history.back(),a(q),w(!0),setTimeout(()=>w(!1),2e3)}};return Ht(()=>v?(T(!1),f(null),!0):m?(P(),!0):y?(w(!1),!0):!1,[v,m,y]),r.jsxs(r.Fragment,{children:[v&&d&&r.jsx("div",{className:"fixed inset-0 z-[100] bg-gray-900",children:r.jsx(XD,{driver:d,payments:t,orders:s,onBack:()=>{T(!1),f(null)},onDeletePayment:l,currentUser:c})}),r.jsx("div",{className:`grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 pb-32 ${v?"hidden":""}`,children:I.map(V=>{const q=s.filter(Y=>Y.driverId===V.id&&Y.status===ue.Delivered&&Y.status!==ue.Cancelled&&!Y.reconciled),W=q.reduce((Y,X)=>Y+(X.deliveryFee||0),0),z=V.commissionRate||0;let k=0;V.commissionType==="fixed"?k=q.length*z:k=W*(z/100);const M=W-k,B=V.commissionType==="fixed"?`${z} ./`:`${z}%`,D=()=>{const Y=V.dailyLogStatus==="active"?"closed":"active",X={dailyLogStatus:Y};Y==="active"&&(X.dailyLogStartedAt=new Date),n(V.id,X)},F=V.dailyLogStatus==="active"||V.dailyLogMode==="always_open"?"border-l-4 border-l-green-500":"border-l-4 border-l-red-500",E=s.some(Y=>String(Y.driverId)===String(V.id)&&Y.status!==ue.Delivered&&Y.status!==ue.Cancelled);return r.jsxs("div",{className:`bg-gray-800 rounded-xl shadow-lg flex flex-col overflow-hidden transition-all duration-300 ${F}`,children:[r.jsx("div",{className:"p-5 pb-0 flex justify-between items-start",children:r.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[r.jsx("div",{className:"w-12 h-12 bg-gray-700 rounded-full flex items-center justify-center overflow-hidden border border-gray-600",children:V.storeImage?r.jsx("img",{src:V.storeImage,className:"w-full h-full object-cover",alt:"Avatar"}):r.jsx(pt,{className:"w-6 h-6 text-gray-300"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-bold text-lg text-white",children:V.name}),r.jsx("p",{className:"text-xs text-gray-500 font-mono",children:V.id})]})]})}),r.jsxs("div",{className:"p-5 space-y-4",children:[r.jsx("div",{className:"bg-black/20 p-3 rounded-xl border border-white/5",children:r.jsx(ZD,{status:V.dailyLogStatus||"closed",mode:V.dailyLogMode||"12_hour",onChange:D})}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between items-center mb-1",children:[r.jsx("h4",{className:"text-xs font-bold text-gray-400",children:"  ( )"}),r.jsxs("span",{className:"text-[10px] bg-gray-700 px-2 py-0.5 rounded text-gray-300",children:[q.length," "]})]}),r.jsx(Ey,{label:" ",value:W,colorClass:"text-blue-400"}),r.jsx(Ey,{label:`  (${B})`,value:k,colorClass:"text-red-400"}),r.jsx(Ey,{label:" ",value:M,colorClass:"text-green-400"})]})]}),r.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 border-t border-gray-700",children:[r.jsxs("button",{onClick:()=>{f(V),T(!0)},className:"flex items-center text-xs font-bold text-gray-400 hover:text-white transition-colors",children:[r.jsx(U5,{className:"w-4 h-4 ml-1.5"})," "]}),E?r.jsxs("div",{className:"flex items-center text-xs bg-red-900/40 text-red-400 font-bold px-4 py-2.5 rounded-lg border border-red-900/50 cursor-not-allowed w-auto text-center",title:"      ",children:[r.jsx(wt,{className:"w-4 h-4 ml-2 animate-pulse"}),"  "]}):r.jsx("button",{onClick:()=>{N("pay"),x({driver:V,amount:k})},disabled:q.length===0,className:"flex items-center text-xs bg-green-600 text-white hover:bg-green-700 font-bold px-4 py-2.5 rounded-lg transition-colors disabled:bg-gray-700 disabled:text-gray-500 disabled:cursor-not-allowed shadow-md",children:" "})]})]},V.id)})}),m&&r.jsx(os,{title:"  ",message:`    ${m.amount.toLocaleString("en-US",{minimumFractionDigits:2})} .   ${m.driver.name}       .`,onClose:P,onConfirm:U,confirmButtonText:" ",confirmVariant:"success"}),y&&r.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-6 bg-black/60 backdrop-blur-[2px] animate-fadeIn",style:{touchAction:"none"},onClick:()=>w(!1),children:r.jsxs("div",{className:"w-full max-w-xs bg-[#1e293b] rounded-2xl border border-gray-700 shadow-2xl p-6 text-center transform scale-100 animate-pop-in relative overflow-hidden",onClick:V=>V.stopPropagation(),children:[r.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-green-500 via-emerald-500 to-green-500"}),r.jsx("div",{className:"flex justify-center mb-4",children:r.jsx("div",{className:"p-3 rounded-full bg-[#0f172a] border border-gray-700 shadow-inner",children:r.jsx(nt,{className:"w-10 h-10 text-green-500 animate-pulse"})})}),r.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),r.jsx("p",{className:"text-gray-400 text-sm",children:"     ."})]})})]})},Y5=({users:s,onSendMessage:e,messages:t=[],deleteMessage:n})=>{const[a,l]=j.useState("driver"),[c,d]=j.useState([]),[f,m]=j.useState(""),[x,y]=j.useState(""),[w,v]=j.useState(null),[T,I]=j.useState(null),[N,P]=j.useState(""),[U,V]=j.useState(null),q=R=>{try{window.history.pushState({view:"messages",modal:R},"",window.location.pathname)}catch{}},W=()=>{var R;(R=window.history.state)!=null&&R.modal?window.history.back():V(null)};j.useEffect(()=>{const R=J=>{var O;(O=J.state)!=null&&O.modal||V(null)};return window.addEventListener("popstate",R),()=>window.removeEventListener("popstate",R)},[]);const z=j.useMemo(()=>s.filter(R=>R.role===a),[s,a]),k=j.useMemo(()=>f?z.filter(R=>R.name.toLowerCase().includes(f.toLowerCase())||R.phone&&R.phone.includes(f)):z,[z,f]);j.useEffect(()=>{d([]),m("")},[a]);const M=()=>{c.length===k.length&&k.length>0?d([]):d(k.map(R=>R.id))},B=R=>{d(J=>J.includes(R)?J.filter(O=>O!==R):[...J,R])},D=j.useMemo(()=>[...t].sort((R,J)=>new Date(J.createdAt).getTime()-new Date(R.createdAt).getTime()),[t]),S=R=>{var O;const J=(O=R.target.files)==null?void 0:O[0];if(J){const K=new FileReader;K.onloadend=()=>{v(K.result),I(URL.createObjectURL(J))},K.readAsDataURL(J)}else v(null),I(null)},F=()=>{if(c.length===0){P("     .");return}if(!x.trim()){P("   .");return}e({text:x,image:w||void 0,targetRole:a,targetIds:c}),y(""),v(null),I(null),d([]),P("")},E=()=>{U&&n&&n(U),W()},Y=R=>{if(R.targetId==="all"||R.targetId==="multiple")return R.targetRole==="driver"?"  ":R.targetRole==="merchant"?"  ":"  ";const J=s.find(O=>O.id===R.targetId);return J?` ${J.name}`:"  "},X=({checked:R})=>R?r.jsx("div",{className:"bg-red-600 text-white rounded p-0.5",children:r.jsx(RD,{className:"w-5 h-5"})}):r.jsx("div",{className:"text-gray-500",children:r.jsx(DD,{className:"w-5 h-5"})});return r.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 pb-32",children:[r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[r.jsx("div",{className:"lg:col-span-1 space-y-6",children:r.jsxs("div",{className:"bg-gray-800 rounded-2xl shadow-xl border border-gray-700 overflow-hidden sticky top-6",children:[r.jsxs("div",{className:"p-5 border-b border-gray-700 bg-gray-900/50 flex items-center gap-3",children:[r.jsx("div",{className:"p-2 bg-red-600 rounded-lg shadow-lg shadow-red-900/20",children:r.jsx(kr,{className:"w-5 h-5 text-white"})}),r.jsx("h2",{className:"text-lg font-bold text-white",children:" "})]}),r.jsxs("div",{className:"p-5 space-y-5",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:" "}),r.jsx("div",{className:"grid grid-cols-3 gap-2 bg-gray-900 p-1.5 rounded-xl border border-gray-700",children:[{id:"driver",label:""},{id:"merchant",label:""},{id:"customer",label:""}].map(R=>r.jsx("button",{onClick:()=>l(R.id),className:`py-2 text-xs font-bold rounded-lg transition-all duration-200 ${a===R.id?"bg-gray-700 text-white shadow-md":"text-gray-500 hover:text-gray-300 hover:bg-gray-800"}`,children:R.label},R.id))})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:["  (",c.length,")"]}),r.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-xl overflow-hidden",children:[r.jsxs("div",{className:"p-2 border-b border-gray-700 flex items-center gap-2",children:[r.jsxs("button",{onClick:M,className:"p-2 hover:bg-gray-800 rounded-lg transition-colors flex items-center gap-2 text-xs font-bold text-gray-300",children:[r.jsx(X,{checked:c.length>0&&c.length===k.length}),""]}),r.jsx("div",{className:"h-6 w-px bg-gray-700 mx-1"}),r.jsxs("div",{className:"flex-1 relative",children:[r.jsx(Kn,{className:"absolute right-2 top-2 w-4 h-4 text-gray-500"}),r.jsx("input",{type:"text",placeholder:"...",value:f,onChange:R=>m(R.target.value),className:"w-full bg-transparent border-none text-white text-xs py-2 pr-8 pl-2 focus:ring-0 placeholder-gray-600"})]})]}),r.jsx("div",{className:"max-h-48 overflow-y-auto p-1 custom-scrollbar",children:k.length>0?k.map(R=>r.jsx("div",{onClick:()=>B(R.id),className:`flex items-center justify-between p-2 rounded-lg cursor-pointer transition-colors ${c.includes(R.id)?"bg-red-900/20":"hover:bg-gray-800"}`,children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(X,{checked:c.includes(R.id)}),r.jsxs("div",{children:[r.jsx("p",{className:`text-xs font-bold ${c.includes(R.id)?"text-red-200":"text-gray-300"}`,children:R.name}),r.jsx("p",{className:"text-[10px] text-gray-500 font-mono",children:R.phone})]})]})},R.id)):r.jsx("p",{className:"text-center text-gray-500 py-4 text-xs",children:"  "})})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:" "}),r.jsx("textarea",{rows:4,value:x,onChange:R=>y(R.target.value),className:"w-full px-4 py-3 bg-gray-900 border border-gray-700 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none text-white placeholder:text-gray-600 text-sm resize-none transition-all",placeholder:"  ..."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:"  ()"}),r.jsxs("label",{className:"flex items-center justify-center w-full px-4 py-3 bg-gray-900 border border-dashed border-gray-600 rounded-xl cursor-pointer hover:border-red-500 hover:bg-gray-900/80 transition-all group",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ur,{className:"w-5 h-5 text-gray-500 group-hover:text-red-500 transition-colors"}),r.jsx("span",{className:"text-xs text-gray-500 group-hover:text-gray-300",children:"  "})]}),r.jsx("input",{type:"file",accept:"image/*",onChange:S,className:"hidden"})]})]}),T&&r.jsxs("div",{className:"relative rounded-xl overflow-hidden border border-gray-700 group",children:[r.jsx("img",{src:T,alt:"Preview",className:"w-full h-40 object-cover"}),r.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:r.jsx("button",{onClick:()=>{v(null),I(null)},className:"bg-red-600 text-white p-2 rounded-full shadow-lg hover:scale-110 transition-transform",children:r.jsx(rt,{className:"w-4 h-4"})})})]}),N&&r.jsx("p",{className:"text-red-400 text-xs font-bold text-center bg-red-900/10 p-2 rounded-lg border border-red-500/20",children:N}),r.jsxs("button",{onClick:F,className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-bold py-3.5 rounded-xl transition-all shadow-lg shadow-red-900/20 active:scale-95 flex items-center justify-center gap-2",children:[r.jsxs("span",{children:[" (",c.length,")"]}),r.jsx(kr,{className:"w-4 h-4"})]})]})]})}),r.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[r.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2 pb-2 border-b border-gray-700",children:[r.jsx(wt,{className:"w-6 h-6 text-gray-500"}),"  ",r.jsx("span",{className:"text-xs bg-gray-800 text-gray-400 px-2 py-0.5 rounded-full border border-gray-700",children:D.length})]}),r.jsx("div",{className:"space-y-4",children:D.length===0?r.jsxs("div",{className:"text-center py-16 bg-gray-800/30 rounded-2xl border border-dashed border-gray-700",children:[r.jsx(kr,{className:"w-16 h-16 mx-auto mb-4 text-gray-600 opacity-50"}),r.jsx("p",{className:"text-gray-500 font-medium",children:"   ."})]}):D.map(R=>{var J,O;return r.jsxs("div",{className:"bg-gray-800 p-5 rounded-2xl border border-gray-700 shadow-sm hover:border-gray-600 transition-all group relative overflow-hidden",children:[r.jsxs("div",{className:"flex justify-between items-start mb-3 relative z-10",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`p-2.5 rounded-full ${R.targetRole==="driver"?"bg-blue-900/20 text-blue-400":R.targetRole==="merchant"?"bg-purple-900/20 text-purple-400":"bg-green-900/20 text-green-400"}`,children:r.jsx(pt,{className:"w-5 h-5"})}),r.jsxs("div",{children:[r.jsxs("p",{className:"text-sm font-bold text-white flex items-center gap-2",children:[Y(R),r.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded border ${R.targetRole==="driver"?"bg-blue-500/10 border-blue-500/20 text-blue-300":R.targetRole==="merchant"?"bg-purple-500/10 border-purple-500/20 text-purple-300":"bg-green-500/10 border-green-500/20 text-green-300"}`,children:R.targetRole==="driver"?"":R.targetRole==="merchant"?"":""})]}),r.jsxs("p",{className:"text-xs text-gray-500 flex items-center mt-0.5",children:[r.jsx(wt,{className:"w-3 h-3 ml-1"}),new Date(R.createdAt).toLocaleString("ar-EG-u-nu-latn")]})]})]}),n&&r.jsx("button",{onClick:()=>{q("deleteMessage"),V(R.id)},className:"text-gray-500 hover:text-red-400 p-2 hover:bg-red-500/10 rounded-lg transition-colors opacity-0 group-hover:opacity-100",title:" ",children:r.jsx(Pt,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-4 border border-gray-700/50 relative z-10",children:[R.image&&r.jsx("div",{className:"mb-3",children:r.jsx("img",{src:R.image,alt:"",className:"h-32 w-auto rounded-lg border border-gray-700 object-cover hover:scale-105 transition-transform cursor-pointer"})}),r.jsx("p",{className:"text-sm text-gray-200 leading-relaxed whitespace-pre-wrap font-medium",children:R.text})]}),r.jsx("div",{className:"mt-3 flex justify-end relative z-10",children:r.jsxs("span",{className:`text-xs font-bold flex items-center gap-1 bg-black/20 px-2 py-1 rounded-md border border-white/5 ${(J=R.readBy)!=null&&J.length?"text-green-400":"text-gray-500"}`,children:[r.jsx(nt,{className:"w-3.5 h-3.5"}),(O=R.readBy)!=null&&O.length?`   ${R.readBy.length}`:"   "]})})]},R.id)})})]})]}),U&&r.jsx(os,{title:" ",message:"        ",onClose:W,onConfirm:E,confirmButtonText:" ",confirmVariant:"danger"})]})},Iy=({title:s,value:e,subValue:t,icon:n,color:a,trend:l,trendValue:c})=>r.jsxs("div",{className:"bg-gray-800 border border-gray-700 p-5 rounded-2xl shadow-lg relative overflow-hidden group",children:[r.jsx("div",{className:`absolute top-0 right-0 w-24 h-24 ${a} opacity-5 blur-3xl -mr-10 -mt-10 group-hover:opacity-10 transition-opacity`}),r.jsxs("div",{className:"flex justify-between items-start relative z-10",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500 text-xs font-bold uppercase tracking-wider mb-1",children:s}),r.jsx("h3",{className:"text-2xl font-black text-white",children:e}),t&&r.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:t})]}),r.jsx("div",{className:`p-3 rounded-xl bg-gray-900/50 border border-gray-700 ${a.replace("bg-","text-")}`,children:n})]}),l&&r.jsxs("div",{className:"mt-4 flex items-center gap-1 relative z-10",children:[l==="up"?r.jsx($5,{className:"w-3 h-3 text-green-500"}):r.jsx(OD,{className:"w-3 h-3 text-red-500"}),r.jsx("span",{className:`text-[10px] font-bold ${l==="up"?"text-green-500":"text-red-500"}`,children:c}),r.jsx("span",{className:"text-[10px] text-gray-600",children:" "})]})]}),eO=({isOpen:s,onClose:e,type:t,users:n,onGenerate:a})=>{const[l,c]=j.useState(""),[d,f]=j.useState("all"),[m,x]=j.useState(""),[y,w]=j.useState(""),[v,T]=j.useState("");Ht(()=>s?(e(),!0):!1,[s]);const I=j.useMemo(()=>n.filter(P=>{var U,V;return(P==null?void 0:P.role)===t&&(((U=P==null?void 0:P.name)==null?void 0:U.toLowerCase().includes(v.toLowerCase()))||((V=P==null?void 0:P.phone)==null?void 0:V.includes(v)))}),[n,t,v]);if(!s)return null;const N=()=>{l&&(a(l,{type:d,start:d==="custom"?m:void 0,end:d==="custom"?y:void 0}),e())};return r.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-2xl border border-gray-700 shadow-2xl overflow-hidden animate-pop-in flex flex-col max-h-[85vh]",onClick:P=>P.stopPropagation(),children:[r.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[r.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[t==="driver"?r.jsx(Bt,{className:"w-5 h-5 text-blue-400"}):r.jsx(lr,{className:"w-5 h-5 text-purple-400"}),t==="driver"?"  ":"  "]}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white p-1 rounded-full hover:bg-gray-800",children:r.jsx(rt,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto custom-scrollbar",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs("label",{className:"text-xs font-bold text-gray-400 block",children:[" ",t==="driver"?"":""]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"text",placeholder:"   ...",value:v,onChange:P=>T(P.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-3 px-4 pl-10 text-white text-sm focus:border-blue-500 outline-none"}),r.jsx(Kn,{className:"absolute left-3 top-3.5 w-4 h-4 text-gray-500"})]}),r.jsx("div",{className:"max-h-40 overflow-y-auto bg-[#0f172a] border border-gray-600 rounded-xl custom-scrollbar",children:I.length>0?I.map(P=>r.jsxs("button",{onClick:()=>c(P.id),className:`w-full flex items-center justify-between p-3 text-right hover:bg-gray-800 border-b border-gray-700/50 last:border-0 transition-colors ${l===P.id?"bg-blue-900/20 text-blue-400":"text-gray-300"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden",children:P.storeImage?r.jsx("img",{src:P.storeImage,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-4 h-4"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-bold",children:P.name}),r.jsx("p",{className:"text-[10px] opacity-70 font-mono",children:P.phone})]})]}),l===P.id&&r.jsx(nt,{className:"w-4 h-4"})]},P.id)):r.jsx("p",{className:"p-4 text-center text-xs text-gray-500",children:"  "})})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("label",{className:"text-xs font-bold text-gray-400 block",children:" "}),r.jsxs("div",{className:"flex bg-[#0f172a] p-1 rounded-xl border border-gray-600",children:[r.jsx("button",{onClick:()=>f("all"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${d==="all"?"bg-blue-600 text-white shadow-md":"text-gray-400 hover:text-white"}`,children:"  "}),r.jsx("button",{onClick:()=>f("custom"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${d==="custom"?"bg-blue-600 text-white shadow-md":"text-gray-400 hover:text-white"}`,children:" "})]}),d==="custom"&&r.jsxs("div",{className:"grid grid-cols-2 gap-3 animate-fadeIn",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-[10px] text-gray-500 mb-1 block",children:""}),r.jsx("input",{type:"date",value:m,onChange:P=>x(P.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-lg py-2 px-3 text-white text-xs outline-none focus:border-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-[10px] text-gray-500 mb-1 block",children:""}),r.jsx("input",{type:"date",value:y,onChange:P=>w(P.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-lg py-2 px-3 text-white text-xs outline-none focus:border-blue-500"})]})]})]})]}),r.jsx("div",{className:"p-5 border-t border-gray-700 bg-[#151e2d]",children:r.jsxs("button",{onClick:N,disabled:!l||d==="custom"&&(!m||!y),className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:text-gray-500 text-white font-bold py-3.5 rounded-xl shadow-lg transition-all active:scale-95 flex items-center justify-center gap-2",children:[r.jsx(Wn,{className:"w-5 h-5"})," "]})})]})})},tO=({isOpen:s,onClose:e,reportData:t})=>{if(Ht(()=>s?(e(),!0):!1,[s]),!s||!t)return null;const{user:n,orders:a,summary:l,dateLabel:c}=t,d=(n==null?void 0:n.role)==="driver",f=m=>{if(!m)return"---";try{let x;return m.seconds?x=new Date(m.seconds*1e3):x=new Date(m),isNaN(x.getTime())?"---":x.toLocaleString("ar-EG-u-nu-latn",{month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0})}catch{return"---"}};return r.jsx("div",{className:"fixed inset-0 z-[100] bg-black/90 backdrop-blur-sm flex items-center justify-center p-0 sm:p-4 animate-fadeIn",onClick:e,children:r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-2xl h-full sm:h-auto sm:max-h-[90vh] sm:rounded-2xl border-x-0 sm:border border-gray-700 shadow-2xl overflow-hidden animate-slide-up flex flex-col",onClick:m=>m.stopPropagation(),children:[r.jsxs("div",{className:"p-5 border-b border-gray-700 bg-[#151e2d] flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"text-xl font-black text-white flex items-center gap-2",children:[n.name,r.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded border ${d?"bg-blue-500/10 text-blue-400 border-blue-500/20":"bg-purple-500/10 text-purple-400 border-purple-500/20"}`,children:d?"":""})]}),r.jsxs("p",{className:"text-xs text-gray-400 mt-1 flex items-center gap-1",children:[r.jsx(il,{className:"w-3 h-3"}),c]})]}),r.jsx("button",{onClick:e,className:"bg-gray-800 p-2 rounded-full text-gray-400 hover:text-white transition-colors",children:r.jsx(rt,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-5 space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[r.jsxs("div",{className:"bg-gray-800 p-3 rounded-xl border border-gray-700 text-center",children:[r.jsx("p",{className:"text-[10px] text-gray-500 font-bold mb-1",children:" "}),r.jsx("p",{className:"text-xl font-black text-white",children:l.count})]}),r.jsxs("div",{className:"bg-gray-800 p-3 rounded-xl border border-gray-700 text-center",children:[r.jsx("p",{className:"text-[10px] text-gray-500 font-bold mb-1",children:" "}),r.jsxs("p",{className:"text-xl font-black text-green-400",children:[l.totalRevenue.toLocaleString("en-US")," ",r.jsx("span",{className:"text-[10px]",children:"."})]})]}),r.jsxs("div",{className:"bg-gray-800 p-3 rounded-xl border border-gray-700 text-center",children:[r.jsx("p",{className:"text-[10px] text-gray-500 font-bold mb-1",children:" "}),r.jsxs("p",{className:"text-xl font-black text-blue-400",children:[l.totalDelivery.toLocaleString("en-US")," ",r.jsx("span",{className:"text-[10px]",children:"."})]})]}),r.jsxs("div",{className:"bg-gray-800 p-3 rounded-xl border border-gray-700 text-center",children:[r.jsx("p",{className:"text-[10px] text-gray-500 font-bold mb-1",children:d?" ":" "}),r.jsxs("p",{className:`text-xl font-black ${d?"text-yellow-400":"text-red-400"}`,children:[d?l.driverEarnings.toLocaleString("en-US"):l.appCommission.toLocaleString("en-US")," ",r.jsx("span",{className:"text-[10px]",children:"."})]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("h4",{className:"text-sm font-bold text-white flex items-center gap-2",children:[r.jsx(Wn,{className:"w-4 h-4 text-gray-400"})," "]}),a.length>0?a.map(m=>{var x,y,w;return r.jsxs("div",{className:"bg-[#252525] p-4 rounded-2xl border border-white/5 flex flex-col gap-3 shadow-md hover:border-white/10 transition-all",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"font-mono text-sm text-blue-400 font-black bg-blue-900/10 px-2 py-0.5 rounded border border-blue-500/20",children:["#",m.id]}),r.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full font-bold ${m.status===ue.Delivered?"bg-green-500/10 text-green-400":m.status===ue.Cancelled?"bg-red-500/10 text-red-400":"bg-yellow-500/10 text-yellow-400"}`,children:m.status})]}),r.jsxs("div",{className:"flex flex-col items-end",children:[r.jsx("p",{className:"text-xs text-gray-400",children:" "}),r.jsxs("p",{className:"text-sm font-bold text-white",children:[(x=m.totalPrice)==null?void 0:x.toLocaleString("en-US")," ."]})]})]}),r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx(jn,{className:"w-4 h-4 text-gray-500 mt-0.5 flex-shrink-0"}),r.jsx("p",{className:"text-xs text-gray-300 leading-relaxed",children:d?` : ${m.merchantName}`:` : ${(y=m.customer)==null?void 0:y.address}`})]}),r.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-gray-700 mt-1 bg-black/20 -mx-4 -mb-4 px-4 py-3 rounded-b-2xl",children:[r.jsxs("div",{className:"flex items-center gap-1.5 text-gray-400 text-[10px]",children:[r.jsx(wt,{className:"w-3 h-3"}),r.jsx("span",{className:"dir-ltr",children:f(m.deliveredAt||m.createdAt)})]}),d&&r.jsxs("div",{className:"flex items-center gap-2 bg-green-900/20 px-3 py-1 rounded-lg border border-green-500/20",children:[r.jsx("span",{className:"text-[10px] text-green-300 font-bold",children:" :"}),r.jsxs("span",{className:"text-sm font-black text-green-400",children:[((w=m.deliveryFee)==null?void 0:w.toLocaleString("en-US"))||0," ."]})]})]})]},m.id)}):r.jsx("div",{className:"text-center py-10 text-gray-500 bg-gray-800/30 rounded-xl border border-dashed border-gray-700",children:"     "})]})]})]})})},NS=s=>{const e=new Date(s);return e.getHours()<6&&e.setDate(e.getDate()-1),e.setHours(0,0,0,0),e},sO=({isOpen:s,onClose:e,orders:t,users:n})=>{const a=j.useMemo(()=>{if(!s)return null;const l=NS(new Date),c=t.filter(I=>{const N=I.createdAt.seconds?new Date(I.createdAt.seconds*1e3):new Date(I.createdAt);return NS(N).getTime()===l.getTime()}),d=c.filter(I=>I.status===ue.Delivered),f=c.filter(I=>I.status===ue.Cancelled),m=c.filter(I=>I.status===ue.Pending),x=d.reduce((I,N)=>I+(N.totalPrice||0),0),y=d.reduce((I,N)=>I+(N.deliveryFee||0),0);let w=0;const v={};d.forEach(I=>{const N=n.find(P=>(P==null?void 0:P.id)===I.driverId);N&&(N.commissionType==="fixed"?w+=N.commissionRate||0:w+=(I.deliveryFee||0)*((N.commissionRate||0)/100),v[N.id]||(v[N.id]={name:N.name,count:0,total:0}),v[N.id].count+=1,v[N.id].total+=I.deliveryFee||0)});const T=Object.values(v).sort((I,N)=>N.count-I.count).slice(0,5);return{date:l,count:c.length,deliveredCount:d.length,cancelledCount:f.length,pendingCount:m.length,totalRevenue:x,totalDeliveryFees:y,totalCommission:w,topDrivers:T}},[s,t,n]);return!s||!a?null:r.jsx("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:r.jsxs("div",{className:"bg-[#0f172a] w-full max-w-4xl max-h-[90vh] rounded-3xl border border-gray-800 shadow-2xl overflow-hidden flex flex-col",onClick:l=>l.stopPropagation(),children:[r.jsxs("div",{className:"p-6 border-b border-gray-800 bg-[#1e293b] flex justify-between items-center sticky top-0 z-10",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-2xl font-black text-white flex items-center gap-2",children:["  ",r.jsx("span",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded-lg",children:" "})]}),r.jsx("p",{className:"text-sm text-gray-400 mt-1",children:a.date.toLocaleDateString("ar-EG",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),r.jsx("button",{onClick:e,className:"p-2 bg-gray-800 rounded-full text-gray-400 hover:text-white hover:bg-red-500/20 hover:text-red-500 transition-all",children:r.jsx(rt,{className:"w-6 h-6"})})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8 custom-scrollbar",children:[r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-2xl border border-gray-700",children:[r.jsx("p",{className:"text-xs text-gray-500 font-bold mb-1",children:" "}),r.jsx("p",{className:"text-3xl font-black text-white",children:a.count})]}),r.jsxs("div",{className:"bg-green-900/10 p-4 rounded-2xl border border-green-500/20",children:[r.jsx("p",{className:"text-xs text-green-500/70 font-bold mb-1",children:" "}),r.jsx("p",{className:"text-3xl font-black text-green-400",children:a.deliveredCount})]}),r.jsxs("div",{className:"bg-red-900/10 p-4 rounded-2xl border border-red-500/20",children:[r.jsx("p",{className:"text-xs text-red-500/70 font-bold mb-1",children:" / "}),r.jsx("p",{className:"text-3xl font-black text-red-400",children:a.cancelledCount})]}),r.jsxs("div",{className:"bg-yellow-900/10 p-4 rounded-2xl border border-yellow-500/20",children:[r.jsx("p",{className:"text-xs text-yellow-500/70 font-bold mb-1",children:" "}),r.jsx("p",{className:"text-3xl font-black text-yellow-400",children:a.pendingCount})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-3xl p-6 border border-gray-700 relative overflow-hidden",children:[r.jsx("div",{className:"absolute top-0 left-0 w-32 h-32 bg-blue-500/10 blur-3xl rounded-full -ml-10 -mt-10 pointer-events-none"}),r.jsxs("h3",{className:"text-lg font-bold text-white mb-6 relative z-10 flex items-center gap-2",children:[r.jsx(Pc,{className:"w-5 h-5 text-green-400"})," "]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 relative z-10",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"  "}),r.jsxs("p",{className:"text-2xl font-black text-white",children:[a.totalRevenue.toLocaleString("en-US")," ",r.jsx("span",{className:"text-sm font-normal text-gray-500",children:"."})]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"  "}),r.jsxs("p",{className:"text-2xl font-black text-blue-400",children:[a.totalDeliveryFees.toLocaleString("en-US")," ",r.jsx("span",{className:"text-sm font-normal text-gray-500",children:"."})]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"  ()"}),r.jsxs("p",{className:"text-2xl font-black text-green-400",children:[a.totalCommission.toLocaleString("en-US")," ",r.jsx("span",{className:"text-sm font-normal text-gray-500",children:"."})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-gray-800 p-6 rounded-3xl border border-gray-700",children:[r.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[r.jsx(Bt,{className:"w-5 h-5 text-blue-400"}),"  "]}),r.jsx("div",{className:"space-y-4",children:a.topDrivers.length>0?a.topDrivers.map((l,c)=>r.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900/50 rounded-xl border border-gray-700/50",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm ${c===0?"bg-yellow-500 text-black":"bg-gray-700 text-gray-300"}`,children:c+1}),r.jsx("span",{className:"text-sm font-bold text-white",children:l.name})]}),r.jsxs("div",{className:"text-left",children:[r.jsxs("p",{className:"text-sm font-black text-blue-400",children:[l.count," "]}),r.jsxs("p",{className:"text-[10px] text-gray-500",children:[l.total.toLocaleString()," . "]})]})]},c)):r.jsx("p",{className:"text-gray-500 text-center py-4 text-sm",children:"    "})})]}),r.jsxs("div",{className:"bg-gray-800 p-6 rounded-3xl border border-gray-700 flex flex-col justify-center",children:[r.jsx("h3",{className:"text-lg font-bold text-white mb-6",children:"  "}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-300 mb-2",children:[r.jsx("span",{children:" "}),r.jsxs("span",{children:[a.count>0?Math.round(a.deliveredCount/a.count*100):0,"%"]})]}),r.jsx("div",{className:"h-3 bg-gray-900 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-green-500",style:{width:`${a.count>0?a.deliveredCount/a.count*100:0}%`}})})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-300 mb-2",children:[r.jsx("span",{children:" "}),r.jsxs("span",{children:[a.count>0?Math.round(a.cancelledCount/a.count*100):0,"%"]})]}),r.jsx("div",{className:"h-3 bg-gray-900 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-red-500",style:{width:`${a.count>0?a.cancelledCount/a.count*100:0}%`}})})]})]})]})]})]})]})})},J5=({orders:s,users:e,payments:t,currentUser:n})=>{const[a,l]=j.useState(!1),[c,d]=j.useState("driver"),[f,m]=j.useState(!1),[x,y]=j.useState(null),[w,v]=j.useState(!1),T=j.useMemo(()=>{const P=s.filter(S=>S.status===ue.Delivered),U=P.reduce((S,F)=>S+(F.totalPrice||0),0),V=P.reduce((S,F)=>S+(F.deliveryFee||0),0);let q=0;P.forEach(S=>{const F=e.find(E=>(E==null?void 0:E.id)===S.driverId);F&&(F.commissionType==="fixed"?q+=F.commissionRate||0:q+=(S.deliveryFee||0)*((F.commissionRate||0)/100))});const W=new Date,z=W.getMonth(),k=W.getFullYear(),M=P.filter(S=>{var E;const F=(E=S.deliveredAt)!=null&&E.seconds?new Date(S.deliveredAt.seconds*1e3):new Date(S.deliveredAt||S.createdAt);return F.getMonth()===z&&F.getFullYear()===k}),B=M.reduce((S,F)=>S+(F.totalPrice||0),0);let D=0;return M.forEach(S=>{const F=e.find(E=>(E==null?void 0:E.id)===S.driverId);F&&(F.commissionType==="fixed"?D+=F.commissionRate||0:D+=(S.deliveryFee||0)*((F.commissionRate||0)/100))}),{orderCount:s.length,deliveredCount:P.length,cancelledCount:s.filter(S=>S.status===ue.Cancelled).length,pendingCount:s.filter(S=>S.status===ue.Pending).length,totalRevenue:U,totalDeliveryFees:V,totalCommission:q,merchantsCount:e.filter(S=>(S==null?void 0:S.role)==="merchant").length,driversCount:e.filter(S=>(S==null?void 0:S.role)==="driver").length,monthlyRevenue:B,monthlyCommission:D,commission15Percent:D*.15}},[s,e]),I=P=>{d(P),l(!0)},N=(P,U)=>{const V=e.find(S=>(S==null?void 0:S.id)===P);if(!V)return;let q=s.filter(S=>V.role==="driver"?S.driverId===P:S.merchantId===P),W="  ";if(U.type==="custom"&&U.start&&U.end){const S=new Date(U.start),F=new Date(U.end);F.setHours(23,59,59),q=q.filter(E=>{const Y=new Date(E.createdAt);return Y>=S&&Y<=F}),W=` ${U.start}  ${U.end}`}const z=q.filter(S=>S.status===ue.Delivered),k=z.reduce((S,F)=>S+(F.totalPrice||0),0),M=z.reduce((S,F)=>S+(F.deliveryFee||0),0);let B=0,D=0;V.role==="driver"&&(V.commissionType==="fixed"?B=z.length*(V.commissionRate||0):B=M*((V.commissionRate||0)/100),D=M-B),y({user:V,orders:q.sort((S,F)=>{const E=S.createdAt.seconds?S.createdAt.seconds:new Date(S.createdAt).getTime();return(F.createdAt.seconds?F.createdAt.seconds:new Date(F.createdAt).getTime())-E}),summary:{count:q.length,totalRevenue:k,totalDelivery:M,appCommission:B,driverEarnings:D},dateLabel:W}),m(!0)};return r.jsxs("div",{className:"space-y-8 pb-32 animate-fadeIn relative",children:[r.jsxs("div",{className:"flex flex-col gap-6 border-b border-gray-700 pb-6",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"p-4 bg-red-600 rounded-2xl shadow-xl shadow-red-900/20",children:r.jsx(ym,{className:"w-8 h-8 text-white"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-3xl font-black text-white tracking-tight",children:" "}),r.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"    "})]})]}),r.jsxs("div",{className:"flex gap-3",children:[n.role==="admin"&&r.jsxs("button",{onClick:()=>v(!0),className:"flex-1 bg-gradient-to-r from-blue-900 to-blue-800 hover:from-blue-800 hover:to-blue-700 border border-blue-700 rounded-xl p-3 flex items-center justify-center gap-2 transition-all active:scale-95 group shadow-lg shadow-blue-900/30",children:[r.jsx("div",{className:"p-2 bg-blue-500/20 rounded-full group-hover:bg-blue-500/30",children:r.jsx(Wn,{className:"w-5 h-5 text-blue-200"})}),r.jsx("span",{className:"text-sm font-bold text-white",children:"  "})]}),r.jsxs("button",{onClick:()=>I("driver"),className:"flex-1 bg-gray-800 hover:bg-gray-700 border border-gray-700 rounded-xl p-3 flex items-center justify-center gap-2 transition-all active:scale-95 group",children:[r.jsx("div",{className:"p-2 bg-blue-500/10 rounded-full group-hover:bg-blue-500/20",children:r.jsx(Bt,{className:"w-5 h-5 text-blue-400"})}),r.jsx("span",{className:"text-sm font-bold text-gray-200",children:" "})]}),r.jsxs("button",{onClick:()=>I("merchant"),className:"flex-1 bg-gray-800 hover:bg-gray-700 border border-gray-700 rounded-xl p-3 flex items-center justify-center gap-2 transition-all active:scale-95 group",children:[r.jsx("div",{className:"p-2 bg-purple-500/10 rounded-full group-hover:bg-purple-500/20",children:r.jsx(lr,{className:"w-5 h-5 text-purple-400"})}),r.jsx("span",{className:"text-sm font-bold text-gray-200",children:" "})]})]})]}),n.role==="admin"&&r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[r.jsx(Iy,{title:" ",value:`${T.totalRevenue.toLocaleString("en-US")} .`,subValue:"    ",icon:r.jsx(Pc,{className:"w-6 h-6"}),color:"bg-green-500",trend:"up",trendValue:"+12%"}),r.jsx(Iy,{title:" ",value:`${T.totalDeliveryFees.toLocaleString("en-US")} .`,subValue:"   ",icon:r.jsx(Bt,{className:"w-6 h-6"}),color:"bg-blue-500"}),r.jsx(Iy,{title:" ",value:`${T.totalCommission.toLocaleString("en-US")} .`,subValue:"    ",icon:r.jsx($5,{className:"w-6 h-6"}),color:"bg-red-500",trend:"up",trendValue:"+5%"})]}),n.role==="admin"&&r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsx("div",{className:"bg-gradient-to-br from-purple-900/50 to-purple-800/30 p-5 rounded-2xl border border-purple-500/30 relative overflow-hidden",children:r.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[r.jsx("div",{className:"p-3 bg-purple-500/20 rounded-xl text-purple-300",children:r.jsx(il,{className:"w-6 h-6"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-purple-200 font-bold mb-1",children:"   "}),r.jsxs("h3",{className:"text-2xl font-black text-white",children:[T.monthlyCommission.toLocaleString("en-US")," ",r.jsx("span",{className:"text-sm font-normal text-purple-300",children:"."})]})]})]})}),r.jsx("div",{className:"bg-gradient-to-br from-orange-900/50 to-orange-800/30 p-5 rounded-2xl border border-orange-500/30 relative overflow-hidden",children:r.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[r.jsx("div",{className:"p-3 bg-orange-500/20 rounded-xl text-orange-300",children:r.jsx(R0,{className:"w-6 h-6"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-orange-200 font-bold mb-1",children:"  (15%)"}),r.jsxs("h3",{className:"text-2xl font-black text-white",children:[T.commission15Percent.toLocaleString("en-US")," ",r.jsx("span",{className:"text-sm font-normal text-orange-300",children:"."})]})]})]})})]}),r.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-2xl border border-gray-700 flex flex-col items-center text-center",children:[r.jsx(nt,{className:"w-8 h-8 text-green-500 mb-2"}),r.jsx("span",{className:"text-2xl font-black text-white",children:T.deliveredCount}),r.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase",children:" "})]}),r.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-2xl border border-gray-700 flex flex-col items-center text-center",children:[r.jsx(wt,{className:"w-8 h-8 text-yellow-500 mb-2"}),r.jsx("span",{className:"text-2xl font-black text-white",children:T.pendingCount}),r.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase",children:" "})]}),r.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-2xl border border-gray-700 flex flex-col items-center text-center",children:[r.jsx(rt,{className:"w-8 h-8 text-red-500 mb-2"}),r.jsx("span",{className:"text-2xl font-black text-white",children:T.cancelledCount}),r.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase",children:" "})]}),r.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-2xl border border-gray-700 flex flex-col items-center text-center",children:[r.jsx(Vd,{className:"w-8 h-8 text-purple-500 mb-2"}),r.jsx("span",{className:"text-2xl font-black text-white",children:e.length}),r.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase",children:" "})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[r.jsxs("div",{className:"bg-gray-800 p-6 rounded-3xl border border-gray-700 shadow-xl",children:[r.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2",children:[r.jsx(lr,{className:"w-5 h-5 text-purple-400"})," "]}),r.jsx("div",{className:"space-y-4",children:["restaurant","market","pharmacy"].map(P=>{const U=e.filter(q=>(q==null?void 0:q.role)==="merchant"&&q.storeCategory===P).length,V=T.merchantsCount>0?U/T.merchantsCount*100:0;return r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-400",children:[r.jsx("span",{children:P==="restaurant"?"":P==="market"?" ":""}),r.jsx("span",{className:"text-white",children:U})]}),r.jsx("div",{className:"h-2 bg-gray-900 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-purple-600 transition-all duration-1000",style:{width:`${V}%`}})})]},P)})})]}),r.jsxs("div",{className:"bg-gray-800 p-6 rounded-3xl border border-gray-700 shadow-xl",children:[r.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2",children:[r.jsx(Bt,{className:"w-5 h-5 text-blue-400"})," "]}),r.jsxs("div",{className:"flex flex-col justify-center h-full",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 rounded-2xl mb-3 border border-white/5",children:[r.jsx("span",{className:"text-sm text-gray-400 font-bold",children:"  "}),r.jsx("span",{className:"text-xl font-black text-blue-400",children:T.deliveredCount>0?(T.deliveredCount/Math.max(T.driversCount,1)).toFixed(1):0})]}),r.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 rounded-2xl border border-white/5",children:[r.jsx("span",{className:"text-sm text-gray-400 font-bold",children:"  "}),r.jsxs("span",{className:"text-xl font-black text-green-400",children:[T.orderCount>0?(T.deliveredCount/T.orderCount*100).toFixed(0):0,"%"]})]})]})]})]}),r.jsx(eO,{isOpen:a,onClose:()=>l(!1),type:c,users:e,onGenerate:N}),r.jsx(tO,{isOpen:f,onClose:()=>m(!1),reportData:x}),r.jsx(sO,{isOpen:w,onClose:()=>v(!1),orders:s,users:e})]})},nO=()=>{};var SS={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X5=function(s){const e=[];let t=0;for(let n=0;n<s.length;n++){let a=s.charCodeAt(n);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&n+1<s.length&&(s.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(s.charCodeAt(++n)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},rO=function(s){const e=[];let t=0,n=0;for(;t<s.length;){const a=s[t++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const l=s[t++];e[n++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=s[t++],c=s[t++],d=s[t++],f=((a&7)<<18|(l&63)<<12|(c&63)<<6|d&63)-65536;e[n++]=String.fromCharCode(55296+(f>>10)),e[n++]=String.fromCharCode(56320+(f&1023))}else{const l=s[t++],c=s[t++];e[n++]=String.fromCharCode((a&15)<<12|(l&63)<<6|c&63)}}return e.join("")},Z5={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<s.length;a+=3){const l=s[a],c=a+1<s.length,d=c?s[a+1]:0,f=a+2<s.length,m=f?s[a+2]:0,x=l>>2,y=(l&3)<<4|d>>4;let w=(d&15)<<2|m>>6,v=m&63;f||(v=64,c||(w=64)),n.push(t[x],t[y],t[w],t[v])}return n.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(X5(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):rO(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<s.length;){const l=t[s.charAt(a++)],d=a<s.length?t[s.charAt(a)]:0;++a;const m=a<s.length?t[s.charAt(a)]:64;++a;const y=a<s.length?t[s.charAt(a)]:64;if(++a,l==null||d==null||m==null||y==null)throw new aO;const w=l<<2|d>>4;if(n.push(w),m!==64){const v=d<<4&240|m>>2;if(n.push(v),y!==64){const T=m<<6&192|y;n.push(T)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class aO extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const iO=function(s){const e=X5(s);return Z5.encodeByteArray(e,!0)},Yp=function(s){return iO(s).replace(/\./g,"")},Ov=function(s){try{return Z5.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Jp(s,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:s===void 0&&(s={});break;case Array:s=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!oO(t)||(s[t]=Jp(s[t],e[t]));return s}function oO(s){return s!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lO=()=>Pv().__FIREBASE_DEFAULTS__,cO=()=>{if(typeof process>"u"||typeof SS>"u")return;const s=SS.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},uO=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&Ov(s[1]);return e&&JSON.parse(e)},Mv=()=>{try{return nO()||lO()||cO()||uO()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Lv=()=>{var s;return(s=Mv())==null?void 0:s.config},dO=s=>{var e;return(e=Mv())==null?void 0:e[`_${s}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hO=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}};/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ol(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Vv(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eI(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",a=s.iat||0,l=s.sub||s.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Yp(JSON.stringify(t)),Yp(JSON.stringify(c)),""].join(".")}const jf={};function fO(){const s={prod:[],emulator:[]};for(const e of Object.keys(jf))jf[e]?s.emulator.push(e):s.prod.push(e);return s}function mO(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let TS=!1;function Uv(s,e){if(typeof window>"u"||typeof document>"u"||!ol(window.location.host)||jf[s]===e||jf[s]||TS)return;jf[s]=e;function t(w){return`__firebase__banner__${w}`}const n="__firebase__banner",l=fO().prod.length>0;function c(){const w=document.getElementById(n);w&&w.remove()}function d(w){w.style.display="flex",w.style.background="#7faaf0",w.style.position="fixed",w.style.bottom="5px",w.style.left="5px",w.style.padding=".5em",w.style.borderRadius="5px",w.style.alignItems="center"}function f(w,v){w.setAttribute("width","24"),w.setAttribute("id",v),w.setAttribute("height","24"),w.setAttribute("viewBox","0 0 24 24"),w.setAttribute("fill","none"),w.style.marginLeft="-6px"}function m(){const w=document.createElement("span");return w.style.cursor="pointer",w.style.marginLeft="16px",w.style.fontSize="24px",w.innerHTML=" &times;",w.onclick=()=>{TS=!0,c()},w}function x(w,v){w.setAttribute("id",v),w.innerText="Learn more",w.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",w.setAttribute("target","__blank"),w.style.paddingLeft="5px",w.style.textDecoration="underline"}function y(){const w=mO(n),v=t("text"),T=document.getElementById(v)||document.createElement("span"),I=t("learnmore"),N=document.getElementById(I)||document.createElement("a"),P=t("preprendIcon"),U=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(w.created){const V=w.element;d(V),x(N,I);const q=m();f(U,P),V.append(U,T,N,q),document.body.appendChild(V)}l?(T.innerText="Preview backend disconnected.",U.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(U.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ps(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function gO(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ps())}function D0(){var e;const s=(e=Mv())==null?void 0:e.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function pO(){return typeof window<"u"||tI()}function tI(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function xO(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function sI(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function Fv(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function nI(){const s=ps();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function rI(){return!D0()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function aI(){return!D0()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function mc(){try{return typeof indexedDB=="object"}catch{return!1}}function bO(){return new Promise((s,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(n),s(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)==null?void 0:l.message)||"")}}catch(t){e(t)}})}function yO(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wO="FirebaseError";class wn extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=wO,Object.setPrototypeOf(this,wn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,oi.prototype.create)}}class oi{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],c=l?vO(l,n):"Error",d=`${this.serviceName}: ${c} (${a}).`;return new wn(a,d,n)}}function vO(s,e){return s.replace(_O,(t,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const _O=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ES(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function jO(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function Yo(s,e){if(s===e)return!0;const t=Object.keys(s),n=Object.keys(e);for(const a of t){if(!n.includes(a))return!1;const l=s[a],c=e[a];if(IS(l)&&IS(c)){if(!Yo(l,c))return!1}else if(l!==c)return!1}for(const a of n)if(!t.includes(a))return!1;return!0}function IS(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ud(s){const e=[];for(const[t,n]of Object.entries(s))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function ed(s){const e={};return s.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[a,l]=n.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function mf(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function iI(s,e){const t=new NO(s,e);return t.subscribe.bind(t)}class NO{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let a;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");SO(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:n},a.next===void 0&&(a.next=Ay),a.error===void 0&&(a.error=Ay),a.complete===void 0&&(a.complete=Ay);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function SO(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function Ay(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function We(s){return s&&s._delegate?s._delegate:s}class un{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TO{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new hO;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(n)return null;throw a}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(IO(e))try{this.getOrInitializeService({instanceIdentifier:Gl})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});n.resolve(l)}catch{}}}}clearInstance(e=Gl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Gl){return this.instances.has(e)}getOptions(e=Gl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[l,c]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(l);n===d&&c.resolve(a)}return a}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(n)??new Set;a.add(e),this.onInitCallbacks.set(n,a);const l=this.instances.get(n);return l&&e(l,n),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const a of n)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:EO(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Gl){return this.component?this.component.multipleInstances?e:Gl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function EO(s){return s===Gl?void 0:s}function IO(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new TO(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $v=[];var jt;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(jt||(jt={}));const lI={debug:jt.DEBUG,verbose:jt.VERBOSE,info:jt.INFO,warn:jt.WARN,error:jt.ERROR,silent:jt.SILENT},AO=jt.INFO,kO={[jt.DEBUG]:"log",[jt.VERBOSE]:"log",[jt.INFO]:"info",[jt.WARN]:"warn",[jt.ERROR]:"error"},CO=(s,e,...t)=>{if(e<s.logLevel)return;const n=new Date().toISOString(),a=kO[e];if(a)console[a](`[${n}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class O0{constructor(e){this.name=e,this._logLevel=AO,this._logHandler=CO,this._userLogHandler=null,$v.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in jt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?lI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,jt.DEBUG,...e),this._logHandler(this,jt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,jt.VERBOSE,...e),this._logHandler(this,jt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,jt.INFO,...e),this._logHandler(this,jt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,jt.WARN,...e),this._logHandler(this,jt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,jt.ERROR,...e),this._logHandler(this,jt.ERROR,...e)}}function RO(s){$v.forEach(e=>{e.setLogLevel(s)})}function DO(s,e){for(const t of $v){let n=null;e&&e.level&&(n=lI[e.level]),s===null?t.userLogHandler=null:t.userLogHandler=(a,l,...c)=>{const d=c.map(f=>{if(f==null)return null;if(typeof f=="string")return f;if(typeof f=="number"||typeof f=="boolean")return f.toString();if(f instanceof Error)return f.message;try{return JSON.stringify(f)}catch{return null}}).filter(f=>f).join(" ");l>=(n??a.logLevel)&&s({level:jt[l].toLowerCase(),message:d,args:c,type:a.name})}}}const OO=(s,e)=>e.some(t=>s instanceof t);let AS,kS;function PO(){return AS||(AS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function MO(){return kS||(kS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cI=new WeakMap,Nw=new WeakMap,uI=new WeakMap,ky=new WeakMap,Bv=new WeakMap;function LO(s){const e=new Promise((t,n)=>{const a=()=>{s.removeEventListener("success",l),s.removeEventListener("error",c)},l=()=>{t(Mi(s.result)),a()},c=()=>{n(s.error),a()};s.addEventListener("success",l),s.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&cI.set(t,s)}).catch(()=>{}),Bv.set(e,s),e}function VO(s){if(Nw.has(s))return;const e=new Promise((t,n)=>{const a=()=>{s.removeEventListener("complete",l),s.removeEventListener("error",c),s.removeEventListener("abort",c)},l=()=>{t(),a()},c=()=>{n(s.error||new DOMException("AbortError","AbortError")),a()};s.addEventListener("complete",l),s.addEventListener("error",c),s.addEventListener("abort",c)});Nw.set(s,e)}let Sw={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return Nw.get(s);if(e==="objectStoreNames")return s.objectStoreNames||uI.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Mi(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function UO(s){Sw=s(Sw)}function FO(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=s.call(Cy(this),e,...t);return uI.set(n,e.sort?e.sort():[e]),Mi(n)}:MO().includes(s)?function(...e){return s.apply(Cy(this),e),Mi(cI.get(this))}:function(...e){return Mi(s.apply(Cy(this),e))}}function $O(s){return typeof s=="function"?FO(s):(s instanceof IDBTransaction&&VO(s),OO(s,PO())?new Proxy(s,Sw):s)}function Mi(s){if(s instanceof IDBRequest)return LO(s);if(ky.has(s))return ky.get(s);const e=$O(s);return e!==s&&(ky.set(s,e),Bv.set(e,s)),e}const Cy=s=>Bv.get(s);function Fd(s,e,{blocked:t,upgrade:n,blocking:a,terminated:l}={}){const c=indexedDB.open(s,e),d=Mi(c);return n&&c.addEventListener("upgradeneeded",f=>{n(Mi(c.result),f.oldVersion,f.newVersion,Mi(c.transaction),f)}),t&&c.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),d.then(f=>{l&&f.addEventListener("close",()=>l()),a&&f.addEventListener("versionchange",m=>a(m.oldVersion,m.newVersion,m))}).catch(()=>{}),d}function rd(s,{blocked:e}={}){const t=indexedDB.deleteDatabase(s);return e&&t.addEventListener("blocked",n=>e(n.oldVersion,n)),Mi(t).then(()=>{})}const BO=["get","getKey","getAll","getAllKeys","count"],zO=["put","add","delete","clear"],Ry=new Map;function CS(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Ry.get(e))return Ry.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,a=zO.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(a||BO.includes(t)))return;const l=async function(c,...d){const f=this.transaction(c,a?"readwrite":"readonly");let m=f.store;return n&&(m=m.index(d.shift())),(await Promise.all([m[t](...d),a&&f.done]))[0]};return Ry.set(e,l),l}UO(s=>({...s,get:(e,t,n)=>CS(e,t)||s.get(e,t,n),has:(e,t)=>!!CS(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qO{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(HO(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function HO(s){const e=s.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Xp="@firebase/app",Tw="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fi=new O0("@firebase/app"),GO="@firebase/app-compat",WO="@firebase/analytics-compat",KO="@firebase/analytics",QO="@firebase/app-check-compat",YO="@firebase/app-check",JO="@firebase/auth",XO="@firebase/auth-compat",ZO="@firebase/database",eP="@firebase/data-connect",tP="@firebase/database-compat",sP="@firebase/functions",nP="@firebase/functions-compat",rP="@firebase/installations",aP="@firebase/installations-compat",iP="@firebase/messaging",oP="@firebase/messaging-compat",lP="@firebase/performance",cP="@firebase/performance-compat",uP="@firebase/remote-config",dP="@firebase/remote-config-compat",hP="@firebase/storage",fP="@firebase/storage-compat",mP="@firebase/firestore",gP="@firebase/ai",pP="@firebase/firestore-compat",xP="firebase",bP="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jo="[DEFAULT]",yP={[Xp]:"fire-core",[GO]:"fire-core-compat",[KO]:"fire-analytics",[WO]:"fire-analytics-compat",[YO]:"fire-app-check",[QO]:"fire-app-check-compat",[JO]:"fire-auth",[XO]:"fire-auth-compat",[ZO]:"fire-rtdb",[eP]:"fire-data-connect",[tP]:"fire-rtdb-compat",[sP]:"fire-fn",[nP]:"fire-fn-compat",[rP]:"fire-iid",[aP]:"fire-iid-compat",[iP]:"fire-fcm",[oP]:"fire-fcm-compat",[lP]:"fire-perf",[cP]:"fire-perf-compat",[uP]:"fire-rc",[dP]:"fire-rc-compat",[hP]:"fire-gcs",[fP]:"fire-gcs-compat",[mP]:"fire-fst",[pP]:"fire-fst-compat",[gP]:"fire-vertex","fire-js":"fire-js",[xP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xo=new Map,md=new Map,gd=new Map;function zf(s,e){try{s.container.addComponent(e)}catch(t){Fi.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function dI(s,e){s.container.addOrOverwriteComponent(e)}function dr(s){const e=s.name;if(gd.has(e))return Fi.debug(`There were multiple attempts to register component ${e}.`),!1;gd.set(e,s);for(const t of Xo.values())zf(t,s);for(const t of md.values())zf(t,s);return!0}function P0(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function wP(s,e,t=Jo){P0(s,e).clearInstance(t)}function zv(s){return s.options!==void 0}function hI(s){return zv(s)?!1:"authIdToken"in s||"appCheckToken"in s||"releaseOnDeref"in s||"automaticDataCollectionEnabled"in s}function is(s){return s==null?!1:s.settings!==void 0}function vP(){gd.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _P={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Cr=new oi("app","Firebase",_P);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fI=class{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new un("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Cr.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RS(s,e){const t=Ov(s.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const a=JSON.parse(t).exp*1e3,l=new Date().getTime();a-l<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class jP extends fI{constructor(e,t,n,a){const l=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,c={name:n,automaticDataCollectionEnabled:l};if(e.apiKey!==void 0)super(e,c,a);else{const d=e;super(d.options,c,a)}this._serverConfig={automaticDataCollectionEnabled:l,...t},this._serverConfig.authIdToken&&RS(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&RS(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,vn(Xp,Tw,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Hv(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Cr.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hi=bP;function qv(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const n={name:Jo,automaticDataCollectionEnabled:!0,...e},a=n.name;if(typeof a!="string"||!a)throw Cr.create("bad-app-name",{appName:String(a)});if(t||(t=Lv()),!t)throw Cr.create("no-options");const l=Xo.get(a);if(l){if(Yo(t,l.options)&&Yo(n,l.config))return l;throw Cr.create("duplicate-app",{appName:a})}const c=new oI(a);for(const f of gd.values())c.addComponent(f);const d=new fI(t,n,c);return Xo.set(a,d),d}function NP(s,e={}){if(pO()&&!tI())throw Cr.create("invalid-server-app-environment");let t,n=e||{};if(s&&(zv(s)?t=s.options:hI(s)?n=s:t=s),n.automaticDataCollectionEnabled===void 0&&(n.automaticDataCollectionEnabled=!0),t||(t=Lv()),!t)throw Cr.create("no-options");const a={...n,...t};a.releaseOnDeref!==void 0&&delete a.releaseOnDeref;const l=x=>[...x].reduce((y,w)=>Math.imul(31,y)+w.charCodeAt(0)|0,0);if(n.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Cr.create("finalization-registry-not-supported",{});const c=""+l(JSON.stringify(a)),d=md.get(c);if(d)return d.incRefCount(n.releaseOnDeref),d;const f=new oI(c);for(const x of gd.values())f.addComponent(x);const m=new jP(t,n,c,f);return md.set(c,m),m}function SP(s=Jo){const e=Xo.get(s);if(!e&&s===Jo&&Lv())return qv();if(!e)throw Cr.create("no-app",{appName:s});return e}function TP(){return Array.from(Xo.values())}async function Hv(s){let e=!1;const t=s.name;Xo.has(t)?(e=!0,Xo.delete(t)):md.has(t)&&s.decRefCount()<=0&&(md.delete(t),e=!0),e&&(await Promise.all(s.container.getProviders().map(n=>n.delete())),s.isDeleted=!0)}function vn(s,e,t){let n=yP[s]??s;t&&(n+=`-${t}`);const a=n.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const c=[`Unable to register library "${n}" with version "${e}":`];a&&c.push(`library name "${n}" contains illegal characters (whitespace or "/")`),a&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Fi.warn(c.join(" "));return}dr(new un(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}function mI(s,e){if(s!==null&&typeof s!="function")throw Cr.create("invalid-log-argument");DO(s,e)}function gI(s){RO(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EP="firebase-heartbeat-database",IP=1,qf="firebase-heartbeat-store";let Dy=null;function pI(){return Dy||(Dy=Fd(EP,IP,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(qf)}catch(t){console.warn(t)}}}}).catch(s=>{throw Cr.create("idb-open",{originalErrorMessage:s.message})})),Dy}async function AP(s){try{const t=(await pI()).transaction(qf),n=await t.objectStore(qf).get(xI(s));return await t.done,n}catch(e){if(e instanceof wn)Fi.warn(e.message);else{const t=Cr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Fi.warn(t.message)}}}async function DS(s,e){try{const n=(await pI()).transaction(qf,"readwrite");await n.objectStore(qf).put(e,xI(s)),await n.done}catch(t){if(t instanceof wn)Fi.warn(t.message);else{const n=Cr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Fi.warn(n.message)}}}function xI(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kP=1024,CP=30;class RP{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new OP(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=OS();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(c=>c.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>CP){const c=PP(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Fi.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=OS(),{heartbeatsToSend:n,unsentEntries:a}=DP(this._heartbeatsCache.heartbeats),l=Yp(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return Fi.warn(t),""}}}function OS(){return new Date().toISOString().substring(0,10)}function DP(s,e=kP){const t=[];let n=s.slice();for(const a of s){const l=t.find(c=>c.agent===a.agent);if(l){if(l.dates.push(a.date),PS(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),PS(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class OP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return mc()?bO().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await AP(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return DS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return DS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function PS(s){return Yp(JSON.stringify({version:2,heartbeats:s})).length}function PP(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let n=1;n<s.length;n++)s[n].date<t&&(t=s[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MP(s){dr(new un("platform-logger",e=>new qO(e),"PRIVATE")),dr(new un("heartbeat",e=>new RP(e),"PRIVATE")),vn(Xp,Tw,s),vn(Xp,Tw,"esm2020"),vn("fire-js","")}MP("");const LP=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:wn,SDK_VERSION:Hi,_DEFAULT_ENTRY_NAME:Jo,_addComponent:zf,_addOrOverwriteComponent:dI,_apps:Xo,_clearComponents:vP,_components:gd,_getProvider:P0,_isFirebaseApp:zv,_isFirebaseServerApp:is,_isFirebaseServerAppSettings:hI,_registerComponent:dr,_removeServiceInstance:wP,_serverApps:md,deleteApp:Hv,getApp:SP,getApps:TP,initializeApp:qv,initializeServerApp:NP,onLog:mI,registerVersion:vn,setLogLevel:gI},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(e,t){this._delegate=e,this.firebase=t,zf(e,new un("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Hv(this._delegate)))}_getService(e,t=Jo){var a;this._delegate.checkDestroyed();const n=this._delegate.container.getProvider(e);return!n.isInitialized()&&((a=n.getComponent())==null?void 0:a.instantiationMode)==="EXPLICIT"&&n.initialize(),n.getImmediate({identifier:t})}_removeServiceInstance(e,t=Jo){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){zf(this._delegate,e)}_addOrOverwriteComponent(e){dI(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UP={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},MS=new oi("app-compat","Firebase",UP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FP(s){const e={},t={__esModule:!0,initializeApp:l,app:a,registerVersion:vn,setLogLevel:gI,onLog:mI,apps:null,SDK_VERSION:Hi,INTERNAL:{registerComponent:d,removeApp:n,useAsService:f,modularAPIs:LP}};t.default=t,Object.defineProperty(t,"apps",{get:c});function n(m){delete e[m]}function a(m){if(m=m||Jo,!ES(e,m))throw MS.create("no-app",{appName:m});return e[m]}a.App=s;function l(m,x={}){const y=qv(m,x);if(ES(e,y.name))return e[y.name];const w=new s(y,t);return e[y.name]=w,w}function c(){return Object.keys(e).map(m=>e[m])}function d(m){const x=m.name,y=x.replace("-compat","");if(dr(m)&&m.type==="PUBLIC"){const w=(v=a())=>{if(typeof v[y]!="function")throw MS.create("invalid-app-argument",{appName:x});return v[y]()};m.serviceProps!==void 0&&Jp(w,m.serviceProps),t[y]=w,s.prototype[y]=function(...v){return this._getService.bind(this,x).apply(this,m.multipleInstances?v:[])}}return m.type==="PUBLIC"?t[y]:null}function f(m,x){return x==="serverAuth"?null:x}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bI(){const s=FP(VP);s.INTERNAL={...s.INTERNAL,createFirebaseNamespace:bI,extendNamespace:e,createSubscribe:iI,ErrorFactory:oi,deepExtend:Jp};function e(t){Jp(s,t)}return s}const $P=bI();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LS=new O0("@firebase/app-compat"),BP="@firebase/app-compat",zP="0.5.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qP(s){vn(BP,zP,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const s=Pv();if(s.firebase!==void 0){LS.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=s.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&LS.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const qs=$P;qP();var HP="firebase",GP="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qs.registerVersion(HP,GP,"app-compat");var VS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ho,yI;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,M){function B(){}B.prototype=M.prototype,k.F=M.prototype,k.prototype=new B,k.prototype.constructor=k,k.D=function(D,S,F){for(var E=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)E[Y-2]=arguments[Y];return M.prototype[S].apply(D,E)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(k,M,B){B||(B=0);const D=Array(16);if(typeof M=="string")for(var S=0;S<16;++S)D[S]=M.charCodeAt(B++)|M.charCodeAt(B++)<<8|M.charCodeAt(B++)<<16|M.charCodeAt(B++)<<24;else for(S=0;S<16;++S)D[S]=M[B++]|M[B++]<<8|M[B++]<<16|M[B++]<<24;M=k.g[0],B=k.g[1],S=k.g[2];let F=k.g[3],E;E=M+(F^B&(S^F))+D[0]+3614090360&4294967295,M=B+(E<<7&4294967295|E>>>25),E=F+(S^M&(B^S))+D[1]+3905402710&4294967295,F=M+(E<<12&4294967295|E>>>20),E=S+(B^F&(M^B))+D[2]+606105819&4294967295,S=F+(E<<17&4294967295|E>>>15),E=B+(M^S&(F^M))+D[3]+3250441966&4294967295,B=S+(E<<22&4294967295|E>>>10),E=M+(F^B&(S^F))+D[4]+4118548399&4294967295,M=B+(E<<7&4294967295|E>>>25),E=F+(S^M&(B^S))+D[5]+1200080426&4294967295,F=M+(E<<12&4294967295|E>>>20),E=S+(B^F&(M^B))+D[6]+2821735955&4294967295,S=F+(E<<17&4294967295|E>>>15),E=B+(M^S&(F^M))+D[7]+4249261313&4294967295,B=S+(E<<22&4294967295|E>>>10),E=M+(F^B&(S^F))+D[8]+1770035416&4294967295,M=B+(E<<7&4294967295|E>>>25),E=F+(S^M&(B^S))+D[9]+2336552879&4294967295,F=M+(E<<12&4294967295|E>>>20),E=S+(B^F&(M^B))+D[10]+4294925233&4294967295,S=F+(E<<17&4294967295|E>>>15),E=B+(M^S&(F^M))+D[11]+2304563134&4294967295,B=S+(E<<22&4294967295|E>>>10),E=M+(F^B&(S^F))+D[12]+1804603682&4294967295,M=B+(E<<7&4294967295|E>>>25),E=F+(S^M&(B^S))+D[13]+4254626195&4294967295,F=M+(E<<12&4294967295|E>>>20),E=S+(B^F&(M^B))+D[14]+2792965006&4294967295,S=F+(E<<17&4294967295|E>>>15),E=B+(M^S&(F^M))+D[15]+1236535329&4294967295,B=S+(E<<22&4294967295|E>>>10),E=M+(S^F&(B^S))+D[1]+4129170786&4294967295,M=B+(E<<5&4294967295|E>>>27),E=F+(B^S&(M^B))+D[6]+3225465664&4294967295,F=M+(E<<9&4294967295|E>>>23),E=S+(M^B&(F^M))+D[11]+643717713&4294967295,S=F+(E<<14&4294967295|E>>>18),E=B+(F^M&(S^F))+D[0]+3921069994&4294967295,B=S+(E<<20&4294967295|E>>>12),E=M+(S^F&(B^S))+D[5]+3593408605&4294967295,M=B+(E<<5&4294967295|E>>>27),E=F+(B^S&(M^B))+D[10]+38016083&4294967295,F=M+(E<<9&4294967295|E>>>23),E=S+(M^B&(F^M))+D[15]+3634488961&4294967295,S=F+(E<<14&4294967295|E>>>18),E=B+(F^M&(S^F))+D[4]+3889429448&4294967295,B=S+(E<<20&4294967295|E>>>12),E=M+(S^F&(B^S))+D[9]+568446438&4294967295,M=B+(E<<5&4294967295|E>>>27),E=F+(B^S&(M^B))+D[14]+3275163606&4294967295,F=M+(E<<9&4294967295|E>>>23),E=S+(M^B&(F^M))+D[3]+4107603335&4294967295,S=F+(E<<14&4294967295|E>>>18),E=B+(F^M&(S^F))+D[8]+1163531501&4294967295,B=S+(E<<20&4294967295|E>>>12),E=M+(S^F&(B^S))+D[13]+2850285829&4294967295,M=B+(E<<5&4294967295|E>>>27),E=F+(B^S&(M^B))+D[2]+4243563512&4294967295,F=M+(E<<9&4294967295|E>>>23),E=S+(M^B&(F^M))+D[7]+1735328473&4294967295,S=F+(E<<14&4294967295|E>>>18),E=B+(F^M&(S^F))+D[12]+2368359562&4294967295,B=S+(E<<20&4294967295|E>>>12),E=M+(B^S^F)+D[5]+4294588738&4294967295,M=B+(E<<4&4294967295|E>>>28),E=F+(M^B^S)+D[8]+2272392833&4294967295,F=M+(E<<11&4294967295|E>>>21),E=S+(F^M^B)+D[11]+1839030562&4294967295,S=F+(E<<16&4294967295|E>>>16),E=B+(S^F^M)+D[14]+4259657740&4294967295,B=S+(E<<23&4294967295|E>>>9),E=M+(B^S^F)+D[1]+2763975236&4294967295,M=B+(E<<4&4294967295|E>>>28),E=F+(M^B^S)+D[4]+1272893353&4294967295,F=M+(E<<11&4294967295|E>>>21),E=S+(F^M^B)+D[7]+4139469664&4294967295,S=F+(E<<16&4294967295|E>>>16),E=B+(S^F^M)+D[10]+3200236656&4294967295,B=S+(E<<23&4294967295|E>>>9),E=M+(B^S^F)+D[13]+681279174&4294967295,M=B+(E<<4&4294967295|E>>>28),E=F+(M^B^S)+D[0]+3936430074&4294967295,F=M+(E<<11&4294967295|E>>>21),E=S+(F^M^B)+D[3]+3572445317&4294967295,S=F+(E<<16&4294967295|E>>>16),E=B+(S^F^M)+D[6]+76029189&4294967295,B=S+(E<<23&4294967295|E>>>9),E=M+(B^S^F)+D[9]+3654602809&4294967295,M=B+(E<<4&4294967295|E>>>28),E=F+(M^B^S)+D[12]+3873151461&4294967295,F=M+(E<<11&4294967295|E>>>21),E=S+(F^M^B)+D[15]+530742520&4294967295,S=F+(E<<16&4294967295|E>>>16),E=B+(S^F^M)+D[2]+3299628645&4294967295,B=S+(E<<23&4294967295|E>>>9),E=M+(S^(B|~F))+D[0]+4096336452&4294967295,M=B+(E<<6&4294967295|E>>>26),E=F+(B^(M|~S))+D[7]+1126891415&4294967295,F=M+(E<<10&4294967295|E>>>22),E=S+(M^(F|~B))+D[14]+2878612391&4294967295,S=F+(E<<15&4294967295|E>>>17),E=B+(F^(S|~M))+D[5]+4237533241&4294967295,B=S+(E<<21&4294967295|E>>>11),E=M+(S^(B|~F))+D[12]+1700485571&4294967295,M=B+(E<<6&4294967295|E>>>26),E=F+(B^(M|~S))+D[3]+2399980690&4294967295,F=M+(E<<10&4294967295|E>>>22),E=S+(M^(F|~B))+D[10]+4293915773&4294967295,S=F+(E<<15&4294967295|E>>>17),E=B+(F^(S|~M))+D[1]+2240044497&4294967295,B=S+(E<<21&4294967295|E>>>11),E=M+(S^(B|~F))+D[8]+1873313359&4294967295,M=B+(E<<6&4294967295|E>>>26),E=F+(B^(M|~S))+D[15]+4264355552&4294967295,F=M+(E<<10&4294967295|E>>>22),E=S+(M^(F|~B))+D[6]+2734768916&4294967295,S=F+(E<<15&4294967295|E>>>17),E=B+(F^(S|~M))+D[13]+1309151649&4294967295,B=S+(E<<21&4294967295|E>>>11),E=M+(S^(B|~F))+D[4]+4149444226&4294967295,M=B+(E<<6&4294967295|E>>>26),E=F+(B^(M|~S))+D[11]+3174756917&4294967295,F=M+(E<<10&4294967295|E>>>22),E=S+(M^(F|~B))+D[2]+718787259&4294967295,S=F+(E<<15&4294967295|E>>>17),E=B+(F^(S|~M))+D[9]+3951481745&4294967295,k.g[0]=k.g[0]+M&4294967295,k.g[1]=k.g[1]+(S+(E<<21&4294967295|E>>>11))&4294967295,k.g[2]=k.g[2]+S&4294967295,k.g[3]=k.g[3]+F&4294967295}n.prototype.v=function(k,M){M===void 0&&(M=k.length);const B=M-this.blockSize,D=this.C;let S=this.h,F=0;for(;F<M;){if(S==0)for(;F<=B;)a(this,k,F),F+=this.blockSize;if(typeof k=="string"){for(;F<M;)if(D[S++]=k.charCodeAt(F++),S==this.blockSize){a(this,D),S=0;break}}else for(;F<M;)if(D[S++]=k[F++],S==this.blockSize){a(this,D),S=0;break}}this.h=S,this.o+=M},n.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var M=1;M<k.length-8;++M)k[M]=0;M=this.o*8;for(var B=k.length-8;B<k.length;++B)k[B]=M&255,M/=256;for(this.v(k),k=Array(16),M=0,B=0;B<4;++B)for(let D=0;D<32;D+=8)k[M++]=this.g[B]>>>D&255;return k};function l(k,M){var B=d;return Object.prototype.hasOwnProperty.call(B,k)?B[k]:B[k]=M(k)}function c(k,M){this.h=M;const B=[];let D=!0;for(let S=k.length-1;S>=0;S--){const F=k[S]|0;D&&F==M||(B[S]=F,D=!1)}this.g=B}var d={};function f(k){return-128<=k&&k<128?l(k,function(M){return new c([M|0],M<0?-1:0)}):new c([k|0],k<0?-1:0)}function m(k){if(isNaN(k)||!isFinite(k))return y;if(k<0)return N(m(-k));const M=[];let B=1;for(let D=0;k>=B;D++)M[D]=k/B|0,B*=4294967296;return new c(M,0)}function x(k,M){if(k.length==0)throw Error("number format error: empty string");if(M=M||10,M<2||36<M)throw Error("radix out of range: "+M);if(k.charAt(0)=="-")return N(x(k.substring(1),M));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const B=m(Math.pow(M,8));let D=y;for(let F=0;F<k.length;F+=8){var S=Math.min(8,k.length-F);const E=parseInt(k.substring(F,F+S),M);S<8?(S=m(Math.pow(M,S)),D=D.j(S).add(m(E))):(D=D.j(B),D=D.add(m(E)))}return D}var y=f(0),w=f(1),v=f(16777216);s=c.prototype,s.m=function(){if(I(this))return-N(this).m();let k=0,M=1;for(let B=0;B<this.g.length;B++){const D=this.i(B);k+=(D>=0?D:4294967296+D)*M,M*=4294967296}return k},s.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(T(this))return"0";if(I(this))return"-"+N(this).toString(k);const M=m(Math.pow(k,6));var B=this;let D="";for(;;){const S=q(B,M).g;B=P(B,S.j(M));let F=((B.g.length>0?B.g[0]:B.h)>>>0).toString(k);if(B=S,T(B))return F+D;for(;F.length<6;)F="0"+F;D=F+D}},s.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function T(k){if(k.h!=0)return!1;for(let M=0;M<k.g.length;M++)if(k.g[M]!=0)return!1;return!0}function I(k){return k.h==-1}s.l=function(k){return k=P(this,k),I(k)?-1:T(k)?0:1};function N(k){const M=k.g.length,B=[];for(let D=0;D<M;D++)B[D]=~k.g[D];return new c(B,~k.h).add(w)}s.abs=function(){return I(this)?N(this):this},s.add=function(k){const M=Math.max(this.g.length,k.g.length),B=[];let D=0;for(let S=0;S<=M;S++){let F=D+(this.i(S)&65535)+(k.i(S)&65535),E=(F>>>16)+(this.i(S)>>>16)+(k.i(S)>>>16);D=E>>>16,F&=65535,E&=65535,B[S]=E<<16|F}return new c(B,B[B.length-1]&-2147483648?-1:0)};function P(k,M){return k.add(N(M))}s.j=function(k){if(T(this)||T(k))return y;if(I(this))return I(k)?N(this).j(N(k)):N(N(this).j(k));if(I(k))return N(this.j(N(k)));if(this.l(v)<0&&k.l(v)<0)return m(this.m()*k.m());const M=this.g.length+k.g.length,B=[];for(var D=0;D<2*M;D++)B[D]=0;for(D=0;D<this.g.length;D++)for(let S=0;S<k.g.length;S++){const F=this.i(D)>>>16,E=this.i(D)&65535,Y=k.i(S)>>>16,X=k.i(S)&65535;B[2*D+2*S]+=E*X,U(B,2*D+2*S),B[2*D+2*S+1]+=F*X,U(B,2*D+2*S+1),B[2*D+2*S+1]+=E*Y,U(B,2*D+2*S+1),B[2*D+2*S+2]+=F*Y,U(B,2*D+2*S+2)}for(k=0;k<M;k++)B[k]=B[2*k+1]<<16|B[2*k];for(k=M;k<2*M;k++)B[k]=0;return new c(B,0)};function U(k,M){for(;(k[M]&65535)!=k[M];)k[M+1]+=k[M]>>>16,k[M]&=65535,M++}function V(k,M){this.g=k,this.h=M}function q(k,M){if(T(M))throw Error("division by zero");if(T(k))return new V(y,y);if(I(k))return M=q(N(k),M),new V(N(M.g),N(M.h));if(I(M))return M=q(k,N(M)),new V(N(M.g),M.h);if(k.g.length>30){if(I(k)||I(M))throw Error("slowDivide_ only works with positive integers.");for(var B=w,D=M;D.l(k)<=0;)B=W(B),D=W(D);var S=z(B,1),F=z(D,1);for(D=z(D,2),B=z(B,2);!T(D);){var E=F.add(D);E.l(k)<=0&&(S=S.add(B),F=E),D=z(D,1),B=z(B,1)}return M=P(k,S.j(M)),new V(S,M)}for(S=y;k.l(M)>=0;){for(B=Math.max(1,Math.floor(k.m()/M.m())),D=Math.ceil(Math.log(B)/Math.LN2),D=D<=48?1:Math.pow(2,D-48),F=m(B),E=F.j(M);I(E)||E.l(k)>0;)B-=D,F=m(B),E=F.j(M);T(F)&&(F=w),S=S.add(F),k=P(k,E)}return new V(S,k)}s.B=function(k){return q(this,k).h},s.and=function(k){const M=Math.max(this.g.length,k.g.length),B=[];for(let D=0;D<M;D++)B[D]=this.i(D)&k.i(D);return new c(B,this.h&k.h)},s.or=function(k){const M=Math.max(this.g.length,k.g.length),B=[];for(let D=0;D<M;D++)B[D]=this.i(D)|k.i(D);return new c(B,this.h|k.h)},s.xor=function(k){const M=Math.max(this.g.length,k.g.length),B=[];for(let D=0;D<M;D++)B[D]=this.i(D)^k.i(D);return new c(B,this.h^k.h)};function W(k){const M=k.g.length+1,B=[];for(let D=0;D<M;D++)B[D]=k.i(D)<<1|k.i(D-1)>>>31;return new c(B,k.h)}function z(k,M){const B=M>>5;M%=32;const D=k.g.length-B,S=[];for(let F=0;F<D;F++)S[F]=M>0?k.i(F+B)>>>M|k.i(F+B+1)<<32-M:k.i(F+B);return new c(S,k.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,yI=n,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=m,c.fromString=x,Ho=c}).apply(typeof VS<"u"?VS:typeof self<"u"?self:typeof window<"u"?window:{});var fp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var wI,gf,vI,Op,Ew,_I,jI,NI;(function(){var s,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof fp=="object"&&fp];for(var _=0;_<g.length;++_){var C=g[_];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var n=t(this);function a(g,_){if(_)e:{var C=n;g=g.split(".");for(var H=0;H<g.length-1;H++){var ie=g[H];if(!(ie in C))break e;C=C[ie]}g=g[g.length-1],H=C[g],_=_(H),_!=H&&_!=null&&e(C,g,{configurable:!0,writable:!0,value:_})}}a("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(g){return g||function(_){var C=[],H;for(H in _)Object.prototype.hasOwnProperty.call(_,H)&&C.push([H,_[H]]);return C}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},c=this||self;function d(g){var _=typeof g;return _=="object"&&g!=null||_=="function"}function f(g,_,C){return g.call.apply(g.bind,arguments)}function m(g,_,C){return m=f,m.apply(null,arguments)}function x(g,_){var C=Array.prototype.slice.call(arguments,1);return function(){var H=C.slice();return H.push.apply(H,arguments),g.apply(this,H)}}function y(g,_){function C(){}C.prototype=_.prototype,g.Z=_.prototype,g.prototype=new C,g.prototype.constructor=g,g.Ob=function(H,ie,ge){for(var Ve=Array(arguments.length-2),ft=2;ft<arguments.length;ft++)Ve[ft-2]=arguments[ft];return _.prototype[ie].apply(H,Ve)}}var w=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function v(g){const _=g.length;if(_>0){const C=Array(_);for(let H=0;H<_;H++)C[H]=g[H];return C}return[]}function T(g,_){for(let H=1;H<arguments.length;H++){const ie=arguments[H];var C=typeof ie;if(C=C!="object"?C:ie?Array.isArray(ie)?"array":C:"null",C=="array"||C=="object"&&typeof ie.length=="number"){C=g.length||0;const ge=ie.length||0;g.length=C+ge;for(let Ve=0;Ve<ge;Ve++)g[C+Ve]=ie[Ve]}else g.push(ie)}}class I{constructor(_,C){this.i=_,this.j=C,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function N(g){c.setTimeout(()=>{throw g},0)}function P(){var g=k;let _=null;return g.g&&(_=g.g,g.g=g.g.next,g.g||(g.h=null),_.next=null),_}class U{constructor(){this.h=this.g=null}add(_,C){const H=V.get();H.set(_,C),this.h?this.h.next=H:this.g=H,this.h=H}}var V=new I(()=>new q,g=>g.reset());class q{constructor(){this.next=this.g=this.h=null}set(_,C){this.h=_,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let W,z=!1,k=new U,M=()=>{const g=Promise.resolve(void 0);W=()=>{g.then(B)}};function B(){for(var g;g=P();){try{g.h.call(g.g)}catch(C){N(C)}var _=V;_.j(g),_.h<100&&(_.h++,g.next=_.g,_.g=g)}z=!1}function D(){this.u=this.u,this.C=this.C}D.prototype.u=!1,D.prototype.dispose=function(){this.u||(this.u=!0,this.N())},D.prototype[Symbol.dispose]=function(){this.dispose()},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function S(g,_){this.type=g,this.g=this.target=_,this.defaultPrevented=!1}S.prototype.h=function(){this.defaultPrevented=!0};var F=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var g=!1,_=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const C=()=>{};c.addEventListener("test",C,_),c.removeEventListener("test",C,_)}catch{}return g})();function E(g){return/^[\s\xa0]*$/.test(g)}function Y(g,_){S.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,_)}y(Y,S),Y.prototype.init=function(g,_){const C=this.type=g.type,H=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=_,_=g.relatedTarget,_||(C=="mouseover"?_=g.fromElement:C=="mouseout"&&(_=g.toElement)),this.relatedTarget=_,H?(this.clientX=H.clientX!==void 0?H.clientX:H.pageX,this.clientY=H.clientY!==void 0?H.clientY:H.pageY,this.screenX=H.screenX||0,this.screenY=H.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&Y.Z.h.call(this)},Y.prototype.h=function(){Y.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var X="closure_listenable_"+(Math.random()*1e6|0),R=0;function J(g,_,C,H,ie){this.listener=g,this.proxy=null,this.src=_,this.type=C,this.capture=!!H,this.ha=ie,this.key=++R,this.da=this.fa=!1}function O(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function K(g,_,C){for(const H in g)_.call(C,g[H],H,g)}function Q(g,_){for(const C in g)_.call(void 0,g[C],C,g)}function L(g){const _={};for(const C in g)_[C]=g[C];return _}const G="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ee(g,_){let C,H;for(let ie=1;ie<arguments.length;ie++){H=arguments[ie];for(C in H)g[C]=H[C];for(let ge=0;ge<G.length;ge++)C=G[ge],Object.prototype.hasOwnProperty.call(H,C)&&(g[C]=H[C])}}function ne(g){this.src=g,this.g={},this.h=0}ne.prototype.add=function(g,_,C,H,ie){const ge=g.toString();g=this.g[ge],g||(g=this.g[ge]=[],this.h++);const Ve=se(g,_,H,ie);return Ve>-1?(_=g[Ve],C||(_.fa=!1)):(_=new J(_,this.src,ge,!!H,ie),_.fa=C,g.push(_)),_};function je(g,_){const C=_.type;if(C in g.g){var H=g.g[C],ie=Array.prototype.indexOf.call(H,_,void 0),ge;(ge=ie>=0)&&Array.prototype.splice.call(H,ie,1),ge&&(O(_),g.g[C].length==0&&(delete g.g[C],g.h--))}}function se(g,_,C,H){for(let ie=0;ie<g.length;++ie){const ge=g[ie];if(!ge.da&&ge.listener==_&&ge.capture==!!C&&ge.ha==H)return ie}return-1}var _e="closure_lm_"+(Math.random()*1e6|0),Te={};function be(g,_,C,H,ie){if(Array.isArray(_)){for(let ge=0;ge<_.length;ge++)be(g,_[ge],C,H,ie);return null}return C=ce(C),g&&g[X]?g.J(_,C,d(H)?!!H.capture:!1,ie):ye(g,_,C,!1,H,ie)}function ye(g,_,C,H,ie,ge){if(!_)throw Error("Invalid event type");const Ve=d(ie)?!!ie.capture:!!ie;let ft=fe(g);if(ft||(g[_e]=ft=new ne(g)),C=ft.add(_,C,H,Ve,ge),C.proxy)return C;if(H=et(),C.proxy=H,H.src=g,H.listener=C,g.addEventListener)F||(ie=Ve),ie===void 0&&(ie=!1),g.addEventListener(_.toString(),H,ie);else if(g.attachEvent)g.attachEvent(yt(_.toString()),H);else if(g.addListener&&g.removeListener)g.addListener(H);else throw Error("addEventListener and attachEvent are unavailable.");return C}function et(){function g(C){return _.call(g.src,g.listener,C)}const _=Ae;return g}function Je(g,_,C,H,ie){if(Array.isArray(_))for(var ge=0;ge<_.length;ge++)Je(g,_[ge],C,H,ie);else H=d(H)?!!H.capture:!!H,C=ce(C),g&&g[X]?(g=g.i,ge=String(_).toString(),ge in g.g&&(_=g.g[ge],C=se(_,C,H,ie),C>-1&&(O(_[C]),Array.prototype.splice.call(_,C,1),_.length==0&&(delete g.g[ge],g.h--)))):g&&(g=fe(g))&&(_=g.g[_.toString()],g=-1,_&&(g=se(_,C,H,ie)),(C=g>-1?_[g]:null)&&bt(C))}function bt(g){if(typeof g!="number"&&g&&!g.da){var _=g.src;if(_&&_[X])je(_.i,g);else{var C=g.type,H=g.proxy;_.removeEventListener?_.removeEventListener(C,H,g.capture):_.detachEvent?_.detachEvent(yt(C),H):_.addListener&&_.removeListener&&_.removeListener(H),(C=fe(_))?(je(C,g),C.h==0&&(C.src=null,_[_e]=null)):O(g)}}}function yt(g){return g in Te?Te[g]:Te[g]="on"+g}function Ae(g,_){if(g.da)g=!0;else{_=new Y(_,this);const C=g.listener,H=g.ha||g.src;g.fa&&bt(g),g=C.call(H,_)}return g}function fe(g){return g=g[_e],g instanceof ne?g:null}var $e="__closure_events_fn_"+(Math.random()*1e9>>>0);function ce(g){return typeof g=="function"?g:(g[$e]||(g[$e]=function(_){return g.handleEvent(_)}),g[$e])}function Oe(){D.call(this),this.i=new ne(this),this.M=this,this.G=null}y(Oe,D),Oe.prototype[X]=!0,Oe.prototype.removeEventListener=function(g,_,C,H){Je(this,g,_,C,H)};function Pe(g,_){var C,H=g.G;if(H)for(C=[];H;H=H.G)C.push(H);if(g=g.M,H=_.type||_,typeof _=="string")_=new S(_,g);else if(_ instanceof S)_.target=_.target||g;else{var ie=_;_=new S(H,g),ee(_,ie)}ie=!0;let ge,Ve;if(C)for(Ve=C.length-1;Ve>=0;Ve--)ge=_.g=C[Ve],ie=Ge(ge,H,!0,_)&&ie;if(ge=_.g=g,ie=Ge(ge,H,!0,_)&&ie,ie=Ge(ge,H,!1,_)&&ie,C)for(Ve=0;Ve<C.length;Ve++)ge=_.g=C[Ve],ie=Ge(ge,H,!1,_)&&ie}Oe.prototype.N=function(){if(Oe.Z.N.call(this),this.i){var g=this.i;for(const _ in g.g){const C=g.g[_];for(let H=0;H<C.length;H++)O(C[H]);delete g.g[_],g.h--}}this.G=null},Oe.prototype.J=function(g,_,C,H){return this.i.add(String(g),_,!1,C,H)},Oe.prototype.K=function(g,_,C,H){return this.i.add(String(g),_,!0,C,H)};function Ge(g,_,C,H){if(_=g.i.g[String(_)],!_)return!0;_=_.concat();let ie=!0;for(let ge=0;ge<_.length;++ge){const Ve=_[ge];if(Ve&&!Ve.da&&Ve.capture==C){const ft=Ve.listener,Ss=Ve.ha||Ve.src;Ve.fa&&je(g.i,Ve),ie=ft.call(Ss,H)!==!1&&ie}}return ie&&!H.defaultPrevented}function Ke(g,_){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=m(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:c.setTimeout(g,_||0)}function Ie(g){g.g=Ke(()=>{g.g=null,g.i&&(g.i=!1,Ie(g))},g.l);const _=g.h;g.h=null,g.m.apply(null,_)}class Le extends D{constructor(_,C){super(),this.m=_,this.l=C,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:Ie(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Lt(g){D.call(this),this.h=g,this.g={}}y(Lt,D);var bs=[];function Zt(g){K(g.g,function(_,C){this.g.hasOwnProperty(C)&&bt(_)},g),g.g={}}Lt.prototype.N=function(){Lt.Z.N.call(this),Zt(this)},Lt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ws=c.JSON.stringify,Ds=c.JSON.parse,En=class{stringify(g){return c.JSON.stringify(g,void 0)}parse(g){return c.JSON.parse(g,void 0)}};function hr(){}function we(){}var pe={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Re(){S.call(this,"d")}y(Re,S);function he(){S.call(this,"c")}y(he,S);var Me={},ze=null;function tt(){return ze=ze||new Oe}Me.Ia="serverreachability";function Se(g){S.call(this,Me.Ia,g)}y(Se,S);function Fe(g){const _=tt();Pe(_,new Se(_))}Me.STAT_EVENT="statevent";function it(g,_){S.call(this,Me.STAT_EVENT,g),this.stat=_}y(it,S);function at(g){const _=tt();Pe(_,new it(_,g))}Me.Ja="timingevent";function Gt(g,_){S.call(this,Me.Ja,g),this.size=_}y(Gt,S);function Ks(g,_){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){g()},_)}function Mn(){this.g=!0}Mn.prototype.ua=function(){this.g=!1};function $c(g,_,C,H,ie,ge){g.info(function(){if(g.g)if(ge){var Ve="",ft=ge.split("&");for(let Dt=0;Dt<ft.length;Dt++){var Ss=ft[Dt].split("=");if(Ss.length>1){const cs=Ss[0];Ss=Ss[1];const Vr=cs.split("_");Ve=Vr.length>=2&&Vr[1]=="type"?Ve+(cs+"="+Ss+"&"):Ve+(cs+"=redacted&")}}}else Ve=null;else Ve=ge;return"XMLHTTP REQ ("+H+") [attempt "+ie+"]: "+_+`
`+C+`
`+Ve})}function gl(g,_,C,H,ie,ge,Ve){g.info(function(){return"XMLHTTP RESP ("+H+") [ attempt "+ie+"]: "+_+`
`+C+`
`+ge+" "+Ve})}function fr(g,_,C,H){g.info(function(){return"XMLHTTP TEXT ("+_+"): "+pl(g,C)+(H?" "+H:"")})}function Ln(g,_){g.info(function(){return"TIMEOUT: "+_})}Mn.prototype.info=function(){};function pl(g,_){if(!g.g)return _;if(!_)return null;try{const ge=JSON.parse(_);if(ge){for(g=0;g<ge.length;g++)if(Array.isArray(ge[g])){var C=ge[g];if(!(C.length<2)){var H=C[1];if(Array.isArray(H)&&!(H.length<1)){var ie=H[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(let Ve=1;Ve<H.length;Ve++)H[Ve]=""}}}}return Ws(ge)}catch{return _}}var ja={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Na={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Zd;function xl(){}y(xl,hr),xl.prototype.g=function(){return new XMLHttpRequest},Zd=new xl;function li(g){return encodeURIComponent(String(g))}function qm(g){var _=1;g=g.split(":");const C=[];for(;_>0&&g.length;)C.push(g.shift()),_--;return g.length&&C.push(g.join(":")),C}function ea(g,_,C,H){this.j=g,this.i=_,this.l=C,this.S=H||1,this.V=new Lt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ta}function ta(){this.i=null,this.g="",this.h=!1}var Os={},en={};function Sa(g,_,C){g.M=1,g.A=bl(Ms(_)),g.u=C,g.R=!0,Bc(g,null)}function Bc(g,_){g.F=Date.now(),Ta(g),g.B=Ms(g.A);var C=g.B,H=g.S;Array.isArray(H)||(H=[String(H)]),Gc(C.i,"t",H),g.C=0,C=g.j.L,g.h=new ta,g.g=ag(g.j,C?_:null,!g.u),g.P>0&&(g.O=new Le(m(g.Y,g,g.g),g.P)),_=g.V,C=g.g,H=g.ba;var ie="readystatechange";Array.isArray(ie)||(ie&&(bs[0]=ie.toString()),ie=bs);for(let ge=0;ge<ie.length;ge++){const Ve=be(C,ie[ge],H||_.handleEvent,!1,_.h||_);if(!Ve)break;_.g[Ve.key]=Ve}_=g.J?L(g.J):{},g.u?(g.v||(g.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,_)):(g.v="GET",g.g.ea(g.B,g.v,null,_)),Fe(),$c(g.i,g.v,g.B,g.l,g.S,g.u)}ea.prototype.ba=function(g){g=g.target;const _=this.O;_&&ra(g)==3?_.j():this.Y(g)},ea.prototype.Y=function(g){try{if(g==this.g)e:{const ft=ra(this.g),Ss=this.g.ya(),Dt=this.g.ca();if(!(ft<3)&&(ft!=3||this.g&&(this.h.h||this.g.la()||dn(this.g)))){this.K||ft!=4||Ss==7||(Ss==8||Dt<=0?Fe(3):Fe(2)),Ea(this);var _=this.g.ca();this.X=_;var C=Tx(this);if(this.o=_==200,gl(this.i,this.v,this.B,this.l,this.S,ft,_),this.o){if(this.U&&!this.L){t:{if(this.g){var H,ie=this.g;if((H=ie.g?ie.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(H)){var ge=H;break t}}ge=null}if(g=ge)fr(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ia(this,g);else{this.o=!1,this.m=3,at(12),mr(this),Pr(this);break e}}if(this.R){g=!0;let cs;for(;!this.K&&this.C<C.length;)if(cs=Gm(this,C),cs==en){ft==4&&(this.m=4,at(14),g=!1),fr(this.i,this.l,null,"[Incomplete Response]");break}else if(cs==Os){this.m=4,at(15),fr(this.i,this.l,C,"[Invalid Chunk]"),g=!1;break}else fr(this.i,this.l,cs,null),Ia(this,cs);if(Hm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ft!=4||C.length!=0||this.h.h||(this.m=1,at(16),g=!1),this.o=this.o&&g,!g)fr(this.i,this.l,C,"[Invalid Chunked Response]"),mr(this),Pr(this);else if(C.length>0&&!this.W){this.W=!0;var Ve=this.j;Ve.g==this&&Ve.aa&&!Ve.P&&(Ve.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),mh(Ve),Ve.P=!0,at(11))}}else fr(this.i,this.l,C,null),Ia(this,C);ft==4&&mr(this),this.o&&!this.K&&(ft==4?tg(this.j,this):(this.o=!1,Ta(this)))}else ui(this.g),_==400&&C.indexOf("Unknown SID")>0?(this.m=3,at(12)):(this.m=0,at(13)),mr(this),Pr(this)}}}catch{}finally{}};function Tx(g){if(!Hm(g))return g.g.la();const _=dn(g.g);if(_==="")return"";let C="";const H=_.length,ie=ra(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return mr(g),Pr(g),"";g.h.i=new c.TextDecoder}for(let ge=0;ge<H;ge++)g.h.h=!0,C+=g.h.i.decode(_[ge],{stream:!(ie&&ge==H-1)});return _.length=0,g.h.g+=C,g.C=0,g.h.g}function Hm(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function Gm(g,_){var C=g.C,H=_.indexOf(`
`,C);return H==-1?en:(C=Number(_.substring(C,H)),isNaN(C)?Os:(H+=1,H+C>_.length?en:(_=_.slice(H,H+C),g.C=H+C,_)))}ea.prototype.cancel=function(){this.K=!0,mr(this)};function Ta(g){g.T=Date.now()+g.H,zc(g,g.H)}function zc(g,_){if(g.D!=null)throw Error("WatchDog timer not null");g.D=Ks(m(g.aa,g),_)}function Ea(g){g.D&&(c.clearTimeout(g.D),g.D=null)}ea.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(Ln(this.i,this.B),this.M!=2&&(Fe(),at(17)),mr(this),this.m=2,Pr(this)):zc(this,this.T-g)};function Pr(g){g.j.I==0||g.K||tg(g.j,g)}function mr(g){Ea(g);var _=g.O;_&&typeof _.dispose=="function"&&_.dispose(),g.O=null,Zt(g.V),g.g&&(_=g.g,g.g=null,_.abort(),_.dispose())}function Ia(g,_){try{var C=g.j;if(C.I!=0&&(C.g==g||ka(C.h,g))){if(!g.L&&ka(C.h,g)&&C.I==3){try{var H=C.Ba.g.parse(_)}catch{H=null}if(Array.isArray(H)&&H.length==3){var ie=H;if(ie[0]==0){e:if(!C.v){if(C.g)if(C.g.F+3e3<g.F)Jc(C),oo(C);else break e;Sl(C),at(18)}}else C.xa=ie[1],0<C.xa-C.K&&ie[2]<37500&&C.F&&C.A==0&&!C.C&&(C.C=Ks(m(C.Va,C),6e3));Aa(C.h)<=1&&C.ta&&(C.ta=void 0)}else Ma(C,11)}else if((g.L||C.g==g)&&Jc(C),!E(_))for(ie=C.Ba.g.parse(_),_=0;_<ie.length;_++){let Dt=ie[_];const cs=Dt[0];if(!(cs<=C.K))if(C.K=cs,Dt=Dt[1],C.I==2)if(Dt[0]=="c"){C.M=Dt[1],C.ba=Dt[2];const Vr=Dt[3];Vr!=null&&(C.ka=Vr,C.j.info("VER="+C.ka));const La=Dt[4];La!=null&&(C.za=La,C.j.info("SVER="+C.za));const aa=Dt[5];aa!=null&&typeof aa=="number"&&aa>0&&(H=1.5*aa,C.O=H,C.j.info("backChannelRequestTimeoutMs_="+H)),H=C;const ia=g.g;if(ia){const Tl=ia.g?ia.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Tl){var ge=H.h;ge.g||Tl.indexOf("spdy")==-1&&Tl.indexOf("quic")==-1&&Tl.indexOf("h2")==-1||(ge.j=ge.l,ge.g=new Set,ge.h&&(sh(ge,ge.h),ge.h=null))}if(H.G){const Xc=ia.g?ia.g.getResponseHeader("X-HTTP-Session-Id"):null;Xc&&(H.wa=Xc,Vt(H.J,H.G,Xc))}}C.I=3,C.l&&C.l.ra(),C.aa&&(C.T=Date.now()-g.F,C.j.info("Handshake RTT: "+C.T+"ms")),H=C;var Ve=g;if(H.na=rg(H,H.L?H.ba:null,H.W),Ve.L){nh(H.h,Ve);var ft=Ve,Ss=H.O;Ss&&(ft.H=Ss),ft.D&&(Ea(ft),Ta(ft)),H.g=Ve}else Zm(H);C.i.length>0&&Pa(C)}else Dt[0]!="stop"&&Dt[0]!="close"||Ma(C,7);else C.I==3&&(Dt[0]=="stop"||Dt[0]=="close"?Dt[0]=="stop"?Ma(C,7):hh(C):Dt[0]!="noop"&&C.l&&C.l.qa(Dt),C.A=0)}}Fe(4)}catch{}}var Ps=class{constructor(g,_){this.g=g,this.map=_}};function eh(g){this.l=g||10,c.PerformanceNavigationTiming?(g=c.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function th(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function Aa(g){return g.h?1:g.g?g.g.size:0}function ka(g,_){return g.h?g.h==_:g.g?g.g.has(_):!1}function sh(g,_){g.g?g.g.add(_):g.h=_}function nh(g,_){g.h&&g.h==_?g.h=null:g.g&&g.g.has(_)&&g.g.delete(_)}eh.prototype.cancel=function(){if(this.i=rh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function rh(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let _=g.i;for(const C of g.g.values())_=_.concat(C.G);return _}return v(g.i)}var Wm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function qc(g,_){if(g){g=g.split("&");for(let C=0;C<g.length;C++){const H=g[C].indexOf("=");let ie,ge=null;H>=0?(ie=g[C].substring(0,H),ge=g[C].substring(H+1)):ie=g[C],_(ie,ge?decodeURIComponent(ge.replace(/\+/g," ")):"")}}}function gr(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;g instanceof gr?(this.l=g.l,tn(this,g.j),this.o=g.o,this.g=g.g,eo(this,g.u),this.h=g.h,ah(this,Jm(g.i)),this.m=g.m):g&&(_=String(g).match(Wm))?(this.l=!1,tn(this,_[1]||"",!0),this.o=Ca(_[2]||""),this.g=Ca(_[3]||"",!0),eo(this,_[4]),this.h=Ca(_[5]||"",!0),ah(this,_[6]||"",!0),this.m=Ca(_[7]||"")):(this.l=!1,this.i=new so(null,this.l))}gr.prototype.toString=function(){const g=[];var _=this.j;_&&g.push(yl(_,Hc,!0),":");var C=this.g;return(C||_=="file")&&(g.push("//"),(_=this.o)&&g.push(yl(_,Hc,!0),"@"),g.push(li(C).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.u,C!=null&&g.push(":",String(C))),(C=this.h)&&(this.g&&C.charAt(0)!="/"&&g.push("/"),g.push(yl(C,C.charAt(0)=="/"?ih:Km,!0))),(C=this.i.toString())&&g.push("?",C),(C=this.m)&&g.push("#",yl(C,Qm)),g.join("")},gr.prototype.resolve=function(g){const _=Ms(this);let C=!!g.j;C?tn(_,g.j):C=!!g.o,C?_.o=g.o:C=!!g.g,C?_.g=g.g:C=g.u!=null;var H=g.h;if(C)eo(_,g.u);else if(C=!!g.h){if(H.charAt(0)!="/")if(this.g&&!this.h)H="/"+H;else{var ie=_.h.lastIndexOf("/");ie!=-1&&(H=_.h.slice(0,ie+1)+H)}if(ie=H,ie==".."||ie==".")H="";else if(ie.indexOf("./")!=-1||ie.indexOf("/.")!=-1){H=ie.lastIndexOf("/",0)==0,ie=ie.split("/");const ge=[];for(let Ve=0;Ve<ie.length;){const ft=ie[Ve++];ft=="."?H&&Ve==ie.length&&ge.push(""):ft==".."?((ge.length>1||ge.length==1&&ge[0]!="")&&ge.pop(),H&&Ve==ie.length&&ge.push("")):(ge.push(ft),H=!0)}H=ge.join("/")}else H=ie}return C?_.h=H:C=g.i.toString()!=="",C?ah(_,Jm(g.i)):C=!!g.m,C&&(_.m=g.m),_};function Ms(g){return new gr(g)}function tn(g,_,C){g.j=C?Ca(_,!0):_,g.j&&(g.j=g.j.replace(/:$/,""))}function eo(g,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);g.u=_}else g.u=null}function ah(g,_,C){_ instanceof so?(g.i=_,Wc(g.i,g.l)):(C||(_=yl(_,to)),g.i=new so(_,g.l))}function Vt(g,_,C){g.i.set(_,C)}function bl(g){return Vt(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function Ca(g,_){return g?_?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function yl(g,_,C){return typeof g=="string"?(g=encodeURI(g).replace(_,Yn),C&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Yn(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var Hc=/[#\/\?@]/g,Km=/[#\?:]/g,ih=/[#\?]/g,to=/[#\?@]/g,Qm=/#/g;function so(g,_){this.h=this.g=null,this.i=g||null,this.j=!!_}function Jn(g){g.g||(g.g=new Map,g.h=0,g.i&&qc(g.i,function(_,C){g.add(decodeURIComponent(_.replace(/\+/g," ")),C)}))}s=so.prototype,s.add=function(g,_){Jn(this),this.i=null,g=no(this,g);let C=this.g.get(g);return C||this.g.set(g,C=[]),C.push(_),this.h+=1,this};function Ym(g,_){Jn(g),_=no(g,_),g.g.has(_)&&(g.i=null,g.h-=g.g.get(_).length,g.g.delete(_))}function oh(g,_){return Jn(g),_=no(g,_),g.g.has(_)}s.forEach=function(g,_){Jn(this),this.g.forEach(function(C,H){C.forEach(function(ie){g.call(_,ie,H,this)},this)},this)};function lh(g,_){Jn(g);let C=[];if(typeof _=="string")oh(g,_)&&(C=C.concat(g.g.get(no(g,_))));else for(g=Array.from(g.g.values()),_=0;_<g.length;_++)C=C.concat(g[_]);return C}s.set=function(g,_){return Jn(this),this.i=null,g=no(this,g),oh(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[_]),this.h+=1,this},s.get=function(g,_){return g?(g=lh(this,g),g.length>0?String(g[0]):_):_};function Gc(g,_,C){Ym(g,_),C.length>0&&(g.i=null,g.g.set(no(g,_),v(C)),g.h+=C.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],_=Array.from(this.g.keys());for(let H=0;H<_.length;H++){var C=_[H];const ie=li(C);C=lh(this,C);for(let ge=0;ge<C.length;ge++){let Ve=ie;C[ge]!==""&&(Ve+="="+li(C[ge])),g.push(Ve)}}return this.i=g.join("&")};function Jm(g){const _=new so;return _.i=g.i,g.g&&(_.g=new Map(g.g),_.h=g.h),_}function no(g,_){return _=String(_),g.j&&(_=_.toLowerCase()),_}function Wc(g,_){_&&!g.j&&(Jn(g),g.i=null,g.g.forEach(function(C,H){const ie=H.toLowerCase();H!=ie&&(Ym(this,H),Gc(this,ie,C))},g)),g.j=_}function sa(g,_){const C=new Mn;if(c.Image){const H=new Image;H.onload=x(Mr,C,"TestLoadImage: loaded",!0,_,H),H.onerror=x(Mr,C,"TestLoadImage: error",!1,_,H),H.onabort=x(Mr,C,"TestLoadImage: abort",!1,_,H),H.ontimeout=x(Mr,C,"TestLoadImage: timeout",!1,_,H),c.setTimeout(function(){H.ontimeout&&H.ontimeout()},1e4),H.src=g}else _(!1)}function ch(g,_){const C=new Mn,H=new AbortController,ie=setTimeout(()=>{H.abort(),Mr(C,"TestPingServer: timeout",!1,_)},1e4);fetch(g,{signal:H.signal}).then(ge=>{clearTimeout(ie),ge.ok?Mr(C,"TestPingServer: ok",!0,_):Mr(C,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(ie),Mr(C,"TestPingServer: error",!1,_)})}function Mr(g,_,C,H,ie){try{ie&&(ie.onload=null,ie.onerror=null,ie.onabort=null,ie.ontimeout=null),H(C)}catch{}}function ro(){this.g=new En}function Ra(g){this.i=g.Sb||null,this.h=g.ab||!1}y(Ra,hr),Ra.prototype.g=function(){return new wl(this.i,this.h)};function wl(g,_){Oe.call(this),this.H=g,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}y(wl,Oe),s=wl.prototype,s.open=function(g,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=_,this.readyState=1,na(this)},s.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(_.body=g),(this.H||c).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ao(this)),this.readyState=0},s.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,na(this)),this.g&&(this.readyState=3,na(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Kc(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function Kc(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}s.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var _=g.value?g.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!g.done}))&&(this.response=this.responseText+=_)}g.done?ao(this):na(this),this.readyState==3&&Kc(this)}},s.Oa=function(g){this.g&&(this.response=this.responseText=g,ao(this))},s.Na=function(g){this.g&&(this.response=g,ao(this))},s.ga=function(){this.g&&ao(this)};function ao(g){g.readyState=4,g.l=null,g.j=null,g.B=null,na(g)}s.setRequestHeader=function(g,_){this.A.append(g,_)},s.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],_=this.h.entries();for(var C=_.next();!C.done;)C=C.value,g.push(C[0]+": "+C[1]),C=_.next();return g.join(`\r
`)};function na(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(wl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Lr(g){let _="";return K(g,function(C,H){_+=H,_+=":",_+=C,_+=`\r
`}),_}function vl(g,_,C){e:{for(H in C){var H=!1;break e}H=!0}H||(C=Lr(C),typeof g=="string"?C!=null&&li(C):Vt(g,_,C))}function Wt(g){Oe.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}y(Wt,Oe);var Da=/^https?$/i,uh=["POST","PUT"];s=Wt.prototype,s.Fa=function(g){this.H=g},s.ea=function(g,_,C,H){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);_=_?_.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Zd.g(),this.g.onreadystatechange=w(m(this.Ca,this));try{this.B=!0,this.g.open(_,String(g),!0),this.B=!1}catch(ge){_l(this,ge);return}if(g=C||"",C=new Map(this.headers),H)if(Object.getPrototypeOf(H)===Object.prototype)for(var ie in H)C.set(ie,H[ie]);else if(typeof H.keys=="function"&&typeof H.get=="function")for(const ge of H.keys())C.set(ge,H.get(ge));else throw Error("Unknown input type for opt_headers: "+String(H));H=Array.from(C.keys()).find(ge=>ge.toLowerCase()=="content-type"),ie=c.FormData&&g instanceof c.FormData,!(Array.prototype.indexOf.call(uh,_,void 0)>=0)||H||ie||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ge,Ve]of C)this.g.setRequestHeader(ge,Ve);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(ge){_l(this,ge)}};function _l(g,_){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=_,g.o=5,dh(g),ci(g)}function dh(g){g.A||(g.A=!0,Pe(g,"complete"),Pe(g,"error"))}s.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,Pe(this,"complete"),Pe(this,"abort"),ci(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ci(this,!0)),Wt.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?jl(this):this.Xa())},s.Xa=function(){jl(this)};function jl(g){if(g.h&&typeof l<"u"){if(g.v&&ra(g)==4)setTimeout(g.Ca.bind(g),0);else if(Pe(g,"readystatechange"),ra(g)==4){g.h=!1;try{const ge=g.ca();e:switch(ge){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var C;if(!(C=_)){var H;if(H=ge===0){let Ve=String(g.D).match(Wm)[1]||null;!Ve&&c.self&&c.self.location&&(Ve=c.self.location.protocol.slice(0,-1)),H=!Da.test(Ve?Ve.toLowerCase():"")}C=H}if(C)Pe(g,"complete"),Pe(g,"success");else{g.o=6;try{var ie=ra(g)>2?g.g.statusText:""}catch{ie=""}g.l=ie+" ["+g.ca()+"]",dh(g)}}finally{ci(g)}}}}function ci(g,_){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const C=g.g;g.g=null,_||Pe(g,"ready");try{C.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function ra(g){return g.g?g.g.readyState:0}s.ca=function(){try{return ra(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(g){if(this.g){var _=this.g.responseText;return g&&_.indexOf(g)==0&&(_=_.substring(g.length)),Ds(_)}};function dn(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function ui(g){const _={};g=(g.g&&ra(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let H=0;H<g.length;H++){if(E(g[H]))continue;var C=qm(g[H]);const ie=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const ge=_[ie]||[];_[ie]=ge,ge.push(C)}Q(_,function(H){return H.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Oa(g,_,C){return C&&C.internalChannelParams&&C.internalChannelParams[g]||_}function io(g){this.za=0,this.i=[],this.j=new Mn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Oa("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Oa("baseRetryDelayMs",5e3,g),this.Za=Oa("retryDelaySeedMs",1e4,g),this.Ta=Oa("forwardChannelMaxRetries",2,g),this.va=Oa("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new eh(g&&g.concurrentRequestLimit),this.Ba=new ro,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=io.prototype,s.ka=8,s.I=1,s.connect=function(g,_,C,H){at(0),this.W=g,this.H=_||{},C&&H!==void 0&&(this.H.OSID=C,this.H.OAID=H),this.F=this.X,this.J=rg(this,null,this.W),Pa(this)};function hh(g){if(Qc(g),g.I==3){var _=g.V++,C=Ms(g.J);if(Vt(C,"SID",g.M),Vt(C,"RID",_),Vt(C,"TYPE","terminate"),Nl(g,C),_=new ea(g,g.j,_),_.M=2,_.A=bl(Ms(C)),C=!1,c.navigator&&c.navigator.sendBeacon)try{C=c.navigator.sendBeacon(_.A.toString(),"")}catch{}!C&&c.Image&&(new Image().src=_.A,C=!0),C||(_.g=ag(_.j,null),_.g.ea(_.A)),_.F=Date.now(),Ta(_)}ng(g)}function oo(g){g.g&&(mh(g),g.g.cancel(),g.g=null)}function Qc(g){oo(g),g.v&&(c.clearTimeout(g.v),g.v=null),Jc(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&c.clearTimeout(g.m),g.m=null)}function Pa(g){if(!th(g.h)&&!g.m){g.m=!0;var _=g.Ea;W||M(),z||(W(),z=!0),k.add(_,g),g.D=0}}function Yc(g,_){return Aa(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=_.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=Ks(m(g.Ea,g,_),sg(g,g.D)),g.D++,!0)}s.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const ie=new ea(this,this.j,g);let ge=this.o;if(this.U&&(ge?(ge=L(ge),ee(ge,this.U)):ge=this.U),this.u!==null||this.R||(ie.J=ge,ge=null),this.S)e:{for(var _=0,C=0;C<this.i.length;C++){t:{var H=this.i[C];if("__data__"in H.map&&(H=H.map.__data__,typeof H=="string")){H=H.length;break t}H=void 0}if(H===void 0)break;if(_+=H,_>4096){_=C;break e}if(_===4096||C===this.i.length-1){_=C+1;break e}}_=1e3}else _=1e3;_=Xm(this,ie,_),C=Ms(this.J),Vt(C,"RID",g),Vt(C,"CVER",22),this.G&&Vt(C,"X-HTTP-Session-Id",this.G),Nl(this,C),ge&&(this.R?_="headers="+li(Lr(ge))+"&"+_:this.u&&vl(C,this.u,ge)),sh(this.h,ie),this.Ra&&Vt(C,"TYPE","init"),this.S?(Vt(C,"$req",_),Vt(C,"SID","null"),ie.U=!0,Sa(ie,C,null)):Sa(ie,C,_),this.I=2}}else this.I==3&&(g?fh(this,g):this.i.length==0||th(this.h)||fh(this))};function fh(g,_){var C;_?C=_.l:C=g.V++;const H=Ms(g.J);Vt(H,"SID",g.M),Vt(H,"RID",C),Vt(H,"AID",g.K),Nl(g,H),g.u&&g.o&&vl(H,g.u,g.o),C=new ea(g,g.j,C,g.D+1),g.u===null&&(C.J=g.o),_&&(g.i=_.G.concat(g.i)),_=Xm(g,C,1e3),C.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),sh(g.h,C),Sa(C,H,_)}function Nl(g,_){g.H&&K(g.H,function(C,H){Vt(_,H,C)}),g.l&&K({},function(C,H){Vt(_,H,C)})}function Xm(g,_,C){C=Math.min(g.i.length,C);const H=g.l?m(g.l.Ka,g.l,g):null;e:{var ie=g.i;let ft=-1;for(;;){const Ss=["count="+C];ft==-1?C>0?(ft=ie[0].g,Ss.push("ofs="+ft)):ft=0:Ss.push("ofs="+ft);let Dt=!0;for(let cs=0;cs<C;cs++){var ge=ie[cs].g;const Vr=ie[cs].map;if(ge-=ft,ge<0)ft=Math.max(0,ie[cs].g-100),Dt=!1;else try{ge="req"+ge+"_"||"";try{var Ve=Vr instanceof Map?Vr:Object.entries(Vr);for(const[La,aa]of Ve){let ia=aa;d(aa)&&(ia=Ws(aa)),Ss.push(ge+La+"="+encodeURIComponent(ia))}}catch(La){throw Ss.push(ge+"type="+encodeURIComponent("_badmap")),La}}catch{H&&H(Vr)}}if(Dt){Ve=Ss.join("&");break e}}Ve=void 0}return g=g.i.splice(0,C),_.G=g,Ve}function Zm(g){if(!g.g&&!g.v){g.Y=1;var _=g.Da;W||M(),z||(W(),z=!0),k.add(_,g),g.A=0}}function Sl(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=Ks(m(g.Da,g),sg(g,g.A)),g.A++,!0)}s.Da=function(){if(this.v=null,eg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=Ks(m(this.Wa,this),g)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,at(10),oo(this),eg(this))};function mh(g){g.B!=null&&(c.clearTimeout(g.B),g.B=null)}function eg(g){g.g=new ea(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var _=Ms(g.na);Vt(_,"RID","rpc"),Vt(_,"SID",g.M),Vt(_,"AID",g.K),Vt(_,"CI",g.F?"0":"1"),!g.F&&g.ia&&Vt(_,"TO",g.ia),Vt(_,"TYPE","xmlhttp"),Nl(g,_),g.u&&g.o&&vl(_,g.u,g.o),g.O&&(g.g.H=g.O);var C=g.g;g=g.ba,C.M=1,C.A=bl(Ms(_)),C.u=null,C.R=!0,Bc(C,g)}s.Va=function(){this.C!=null&&(this.C=null,oo(this),Sl(this),at(19))};function Jc(g){g.C!=null&&(c.clearTimeout(g.C),g.C=null)}function tg(g,_){var C=null;if(g.g==_){Jc(g),mh(g),g.g=null;var H=2}else if(ka(g.h,_))C=_.G,nh(g.h,_),H=1;else return;if(g.I!=0){if(_.o)if(H==1){C=_.u?_.u.length:0,_=Date.now()-_.F;var ie=g.D;H=tt(),Pe(H,new Gt(H,C)),Pa(g)}else Zm(g);else if(ie=_.m,ie==3||ie==0&&_.X>0||!(H==1&&Yc(g,_)||H==2&&Sl(g)))switch(C&&C.length>0&&(_=g.h,_.i=_.i.concat(C)),ie){case 1:Ma(g,5);break;case 4:Ma(g,10);break;case 3:Ma(g,6);break;default:Ma(g,2)}}}function sg(g,_){let C=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(C*=2),C*_}function Ma(g,_){if(g.j.info("Error code "+_),_==2){var C=m(g.bb,g),H=g.Ua;const ie=!H;H=new gr(H||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||tn(H,"https"),bl(H),ie?sa(H.toString(),C):ch(H.toString(),C)}else at(2);g.I=0,g.l&&g.l.pa(_),ng(g),Qc(g)}s.bb=function(g){g?(this.j.info("Successfully pinged google.com"),at(2)):(this.j.info("Failed to ping google.com"),at(1))};function ng(g){if(g.I=0,g.ja=[],g.l){const _=rh(g.h);(_.length!=0||g.i.length!=0)&&(T(g.ja,_),T(g.ja,g.i),g.h.i.length=0,v(g.i),g.i.length=0),g.l.oa()}}function rg(g,_,C){var H=C instanceof gr?Ms(C):new gr(C);if(H.g!="")_&&(H.g=_+"."+H.g),eo(H,H.u);else{var ie=c.location;H=ie.protocol,_=_?_+"."+ie.hostname:ie.hostname,ie=+ie.port;const ge=new gr(null);H&&tn(ge,H),_&&(ge.g=_),ie&&eo(ge,ie),C&&(ge.h=C),H=ge}return C=g.G,_=g.wa,C&&_&&Vt(H,C,_),Vt(H,"VER",g.ka),Nl(g,H),H}function ag(g,_,C){if(_&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=g.Aa&&!g.ma?new Wt(new Ra({ab:C})):new Wt(g.ma),_.Fa(g.L),_}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function ig(){}s=ig.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function lo(){}lo.prototype.g=function(g,_){return new Vn(g,_)};function Vn(g,_){Oe.call(this),this.g=new io(_),this.l=g,this.h=_&&_.messageUrlParams||null,g=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(g?g["X-WebChannel-Content-Type"]=_.messageContentType:g={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(g?g["X-WebChannel-Client-Profile"]=_.sa:g={"X-WebChannel-Client-Profile":_.sa}),this.g.U=g,(g=_&&_.Qb)&&!E(g)&&(this.g.u=g),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!E(_)&&(this.g.G=_,g=this.h,g!==null&&_ in g&&(g=this.h,_ in g&&delete g[_])),this.j=new di(this)}y(Vn,Oe),Vn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Vn.prototype.close=function(){hh(this.g)},Vn.prototype.o=function(g){var _=this.g;if(typeof g=="string"){var C={};C.__data__=g,g=C}else this.v&&(C={},C.__data__=Ws(g),g=C);_.i.push(new Ps(_.Ya++,g)),_.I==3&&Pa(_)},Vn.prototype.N=function(){this.g.l=null,delete this.j,hh(this.g),delete this.g,Vn.Z.N.call(this)};function og(g){Re.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var _=g.__sm__;if(_){e:{for(const C in _){g=C;break e}g=void 0}(this.i=g)&&(g=this.i,_=_!==null&&g in _?_[g]:void 0),this.data=_}else this.data=g}y(og,Re);function lg(){he.call(this),this.status=1}y(lg,he);function di(g){this.g=g}y(di,ig),di.prototype.ra=function(){Pe(this.g,"a")},di.prototype.qa=function(g){Pe(this.g,new og(g))},di.prototype.pa=function(g){Pe(this.g,new lg)},di.prototype.oa=function(){Pe(this.g,"b")},lo.prototype.createWebChannel=lo.prototype.g,Vn.prototype.send=Vn.prototype.o,Vn.prototype.open=Vn.prototype.m,Vn.prototype.close=Vn.prototype.close,NI=function(){return new lo},jI=function(){return tt()},_I=Me,Ew={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ja.NO_ERROR=0,ja.TIMEOUT=8,ja.HTTP_ERROR=6,Op=ja,Na.COMPLETE="complete",vI=Na,we.EventType=pe,pe.OPEN="a",pe.CLOSE="b",pe.ERROR="c",pe.MESSAGE="d",Oe.prototype.listen=Oe.prototype.J,gf=we,Wt.prototype.listenOnce=Wt.prototype.K,Wt.prototype.getLastError=Wt.prototype.Ha,Wt.prototype.getLastErrorCode=Wt.prototype.ya,Wt.prototype.getStatus=Wt.prototype.ca,Wt.prototype.getResponseJson=Wt.prototype.La,Wt.prototype.getResponseText=Wt.prototype.la,Wt.prototype.send=Wt.prototype.ea,Wt.prototype.setWithCredentials=Wt.prototype.Fa,wI=Wt}).apply(typeof fp<"u"?fp:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};rn.UNAUTHENTICATED=new rn(null),rn.GOOGLE_CREDENTIALS=new rn("google-credentials-uid"),rn.FIRST_PARTY=new rn("first-party-uid"),rn.MOCK_USER=new rn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $d="12.8.0";function WP(s){$d=s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zo=new O0("@firebase/firestore");function Gu(){return Zo.logLevel}function KP(s){Zo.setLogLevel(s)}function Ce(s,...e){if(Zo.logLevel<=jt.DEBUG){const t=e.map(Gv);Zo.debug(`Firestore (${$d}): ${s}`,...t)}}function As(s,...e){if(Zo.logLevel<=jt.ERROR){const t=e.map(Gv);Zo.error(`Firestore (${$d}): ${s}`,...t)}}function ri(s,...e){if(Zo.logLevel<=jt.WARN){const t=e.map(Gv);Zo.warn(`Firestore (${$d}): ${s}`,...t)}}function Gv(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qe(s,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,SI(s,n,t)}function SI(s,e,t){let n=`FIRESTORE (${$d}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw As(n),new Error(n)}function Qe(s,e,t,n){let a="Unexpected state";typeof t=="string"?a=t:n=t,s||SI(e,a,n)}function QP(s,e){s||qe(57014,e)}function Be(s,e){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ke extends wn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TI{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class YP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(rn.UNAUTHENTICATED)))}shutdown(){}}class JP{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class XP{constructor(e){this.t=e,this.currentUser=rn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Qe(this.o===void 0,42304);let n=this.i;const a=f=>this.i!==n?(n=this.i,t(f)):Promise.resolve();let l=new _n;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new _n,e.enqueueRetryable((()=>a(this.currentUser)))};const c=()=>{const f=l;e.enqueueRetryable((async()=>{await f.promise,await a(this.currentUser)}))},d=f=>{Ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((f=>d(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?d(f):(Ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new _n)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?(Ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Qe(typeof n.accessToken=="string",31837,{l:n}),new TI(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Qe(e===null||typeof e=="string",2055,{h:e}),new rn(e)}}class ZP{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=rn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class e6{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new ZP(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(rn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class US{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class t6{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,is(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Qe(this.o===void 0,3512);const n=l=>{l.error!=null&&Ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,Ce("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>n(l)))};const a=l=>{Ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new US(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Qe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new US(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s6(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<s;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=s6(40);for(let l=0;l<a.length;++l)n.length<20&&a[l]<t&&(n+=e.charAt(a[l]%62))}return n}}function dt(s,e){return s<e?-1:s>e?1:0}function Iw(s,e){const t=Math.min(s.length,e.length);for(let n=0;n<t;n++){const a=s.charAt(n),l=e.charAt(n);if(a!==l)return Oy(a)===Oy(l)?dt(a,l):Oy(a)?1:-1}return dt(s.length,e.length)}const n6=55296,r6=57343;function Oy(s){const e=s.charCodeAt(0);return e>=n6&&e<=r6}function pd(s,e,t){return s.length===e.length&&s.every(((n,a)=>t(n,e[a])))}function EI(s){return s+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FS="__name__";class qa{constructor(e,t,n){t===void 0?t=0:t>e.length&&qe(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&qe(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return qa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof qa?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let a=0;a<n;a++){const l=qa.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return dt(e.length,t.length)}static compareSegments(e,t){const n=qa.isNumericId(e),a=qa.isNumericId(t);return n&&!a?-1:!n&&a?1:n&&a?qa.extractNumericId(e).compare(qa.extractNumericId(t)):Iw(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ho.fromString(e.substring(4,e.length-2))}}class Nt extends qa{construct(e,t,n){return new Nt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new ke(me.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((a=>a.length>0)))}return new Nt(t)}static emptyPath(){return new Nt([])}}const a6=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class hs extends qa{construct(e,t,n){return new hs(e,t,n)}static isValidIdentifier(e){return a6.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),hs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===FS}static keyField(){return new hs([FS])}static fromServerFormat(e){const t=[];let n="",a=0;const l=()=>{if(n.length===0)throw new ke(me.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let c=!1;for(;a<e.length;){const d=e[a];if(d==="\\"){if(a+1===e.length)throw new ke(me.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[a+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new ke(me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=f,a+=2}else d==="`"?(c=!c,a++):d!=="."||c?(n+=d,a++):(l(),a++)}if(l(),c)throw new ke(me.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new hs(t)}static emptyPath(){return new hs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e){this.path=e}static fromPath(e){return new Ue(Nt.fromString(e))}static fromName(e){return new Ue(Nt.fromString(e).popFirst(5))}static empty(){return new Ue(Nt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Nt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Nt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ue(new Nt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kv(s,e,t){if(!t)throw new ke(me.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function II(s,e,t,n){if(e===!0&&n===!0)throw new ke(me.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function $S(s){if(!Ue.isDocumentKey(s))throw new ke(me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function BS(s){if(Ue.isDocumentKey(s))throw new ke(me.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function AI(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function M0(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":qe(12329,{type:typeof s})}function Rt(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new ke(me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=M0(s);throw new ke(me.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function kI(s,e){if(e<=0)throw new ke(me.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hs(s,e){const t={typeString:s};return e&&(t.value=e),t}function vm(s,e){if(!AI(s))throw new ke(me.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const a=e[n].typeString,l="value"in e[n]?{value:e[n].value}:void 0;if(!(n in s)){t=`JSON missing required field: '${n}'`;break}const c=s[n];if(a&&typeof c!==a){t=`JSON field '${n}' must be a ${a}.`;break}if(l!==void 0&&c!==l.value){t=`Expected '${n}' field to equal '${l.value}'`;break}}if(t)throw new ke(me.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zS=-62135596800,qS=1e6;class Mt{static now(){return Mt.fromMillis(Date.now())}static fromDate(e){return Mt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*qS);return new Mt(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ke(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ke(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<zS)throw new ke(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ke(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/qS}_compareTo(e){return this.seconds===e.seconds?dt(this.nanoseconds,e.nanoseconds):dt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Mt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(vm(e,Mt._jsonSchema))return new Mt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-zS;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Mt._jsonSchemaVersion="firestore/timestamp/1.0",Mt._jsonSchema={type:Hs("string",Mt._jsonSchemaVersion),seconds:Hs("number"),nanoseconds:Hs("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{static fromTimestamp(e){return new Xe(e)}static min(){return new Xe(new Mt(0,0))}static max(){return new Xe(new Mt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xd=-1;class Zp{constructor(e,t,n,a){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=a}}function Aw(s){return s.fields.find((e=>e.kind===2))}function Wl(s){return s.fields.filter((e=>e.kind!==2))}Zp.UNKNOWN_ID=-1;class Pp{constructor(e,t){this.fieldPath=e,this.kind=t}}class Hf{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Hf(0,Or.min())}}function CI(s,e){const t=s.toTimestamp().seconds,n=s.toTimestamp().nanoseconds+1,a=Xe.fromTimestamp(n===1e9?new Mt(t+1,0):new Mt(t,n));return new Or(a,Ue.empty(),e)}function RI(s){return new Or(s.readTime,s.key,xd)}class Or{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Or(Xe.min(),Ue.empty(),xd)}static max(){return new Or(Xe.max(),Ue.empty(),xd)}}function Qv(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=Ue.comparator(s.documentKey,e.documentKey),t!==0?t:dt(s.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class OI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ll(s){if(s.code!==me.FAILED_PRECONDITION||s.message!==DI)throw s;Ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&qe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ae(((n,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(n,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(n,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ae?t:ae.resolve(t)}catch(t){return ae.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.reject(t)}static resolve(e){return new ae(((t,n)=>{t(e)}))}static reject(e){return new ae(((t,n)=>{n(e)}))}static waitFor(e){return new ae(((t,n)=>{let a=0,l=0,c=!1;e.forEach((d=>{++a,d.next((()=>{++l,c&&l===a&&t()}),(f=>n(f)))})),c=!0,l===a&&t()}))}static or(e){let t=ae.resolve(!1);for(const n of e)t=t.next((a=>a?ae.resolve(a):n()));return t}static forEach(e,t){const n=[];return e.forEach(((a,l)=>{n.push(t.call(this,a,l))})),this.waitFor(n)}static mapArray(e,t){return new ae(((n,a)=>{const l=e.length,c=new Array(l);let d=0;for(let f=0;f<l;f++){const m=f;t(e[m]).next((x=>{c[m]=x,++d,d===l&&n(c)}),(x=>a(x)))}}))}static doWhile(e,t){return new ae(((n,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):n()};l()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nr="SimpleDb";class L0{static open(e,t,n,a){try{return new L0(t,e.transaction(a,n))}catch(l){throw new Nf(t,l)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new _n,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Nf(e,t.error)):this.S.resolve()},this.transaction.onerror=n=>{const a=Yv(n.target.error);this.S.reject(new Nf(e,a))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ce(Nr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new o6(t)}}class ei{static delete(e){return Ce(Nr,"Removing database:",e),Yl(Pv().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!mc())return!1;if(ei.F())return!0;const e=ps(),t=ei.M(e),n=0<t&&t<10,a=PI(e),l=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||l)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.N=n,this.B=null,ei.M(ps())===12.2&&As("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Ce(Nr,"Opening database:",this.name),this.db=await new Promise(((t,n)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=l=>{const c=l.target.result;t(c)},a.onblocked=()=>{n(new Nf(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=l=>{const c=l.target.error;c.name==="VersionError"?n(new ke(me.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):c.name==="InvalidStateError"?n(new ke(me.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c)):n(new Nf(e,c))},a.onupgradeneeded=l=>{Ce(Nr,'Database "'+this.name+'" requires upgrade from version:',l.oldVersion);const c=l.target.result;this.N.k(c,a.transaction,l.oldVersion,this.version).next((()=>{Ce(Nr,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,a){const l=t==="readonly";let c=0;for(;;){++c;try{this.db=await this.L(e);const d=L0.open(this.db,e,l?"readonly":"readwrite",n),f=a(d).next((m=>(d.C(),m))).catch((m=>(d.abort(m),ae.reject(m)))).toPromise();return f.catch((()=>{})),await d.D,f}catch(d){const f=d,m=f.name!=="FirebaseError"&&c<3;if(Ce(Nr,"Transaction failed with error:",f.message,"Retrying:",m),this.close(),!m)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function PI(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class i6{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return Yl(this.U.delete())}}class Nf extends ke{constructor(e,t){super(me.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function cl(s){return s.name==="IndexedDbTransactionError"}class o6{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(Ce(Nr,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(Ce(Nr,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Yl(n)}add(e){return Ce(Nr,"ADD",this.store.name,e,e),Yl(this.store.add(e))}get(e){return Yl(this.store.get(e)).next((t=>(t===void 0&&(t=null),Ce(Nr,"GET",this.store.name,e,t),t)))}delete(e){return Ce(Nr,"DELETE",this.store.name,e),Yl(this.store.delete(e))}count(){return Ce(Nr,"COUNT",this.store.name),Yl(this.store.count())}H(e,t){const n=this.options(e,t),a=n.index?this.store.index(n.index):this.store;if(typeof a.getAll=="function"){const l=a.getAll(n.range);return new ae(((c,d)=>{l.onerror=f=>{d(f.target.error)},l.onsuccess=f=>{c(f.target.result)}}))}{const l=this.cursor(n),c=[];return this.J(l,((d,f)=>{c.push(f)})).next((()=>c))}}Z(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new ae(((a,l)=>{n.onerror=c=>{l(c.target.error)},n.onsuccess=c=>{a(c.target.result)}}))}X(e,t){Ce(Nr,"DELETE ALL",this.store.name);const n=this.options(e,t);n.Y=!1;const a=this.cursor(n);return this.J(a,((l,c,d)=>d.delete()))}ee(e,t){let n;t?n=e:(n={},t=e);const a=this.cursor(n);return this.J(a,t)}te(e){const t=this.cursor({});return new ae(((n,a)=>{t.onerror=l=>{const c=Yv(l.target.error);a(c)},t.onsuccess=l=>{const c=l.target.result;c?e(c.primaryKey,c.value).next((d=>{d?c.continue():n()})):n()}}))}J(e,t){const n=[];return new ae(((a,l)=>{e.onerror=c=>{l(c.target.error)},e.onsuccess=c=>{const d=c.target.result;if(!d)return void a();const f=new i6(d),m=t(d.primaryKey,d.value,f);if(m instanceof ae){const x=m.catch((y=>(f.done(),ae.reject(y))));n.push(x)}f.isDone?a():f.G===null?d.continue():d.continue(f.G)}})).next((()=>ae.waitFor(n)))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Yl(s){return new ae(((e,t)=>{s.onsuccess=n=>{const a=n.target.result;e(a)},s.onerror=n=>{const a=Yv(n.target.error);t(a)}}))}let HS=!1;function Yv(s){const e=ei.M(ps());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(s.message.indexOf(t)>=0){const n=new ke("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return HS||(HS=!0,setTimeout((()=>{throw n}),0)),n}}return s}const Sf="IndexBackfiller";class l6{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Ce(Sf,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Ce(Sf,`Documents written: ${t}`)}catch(t){cl(t)?Ce(Sf,"Ignoring IndexedDB error during index backfill: ",t):await ll(t)}await this.re(6e4)}))}}class c6{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const n=new Set;let a=t,l=!0;return ae.doWhile((()=>l===!0&&a>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((c=>{if(c!==null&&!n.has(c))return Ce(Sf,`Processing collection: ${c}`),this.oe(e,c,a).next((d=>{a-=d,n.add(c)}));l=!1})))).next((()=>t-a))}oe(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((a=>this.localStore.localDocuments.getNextDocuments(e,t,a,n).next((l=>{const c=l.changes;return this.localStore.indexManager.updateIndexEntries(e,c).next((()=>this._e(a,l))).next((d=>(Ce(Sf,`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d)))).next((()=>c.size))}))))}_e(e,t){let n=e;return t.changes.forEach(((a,l)=>{const c=RI(l);Qv(c,n)>0&&(n=c)})),new Or(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ar.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Go=-1;function _m(s){return s==null}function Gf(s){return s===0&&1/s==-1/0}function MI(s){return typeof s=="number"&&Number.isInteger(s)&&!Gf(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e0="";function On(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=GS(e)),e=u6(s.get(t),e);return GS(e)}function u6(s,e){let t=e;const n=s.length;for(let a=0;a<n;a++){const l=s.charAt(a);switch(l){case"\0":t+="";break;case e0:t+="";break;default:t+=l}}return t}function GS(s){return s+e0+""}function Ja(s){const e=s.length;if(Qe(e>=2,64408,{path:s}),e===2)return Qe(s.charAt(0)===e0&&s.charAt(1)==="",56145,{path:s}),Nt.emptyPath();const t=e-2,n=[];let a="";for(let l=0;l<e;){const c=s.indexOf(e0,l);switch((c<0||c>t)&&qe(50515,{path:s}),s.charAt(c+1)){case"":const d=s.substring(l,c);let f;a.length===0?f=d:(a+=d,f=a,a=""),n.push(f);break;case"":a+=s.substring(l,c),a+="\0";break;case"":a+=s.substring(l,c+1);break;default:qe(61167,{path:s})}l=c+2}return new Nt(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kl="remoteDocuments",jm="owner",Au="owner",Wf="mutationQueues",d6="userId",ha="mutations",WS="batchId",nc="userMutationsIndex",KS=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mp(s,e){return[s,On(e)]}function LI(s,e,t){return[s,On(e),t]}const h6={},bd="documentMutations",t0="remoteDocumentsV14",f6=["prefixPath","collectionGroup","readTime","documentId"],Lp="documentKeyIndex",m6=["prefixPath","collectionGroup","documentId"],VI="collectionGroupIndex",g6=["collectionGroup","readTime","prefixPath","documentId"],Kf="remoteDocumentGlobal",kw="remoteDocumentGlobalKey",yd="targets",UI="queryTargetsIndex",p6=["canonicalId","targetId"],wd="targetDocuments",x6=["targetId","path"],Jv="documentTargetsIndex",b6=["path","targetId"],s0="targetGlobalKey",uc="targetGlobal",Qf="collectionParents",y6=["collectionId","parent"],vd="clientMetadata",w6="clientId",V0="bundles",v6="bundleId",U0="namedQueries",_6="name",Xv="indexConfiguration",j6="indexId",Cw="collectionGroupIndex",N6="collectionGroup",Tf="indexState",S6=["indexId","uid"],FI="sequenceNumberIndex",T6=["uid","sequenceNumber"],Ef="indexEntries",E6=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],$I="documentKeyIndex",I6=["indexId","uid","orderedDocumentKey"],F0="documentOverlays",A6=["userId","collectionPath","documentId"],Rw="collectionPathOverlayIndex",k6=["userId","collectionPath","largestBatchId"],BI="collectionGroupOverlayIndex",C6=["userId","collectionGroup","largestBatchId"],Zv="globals",R6="name",zI=[Wf,ha,bd,Kl,yd,jm,uc,wd,vd,Kf,Qf,V0,U0],D6=[...zI,F0],qI=[Wf,ha,bd,t0,yd,jm,uc,wd,vd,Kf,Qf,V0,U0,F0],HI=qI,e_=[...HI,Xv,Tf,Ef],O6=e_,GI=[...e_,Zv],P6=GI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dw extends OI{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Zs(s,e){const t=Be(s);return ei.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QS(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function ul(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function WI(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e,t){this.comparator=e,this.root=t||bn.EMPTY}insert(e,t){return new ss(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,bn.BLACK,null,null))}remove(e){return new ss(this.comparator,this.root.remove(e,this.comparator).copy(null,null,bn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return t+n.left.size;a<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new mp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new mp(this.root,e,this.comparator,!1)}getReverseIterator(){return new mp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new mp(this.root,e,this.comparator,!0)}}class mp{constructor(e,t,n,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?n(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class bn{constructor(e,t,n,a,l){this.key=e,this.value=t,this.color=n??bn.RED,this.left=a??bn.EMPTY,this.right=l??bn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,a,l){return new bn(e??this.key,t??this.value,n??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let a=this;const l=n(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,n),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return bn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return bn.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,bn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,bn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw qe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw qe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw qe(27949);return e+(this.isRed()?0:1)}}bn.EMPTY=null,bn.RED=!0,bn.BLACK=!1;bn.EMPTY=new class{constructor(){this.size=0}get key(){throw qe(57766)}get value(){throw qe(16141)}get color(){throw qe(16727)}get left(){throw qe(29726)}get right(){throw qe(36894)}copy(e,t,n,a,l){return this}insert(e,t,n){return new bn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e){this.comparator=e,this.data=new ss(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new YS(this.data.getIterator())}getIteratorFrom(e){return new YS(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof qt)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=n.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new qt(this.comparator);return t.data=e,t}}class YS{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ku(s){return s.hasNext()?s.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e){this.fields=e,e.sort(hs.comparator)}static empty(){return new ir([])}unionWith(e){let t=new qt(hs.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new ir(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return pd(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M6(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new KI("Invalid base64 string: "+l):l}})(e);return new _s(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return l})(e);return new _s(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let a=0;a<t.length;a++)n[a]=t.charCodeAt(a);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return dt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_s.EMPTY_BYTE_STRING=new _s("");const L6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $i(s){if(Qe(!!s,39018),typeof s=="string"){let e=0;const t=L6.exec(s);if(Qe(!!t,46558,{timestamp:s}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(s);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ds(s.seconds),nanos:ds(s.nanos)}}function ds(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Bi(s){return typeof s=="string"?_s.fromBase64String(s):_s.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QI="server_timestamp",YI="__type__",JI="__previous_value__",XI="__local_write_time__";function $0(s){var t,n;return((n=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[YI])==null?void 0:n.stringValue)===QI}function B0(s){const e=s.mapValue.fields[JI];return $0(e)?B0(e):e}function Yf(s){const e=$i(s.mapValue.fields[XI].timestampValue);return new Mt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V6{constructor(e,t,n,a,l,c,d,f,m,x,y){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=a,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=d,this.longPollingOptions=f,this.useFetchStreams=m,this.isUsingEmulator=x,this.apiKey=y}}const Ow="(default)";class el{constructor(e,t){this.projectId=e,this.database=t||Ow}static empty(){return new el("","")}get isDefaultDatabase(){return this.database===Ow}isEqual(e){return e instanceof el&&e.projectId===this.projectId&&e.database===this.database}}function U6(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new ke(me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new el(s.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_="__type__",ZI="__max__",$o={mapValue:{fields:{__type__:{stringValue:ZI}}}},s_="__vector__",_d="value",Vp={nullValue:"NULL_VALUE"};function tl(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?$0(s)?4:eA(s)?9007199254740991:z0(s)?10:11:qe(28295,{value:s})}function ai(s,e){if(s===e)return!0;const t=tl(s);if(t!==tl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Yf(s).isEqual(Yf(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const c=$i(a.timestampValue),d=$i(l.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(a,l){return Bi(a.bytesValue).isEqual(Bi(l.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(a,l){return ds(a.geoPointValue.latitude)===ds(l.geoPointValue.latitude)&&ds(a.geoPointValue.longitude)===ds(l.geoPointValue.longitude)})(s,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return ds(a.integerValue)===ds(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const c=ds(a.doubleValue),d=ds(l.doubleValue);return c===d?Gf(c)===Gf(d):isNaN(c)&&isNaN(d)}return!1})(s,e);case 9:return pd(s.arrayValue.values||[],e.arrayValue.values||[],ai);case 10:case 11:return(function(a,l){const c=a.mapValue.fields||{},d=l.mapValue.fields||{};if(QS(c)!==QS(d))return!1;for(const f in c)if(c.hasOwnProperty(f)&&(d[f]===void 0||!ai(c[f],d[f])))return!1;return!0})(s,e);default:return qe(52216,{left:s})}}function Jf(s,e){return(s.values||[]).find((t=>ai(t,e)))!==void 0}function sl(s,e){if(s===e)return 0;const t=tl(s),n=tl(e);if(t!==n)return dt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return dt(s.booleanValue,e.booleanValue);case 2:return(function(l,c){const d=ds(l.integerValue||l.doubleValue),f=ds(c.integerValue||c.doubleValue);return d<f?-1:d>f?1:d===f?0:isNaN(d)?isNaN(f)?0:-1:1})(s,e);case 3:return JS(s.timestampValue,e.timestampValue);case 4:return JS(Yf(s),Yf(e));case 5:return Iw(s.stringValue,e.stringValue);case 6:return(function(l,c){const d=Bi(l),f=Bi(c);return d.compareTo(f)})(s.bytesValue,e.bytesValue);case 7:return(function(l,c){const d=l.split("/"),f=c.split("/");for(let m=0;m<d.length&&m<f.length;m++){const x=dt(d[m],f[m]);if(x!==0)return x}return dt(d.length,f.length)})(s.referenceValue,e.referenceValue);case 8:return(function(l,c){const d=dt(ds(l.latitude),ds(c.latitude));return d!==0?d:dt(ds(l.longitude),ds(c.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return XS(s.arrayValue,e.arrayValue);case 10:return(function(l,c){var w,v,T,I;const d=l.fields||{},f=c.fields||{},m=(w=d[_d])==null?void 0:w.arrayValue,x=(v=f[_d])==null?void 0:v.arrayValue,y=dt(((T=m==null?void 0:m.values)==null?void 0:T.length)||0,((I=x==null?void 0:x.values)==null?void 0:I.length)||0);return y!==0?y:XS(m,x)})(s.mapValue,e.mapValue);case 11:return(function(l,c){if(l===$o.mapValue&&c===$o.mapValue)return 0;if(l===$o.mapValue)return 1;if(c===$o.mapValue)return-1;const d=l.fields||{},f=Object.keys(d),m=c.fields||{},x=Object.keys(m);f.sort(),x.sort();for(let y=0;y<f.length&&y<x.length;++y){const w=Iw(f[y],x[y]);if(w!==0)return w;const v=sl(d[f[y]],m[x[y]]);if(v!==0)return v}return dt(f.length,x.length)})(s.mapValue,e.mapValue);default:throw qe(23264,{he:t})}}function JS(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return dt(s,e);const t=$i(s),n=$i(e),a=dt(t.seconds,n.seconds);return a!==0?a:dt(t.nanos,n.nanos)}function XS(s,e){const t=s.values||[],n=e.values||[];for(let a=0;a<t.length&&a<n.length;++a){const l=sl(t[a],n[a]);if(l)return l}return dt(t.length,n.length)}function jd(s){return Pw(s)}function Pw(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const n=$i(t);return`time(${n.seconds},${n.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return Bi(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return Ue.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let n="[",a=!0;for(const l of t.values||[])a?a=!1:n+=",",n+=Pw(l);return n+"]"})(s.arrayValue):"mapValue"in s?(function(t){const n=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const c of n)l?l=!1:a+=",",a+=`${c}:${Pw(t.fields[c])}`;return a+"}"})(s.mapValue):qe(61005,{value:s})}function Up(s){switch(tl(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=B0(s);return e?16+Up(e):16;case 5:return 2*s.stringValue.length;case 6:return Bi(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((a,l)=>a+Up(l)),0)})(s.arrayValue);case 10:case 11:return(function(n){let a=0;return ul(n.fields,((l,c)=>{a+=l.length+Up(c)})),a})(s.mapValue);default:throw qe(13486,{value:s})}}function gc(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function Mw(s){return!!s&&"integerValue"in s}function Xf(s){return!!s&&"arrayValue"in s}function ZS(s){return!!s&&"nullValue"in s}function eT(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Fp(s){return!!s&&"mapValue"in s}function z0(s){var t,n;return((n=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[t_])==null?void 0:n.stringValue)===s_}function If(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return ul(s.mapValue.fields,((t,n)=>e.mapValue.fields[t]=If(n))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=If(s.arrayValue.values[t]);return e}return{...s}}function eA(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===ZI}const tA={mapValue:{fields:{[t_]:{stringValue:s_},[_d]:{arrayValue:{}}}}};function F6(s){return"nullValue"in s?Vp:"booleanValue"in s?{booleanValue:!1}:"integerValue"in s||"doubleValue"in s?{doubleValue:NaN}:"timestampValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in s?{stringValue:""}:"bytesValue"in s?{bytesValue:""}:"referenceValue"in s?gc(el.empty(),Ue.empty()):"geoPointValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in s?{arrayValue:{}}:"mapValue"in s?z0(s)?tA:{mapValue:{}}:qe(35942,{value:s})}function $6(s){return"nullValue"in s?{booleanValue:!1}:"booleanValue"in s?{doubleValue:NaN}:"integerValue"in s||"doubleValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in s?{stringValue:""}:"stringValue"in s?{bytesValue:""}:"bytesValue"in s?gc(el.empty(),Ue.empty()):"referenceValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in s?{arrayValue:{}}:"arrayValue"in s?tA:"mapValue"in s?z0(s)?{mapValue:{}}:$o:qe(61959,{value:s})}function tT(s,e){const t=sl(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?-1:!s.inclusive&&e.inclusive?1:0}function sT(s,e){const t=sl(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?1:!s.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this.value=e}static empty(){return new yn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Fp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=If(t)}setAll(e){let t=hs.emptyPath(),n={},a=[];e.forEach(((c,d)=>{if(!t.isImmediateParentOf(d)){const f=this.getFieldsMap(t);this.applyChanges(f,n,a),n={},a=[],t=d.popLast()}c?n[d.lastSegment()]=If(c):a.push(d.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,n,a)}delete(e){const t=this.field(e.popLast());Fp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ai(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=t.mapValue.fields[e.get(n)];Fp(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,n){ul(t,((a,l)=>e[a]=l));for(const a of n)delete e[a]}clone(){return new yn(If(this.value))}}function sA(s){const e=[];return ul(s.fields,((t,n)=>{const a=new hs([t]);if(Fp(n)){const l=sA(n.mapValue).fields;if(l.length===0)e.push(a);else for(const c of l)e.push(a.child(c))}else e.push(a)})),new ir(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e,t,n,a,l,c,d){this.key=e,this.documentType=t,this.version=n,this.readTime=a,this.createTime=l,this.data=c,this.documentState=d}static newInvalidDocument(e){return new as(e,0,Xe.min(),Xe.min(),Xe.min(),yn.empty(),0)}static newFoundDocument(e,t,n,a){return new as(e,1,t,Xe.min(),n,a,0)}static newNoDocument(e,t){return new as(e,2,t,Xe.min(),Xe.min(),yn.empty(),0)}static newUnknownDocument(e,t){return new as(e,3,t,Xe.min(),Xe.min(),yn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=yn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=yn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof as&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new as(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,t){this.position=e,this.inclusive=t}}function nT(s,e,t){let n=0;for(let a=0;a<s.position.length;a++){const l=e[a],c=s.position[a];if(l.field.isKeyField()?n=Ue.comparator(Ue.fromName(c.referenceValue),t.key):n=sl(c,t.data.field(l.field)),l.dir==="desc"&&(n*=-1),n!==0)break}return n}function rT(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!ai(s.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zf{constructor(e,t="asc"){this.field=e,this.dir=t}}function B6(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{}class Et extends nA{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new z6(e,t,n):t==="array-contains"?new G6(e,n):t==="in"?new cA(e,n):t==="not-in"?new W6(e,n):t==="array-contains-any"?new K6(e,n):new Et(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new q6(e,n):new H6(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(sl(t,this.value)):t!==null&&tl(this.value)===tl(t)&&this.matchesComparison(sl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return qe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class $t extends nA{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new $t(e,t)}matches(e){return Nd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Nd(s){return s.op==="and"}function Lw(s){return s.op==="or"}function n_(s){return rA(s)&&Nd(s)}function rA(s){for(const e of s.filters)if(e instanceof $t)return!1;return!0}function Vw(s){if(s instanceof Et)return s.field.canonicalString()+s.op.toString()+jd(s.value);if(n_(s))return s.filters.map((e=>Vw(e))).join(",");{const e=s.filters.map((t=>Vw(t))).join(",");return`${s.op}(${e})`}}function aA(s,e){return s instanceof Et?(function(n,a){return a instanceof Et&&n.op===a.op&&n.field.isEqual(a.field)&&ai(n.value,a.value)})(s,e):s instanceof $t?(function(n,a){return a instanceof $t&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce(((l,c,d)=>l&&aA(c,a.filters[d])),!0):!1})(s,e):void qe(19439)}function iA(s,e){const t=s.filters.concat(e);return $t.create(t,s.op)}function oA(s){return s instanceof Et?(function(t){return`${t.field.canonicalString()} ${t.op} ${jd(t.value)}`})(s):s instanceof $t?(function(t){return t.op.toString()+" {"+t.getFilters().map(oA).join(" ,")+"}"})(s):"Filter"}class z6 extends Et{constructor(e,t,n){super(e,t,n),this.key=Ue.fromName(n.referenceValue)}matches(e){const t=Ue.comparator(e.key,this.key);return this.matchesComparison(t)}}class q6 extends Et{constructor(e,t){super(e,"in",t),this.keys=lA("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class H6 extends Et{constructor(e,t){super(e,"not-in",t),this.keys=lA("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function lA(s,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((n=>Ue.fromName(n.referenceValue)))}class G6 extends Et{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Xf(t)&&Jf(t.arrayValue,this.value)}}class cA extends Et{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Jf(this.value.arrayValue,t)}}class W6 extends Et{constructor(e,t){super(e,"not-in",t)}matches(e){if(Jf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Jf(this.value.arrayValue,t)}}class K6 extends Et{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Xf(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>Jf(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q6{constructor(e,t=null,n=[],a=[],l=null,c=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=a,this.limit=l,this.startAt=c,this.endAt=d,this.Te=null}}function Uw(s,e=null,t=[],n=[],a=null,l=null,c=null){return new Q6(s,e,t,n,a,l,c)}function pc(s){const e=Be(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>Vw(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(l){return l.field.canonicalString()+l.dir})(n))).join(","),_m(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>jd(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>jd(n))).join(",")),e.Te=t}return e.Te}function Nm(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!B6(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!aA(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!rT(s.startAt,e.startAt)&&rT(s.endAt,e.endAt)}function n0(s){return Ue.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function r0(s,e){return s.filters.filter((t=>t instanceof Et&&t.field.isEqual(e)))}function aT(s,e,t){let n=Vp,a=!0;for(const l of r0(s,e)){let c=Vp,d=!0;switch(l.op){case"<":case"<=":c=F6(l.value);break;case"==":case"in":case">=":c=l.value;break;case">":c=l.value,d=!1;break;case"!=":case"not-in":c=Vp}tT({value:n,inclusive:a},{value:c,inclusive:d})<0&&(n=c,a=d)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const c=t.position[l];tT({value:n,inclusive:a},{value:c,inclusive:t.inclusive})<0&&(n=c,a=t.inclusive);break}}return{value:n,inclusive:a}}function iT(s,e,t){let n=$o,a=!0;for(const l of r0(s,e)){let c=$o,d=!0;switch(l.op){case">=":case">":c=$6(l.value),d=!1;break;case"==":case"in":case"<=":c=l.value;break;case"<":c=l.value,d=!1;break;case"!=":case"not-in":c=$o}sT({value:n,inclusive:a},{value:c,inclusive:d})>0&&(n=c,a=d)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const c=t.position[l];sT({value:n,inclusive:a},{value:c,inclusive:t.inclusive})>0&&(n=c,a=t.inclusive);break}}return{value:n,inclusive:a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e,t=null,n=[],a=[],l=null,c="F",d=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=a,this.limit=l,this.limitType=c,this.startAt=d,this.endAt=f,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function uA(s,e,t,n,a,l,c,d){return new Gi(s,e,t,n,a,l,c,d)}function Bd(s){return new Gi(s)}function oT(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function Y6(s){return Ue.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function r_(s){return s.collectionGroup!==null}function ad(s){const e=Be(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let d=new qt(hs.comparator);return c.filters.forEach((f=>{f.getFlattenedFilters().forEach((m=>{m.isInequality()&&(d=d.add(m.field))}))})),d})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Zf(l,n))})),t.has(hs.keyField().canonicalString())||e.Ie.push(new Zf(hs.keyField(),n))}return e.Ie}function Hn(s){const e=Be(s);return e.Ee||(e.Ee=J6(e,ad(s))),e.Ee}function J6(s,e){if(s.limitType==="F")return Uw(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Zf(a.field,l)}));const t=s.endAt?new nl(s.endAt.position,s.endAt.inclusive):null,n=s.startAt?new nl(s.startAt.position,s.startAt.inclusive):null;return Uw(s.path,s.collectionGroup,e,s.filters,s.limit,t,n)}}function Fw(s,e){const t=s.filters.concat([e]);return new Gi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function X6(s,e){const t=s.explicitOrderBy.concat([e]);return new Gi(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function a0(s,e,t){return new Gi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function Z6(s,e){return new Gi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,e,s.endAt)}function eM(s,e){return new Gi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,e)}function Sm(s,e){return Nm(Hn(s),Hn(e))&&s.limitType===e.limitType}function dA(s){return`${pc(Hn(s))}|lt:${s.limitType}`}function Wu(s){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((a=>oA(a))).join(", ")}]`),_m(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((a=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(a))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((a=>jd(a))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((a=>jd(a))).join(",")),`Target(${n})`})(Hn(s))}; limitType=${s.limitType})`}function Tm(s,e){return e.isFoundDocument()&&(function(n,a){const l=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(l):Ue.isDocumentKey(n.path)?n.path.isEqual(l):n.path.isImmediateParentOf(l)})(s,e)&&(function(n,a){for(const l of ad(n))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(s,e)&&(function(n,a){for(const l of n.filters)if(!l.matches(a))return!1;return!0})(s,e)&&(function(n,a){return!(n.startAt&&!(function(c,d,f){const m=nT(c,d,f);return c.inclusive?m<=0:m<0})(n.startAt,ad(n),a)||n.endAt&&!(function(c,d,f){const m=nT(c,d,f);return c.inclusive?m>=0:m>0})(n.endAt,ad(n),a))})(s,e)}function hA(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function fA(s){return(e,t)=>{let n=!1;for(const a of ad(s)){const l=tM(a,e,t);if(l!==0)return l;n=n||a.field.isKeyField()}return 0}}function tM(s,e,t){const n=s.field.isKeyField()?Ue.comparator(e.key,t.key):(function(l,c,d){const f=c.data.field(l),m=d.data.field(l);return f!==null&&m!==null?sl(f,m):qe(42886)})(s.field,e,t);switch(s.dir){case"asc":return n;case"desc":return-1*n;default:return qe(19790,{direction:s.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[a,l]of n)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[t]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){ul(this.inner,((t,n)=>{for(const[a,l]of n)e(a,l)}))}isEmpty(){return WI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sM=new ss(Ue.comparator);function or(){return sM}const mA=new ss(Ue.comparator);function pf(...s){let e=mA;for(const t of s)e=e.insert(t.key,t);return e}function gA(s){let e=mA;return s.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Xa(){return Af()}function pA(){return Af()}function Af(){return new Wi((s=>s.toString()),((s,e)=>s.isEqual(e)))}const nM=new ss(Ue.comparator),rM=new qt(Ue.comparator);function gt(...s){let e=rM;for(const t of s)e=e.add(t);return e}const aM=new qt(dt);function a_(){return aM}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i_(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Gf(e)?"-0":e}}function xA(s){return{integerValue:""+s}}function bA(s,e){return MI(e)?xA(e):i_(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0{constructor(){this._=void 0}}function iM(s,e,t){return s instanceof Sd?(function(a,l){const c={fields:{[YI]:{stringValue:QI},[XI]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&$0(l)&&(l=B0(l)),l&&(c.fields[JI]=l),{mapValue:c}})(t,e):s instanceof xc?wA(s,e):s instanceof bc?vA(s,e):(function(a,l){const c=yA(a,l),d=lT(c)+lT(a.Ae);return Mw(c)&&Mw(a.Ae)?xA(d):i_(a.serializer,d)})(s,e)}function oM(s,e,t){return s instanceof xc?wA(s,e):s instanceof bc?vA(s,e):t}function yA(s,e){return s instanceof Td?(function(n){return Mw(n)||(function(l){return!!l&&"doubleValue"in l})(n)})(e)?e:{integerValue:0}:null}class Sd extends q0{}class xc extends q0{constructor(e){super(),this.elements=e}}function wA(s,e){const t=_A(e);for(const n of s.elements)t.some((a=>ai(a,n)))||t.push(n);return{arrayValue:{values:t}}}class bc extends q0{constructor(e){super(),this.elements=e}}function vA(s,e){let t=_A(e);for(const n of s.elements)t=t.filter((a=>!ai(a,n)));return{arrayValue:{values:t}}}class Td extends q0{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function lT(s){return ds(s.integerValue||s.doubleValue)}function _A(s){return Xf(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Em{constructor(e,t){this.field=e,this.transform=t}}function lM(s,e){return s.field.isEqual(e.field)&&(function(n,a){return n instanceof xc&&a instanceof xc||n instanceof bc&&a instanceof bc?pd(n.elements,a.elements,ai):n instanceof Td&&a instanceof Td?ai(n.Ae,a.Ae):n instanceof Sd&&a instanceof Sd})(s.transform,e.transform)}class cM{constructor(e,t){this.version=e,this.transformResults=t}}class fs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new fs}static exists(e){return new fs(void 0,e)}static updateTime(e){return new fs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function $p(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class H0{}function jA(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new qd(s.key,fs.none()):new zd(s.key,s.data,fs.none());{const t=s.data,n=yn.empty();let a=new qt(hs.comparator);for(let l of e.fields)if(!a.has(l)){let c=t.field(l);c===null&&l.length>1&&(l=l.popLast(),c=t.field(l)),c===null?n.delete(l):n.set(l,c),a=a.add(l)}return new Ki(s.key,n,new ir(a.toArray()),fs.none())}}function uM(s,e,t){s instanceof zd?(function(a,l,c){const d=a.value.clone(),f=uT(a.fieldTransforms,l,c.transformResults);d.setAll(f),l.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(s,e,t):s instanceof Ki?(function(a,l,c){if(!$p(a.precondition,l))return void l.convertToUnknownDocument(c.version);const d=uT(a.fieldTransforms,l,c.transformResults),f=l.data;f.setAll(NA(a)),f.setAll(d),l.convertToFoundDocument(c.version,f).setHasCommittedMutations()})(s,e,t):(function(a,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function kf(s,e,t,n){return s instanceof zd?(function(l,c,d,f){if(!$p(l.precondition,c))return d;const m=l.value.clone(),x=dT(l.fieldTransforms,f,c);return m.setAll(x),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),null})(s,e,t,n):s instanceof Ki?(function(l,c,d,f){if(!$p(l.precondition,c))return d;const m=dT(l.fieldTransforms,f,c),x=c.data;return x.setAll(NA(l)),x.setAll(m),c.convertToFoundDocument(c.version,x).setHasLocalMutations(),d===null?null:d.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((y=>y.field)))})(s,e,t,n):(function(l,c,d){return $p(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d})(s,e,t)}function dM(s,e){let t=null;for(const n of s.fieldTransforms){const a=e.data.field(n.field),l=yA(n.transform,a||null);l!=null&&(t===null&&(t=yn.empty()),t.set(n.field,l))}return t||null}function cT(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&pd(n,a,((l,c)=>lM(l,c)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class zd extends H0{constructor(e,t,n,a=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Ki extends H0{constructor(e,t,n,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function NA(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=s.data.field(t);e.set(t,n)}})),e}function uT(s,e,t){const n=new Map;Qe(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let a=0;a<t.length;a++){const l=s[a],c=l.transform,d=e.data.field(l.field);n.set(l.field,oM(c,d,t[a]))}return n}function dT(s,e,t){const n=new Map;for(const a of s){const l=a.transform,c=t.data.field(a.field);n.set(a.field,iM(l,c,e))}return n}class qd extends H0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class o_ extends H0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(e,t,n,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&uM(l,e,n[a])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=kf(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=kf(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=pA();return this.mutations.forEach((a=>{const l=e.get(a.key),c=l.overlayedDocument;let d=this.applyToLocalView(c,l.mutatedFields);d=t.has(a.key)?null:d;const f=jA(c,d);f!==null&&n.set(a.key,f),c.isValidDocument()||c.convertToNoDocument(Xe.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),gt())}isEqual(e){return this.batchId===e.batchId&&pd(this.mutations,e.mutations,((t,n)=>cT(t,n)))&&pd(this.baseMutations,e.baseMutations,((t,n)=>cT(t,n)))}}class c_{constructor(e,t,n,a){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=a}static from(e,t,n){Qe(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let a=(function(){return nM})();const l=e.mutations;for(let c=0;c<l.length;c++)a=a.insert(l[c].key,n[c].version);return new c_(e,t,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $s,At;function SA(s){switch(s){case me.OK:return qe(64938);case me.CANCELLED:case me.UNKNOWN:case me.DEADLINE_EXCEEDED:case me.RESOURCE_EXHAUSTED:case me.INTERNAL:case me.UNAVAILABLE:case me.UNAUTHENTICATED:return!1;case me.INVALID_ARGUMENT:case me.NOT_FOUND:case me.ALREADY_EXISTS:case me.PERMISSION_DENIED:case me.FAILED_PRECONDITION:case me.ABORTED:case me.OUT_OF_RANGE:case me.UNIMPLEMENTED:case me.DATA_LOSS:return!0;default:return qe(15467,{code:s})}}function TA(s){if(s===void 0)return As("GRPC error has no .code"),me.UNKNOWN;switch(s){case $s.OK:return me.OK;case $s.CANCELLED:return me.CANCELLED;case $s.UNKNOWN:return me.UNKNOWN;case $s.DEADLINE_EXCEEDED:return me.DEADLINE_EXCEEDED;case $s.RESOURCE_EXHAUSTED:return me.RESOURCE_EXHAUSTED;case $s.INTERNAL:return me.INTERNAL;case $s.UNAVAILABLE:return me.UNAVAILABLE;case $s.UNAUTHENTICATED:return me.UNAUTHENTICATED;case $s.INVALID_ARGUMENT:return me.INVALID_ARGUMENT;case $s.NOT_FOUND:return me.NOT_FOUND;case $s.ALREADY_EXISTS:return me.ALREADY_EXISTS;case $s.PERMISSION_DENIED:return me.PERMISSION_DENIED;case $s.FAILED_PRECONDITION:return me.FAILED_PRECONDITION;case $s.ABORTED:return me.ABORTED;case $s.OUT_OF_RANGE:return me.OUT_OF_RANGE;case $s.UNIMPLEMENTED:return me.UNIMPLEMENTED;case $s.DATA_LOSS:return me.DATA_LOSS;default:return qe(39323,{code:s})}}(At=$s||($s={}))[At.OK=0]="OK",At[At.CANCELLED=1]="CANCELLED",At[At.UNKNOWN=2]="UNKNOWN",At[At.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",At[At.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",At[At.NOT_FOUND=5]="NOT_FOUND",At[At.ALREADY_EXISTS=6]="ALREADY_EXISTS",At[At.PERMISSION_DENIED=7]="PERMISSION_DENIED",At[At.UNAUTHENTICATED=16]="UNAUTHENTICATED",At[At.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",At[At.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",At[At.ABORTED=10]="ABORTED",At[At.OUT_OF_RANGE=11]="OUT_OF_RANGE",At[At.UNIMPLEMENTED=12]="UNIMPLEMENTED",At[At.INTERNAL=13]="INTERNAL",At[At.UNAVAILABLE=14]="UNAVAILABLE",At[At.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EA(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fM=new Ho([4294967295,4294967295],0);function hT(s){const e=EA().encode(s),t=new yI;return t.update(e),new Uint8Array(t.digest())}function fT(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Ho([t,n],0),new Ho([a,l],0)]}class d_{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new xf(`Invalid padding: ${t}`);if(n<0)throw new xf(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new xf(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new xf(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ho.fromNumber(this.ge)}ye(e,t,n){let a=e.add(t.multiply(Ho.fromNumber(n)));return a.compare(fM)===1&&(a=new Ho([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=hT(e),[n,a]=fT(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(n,a,l);if(!this.we(c))return!1}return!0}static create(e,t,n){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new d_(l,a,t);return n.forEach((d=>c.insert(d))),c}insert(e){if(this.ge===0)return;const t=hT(e),[n,a]=fT(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(n,a,l);this.be(c)}}be(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class xf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Im{constructor(e,t,n,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const a=new Map;return a.set(e,Am.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Im(Xe.min(),a,new ss(dt),or(),gt())}}class Am{constructor(e,t,n,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Am(n,t,gt(),gt(),gt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(e,t,n,a){this.Se=e,this.removedTargetIds=t,this.key=n,this.De=a}}class IA{constructor(e,t){this.targetId=e,this.Ce=t}}class AA{constructor(e,t,n=_s.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=a}}class mT{constructor(){this.ve=0,this.Fe=gT(),this.Me=_s.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=gt(),t=gt(),n=gt();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:n=n.add(a);break;default:qe(38017,{changeType:l})}})),new Am(this.Me,this.xe,e,t,n)}Ke(){this.Oe=!1,this.Fe=gT()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Qe(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class mM{constructor(e){this.Ge=e,this.ze=new Map,this.je=or(),this.He=gp(),this.Je=gp(),this.Ze=new ss(dt)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.We(),n.Ne||n.Ke(),n.Le(e.resumeToken);break;case 2:n.We(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.Qe(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:qe(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,a)=>{this.rt(a)&&t(a)}))}st(e){const t=e.targetId,n=e.Ce.count,a=this.ot(t);if(a){const l=a.target;if(n0(l))if(n===0){const c=new Ue(l.path);this.et(t,c,as.newNoDocument(c,Xe.min()))}else Qe(n===1,20013,{expectedCount:n});else{const c=this._t(t);if(c!==n){const d=this.ut(e),f=d?this.ct(d,e,c):1;if(f!==0){this.it(t);const m=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:l=0}=t;let c,d;try{c=Bi(n).toUint8Array()}catch(f){if(f instanceof KI)return ri("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{d=new d_(c,a,l)}catch(f){return ri(f instanceof xf?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return d.ge===0?null:d}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let a=0;return n.forEach((l=>{const c=this.Ge.ht(),d=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(d)||(this.et(t,l,null),a++)})),a}Tt(e){const t=new Map;this.ze.forEach(((l,c)=>{const d=this.ot(c);if(d){if(l.current&&n0(d.target)){const f=new Ue(d.target.path);this.It(f).has(c)||this.Et(c,f)||this.et(c,f,as.newNoDocument(f,e))}l.Be&&(t.set(c,l.ke()),l.Ke())}}));let n=gt();this.Je.forEach(((l,c)=>{let d=!0;c.forEachWhile((f=>{const m=this.ot(f);return!m||m.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(n=n.add(l))})),this.je.forEach(((l,c)=>c.setReadTime(e)));const a=new Im(e,t,this.Ze,this.je,n);return this.je=or(),this.He=gp(),this.Je=gp(),this.Ze=new ss(dt),a}Ye(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,n),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.qe(t,1):a.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new mT,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new qt(dt),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new qt(dt),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ce("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new mT),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function gp(){return new ss(Ue.comparator)}function gT(){return new ss(Ue.comparator)}const gM={asc:"ASCENDING",desc:"DESCENDING"},pM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},xM={and:"AND",or:"OR"};class bM{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function $w(s,e){return s.useProto3Json||_m(e)?e:{value:e}}function Ed(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function kA(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function yM(s,e){return Ed(s,e.toTimestamp())}function ks(s){return Qe(!!s,49232),Xe.fromTimestamp((function(t){const n=$i(t);return new Mt(n.seconds,n.nanos)})(s))}function h_(s,e){return Bw(s,e).canonicalString()}function Bw(s,e){const t=(function(a){return new Nt(["projects",a.projectId,"databases",a.database])})(s).child("documents");return e===void 0?t:t.child(e)}function CA(s){const e=Nt.fromString(s);return Qe($A(e),10190,{key:e.toString()}),e}function em(s,e){return h_(s.databaseId,e.path)}function ti(s,e){const t=CA(e);if(t.get(1)!==s.databaseId.projectId)throw new ke(me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new ke(me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new Ue(OA(t))}function RA(s,e){return h_(s.databaseId,e)}function DA(s){const e=CA(s);return e.length===4?Nt.emptyPath():OA(e)}function zw(s){return new Nt(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function OA(s){return Qe(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function pT(s,e,t){return{name:em(s,e),fields:t.value.mapValue.fields}}function PA(s,e,t){const n=ti(s,e.name),a=ks(e.updateTime),l=e.createTime?ks(e.createTime):Xe.min(),c=new yn({mapValue:{fields:e.fields}}),d=as.newFoundDocument(n,a,l,c);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function wM(s,e){return"found"in e?(function(n,a){Qe(!!a.found,43571),a.found.name,a.found.updateTime;const l=ti(n,a.found.name),c=ks(a.found.updateTime),d=a.found.createTime?ks(a.found.createTime):Xe.min(),f=new yn({mapValue:{fields:a.found.fields}});return as.newFoundDocument(l,c,d,f)})(s,e):"missing"in e?(function(n,a){Qe(!!a.missing,3894),Qe(!!a.readTime,22933);const l=ti(n,a.missing),c=ks(a.readTime);return as.newNoDocument(l,c)})(s,e):qe(7234,{result:e})}function vM(s,e){let t;if("targetChange"in e){e.targetChange;const n=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:qe(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(m,x){return m.useProto3Json?(Qe(x===void 0||typeof x=="string",58123),_s.fromBase64String(x||"")):(Qe(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),_s.fromUint8Array(x||new Uint8Array))})(s,e.targetChange.resumeToken),c=e.targetChange.cause,d=c&&(function(m){const x=m.code===void 0?me.UNKNOWN:TA(m.code);return new ke(x,m.message||"")})(c);t=new AA(n,a,l,d||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=ti(s,n.document.name),l=ks(n.document.updateTime),c=n.document.createTime?ks(n.document.createTime):Xe.min(),d=new yn({mapValue:{fields:n.document.fields}}),f=as.newFoundDocument(a,l,c,d),m=n.targetIds||[],x=n.removedTargetIds||[];t=new Bp(m,x,f.key,f)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=ti(s,n.document),l=n.readTime?ks(n.readTime):Xe.min(),c=as.newNoDocument(a,l),d=n.removedTargetIds||[];t=new Bp([],d,c.key,c)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=ti(s,n.document),l=n.removedTargetIds||[];t=new Bp([],l,a,null)}else{if(!("filter"in e))return qe(11601,{Vt:e});{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:l}=n,c=new hM(a,l),d=n.targetId;t=new IA(d,c)}}return t}function tm(s,e){let t;if(e instanceof zd)t={update:pT(s,e.key,e.value)};else if(e instanceof qd)t={delete:em(s,e.key)};else if(e instanceof Ki)t={update:pT(s,e.key,e.data),updateMask:EM(e.fieldMask)};else{if(!(e instanceof o_))return qe(16599,{dt:e.type});t={verify:em(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((n=>(function(l,c){const d=c.transform;if(d instanceof Sd)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof xc)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof bc)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Td)return{fieldPath:c.field.canonicalString(),increment:d.Ae};throw qe(20930,{transform:c.transform})})(0,n)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:yM(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:qe(27497)})(s,e.precondition)),t}function qw(s,e){const t=e.currentDocument?(function(l){return l.updateTime!==void 0?fs.updateTime(ks(l.updateTime)):l.exists!==void 0?fs.exists(l.exists):fs.none()})(e.currentDocument):fs.none(),n=e.updateTransforms?e.updateTransforms.map((a=>(function(c,d){let f=null;if("setToServerValue"in d)Qe(d.setToServerValue==="REQUEST_TIME",16630,{proto:d}),f=new Sd;else if("appendMissingElements"in d){const x=d.appendMissingElements.values||[];f=new xc(x)}else if("removeAllFromArray"in d){const x=d.removeAllFromArray.values||[];f=new bc(x)}else"increment"in d?f=new Td(c,d.increment):qe(16584,{proto:d});const m=hs.fromServerFormat(d.fieldPath);return new Em(m,f)})(s,a))):[];if(e.update){e.update.name;const a=ti(s,e.update.name),l=new yn({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=(function(f){const m=f.fieldPaths||[];return new ir(m.map((x=>hs.fromServerFormat(x))))})(e.updateMask);return new Ki(a,l,c,t,n)}return new zd(a,l,t,n)}if(e.delete){const a=ti(s,e.delete);return new qd(a,t)}if(e.verify){const a=ti(s,e.verify);return new o_(a,t)}return qe(1463,{proto:e})}function _M(s,e){return s&&s.length>0?(Qe(e!==void 0,14353),s.map((t=>(function(a,l){let c=a.updateTime?ks(a.updateTime):ks(l);return c.isEqual(Xe.min())&&(c=ks(l)),new cM(c,a.transformResults||[])})(t,e)))):[]}function MA(s,e){return{documents:[RA(s,e.path)]}}function LA(s,e){const t={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=RA(s,a);const l=(function(m){if(m.length!==0)return FA($t.create(m,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const c=(function(m){if(m.length!==0)return m.map((x=>(function(w){return{field:Ku(w.field),direction:NM(w.dir)}})(x)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const d=$w(s,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:t,parent:a}}function VA(s){let e=DA(s.parent);const t=s.structuredQuery,n=t.from?t.from.length:0;let a=null;if(n>0){Qe(n===1,65062);const x=t.from[0];x.allDescendants?a=x.collectionId:e=e.child(x.collectionId)}let l=[];t.where&&(l=(function(y){const w=UA(y);return w instanceof $t&&n_(w)?w.getFilters():[w]})(t.where));let c=[];t.orderBy&&(c=(function(y){return y.map((w=>(function(T){return new Zf(Qu(T.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(T.direction))})(w)))})(t.orderBy));let d=null;t.limit&&(d=(function(y){let w;return w=typeof y=="object"?y.value:y,_m(w)?null:w})(t.limit));let f=null;t.startAt&&(f=(function(y){const w=!!y.before,v=y.values||[];return new nl(v,w)})(t.startAt));let m=null;return t.endAt&&(m=(function(y){const w=!y.before,v=y.values||[];return new nl(v,w)})(t.endAt)),uA(e,a,c,l,d,"F",f,m)}function jM(s,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return qe(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function UA(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Qu(t.unaryFilter.field);return Et.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=Qu(t.unaryFilter.field);return Et.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Qu(t.unaryFilter.field);return Et.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Qu(t.unaryFilter.field);return Et.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return qe(61313);default:return qe(60726)}})(s):s.fieldFilter!==void 0?(function(t){return Et.create(Qu(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return qe(58110);default:return qe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return $t.create(t.compositeFilter.filters.map((n=>UA(n))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return qe(1026)}})(t.compositeFilter.op))})(s):qe(30097,{filter:s})}function NM(s){return gM[s]}function SM(s){return pM[s]}function TM(s){return xM[s]}function Ku(s){return{fieldPath:s.canonicalString()}}function Qu(s){return hs.fromServerFormat(s.fieldPath)}function FA(s){return s instanceof Et?(function(t){if(t.op==="=="){if(eT(t.value))return{unaryFilter:{field:Ku(t.field),op:"IS_NAN"}};if(ZS(t.value))return{unaryFilter:{field:Ku(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(eT(t.value))return{unaryFilter:{field:Ku(t.field),op:"IS_NOT_NAN"}};if(ZS(t.value))return{unaryFilter:{field:Ku(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ku(t.field),op:SM(t.op),value:t.value}}})(s):s instanceof $t?(function(t){const n=t.getFilters().map((a=>FA(a)));return n.length===1?n[0]:{compositeFilter:{op:TM(t.op),filters:n}}})(s):qe(54877,{filter:s})}function EM(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function $A(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function BA(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,t,n,a,l=Xe.min(),c=Xe.min(),d=_s.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=d,this.expectedCount=f}withSequenceNumber(e){return new Ri(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ri(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ri(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ri(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(e){this.yt=e}}function IM(s,e){let t;if(e.document)t=PA(s.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=Ue.fromSegments(e.noDocument.path),a=wc(e.noDocument.readTime);t=as.newNoDocument(n,a),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return qe(56709);{const n=Ue.fromSegments(e.unknownDocument.path),a=wc(e.unknownDocument.version);t=as.newUnknownDocument(n,a)}}return e.readTime&&t.setReadTime((function(a){const l=new Mt(a[0],a[1]);return Xe.fromTimestamp(l)})(e.readTime)),t}function xT(s,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:i0(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=(function(l,c){return{name:em(l,c.key),fields:c.data.value.mapValue.fields,updateTime:Ed(l,c.version.toTimestamp()),createTime:Ed(l,c.createTime.toTimestamp())}})(s.yt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:yc(e.version)};else{if(!e.isUnknownDocument())return qe(57904,{document:e});n.unknownDocument={path:t.path.toArray(),version:yc(e.version)}}return n}function i0(s){const e=s.toTimestamp();return[e.seconds,e.nanoseconds]}function yc(s){const e=s.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function wc(s){const e=new Mt(s.seconds,s.nanoseconds);return Xe.fromTimestamp(e)}function Jl(s,e){const t=(e.baseMutations||[]).map((l=>qw(s.yt,l)));for(let l=0;l<e.mutations.length-1;++l){const c=e.mutations[l];if(l+1<e.mutations.length&&e.mutations[l+1].transform!==void 0){const d=e.mutations[l+1];c.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(l+1,1),++l}}const n=e.mutations.map((l=>qw(s.yt,l))),a=Mt.fromMillis(e.localWriteTimeMs);return new l_(e.batchId,a,t,n)}function bf(s){const e=wc(s.readTime),t=s.lastLimboFreeSnapshotVersion!==void 0?wc(s.lastLimboFreeSnapshotVersion):Xe.min();let n;return n=(function(l){return l.documents!==void 0})(s.query)?(function(l){const c=l.documents.length;return Qe(c===1,1966,{count:c}),Hn(Bd(DA(l.documents[0])))})(s.query):(function(l){return Hn(VA(l))})(s.query),new Ri(n,s.targetId,"TargetPurposeListen",s.lastListenSequenceNumber,e,t,_s.fromBase64String(s.resumeToken))}function qA(s,e){const t=yc(e.snapshotVersion),n=yc(e.lastLimboFreeSnapshotVersion);let a;a=n0(e.target)?MA(s.yt,e.target):LA(s.yt,e.target).ft;const l=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:pc(e.target),readTime:t,resumeToken:l,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:a}}function f_(s){const e=VA({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?a0(e,e.limit,"L"):e}function Py(s,e){return new u_(e.largestBatchId,qw(s.yt,e.overlayMutation))}function bT(s,e){const t=e.path.lastSegment();return[s,On(e.path.popLast()),t]}function yT(s,e,t,n){return{indexId:s,uid:e,sequenceNumber:t,readTime:yc(n.readTime),documentKey:On(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AM{getBundleMetadata(e,t){return wT(e).get(t).next((n=>{if(n)return(function(l){return{id:l.bundleId,createTime:wc(l.createTime),version:l.version}})(n)}))}saveBundleMetadata(e,t){return wT(e).put((function(a){return{bundleId:a.id,createTime:yc(ks(a.createTime)),version:a.version}})(t))}getNamedQuery(e,t){return vT(e).get(t).next((n=>{if(n)return(function(l){return{name:l.name,query:f_(l.bundledQuery),readTime:wc(l.readTime)}})(n)}))}saveNamedQuery(e,t){return vT(e).put((function(a){return{name:a.name,readTime:yc(ks(a.readTime)),bundledQuery:a.bundledQuery}})(t))}}function wT(s){return Zs(s,V0)}function vT(s){return Zs(s,U0)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const n=t.uid||"";return new G0(e,n)}getOverlay(e,t){return Zh(e).get(bT(this.userId,t)).next((n=>n?Py(this.serializer,n):null))}getOverlays(e,t){const n=Xa();return ae.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&n.set(a,l)})))).next((()=>n))}saveOverlays(e,t,n){const a=[];return n.forEach(((l,c)=>{const d=new u_(t,c);a.push(this.bt(e,d))})),ae.waitFor(a)}removeOverlaysForBatchId(e,t,n){const a=new Set;t.forEach((c=>a.add(On(c.getCollectionPath()))));const l=[];return a.forEach((c=>{const d=IDBKeyRange.bound([this.userId,c,n],[this.userId,c,n+1],!1,!0);l.push(Zh(e).X(Rw,d))})),ae.waitFor(l)}getOverlaysForCollection(e,t,n){const a=Xa(),l=On(t),c=IDBKeyRange.bound([this.userId,l,n],[this.userId,l,Number.POSITIVE_INFINITY],!0);return Zh(e).H(Rw,c).next((d=>{for(const f of d){const m=Py(this.serializer,f);a.set(m.getKey(),m)}return a}))}getOverlaysForCollectionGroup(e,t,n,a){const l=Xa();let c;const d=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Zh(e).ee({index:BI,range:d},((f,m,x)=>{const y=Py(this.serializer,m);l.size()<a||y.largestBatchId===c?(l.set(y.getKey(),y),c=y.largestBatchId):x.done()})).next((()=>l))}bt(e,t){return Zh(e).put((function(a,l,c){const[d,f,m]=bT(l,c.mutation.key);return{userId:l,collectionPath:f,documentId:m,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:tm(a.yt,c.mutation)}})(this.serializer,this.userId,t))}}function Zh(s){return Zs(s,F0)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kM{St(e){return Zs(e,Zv)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const n=t==null?void 0:t.value;return n?_s.fromUint8Array(n):_s.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(ds(e.integerValue));else if("doubleValue"in e){const n=ds(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),Gf(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),typeof n=="string"&&(n=$i(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Bi(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?eA(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):z0(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):qe(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const n=e.fields||{};this.Ft(t,55);for(const a of Object.keys(n))this.Ot(a,t),this.Ct(n[a],t)}kt(e,t){var c,d;const n=e.fields||{};this.Ft(t,53);const a=_d,l=((d=(c=n[a].arrayValue)==null?void 0:c.values)==null?void 0:d.length)||0;this.Ft(t,15),t.Mt(ds(l)),this.Ot(a,t),this.Ct(n[a],t)}qt(e,t){const n=e.values||[];this.Ft(t,50);for(const a of n)this.Ct(a,t)}Lt(e,t){this.Ft(t,37),Ue.fromName(e).path.forEach((n=>{this.Ft(t,60),this.$t(n,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Xl.Wt=new Xl;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cu=255;function CM(s){if(s===0)return 8;let e=0;return s>>4||(e+=4,s<<=4),s>>6||(e+=2,s<<=2),s>>7||(e+=1),e}function _T(s){const e=64-(function(n){let a=0;for(let l=0;l<8;++l){const c=CM(255&n[l]);if(a+=c,c!==8)break}return a})(s);return Math.ceil(e/8)}class RM{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Gt(n.value),n=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ht(n.value),n=t.next();this.Jt()}Zt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Gt(n);else if(n<2048)this.Gt(960|n>>>6),this.Gt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|n>>>12),this.Gt(128|63&n>>>6),this.Gt(128|63&n);else{const a=t.codePointAt(0);this.Gt(240|a>>>18),this.Gt(128|63&a>>>12),this.Gt(128|63&a>>>6),this.Gt(128|63&a)}}this.zt()}Xt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Ht(n);else if(n<2048)this.Ht(960|n>>>6),this.Ht(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|n>>>12),this.Ht(128|63&n>>>6),this.Ht(128|63&n);else{const a=t.codePointAt(0);this.Ht(240|a>>>18),this.Ht(128|63&a>>>12),this.Ht(128|63&a>>>6),this.Ht(128|63&a)}}this.Jt()}Yt(e){const t=this.en(e),n=_T(t);this.tn(1+n),this.buffer[this.position++]=255&n;for(let a=t.length-n;a<t.length;++a)this.buffer[this.position++]=255&t[a]}nn(e){const t=this.en(e),n=_T(t);this.tn(1+n),this.buffer[this.position++]=~(255&n);for(let a=t.length-n;a<t.length;++a)this.buffer[this.position++]=~(255&t[a])}rn(){this.sn(Cu),this.sn(255)}_n(){this.an(Cu),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(l){const c=new DataView(new ArrayBuffer(8));return c.setFloat64(0,l,!1),new Uint8Array(c.buffer)})(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let a=1;a<t.length;++a)t[a]^=n?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Cu?(this.sn(Cu),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Cu?(this.an(Cu),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const a=new Uint8Array(n);a.set(this.buffer),this.buffer=a}}class DM{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class OM{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class ef{constructor(){this.cn=new RM,this.ascending=new DM(this.cn),this.descending=new OM(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(e,t,n,a){this.hn=e,this.Pn=t,this.Tn=n,this.In=a}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.In,0),t!==e?n.set([0],this.In.length):++n[n.length-1],new Zl(this.hn,this.Pn,this.Tn,n)}Rn(e,t,n){return{indexId:this.hn,uid:e,arrayValue:zp(this.Tn),directionalValue:zp(this.In),orderedDocumentKey:zp(t),documentKey:n.path.toArray()}}An(e,t,n){const a=this.Rn(e,t,n);return[a.indexId,a.uid,a.arrayValue,a.directionalValue,a.orderedDocumentKey,a.documentKey]}}function Ro(s,e){let t=s.hn-e.hn;return t!==0?t:(t=jT(s.Tn,e.Tn),t!==0?t:(t=jT(s.In,e.In),t!==0?t:Ue.comparator(s.Pn,e.Pn)))}function jT(s,e){for(let t=0;t<s.length&&t<e.length;++t){const n=s[t]-e[t];if(n!==0)return n}return s.length-e.length}function zp(s){return aI()?(function(t){let n="";for(let a=0;a<t.length;a++)n+=String.fromCharCode(t[a]);return n})(s):s}function NT(s){return typeof s!="string"?s:(function(t){const n=new Uint8Array(t.length);for(let a=0;a<t.length;a++)n[a]=t.charCodeAt(a);return n})(s)}class ST{constructor(e){this.Vn=new qt(((t,n)=>hs.comparator(t.field,n.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const n=t;n.isInequality()?this.Vn=this.Vn.add(n):this.mn.push(n)}}get fn(){return this.Vn.size>1}gn(e){if(Qe(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=Aw(e);if(t!==void 0&&!this.pn(t))return!1;const n=Wl(e);let a=new Set,l=0,c=0;for(;l<n.length&&this.pn(n[l]);++l)a=a.add(n[l].fieldPath.canonicalString());if(l===n.length)return!0;if(this.Vn.size>0){const d=this.Vn.getIterator().getNext();if(!a.has(d.field.canonicalString())){const f=n[l];if(!this.yn(d,f)||!this.wn(this.dn[c++],f))return!1}++l}for(;l<n.length;++l){const d=n[l];if(c>=this.dn.length||!this.wn(this.dn[c++],d))return!1}return!0}bn(){if(this.fn)return null;let e=new qt(hs.comparator);const t=[];for(const n of this.mn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new Pp(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new Pp(n.field,0))}for(const n of this.dn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new Pp(n.field,n.dir==="asc"?0:1)));return new Zp(Zp.UNKNOWN_ID,this.collectionId,t,Hf.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HA(s){var t,n;if(Qe(s instanceof Et||s instanceof $t,20012),s instanceof Et){if(s instanceof cA){const a=((n=(t=s.value.arrayValue)==null?void 0:t.values)==null?void 0:n.map((l=>Et.create(s.field,"==",l))))||[];return $t.create(a,"or")}return s}const e=s.filters.map((a=>HA(a)));return $t.create(e,s.op)}function PM(s){if(s.getFilters().length===0)return[];const e=Ww(HA(s));return Qe(GA(e),7391),Hw(e)||Gw(e)?[e]:e.getFilters()}function Hw(s){return s instanceof Et}function Gw(s){return s instanceof $t&&n_(s)}function GA(s){return Hw(s)||Gw(s)||(function(t){if(t instanceof $t&&Lw(t)){for(const n of t.getFilters())if(!Hw(n)&&!Gw(n))return!1;return!0}return!1})(s)}function Ww(s){if(Qe(s instanceof Et||s instanceof $t,34018),s instanceof Et)return s;if(s.filters.length===1)return Ww(s.filters[0]);const e=s.filters.map((n=>Ww(n)));let t=$t.create(e,s.op);return t=o0(t),GA(t)?t:(Qe(t instanceof $t,64498),Qe(Nd(t),40251),Qe(t.filters.length>1,57927),t.filters.reduce(((n,a)=>m_(n,a))))}function m_(s,e){let t;return Qe(s instanceof Et||s instanceof $t,38388),Qe(e instanceof Et||e instanceof $t,25473),t=s instanceof Et?e instanceof Et?(function(a,l){return $t.create([a,l],"and")})(s,e):TT(s,e):e instanceof Et?TT(e,s):(function(a,l){if(Qe(a.filters.length>0&&l.filters.length>0,48005),Nd(a)&&Nd(l))return iA(a,l.getFilters());const c=Lw(a)?a:l,d=Lw(a)?l:a,f=c.filters.map((m=>m_(m,d)));return $t.create(f,"or")})(s,e),o0(t)}function TT(s,e){if(Nd(e))return iA(e,s.getFilters());{const t=e.filters.map((n=>m_(s,n)));return $t.create(t,"or")}}function o0(s){if(Qe(s instanceof Et||s instanceof $t,11850),s instanceof Et)return s;const e=s.getFilters();if(e.length===1)return o0(e[0]);if(rA(s))return s;const t=e.map((a=>o0(a))),n=[];return t.forEach((a=>{a instanceof Et?n.push(a):a instanceof $t&&(a.op===s.op?n.push(...a.filters):n.push(a))})),n.length===1?n[0]:$t.create(n,s.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM{constructor(){this.Sn=new g_}addToCollectionParentIndex(e,t){return this.Sn.add(t),ae.resolve()}getCollectionParents(e,t){return ae.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return ae.resolve()}deleteFieldIndex(e,t){return ae.resolve()}deleteAllFieldIndexes(e){return ae.resolve()}createTargetIndexes(e,t){return ae.resolve()}getDocumentsMatchingTarget(e,t){return ae.resolve(null)}getIndexType(e,t){return ae.resolve(0)}getFieldIndexes(e,t){return ae.resolve([])}getNextCollectionGroupToUpdate(e){return ae.resolve(null)}getMinOffset(e,t){return ae.resolve(Or.min())}getMinOffsetFromCollectionGroup(e,t){return ae.resolve(Or.min())}updateCollectionGroup(e,t,n){return ae.resolve()}updateIndexEntries(e,t){return ae.resolve()}}class g_{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),a=this.index[t]||new qt(Nt.comparator),l=!a.has(n);return this.index[t]=a.add(n),l}has(e){const t=e.lastSegment(),n=e.popLast(),a=this.index[t];return a&&a.has(n)}getEntries(e){return(this.index[e]||new qt(Nt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET="IndexedDbIndexManager",pp=new Uint8Array(0);class LM{constructor(e,t){this.databaseId=t,this.Dn=new g_,this.Cn=new Wi((n=>pc(n)),((n,a)=>Nm(n,a))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const n=t.lastSegment(),a=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const l={collectionId:n,parent:On(a)};return IT(e).put(l)}return ae.resolve()}getCollectionParents(e,t){const n=[],a=IDBKeyRange.bound([t,""],[EI(t),""],!1,!0);return IT(e).H(a).next((l=>{for(const c of l){if(c.collectionId!==t)break;n.push(Ja(c.parent))}return n}))}addFieldIndex(e,t){const n=tf(e),a=(function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete a.indexId;const l=n.add(a);if(t.indexState){const c=Du(e);return l.next((d=>{c.put(yT(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return l.next()}deleteFieldIndex(e,t){const n=tf(e),a=Du(e),l=Ru(e);return n.delete(t.indexId).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>l.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=tf(e),n=Ru(e),a=Du(e);return t.X().next((()=>n.X())).next((()=>a.X()))}createTargetIndexes(e,t){return ae.forEach(this.vn(t),(n=>this.getIndexType(e,n).next((a=>{if(a===0||a===1){const l=new ST(n).bn();if(l!=null)return this.addFieldIndex(e,l)}}))))}getDocumentsMatchingTarget(e,t){const n=Ru(e);let a=!0;const l=new Map;return ae.forEach(this.vn(t),(c=>this.Fn(e,c).next((d=>{a&&(a=!!d),l.set(c,d)})))).next((()=>{if(a){let c=gt();const d=[];return ae.forEach(l,((f,m)=>{Ce(ET,`Using index ${(function(V){return`id=${V.indexId}|cg=${V.collectionGroup}|f=${V.fields.map((q=>`${q.fieldPath}:${q.kind}`)).join(",")}`})(f)} to execute ${pc(t)}`);const x=(function(V,q){const W=Aw(q);if(W===void 0)return null;for(const z of r0(V,W.fieldPath))switch(z.op){case"array-contains-any":return z.value.arrayValue.values||[];case"array-contains":return[z.value]}return null})(m,f),y=(function(V,q){const W=new Map;for(const z of Wl(q))for(const k of r0(V,z.fieldPath))switch(k.op){case"==":case"in":W.set(z.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return W.set(z.fieldPath.canonicalString(),k.value),Array.from(W.values())}return null})(m,f),w=(function(V,q){const W=[];let z=!0;for(const k of Wl(q)){const M=k.kind===0?aT(V,k.fieldPath,V.startAt):iT(V,k.fieldPath,V.startAt);W.push(M.value),z&&(z=M.inclusive)}return new nl(W,z)})(m,f),v=(function(V,q){const W=[];let z=!0;for(const k of Wl(q)){const M=k.kind===0?iT(V,k.fieldPath,V.endAt):aT(V,k.fieldPath,V.endAt);W.push(M.value),z&&(z=M.inclusive)}return new nl(W,z)})(m,f),T=this.Mn(f,m,w),I=this.Mn(f,m,v),N=this.xn(f,m,y),P=this.On(f.indexId,x,T,w.inclusive,I,v.inclusive,N);return ae.forEach(P,(U=>n.Z(U,t.limit).next((V=>{V.forEach((q=>{const W=Ue.fromSegments(q.documentKey);c.has(W)||(c=c.add(W),d.push(W))}))}))))})).next((()=>d))}return ae.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=PM($t.create(e.filters,"and")).map((n=>Uw(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,n,a,l,c,d){const f=(t!=null?t.length:1)*Math.max(n.length,l.length),m=f/(t!=null?t.length:1),x=[];for(let y=0;y<f;++y){const w=t?this.Nn(t[y/m]):pp,v=this.Bn(e,w,n[y%m],a),T=this.Ln(e,w,l[y%m],c),I=d.map((N=>this.Bn(e,w,N,!0)));x.push(...this.createRange(v,T,I))}return x}Bn(e,t,n,a){const l=new Zl(e,Ue.empty(),t,n);return a?l:l.En()}Ln(e,t,n,a){const l=new Zl(e,Ue.empty(),t,n);return a?l.En():l}Fn(e,t){const n=new ST(t),a=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,a).next((l=>{let c=null;for(const d of l)n.gn(d)&&(!c||d.fields.length>c.fields.length)&&(c=d);return c}))}getIndexType(e,t){let n=2;const a=this.vn(t);return ae.forEach(a,(l=>this.Fn(e,l).next((c=>{c?n!==0&&c.fields.length<(function(f){let m=new qt(hs.comparator),x=!1;for(const y of f.filters)for(const w of y.getFlattenedFilters())w.field.isKeyField()||(w.op==="array-contains"||w.op==="array-contains-any"?x=!0:m=m.add(w.field));for(const y of f.orderBy)y.field.isKeyField()||(m=m.add(y.field));return m.size+(x?1:0)})(l)&&(n=1):n=0})))).next((()=>(function(c){return c.limit!==null})(t)&&a.length>1&&n===2?1:n))}kn(e,t){const n=new ef;for(const a of Wl(e)){const l=t.data.field(a.fieldPath);if(l==null)return null;const c=n.ln(a.kind);Xl.Wt.Dt(l,c)}return n.un()}Nn(e){const t=new ef;return Xl.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const n=new ef;return Xl.Wt.Dt(gc(this.databaseId,t),n.ln((function(l){const c=Wl(l);return c.length===0?0:c[c.length-1].kind})(e))),n.un()}xn(e,t,n){if(n===null)return[];let a=[];a.push(new ef);let l=0;for(const c of Wl(e)){const d=n[l++];for(const f of a)if(this.qn(t,c.fieldPath)&&Xf(d))a=this.Un(a,c,d);else{const m=f.ln(c.kind);Xl.Wt.Dt(d,m)}}return this.$n(a)}Mn(e,t,n){return this.xn(e,t,n.position)}$n(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].un();return t}Un(e,t,n){const a=[...e],l=[];for(const c of n.arrayValue.values||[])for(const d of a){const f=new ef;f.seed(d.un()),Xl.Wt.Dt(c,f.ln(t.kind)),l.push(f)}return l}qn(e,t){return!!e.filters.find((n=>n instanceof Et&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in")))}getFieldIndexes(e,t){const n=tf(e),a=Du(e);return(t?n.H(Cw,IDBKeyRange.bound(t,t)):n.H()).next((l=>{const c=[];return ae.forEach(l,(d=>a.get([d.indexId,this.uid]).next((f=>{c.push((function(x,y){const w=y?new Hf(y.sequenceNumber,new Or(wc(y.readTime),new Ue(Ja(y.documentKey)),y.largestBatchId)):Hf.empty(),v=x.fields.map((([T,I])=>new Pp(hs.fromServerFormat(T),I)));return new Zp(x.indexId,x.collectionGroup,v,w)})(d,f))})))).next((()=>c))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((n,a)=>{const l=n.indexState.sequenceNumber-a.indexState.sequenceNumber;return l!==0?l:dt(n.collectionGroup,a.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,n){const a=tf(e),l=Du(e);return this.Wn(e).next((c=>a.H(Cw,IDBKeyRange.bound(t,t)).next((d=>ae.forEach(d,(f=>l.put(yT(f.indexId,this.uid,c,n))))))))}updateIndexEntries(e,t){const n=new Map;return ae.forEach(t,((a,l)=>{const c=n.get(a.collectionGroup);return(c?ae.resolve(c):this.getFieldIndexes(e,a.collectionGroup)).next((d=>(n.set(a.collectionGroup,d),ae.forEach(d,(f=>this.Qn(e,a,f).next((m=>{const x=this.Gn(l,f);return m.isEqual(x)?ae.resolve():this.zn(e,l,f,m,x)})))))))}))}jn(e,t,n,a){return Ru(e).put(a.Rn(this.uid,this.Kn(n,t.key),t.key))}Hn(e,t,n,a){return Ru(e).delete(a.An(this.uid,this.Kn(n,t.key),t.key))}Qn(e,t,n){const a=Ru(e);let l=new qt(Ro);return a.ee({index:$I,range:IDBKeyRange.only([n.indexId,this.uid,zp(this.Kn(n,t))])},((c,d)=>{l=l.add(new Zl(n.indexId,t,NT(d.arrayValue),NT(d.directionalValue)))})).next((()=>l))}Gn(e,t){let n=new qt(Ro);const a=this.kn(t,e);if(a==null)return n;const l=Aw(t);if(l!=null){const c=e.data.field(l.fieldPath);if(Xf(c))for(const d of c.arrayValue.values||[])n=n.add(new Zl(t.indexId,e.key,this.Nn(d),a))}else n=n.add(new Zl(t.indexId,e.key,pp,a));return n}zn(e,t,n,a,l){Ce(ET,"Updating index entries for document '%s'",t.key);const c=[];return(function(f,m,x,y,w){const v=f.getIterator(),T=m.getIterator();let I=ku(v),N=ku(T);for(;I||N;){let P=!1,U=!1;if(I&&N){const V=x(I,N);V<0?U=!0:V>0&&(P=!0)}else I!=null?U=!0:P=!0;P?(y(N),N=ku(T)):U?(w(I),I=ku(v)):(I=ku(v),N=ku(T))}})(a,l,Ro,(d=>{c.push(this.jn(e,t,n,d))}),(d=>{c.push(this.Hn(e,t,n,d))})),ae.waitFor(c)}Wn(e){let t=1;return Du(e).ee({index:FI,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((n,a,l)=>{l.done(),t=a.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((c,d)=>Ro(c,d))).filter(((c,d,f)=>!d||Ro(c,f[d-1])!==0));const a=[];a.push(e);for(const c of n){const d=Ro(c,e),f=Ro(c,t);if(d===0)a[0]=e.En();else if(d>0&&f<0)a.push(c),a.push(c.En());else if(f>0)break}a.push(t);const l=[];for(let c=0;c<a.length;c+=2){if(this.Jn(a[c],a[c+1]))return[];const d=a[c].An(this.uid,pp,Ue.empty()),f=a[c+1].An(this.uid,pp,Ue.empty());l.push(IDBKeyRange.bound(d,f))}return l}Jn(e,t){return Ro(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(AT)}getMinOffset(e,t){return ae.mapArray(this.vn(t),(n=>this.Fn(e,n).next((a=>a||qe(44426))))).next(AT)}}function IT(s){return Zs(s,Qf)}function Ru(s){return Zs(s,Ef)}function tf(s){return Zs(s,Xv)}function Du(s){return Zs(s,Tf)}function AT(s){Qe(s.length!==0,28825);let e=s[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<s.length;n++){const a=s[n].indexState.offset;Qv(a,e)<0&&(e=a),t<a.largestBatchId&&(t=a.largestBatchId)}return new Or(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},WA=41943040;class Cn{static withCacheSize(e){return new Cn(e,Cn.DEFAULT_COLLECTION_PERCENTILE,Cn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KA(s,e,t){const n=s.store(ha),a=s.store(bd),l=[],c=IDBKeyRange.only(t.batchId);let d=0;const f=n.ee({range:c},((x,y,w)=>(d++,w.delete())));l.push(f.next((()=>{Qe(d===1,47070,{batchId:t.batchId})})));const m=[];for(const x of t.mutations){const y=LI(e,x.key.path,t.batchId);l.push(a.delete(y)),m.push(x.key)}return ae.waitFor(l).next((()=>m))}function l0(s){if(!s)return 0;let e;if(s.document)e=s.document;else if(s.unknownDocument)e=s.unknownDocument;else{if(!s.noDocument)throw qe(14731);e=s.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cn.DEFAULT_COLLECTION_PERCENTILE=10,Cn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Cn.DEFAULT=new Cn(WA,Cn.DEFAULT_COLLECTION_PERCENTILE,Cn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Cn.DISABLED=new Cn(-1,0,0);class W0{constructor(e,t,n,a){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=a,this.Zn={}}static wt(e,t,n,a){Qe(e.uid!=="",64387);const l=e.isAuthenticated()?e.uid:"";return new W0(l,t,n,a)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Do(e).ee({index:nc,range:n},((a,l,c)=>{t=!1,c.done()})).next((()=>t))}addMutationBatch(e,t,n,a){const l=Yu(e),c=Do(e);return c.add({}).next((d=>{Qe(typeof d=="number",49019);const f=new l_(d,t,n,a),m=(function(v,T,I){const N=I.baseMutations.map((U=>tm(v.yt,U))),P=I.mutations.map((U=>tm(v.yt,U)));return{userId:T,batchId:I.batchId,localWriteTimeMs:I.localWriteTime.toMillis(),baseMutations:N,mutations:P}})(this.serializer,this.userId,f),x=[];let y=new qt(((w,v)=>dt(w.canonicalString(),v.canonicalString())));for(const w of a){const v=LI(this.userId,w.key.path,d);y=y.add(w.key.path.popLast()),x.push(c.put(m)),x.push(l.put(v,h6))}return y.forEach((w=>{x.push(this.indexManager.addToCollectionParentIndex(e,w))})),e.addOnCommittedListener((()=>{this.Zn[d]=f.keys()})),ae.waitFor(x).next((()=>f))}))}lookupMutationBatch(e,t){return Do(e).get(t).next((n=>n?(Qe(n.userId===this.userId,48,"Unexpected user for mutation batch",{userId:n.userId,batchId:t}),Jl(this.serializer,n)):null))}Xn(e,t){return this.Zn[t]?ae.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((n=>{if(n){const a=n.keys();return this.Zn[t]=a,a}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,a=IDBKeyRange.lowerBound([this.userId,n]);let l=null;return Do(e).ee({index:nc,range:a},((c,d,f)=>{d.userId===this.userId&&(Qe(d.batchId>=n,47524,{Yn:n}),l=Jl(this.serializer,d)),f.done()})).next((()=>l))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Go;return Do(e).ee({index:nc,range:t,reverse:!0},((a,l,c)=>{n=l.batchId,c.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Go],[this.userId,Number.POSITIVE_INFINITY]);return Do(e).H(nc,t).next((n=>n.map((a=>Jl(this.serializer,a)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Mp(this.userId,t.path),a=IDBKeyRange.lowerBound(n),l=[];return Yu(e).ee({range:a},((c,d,f)=>{const[m,x,y]=c,w=Ja(x);if(m===this.userId&&t.path.isEqual(w))return Do(e).get(y).next((v=>{if(!v)throw qe(61480,{er:c,batchId:y});Qe(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:y}),l.push(Jl(this.serializer,v))}));f.done()})).next((()=>l))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new qt(dt);const a=[];return t.forEach((l=>{const c=Mp(this.userId,l.path),d=IDBKeyRange.lowerBound(c),f=Yu(e).ee({range:d},((m,x,y)=>{const[w,v,T]=m,I=Ja(v);w===this.userId&&l.path.isEqual(I)?n=n.add(T):y.done()}));a.push(f)})),ae.waitFor(a).next((()=>this.tr(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,a=n.length+1,l=Mp(this.userId,n),c=IDBKeyRange.lowerBound(l);let d=new qt(dt);return Yu(e).ee({range:c},((f,m,x)=>{const[y,w,v]=f,T=Ja(w);y===this.userId&&n.isPrefixOf(T)?T.length===a&&(d=d.add(v)):x.done()})).next((()=>this.tr(e,d)))}tr(e,t){const n=[],a=[];return t.forEach((l=>{a.push(Do(e).get(l).next((c=>{if(c===null)throw qe(35274,{batchId:l});Qe(c.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:c.userId,batchId:l}),n.push(Jl(this.serializer,c))})))})),ae.waitFor(a).next((()=>n))}removeMutationBatch(e,t){return KA(e.le,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),ae.forEach(n,(a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return ae.resolve();const n=IDBKeyRange.lowerBound((function(c){return[c]})(this.userId)),a=[];return Yu(e).ee({range:n},((l,c,d)=>{if(l[0]===this.userId){const f=Ja(l[1]);a.push(f)}else d.done()})).next((()=>{Qe(a.length===0,56720,{rr:a.map((l=>l.canonicalString()))})}))}))}containsKey(e,t){return QA(e,this.userId,t)}ir(e){return YA(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Go,lastStreamToken:""}))}}function QA(s,e,t){const n=Mp(e,t.path),a=n[1],l=IDBKeyRange.lowerBound(n);let c=!1;return Yu(s).ee({range:l,Y:!0},((d,f,m)=>{const[x,y,w]=d;x===e&&y===a&&(c=!0),m.done()})).next((()=>c))}function Do(s){return Zs(s,ha)}function Yu(s){return Zs(s,bd)}function YA(s){return Zs(s,Wf)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new vc(0)}static ar(){return new vc(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VM{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const n=new vc(t.highestTargetId);return t.highestTargetId=n.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>Xe.fromTimestamp(new Mt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.ur(e).next((a=>(a.highestListenSequenceNumber=t,n&&(a.lastRemoteSnapshotVersion=n.toTimestamp()),t>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=t),this.cr(e,a))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((n=>(n.targetCount+=1,this.hr(t,n),this.cr(e,n))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Ou(e).delete(t.targetId))).next((()=>this.ur(e))).next((n=>(Qe(n.targetCount>0,8065),n.targetCount-=1,this.cr(e,n))))}removeTargets(e,t,n){let a=0;const l=[];return Ou(e).ee(((c,d)=>{const f=bf(d);f.sequenceNumber<=t&&n.get(f.targetId)===null&&(a++,l.push(this.removeTargetData(e,f)))})).next((()=>ae.waitFor(l))).next((()=>a))}forEachTarget(e,t){return Ou(e).ee(((n,a)=>{const l=bf(a);t(l)}))}ur(e){return CT(e).get(s0).next((t=>(Qe(t!==null,2888),t)))}cr(e,t){return CT(e).put(s0,t)}lr(e,t){return Ou(e).put(qA(this.serializer,t))}hr(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const n=pc(t),a=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let l=null;return Ou(e).ee({range:a,index:UI},((c,d,f)=>{const m=bf(d);Nm(t,m.target)&&(l=m,f.done())})).next((()=>l))}addMatchingKeys(e,t,n){const a=[],l=Uo(e);return t.forEach((c=>{const d=On(c.path);a.push(l.put({targetId:n,path:d})),a.push(this.referenceDelegate.addReference(e,n,c))})),ae.waitFor(a)}removeMatchingKeys(e,t,n){const a=Uo(e);return ae.forEach(t,(l=>{const c=On(l.path);return ae.waitFor([a.delete([n,c]),this.referenceDelegate.removeReference(e,n,l)])}))}removeMatchingKeysForTargetId(e,t){const n=Uo(e),a=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(a)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),a=Uo(e);let l=gt();return a.ee({range:n,Y:!0},((c,d,f)=>{const m=Ja(c[1]),x=new Ue(m);l=l.add(x)})).next((()=>l))}containsKey(e,t){const n=On(t.path),a=IDBKeyRange.bound([n],[EI(n)],!1,!0);let l=0;return Uo(e).ee({index:Jv,Y:!0,range:a},(([c,d],f,m)=>{c!==0&&(l++,m.done())})).next((()=>l>0))}At(e,t){return Ou(e).get(t).next((n=>n?bf(n):null))}}function Ou(s){return Zs(s,yd)}function CT(s){return Zs(s,uc)}function Uo(s){return Zs(s,wd)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RT="LruGarbageCollector",UM=1048576;function DT([s,e],[t,n]){const a=dt(s,t);return a===0?dt(e,n):a}class FM{constructor(e){this.Pr=e,this.buffer=new qt(DT),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();DT(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class JA{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Ce(RT,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){cl(t)?Ce(RT,"Ignoring IndexedDB error during garbage collection: ",t):await ll(t)}await this.Ar(3e5)}))}}class $M{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return ae.resolve(ar.ce);const n=new FM(t);return this.Vr.forEachTarget(e,(a=>n.Er(a.sequenceNumber))).next((()=>this.Vr.mr(e,(a=>n.Er(a))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.Vr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ce("LruGarbageCollector","Garbage collection skipped; disabled"),ae.resolve(kT)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),kT):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let n,a,l,c,d,f,m;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((y=>(y>this.params.maximumSequenceNumbersToCollect?(Ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),a=this.params.maximumSequenceNumbersToCollect):a=y,c=Date.now(),this.nthSequenceNumber(e,a)))).next((y=>(n=y,d=Date.now(),this.removeTargets(e,n,t)))).next((y=>(l=y,f=Date.now(),this.removeOrphanedDocuments(e,n)))).next((y=>(m=Date.now(),Gu()<=jt.DEBUG&&Ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-x}ms
	Determined least recently used ${a} in `+(d-c)+`ms
	Removed ${l} targets in `+(f-d)+`ms
	Removed ${y} documents in `+(m-f)+`ms
Total Duration: ${m-x}ms`),ae.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:y}))))}}function XA(s,e){return new $M(s,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BM{constructor(e,t){this.db=e,this.garbageCollector=XA(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((n=>t.next((a=>n+a))))}pr(e){let t=0;return this.mr(e,(n=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((n,a)=>t(a)))}addReference(e,t,n){return xp(e,n)}removeReference(e,t,n){return xp(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return xp(e,t)}wr(e,t){return(function(a,l){let c=!1;return YA(a).te((d=>QA(a,d,l).next((f=>(f&&(c=!0),ae.resolve(!f)))))).next((()=>c))})(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let l=0;return this.yr(e,((c,d)=>{if(d<=t){const f=this.wr(e,c).next((m=>{if(!m)return l++,n.getEntry(e,c).next((()=>(n.removeEntry(c,Xe.min()),Uo(e).delete((function(y){return[0,On(y.path)]})(c)))))}));a.push(f)}})).next((()=>ae.waitFor(a))).next((()=>n.apply(e))).next((()=>l))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return xp(e,t)}yr(e,t){const n=Uo(e);let a,l=ar.ce;return n.ee({index:Jv},(([c,d],{path:f,sequenceNumber:m})=>{c===0?(l!==ar.ce&&t(new Ue(Ja(a)),l),l=m,a=f):l=ar.ce})).next((()=>{l!==ar.ce&&t(new Ue(Ja(a)),l)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function xp(s,e){return Uo(s).put((function(n,a){return{targetId:0,path:On(n.path),sequenceNumber:a}})(e,s.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{constructor(){this.changes=new Wi((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,as.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?ae.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zM{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return zl(e).put(n)}removeEntry(e,t,n){return zl(e).delete((function(l,c){const d=l.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],i0(c),d[d.length-1]]})(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.br(e,n))))}getEntry(e,t){let n=as.newInvalidDocument(t);return zl(e).ee({index:Lp,range:IDBKeyRange.only(sf(t))},((a,l)=>{n=this.Sr(t,l)})).next((()=>n))}Dr(e,t){let n={size:0,document:as.newInvalidDocument(t)};return zl(e).ee({index:Lp,range:IDBKeyRange.only(sf(t))},((a,l)=>{n={document:this.Sr(t,l),size:l0(l)}})).next((()=>n))}getEntries(e,t){let n=or();return this.Cr(e,t,((a,l)=>{const c=this.Sr(a,l);n=n.insert(a,c)})).next((()=>n))}vr(e,t){let n=or(),a=new ss(Ue.comparator);return this.Cr(e,t,((l,c)=>{const d=this.Sr(l,c);n=n.insert(l,d),a=a.insert(l,l0(c))})).next((()=>({documents:n,Fr:a})))}Cr(e,t,n){if(t.isEmpty())return ae.resolve();let a=new qt(MT);t.forEach((f=>a=a.add(f)));const l=IDBKeyRange.bound(sf(a.first()),sf(a.last())),c=a.getIterator();let d=c.getNext();return zl(e).ee({index:Lp,range:l},((f,m,x)=>{const y=Ue.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;d&&MT(d,y)<0;)n(d,null),d=c.getNext();d&&d.isEqual(y)&&(n(d,m),d=c.hasNext()?c.getNext():null),d?x.j(sf(d)):x.done()})).next((()=>{for(;d;)n(d,null),d=c.hasNext()?c.getNext():null}))}getDocumentsMatchingQuery(e,t,n,a,l){const c=t.path,d=[c.popLast().toArray(),c.lastSegment(),i0(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],f=[c.popLast().toArray(),c.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return zl(e).H(IDBKeyRange.bound(d,f,!0)).next((m=>{l==null||l.incrementDocumentReadCount(m.length);let x=or();for(const y of m){const w=this.Sr(Ue.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);w.isFoundDocument()&&(Tm(t,w)||a.has(w.key))&&(x=x.insert(w.key,w))}return x}))}getAllFromCollectionGroup(e,t,n,a){let l=or();const c=PT(t,n),d=PT(t,Or.max());return zl(e).ee({index:VI,range:IDBKeyRange.bound(c,d,!0)},((f,m,x)=>{const y=this.Sr(Ue.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);l=l.insert(y.key,y),l.size===a&&x.done()})).next((()=>l))}newChangeBuffer(e){return new qM(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return OT(e).get(kw).next((t=>(Qe(!!t,20021),t)))}br(e,t){return OT(e).put(kw,t)}Sr(e,t){if(t){const n=IM(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(Xe.min())))return n}return as.newInvalidDocument(e)}}function ek(s){return new zM(s)}class qM extends ZA{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new Wi((n=>n.toString()),((n,a)=>n.isEqual(a)))}applyChanges(e){const t=[];let n=0,a=new qt(((l,c)=>dt(l.canonicalString(),c.canonicalString())));return this.changes.forEach(((l,c)=>{const d=this.Or.get(l);if(t.push(this.Mr.removeEntry(e,l,d.readTime)),c.isValidDocument()){const f=xT(this.Mr.serializer,c);a=a.add(l.path.popLast());const m=l0(f);n+=m-d.size,t.push(this.Mr.addEntry(e,l,f))}else if(n-=d.size,this.trackRemovals){const f=xT(this.Mr.serializer,c.convertToNoDocument(Xe.min()));t.push(this.Mr.addEntry(e,l,f))}})),a.forEach((l=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,l))})),t.push(this.Mr.updateMetadata(e,n)),ae.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((n=>(this.Or.set(t,{size:n.size,readTime:n.document.readTime}),n.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:n,Fr:a})=>(a.forEach(((l,c)=>{this.Or.set(l,{size:c,readTime:n.get(l).readTime})})),n)))}}function OT(s){return Zs(s,Kf)}function zl(s){return Zs(s,t0)}function sf(s){const e=s.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function PT(s,e){const t=e.documentKey.path.toArray();return[s,i0(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function MT(s,e){const t=s.path.toArray(),n=e.path.toArray();let a=0;for(let l=0;l<t.length-2&&l<n.length-2;++l)if(a=dt(t[l],n[l]),a)return a;return a=dt(t.length,n.length),a||(a=dt(t[t.length-2],n[n.length-2]),a||dt(t[t.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HM{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e,t,n,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(n=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(n!==null&&kf(n.mutation,a,ir.empty(),Mt.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,gt()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=gt()){const a=Xa();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,n).next((l=>{let c=pf();return l.forEach(((d,f)=>{c=c.insert(d,f.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const n=Xa();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,gt())))}populateOverlays(e,t,n){const a=[];return n.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((c,d)=>{t.set(c,d)}))}))}computeViews(e,t,n,a){let l=or();const c=Af(),d=(function(){return Af()})();return t.forEach(((f,m)=>{const x=n.get(m.key);a.has(m.key)&&(x===void 0||x.mutation instanceof Ki)?l=l.insert(m.key,m):x!==void 0?(c.set(m.key,x.mutation.getFieldMask()),kf(x.mutation,m,x.mutation.getFieldMask(),Mt.now())):c.set(m.key,ir.empty())})),this.recalculateAndSaveOverlays(e,l).next((f=>(f.forEach(((m,x)=>c.set(m,x))),t.forEach(((m,x)=>d.set(m,new HM(x,c.get(m)??null)))),d)))}recalculateAndSaveOverlays(e,t){const n=Af();let a=new ss(((c,d)=>c-d)),l=gt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const d of c)d.keys().forEach((f=>{const m=t.get(f);if(m===null)return;let x=n.get(f)||ir.empty();x=d.applyToLocalView(m,x),n.set(f,x);const y=(a.get(d.batchId)||gt()).add(f);a=a.insert(d.batchId,y)}))})).next((()=>{const c=[],d=a.getReverseIterator();for(;d.hasNext();){const f=d.getNext(),m=f.key,x=f.value,y=pA();x.forEach((w=>{if(!l.has(w)){const v=jA(t.get(w),n.get(w));v!==null&&y.set(w,v),l=l.add(w)}})),c.push(this.documentOverlayCache.saveOverlays(e,m,y))}return ae.waitFor(c)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,a){return Y6(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):r_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,a):this.getDocumentsMatchingCollectionQuery(e,t,n,a)}getNextDocuments(e,t,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,a).next((l=>{const c=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,a-l.size):ae.resolve(Xa());let d=xd,f=l;return c.next((m=>ae.forEach(m,((x,y)=>(d<y.largestBatchId&&(d=y.largestBatchId),l.get(x)?ae.resolve():this.remoteDocumentCache.getEntry(e,x).next((w=>{f=f.insert(x,w)}))))).next((()=>this.populateOverlays(e,m,l))).next((()=>this.computeViews(e,f,m,gt()))).next((x=>({batchId:d,changes:gA(x)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ue(t)).next((n=>{let a=pf();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,a){const l=t.collectionGroup;let c=pf();return this.indexManager.getCollectionParents(e,l).next((d=>ae.forEach(d,(f=>{const m=(function(y,w){return new Gi(w,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)})(t,f.child(l));return this.getDocumentsMatchingCollectionQuery(e,m,n,a).next((x=>{x.forEach(((y,w)=>{c=c.insert(y,w)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,n,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,l,a)))).next((c=>{l.forEach(((f,m)=>{const x=m.getKey();c.get(x)===null&&(c=c.insert(x,as.newInvalidDocument(x)))}));let d=pf();return c.forEach(((f,m)=>{const x=l.get(f);x!==void 0&&kf(x.mutation,m,ir.empty(),Mt.now()),Tm(t,m)&&(d=d.insert(f,m))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GM{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return ae.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:ks(a.createTime)}})(t)),ae.resolve()}getNamedQuery(e,t){return ae.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(a){return{name:a.name,query:f_(a.bundledQuery),readTime:ks(a.readTime)}})(t)),ae.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WM{constructor(){this.overlays=new ss(Ue.comparator),this.Lr=new Map}getOverlay(e,t){return ae.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Xa();return ae.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&n.set(a,l)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((a,l)=>{this.bt(e,t,l)})),ae.resolve()}removeOverlaysForBatchId(e,t,n){const a=this.Lr.get(n);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.Lr.delete(n)),ae.resolve()}getOverlaysForCollection(e,t,n){const a=Xa(),l=t.length+1,c=new Ue(t.child("")),d=this.overlays.getIteratorFrom(c);for(;d.hasNext();){const f=d.getNext().value,m=f.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===l&&f.largestBatchId>n&&a.set(f.getKey(),f)}return ae.resolve(a)}getOverlaysForCollectionGroup(e,t,n,a){let l=new ss(((m,x)=>m-x));const c=this.overlays.getIterator();for(;c.hasNext();){const m=c.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>n){let x=l.get(m.largestBatchId);x===null&&(x=Xa(),l=l.insert(m.largestBatchId,x)),x.set(m.getKey(),m)}}const d=Xa(),f=l.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((m,x)=>d.set(m,x))),!(d.size()>=a)););return ae.resolve(d)}bt(e,t,n){const a=this.overlays.get(n.key);if(a!==null){const c=this.Lr.get(a.largestBatchId).delete(n.key);this.Lr.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(n.key,new u_(t,n));let l=this.Lr.get(t);l===void 0&&(l=gt(),this.Lr.set(t,l)),this.Lr.set(t,l.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KM{constructor(){this.sessionToken=_s.EMPTY_BYTE_STRING}getSessionToken(e){return ae.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ae.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(){this.kr=new qt(nn.Kr),this.qr=new qt(nn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const n=new nn(e,t);this.kr=this.kr.add(n),this.qr=this.qr.add(n)}$r(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Wr(new nn(e,t))}Qr(e,t){e.forEach((n=>this.removeReference(n,t)))}Gr(e){const t=new Ue(new Nt([])),n=new nn(t,e),a=new nn(t,e+1),l=[];return this.qr.forEachInRange([n,a],(c=>{this.Wr(c),l.push(c.key)})),l}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Ue(new Nt([])),n=new nn(t,e),a=new nn(t,e+1);let l=gt();return this.qr.forEachInRange([n,a],(c=>{l=l.add(c.key)})),l}containsKey(e){const t=new nn(e,0),n=this.kr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class nn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Ue.comparator(e.key,t.key)||dt(e.Hr,t.Hr)}static Ur(e,t){return dt(e.Hr,t.Hr)||Ue.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new qt(nn.Kr)}checkEmpty(e){return ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,a){const l=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new l_(l,t,n,a);this.mutationQueue.push(c);for(const d of a)this.Jr=this.Jr.add(new nn(d.key,l)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return ae.resolve(c)}lookupMutationBatch(e,t){return ae.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,a=this.Xr(n),l=a<0?0:a;return ae.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ae.resolve(this.mutationQueue.length===0?Go:this.Yn-1)}getAllMutationBatches(e){return ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new nn(t,0),a=new nn(t,Number.POSITIVE_INFINITY),l=[];return this.Jr.forEachInRange([n,a],(c=>{const d=this.Zr(c.Hr);l.push(d)})),ae.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new qt(dt);return t.forEach((a=>{const l=new nn(a,0),c=new nn(a,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([l,c],(d=>{n=n.add(d.Hr)}))})),ae.resolve(this.Yr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,a=n.length+1;let l=n;Ue.isDocumentKey(l)||(l=l.child(""));const c=new nn(new Ue(l),0);let d=new qt(dt);return this.Jr.forEachWhile((f=>{const m=f.key.path;return!!n.isPrefixOf(m)&&(m.length===a&&(d=d.add(f.Hr)),!0)}),c),ae.resolve(this.Yr(d))}Yr(e){const t=[];return e.forEach((n=>{const a=this.Zr(n);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Qe(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Jr;return ae.forEach(t.mutations,(a=>{const l=new nn(a.key,t.batchId);return n=n.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Jr=n}))}nr(e){}containsKey(e,t){const n=new nn(t,0),a=this.Jr.firstAfterOrEqual(n);return ae.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ae.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(e){this.ti=e,this.docs=(function(){return new ss(Ue.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,a=this.docs.get(n),l=a?a.size:0,c=this.ti(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ae.resolve(n?n.document.mutableCopy():as.newInvalidDocument(t))}getEntries(e,t){let n=or();return t.forEach((a=>{const l=this.docs.get(a);n=n.insert(a,l?l.document.mutableCopy():as.newInvalidDocument(a))})),ae.resolve(n)}getDocumentsMatchingQuery(e,t,n,a){let l=or();const c=t.path,d=new Ue(c.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(d);for(;f.hasNext();){const{key:m,value:{document:x}}=f.getNext();if(!c.isPrefixOf(m.path))break;m.path.length>c.length+1||Qv(RI(x),n)<=0||(a.has(x.key)||Tm(t,x))&&(l=l.insert(x.key,x.mutableCopy()))}return ae.resolve(l)}getAllFromCollectionGroup(e,t,n,a){qe(9500)}ni(e,t){return ae.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new JM(this)}getSize(e){return ae.resolve(this.size)}}class JM extends ZA{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,a)=>{a.isValidDocument()?t.push(this.Mr.addEntry(e,a)):this.Mr.removeEntry(n)})),ae.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XM{constructor(e){this.persistence=e,this.ri=new Wi((t=>pc(t)),Nm),this.lastRemoteSnapshotVersion=Xe.min(),this.highestTargetId=0,this.ii=0,this.si=new p_,this.targetCount=0,this.oi=vc._r()}forEachTarget(e,t){return this.ri.forEach(((n,a)=>t(a))),ae.resolve()}getLastRemoteSnapshotVersion(e){return ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ae.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),ae.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ii&&(this.ii=t),ae.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new vc(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,ae.resolve()}updateTargetData(e,t){return this.lr(t),ae.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,ae.resolve()}removeTargets(e,t,n){let a=0;const l=[];return this.ri.forEach(((c,d)=>{d.sequenceNumber<=t&&n.get(d.targetId)===null&&(this.ri.delete(c),l.push(this.removeMatchingKeysForTargetId(e,d.targetId)),a++)})),ae.waitFor(l).next((()=>a))}getTargetCount(e){return ae.resolve(this.targetCount)}getTargetData(e,t){const n=this.ri.get(t)||null;return ae.resolve(n)}addMatchingKeys(e,t,n){return this.si.$r(t,n),ae.resolve()}removeMatchingKeys(e,t,n){this.si.Qr(t,n);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((c=>{l.push(a.markPotentiallyOrphaned(e,c))})),ae.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),ae.resolve()}getMatchingKeysForTargetId(e,t){const n=this.si.jr(t);return ae.resolve(n)}containsKey(e,t){return ae.resolve(this.si.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(e,t){this._i={},this.overlays={},this.ai=new ar(0),this.ui=!1,this.ui=!0,this.ci=new KM,this.referenceDelegate=e(this),this.li=new XM(this),this.indexManager=new MM,this.remoteDocumentCache=(function(a){return new YM(a)})((n=>this.referenceDelegate.hi(n))),this.serializer=new zA(t),this.Pi=new GM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new WM,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this._i[e.toKey()];return n||(n=new QM(t,this.referenceDelegate),this._i[e.toKey()]=n),n}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,n){Ce("MemoryPersistence","Starting transaction:",e);const a=new ZM(this.ai.next());return this.referenceDelegate.Ti(),n(a).next((l=>this.referenceDelegate.Ii(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return ae.or(Object.values(this._i).map((n=>()=>n.containsKey(e,t))))}}class ZM extends OI{constructor(e){super(),this.currentSequenceNumber=e}}class K0{constructor(e){this.persistence=e,this.Ri=new p_,this.Ai=null}static Vi(e){return new K0(e)}get di(){if(this.Ai)return this.Ai;throw qe(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.di.delete(n.toString()),ae.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.di.add(n.toString()),ae.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),ae.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((a=>this.di.add(a.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.di.add(l.toString())))})).next((()=>n.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ae.forEach(this.di,(n=>{const a=Ue.fromPath(n);return this.mi(e,a).next((l=>{l||t.removeEntry(a,Xe.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((n=>{n?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return ae.or([()=>ae.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class c0{constructor(e,t){this.persistence=e,this.fi=new Wi((n=>On(n.path)),((n,a)=>n.isEqual(a))),this.garbageCollector=XA(this,t)}static Vi(e,t){return new c0(e,t)}Ti(){}Ii(e){return ae.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((a=>n+a))))}pr(e){let t=0;return this.mr(e,(n=>{t++})).next((()=>t))}mr(e,t){return ae.forEach(this.fi,((n,a)=>this.wr(e,n,a).next((l=>l?ae.resolve():t(a)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ni(e,(c=>this.wr(e,c,t).next((d=>{d||(n++,l.removeEntry(c,Xe.min()))})))).next((()=>l.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),ae.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),ae.resolve()}removeReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),ae.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),ae.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Up(e.data.value)),t}wr(e,t,n){return ae.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.fi.get(t);return ae.resolve(a!==void 0&&a>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(e){this.serializer=e}k(e,t,n,a){const l=new L0("createOrUpgrade",t);n<1&&a>=1&&((function(f){f.createObjectStore(jm)})(e),(function(f){f.createObjectStore(Wf,{keyPath:d6}),f.createObjectStore(ha,{keyPath:WS,autoIncrement:!0}).createIndex(nc,KS,{unique:!0}),f.createObjectStore(bd)})(e),LT(e),(function(f){f.createObjectStore(Kl)})(e));let c=ae.resolve();return n<3&&a>=3&&(n!==0&&((function(f){f.deleteObjectStore(wd),f.deleteObjectStore(yd),f.deleteObjectStore(uc)})(e),LT(e)),c=c.next((()=>(function(f){const m=f.store(uc),x={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Xe.min().toTimestamp(),targetCount:0};return m.put(s0,x)})(l)))),n<4&&a>=4&&(n!==0&&(c=c.next((()=>(function(f,m){return m.store(ha).H().next((y=>{f.deleteObjectStore(ha),f.createObjectStore(ha,{keyPath:WS,autoIncrement:!0}).createIndex(nc,KS,{unique:!0});const w=m.store(ha),v=y.map((T=>w.put(T)));return ae.waitFor(v)}))})(e,l)))),c=c.next((()=>{(function(f){f.createObjectStore(vd,{keyPath:w6})})(e)}))),n<5&&a>=5&&(c=c.next((()=>this.gi(l)))),n<6&&a>=6&&(c=c.next((()=>((function(f){f.createObjectStore(Kf)})(e),this.pi(l))))),n<7&&a>=7&&(c=c.next((()=>this.yi(l)))),n<8&&a>=8&&(c=c.next((()=>this.wi(e,l)))),n<9&&a>=9&&(c=c.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),n<10&&a>=10&&(c=c.next((()=>this.bi(l)))),n<11&&a>=11&&(c=c.next((()=>{(function(f){f.createObjectStore(V0,{keyPath:v6})})(e),(function(f){f.createObjectStore(U0,{keyPath:_6})})(e)}))),n<12&&a>=12&&(c=c.next((()=>{(function(f){const m=f.createObjectStore(F0,{keyPath:A6});m.createIndex(Rw,k6,{unique:!1}),m.createIndex(BI,C6,{unique:!1})})(e)}))),n<13&&a>=13&&(c=c.next((()=>(function(f){const m=f.createObjectStore(t0,{keyPath:f6});m.createIndex(Lp,m6),m.createIndex(VI,g6)})(e))).next((()=>this.Si(e,l))).next((()=>e.deleteObjectStore(Kl)))),n<14&&a>=14&&(c=c.next((()=>this.Di(e,l)))),n<15&&a>=15&&(c=c.next((()=>(function(f){f.createObjectStore(Xv,{keyPath:j6,autoIncrement:!0}).createIndex(Cw,N6,{unique:!1}),f.createObjectStore(Tf,{keyPath:S6}).createIndex(FI,T6,{unique:!1}),f.createObjectStore(Ef,{keyPath:E6}).createIndex($I,I6,{unique:!1})})(e)))),n<16&&a>=16&&(c=c.next((()=>{t.objectStore(Tf).clear()})).next((()=>{t.objectStore(Ef).clear()}))),n<17&&a>=17&&(c=c.next((()=>{(function(f){f.createObjectStore(Zv,{keyPath:R6})})(e)}))),n<18&&a>=18&&aI()&&(c=c.next((()=>{t.objectStore(Tf).clear()})).next((()=>{t.objectStore(Ef).clear()}))),c}pi(e){let t=0;return e.store(Kl).ee(((n,a)=>{t+=l0(a)})).next((()=>{const n={byteSize:t};return e.store(Kf).put(kw,n)}))}gi(e){const t=e.store(Wf),n=e.store(ha);return t.H().next((a=>ae.forEach(a,(l=>{const c=IDBKeyRange.bound([l.userId,Go],[l.userId,l.lastAcknowledgedBatchId]);return n.H(nc,c).next((d=>ae.forEach(d,(f=>{Qe(f.userId===l.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const m=Jl(this.serializer,f);return KA(e,l.userId,m).next((()=>{}))}))))}))))}yi(e){const t=e.store(wd),n=e.store(Kl);return e.store(uc).get(s0).next((a=>{const l=[];return n.ee(((c,d)=>{const f=new Nt(c),m=(function(y){return[0,On(y)]})(f);l.push(t.get(m).next((x=>x?ae.resolve():(y=>t.put({targetId:0,path:On(y),sequenceNumber:a.highestListenSequenceNumber}))(f))))})).next((()=>ae.waitFor(l)))}))}wi(e,t){e.createObjectStore(Qf,{keyPath:y6});const n=t.store(Qf),a=new g_,l=c=>{if(a.add(c)){const d=c.lastSegment(),f=c.popLast();return n.put({collectionId:d,parent:On(f)})}};return t.store(Kl).ee({Y:!0},((c,d)=>{const f=new Nt(c);return l(f.popLast())})).next((()=>t.store(bd).ee({Y:!0},(([c,d,f],m)=>{const x=Ja(d);return l(x.popLast())}))))}bi(e){const t=e.store(yd);return t.ee(((n,a)=>{const l=bf(a),c=qA(this.serializer,l);return t.put(c)}))}Si(e,t){const n=t.store(Kl),a=[];return n.ee(((l,c)=>{const d=t.store(t0),f=(function(y){return y.document?new Ue(Nt.fromString(y.document.name).popFirst(5)):y.noDocument?Ue.fromSegments(y.noDocument.path):y.unknownDocument?Ue.fromSegments(y.unknownDocument.path):qe(36783)})(c).path.toArray(),m={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};a.push(d.put(m))})).next((()=>ae.waitFor(a)))}Di(e,t){const n=t.store(ha),a=ek(this.serializer),l=new x_(K0.Vi,this.serializer.yt);return n.H().next((c=>{const d=new Map;return c.forEach((f=>{let m=d.get(f.userId)??gt();Jl(this.serializer,f).keys().forEach((x=>m=m.add(x))),d.set(f.userId,m)})),ae.forEach(d,((f,m)=>{const x=new rn(m),y=G0.wt(this.serializer,x),w=l.getIndexManager(x),v=W0.wt(x,this.serializer,w,l.referenceDelegate);return new tk(a,v,y,w).recalculateAndSaveOverlaysForDocumentKeys(new Dw(t,ar.ce),f).next()}))}))}}function LT(s){s.createObjectStore(wd,{keyPath:x6}).createIndex(Jv,b6,{unique:!0}),s.createObjectStore(yd,{keyPath:"targetId"}).createIndex(UI,p6,{unique:!0}),s.createObjectStore(uc)}const Oo="IndexedDbPersistence",My=18e5,Ly=5e3,Vy="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",sk="main";class b_{constructor(e,t,n,a,l,c,d,f,m,x,y=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Ci=l,this.window=c,this.document=d,this.Fi=m,this.Mi=x,this.xi=y,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=w=>Promise.resolve(),!b_.v())throw new ke(me.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new BM(this,a),this.Ki=t+sk,this.serializer=new zA(f),this.qi=new ei(this.Ki,this.xi,new eL(this.serializer)),this.ci=new kM,this.li=new VM(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ek(this.serializer),this.Pi=new AM,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,x===!1&&As(Oo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ke(me.FAILED_PRECONDITION,Vy);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new ar(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>bp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(cl(e))return Ce(Oo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ce(Oo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return nf(e).get(Au).next((t=>ae.resolve(this.Xi(t))))}Yi(e){return bp(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,My)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const n=Zs(t,vd);return n.H().next((a=>{const l=this.ns(a,My),c=a.filter((d=>l.indexOf(d)===-1));return ae.forEach(c,(d=>n.delete(d.clientId))).next((()=>c))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?ae.resolve(!0):nf(e).get(Au).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Ly)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new ke(me.FAILED_PRECONDITION,Vy);return!1}}return!(!this.networkEnabled||!this.inForeground)||bp(e).H().next((n=>this.ns(n,Ly).find((a=>{if(this.clientId!==a.clientId){const l=!this.networkEnabled&&a.networkEnabled,c=!this.inForeground&&a.inForeground,d=this.networkEnabled===a.networkEnabled;if(l||c&&d)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Ce(Oo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[jm,vd],(e=>{const t=new Dw(e,ar.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((n=>this.ts(n.updateTimeMs,t)&&!this.ss(n.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>bp(e).H().next((t=>this.ns(t,My).map((n=>n.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return W0.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new LM(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return G0.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,n){Ce(Oo,"Starting transaction:",e);const a=t==="readonly"?"readonly":"readwrite",l=(function(f){return f===18?P6:f===17?GI:f===16?O6:f===15?e_:f===14?HI:f===13?qI:f===12?D6:f===11?zI:void qe(60245)})(this.xi);let c;return this.qi.runTransaction(e,a,l,(d=>(c=new Dw(d,this.ai?this.ai.next():ar.ce),t==="readwrite-primary"?this.ji(c).next((f=>!!f||this.Hi(c))).next((f=>{if(!f)throw As(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new ke(me.FAILED_PRECONDITION,DI);return n(c)})).next((f=>this.Zi(c).next((()=>f)))):this.Ps(c).next((()=>n(c)))))).then((d=>(c.raiseOnCommittedEvent(),d)))}Ps(e){return nf(e).get(Au).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Ly)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ke(me.FAILED_PRECONDITION,Vy)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return nf(e).put(Au,t)}static v(){return ei.v()}Ji(e){const t=nf(e);return t.get(Au).next((n=>this.Xi(n)?(Ce(Oo,"Releasing primary lease."),t.delete(Au)):ae.resolve()))}ts(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(As(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Oi=()=>{this._s();const t=/(?:Version|Mobile)\/1[456]/;rI()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){var t;try{const n=((t=this.Ui)==null?void 0:t.getItem(this.rs(e)))!==null;return Ce(Oo,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return As(Oo,"Failed to get zombied client id.",n),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){As("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function nf(s){return Zs(s,jm)}function bp(s){return Zs(s,vd)}function y_(s,e){let t=s.projectId;return s.isDefaultDatabase||(t+="."+s.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(e,t,n,a){this.targetId=e,this.fromCache=t,this.Ts=n,this.Is=a}static Es(e,t){let n=gt(),a=gt();for(const l of t.docChanges)switch(l.type){case 0:n=n.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new w_(e,t.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return rI()?8:PI(ps())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,a){const l={result:null};return this.gs(e,t).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ps(e,t,a,n).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new tL;return this.ys(e,t,c).next((d=>{if(l.result=d,this.As)return this.ws(e,t,c,d.size)}))})).next((()=>l.result))}ws(e,t,n,a){return n.documentReadCount<this.Vs?(Gu()<=jt.DEBUG&&Ce("QueryEngine","SDK will not create cache indexes for query:",Wu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ae.resolve()):(Gu()<=jt.DEBUG&&Ce("QueryEngine","Query:",Wu(t),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.ds*a?(Gu()<=jt.DEBUG&&Ce("QueryEngine","The SDK decides to create cache indexes for query:",Wu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Hn(t))):ae.resolve())}gs(e,t){if(oT(t))return ae.resolve(null);let n=Hn(t);return this.indexManager.getIndexType(e,n).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=a0(t,null,"F"),n=Hn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((l=>{const c=gt(...l);return this.fs.getDocuments(e,c).next((d=>this.indexManager.getMinOffset(e,n).next((f=>{const m=this.bs(t,d);return this.Ss(t,m,c,f.readTime)?this.gs(e,a0(t,null,"F")):this.Ds(e,m,t,f)}))))})))))}ps(e,t,n,a){return oT(t)||a.isEqual(Xe.min())?ae.resolve(null):this.fs.getDocuments(e,n).next((l=>{const c=this.bs(t,l);return this.Ss(t,c,n,a)?ae.resolve(null):(Gu()<=jt.DEBUG&&Ce("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Wu(t)),this.Ds(e,c,t,CI(a,xd)).next((d=>d)))}))}bs(e,t){let n=new qt(fA(e));return t.forEach(((a,l)=>{Tm(e,l)&&(n=n.add(l))})),n}Ss(e,t,n,a){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ys(e,t,n){return Gu()<=jt.DEBUG&&Ce("QueryEngine","Using full collection scan to execute query:",Wu(t)),this.fs.getDocumentsMatchingQuery(e,t,Or.min(),n)}Ds(e,t,n,a){return this.fs.getDocumentsMatchingQuery(e,n,a).next((l=>(t.forEach((c=>{l=l.insert(c.key,c)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v_="LocalStore",sL=3e8;class nL{constructor(e,t,n,a){this.persistence=e,this.Cs=t,this.serializer=a,this.vs=new ss(dt),this.Fs=new Wi((l=>pc(l)),Nm),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(n)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tk(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function rk(s,e,t,n){return new nL(s,e,t,n)}async function ak(s,e){const t=Be(s);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let a;return t.mutationQueue.getAllMutationBatches(n).next((l=>(a=l,t.Os(e),t.mutationQueue.getAllMutationBatches(n)))).next((l=>{const c=[],d=[];let f=gt();for(const m of a){c.push(m.batchId);for(const x of m.mutations)f=f.add(x.key)}for(const m of l){d.push(m.batchId);for(const x of m.mutations)f=f.add(x.key)}return t.localDocuments.getDocuments(n,f).next((m=>({Ns:m,removedBatchIds:c,addedBatchIds:d})))}))}))}function rL(s,e){const t=Be(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const a=e.batch.keys(),l=t.xs.newChangeBuffer({trackRemovals:!0});return(function(d,f,m,x){const y=m.batch,w=y.keys();let v=ae.resolve();return w.forEach((T=>{v=v.next((()=>x.getEntry(f,T))).next((I=>{const N=m.docVersions.get(T);Qe(N!==null,48541),I.version.compareTo(N)<0&&(y.applyToRemoteDocument(I,m),I.isValidDocument()&&(I.setReadTime(m.commitVersion),x.addEntry(I)))}))})),v.next((()=>d.mutationQueue.removeMutationBatch(f,y)))})(t,n,e,l).next((()=>l.apply(n))).next((()=>t.mutationQueue.performConsistencyCheck(n))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(d){let f=gt();for(let m=0;m<d.mutationResults.length;++m)d.mutationResults[m].transformResults.length>0&&(f=f.add(d.batch.mutations[m].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(n,a)))}))}function ik(s){const e=Be(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function aL(s,e){const t=Be(s),n=e.snapshotVersion;let a=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=t.xs.newChangeBuffer({trackRemovals:!0});a=t.vs;const d=[];e.targetChanges.forEach(((x,y)=>{const w=a.get(y);if(!w)return;d.push(t.li.removeMatchingKeys(l,x.removedDocuments,y).next((()=>t.li.addMatchingKeys(l,x.addedDocuments,y))));let v=w.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(y)!==null?v=v.withResumeToken(_s.EMPTY_BYTE_STRING,Xe.min()).withLastLimboFreeSnapshotVersion(Xe.min()):x.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(x.resumeToken,n)),a=a.insert(y,v),(function(I,N,P){return I.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=sL?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0})(w,v,x)&&d.push(t.li.updateTargetData(l,v))}));let f=or(),m=gt();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(l,x))})),d.push(ok(l,c,e.documentUpdates).next((x=>{f=x.Bs,m=x.Ls}))),!n.isEqual(Xe.min())){const x=t.li.getLastRemoteSnapshotVersion(l).next((y=>t.li.setTargetsMetadata(l,l.currentSequenceNumber,n)));d.push(x)}return ae.waitFor(d).next((()=>c.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,f,m))).next((()=>f))})).then((l=>(t.vs=a,l)))}function ok(s,e,t){let n=gt(),a=gt();return t.forEach((l=>n=n.add(l))),e.getEntries(s,n).next((l=>{let c=or();return t.forEach(((d,f)=>{const m=l.get(d);f.isFoundDocument()!==m.isFoundDocument()&&(a=a.add(d)),f.isNoDocument()&&f.version.isEqual(Xe.min())?(e.removeEntry(d,f.readTime),c=c.insert(d,f)):!m.isValidDocument()||f.version.compareTo(m.version)>0||f.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(f),c=c.insert(d,f)):Ce(v_,"Ignoring outdated watch update for ",d,". Current version:",m.version," Watch version:",f.version)})),{Bs:c,Ls:a}}))}function iL(s,e){const t=Be(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=Go),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function Id(s,e){const t=Be(s);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let a;return t.li.getTargetData(n,e).next((l=>l?(a=l,ae.resolve(a)):t.li.allocateTargetId(n).next((c=>(a=new Ri(e,c,"TargetPurposeListen",n.currentSequenceNumber),t.li.addTargetData(n,a).next((()=>a)))))))})).then((n=>{const a=t.vs.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.vs=t.vs.insert(n.targetId,n),t.Fs.set(e,n.targetId)),n}))}async function Ad(s,e,t){const n=Be(s),a=n.vs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",l,(c=>n.persistence.referenceDelegate.removeTarget(c,a)))}catch(c){if(!cl(c))throw c;Ce(v_,`Failed to update sequence numbers for target ${e}: ${c}`)}n.vs=n.vs.remove(e),n.Fs.delete(a.target)}function u0(s,e,t){const n=Be(s);let a=Xe.min(),l=gt();return n.persistence.runTransaction("Execute query","readwrite",(c=>(function(f,m,x){const y=Be(f),w=y.Fs.get(x);return w!==void 0?ae.resolve(y.vs.get(w)):y.li.getTargetData(m,x)})(n,c,Hn(e)).next((d=>{if(d)return a=d.lastLimboFreeSnapshotVersion,n.li.getMatchingKeysForTargetId(c,d.targetId).next((f=>{l=f}))})).next((()=>n.Cs.getDocumentsMatchingQuery(c,e,t?a:Xe.min(),t?l:gt()))).next((d=>(uk(n,hA(e),d),{documents:d,ks:l})))))}function lk(s,e){const t=Be(s),n=Be(t.li),a=t.vs.get(e);return a?Promise.resolve(a.target):t.persistence.runTransaction("Get target data","readonly",(l=>n.At(l,e).next((c=>c?c.target:null))))}function ck(s,e){const t=Be(s),n=t.Ms.get(e)||Xe.min();return t.persistence.runTransaction("Get new document changes","readonly",(a=>t.xs.getAllFromCollectionGroup(a,e,CI(n,xd),Number.MAX_SAFE_INTEGER))).then((a=>(uk(t,e,a),a)))}function uk(s,e,t){let n=s.Ms.get(e)||Xe.min();t.forEach(((a,l)=>{l.readTime.compareTo(n)>0&&(n=l.readTime)})),s.Ms.set(e,n)}async function oL(s,e,t,n){const a=Be(s);let l=gt(),c=or();for(const m of t){const x=e.Ks(m.metadata.name);m.document&&(l=l.add(x));const y=e.qs(m);y.setReadTime(e.Us(m.metadata.readTime)),c=c.insert(x,y)}const d=a.xs.newChangeBuffer({trackRemovals:!0}),f=await Id(a,(function(x){return Hn(Bd(Nt.fromString(`__bundle__/docs/${x}`)))})(n));return a.persistence.runTransaction("Apply bundle documents","readwrite",(m=>ok(m,d,c).next((x=>(d.apply(m),x))).next((x=>a.li.removeMatchingKeysForTargetId(m,f.targetId).next((()=>a.li.addMatchingKeys(m,l,f.targetId))).next((()=>a.localDocuments.getLocalViewOfDocuments(m,x.Bs,x.Ls))).next((()=>x.Bs))))))}async function lL(s,e,t=gt()){const n=await Id(s,Hn(f_(e.bundledQuery))),a=Be(s);return a.persistence.runTransaction("Save named query","readwrite",(l=>{const c=ks(e.readTime);if(n.snapshotVersion.compareTo(c)>=0)return a.Pi.saveNamedQuery(l,e);const d=n.withResumeToken(_s.EMPTY_BYTE_STRING,c);return a.vs=a.vs.insert(d.targetId,d),a.li.updateTargetData(l,d).next((()=>a.li.removeMatchingKeysForTargetId(l,n.targetId))).next((()=>a.li.addMatchingKeys(l,t,n.targetId))).next((()=>a.Pi.saveNamedQuery(l,e)))}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dk="firestore_clients";function VT(s,e){return`${dk}_${s}_${e}`}const hk="firestore_mutations";function UT(s,e,t){let n=`${hk}_${s}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}const fk="firestore_targets";function Uy(s,e){return`${fk}_${s}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ha="SharedClientState";class d0{constructor(e,t,n,a){this.user=e,this.batchId=t,this.state=n,this.error=a}static $s(e,t,n){const a=JSON.parse(n);let l,c=typeof a=="object"&&["pending","acknowledged","rejected"].indexOf(a.state)!==-1&&(a.error===void 0||typeof a.error=="object");return c&&a.error&&(c=typeof a.error.message=="string"&&typeof a.error.code=="string",c&&(l=new ke(a.error.code,a.error.message))),c?new d0(e,t,a.state,l):(As(Ha,`Failed to parse mutation state for ID '${t}': ${n}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Cf{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static $s(e,t){const n=JSON.parse(t);let a,l=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return l&&n.error&&(l=typeof n.error.message=="string"&&typeof n.error.code=="string",l&&(a=new ke(n.error.code,n.error.message))),l?new Cf(e,n.state,a):(As(Ha,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class h0{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const n=JSON.parse(t);let a=typeof n=="object"&&n.activeTargetIds instanceof Array,l=a_();for(let c=0;a&&c<n.activeTargetIds.length;++c)a=MI(n.activeTargetIds[c]),l=l.add(n.activeTargetIds[c]);return a?new h0(e,l):(As(Ha,`Failed to parse client data for instance '${e}': ${t}`),null)}}class __{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new __(t.clientId,t.onlineState):(As(Ha,`Failed to parse online state: ${e}`),null)}}class Kw{constructor(){this.activeTargetIds=a_()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Fy{constructor(e,t,n,a,l){this.window=e,this.Ci=t,this.persistenceKey=n,this.zs=a,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new ss(dt),this.started=!1,this.Zs=[];const c=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=l,this.Xs=VT(this.persistenceKey,this.zs),this.Ys=(function(f){return`firestore_sequence_number_${f}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new Kw),this.eo=new RegExp(`^${dk}_${c}_([^_]*)$`),this.no=new RegExp(`^${hk}_${c}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${fk}_${c}_(\\d+)$`),this.io=(function(f){return`firestore_online_state_${f}`})(this.persistenceKey),this.so=(function(f){return`firestore_bundle_loaded_v2_${f}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const n of e){if(n===this.zs)continue;const a=this.getItem(VT(this.persistenceKey,n));if(a){const l=h0.$s(n,a);l&&(this.Js=this.Js.insert(l.clientId,l))}}this.oo();const t=this.storage.getItem(this.io);if(t){const n=this._o(t);n&&this.ao(n)}for(const n of this.Zs)this.Hs(n);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((n,a)=>{a.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,n){this.co(e,t,n),this.lo(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const a=this.storage.getItem(Uy(this.persistenceKey,e));if(a){const l=Cf.$s(e,a);l&&(n=l.state)}}return t&&this.ho.Qs(e),this.oo(),n}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Uy(this.persistenceKey,e))}updateQueryState(e,t,n){this.Po(e,t,n)}handleUserChange(e,t,n){t.forEach((a=>{this.lo(a)})),this.currentUser=e,n.forEach((a=>{this.addPendingMutation(a)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Ce(Ha,"READ",e,t),t}setItem(e,t){Ce(Ha,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Ce(Ha,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(Ce(Ha,"EVENT",t.key,t.newValue),t.key===this.Xs)return void As("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const n=this.Eo(t.key);return this.Ro(n,null)}{const n=this.Ao(t.key,t.newValue);if(n)return this.Ro(n.clientId,n)}}else if(this.no.test(t.key)){if(t.newValue!==null){const n=this.Vo(t.key,t.newValue);if(n)return this.mo(n)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const n=this.fo(t.key,t.newValue);if(n)return this.po(n)}}else if(t.key===this.io){if(t.newValue!==null){const n=this._o(t.newValue);if(n)return this.ao(n)}}else if(t.key===this.Ys){const n=(function(l){let c=ar.ce;if(l!=null)try{const d=JSON.parse(l);Qe(typeof d=="number",30636,{yo:l}),c=d}catch(d){As(Ha,"Failed to read sequence number from WebStorage",d)}return c})(t.newValue);n!==ar.ce&&this.sequenceNumberHandler(n)}else if(t.key===this.so){const n=this.wo(t.newValue);await Promise.all(n.map((a=>this.syncEngine.bo(a))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,n){const a=new d0(this.currentUser,e,t,n),l=UT(this.persistenceKey,this.currentUser,e);this.setItem(l,a.Ws())}lo(e){const t=UT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,n){const a=Uy(this.persistenceKey,e),l=new Cf(e,t,n);this.setItem(a,l.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const n=this.Eo(e);return h0.$s(n,t)}Vo(e,t){const n=this.no.exec(e),a=Number(n[1]),l=n[2]!==void 0?n[2]:null;return d0.$s(new rn(l),a,t)}fo(e,t){const n=this.ro.exec(e),a=Number(n[1]);return Cf.$s(a,t)}_o(e){return __.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);Ce(Ha,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const n=t?this.Js.insert(e,t):this.Js.remove(e),a=this.uo(this.Js),l=this.uo(n),c=[],d=[];return l.forEach((f=>{a.has(f)||c.push(f)})),a.forEach((f=>{l.has(f)||d.push(f)})),this.syncEngine.Co(c,d).then((()=>{this.Js=n}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=a_();return e.forEach(((n,a)=>{t=t.unionWith(a.activeTargetIds)})),t}}class mk{constructor(){this.vo=new Kw,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,n){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Kw,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FT="ConnectivityMonitor";class $T{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Ce(FT,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Ce(FT,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yp=null;function Qw(){return yp===null?yp=(function(){return 268435456+Math.round(2147483648*Math.random())})():yp++,"0x"+yp.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y="RestConnection",uL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class dL{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${n}/databases/${a}`,this.$o=this.databaseId.database===Ow?`project_id=${n}`:`project_id=${n}&database_id=${a}`}Wo(e,t,n,a,l){const c=Qw(),d=this.Qo(e,t.toUriEncodedString());Ce($y,`Sending RPC '${e}' ${c}:`,d,n);const f={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(f,a,l);const{host:m}=new URL(d),x=ol(m);return this.zo(e,d,f,n,x).then((y=>(Ce($y,`Received RPC '${e}' ${c}: `,y),y)),(y=>{throw ri($y,`RPC '${e}' ${c} failed with error: `,y,"url: ",d,"request:",n),y}))}jo(e,t,n,a,l,c){return this.Wo(e,t,n,a,l)}Go(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+$d})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),n&&n.headers.forEach(((a,l)=>e[l]=a))}Qo(e,t){const n=uL[e];let a=`${this.qo}/v1/${t}:${n}`;return this.databaseInfo.apiKey&&(a=`${a}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),a}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const An="WebChannelConnection",rf=(s,e,t)=>{s.listen(e,(n=>{try{t(n)}catch(a){setTimeout((()=>{throw a}),0)}}))};class id extends dL{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!id.c_){const e=jI();rf(e,_I.STAT_EVENT,(t=>{t.stat===Ew.PROXY?Ce(An,"STAT_EVENT: detected buffering proxy"):t.stat===Ew.NOPROXY&&Ce(An,"STAT_EVENT: detected no buffering proxy")})),id.c_=!0}}zo(e,t,n,a,l){const c=Qw();return new Promise(((d,f)=>{const m=new wI;m.setWithCredentials(!0),m.listenOnce(vI.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case Op.NO_ERROR:const y=m.getResponseJson();Ce(An,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(y)),d(y);break;case Op.TIMEOUT:Ce(An,`RPC '${e}' ${c} timed out`),f(new ke(me.DEADLINE_EXCEEDED,"Request time out"));break;case Op.HTTP_ERROR:const w=m.getStatus();if(Ce(An,`RPC '${e}' ${c} failed with status:`,w,"response text:",m.getResponseText()),w>0){let v=m.getResponseJson();Array.isArray(v)&&(v=v[0]);const T=v==null?void 0:v.error;if(T&&T.status&&T.message){const I=(function(P){const U=P.toLowerCase().replace(/_/g,"-");return Object.values(me).indexOf(U)>=0?U:me.UNKNOWN})(T.status);f(new ke(I,T.message))}else f(new ke(me.UNKNOWN,"Server responded with status "+m.getStatus()))}else f(new ke(me.UNAVAILABLE,"Connection failed."));break;default:qe(9055,{l_:e,streamId:c,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{Ce(An,`RPC '${e}' ${c} completed.`)}}));const x=JSON.stringify(a);Ce(An,`RPC '${e}' ${c} sending request:`,a),m.send(t,"POST",x,n,15)}))}T_(e,t,n){const a=Qw(),l=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=this.createWebChannelTransport(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(d.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Go(d.initMessageHeaders,t,n),d.encodeInitMessageHeaders=!0;const m=l.join("");Ce(An,`Creating RPC '${e}' stream ${a}: ${m}`,d);const x=c.createWebChannel(m,d);this.I_(x);let y=!1,w=!1;const v=new hL({Ho:T=>{w?Ce(An,`Not sending because RPC '${e}' stream ${a} is closed:`,T):(y||(Ce(An,`Opening RPC '${e}' stream ${a} transport.`),x.open(),y=!0),Ce(An,`RPC '${e}' stream ${a} sending:`,T),x.send(T))},Jo:()=>x.close()});return rf(x,gf.EventType.OPEN,(()=>{w||(Ce(An,`RPC '${e}' stream ${a} transport opened.`),v.i_())})),rf(x,gf.EventType.CLOSE,(()=>{w||(w=!0,Ce(An,`RPC '${e}' stream ${a} transport closed`),v.o_(),this.E_(x))})),rf(x,gf.EventType.ERROR,(T=>{w||(w=!0,ri(An,`RPC '${e}' stream ${a} transport errored. Name:`,T.name,"Message:",T.message),v.o_(new ke(me.UNAVAILABLE,"The operation could not be completed")))})),rf(x,gf.EventType.MESSAGE,(T=>{var I;if(!w){const N=T.data[0];Qe(!!N,16349);const P=N,U=(P==null?void 0:P.error)||((I=P[0])==null?void 0:I.error);if(U){Ce(An,`RPC '${e}' stream ${a} received error:`,U);const V=U.status;let q=(function(k){const M=$s[k];if(M!==void 0)return TA(M)})(V),W=U.message;q===void 0&&(q=me.INTERNAL,W="Unknown error status: "+V+" with message "+U.message),w=!0,v.o_(new ke(q,W)),x.close()}else Ce(An,`RPC '${e}' stream ${a} received:`,N),v.__(N)}})),id.u_(),setTimeout((()=>{v.s_()}),0),v}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,n){super.Go(e,t,n),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return NI()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fL(s){return new id(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gk(){return typeof window<"u"?window:null}function qp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function km(s){return new bM(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */id.c_=!1;class j_{constructor(e,t,n=1e3,a=1.5,l=6e4){this.Ci=e,this.timerId=t,this.R_=n,this.A_=a,this.V_=l,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),n=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-n);a>0&&Ce("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BT="PersistentStream";class pk{constructor(e,t,n,a,l,c,d,f){this.Ci=e,this.b_=n,this.S_=a,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=d,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new j_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===me.RESOURCE_EXHAUSTED?(As(t.toString()),As("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===me.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,a])=>{this.D_===t&&this.G_(n,a)}),(n=>{e((()=>{const a=new ke(me.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(a)}))}))}G_(e,t){const n=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{n((()=>this.listener.Zo()))})),this.stream.Yo((()=>{n((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((a=>{n((()=>this.z_(a)))})),this.stream.onMessage((a=>{n((()=>++this.F_==1?this.H_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ce(BT,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Ce(BT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class mL extends pk{constructor(e,t,n,a,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,a,c),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=vM(this.serializer,e),n=(function(l){if(!("targetChange"in l))return Xe.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?Xe.min():c.readTime?ks(c.readTime):Xe.min()})(e);return this.listener.J_(t,n)}Z_(e){const t={};t.database=zw(this.serializer),t.addTarget=(function(l,c){let d;const f=c.target;if(d=n0(f)?{documents:MA(l,f)}:{query:LA(l,f).ft},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){d.resumeToken=kA(l,c.resumeToken);const m=$w(l,c.expectedCount);m!==null&&(d.expectedCount=m)}else if(c.snapshotVersion.compareTo(Xe.min())>0){d.readTime=Ed(l,c.snapshotVersion.toTimestamp());const m=$w(l,c.expectedCount);m!==null&&(d.expectedCount=m)}return d})(this.serializer,e);const n=jM(this.serializer,e);n&&(t.labels=n),this.K_(t)}X_(e){const t={};t.database=zw(this.serializer),t.removeTarget=e,this.K_(t)}}class gL extends pk{constructor(e,t,n,a,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,a,c),this.serializer=l}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Qe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Qe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Qe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=_M(e.writeResults,e.commitTime),n=ks(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=zw(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((n=>tm(this.serializer,n)))};this.K_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{}class xL extends pL{constructor(e,t,n,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new ke(me.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,n,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Wo(e,Bw(t,n),a,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new ke(me.UNKNOWN,l.toString())}))}jo(e,t,n,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.jo(e,Bw(t,n),a,c,d,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new ke(me.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function bL(s,e,t,n){return new xL(s,e,t,n)}class yL{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(As(t),this.aa=!1):Ce("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _c="RemoteStore";class wL{constructor(e,t,n,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=l,this.Aa.Mo((c=>{n.enqueueAndForget((async()=>{dl(this)&&(Ce(_c,"Restarting streams for network reachability change."),await(async function(f){const m=Be(f);m.Ea.add(4),await Hd(m),m.Va.set("Unknown"),m.Ea.delete(4),await Cm(m)})(this))}))})),this.Va=new yL(n,a)}}async function Cm(s){if(dl(s))for(const e of s.Ra)await e(!0)}async function Hd(s){for(const e of s.Ra)await e(!1)}function Q0(s,e){const t=Be(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),T_(t)?S_(t):Wd(t).O_()&&N_(t,e))}function kd(s,e){const t=Be(s),n=Wd(t);t.Ia.delete(e),n.O_()&&xk(t,e),t.Ia.size===0&&(n.O_()?n.L_():dl(t)&&t.Va.set("Unknown"))}function N_(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Xe.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Wd(s).Z_(e)}function xk(s,e){s.da.$e(e),Wd(s).X_(e)}function S_(s){s.da=new mM({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),Wd(s).start(),s.Va.ua()}function T_(s){return dl(s)&&!Wd(s).x_()&&s.Ia.size>0}function dl(s){return Be(s).Ea.size===0}function bk(s){s.da=void 0}async function vL(s){s.Va.set("Online")}async function _L(s){s.Ia.forEach(((e,t)=>{N_(s,e)}))}async function jL(s,e){bk(s),T_(s)?(s.Va.ha(e),S_(s)):s.Va.set("Unknown")}async function NL(s,e,t){if(s.Va.set("Online"),e instanceof AA&&e.state===2&&e.cause)try{await(async function(a,l){const c=l.cause;for(const d of l.targetIds)a.Ia.has(d)&&(await a.remoteSyncer.rejectListen(d,c),a.Ia.delete(d),a.da.removeTarget(d))})(s,e)}catch(n){Ce(_c,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await f0(s,n)}else if(e instanceof Bp?s.da.Xe(e):e instanceof IA?s.da.st(e):s.da.tt(e),!t.isEqual(Xe.min()))try{const n=await ik(s.localStore);t.compareTo(n)>=0&&await(function(l,c){const d=l.da.Tt(c);return d.targetChanges.forEach(((f,m)=>{if(f.resumeToken.approximateByteSize()>0){const x=l.Ia.get(m);x&&l.Ia.set(m,x.withResumeToken(f.resumeToken,c))}})),d.targetMismatches.forEach(((f,m)=>{const x=l.Ia.get(f);if(!x)return;l.Ia.set(f,x.withResumeToken(_s.EMPTY_BYTE_STRING,x.snapshotVersion)),xk(l,f);const y=new Ri(x.target,f,m,x.sequenceNumber);N_(l,y)})),l.remoteSyncer.applyRemoteEvent(d)})(s,t)}catch(n){Ce(_c,"Failed to raise snapshot:",n),await f0(s,n)}}async function f0(s,e,t){if(!cl(e))throw e;s.Ea.add(1),await Hd(s),s.Va.set("Offline"),t||(t=()=>ik(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{Ce(_c,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await Cm(s)}))}function yk(s,e){return e().catch((t=>f0(s,t,e)))}async function Gd(s){const e=Be(s),t=rl(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Go;for(;SL(e);)try{const a=await iL(e.localStore,n);if(a===null){e.Ta.length===0&&t.L_();break}n=a.batchId,TL(e,a)}catch(a){await f0(e,a)}wk(e)&&vk(e)}function SL(s){return dl(s)&&s.Ta.length<10}function TL(s,e){s.Ta.push(e);const t=rl(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function wk(s){return dl(s)&&!rl(s).x_()&&s.Ta.length>0}function vk(s){rl(s).start()}async function EL(s){rl(s).ra()}async function IL(s){const e=rl(s);for(const t of s.Ta)e.ea(t.mutations)}async function AL(s,e,t){const n=s.Ta.shift(),a=c_.from(n,e,t);await yk(s,(()=>s.remoteSyncer.applySuccessfulWrite(a))),await Gd(s)}async function kL(s,e){e&&rl(s).Y_&&await(async function(n,a){if((function(c){return SA(c)&&c!==me.ABORTED})(a.code)){const l=n.Ta.shift();rl(n).B_(),await yk(n,(()=>n.remoteSyncer.rejectFailedWrite(l.batchId,a))),await Gd(n)}})(s,e),wk(s)&&vk(s)}async function zT(s,e){const t=Be(s);t.asyncQueue.verifyOperationInProgress(),Ce(_c,"RemoteStore received new credentials");const n=dl(t);t.Ea.add(3),await Hd(t),n&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Cm(t)}async function Yw(s,e){const t=Be(s);e?(t.Ea.delete(2),await Cm(t)):e||(t.Ea.add(2),await Hd(t),t.Va.set("Unknown"))}function Wd(s){return s.ma||(s.ma=(function(t,n,a){const l=Be(t);return l.sa(),new mL(n,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(s.datastore,s.asyncQueue,{Zo:vL.bind(null,s),Yo:_L.bind(null,s),t_:jL.bind(null,s),J_:NL.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),T_(s)?S_(s):s.Va.set("Unknown")):(await s.ma.stop(),bk(s))}))),s.ma}function rl(s){return s.fa||(s.fa=(function(t,n,a){const l=Be(t);return l.sa(),new gL(n,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:EL.bind(null,s),t_:kL.bind(null,s),ta:IL.bind(null,s),na:AL.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await Gd(s)):(await s.fa.stop(),s.Ta.length>0&&(Ce(_c,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_{constructor(e,t,n,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=a,this.removalCallback=l,this.deferred=new _n,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,a,l){const c=Date.now()+n,d=new E_(e,t,c,a,l);return d.start(n),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ke(me.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Kd(s,e){if(As("AsyncQueue",`${e}: ${s}`),cl(s))return new ke(me.UNAVAILABLE,`${e}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{static emptySet(e){return new od(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Ue.comparator(t.key,n.key):(t,n)=>Ue.comparator(t.key,n.key),this.keyedMap=pf(),this.sortedSet=new ss(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof od)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=n.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new od;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT{constructor(){this.ga=new ss(Ue.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):qe(63341,{Vt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Cd{constructor(e,t,n,a,l,c,d,f,m){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=d,this.excludesMetadataChanges=f,this.hasCachedResults=m}static fromInitialDocuments(e,t,n,a,l){const c=[];return t.forEach((d=>{c.push({type:0,doc:d})})),new Cd(e,t,od.emptySet(t),c,n,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Sm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==n[a].type||!t[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CL{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class RL{constructor(){this.queries=HT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const a=Be(t),l=a.queries;a.queries=HT(),l.forEach(((c,d)=>{for(const f of d.ba)f.onError(n)}))})(this,new ke(me.ABORTED,"Firestore shutting down"))}}function HT(){return new Wi((s=>dA(s)),Sm)}async function I_(s,e){const t=Be(s);let n=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.Da()&&(n=2):(l=new CL,n=e.Da()?0:1);try{switch(n){case 0:l.wa=await t.onListen(a,!0);break;case 1:l.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(c){const d=Kd(c,`Initialization of query '${Wu(e.query)}' failed`);return void e.onError(d)}t.queries.set(a,l),l.ba.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&k_(t)}async function A_(s,e){const t=Be(s),n=e.query;let a=3;const l=t.queries.get(n);if(l){const c=l.ba.indexOf(e);c>=0&&(l.ba.splice(c,1),l.ba.length===0?a=e.Da()?0:1:!l.Sa()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function DL(s,e){const t=Be(s);let n=!1;for(const a of e){const l=a.query,c=t.queries.get(l);if(c){for(const d of c.ba)d.Fa(a)&&(n=!0);c.wa=a}}n&&k_(t)}function OL(s,e,t){const n=Be(s),a=n.queries.get(e);if(a)for(const l of a.ba)l.onError(t);n.queries.delete(e)}function k_(s){s.Ca.forEach((e=>{e.next()}))}var Jw,GT;(GT=Jw||(Jw={})).Ma="default",GT.Cache="cache";class C_{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new Cd(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.Ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Cd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Jw.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL{constructor(e,t){this.qa=e,this.byteLength=t}Ua(){return"metadata"in this.qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e){this.serializer=e}Ks(e){return ti(this.serializer,e)}qs(e){return e.metadata.exists?PA(this.serializer,e.document,!1):as.newNoDocument(this.Ks(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return ks(e)}}class ML{constructor(e,t){this.$a=e,this.serializer=t,this.Wa=[],this.Qa=[],this.collectionGroups=new Set,this.progress=_k(e)}get queries(){return this.Wa}get documents(){return this.Qa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Wa.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Qa.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;const n=Nt.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.qa.document&&(this.Qa[this.Qa.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,n=new WT(this.serializer);for(const a of e)if(a.metadata.queries){const l=n.Ks(a.metadata.name);for(const c of a.metadata.queries){const d=(t.get(c)||gt()).add(l);t.set(c,d)}}return t}async ja(e){const t=await oL(e,new WT(this.serializer),this.Qa,this.$a.id),n=this.za(this.documents);for(const a of this.Wa)await lL(e,a,n.get(a.name));return this.progress.taskState="Success",{progress:this.progress,Ha:this.collectionGroups,Ja:t}}}function _k(s){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:s.totalDocuments,totalBytes:s.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jk{constructor(e){this.key=e}}class Nk{constructor(e){this.key=e}}class Sk{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=gt(),this.mutatedKeys=gt(),this.eu=fA(e),this.tu=new od(this.eu)}get nu(){return this.Za}ru(e,t){const n=t?t.iu:new qT,a=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,c=a,d=!1;const f=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,m=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((x,y)=>{const w=a.get(x),v=Tm(this.query,y)?y:null,T=!!w&&this.mutatedKeys.has(w.key),I=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let N=!1;w&&v?w.data.isEqual(v.data)?T!==I&&(n.track({type:3,doc:v}),N=!0):this.su(w,v)||(n.track({type:2,doc:v}),N=!0,(f&&this.eu(v,f)>0||m&&this.eu(v,m)<0)&&(d=!0)):!w&&v?(n.track({type:0,doc:v}),N=!0):w&&!v&&(n.track({type:1,doc:w}),N=!0,(f||m)&&(d=!0)),N&&(v?(c=c.add(v),l=I?l.add(x):l.delete(x)):(c=c.delete(x),l=l.delete(x)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const x=this.query.limitType==="F"?c.last():c.first();c=c.delete(x.key),l=l.delete(x.key),n.track({type:1,doc:x})}return{tu:c,iu:n,Ss:d,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((x,y)=>(function(v,T){const I=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return qe(20277,{Vt:N})}};return I(v)-I(T)})(x.type,y.type)||this.eu(x.doc,y.doc))),this.ou(n),a=a??!1;const d=t&&!a?this._u():[],f=this.Ya.size===0&&this.current&&!a?1:0,m=f!==this.Xa;return this.Xa=f,c.length!==0||m?{snapshot:new Cd(this.query,e.tu,l,c,e.mutatedKeys,f===0,m,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new qT,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=gt(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Ya=this.Ya.add(n.key))}));const t=[];return e.forEach((n=>{this.Ya.has(n)||t.push(new Nk(n))})),this.Ya.forEach((n=>{e.has(n)||t.push(new jk(n))})),t}cu(e){this.Za=e.ks,this.Ya=gt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Cd.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const hl="SyncEngine";class LL{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class VL{constructor(e){this.key=e,this.hu=!1}}class UL{constructor(e,t,n,a,l,c){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new Wi((d=>dA(d)),Sm),this.Iu=new Map,this.Eu=new Set,this.Ru=new ss(Ue.comparator),this.Au=new Map,this.Vu=new p_,this.du={},this.mu=new Map,this.fu=vc.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function FL(s,e,t=!0){const n=Y0(s);let a;const l=n.Tu.get(e);return l?(n.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await Tk(n,e,t,!0),a}async function $L(s,e){const t=Y0(s);await Tk(t,e,!0,!1)}async function Tk(s,e,t,n){const a=await Id(s.localStore,Hn(e)),l=a.targetId,c=s.sharedClientState.addLocalQueryTarget(l,t);let d;return n&&(d=await R_(s,e,l,c==="current",a.resumeToken)),s.isPrimaryClient&&t&&Q0(s.remoteStore,a),d}async function R_(s,e,t,n,a){s.pu=(y,w,v)=>(async function(I,N,P,U){let V=N.view.ru(P);V.Ss&&(V=await u0(I.localStore,N.query,!1).then((({documents:k})=>N.view.ru(k,V))));const q=U&&U.targetChanges.get(N.targetId),W=U&&U.targetMismatches.get(N.targetId)!=null,z=N.view.applyChanges(V,I.isPrimaryClient,q,W);return Xw(I,N.targetId,z.au),z.snapshot})(s,y,w,v);const l=await u0(s.localStore,e,!0),c=new Sk(e,l.ks),d=c.ru(l.documents),f=Am.createSynthesizedTargetChangeForCurrentChange(t,n&&s.onlineState!=="Offline",a),m=c.applyChanges(d,s.isPrimaryClient,f);Xw(s,t,m.au);const x=new LL(e,t,c);return s.Tu.set(e,x),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),m.snapshot}async function BL(s,e,t){const n=Be(s),a=n.Tu.get(e),l=n.Iu.get(a.targetId);if(l.length>1)return n.Iu.set(a.targetId,l.filter((c=>!Sm(c,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await Ad(n.localStore,a.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(a.targetId),t&&kd(n.remoteStore,a.targetId),Rd(n,a.targetId)})).catch(ll)):(Rd(n,a.targetId),await Ad(n.localStore,a.targetId,!0))}async function zL(s,e){const t=Be(s),n=t.Tu.get(e),a=t.Iu.get(n.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),kd(t.remoteStore,n.targetId))}async function qL(s,e,t){const n=M_(s);try{const a=await(function(c,d){const f=Be(c),m=Mt.now(),x=d.reduce(((v,T)=>v.add(T.key)),gt());let y,w;return f.persistence.runTransaction("Locally write mutations","readwrite",(v=>{let T=or(),I=gt();return f.xs.getEntries(v,x).next((N=>{T=N,T.forEach(((P,U)=>{U.isValidDocument()||(I=I.add(P))}))})).next((()=>f.localDocuments.getOverlayedDocuments(v,T))).next((N=>{y=N;const P=[];for(const U of d){const V=dM(U,y.get(U.key).overlayedDocument);V!=null&&P.push(new Ki(U.key,V,sA(V.value.mapValue),fs.exists(!0)))}return f.mutationQueue.addMutationBatch(v,m,P,d)})).next((N=>{w=N;const P=N.applyToLocalDocumentSet(y,I);return f.documentOverlayCache.saveOverlays(v,N.batchId,P)}))})).then((()=>({batchId:w.batchId,changes:gA(y)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),(function(c,d,f){let m=c.du[c.currentUser.toKey()];m||(m=new ss(dt)),m=m.insert(d,f),c.du[c.currentUser.toKey()]=m})(n,a.batchId,t),await Qi(n,a.changes),await Gd(n.remoteStore)}catch(a){const l=Kd(a,"Failed to persist write");t.reject(l)}}async function Ek(s,e){const t=Be(s);try{const n=await aL(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const c=t.Au.get(l);c&&(Qe(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?c.hu=!0:a.modifiedDocuments.size>0?Qe(c.hu,14607):a.removedDocuments.size>0&&(Qe(c.hu,42227),c.hu=!1))})),await Qi(t,n,e)}catch(n){await ll(n)}}function KT(s,e,t){const n=Be(s);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const a=[];n.Tu.forEach(((l,c)=>{const d=c.view.va(e);d.snapshot&&a.push(d.snapshot)})),(function(c,d){const f=Be(c);f.onlineState=d;let m=!1;f.queries.forEach(((x,y)=>{for(const w of y.ba)w.va(d)&&(m=!0)})),m&&k_(f)})(n.eventManager,e),a.length&&n.Pu.J_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function HL(s,e,t){const n=Be(s);n.sharedClientState.updateQueryState(e,"rejected",t);const a=n.Au.get(e),l=a&&a.key;if(l){let c=new ss(Ue.comparator);c=c.insert(l,as.newNoDocument(l,Xe.min()));const d=gt().add(l),f=new Im(Xe.min(),new Map,new ss(dt),c,d);await Ek(n,f),n.Ru=n.Ru.remove(l),n.Au.delete(e),P_(n)}else await Ad(n.localStore,e,!1).then((()=>Rd(n,e,t))).catch(ll)}async function GL(s,e){const t=Be(s),n=e.batch.batchId;try{const a=await rL(t.localStore,e);O_(t,n,null),D_(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await Qi(t,a)}catch(a){await ll(a)}}async function WL(s,e,t){const n=Be(s);try{const a=await(function(c,d){const f=Be(c);return f.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let x;return f.mutationQueue.lookupMutationBatch(m,d).next((y=>(Qe(y!==null,37113),x=y.keys(),f.mutationQueue.removeMutationBatch(m,y)))).next((()=>f.mutationQueue.performConsistencyCheck(m))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(m,x,d))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,x))).next((()=>f.localDocuments.getDocuments(m,x)))}))})(n.localStore,e);O_(n,e,t),D_(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await Qi(n,a)}catch(a){await ll(a)}}async function KL(s,e){const t=Be(s);dl(t.remoteStore)||Ce(hl,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const n=await(function(c){const d=Be(c);return d.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(f=>d.mutationQueue.getHighestUnacknowledgedBatchId(f)))})(t.localStore);if(n===Go)return void e.resolve();const a=t.mu.get(n)||[];a.push(e),t.mu.set(n,a)}catch(n){const a=Kd(n,"Initialization of waitForPendingWrites() operation failed");e.reject(a)}}function D_(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function O_(s,e,t){const n=Be(s);let a=n.du[n.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),n.du[n.currentUser.toKey()]=a}}function Rd(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const n of s.Iu.get(e))s.Tu.delete(n),t&&s.Pu.yu(n,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((n=>{s.Vu.containsKey(n)||Ik(s,n)}))}function Ik(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(kd(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),P_(s))}function Xw(s,e,t){for(const n of t)n instanceof jk?(s.Vu.addReference(n.key,e),QL(s,n)):n instanceof Nk?(Ce(hl,"Document no longer in limbo: "+n.key),s.Vu.removeReference(n.key,e),s.Vu.containsKey(n.key)||Ik(s,n.key)):qe(19791,{wu:n})}function QL(s,e){const t=e.key,n=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(n)||(Ce(hl,"New document in limbo: "+t),s.Eu.add(n),P_(s))}function P_(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new Ue(Nt.fromString(e)),n=s.fu.next();s.Au.set(n,new VL(t)),s.Ru=s.Ru.insert(t,n),Q0(s.remoteStore,new Ri(Hn(Bd(t.path)),n,"TargetPurposeLimboResolution",ar.ce))}}async function Qi(s,e,t){const n=Be(s),a=[],l=[],c=[];n.Tu.isEmpty()||(n.Tu.forEach(((d,f)=>{c.push(n.pu(f,e,t).then((m=>{var x;if((m||t)&&n.isPrimaryClient){const y=m?!m.fromCache:(x=t==null?void 0:t.targetChanges.get(f.targetId))==null?void 0:x.current;n.sharedClientState.updateQueryState(f.targetId,y?"current":"not-current")}if(m){a.push(m);const y=w_.Es(f.targetId,m);l.push(y)}})))})),await Promise.all(c),n.Pu.J_(a),await(async function(f,m){const x=Be(f);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(y=>ae.forEach(m,(w=>ae.forEach(w.Ts,(v=>x.persistence.referenceDelegate.addReference(y,w.targetId,v))).next((()=>ae.forEach(w.Is,(v=>x.persistence.referenceDelegate.removeReference(y,w.targetId,v)))))))))}catch(y){if(!cl(y))throw y;Ce(v_,"Failed to update sequence numbers: "+y)}for(const y of m){const w=y.targetId;if(!y.fromCache){const v=x.vs.get(w),T=v.snapshotVersion,I=v.withLastLimboFreeSnapshotVersion(T);x.vs=x.vs.insert(w,I)}}})(n.localStore,l))}async function YL(s,e){const t=Be(s);if(!t.currentUser.isEqual(e)){Ce(hl,"User change. New user:",e.toKey());const n=await ak(t.localStore,e);t.currentUser=e,(function(l,c){l.mu.forEach((d=>{d.forEach((f=>{f.reject(new ke(me.CANCELLED,c))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Qi(t,n.Ns)}}function JL(s,e){const t=Be(s),n=t.Au.get(e);if(n&&n.hu)return gt().add(n.key);{let a=gt();const l=t.Iu.get(e);if(!l)return a;for(const c of l){const d=t.Tu.get(c);a=a.unionWith(d.view.nu)}return a}}async function XL(s,e){const t=Be(s),n=await u0(t.localStore,e.query,!0),a=e.view.cu(n);return t.isPrimaryClient&&Xw(t,e.targetId,a.au),a}async function ZL(s,e){const t=Be(s);return ck(t.localStore,e).then((n=>Qi(t,n)))}async function eV(s,e,t,n){const a=Be(s),l=await(function(d,f){const m=Be(d),x=Be(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",(y=>x.Xn(y,f).next((w=>w?m.localDocuments.getDocuments(y,w):ae.resolve(null)))))})(a.localStore,e);l!==null?(t==="pending"?await Gd(a.remoteStore):t==="acknowledged"||t==="rejected"?(O_(a,e,n||null),D_(a,e),(function(d,f){Be(Be(d).mutationQueue).nr(f)})(a.localStore,e)):qe(6720,"Unknown batchState",{bu:t}),await Qi(a,l)):Ce(hl,"Cannot apply mutation batch with id: "+e)}async function tV(s,e){const t=Be(s);if(Y0(t),M_(t),e===!0&&t.gu!==!0){const n=t.sharedClientState.getAllActiveQueryTargets(),a=await QT(t,n.toArray());t.gu=!0,await Yw(t.remoteStore,!0);for(const l of a)Q0(t.remoteStore,l)}else if(e===!1&&t.gu!==!1){const n=[];let a=Promise.resolve();t.Iu.forEach(((l,c)=>{t.sharedClientState.isLocalQueryTarget(c)?n.push(c):a=a.then((()=>(Rd(t,c),Ad(t.localStore,c,!0)))),kd(t.remoteStore,c)})),await a,await QT(t,n),(function(c){const d=Be(c);d.Au.forEach(((f,m)=>{kd(d.remoteStore,m)})),d.Vu.zr(),d.Au=new Map,d.Ru=new ss(Ue.comparator)})(t),t.gu=!1,await Yw(t.remoteStore,!1)}}async function QT(s,e,t){const n=Be(s),a=[],l=[];for(const c of e){let d;const f=n.Iu.get(c);if(f&&f.length!==0){d=await Id(n.localStore,Hn(f[0]));for(const m of f){const x=n.Tu.get(m),y=await XL(n,x);y.snapshot&&l.push(y.snapshot)}}else{const m=await lk(n.localStore,c);d=await Id(n.localStore,m),await R_(n,Ak(m),c,!1,d.resumeToken)}a.push(d)}return n.Pu.J_(l),a}function Ak(s){return uA(s.path,s.collectionGroup,s.orderBy,s.filters,s.limit,"F",s.startAt,s.endAt)}function sV(s){return(function(t){return Be(Be(t).persistence).hs()})(Be(s).localStore)}async function nV(s,e,t,n){const a=Be(s);if(a.gu)return void Ce(hl,"Ignoring unexpected query state notification.");const l=a.Iu.get(e);if(l&&l.length>0)switch(t){case"current":case"not-current":{const c=await ck(a.localStore,hA(l[0])),d=Im.createSynthesizedRemoteEventForCurrentChange(e,t==="current",_s.EMPTY_BYTE_STRING);await Qi(a,c,d);break}case"rejected":await Ad(a.localStore,e,!0),Rd(a,e,n);break;default:qe(64155,t)}}async function rV(s,e,t){const n=Y0(s);if(n.gu){for(const a of e){if(n.Iu.has(a)&&n.sharedClientState.isActiveQueryTarget(a)){Ce(hl,"Adding an already active target "+a);continue}const l=await lk(n.localStore,a),c=await Id(n.localStore,l);await R_(n,Ak(l),c.targetId,!1,c.resumeToken),Q0(n.remoteStore,c)}for(const a of t)n.Iu.has(a)&&await Ad(n.localStore,a,!1).then((()=>{kd(n.remoteStore,a),Rd(n,a)})).catch(ll)}}function Y0(s){const e=Be(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ek.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=JL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=HL.bind(null,e),e.Pu.J_=DL.bind(null,e.eventManager),e.Pu.yu=OL.bind(null,e.eventManager),e}function M_(s){const e=Be(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=GL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=WL.bind(null,e),e}function aV(s,e,t){const n=Be(s);(async function(l,c,d){try{const f=await c.getMetadata();if(await(function(v,T){const I=Be(v),N=ks(T.createTime);return I.persistence.runTransaction("hasNewerBundle","readonly",(P=>I.Pi.getBundleMetadata(P,T.id))).then((P=>!!P&&P.createTime.compareTo(N)>=0))})(l.localStore,f))return await c.close(),d._completeWith((function(v){return{taskState:"Success",documentsLoaded:v.totalDocuments,bytesLoaded:v.totalBytes,totalDocuments:v.totalDocuments,totalBytes:v.totalBytes}})(f)),Promise.resolve(new Set);d._updateProgress(_k(f));const m=new ML(f,c.serializer);let x=await c.Su();for(;x;){const w=await m.Ga(x);w&&d._updateProgress(w),x=await c.Su()}const y=await m.ja(l.localStore);return await Qi(l,y.Ja,void 0),await(function(v,T){const I=Be(v);return I.persistence.runTransaction("Save bundle","readwrite",(N=>I.Pi.saveBundleMetadata(N,T)))})(l.localStore,f),d._completeWith(y.progress),Promise.resolve(y.Ha)}catch(f){return ri(hl,`Loading bundle failed with ${f}`),d._failWith(f),Promise.resolve(new Set)}})(n,e,t).then((a=>{n.sharedClientState.notifyBundleLoaded(a)}))}class sm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=km(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return rk(this.persistence,new nk,e.initialUser,this.serializer)}Cu(e){return new x_(K0.Vi,this.serializer)}Du(e){return new mk}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}sm.provider={build:()=>new sm};class iV extends sm{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Qe(this.persistence.referenceDelegate instanceof c0,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new JA(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Cn.withCacheSize(this.cacheSizeBytes):Cn.DEFAULT;return new x_((n=>c0.Vi(n,t)),this.serializer)}}class kk extends sm{constructor(e,t,n){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await M_(this.xu.syncEngine),await Gd(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return rk(this.persistence,new nk,e.initialUser,this.serializer)}Fu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new JA(n,e.asyncQueue,t)}Mu(e,t){const n=new c6(t,this.persistence);return new l6(e.asyncQueue,n)}Cu(e){const t=y_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Cn.withCacheSize(this.cacheSizeBytes):Cn.DEFAULT;return new b_(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,gk(),qp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new mk}}class oV extends kk{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Fy&&(this.sharedClientState.syncEngine={So:eV.bind(null,t),Do:nV.bind(null,t),Co:rV.bind(null,t),hs:sV.bind(null,t),bo:ZL.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async n=>{await tV(this.xu.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())}))}Du(e){const t=gk();if(!Fy.v(t))throw new ke(me.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=y_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Fy(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class nm{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>KT(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=YL.bind(null,this.syncEngine),await Yw(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new RL})()}createDatastore(e){const t=km(e.databaseInfo.databaseId),n=fL(e.databaseInfo);return bL(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,a,l,c,d){return new wL(n,a,l,c,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>KT(this.syncEngine,t,0)),(function(){return $T.v()?new $T:new cL})())}createSyncEngine(e,t){return(function(a,l,c,d,f,m,x){const y=new UL(a,l,c,d,f,m);return x&&(y.gu=!0),y})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=Be(a);Ce(_c,"RemoteStore shutting down."),l.Ea.add(5),await Hd(l),l.Aa.shutdown(),l.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}nm.provider={build:()=>new nm};function YT(s,e=10240){let t=0;return{async read(){if(t<s.byteLength){const n={value:s.slice(t,t+e),done:!1};return t+=e,n}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):As("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new _n,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((n=>{n&&n.Ua()?this.metadata.resolve(n.qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(n==null?void 0:n.qa)}`))}),(n=>this.metadata.reject(n)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.Ku();if(e===null)return null;const t=this.Lu.decode(e),n=Number(t);isNaN(n)&&this.qu(`length string (${t}) is not valid number`);const a=await this.Uu(n);return new PL(JSON.parse(a),e.length+n)}$u(){return this.buffer.findIndex((e=>e===123))}async Ku(){for(;this.$u()<0&&!await this.Wu(););if(this.buffer.length===0)return null;const e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Uu(e){for(;this.buffer.length<e;)await this.Wu()&&this.qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Wu(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cV=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ke(me.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(a,l){const c=Be(a),d={documents:l.map((y=>em(c.serializer,y)))},f=await c.jo("BatchGetDocuments",c.serializer.databaseId,Nt.emptyPath(),d,l.length),m=new Map;f.forEach((y=>{const w=wM(c.serializer,y);m.set(w.key.toString(),w)}));const x=[];return l.forEach((y=>{const w=m.get(y.toString());Qe(!!w,55234,{key:y}),x.push(w)})),x})(this.datastore,e);return t.forEach((n=>this.recordVersion(n))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new qd(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,n)=>{const a=Ue.fromPath(n);this.mutations.push(new o_(a,this.precondition(a)))})),await(async function(n,a){const l=Be(n),c={writes:a.map((d=>tm(l.serializer,d)))};await l.Wo("Commit",l.serializer.databaseId,Nt.emptyPath(),c)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw qe(50498,{Gu:e.constructor.name});t=Xe.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new ke(me.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Xe.min())?fs.exists(!1):fs.updateTime(t):fs.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Xe.min()))throw new ke(me.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return fs.updateTime(t)}return fs.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(e,t,n,a,l){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=a,this.deferred=l,this.zu=n.maxAttempts,this.M_=new j_(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_((async()=>{const e=new cV(this.datastore),t=this.Ju(e);t&&t.then((n=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(n)})).catch((a=>{this.Zu(a)}))))})).catch((n=>{this.Zu(n)}))}))}Ju(e){try{const t=this.updateFunction(e);return!_m(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Hu(),Promise.resolve())))):this.deferred.reject(e)}Xu(e){if((e==null?void 0:e.name)==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!SA(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const al="FirestoreClient";class dV{constructor(e,t,n,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this._databaseInfo=a,this.user=rn.UNAUTHENTICATED,this.clientId=Wv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(n,(async c=>{Ce(al,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(n,(c=>(Ce(al,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new _n;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Kd(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function By(s,e){s.asyncQueue.verifyOperationInProgress(),Ce(al,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let n=t.initialUser;s.setCredentialChangeListener((async a=>{n.isEqual(a)||(await ak(e.localStore,a),n=a)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function JT(s,e){s.asyncQueue.verifyOperationInProgress();const t=await L_(s);Ce(al,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((n=>zT(e.remoteStore,n))),s.setAppCheckTokenChangeListener(((n,a)=>zT(e.remoteStore,a))),s._onlineComponents=e}async function L_(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){Ce(al,"Using user provided OfflineComponentProvider");try{await By(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===me.FAILED_PRECONDITION||a.code===me.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;ri("Error using user provided cache. Falling back to memory cache: "+t),await By(s,new sm)}}else Ce(al,"Using default OfflineComponentProvider"),await By(s,new iV(void 0));return s._offlineComponents}async function X0(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(Ce(al,"Using user provided OnlineComponentProvider"),await JT(s,s._uninitializedComponentsProvider._online)):(Ce(al,"Using default OnlineComponentProvider"),await JT(s,new nm))),s._onlineComponents}function Ck(s){return L_(s).then((e=>e.persistence))}function V_(s){return L_(s).then((e=>e.localStore))}function Rk(s){return X0(s).then((e=>e.remoteStore))}function U_(s){return X0(s).then((e=>e.syncEngine))}function hV(s){return X0(s).then((e=>e.datastore))}async function Dd(s){const e=await X0(s),t=e.eventManager;return t.onListen=FL.bind(null,e.syncEngine),t.onUnlisten=BL.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=$L.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=zL.bind(null,e.syncEngine),t}function fV(s){return s.asyncQueue.enqueue((async()=>{const e=await Ck(s),t=await Rk(s);return e.setNetworkEnabled(!0),(function(a){const l=Be(a);return l.Ea.delete(0),Cm(l)})(t)}))}function mV(s){return s.asyncQueue.enqueue((async()=>{const e=await Ck(s),t=await Rk(s);return e.setNetworkEnabled(!1),(async function(a){const l=Be(a);l.Ea.add(0),await Hd(l),l.Va.set("Offline")})(t)}))}function gV(s,e,t,n){const a=new J0(n),l=new C_(e,a,t);return s.asyncQueue.enqueueAndForget((async()=>I_(await Dd(s),l))),()=>{a.Nu(),s.asyncQueue.enqueueAndForget((async()=>A_(await Dd(s),l)))}}function pV(s,e){const t=new _n;return s.asyncQueue.enqueueAndForget((async()=>(async function(a,l,c){try{const d=await(function(m,x){const y=Be(m);return y.persistence.runTransaction("read document","readonly",(w=>y.localDocuments.getDocument(w,x)))})(a,l);d.isFoundDocument()?c.resolve(d):d.isNoDocument()?c.resolve(null):c.reject(new ke(me.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){const f=Kd(d,`Failed to get document '${l} from cache`);c.reject(f)}})(await V_(s),e,t))),t.promise}function Dk(s,e,t={}){const n=new _n;return s.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,f,m){const x=new J0({next:w=>{x.Nu(),c.enqueueAndForget((()=>A_(l,y)));const v=w.docs.has(d);!v&&w.fromCache?m.reject(new ke(me.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&w.fromCache&&f&&f.source==="server"?m.reject(new ke(me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(w)},error:w=>m.reject(w)}),y=new C_(Bd(d.path),x,{includeMetadataChanges:!0,Ka:!0});return I_(l,y)})(await Dd(s),s.asyncQueue,e,t,n))),n.promise}function xV(s,e){const t=new _n;return s.asyncQueue.enqueueAndForget((async()=>(async function(a,l,c){try{const d=await u0(a,l,!0),f=new Sk(l,d.ks),m=f.ru(d.documents),x=f.applyChanges(m,!1);c.resolve(x.snapshot)}catch(d){const f=Kd(d,`Failed to execute query '${l} against cache`);c.reject(f)}})(await V_(s),e,t))),t.promise}function Ok(s,e,t={}){const n=new _n;return s.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,f,m){const x=new J0({next:w=>{x.Nu(),c.enqueueAndForget((()=>A_(l,y))),w.fromCache&&f.source==="server"?m.reject(new ke(me.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(w)},error:w=>m.reject(w)}),y=new C_(d,x,{includeMetadataChanges:!0,Ka:!0});return I_(l,y)})(await Dd(s),s.asyncQueue,e,t,n))),n.promise}function bV(s,e){const t=new _n;return s.asyncQueue.enqueueAndForget((async()=>qL(await U_(s),e,t))),t.promise}function yV(s,e){const t=new J0(e);return s.asyncQueue.enqueueAndForget((async()=>(function(a,l){Be(a).Ca.add(l),l.next()})(await Dd(s),t))),()=>{t.Nu(),s.asyncQueue.enqueueAndForget((async()=>(function(a,l){Be(a).Ca.delete(l)})(await Dd(s),t)))}}function wV(s,e,t){const n=new _n;return s.asyncQueue.enqueueAndForget((async()=>{const a=await hV(s);new uV(s.asyncQueue,a,t,e,n).ju()})),n.promise}function vV(s,e,t,n){const a=(function(c,d){let f;return f=typeof c=="string"?EA().encode(c):c,(function(x,y){return new lV(x,y)})((function(x,y){if(x instanceof Uint8Array)return YT(x,y);if(x instanceof ArrayBuffer)return YT(new Uint8Array(x),y);if(x instanceof ReadableStream)return x.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(f),d)})(t,km(e));s.asyncQueue.enqueueAndForget((async()=>{aV(await U_(s),a,n)}))}function _V(s,e){return s.asyncQueue.enqueue((async()=>(function(n,a){const l=Be(n);return l.persistence.runTransaction("Get named query","readonly",(c=>l.Pi.getNamedQuery(c,a)))})(await V_(s),e)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pk(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jV="ComponentProvider",XT=new Map;function NV(s,e,t,n,a){return new V6(s,e,t,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,Pk(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mk="firestore.googleapis.com",ZT=!0;class eE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ke(me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Mk,this.ssl=ZT}else this.host=e.host,this.ssl=e.ssl??ZT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=WA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<UM)throw new ke(me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}II("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Pk(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new ke(me.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new ke(me.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new ke(me.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,a){return n.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Rm{constructor(e,t,n,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new eE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ke(me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ke(me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new eE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new YP;switch(n.type){case"firstParty":return new e6(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new ke(me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=XT.get(t);n&&(Ce(jV,"Removing Datastore"),XT.delete(t),n.terminate())})(this),Promise.resolve()}}function SV(s,e,t,n={}){var m;s=Rt(s,Rm);const a=ol(e),l=s._getSettings(),c={...l,emulatorOptions:s._getEmulatorOptions()},d=`${e}:${t}`;a&&(Vv(`https://${d}`),Uv("Firestore",!0)),l.host!==Mk&&l.host!==d&&ri("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...l,host:d,ssl:a,emulatorOptions:n};if(!Yo(f,c)&&(s._setSettings(f),n.mockUserToken)){let x,y;if(typeof n.mockUserToken=="string")x=n.mockUserToken,y=rn.MOCK_USER;else{x=eI(n.mockUserToken,(m=s._app)==null?void 0:m.options.projectId);const w=n.mockUserToken.sub||n.mockUserToken.user_id;if(!w)throw new ke(me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new rn(w)}s._authCredentials=new JP(new TI(x,y))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qn=class Lk{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Lk(this.firestore,e,this._query)}},ts=class yf{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Wo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new yf(this.firestore,e,this._key)}toJSON(){return{type:yf._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(vm(t,yf._jsonSchema))return new yf(e,n||null,new Ue(Nt.fromString(t.referencePath)))}};ts._jsonSchemaVersion="firestore/documentReference/1.0",ts._jsonSchema={type:Hs("string",ts._jsonSchemaVersion),referencePath:Hs("string")};let Wo=class Vk extends Qn{constructor(e,t,n){super(e,t,Bd(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ts(this.firestore,null,new Ue(e))}withConverter(e){return new Vk(this.firestore,e,this._path)}};function Uk(s,e,...t){if(s=We(s),Kv("collection","path",e),s instanceof Rm){const n=Nt.fromString(e,...t);return BS(n),new Wo(s,null,n)}{if(!(s instanceof ts||s instanceof Wo))throw new ke(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(Nt.fromString(e,...t));return BS(n),new Wo(s.firestore,null,n)}}function TV(s,e){if(s=Rt(s,Rm),Kv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ke(me.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Qn(s,null,(function(n){return new Gi(Nt.emptyPath(),n)})(e))}function m0(s,e,...t){if(s=We(s),arguments.length===1&&(e=Wv.newId()),Kv("doc","path",e),s instanceof Rm){const n=Nt.fromString(e,...t);return $S(n),new ts(s,null,new Ue(n))}{if(!(s instanceof ts||s instanceof Wo))throw new ke(me.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(Nt.fromString(e,...t));return $S(n),new ts(s.firestore,s instanceof Wo?s.converter:null,new Ue(n))}}function Fk(s,e){return s=We(s),e=We(e),(s instanceof ts||s instanceof Wo)&&(e instanceof ts||e instanceof Wo)&&s.firestore===e.firestore&&s.path===e.path&&s.converter===e.converter}function $k(s,e){return s=We(s),e=We(e),s instanceof Qn&&e instanceof Qn&&s.firestore===e.firestore&&Sm(s._query,e._query)&&s.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tE="AsyncQueue";class sE{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new j_(this,"async_queue_retry"),this._c=()=>{const n=qp();n&&Ce(tE,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=qp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=qp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new _n;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!cl(e))throw e;Ce(tE,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,As("INTERNAL UNHANDLED ERROR: ",nE(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=E_.createAndSchedule(this,e,t,n,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&qe(47125,{Pc:nE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function nE(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EV{constructor(){this._progressObserver={},this._taskCompletionResolver=new _n,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IV=-1;let Cs=class extends Rm{constructor(e,t,n,a){super(e,t,n,a),this.type="firestore",this._queue=new sE,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new sE(e),this._firestoreClient=void 0,await e}}};function Pn(s){if(s._terminated)throw new ke(me.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||Bk(s),s._firestoreClient}function Bk(s){var n,a,l,c;const e=s._freezeSettings(),t=NV(s._databaseId,((n=s._app)==null?void 0:n.options.appId)||"",s._persistenceKey,(a=s._app)==null?void 0:a.options.apiKey,e);s._componentsProvider||(l=e.localCache)!=null&&l._offlineComponentProvider&&((c=e.localCache)!=null&&c._onlineComponentProvider)&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new dV(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(f){const m=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(m),_online:m}})(s._componentsProvider))}function AV(s,e){ri("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=s._freezeSettings();return zk(s,nm.provider,{build:n=>new kk(n,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function kV(s){ri("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=s._freezeSettings();zk(s,nm.provider,{build:t=>new oV(t,e.cacheSizeBytes)})}function zk(s,e,t){if((s=Rt(s,Cs))._firestoreClient||s._terminated)throw new ke(me.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(s._componentsProvider||s._getSettings().localCache)throw new ke(me.FAILED_PRECONDITION,"SDK cache is already specified.");s._componentsProvider={_online:e,_offline:t},Bk(s)}function CV(s){if(s._initialized&&!s._terminated)throw new ke(me.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new _n;return s._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(n){if(!ei.v())return Promise.resolve();const a=n+sk;await ei.delete(a)})(y_(s._databaseId,s._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function RV(s){return(function(t){const n=new _n;return t.asyncQueue.enqueueAndForget((async()=>KL(await U_(t),n))),n.promise})(Pn(s=Rt(s,Cs)))}function DV(s){return fV(Pn(s=Rt(s,Cs)))}function OV(s){return mV(Pn(s=Rt(s,Cs)))}function PV(s,e){const t=Pn(s=Rt(s,Cs)),n=new EV;return vV(t,s._databaseId,e,n),n}function MV(s,e){return _V(Pn(s=Rt(s,Cs)),e).then((t=>t?new Qn(s,null,t.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Rn(_s.fromBase64String(e))}catch(t){throw new ke(me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Rn(_s.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Rn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(vm(e,Rn._jsonSchema))return Rn.fromBase64String(e.bytes)}}Rn._jsonSchemaVersion="firestore/bytes/1.0",Rn._jsonSchema={type:Hs("string",Rn._jsonSchemaVersion),bytes:Hs("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jc=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ke(me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mc=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ke(me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ke(me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return dt(this._lat,e._lat)||dt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:xa._jsonSchemaVersion}}static fromJSON(e){if(vm(e,xa._jsonSchema))return new xa(e.latitude,e.longitude)}}xa._jsonSchemaVersion="firestore/geoPoint/1.0",xa._jsonSchema={type:Hs("string",xa._jsonSchemaVersion),latitude:Hs("number"),longitude:Hs("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,a){if(n.length!==a.length)return!1;for(let l=0;l<n.length;++l)if(n[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ba._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(vm(e,ba._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ba(e.vectorValues);throw new ke(me.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ba._jsonSchemaVersion="firestore/vectorValue/1.0",ba._jsonSchema={type:Hs("string",ba._jsonSchemaVersion),vectorValues:Hs("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LV=/^__.*__$/;class VV{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Ki(e,this.data,this.fieldMask,t,this.fieldTransforms):new zd(e,this.data,t,this.fieldTransforms)}}class qk{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ki(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Hk(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw qe(40011,{dataSource:s})}}class Z0{constructor(e,t,n,a,l,c){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=a,l===void 0&&this.validatePath(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Z0({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var a;const t=(a=this.path)==null?void 0:a.child(e),n=this.contextWith({path:t,arrayElement:!1});return n.validatePathSegment(e),n}childContextForFieldPath(e){var a;const t=(a=this.path)==null?void 0:a.child(e),n=this.contextWith({path:t,arrayElement:!1});return n.validatePath(),n}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return g0(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Hk(this.dataSource)&&LV.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class UV{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||km(e)}createContext(e,t,n,a=!1){return new Z0({dataSource:e,methodName:t,targetDoc:n,path:hs.emptyPath(),arrayElement:!1,hasConverter:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Lc(s){const e=s._freezeSettings(),t=km(s._databaseId);return new UV(s._databaseId,!!e.ignoreUndefinedProperties,t)}function ex(s,e,t,n,a,l={}){const c=s.createContext(l.merge||l.mergeFields?2:0,e,t,a);G_("Data must be an object, but it was:",c,n);const d=Kk(n,c);let f,m;if(l.merge)f=new ir(c.fieldMask),m=c.fieldTransforms;else if(l.mergeFields){const x=[];for(const y of l.mergeFields){const w=Nc(e,y,t);if(!c.contains(w))throw new ke(me.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);Jk(x,w)||x.push(w)}f=new ir(x),m=c.fieldTransforms.filter((y=>f.covers(y.field)))}else f=null,m=c.fieldTransforms;return new VV(new yn(d),f,m)}class Dm extends Mc{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Dm}}function Gk(s,e,t){return new Z0({dataSource:3,targetDoc:e.settings.targetDoc,methodName:s._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class F_ extends Mc{_toFieldTransform(e){return new Em(e.path,new Sd)}isEqual(e){return e instanceof F_}}class $_ extends Mc{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Gk(this,e,!0),n=this.Ac.map((l=>Vc(l,t))),a=new xc(n);return new Em(e.path,a)}isEqual(e){return e instanceof $_&&Yo(this.Ac,e.Ac)}}class B_ extends Mc{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Gk(this,e,!0),n=this.Ac.map((l=>Vc(l,t))),a=new bc(n);return new Em(e.path,a)}isEqual(e){return e instanceof B_&&Yo(this.Ac,e.Ac)}}class z_ extends Mc{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Td(e.serializer,bA(e.serializer,this.Vc));return new Em(e.path,t)}isEqual(e){return e instanceof z_&&this.Vc===e.Vc}}function q_(s,e,t,n){const a=s.createContext(1,e,t);G_("Data must be an object, but it was:",a,n);const l=[],c=yn.empty();ul(n,((f,m)=>{const x=Yk(e,f,t);m=We(m);const y=a.childContextForFieldPath(x);if(m instanceof Dm)l.push(x);else{const w=Vc(m,y);w!=null&&(l.push(x),c.set(x,w))}}));const d=new ir(l);return new qk(c,d,a.fieldTransforms)}function H_(s,e,t,n,a,l){const c=s.createContext(1,e,t),d=[Nc(e,n,t)],f=[a];if(l.length%2!=0)throw new ke(me.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let w=0;w<l.length;w+=2)d.push(Nc(e,l[w])),f.push(l[w+1]);const m=[],x=yn.empty();for(let w=d.length-1;w>=0;--w)if(!Jk(m,d[w])){const v=d[w];let T=f[w];T=We(T);const I=c.childContextForFieldPath(v);if(T instanceof Dm)m.push(v);else{const N=Vc(T,I);N!=null&&(m.push(v),x.set(v,N))}}const y=new ir(m);return new qk(x,y,c.fieldTransforms)}function Wk(s,e,t,n=!1){return Vc(t,s.createContext(n?4:3,e))}function Vc(s,e){if(Qk(s=We(s)))return G_("Unsupported field value:",e,s),Kk(s,e);if(s instanceof Mc)return(function(n,a){if(!Hk(a.dataSource))throw a.createError(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.createError(`${n._methodName}() is not currently supported inside arrays`);const l=n._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(n,a){const l=[];let c=0;for(const d of n){let f=Vc(d,a.childContextForArray(c));f==null&&(f={nullValue:"NULL_VALUE"}),l.push(f),c++}return{arrayValue:{values:l}}})(s,e)}return(function(n,a){if((n=We(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return bA(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const l=Mt.fromDate(n);return{timestampValue:Ed(a.serializer,l)}}if(n instanceof Mt){const l=new Mt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Ed(a.serializer,l)}}if(n instanceof xa)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Rn)return{bytesValue:kA(a.serializer,n._byteString)};if(n instanceof ts){const l=a.databaseId,c=n.firestore._databaseId;if(!c.isEqual(l))throw a.createError(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:h_(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof ba)return(function(c,d){const f=c instanceof ba?c.toArray():c;return{mapValue:{fields:{[t_]:{stringValue:s_},[_d]:{arrayValue:{values:f.map((x=>{if(typeof x!="number")throw d.createError("VectorValues must only contain numeric values.");return i_(d.serializer,x)}))}}}}}})(n,a);if(BA(n))return n._toProto(a.serializer);throw a.createError(`Unsupported field value: ${M0(n)}`)})(s,e)}function Kk(s,e){const t={};return WI(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ul(s,((n,a)=>{const l=Vc(a,e.childContextForField(n));l!=null&&(t[n]=l)})),{mapValue:{fields:t}}}function Qk(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Mt||s instanceof xa||s instanceof Rn||s instanceof ts||s instanceof Mc||s instanceof ba||BA(s))}function G_(s,e,t){if(!Qk(t)||!AI(t)){const n=M0(t);throw n==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+n)}}function Nc(s,e,t){if((e=We(e))instanceof jc)return e._internalPath;if(typeof e=="string")return Yk(s,e);throw g0("Field path arguments must be of type string or ",s,!1,void 0,t)}const FV=new RegExp("[~\\*/\\[\\]]");function Yk(s,e,t){if(e.search(FV)>=0)throw g0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new jc(...e.split("."))._internalPath}catch{throw g0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function g0(s,e,t,n,a){const l=n&&!n.isEmpty(),c=a!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(l||c)&&(f+=" (found",l&&(f+=` in field ${n}`),c&&(f+=` in document ${a}`),f+=")"),new ke(me.INVALID_ARGUMENT,d+s+f)}function Jk(s,e){return s.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W_{convertValue(e,t="none"){switch(tl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ds(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Bi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw qe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return ul(e,((a,l)=>{n[a]=this.convertValue(l,t)})),n}convertVectorValue(e){var n,a,l;const t=(l=(a=(n=e.fields)==null?void 0:n[_d].arrayValue)==null?void 0:a.values)==null?void 0:l.map((c=>ds(c.doubleValue)));return new ba(t)}convertGeoPoint(e){return new xa(ds(e.latitude),ds(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=B0(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Yf(e));default:return null}}convertTimestamp(e){const t=$i(e);return new Mt(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Nt.fromString(e);Qe($A(n),9688,{name:e});const a=new el(n.get(1),n.get(3)),l=new Ue(n.popFirst(5));return a.isEqual(t)||As(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc extends W_{constructor(e){super(),this.firestore=e}convertBytes(e){return new Rn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ts(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $V(){return new Dm("deleteField")}function BV(){return new F_("serverTimestamp")}function zV(...s){return new $_("arrayUnion",s)}function qV(...s){return new B_("arrayRemove",s)}function HV(s){return new z_("increment",s)}const rE="@firebase/firestore",aE="4.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zw(s){return(function(t,n){if(typeof t!="object"||t===null)return!1;const a=t;for(const l of n)if(l in a&&typeof a[l]=="function")return!0;return!1})(s,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rm{constructor(e,t,n,a,l){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new ts(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new GV(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const t=this._document.data.field(Nc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class GV extends rm{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xk(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new ke(me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class K_{}class Om extends K_{}function Po(s,e,...t){let n=[];e instanceof K_&&n.push(e),n=n.concat(t),(function(l){const c=l.filter((f=>f instanceof Q_)).length,d=l.filter((f=>f instanceof tx)).length;if(c>1||c>0&&d>0)throw new ke(me.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const a of n)s=a._apply(s);return s}class tx extends Om{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new tx(e,t,n)}_apply(e){const t=this._parse(e);return e4(e._query,t),new Qn(e.firestore,e.converter,Fw(e._query,t))}_parse(e){const t=Lc(e.firestore);return(function(l,c,d,f,m,x,y){let w;if(m.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new ke(me.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){oE(y,x);const T=[];for(const I of y)T.push(iE(f,l,I));w={arrayValue:{values:T}}}else w=iE(f,l,y)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||oE(y,x),w=Wk(d,c,y,x==="in"||x==="not-in");return Et.create(m,x,w)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function WV(s,e,t){const n=e,a=Nc("where",s);return tx._create(a,n,t)}class Q_ extends K_{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Q_(e,t)}_parse(e){const t=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return t.length===1?t[0]:$t.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let c=a;const d=l.getFlattenedFilters();for(const f of d)e4(c,f),c=Fw(c,f)})(e._query,t),new Qn(e.firestore,e.converter,Fw(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Y_ extends Om{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Y_(e,t)}_apply(e){const t=(function(a,l,c){if(a.startAt!==null)throw new ke(me.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new ke(me.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Zf(l,c)})(e._query,this._field,this._direction);return new Qn(e.firestore,e.converter,X6(e._query,t))}}function KV(s,e="asc"){const t=e,n=Nc("orderBy",s);return Y_._create(n,t)}class sx extends Om{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new sx(e,t,n)}_apply(e){return new Qn(e.firestore,e.converter,a0(e._query,this._limit,this._limitType))}}function QV(s){return kI("limit",s),sx._create("limit",s,"F")}function YV(s){return kI("limitToLast",s),sx._create("limitToLast",s,"L")}class nx extends Om{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new nx(e,t,n)}_apply(e){const t=Zk(e,this.type,this._docOrFields,this._inclusive);return new Qn(e.firestore,e.converter,Z6(e._query,t))}}function JV(...s){return nx._create("startAt",s,!0)}function XV(...s){return nx._create("startAfter",s,!1)}class rx extends Om{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new rx(e,t,n)}_apply(e){const t=Zk(e,this.type,this._docOrFields,this._inclusive);return new Qn(e.firestore,e.converter,eM(e._query,t))}}function ZV(...s){return rx._create("endBefore",s,!1)}function e8(...s){return rx._create("endAt",s,!0)}function Zk(s,e,t,n){if(t[0]=We(t[0]),t[0]instanceof rm)return(function(l,c,d,f,m){if(!f)throw new ke(me.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${d}().`);const x=[];for(const y of ad(l))if(y.field.isKeyField())x.push(gc(c,f.key));else{const w=f.data.field(y.field);if($0(w))throw new ke(me.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+y.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(w===null){const v=y.field.canonicalString();throw new ke(me.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${v}' (used as the orderBy) does not exist.`)}x.push(w)}return new nl(x,m)})(s._query,s.firestore._databaseId,e,t[0]._document,n);{const a=Lc(s.firestore);return(function(c,d,f,m,x,y){const w=c.explicitOrderBy;if(x.length>w.length)throw new ke(me.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const v=[];for(let T=0;T<x.length;T++){const I=x[T];if(w[T].field.isKeyField()){if(typeof I!="string")throw new ke(me.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof I}`);if(!r_(c)&&I.indexOf("/")!==-1)throw new ke(me.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${I}' contains a slash.`);const N=c.path.child(Nt.fromString(I));if(!Ue.isDocumentKey(N))throw new ke(me.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);const P=new Ue(N);v.push(gc(d,P))}else{const N=Wk(f,m,I);v.push(N)}}return new nl(v,y)})(s._query,s.firestore._databaseId,a,e,t,n)}}function iE(s,e,t){if(typeof(t=We(t))=="string"){if(t==="")throw new ke(me.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!r_(e)&&t.indexOf("/")!==-1)throw new ke(me.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Nt.fromString(t));if(!Ue.isDocumentKey(n))throw new ke(me.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return gc(s,new Ue(n))}if(t instanceof ts)return gc(s,t._key);throw new ke(me.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${M0(t)}.`)}function oE(s,e){if(!Array.isArray(s)||s.length===0)throw new ke(me.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function e4(s,e){const t=(function(a,l){for(const c of a)for(const d of c.getFlattenedFilters())if(l.indexOf(d.op)>=0)return d.op;return null})(s.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ke(me.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ke(me.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function ax(s,e,t){let n;return n=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,n}class t8 extends W_{constructor(e){super(),this.firestore=e}convertBytes(e){return new Rn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ts(this.firestore,null,t)}}class rc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Jr=class t4 extends rm{constructor(e,t,n,a,l,c){super(e,t,n,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Rf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Nc("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ke(me.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=t4._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Jr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Jr._jsonSchema={type:Hs("string",Jr._jsonSchemaVersion),bundleSource:Hs("string","DocumentSnapshot"),bundleName:Hs("string"),bundle:Hs("string")};let Rf=class extends Jr{data(e={}){return super.data(e)}},ya=class s4{constructor(e,t,n,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new rc(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Rf(this._firestore,this._userDataWriter,n.key,n,new rc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ke(me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map((d=>{const f=new Rf(a._firestore,a._userDataWriter,d.doc.key,d.doc,new rc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);return d.doc,{type:"added",doc:f,oldIndex:-1,newIndex:c++}}))}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((d=>l||d.type!==3)).map((d=>{const f=new Rf(a._firestore,a._userDataWriter,d.doc.key,d.doc,new rc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);let m=-1,x=-1;return d.type!==0&&(m=c.indexOf(d.doc.key),c=c.delete(d.doc.key)),d.type!==1&&(c=c.add(d.doc),x=c.indexOf(d.doc.key)),{type:s8(d.type),doc:f,oldIndex:m,newIndex:x}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ke(me.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=s4._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Wv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),n.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function s8(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return qe(61501,{type:s})}}function n4(s,e){return s instanceof Jr&&e instanceof Jr?s._firestore===e._firestore&&s._key.isEqual(e._key)&&(s._document===null?e._document===null:s._document.isEqual(e._document))&&s._converter===e._converter:s instanceof ya&&e instanceof ya&&s._firestore===e._firestore&&$k(s.query,e.query)&&s.metadata.isEqual(e.metadata)&&s._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ya._jsonSchemaVersion="firestore/querySnapshot/1.0",ya._jsonSchema={type:Hs("string",ya._jsonSchemaVersion),bundleSource:Hs("string","QuerySnapshot"),bundleName:Hs("string"),bundle:Hs("string")};const n8={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let r8=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Lc(e)}set(e,t,n){this._verifyNotCommitted();const a=Bo(e,this._firestore),l=ax(a.converter,t,n),c=ex(this._dataReader,"WriteBatch.set",a._key,l,a.converter!==null,n);return this._mutations.push(c.toMutation(a._key,fs.none())),this}update(e,t,n,...a){this._verifyNotCommitted();const l=Bo(e,this._firestore);let c;return c=typeof(t=We(t))=="string"||t instanceof jc?H_(this._dataReader,"WriteBatch.update",l._key,t,n,a):q_(this._dataReader,"WriteBatch.update",l._key,t),this._mutations.push(c.toMutation(l._key,fs.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Bo(e,this._firestore);return this._mutations=this._mutations.concat(new qd(t._key,fs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ke(me.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Bo(s,e){if((s=We(s)).firestore!==e)throw new ke(me.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a8{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Lc(e)}get(e){const t=Bo(e,this._firestore),n=new t8(this._firestore);return this._transaction.lookup([t._key]).then((a=>{if(!a||a.length!==1)return qe(24041);const l=a[0];if(l.isFoundDocument())return new rm(this._firestore,n,l.key,l,t.converter);if(l.isNoDocument())return new rm(this._firestore,n,t._key,null,t.converter);throw qe(18433,{doc:l})}))}set(e,t,n){const a=Bo(e,this._firestore),l=ax(a.converter,t,n),c=ex(this._dataReader,"Transaction.set",a._key,l,a.converter!==null,n);return this._transaction.set(a._key,c),this}update(e,t,n,...a){const l=Bo(e,this._firestore);let c;return c=typeof(t=We(t))=="string"||t instanceof jc?H_(this._dataReader,"Transaction.update",l._key,t,n,a):q_(this._dataReader,"Transaction.update",l._key,t),this._transaction.update(l._key,c),this}delete(e){const t=Bo(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let i8=class extends a8{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Bo(e,this._firestore),n=new Uc(this._firestore);return super.get(e).then((a=>new Jr(this._firestore,n,t._key,a._document,new rc(!1,!1),t.converter)))}};function o8(s,e,t){s=Rt(s,Cs);const n={...n8,...t};(function(c){if(c.maxAttempts<1)throw new ke(me.INVALID_ARGUMENT,"Max attempts must be at least 1")})(n);const a=Pn(s);return wV(a,(l=>e(new i8(s,l))),n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l8(s){s=Rt(s,ts);const e=Rt(s.firestore,Cs),t=Pn(e);return Dk(t,s._key).then((n=>J_(e,s,n)))}function c8(s){s=Rt(s,ts);const e=Rt(s.firestore,Cs),t=Pn(e),n=new Uc(e);return pV(t,s._key).then((a=>new Jr(e,n,s._key,a,new rc(a!==null&&a.hasLocalMutations,!0),s.converter)))}function u8(s){s=Rt(s,ts);const e=Rt(s.firestore,Cs),t=Pn(e);return Dk(t,s._key,{source:"server"}).then((n=>J_(e,s,n)))}function d8(s){s=Rt(s,Qn);const e=Rt(s.firestore,Cs),t=Pn(e),n=new Uc(e);return Xk(s._query),Ok(t,s._query).then((a=>new ya(e,n,s,a)))}function h8(s){s=Rt(s,Qn);const e=Rt(s.firestore,Cs),t=Pn(e),n=new Uc(e);return xV(t,s._query).then((a=>new ya(e,n,s,a)))}function f8(s){s=Rt(s,Qn);const e=Rt(s.firestore,Cs),t=Pn(e),n=new Uc(e);return Ok(t,s._query,{source:"server"}).then((a=>new ya(e,n,s,a)))}function lE(s,e,t){s=Rt(s,ts);const n=Rt(s.firestore,Cs),a=ax(s.converter,e,t),l=Lc(n);return Pm(n,[ex(l,"setDoc",s._key,a,s.converter!==null,t).toMutation(s._key,fs.none())])}function cE(s,e,t,...n){s=Rt(s,ts);const a=Rt(s.firestore,Cs),l=Lc(a);let c;return c=typeof(e=We(e))=="string"||e instanceof jc?H_(l,"updateDoc",s._key,e,t,n):q_(l,"updateDoc",s._key,e),Pm(a,[c.toMutation(s._key,fs.exists(!0))])}function m8(s){return Pm(Rt(s.firestore,Cs),[new qd(s._key,fs.none())])}function g8(s,e){const t=Rt(s.firestore,Cs),n=m0(s),a=ax(s.converter,e),l=Lc(s.firestore);return Pm(t,[ex(l,"addDoc",n._key,a,s.converter!==null,{}).toMutation(n._key,fs.exists(!1))]).then((()=>n))}function r4(s,...e){var m,x,y;s=We(s);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||Zw(e[n])||(t=e[n++]);const a={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Zw(e[n])){const w=e[n];e[n]=(m=w.next)==null?void 0:m.bind(w),e[n+1]=(x=w.error)==null?void 0:x.bind(w),e[n+2]=(y=w.complete)==null?void 0:y.bind(w)}let l,c,d;if(s instanceof ts)c=Rt(s.firestore,Cs),d=Bd(s._key.path),l={next:w=>{e[n]&&e[n](J_(c,s,w))},error:e[n+1],complete:e[n+2]};else{const w=Rt(s,Qn);c=Rt(w.firestore,Cs),d=w._query;const v=new Uc(c);l={next:T=>{e[n]&&e[n](new ya(c,v,w,T))},error:e[n+1],complete:e[n+2]},Xk(s._query)}const f=Pn(c);return gV(f,d,a,l)}function p8(s,e){s=Rt(s,Cs);const t=Pn(s),n=Zw(e)?e:{next:e};return yV(t,n)}function Pm(s,e){const t=Pn(s);return bV(t,e)}function J_(s,e,t){const n=t.docs.get(e._key),a=new Uc(s);return new Jr(s,a,e._key,n,new rc(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){WP(Hi),dr(new un("firestore",((n,{instanceIdentifier:a,options:l})=>{const c=n.getProvider("app").getImmediate(),d=new Cs(new XP(n.getProvider("auth-internal")),new t6(c,n.getProvider("app-check-internal")),U6(c,a),c);return l={useFetchStreams:t,...l},d._setSettings(l),d}),"PUBLIC").setMultipleInstances(!0)),vn(rE,aE,e),vn(rE,aE,"esm2020")})();const x8="@firebase/firestore-compat",b8="0.4.4";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X_(s,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new ke("invalid-argument",`Invalid options passed to function ${s}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uE(){if(typeof Uint8Array>"u")throw new ke("unimplemented","Uint8Arrays are not available in this environment.")}function dE(){if(!M6())throw new ke("unimplemented","Blobs are unavailable in Firestore in this environment.")}let a4=class ev{constructor(e){this._delegate=e}static fromBase64String(e){return dE(),new ev(Rn.fromBase64String(e))}static fromUint8Array(e){return uE(),new ev(Rn.fromUint8Array(e))}toBase64(){return dE(),this._delegate.toBase64()}toUint8Array(){return uE(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tv(s){return y8(s,["next","error","complete"])}function y8(s,e){if(typeof s!="object"||s===null)return!1;const t=s;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w8{enableIndexedDbPersistence(e,t){return AV(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return kV(e._delegate)}clearIndexedDbPersistence(e){return CV(e._delegate)}}class i4{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof el||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&ri("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,n={}){SV(this._delegate,e,t,n)}enableNetwork(){return DV(this._delegate)}disableNetwork(){return OV(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,II("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return RV(this._delegate)}onSnapshotsInSync(e){return p8(this._delegate,e)}get app(){if(!this._appCompat)throw new ke("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Od(this,Uk(this._delegate,e))}catch(t){throw Bn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Wr(this,m0(this._delegate,e))}catch(t){throw Bn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new $n(this,TV(this._delegate,e))}catch(t){throw Bn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return o8(this._delegate,t=>e(new o4(this,t)))}batch(){return Pn(this._delegate),new l4(new r8(this._delegate,e=>Pm(this._delegate,e)))}loadBundle(e){return PV(this._delegate,e)}namedQuery(e){return MV(this._delegate,e).then(t=>t?new $n(this,t):null)}}class ix extends W_{constructor(e){super(),this.firestore=e}convertBytes(e){return new a4(new Rn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Wr.forKey(t,this.firestore,null)}}function v8(s){KP(s)}class o4{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new ix(e)}get(e){const t=ac(e);return this._delegate.get(t).then(n=>new am(this._firestore,new Jr(this._firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,t.converter)))}set(e,t,n){const a=ac(e);return n?(X_("Transaction.set",n),this._delegate.set(a,t,n)):this._delegate.set(a,t),this}update(e,t,n,...a){const l=ac(e);return arguments.length===2?this._delegate.update(l,t):this._delegate.update(l,t,n,...a),this}delete(e){const t=ac(e);return this._delegate.delete(t),this}}class l4{constructor(e){this._delegate=e}set(e,t,n){const a=ac(e);return n?(X_("WriteBatch.set",n),this._delegate.set(a,t,n)):this._delegate.set(a,t),this}update(e,t,n,...a){const l=ac(e);return arguments.length===2?this._delegate.update(l,t):this._delegate.update(l,t,n,...a),this}delete(e){const t=ac(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Sc{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new Rf(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new im(this._firestore,n),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=Sc.INSTANCES;let a=n.get(e);a||(a=new WeakMap,n.set(e,a));let l=a.get(t);return l||(l=new Sc(e,new ix(e),t),a.set(t,l)),l}}Sc.INSTANCES=new WeakMap;class Wr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ix(e)}static forPath(e,t,n){if(e.length%2!==0)throw new ke("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Wr(t,new ts(t._delegate,n,new Ue(e)))}static forKey(e,t,n){return new Wr(t,new ts(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new Od(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Od(this.firestore,Uk(this._delegate,e))}catch(t){throw Bn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=We(e),e instanceof ts?Fk(this._delegate,e):!1}set(e,t){t=X_("DocumentReference.set",t);try{return t?lE(this._delegate,e,t):lE(this._delegate,e)}catch(n){throw Bn(n,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return arguments.length===1?cE(this._delegate,e):cE(this._delegate,e,t,...n)}catch(a){throw Bn(a,"updateDoc()","DocumentReference.update()")}}delete(){return m8(this._delegate)}onSnapshot(...e){const t=c4(e),n=u4(e,a=>new am(this.firestore,new Jr(this.firestore._delegate,this._userDataWriter,a._key,a._document,a.metadata,this._delegate.converter)));return r4(this._delegate,t,n)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=c8(this._delegate):(e==null?void 0:e.source)==="server"?t=u8(this._delegate):t=l8(this._delegate),t.then(n=>new am(this.firestore,new Jr(this.firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,this._delegate.converter)))}withConverter(e){return new Wr(this.firestore,e?this._delegate.withConverter(Sc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Bn(s,e,t){return s.message=s.message.replace(e,t),s}function c4(s){for(const e of s)if(typeof e=="object"&&!tv(e))return e;return{}}function u4(s,e){var n,a;let t;return tv(s[0])?t=s[0]:tv(s[1])?t=s[1]:typeof s[0]=="function"?t={next:s[0],error:s[1],complete:s[2]}:t={next:s[1],error:s[2],complete:s[3]},{next:l=>{t.next&&t.next(e(l))},error:(n=t.error)==null?void 0:n.bind(t),complete:(a=t.complete)==null?void 0:a.bind(t)}}class am{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Wr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return n4(this._delegate,e._delegate)}}class im extends am{data(e){const t=this._delegate.data(e);return this._delegate._converter||QP(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class $n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ix(e)}where(e,t,n){try{return new $n(this.firestore,Po(this._delegate,WV(e,t,n)))}catch(a){throw Bn(a,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new $n(this.firestore,Po(this._delegate,KV(e,t)))}catch(n){throw Bn(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new $n(this.firestore,Po(this._delegate,QV(e)))}catch(t){throw Bn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new $n(this.firestore,Po(this._delegate,YV(e)))}catch(t){throw Bn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new $n(this.firestore,Po(this._delegate,JV(...e)))}catch(t){throw Bn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new $n(this.firestore,Po(this._delegate,XV(...e)))}catch(t){throw Bn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new $n(this.firestore,Po(this._delegate,ZV(...e)))}catch(t){throw Bn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new $n(this.firestore,Po(this._delegate,e8(...e)))}catch(t){throw Bn(t,"endAt()","Query.endAt()")}}isEqual(e){return $k(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=h8(this._delegate):(e==null?void 0:e.source)==="server"?t=f8(this._delegate):t=d8(this._delegate),t.then(n=>new sv(this.firestore,new ya(this.firestore._delegate,this._userDataWriter,this._delegate,n._snapshot)))}onSnapshot(...e){const t=c4(e),n=u4(e,a=>new sv(this.firestore,new ya(this.firestore._delegate,this._userDataWriter,this._delegate,a._snapshot)));return r4(this._delegate,t,n)}withConverter(e){return new $n(this.firestore,e?this._delegate.withConverter(Sc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class _8{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new im(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class sv{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new $n(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new im(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new _8(this._firestore,t))}forEach(e,t){this._delegate.forEach(n=>{e.call(t,new im(this._firestore,n))})}isEqual(e){return n4(this._delegate,e._delegate)}}class Od extends $n{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Wr(this.firestore,e):null}doc(e){try{return e===void 0?new Wr(this.firestore,m0(this._delegate)):new Wr(this.firestore,m0(this._delegate,e))}catch(t){throw Bn(t,"doc()","CollectionReference.doc()")}}add(e){return g8(this._delegate,e).then(t=>new Wr(this.firestore,t))}isEqual(e){return Fk(this._delegate,e._delegate)}withConverter(e){return new Od(this.firestore,e?this._delegate.withConverter(Sc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function ac(s){return Rt(s,ts)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{constructor(...e){this._delegate=new jc(...e)}static documentId(){return new Z_(hs.keyField().canonicalString())}isEqual(e){return e=We(e),e instanceof jc?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{static serverTimestamp(){const e=BV();return e._methodName="FieldValue.serverTimestamp",new ec(e)}static delete(){const e=$V();return e._methodName="FieldValue.delete",new ec(e)}static arrayUnion(...e){const t=zV(...e);return t._methodName="FieldValue.arrayUnion",new ec(t)}static arrayRemove(...e){const t=qV(...e);return t._methodName="FieldValue.arrayRemove",new ec(t)}static increment(e){const t=HV(e);return t._methodName="FieldValue.increment",new ec(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j8={Firestore:i4,GeoPoint:xa,Timestamp:Mt,Blob:a4,Transaction:o4,WriteBatch:l4,DocumentReference:Wr,DocumentSnapshot:am,Query:$n,QueryDocumentSnapshot:im,QuerySnapshot:sv,CollectionReference:Od,FieldPath:Z_,FieldValue:ec,setLogLevel:v8,CACHE_SIZE_UNLIMITED:IV};function N8(s,e){s.INTERNAL.registerComponent(new un("firestore-compat",t=>{const n=t.getProvider("app-compat").getImmediate(),a=t.getProvider("firestore").getImmediate();return e(n,a)},"PUBLIC").setServiceProps({...j8}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S8(s){N8(s,(e,t)=>new i4(e,t,new w8)),s.registerVersion(x8,b8)}S8(qs);const d4="@firebase/installations",ej="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h4=1e4,f4=`w:${ej}`,m4="FIS_v2",T8="https://firebaseinstallations.googleapis.com/v1",E8=3600*1e3,I8="installations",A8="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k8={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Tc=new oi(I8,A8,k8);function g4(s){return s instanceof wn&&s.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p4({projectId:s}){return`${T8}/projects/${s}/installations`}function x4(s){return{token:s.token,requestStatus:2,expiresIn:R8(s.expiresIn),creationTime:Date.now()}}async function b4(s,e){const n=(await e.json()).error;return Tc.create("request-failed",{requestName:s,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function y4({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function C8(s,{refreshToken:e}){const t=y4(s);return t.append("Authorization",D8(e)),t}async function w4(s){const e=await s();return e.status>=500&&e.status<600?s():e}function R8(s){return Number(s.replace("s","000"))}function D8(s){return`${m4} ${s}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O8({appConfig:s,heartbeatServiceProvider:e},{fid:t}){const n=p4(s),a=y4(s),l=e.getImmediate({optional:!0});if(l){const m=await l.getHeartbeatsHeader();m&&a.append("x-firebase-client",m)}const c={fid:t,authVersion:m4,appId:s.appId,sdkVersion:f4},d={method:"POST",headers:a,body:JSON.stringify(c)},f=await w4(()=>fetch(n,d));if(f.ok){const m=await f.json();return{fid:m.fid||t,registrationStatus:2,refreshToken:m.refreshToken,authToken:x4(m.authToken)}}else throw await b4("Create Installation",f)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v4(s){return new Promise(e=>{setTimeout(e,s)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P8(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M8=/^[cdef][\w-]{21}$/,nv="";function L8(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const t=V8(s);return M8.test(t)?t:nv}catch{return nv}}function V8(s){return P8(s).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(s){return`${s.appName}!${s.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4=new Map;function j4(s,e){const t=ox(s);N4(t,e),U8(t,e)}function N4(s,e){const t=_4.get(s);if(t)for(const n of t)n(e)}function U8(s,e){const t=F8();t&&t.postMessage({key:s,fid:e}),$8()}let ic=null;function F8(){return!ic&&"BroadcastChannel"in self&&(ic=new BroadcastChannel("[Firebase] FID Change"),ic.onmessage=s=>{N4(s.data.key,s.data.fid)}),ic}function $8(){_4.size===0&&ic&&(ic.close(),ic=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B8="firebase-installations-database",z8=1,Ec="firebase-installations-store";let zy=null;function tj(){return zy||(zy=Fd(B8,z8,{upgrade:(s,e)=>{switch(e){case 0:s.createObjectStore(Ec)}}})),zy}async function p0(s,e){const t=ox(s),a=(await tj()).transaction(Ec,"readwrite"),l=a.objectStore(Ec),c=await l.get(t);return await l.put(e,t),await a.done,(!c||c.fid!==e.fid)&&j4(s,e.fid),e}async function S4(s){const e=ox(s),n=(await tj()).transaction(Ec,"readwrite");await n.objectStore(Ec).delete(e),await n.done}async function lx(s,e){const t=ox(s),a=(await tj()).transaction(Ec,"readwrite"),l=a.objectStore(Ec),c=await l.get(t),d=e(c);return d===void 0?await l.delete(t):await l.put(d,t),await a.done,d&&(!c||c.fid!==d.fid)&&j4(s,d.fid),d}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sj(s){let e;const t=await lx(s.appConfig,n=>{const a=q8(n),l=H8(s,a);return e=l.registrationPromise,l.installationEntry});return t.fid===nv?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function q8(s){const e=s||{fid:L8(),registrationStatus:0};return T4(e)}function H8(s,e){if(e.registrationStatus===0){if(!navigator.onLine){const a=Promise.reject(Tc.create("app-offline"));return{installationEntry:e,registrationPromise:a}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=G8(s,t);return{installationEntry:t,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:W8(s)}:{installationEntry:e}}async function G8(s,e){try{const t=await O8(s,e);return p0(s.appConfig,t)}catch(t){throw g4(t)&&t.customData.serverCode===409?await S4(s.appConfig):await p0(s.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function W8(s){let e=await hE(s.appConfig);for(;e.registrationStatus===1;)await v4(100),e=await hE(s.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:n}=await sj(s);return n||t}return e}function hE(s){return lx(s,e=>{if(!e)throw Tc.create("installation-not-found");return T4(e)})}function T4(s){return K8(s)?{fid:s.fid,registrationStatus:0}:s}function K8(s){return s.registrationStatus===1&&s.registrationTime+h4<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q8({appConfig:s,heartbeatServiceProvider:e},t){const n=Y8(s,t),a=C8(s,t),l=e.getImmediate({optional:!0});if(l){const m=await l.getHeartbeatsHeader();m&&a.append("x-firebase-client",m)}const c={installation:{sdkVersion:f4,appId:s.appId}},d={method:"POST",headers:a,body:JSON.stringify(c)},f=await w4(()=>fetch(n,d));if(f.ok){const m=await f.json();return x4(m)}else throw await b4("Generate Auth Token",f)}function Y8(s,{fid:e}){return`${p4(s)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nj(s,e=!1){let t;const n=await lx(s.appConfig,l=>{if(!E4(l))throw Tc.create("not-registered");const c=l.authToken;if(!e&&Z8(c))return l;if(c.requestStatus===1)return t=J8(s,e),l;{if(!navigator.onLine)throw Tc.create("app-offline");const d=t9(l);return t=X8(s,d),d}});return t?await t:n.authToken}async function J8(s,e){let t=await fE(s.appConfig);for(;t.authToken.requestStatus===1;)await v4(100),t=await fE(s.appConfig);const n=t.authToken;return n.requestStatus===0?nj(s,e):n}function fE(s){return lx(s,e=>{if(!E4(e))throw Tc.create("not-registered");const t=e.authToken;return s9(t)?{...e,authToken:{requestStatus:0}}:e})}async function X8(s,e){try{const t=await Q8(s,e),n={...e,authToken:t};return await p0(s.appConfig,n),t}catch(t){if(g4(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await S4(s.appConfig);else{const n={...e,authToken:{requestStatus:0}};await p0(s.appConfig,n)}throw t}}function E4(s){return s!==void 0&&s.registrationStatus===2}function Z8(s){return s.requestStatus===2&&!e9(s)}function e9(s){const e=Date.now();return e<s.creationTime||s.creationTime+s.expiresIn<e+E8}function t9(s){const e={requestStatus:1,requestTime:Date.now()};return{...s,authToken:e}}function s9(s){return s.requestStatus===1&&s.requestTime+h4<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n9(s){const e=s,{installationEntry:t,registrationPromise:n}=await sj(e);return n?n.catch(console.error):nj(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r9(s,e=!1){const t=s;return await a9(t),(await nj(t,e)).token}async function a9(s){const{registrationPromise:e}=await sj(s);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i9(s){if(!s||!s.options)throw qy("App Configuration");if(!s.name)throw qy("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!s.options[t])throw qy(t);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function qy(s){return Tc.create("missing-app-config-values",{valueName:s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I4="installations",o9="installations-internal",l9=s=>{const e=s.getProvider("app").getImmediate(),t=i9(e),n=P0(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},c9=s=>{const e=s.getProvider("app").getImmediate(),t=P0(e,I4).getImmediate();return{getId:()=>n9(t),getToken:a=>r9(t,a)}};function u9(){dr(new un(I4,l9,"PUBLIC")),dr(new un(o9,c9,"PRIVATE"))}u9();vn(d4,ej);vn(d4,ej,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d9="/firebase-messaging-sw.js",h9="/firebase-cloud-messaging-push-scope",A4="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",f9="https://fcmregistrations.googleapis.com/v1",k4="google.c.a.c_id",m9="google.c.a.c_l",g9="google.c.a.ts",p9="google.c.a.e",mE=1e4;var gE;(function(s){s[s.DATA_MESSAGE=1]="DATA_MESSAGE",s[s.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(gE||(gE={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var om;(function(s){s.PUSH_RECEIVED="push-received",s.NOTIFICATION_CLICKED="notification-clicked"})(om||(om={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ei(s){const e=new Uint8Array(s);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function x9(s){const e="=".repeat((4-s.length%4)%4),t=(s+e).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),a=new Uint8Array(n.length);for(let l=0;l<n.length;++l)a[l]=n.charCodeAt(l);return a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy="fcm_token_details_db",b9=5,pE="fcm_token_object_Store";async function y9(s){if("databases"in indexedDB&&!(await indexedDB.databases()).map(l=>l.name).includes(Hy))return null;let e=null;return(await Fd(Hy,b9,{upgrade:async(n,a,l,c)=>{if(a<2||!n.objectStoreNames.contains(pE))return;const d=c.objectStore(pE),f=await d.index("fcmSenderId").get(s);if(await d.clear(),!!f){if(a===2){const m=f;if(!m.auth||!m.p256dh||!m.endpoint)return;e={token:m.fcmToken,createTime:m.createTime??Date.now(),subscriptionOptions:{auth:m.auth,p256dh:m.p256dh,endpoint:m.endpoint,swScope:m.swScope,vapidKey:typeof m.vapidKey=="string"?m.vapidKey:Ei(m.vapidKey)}}}else if(a===3){const m=f;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:Ei(m.auth),p256dh:Ei(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:Ei(m.vapidKey)}}}else if(a===4){const m=f;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:Ei(m.auth),p256dh:Ei(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:Ei(m.vapidKey)}}}}}})).close(),await rd(Hy),await rd("fcm_vapid_details_db"),await rd("undefined"),w9(e)?e:null}function w9(s){if(!s||!s.subscriptionOptions)return!1;const{subscriptionOptions:e}=s;return typeof s.createTime=="number"&&s.createTime>0&&typeof s.token=="string"&&s.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v9="firebase-messaging-database",_9=1,Ic="firebase-messaging-store";let Gy=null;function rj(){return Gy||(Gy=Fd(v9,_9,{upgrade:(s,e)=>{switch(e){case 0:s.createObjectStore(Ic)}}})),Gy}async function C4(s){const e=ij(s),n=await(await rj()).transaction(Ic).objectStore(Ic).get(e);if(n)return n;{const a=await y9(s.appConfig.senderId);if(a)return await aj(s,a),a}}async function aj(s,e){const t=ij(s),a=(await rj()).transaction(Ic,"readwrite");return await a.objectStore(Ic).put(e,t),await a.done,e}async function j9(s){const e=ij(s),n=(await rj()).transaction(Ic,"readwrite");await n.objectStore(Ic).delete(e),await n.done}function ij({appConfig:s}){return s.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N9={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Gn=new oi("messaging","Messaging",N9);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S9(s,e){const t=await lj(s),n=D4(e),a={method:"POST",headers:t,body:JSON.stringify(n)};let l;try{l=await(await fetch(oj(s.appConfig),a)).json()}catch(c){throw Gn.create("token-subscribe-failed",{errorInfo:c==null?void 0:c.toString()})}if(l.error){const c=l.error.message;throw Gn.create("token-subscribe-failed",{errorInfo:c})}if(!l.token)throw Gn.create("token-subscribe-no-token");return l.token}async function T9(s,e){const t=await lj(s),n=D4(e.subscriptionOptions),a={method:"PATCH",headers:t,body:JSON.stringify(n)};let l;try{l=await(await fetch(`${oj(s.appConfig)}/${e.token}`,a)).json()}catch(c){throw Gn.create("token-update-failed",{errorInfo:c==null?void 0:c.toString()})}if(l.error){const c=l.error.message;throw Gn.create("token-update-failed",{errorInfo:c})}if(!l.token)throw Gn.create("token-update-no-token");return l.token}async function R4(s,e){const n={method:"DELETE",headers:await lj(s)};try{const l=await(await fetch(`${oj(s.appConfig)}/${e}`,n)).json();if(l.error){const c=l.error.message;throw Gn.create("token-unsubscribe-failed",{errorInfo:c})}}catch(a){throw Gn.create("token-unsubscribe-failed",{errorInfo:a==null?void 0:a.toString()})}}function oj({projectId:s}){return`${f9}/projects/${s}/registrations`}async function lj({appConfig:s,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function D4({p256dh:s,auth:e,endpoint:t,vapidKey:n}){const a={web:{endpoint:t,auth:e,p256dh:s}};return n!==A4&&(a.web.applicationPubKey=n),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E9=10080*60*1e3;async function I9(s){const e=await C9(s.swRegistration,s.vapidKey),t={vapidKey:s.vapidKey,swScope:s.swRegistration.scope,endpoint:e.endpoint,auth:Ei(e.getKey("auth")),p256dh:Ei(e.getKey("p256dh"))},n=await C4(s.firebaseDependencies);if(n){if(R9(n.subscriptionOptions,t))return Date.now()>=n.createTime+E9?k9(s,{token:n.token,createTime:Date.now(),subscriptionOptions:t}):n.token;try{await R4(s.firebaseDependencies,n.token)}catch(a){console.warn(a)}return xE(s.firebaseDependencies,t)}else return xE(s.firebaseDependencies,t)}async function A9(s){const e=await C4(s.firebaseDependencies);e&&(await R4(s.firebaseDependencies,e.token),await j9(s.firebaseDependencies));const t=await s.swRegistration.pushManager.getSubscription();return t?t.unsubscribe():!0}async function k9(s,e){try{const t=await T9(s.firebaseDependencies,e),n={...e,token:t,createTime:Date.now()};return await aj(s.firebaseDependencies,n),t}catch(t){throw t}}async function xE(s,e){const n={token:await S9(s,e),createTime:Date.now(),subscriptionOptions:e};return await aj(s,n),n.token}async function C9(s,e){const t=await s.pushManager.getSubscription();return t||s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:x9(e)})}function R9(s,e){const t=e.vapidKey===s.vapidKey,n=e.endpoint===s.endpoint,a=e.auth===s.auth,l=e.p256dh===s.p256dh;return t&&n&&a&&l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bE(s){const e={from:s.from,collapseKey:s.collapse_key,messageId:s.fcmMessageId};return D9(e,s),O9(e,s),P9(e,s),e}function D9(s,e){if(!e.notification)return;s.notification={};const t=e.notification.title;t&&(s.notification.title=t);const n=e.notification.body;n&&(s.notification.body=n);const a=e.notification.image;a&&(s.notification.image=a);const l=e.notification.icon;l&&(s.notification.icon=l)}function O9(s,e){e.data&&(s.data=e.data)}function P9(s,e){var a,l,c,d;if(!e.fcmOptions&&!((a=e.notification)!=null&&a.click_action))return;s.fcmOptions={};const t=((l=e.fcmOptions)==null?void 0:l.link)??((c=e.notification)==null?void 0:c.click_action);t&&(s.fcmOptions.link=t);const n=(d=e.fcmOptions)==null?void 0:d.analytics_label;n&&(s.fcmOptions.analyticsLabel=n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M9(s){return typeof s=="object"&&!!s&&k4 in s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L9(s){if(!s||!s.options)throw Wy("App Configuration Object");if(!s.name)throw Wy("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=s;for(const n of e)if(!t[n])throw Wy(n);return{appName:s.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function Wy(s){return Gn.create("missing-app-config-values",{valueName:s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let V9=class{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const a=L9(e);this.firebaseDependencies={app:e,appConfig:a,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O4(s){try{s.swRegistration=await navigator.serviceWorker.register(d9,{scope:h9}),s.swRegistration.update().catch(()=>{}),await U9(s.swRegistration)}catch(e){throw Gn.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function U9(s){return new Promise((e,t)=>{const n=setTimeout(()=>t(new Error(`Service worker not registered after ${mE} ms`)),mE),a=s.installing||s.waiting;s.active?(clearTimeout(n),e()):a?a.onstatechange=l=>{var c;((c=l.target)==null?void 0:c.state)==="activated"&&(a.onstatechange=null,clearTimeout(n),e())}:(clearTimeout(n),t(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F9(s,e){if(!e&&!s.swRegistration&&await O4(s),!(!e&&s.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw Gn.create("invalid-sw-registration");s.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $9(s,e){e?s.vapidKey=e:s.vapidKey||(s.vapidKey=A4)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P4(s,e){if(!navigator)throw Gn.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw Gn.create("permission-blocked");return await $9(s,e==null?void 0:e.vapidKey),await F9(s,e==null?void 0:e.serviceWorkerRegistration),I9(s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B9(s,e,t){const n=z9(e);(await s.firebaseDependencies.analyticsProvider.get()).logEvent(n,{message_id:t[k4],message_name:t[m9],message_time:t[g9],message_device_time:Math.floor(Date.now()/1e3)})}function z9(s){switch(s){case om.NOTIFICATION_CLICKED:return"notification_open";case om.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q9(s,e){const t=e.data;if(!t.isFirebaseMessaging)return;s.onMessageHandler&&t.messageType===om.PUSH_RECEIVED&&(typeof s.onMessageHandler=="function"?s.onMessageHandler(bE(t)):s.onMessageHandler.next(bE(t)));const n=t.data;M9(n)&&n[p9]==="1"&&await B9(s,t.messageType,n)}const yE="@firebase/messaging",wE="0.12.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H9=s=>{const e=new V9(s.getProvider("app").getImmediate(),s.getProvider("installations-internal").getImmediate(),s.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>q9(e,t)),e},G9=s=>{const e=s.getProvider("messaging").getImmediate();return{getToken:n=>P4(e,n)}};function W9(){dr(new un("messaging",H9,"PUBLIC")),dr(new un("messaging-internal",G9,"PRIVATE")),vn(yE,wE),vn(yE,wE,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K9(s){if(!navigator)throw Gn.create("only-available-in-window");return s.swRegistration||await O4(s),A9(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q9(s,e){if(!navigator)throw Gn.create("only-available-in-window");return s.onMessageHandler=e,()=>{s.onMessageHandler=null}}async function Y9(s,e){return s=We(s),P4(s,e)}function J9(s){return s=We(s),K9(s)}function X9(s,e){return s=We(s),Q9(s,e)}W9();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M4="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Z9="https://fcmregistrations.googleapis.com/v1",L4="FCM_MSG",eU="google.c.a.c_id",tU=3,sU=1;var x0;(function(s){s[s.DATA_MESSAGE=1]="DATA_MESSAGE",s[s.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(x0||(x0={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var b0;(function(s){s.PUSH_RECEIVED="push-received",s.NOTIFICATION_CLICKED="notification-clicked"})(b0||(b0={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ii(s){const e=new Uint8Array(s);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function nU(s){const e="=".repeat((4-s.length%4)%4),t=(s+e).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),a=new Uint8Array(n.length);for(let l=0;l<n.length;++l)a[l]=n.charCodeAt(l);return a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ky="fcm_token_details_db",rU=5,vE="fcm_token_object_Store";async function aU(s){if("databases"in indexedDB&&!(await indexedDB.databases()).map(l=>l.name).includes(Ky))return null;let e=null;return(await Fd(Ky,rU,{upgrade:async(n,a,l,c)=>{if(a<2||!n.objectStoreNames.contains(vE))return;const d=c.objectStore(vE),f=await d.index("fcmSenderId").get(s);if(await d.clear(),!!f){if(a===2){const m=f;if(!m.auth||!m.p256dh||!m.endpoint)return;e={token:m.fcmToken,createTime:m.createTime??Date.now(),subscriptionOptions:{auth:m.auth,p256dh:m.p256dh,endpoint:m.endpoint,swScope:m.swScope,vapidKey:typeof m.vapidKey=="string"?m.vapidKey:Ii(m.vapidKey)}}}else if(a===3){const m=f;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:Ii(m.auth),p256dh:Ii(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:Ii(m.vapidKey)}}}else if(a===4){const m=f;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:Ii(m.auth),p256dh:Ii(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:Ii(m.vapidKey)}}}}}})).close(),await rd(Ky),await rd("fcm_vapid_details_db"),await rd("undefined"),iU(e)?e:null}function iU(s){if(!s||!s.subscriptionOptions)return!1;const{subscriptionOptions:e}=s;return typeof s.createTime=="number"&&s.createTime>0&&typeof s.token=="string"&&s.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oU="firebase-messaging-database",lU=1,Ac="firebase-messaging-store";let Qy=null;function cj(){return Qy||(Qy=Fd(oU,lU,{upgrade:(s,e)=>{switch(e){case 0:s.createObjectStore(Ac)}}})),Qy}async function uj(s){const e=hj(s),n=await(await cj()).transaction(Ac).objectStore(Ac).get(e);if(n)return n;{const a=await aU(s.appConfig.senderId);if(a)return await dj(s,a),a}}async function dj(s,e){const t=hj(s),a=(await cj()).transaction(Ac,"readwrite");return await a.objectStore(Ac).put(e,t),await a.done,e}async function cU(s){const e=hj(s),n=(await cj()).transaction(Ac,"readwrite");await n.objectStore(Ac).delete(e),await n.done}function hj({appConfig:s}){return s.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uU={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},si=new oi("messaging","Messaging",uU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dU(s,e){const t=await mj(s),n=U4(e),a={method:"POST",headers:t,body:JSON.stringify(n)};let l;try{l=await(await fetch(fj(s.appConfig),a)).json()}catch(c){throw si.create("token-subscribe-failed",{errorInfo:c==null?void 0:c.toString()})}if(l.error){const c=l.error.message;throw si.create("token-subscribe-failed",{errorInfo:c})}if(!l.token)throw si.create("token-subscribe-no-token");return l.token}async function hU(s,e){const t=await mj(s),n=U4(e.subscriptionOptions),a={method:"PATCH",headers:t,body:JSON.stringify(n)};let l;try{l=await(await fetch(`${fj(s.appConfig)}/${e.token}`,a)).json()}catch(c){throw si.create("token-update-failed",{errorInfo:c==null?void 0:c.toString()})}if(l.error){const c=l.error.message;throw si.create("token-update-failed",{errorInfo:c})}if(!l.token)throw si.create("token-update-no-token");return l.token}async function V4(s,e){const n={method:"DELETE",headers:await mj(s)};try{const l=await(await fetch(`${fj(s.appConfig)}/${e}`,n)).json();if(l.error){const c=l.error.message;throw si.create("token-unsubscribe-failed",{errorInfo:c})}}catch(a){throw si.create("token-unsubscribe-failed",{errorInfo:a==null?void 0:a.toString()})}}function fj({projectId:s}){return`${Z9}/projects/${s}/registrations`}async function mj({appConfig:s,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function U4({p256dh:s,auth:e,endpoint:t,vapidKey:n}){const a={web:{endpoint:t,auth:e,p256dh:s}};return n!==M4&&(a.web.applicationPubKey=n),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fU=10080*60*1e3;async function mU(s){const e=await pU(s.swRegistration,s.vapidKey),t={vapidKey:s.vapidKey,swScope:s.swRegistration.scope,endpoint:e.endpoint,auth:Ii(e.getKey("auth")),p256dh:Ii(e.getKey("p256dh"))},n=await uj(s.firebaseDependencies);if(n){if(xU(n.subscriptionOptions,t))return Date.now()>=n.createTime+fU?gU(s,{token:n.token,createTime:Date.now(),subscriptionOptions:t}):n.token;try{await V4(s.firebaseDependencies,n.token)}catch(a){console.warn(a)}return jE(s.firebaseDependencies,t)}else return jE(s.firebaseDependencies,t)}async function _E(s){const e=await uj(s.firebaseDependencies);e&&(await V4(s.firebaseDependencies,e.token),await cU(s.firebaseDependencies));const t=await s.swRegistration.pushManager.getSubscription();return t?t.unsubscribe():!0}async function gU(s,e){try{const t=await hU(s.firebaseDependencies,e),n={...e,token:t,createTime:Date.now()};return await dj(s.firebaseDependencies,n),t}catch(t){throw t}}async function jE(s,e){const n={token:await dU(s,e),createTime:Date.now(),subscriptionOptions:e};return await dj(s,n),n.token}async function pU(s,e){const t=await s.pushManager.getSubscription();return t||s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:nU(e)})}function xU(s,e){const t=e.vapidKey===s.vapidKey,n=e.endpoint===s.endpoint,a=e.auth===s.auth,l=e.p256dh===s.p256dh;return t&&n&&a&&l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bU(s){const e={from:s.from,collapseKey:s.collapse_key,messageId:s.fcmMessageId};return yU(e,s),wU(e,s),vU(e,s),e}function yU(s,e){if(!e.notification)return;s.notification={};const t=e.notification.title;t&&(s.notification.title=t);const n=e.notification.body;n&&(s.notification.body=n);const a=e.notification.image;a&&(s.notification.image=a);const l=e.notification.icon;l&&(s.notification.icon=l)}function wU(s,e){e.data&&(s.data=e.data)}function vU(s,e){var a,l,c,d;if(!e.fcmOptions&&!((a=e.notification)!=null&&a.click_action))return;s.fcmOptions={};const t=((l=e.fcmOptions)==null?void 0:l.link)??((c=e.notification)==null?void 0:c.click_action);t&&(s.fcmOptions.link=t);const n=(d=e.fcmOptions)==null?void 0:d.analytics_label;n&&(s.fcmOptions.analyticsLabel=n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _U(s){return typeof s=="object"&&!!s&&eU in s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jU(s){return new Promise(e=>{setTimeout(e,s)})}async function NU(s,e){const t=SU(e,await s.firebaseDependencies.installations.getId());TU(s,t,e.productId)}function SU(s,e){var n,a;const t={};return s.from&&(t.project_number=s.from),s.fcmMessageId&&(t.message_id=s.fcmMessageId),t.instance_id=e,s.notification?t.message_type=x0.DISPLAY_NOTIFICATION.toString():t.message_type=x0.DATA_MESSAGE.toString(),t.sdk_platform=tU.toString(),t.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),s.collapse_key&&(t.collapse_key=s.collapse_key),t.event=sU.toString(),(n=s.fcmOptions)!=null&&n.analytics_label&&(t.analytics_label=(a=s.fcmOptions)==null?void 0:a.analytics_label),t}function TU(s,e,t){const n={};n.event_time_ms=Math.floor(Date.now()).toString(),n.source_extension_json_proto3=JSON.stringify({messaging_client_event:e}),t&&(n.compliance_data=EU(t)),s.logEvents.push(n)}function EU(s){return{privacy_context:{prequest:{origin_associated_product_id:s}}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IU(s,e){var a;const{newSubscription:t}=s;if(!t){await _E(e);return}const n=await uj(e.firebaseDependencies);await _E(e),e.vapidKey=((a=n==null?void 0:n.subscriptionOptions)==null?void 0:a.vapidKey)??M4,await mU(e)}async function AU(s,e){const t=RU(s);if(!t)return;e.deliveryMetricsExportedToBigQueryEnabled&&await NU(e,t);const n=await F4();if(OU(n))return PU(n,t);if(t.notification&&await MU(CU(t)),!!e&&e.onBackgroundMessageHandler){const a=bU(t);typeof e.onBackgroundMessageHandler=="function"?await e.onBackgroundMessageHandler(a):e.onBackgroundMessageHandler.next(a)}}async function kU(s){var c,d;const e=(d=(c=s.notification)==null?void 0:c.data)==null?void 0:d[L4];if(e){if(s.action)return}else return;s.stopImmediatePropagation(),s.notification.close();const t=LU(e);if(!t)return;const n=new URL(t,self.location.href),a=new URL(self.location.origin);if(n.host!==a.host)return;let l=await DU(n);if(l?l=await l.focus():(l=await self.clients.openWindow(t),await jU(3e3)),!!l)return e.messageType=b0.NOTIFICATION_CLICKED,e.isFirebaseMessaging=!0,l.postMessage(e)}function CU(s){const e={...s.notification};return e.data={[L4]:s},e}function RU({data:s}){if(!s)return null;try{return s.json()}catch{return null}}async function DU(s){const e=await F4();for(const t of e){const n=new URL(t.url,self.location.href);if(s.host===n.host)return t}return null}function OU(s){return s.some(e=>e.visibilityState==="visible"&&!e.url.startsWith("chrome-extension://"))}function PU(s,e){e.isFirebaseMessaging=!0,e.messageType=b0.PUSH_RECEIVED;for(const t of s)t.postMessage(e)}function F4(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function MU(s){const{actions:e}=s,{maxActions:t}=Notification;return e&&t&&e.length>t&&console.warn(`This browser only supports ${t} actions. The remaining actions will not be displayed.`),self.registration.showNotification(s.title??"",s)}function LU(s){var t,n;const e=((t=s.fcmOptions)==null?void 0:t.link)??((n=s.notification)==null?void 0:n.click_action);return e||(_U(s.data)?self.location.origin:null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VU(s){if(!s||!s.options)throw Yy("App Configuration Object");if(!s.name)throw Yy("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=s;for(const n of e)if(!t[n])throw Yy(n);return{appName:s.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function Yy(s){return si.create("missing-app-config-values",{valueName:s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UU{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const a=VU(e);this.firebaseDependencies={app:e,appConfig:a,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FU=s=>{const e=new UU(s.getProvider("app").getImmediate(),s.getProvider("installations-internal").getImmediate(),s.getProvider("analytics-internal"));return self.addEventListener("push",t=>{t.waitUntil(AU(t,e))}),self.addEventListener("pushsubscriptionchange",t=>{t.waitUntil(IU(t,e))}),self.addEventListener("notificationclick",t=>{t.waitUntil(kU(t))}),e};function $U(){dr(new un("messaging-sw",FU,"PUBLIC"))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BU(s,e){if(self.document!==void 0)throw si.create("only-available-in-sw");return s.onBackgroundMessageHandler=e,()=>{s.onBackgroundMessageHandler=null}}function zU(s,e){return s=We(s),BU(s,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */$U();const qU="@firebase/messaging-compat",HU="0.2.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GU(){return self&&"ServiceWorkerGlobalScope"in self?KU():WU()}function WU(){return typeof window<"u"&&mc()&&yO()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function KU(){return mc()&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}class NE{constructor(e,t){this.app=e,this._delegate=t,this.app=e,this._delegate=t}async getToken(e){return Y9(this._delegate,e)}async deleteToken(){return J9(this._delegate)}onMessage(e){return X9(this._delegate,e)}onBackgroundMessage(e){return zU(this._delegate,e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QU=s=>self&&"ServiceWorkerGlobalScope"in self?new NE(s.getProvider("app-compat").getImmediate(),s.getProvider("messaging-sw").getImmediate()):new NE(s.getProvider("app-compat").getImmediate(),s.getProvider("messaging").getImmediate()),YU={isSupported:GU};function JU(){qs.INTERNAL.registerComponent(new un("messaging-compat",QU,"PUBLIC").setServiceProps(YU))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */JU();qs.registerVersion(qU,HU);const af={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},Pu={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XU(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function $4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ZU=XU,e7=$4,B4=new oi("auth","Firebase",$4());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y0=new O0("@firebase/auth");function t7(s,...e){y0.logLevel<=jt.WARN&&y0.warn(`Auth (${Hi}): ${s}`,...e)}function Hp(s,...e){y0.logLevel<=jt.ERROR&&y0.error(`Auth (${Hi}): ${s}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tn(s,...e){throw pj(s,...e)}function Xs(s,...e){return pj(s,...e)}function gj(s,e,t){const n={...e7(),[e]:t};return new oi("auth","Firebase",n).create(e,{appName:s.name})}function cn(s){return gj(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Qd(s,e,t){const n=t;if(!(e instanceof n))throw n.name!==e.constructor.name&&Tn(s,"argument-error"),gj(s,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function pj(s,...e){if(typeof s!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=s.name),s._errorFactory.create(t,...n)}return B4.create(s,...e)}function De(s,e,...t){if(!s)throw pj(e,...t)}function Za(s){const e="INTERNAL ASSERTION FAILED: "+s;throw Hp(e),new Error(e)}function _a(s,e){s||Za(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lm(){var s;return typeof self<"u"&&((s=self.location)==null?void 0:s.href)||""}function xj(){return SE()==="http:"||SE()==="https:"}function SE(){var s;return typeof self<"u"&&((s=self.location)==null?void 0:s.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s7(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xj()||sI()||"connection"in navigator)?navigator.onLine:!0}function n7(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{constructor(e,t){this.shortDelay=e,this.longDelay=t,_a(t>e,"Short delay should be less than long delay!"),this.isMobile=gO()||Fv()}get(){return s7()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bj(s,e){_a(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Za("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Za("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Za("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r7={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a7=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],i7=new Mm(3e4,6e4);function js(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function Ns(s,e,t,n,a={}){return q4(s,a,async()=>{let l={},c={};n&&(e==="GET"?c=n:l={body:JSON.stringify(n)});const d=Ud({key:s.config.apiKey,...c}).slice(1),f=await s._getAdditionalHeaders();f["Content-Type"]="application/json",s.languageCode&&(f["X-Firebase-Locale"]=s.languageCode);const m={method:e,headers:f,...l};return xO()||(m.referrerPolicy="no-referrer"),s.emulatorConfig&&ol(s.emulatorConfig.host)&&(m.credentials="include"),z4.fetch()(await H4(s,s.config.apiHost,t,d),m)})}async function q4(s,e,t){s._canInitEmulator=!1;const n={...r7,...e};try{const a=new l7(s),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw wf(s,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const d=l.ok?c.errorMessage:c.error.message,[f,m]=d.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw wf(s,"credential-already-in-use",c);if(f==="EMAIL_EXISTS")throw wf(s,"email-already-in-use",c);if(f==="USER_DISABLED")throw wf(s,"user-disabled",c);const x=n[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw gj(s,x,m);Tn(s,x)}}catch(a){if(a instanceof wn)throw a;Tn(s,"network-request-failed",{message:String(a)})}}async function Yi(s,e,t,n,a={}){const l=await Ns(s,e,t,n,a);return"mfaPendingCredential"in l&&Tn(s,"multi-factor-auth-required",{_serverResponse:l}),l}async function H4(s,e,t,n){const a=`${e}${t}?${n}`,l=s,c=l.config.emulator?bj(s.config,a):`${s.config.apiScheme}://${a}`;return a7.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function o7(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class l7{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(Xs(this.auth,"network-request-failed")),i7.get())})}}function wf(s,e,t){const n={appName:s.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const a=Xs(s,e,n);return a.customData._tokenResponse=t,a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TE(s){return s!==void 0&&s.getResponse!==void 0}function EE(s){return s!==void 0&&s.enterprise!==void 0}class G4{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return o7(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c7(s){return(await Ns(s,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function W4(s,e){return Ns(s,"GET","/v2/recaptchaConfig",js(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u7(s,e){return Ns(s,"POST","/v1/accounts:delete",e)}async function d7(s,e){return Ns(s,"POST","/v1/accounts:update",e)}async function w0(s,e){return Ns(s,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Df(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function h7(s,e=!1){const t=We(s),n=await t.getIdToken(e),a=cx(n);De(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,c=l==null?void 0:l.sign_in_provider;return{claims:a,token:n,authTime:Df(Jy(a.auth_time)),issuedAtTime:Df(Jy(a.iat)),expirationTime:Df(Jy(a.exp)),signInProvider:c||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function Jy(s){return Number(s)*1e3}function cx(s){const[e,t,n]=s.split(".");if(e===void 0||t===void 0||n===void 0)return Hp("JWT malformed, contained fewer than 3 sections"),null;try{const a=Ov(t);return a?JSON.parse(a):(Hp("Failed to decode base64 JWT payload"),null)}catch(a){return Hp("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function IE(s){const e=cx(s);return De(e,"internal-error"),De(typeof e.exp<"u","internal-error"),De(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zi(s,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof wn&&f7(n)&&s.auth.currentUser===s&&await s.auth.signOut(),n}}function f7({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m7{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Df(this.lastLoginAt),this.creationTime=Df(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cm(s){var y;const e=s.auth,t=await s.getIdToken(),n=await zi(s,w0(e,{idToken:t}));De(n==null?void 0:n.users.length,e,"internal-error");const a=n.users[0];s._notifyReloadListener(a);const l=(y=a.providerUserInfo)!=null&&y.length?K4(a.providerUserInfo):[],c=p7(s.providerData,l),d=s.isAnonymous,f=!(s.email&&a.passwordHash)&&!(c!=null&&c.length),m=d?f:!1,x={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new rv(a.createdAt,a.lastLoginAt),isAnonymous:m};Object.assign(s,x)}async function g7(s){const e=We(s);await cm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function p7(s,e){return[...s.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function K4(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x7(s,e){const t=await q4(s,{},async()=>{const n=Ud({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=s.config,c=await H4(s,a,"/v1/token",`key=${l}`),d=await s._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:d,body:n};return s.emulatorConfig&&ol(s.emulatorConfig.host)&&(f.credentials="include"),z4.fetch()(c,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function b7(s,e){return Ns(s,"POST","/v2/accounts:revokeToken",js(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){De(e.idToken,"internal-error"),De(typeof e.idToken<"u","internal-error"),De(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):IE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){De(e.length!==0,"internal-error");const t=IE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(De(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:a,expiresIn:l}=await x7(e,t);this.updateTokensAndExpiration(n,a,Number(l))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:a,expirationTime:l}=t,c=new ld;return n&&(De(typeof n=="string","internal-error",{appName:e}),c.refreshToken=n),a&&(De(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),l&&(De(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ld,this.toJSON())}_performRefresh(){return Za("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mo(s,e){De(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class pa{constructor({uid:e,auth:t,stsTokenManager:n,...a}){this.providerId="firebase",this.proactiveRefresh=new m7(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new rv(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await zi(this,this.stsTokenManager.getToken(this.auth,e));return De(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return h7(this,e)}reload(){return g7(this)}_assign(e){this!==e&&(De(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new pa({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){De(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await cm(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(is(this.auth.app))return Promise.reject(cn(this.auth));const e=await this.getIdToken();return await zi(this,u7(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,a=t.email??void 0,l=t.phoneNumber??void 0,c=t.photoURL??void 0,d=t.tenantId??void 0,f=t._redirectEventId??void 0,m=t.createdAt??void 0,x=t.lastLoginAt??void 0,{uid:y,emailVerified:w,isAnonymous:v,providerData:T,stsTokenManager:I}=t;De(y&&I,e,"internal-error");const N=ld.fromJSON(this.name,I);De(typeof y=="string",e,"internal-error"),Mo(n,e.name),Mo(a,e.name),De(typeof w=="boolean",e,"internal-error"),De(typeof v=="boolean",e,"internal-error"),Mo(l,e.name),Mo(c,e.name),Mo(d,e.name),Mo(f,e.name),Mo(m,e.name),Mo(x,e.name);const P=new pa({uid:y,auth:e,email:a,emailVerified:w,displayName:n,isAnonymous:v,photoURL:c,phoneNumber:l,tenantId:d,stsTokenManager:N,createdAt:m,lastLoginAt:x});return T&&Array.isArray(T)&&(P.providerData=T.map(U=>({...U}))),f&&(P._redirectEventId=f),P}static async _fromIdTokenResponse(e,t,n=!1){const a=new ld;a.updateFromServerResponse(t);const l=new pa({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await cm(l),l}static async _fromGetAccountInfoResponse(e,t,n){const a=t.users[0];De(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?K4(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),d=new ld;d.updateFromIdToken(n);const f=new pa({uid:a.localId,auth:e,stsTokenManager:d,isAnonymous:c}),m={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new rv(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(f,m),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AE=new Map;function Ir(s){_a(s instanceof Function,"Expected a class definition");let e=AE.get(s);return e?(_a(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,AE.set(s,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Q4.type="NONE";const Pd=Q4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dc(s,e,t){return`firebase:${s}:${e}:${t}`}class cd{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:a,name:l}=this.auth;this.fullUserKey=dc(this.userKey,a.apiKey,l),this.fullPersistenceKey=dc("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await w0(this.auth,{idToken:e}).catch(()=>{});return t?pa._fromGetAccountInfoResponse(this.auth,t,e):null}return pa._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new cd(Ir(Pd),e,n);const a=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let l=a[0]||Ir(Pd);const c=dc(n,e.config.apiKey,e.name);let d=null;for(const m of t)try{const x=await m._get(c);if(x){let y;if(typeof x=="string"){const w=await w0(e,{idToken:x}).catch(()=>{});if(!w)break;y=await pa._fromGetAccountInfoResponse(e,w,x)}else y=pa._fromJSON(e,x);m!==l&&(d=y),l=m;break}}catch{}const f=a.filter(m=>m._shouldAllowMigration);return!l._shouldAllowMigration||!f.length?new cd(l,e,n):(l=f[0],d&&await l._set(c,d.toJSON()),await Promise.all(t.map(async m=>{if(m!==l)try{await m._remove(c)}catch{}})),new cd(l,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kE(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Z4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Y4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(eC(e))return"Blackberry";if(tC(e))return"Webos";if(J4(e))return"Safari";if((e.includes("chrome/")||X4(e))&&!e.includes("edge/"))return"Chrome";if(Lm(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=s.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function Y4(s=ps()){return/firefox\//i.test(s)}function J4(s=ps()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function X4(s=ps()){return/crios\//i.test(s)}function Z4(s=ps()){return/iemobile/i.test(s)}function Lm(s=ps()){return/android/i.test(s)}function eC(s=ps()){return/blackberry/i.test(s)}function tC(s=ps()){return/webos/i.test(s)}function Vm(s=ps()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function y7(s=ps()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(s)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(s)}function w7(s=ps()){var e;return Vm(s)&&!!((e=window.navigator)!=null&&e.standalone)}function v7(){return nI()&&document.documentMode===10}function sC(s=ps()){return Vm(s)||Lm(s)||tC(s)||eC(s)||/windows phone/i.test(s)||Z4(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nC(s,e=[]){let t;switch(s){case"Browser":t=kE(ps());break;case"Worker":t=`${kE(ps())}-${s}`;break;default:t=s}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Hi}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _7{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=l=>new Promise((c,d)=>{try{const f=e(l);c(f)}catch(f){d(f)}});n.onAbort=t,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j7(s,e={}){return Ns(s,"GET","/v2/passwordPolicy",js(s,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N7=6;class S7{constructor(e){var n;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??N7,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T7{constructor(e,t,n,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new CE(this),this.idTokenSubscription=new CE(this),this.beforeStateQueue=new _7(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=B4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ir(t)),this._initializationPromise=this.queue(async()=>{var n,a,l;if(!this._deleted&&(this.persistenceManager=await cd.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((a=this._popupRedirectResolver)!=null&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await w0(this,{idToken:e}),n=await pa._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(is(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(l=this.redirectUser)==null?void 0:l._redirectEventId,d=n==null?void 0:n._redirectEventId,f=await this.tryRedirectSignIn(e);(!c||c===d)&&(f!=null&&f.user)&&(n=f.user,a=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(n)}catch(c){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return De(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await cm(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=n7()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(is(this.app))return Promise.reject(cn(this));const t=e?We(e):null;return t&&De(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&De(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return is(this.app)?Promise.reject(cn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return is(this.app)?Promise.reject(cn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ir(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await j7(this),t=new S7(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new oi("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await b7(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ir(e)||this._popupRedirectResolver;De(t,this,"argument-error"),this.redirectPersistenceManager=await cd.create(this,[Ir(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let c=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(De(d,this,"internal-error"),d.then(()=>{c||l(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,n,a);return()=>{c=!0,f()}}else{const f=e.addObserver(t);return()=>{c=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return De(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=nC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var a;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((a=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:a.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var t;if(is(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&t7(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function xs(s){return We(s)}class CE{constructor(e){this.auth=e,this.observer=null,this.addObserver=iI(t=>this.observer=t)}get next(){return De(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Um={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function E7(s){Um=s}function yj(s){return Um.loadJS(s)}function I7(){return Um.recaptchaV2Script}function A7(){return Um.recaptchaEnterpriseScript}function k7(){return Um.gapiScript}function rC(s){return`__${s}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C7=500,R7=6e4,wp=1e12;class D7{constructor(e){this.auth=e,this.counter=wp,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new M7(e,this.auth.name,t||{})),this.counter++,n}reset(e){var n;const t=e||wp;(n=this._widgets.get(t))==null||n.delete(),this._widgets.delete(t)}getResponse(e){var n;const t=e||wp;return((n=this._widgets.get(t))==null?void 0:n.getResponse())||""}async execute(e){var n;const t=e||wp;return(n=this._widgets.get(t))==null||n.execute(),""}}class O7{constructor(){this.enterprise=new P7}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class P7{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class M7{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const a=typeof e=="string"?document.getElementById(e):e;De(a,"argument-error",{appName:t}),this.container=a,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=L7(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},R7)},C7))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function L7(s){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<s;n++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const V7="recaptcha-enterprise",Of="NO_RECAPTCHA";class aC{constructor(e){this.type=V7,this.auth=xs(e)}async verify(e="verify",t=!1){async function n(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,d)=>{W4(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const m=new G4(f);return l.tenantId==null?l._agentRecaptchaConfig=m:l._tenantRecaptchaConfigs[l.tenantId]=m,c(m.siteKey)}}).catch(f=>{d(f)})})}function a(l,c,d){const f=window.grecaptcha;EE(f)?f.enterprise.ready(()=>{f.enterprise.execute(l,{action:e}).then(m=>{c(m)}).catch(()=>{c(Of)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new O7().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{n(this.auth).then(d=>{if(!t&&EE(window.grecaptcha))a(d,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let f=A7();f.length!==0&&(f+=d),yj(f).then(()=>{a(d,l,c)}).catch(m=>{c(m)})}}).catch(d=>{c(d)})})}}async function of(s,e,t,n=!1,a=!1){const l=new aC(s);let c;if(a)c=Of;else try{c=await l.verify(t)}catch{c=await l.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const f=d.phoneEnrollmentInfo.phoneNumber,m=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:m,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const f=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return n?Object.assign(d,{captchaResp:c}):Object.assign(d,{captchaResponse:c}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function Ko(s,e,t,n,a){var l,c;if(a==="EMAIL_PASSWORD_PROVIDER")if((l=s._getRecaptchaConfig())!=null&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await of(s,e,t,t==="getOobCode");return n(s,d)}else return n(s,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await of(s,e,t,t==="getOobCode");return n(s,f)}else return Promise.reject(d)});else if(a==="PHONE_PROVIDER")if((c=s._getRecaptchaConfig())!=null&&c.isProviderEnabled("PHONE_PROVIDER")){const d=await of(s,e,t);return n(s,d).catch(async f=>{var m;if(((m=s._getRecaptchaConfig())==null?void 0:m.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(f.code==="auth/missing-recaptcha-token"||f.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const x=await of(s,e,t,!1,!0);return n(s,x)}return Promise.reject(f)})}else{const d=await of(s,e,t,!1,!0);return n(s,d)}else return Promise.reject(a+" provider is not supported.")}async function U7(s){const e=xs(s),t=await W4(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new G4(t);e.tenantId==null?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,n.isAnyProviderEnabled()&&new aC(e).verify()}function F7(s,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(Ir);e!=null&&e.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function $7(s,e,t){const n=xs(s);De(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!!(t!=null&&t.disableWarnings),l=iC(e),{host:c,port:d}=B7(e),f=d===null?"":`:${d}`,m={url:`${l}//${c}${f}/`},x=Object.freeze({host:c,port:d,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!n._canInitEmulator){De(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),De(Yo(m,n.config.emulator)&&Yo(x,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=m,n.emulatorConfig=x,n.settings.appVerificationDisabledForTesting=!0,ol(c)?(Vv(`${l}//${c}${f}`),Uv("Auth",!0)):a||z7()}function iC(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function B7(s){const e=iC(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const l=a[1];return{host:l,port:RE(n.substr(l.length+1))}}else{const[l,c]=n.split(":");return{host:l,port:RE(c)}}}function RE(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function z7(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Za("not implemented")}_getIdTokenResponse(e){return Za("not implemented")}_linkToIdToken(e,t){return Za("not implemented")}_getReauthenticationResolver(e){return Za("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oC(s,e){return Ns(s,"POST","/v1/accounts:resetPassword",js(s,e))}async function q7(s,e){return Ns(s,"POST","/v1/accounts:update",e)}async function H7(s,e){return Ns(s,"POST","/v1/accounts:signUp",e)}async function G7(s,e){return Ns(s,"POST","/v1/accounts:update",js(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W7(s,e){return Yi(s,"POST","/v1/accounts:signInWithPassword",js(s,e))}async function ux(s,e){return Ns(s,"POST","/v1/accounts:sendOobCode",js(s,e))}async function K7(s,e){return ux(s,e)}async function Q7(s,e){return ux(s,e)}async function Y7(s,e){return ux(s,e)}async function J7(s,e){return ux(s,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X7(s,e){return Yi(s,"POST","/v1/accounts:signInWithEmailLink",js(s,e))}async function Z7(s,e){return Yi(s,"POST","/v1/accounts:signInWithEmailLink",js(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um extends Yd{constructor(e,t,n,a=null){super("password",n),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new um(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new um(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ko(e,t,"signInWithPassword",W7,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return X7(e,{email:this._email,oobCode:this._password});default:Tn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ko(e,n,"signUpPassword",H7,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Z7(e,{idToken:t,email:this._email,oobCode:this._password});default:Tn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Li(s,e){return Yi(s,"POST","/v1/accounts:signInWithIdp",js(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eF="http://localhost";class ii extends Yd{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ii(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Tn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a,...l}=t;if(!n||!a)return null;const c=new ii(n,a);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return Li(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Li(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Li(e,t)}buildRequest(){const e={requestUri:eF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ud(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DE(s,e){return Ns(s,"POST","/v1/accounts:sendVerificationCode",js(s,e))}async function tF(s,e){return Yi(s,"POST","/v1/accounts:signInWithPhoneNumber",js(s,e))}async function sF(s,e){const t=await Yi(s,"POST","/v1/accounts:signInWithPhoneNumber",js(s,e));if(t.temporaryProof)throw wf(s,"account-exists-with-different-credential",t);return t}const nF={USER_NOT_FOUND:"user-not-found"};async function rF(s,e){const t={...e,operation:"REAUTH"};return Yi(s,"POST","/v1/accounts:signInWithPhoneNumber",js(s,t),nF)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hc extends Yd{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new hc({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new hc({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return tF(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return sF(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return rF(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:a}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:a}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:a,temporaryProof:l}=e;return!n&&!t&&!a&&!l?null:new hc({verificationId:t,verificationCode:n,phoneNumber:a,temporaryProof:l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aF(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function iF(s){const e=ed(mf(s)).link,t=e?ed(mf(e)).deep_link_id:null,n=ed(mf(s)).deep_link_id;return(n?ed(mf(n)).link:null)||n||t||e||s}class dx{constructor(e){const t=ed(mf(e)),n=t.apiKey??null,a=t.oobCode??null,l=aF(t.mode??null);De(n&&a&&l,"argument-error"),this.apiKey=n,this.operation=l,this.code=a,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=iF(e);try{return new dx(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(){this.providerId=fl.PROVIDER_ID}static credential(e,t){return um._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=dx.parseLink(t);return De(n,"argument-error"),um._fromEmailAndCode(e,n.code,n.tenantId)}}fl.PROVIDER_ID="password";fl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";fl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd extends Ji{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ud extends Jd{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return De("providerId"in t&&"signInMethod"in t,"argument-error"),ii._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return De(e.idToken||e.accessToken,"argument-error"),ii._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return ud.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return ud.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:a,pendingToken:l,nonce:c,providerId:d}=e;if(!n&&!a&&!t&&!l||!d)return null;try{return new ud(d)._credential({idToken:t,accessToken:n,nonce:c,pendingToken:l})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ga extends Jd{constructor(){super("facebook.com")}static credential(e){return ii._fromParams({providerId:Ga.PROVIDER_ID,signInMethod:Ga.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ga.credentialFromTaggedObject(e)}static credentialFromError(e){return Ga.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ga.credential(e.oauthAccessToken)}catch{return null}}}Ga.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ga.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa extends Jd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ii._fromParams({providerId:Wa.PROVIDER_ID,signInMethod:Wa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Wa.credentialFromTaggedObject(e)}static credentialFromError(e){return Wa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Wa.credential(t,n)}catch{return null}}}Wa.GOOGLE_SIGN_IN_METHOD="google.com";Wa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka extends Jd{constructor(){super("github.com")}static credential(e){return ii._fromParams({providerId:Ka.PROVIDER_ID,signInMethod:Ka.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ka.credentialFromTaggedObject(e)}static credentialFromError(e){return Ka.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ka.credential(e.oauthAccessToken)}catch{return null}}}Ka.GITHUB_SIGN_IN_METHOD="github.com";Ka.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF="http://localhost";class Md extends Yd{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return Li(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Li(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Li(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a,pendingToken:l}=t;return!n||!a||!l||n!==a?null:new Md(n,l)}static _create(e,t){return new Md(e,t)}buildRequest(){return{requestUri:oF,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lF="saml.";class v0 extends Ji{constructor(e){De(e.startsWith(lF),"argument-error"),super(e)}static credentialFromResult(e){return v0.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return v0.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Md.fromJSON(e);return De(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:n}=e;if(!t||!n)return null;try{return Md._create(n,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa extends Jd{constructor(){super("twitter.com")}static credential(e,t){return ii._fromParams({providerId:Qa.PROVIDER_ID,signInMethod:Qa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Qa.credentialFromTaggedObject(e)}static credentialFromError(e){return Qa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Qa.credential(t,n)}catch{return null}}}Qa.TWITTER_SIGN_IN_METHOD="twitter.com";Qa.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lC(s,e){return Yi(s,"POST","/v1/accounts:signUp",js(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,a=!1){const l=await pa._fromIdTokenResponse(e,n,a),c=OE(n);return new Zr({user:l,providerId:c,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const a=OE(n);return new Zr({user:e,providerId:a,_tokenResponse:n,operationType:t})}}function OE(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cF(s){var a;if(is(s.app))return Promise.reject(cn(s));const e=xs(s);if(await e._initializationPromise,(a=e.currentUser)!=null&&a.isAnonymous)return new Zr({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await lC(e,{returnSecureToken:!0}),n=await Zr._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(n.user),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0 extends wn{constructor(e,t,n,a){super(t.code,t.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,_0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,a){return new _0(e,t,n,a)}}function cC(s,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?_0._fromErrorAndOperation(s,l,e,n):l})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uC(s){return new Set(s.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uF(s,e){const t=We(s);await hx(!0,t,e);const{providerUserInfo:n}=await d7(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),a=uC(n||[]);return t.providerData=t.providerData.filter(l=>a.has(l.providerId)),a.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function wj(s,e,t=!1){const n=await zi(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Zr._forOperation(s,"link",n)}async function hx(s,e,t){await cm(e);const n=uC(e.providerData),a=s===!1?"provider-already-linked":"no-such-provider";De(n.has(t)===s,e.auth,a)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dC(s,e,t=!1){const{auth:n}=s;if(is(n.app))return Promise.reject(cn(n));const a="reauthenticate";try{const l=await zi(s,cC(n,a,e,s),t);De(l.idToken,n,"internal-error");const c=cx(l.idToken);De(c,n,"internal-error");const{sub:d}=c;return De(s.uid===d,n,"user-mismatch"),Zr._forOperation(s,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&Tn(n,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hC(s,e,t=!1){if(is(s.app))return Promise.reject(cn(s));const n="signIn",a=await cC(s,n,e),l=await Zr._fromIdTokenResponse(s,n,a);return t||await s._updateCurrentUser(l.user),l}async function fx(s,e){return hC(xs(s),e)}async function fC(s,e){const t=We(s);return await hx(!1,t,e.providerId),wj(t,e)}async function mC(s,e){return dC(We(s),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dF(s,e){return Yi(s,"POST","/v1/accounts:signInWithCustomToken",js(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hF(s,e){if(is(s.app))return Promise.reject(cn(s));const t=xs(s),n=await dF(t,{token:e,returnSecureToken:!0}),a=await Zr._fromIdTokenResponse(t,"signIn",n);return await t._updateCurrentUser(a.user),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?vj._fromServerResponse(e,t):"totpInfo"in t?_j._fromServerResponse(e,t):Tn(e,"internal-error")}}class vj extends Fm{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new vj(t)}}class _j extends Fm{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new _j(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mx(s,e,t){var n;De(((n=t.url)==null?void 0:n.length)>0,s,"invalid-continue-uri"),De(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,s,"invalid-dynamic-link-domain"),De(typeof t.linkDomain>"u"||t.linkDomain.length>0,s,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(De(t.iOS.bundleId.length>0,s,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(De(t.android.packageName.length>0,s,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jj(s){const e=xs(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function fF(s,e,t){const n=xs(s),a={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&mx(n,a,t),await Ko(n,a,"getOobCode",Q7,"EMAIL_PASSWORD_PROVIDER")}async function mF(s,e,t){await oC(We(s),{oobCode:e,newPassword:t}).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&jj(s),n})}async function gF(s,e){await G7(We(s),{oobCode:e})}async function gC(s,e){const t=We(s),n=await oC(t,{oobCode:e}),a=n.requestType;switch(De(a,t,"internal-error"),a){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":De(n.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":De(n.mfaInfo,t,"internal-error");default:De(n.email,t,"internal-error")}let l=null;return n.mfaInfo&&(l=Fm._fromServerResponse(xs(t),n.mfaInfo)),{data:{email:(n.requestType==="VERIFY_AND_CHANGE_EMAIL"?n.newEmail:n.email)||null,previousEmail:(n.requestType==="VERIFY_AND_CHANGE_EMAIL"?n.email:n.newEmail)||null,multiFactorInfo:l},operation:a}}async function pF(s,e){const{data:t}=await gC(We(s),e);return t.email}async function xF(s,e,t){if(is(s.app))return Promise.reject(cn(s));const n=xs(s),c=await Ko(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",lC,"EMAIL_PASSWORD_PROVIDER").catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&jj(s),f}),d=await Zr._fromIdTokenResponse(n,"signIn",c);return await n._updateCurrentUser(d.user),d}function bF(s,e,t){return is(s.app)?Promise.reject(cn(s)):fx(We(s),fl.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&jj(s),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yF(s,e,t){const n=xs(s),a={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function l(c,d){De(d.handleCodeInApp,n,"argument-error"),d&&mx(n,c,d)}l(a,t),await Ko(n,a,"getOobCode",Y7,"EMAIL_PASSWORD_PROVIDER")}function wF(s,e){const t=dx.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function vF(s,e,t){if(is(s.app))return Promise.reject(cn(s));const n=We(s),a=fl.credentialWithLink(e,t||lm());return De(a._tenantId===(n.tenantId||null),n,"tenant-id-mismatch"),fx(n,a)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _F(s,e){return Ns(s,"POST","/v1/accounts:createAuthUri",js(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jF(s,e){const t=xj()?lm():"http://localhost",n={identifier:e,continueUri:t},{signinMethods:a}=await _F(We(s),n);return a||[]}async function NF(s,e){const t=We(s),a={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()};e&&mx(t.auth,a,e);const{email:l}=await K7(t.auth,a);l!==s.email&&await s.reload()}async function SF(s,e,t){const n=We(s),l={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await s.getIdToken(),newEmail:e};t&&mx(n.auth,l,t);const{email:c}=await J7(n.auth,l);c!==s.email&&await s.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TF(s,e){return Ns(s,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EF(s,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const n=We(s),l={idToken:await n.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=await zi(n,TF(n.auth,l));n.displayName=c.displayName||null,n.photoURL=c.photoUrl||null;const d=n.providerData.find(({providerId:f})=>f==="password");d&&(d.displayName=n.displayName,d.photoURL=n.photoURL),await n._updateTokensIfNecessary(c)}function IF(s,e){const t=We(s);return is(t.auth.app)?Promise.reject(cn(t.auth)):pC(t,e,null)}function AF(s,e){return pC(We(s),null,e)}async function pC(s,e,t){const{auth:n}=s,l={idToken:await s.getIdToken(),returnSecureToken:!0};e&&(l.email=e),t&&(l.password=t);const c=await zi(s,q7(n,l));await s._updateTokensIfNecessary(c,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kF(s){var a,l;if(!s)return null;const{providerId:e}=s,t=s.rawUserInfo?JSON.parse(s.rawUserInfo):{},n=s.isNewUser||s.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&(s!=null&&s.idToken)){const c=(l=(a=cx(s.idToken))==null?void 0:a.firebase)==null?void 0:l.sign_in_provider;if(c){const d=c!=="anonymous"&&c!=="custom"?c:null;return new dd(n,d)}}if(!e)return null;switch(e){case"facebook.com":return new CF(n,t);case"github.com":return new RF(n,t);case"google.com":return new DF(n,t);case"twitter.com":return new OF(n,t,s.screenName||null);case"custom":case"anonymous":return new dd(n,null);default:return new dd(n,e,t)}}class dd{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class xC extends dd{constructor(e,t,n,a){super(e,t,n),this.username=a}}class CF extends dd{constructor(e,t){super(e,"facebook.com",t)}}class RF extends xC{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class DF extends dd{constructor(e,t){super(e,"google.com",t)}}class OF extends xC{constructor(e,t,n){super(e,"twitter.com",t,n)}}function PF(s){const{user:e,_tokenResponse:t}=s;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:kF(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e,t,n){this.type=e,this.credential=t,this.user=n}static _fromIdtoken(e,t){return new oc("enroll",e,t)}static _fromMfaPendingCredential(e){return new oc("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(e!=null&&e.multiFactorSession){if((t=e.multiFactorSession)!=null&&t.pendingCredential)return oc._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if((n=e.multiFactorSession)!=null&&n.idToken)return oc._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nj{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=xs(e),a=t.customData._serverResponse,l=(a.mfaInfo||[]).map(d=>Fm._fromServerResponse(n,d));De(a.mfaPendingCredential,n,"internal-error");const c=oc._fromMfaPendingCredential(a.mfaPendingCredential);return new Nj(c,l,async d=>{const f=await d._process(n,c);delete a.mfaInfo,delete a.mfaPendingCredential;const m={...a,idToken:f.idToken,refreshToken:f.refreshToken};switch(t.operationType){case"signIn":const x=await Zr._fromIdTokenResponse(n,t.operationType,m);return await n._updateCurrentUser(x.user),x;case"reauthenticate":return De(t.user,n,"internal-error"),Zr._forOperation(t.user,t.operationType,m);default:Tn(n,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function MF(s,e){var a;const t=We(s),n=e;return De(e.customData.operationType,t,"argument-error"),De((a=n.customData._serverResponse)==null?void 0:a.mfaPendingCredential,t,"argument-error"),Nj._fromError(t,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PE(s,e){return Ns(s,"POST","/v2/accounts/mfaEnrollment:start",js(s,e))}function LF(s,e){return Ns(s,"POST","/v2/accounts/mfaEnrollment:finalize",js(s,e))}function VF(s,e){return Ns(s,"POST","/v2/accounts/mfaEnrollment:withdraw",js(s,e))}class Sj{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(n=>Fm._fromServerResponse(e.auth,n)))})}static _fromUser(e){return new Sj(e)}async getSession(){return oc._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const n=e,a=await this.getSession(),l=await zi(this.user,n._process(this.user.auth,a,t));return await this.user._updateTokensIfNecessary(l),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,n=await this.user.getIdToken();try{const a=await zi(this.user,VF(this.user.auth,{idToken:n,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:l})=>l!==t),await this.user._updateTokensIfNecessary(a),await this.user.reload()}catch(a){throw a}}}const Xy=new WeakMap;function UF(s){const e=We(s);return Xy.has(e)||Xy.set(e,Sj._fromUser(e)),Xy.get(e)}const j0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(j0,"1"),this.storage.removeItem(j0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FF=1e3,$F=10;class yC extends bC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=sC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),a=this.localCache[t];n!==a&&e(t,a,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,d,f)=>{this.notifyListeners(c,f)});return}const n=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(n);!t&&this.localCache[n]===c||this.notifyListeners(n,c)},l=this.storage.getItem(n);v7()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,$F):a()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},FF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}yC.type="LOCAL";const Tj=yC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC extends bC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}wC.type="SESSION";const kc=wC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BF(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const n=new gx(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:a,data:l}=t.data,c=this.handlersMap[a];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const d=Array.from(c).map(async m=>m(t.origin,l)),f=await BF(d);t.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}gx.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $m(s="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return s+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,c;return new Promise((d,f)=>{const m=$m("",20);a.port1.start();const x=setTimeout(()=>{f(new Error("unsupported_event"))},n);c={messageChannel:a,onMessage(y){const w=y;if(w.data.eventId===m)switch(w.data.status){case"ack":clearTimeout(x),l=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),d(w.data.response);break;default:clearTimeout(x),clearTimeout(l),f(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zs(){return window}function qF(s){zs().location.href=s}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ej(){return typeof zs().WorkerGlobalScope<"u"&&typeof zs().importScripts=="function"}async function HF(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function GF(){var s;return((s=navigator==null?void 0:navigator.serviceWorker)==null?void 0:s.controller)||null}function WF(){return Ej()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vC="firebaseLocalStorageDb",KF=1,N0="firebaseLocalStorage",_C="fbase_key";class Bm{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function px(s,e){return s.transaction([N0],e?"readwrite":"readonly").objectStore(N0)}function QF(){const s=indexedDB.deleteDatabase(vC);return new Bm(s).toPromise()}function av(){const s=indexedDB.open(vC,KF);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const n=s.result;try{n.createObjectStore(N0,{keyPath:_C})}catch(a){t(a)}}),s.addEventListener("success",async()=>{const n=s.result;n.objectStoreNames.contains(N0)?e(n):(n.close(),await QF(),e(await av()))})})}async function ME(s,e,t){const n=px(s,!0).put({[_C]:e,value:t});return new Bm(n).toPromise()}async function YF(s,e){const t=px(s,!1).get(e),n=await new Bm(t).toPromise();return n===void 0?null:n.value}function LE(s,e){const t=px(s,!0).delete(e);return new Bm(t).toPromise()}const JF=800,XF=3;class jC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await av(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>XF)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ej()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=gx._getInstance(WF()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,n;if(this.activeServiceWorker=await HF(),!this.activeServiceWorker)return;this.sender=new zF(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||GF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await av();return await ME(e,j0,"1"),await LE(e,j0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>ME(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>YF(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>LE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=px(a,!1).getAll();return new Bm(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),JF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}jC.type="LOCAL";const dm=jC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VE(s,e){return Ns(s,"POST","/v2/accounts/mfaSignIn:start",js(s,e))}function ZF(s,e){return Ns(s,"POST","/v2/accounts/mfaSignIn:finalize",js(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zy=rC("rcb"),e$=new Mm(3e4,6e4);class t${constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!((e=zs().grecaptcha)!=null&&e.render)}load(e,t=""){return De(s$(t),e,"argument-error"),this.shouldResolveImmediately(t)&&TE(zs().grecaptcha)?Promise.resolve(zs().grecaptcha):new Promise((n,a)=>{const l=zs().setTimeout(()=>{a(Xs(e,"network-request-failed"))},e$.get());zs()[Zy]=()=>{zs().clearTimeout(l),delete zs()[Zy];const d=zs().grecaptcha;if(!d||!TE(d)){a(Xs(e,"internal-error"));return}const f=d.render;d.render=(m,x)=>{const y=f(m,x);return this.counter++,y},this.hostLanguage=t,n(d)};const c=`${I7()}?${Ud({onload:Zy,render:"explicit",hl:t})}`;yj(c).catch(()=>{clearTimeout(l),a(Xs(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!((t=zs().grecaptcha)!=null&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function s$(s){return s.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(s)}class n${async load(e){return new D7(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pf="recaptcha",r$={theme:"light",type:"image"};let a$=class{constructor(e,t,n={...r$}){this.parameters=n,this.type=Pf,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=xs(e),this.isInvisible=this.parameters.size==="invisible",De(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const a=typeof t=="string"?document.getElementById(t):t;De(a,this.auth,"argument-error"),this.container=a,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new n$:new t$,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise(a=>{const l=c=>{c&&(this.tokenChangeListeners.delete(l),a(c))};this.tokenChangeListeners.add(l),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){De(!this.parameters.sitekey,this.auth,"argument-error"),De(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),De(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(n=>n(t)),typeof e=="function")e(t);else if(typeof e=="string"){const n=zs()[e];typeof n=="function"&&n(t)}}}assertNotDestroyed(){De(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){De(xj()&&!Ej(),this.auth,"internal-error"),await i$(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await c7(this.auth);De(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return De(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function i$(){let s=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}s=()=>e(),window.addEventListener("load",s)}).catch(e=>{throw s&&window.removeEventListener("load",s),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ij{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=hc._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function o$(s,e,t){if(is(s.app))return Promise.reject(cn(s));const n=xs(s),a=await xx(n,e,We(t));return new Ij(a,l=>fx(n,l))}async function l$(s,e,t){const n=We(s);await hx(!1,n,"phone");const a=await xx(n.auth,e,We(t));return new Ij(a,l=>fC(n,l))}async function c$(s,e,t){const n=We(s);if(is(n.auth.app))return Promise.reject(cn(n.auth));const a=await xx(n.auth,e,We(t));return new Ij(a,l=>mC(n,l))}async function xx(s,e,t){var n;if(!s._getRecaptchaConfig())try{await U7(s)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let a;if(typeof e=="string"?a={phoneNumber:e}:a=e,"session"in a){const l=a.session;if("phoneNumber"in a){De(l.type==="enroll",s,"internal-error");const c={idToken:l.credential,phoneEnrollmentInfo:{phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await Ko(s,c,"mfaSmsEnrollment",async(x,y)=>{if(y.phoneEnrollmentInfo.captchaResponse===Of){De((t==null?void 0:t.type)===Pf,x,"argument-error");const w=await ew(x,y,t);return PE(x,w)}return PE(x,y)},"PHONE_PROVIDER").catch(x=>Promise.reject(x))).phoneSessionInfo.sessionInfo}else{De(l.type==="signin",s,"internal-error");const c=((n=a.multiFactorHint)==null?void 0:n.uid)||a.multiFactorUid;De(c,s,"missing-multi-factor-info");const d={mfaPendingCredential:l.credential,mfaEnrollmentId:c,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await Ko(s,d,"mfaSmsSignIn",async(y,w)=>{if(w.phoneSignInInfo.captchaResponse===Of){De((t==null?void 0:t.type)===Pf,y,"argument-error");const v=await ew(y,w,t);return VE(y,v)}return VE(y,w)},"PHONE_PROVIDER").catch(y=>Promise.reject(y))).phoneResponseInfo.sessionInfo}}else{const l={phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await Ko(s,l,"sendVerificationCode",async(m,x)=>{if(x.captchaResponse===Of){De((t==null?void 0:t.type)===Pf,m,"argument-error");const y=await ew(m,x,t);return DE(m,y)}return DE(m,x)},"PHONE_PROVIDER").catch(m=>Promise.reject(m))).sessionInfo}}finally{t==null||t._reset()}}async function u$(s,e){const t=We(s);if(is(t.auth.app))return Promise.reject(cn(t.auth));await wj(t,e)}async function ew(s,e,t){De(t.type===Pf,s,"argument-error");const n=await t.verify();De(typeof n=="string",s,"argument-error");const a={...e};if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.captchaResponse,d=a.phoneEnrollmentInfo.clientType,f=a.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:n,captchaResponse:c,clientType:d,recaptchaVersion:f}}),a}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.captchaResponse,c=a.phoneSignInInfo.clientType,d=a.phoneSignInInfo.recaptchaVersion;return Object.assign(a,{phoneSignInInfo:{recaptchaToken:n,captchaResponse:l,clientType:c,recaptchaVersion:d}}),a}else return Object.assign(a,{recaptchaToken:n}),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cc=class Gp{constructor(e){this.providerId=Gp.PROVIDER_ID,this.auth=xs(e)}verifyPhoneNumber(e,t){return xx(this.auth,e,We(t))}static credential(e,t){return hc._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Gp.credentialFromTaggedObject(t)}static credentialFromError(e){return Gp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?hc._fromTokenResponse(t,n):null}};Cc.PROVIDER_ID="phone";Cc.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fc(s,e){return e?Ir(e):(De(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj extends Yd{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Li(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Li(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Li(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function d$(s){return hC(s.auth,new Aj(s),s.bypassAuthState)}function h$(s){const{auth:e,user:t}=s;return De(t,e,"internal-error"),dC(t,new Aj(s),s.bypassAuthState)}async function f$(s){const{auth:e,user:t}=s;return De(t,e,"internal-error"),wj(t,new Aj(s),s.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e,t,n,a,l=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:a,tenantId:l,error:c,type:d}=e;if(c){this.reject(c);return}const f={auth:this.auth,requestUri:t,sessionId:n,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(f))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return d$;case"linkViaPopup":case"linkViaRedirect":return f$;case"reauthViaPopup":case"reauthViaRedirect":return h$;default:Tn(this.auth,"internal-error")}}resolve(e){_a(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_a(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m$=new Mm(2e3,1e4);async function g$(s,e,t){if(is(s.app))return Promise.reject(Xs(s,"operation-not-supported-in-this-environment"));const n=xs(s);Qd(s,e,Ji);const a=Fc(n,t);return new Di(n,"signInViaPopup",e,a).executeNotNull()}async function p$(s,e,t){const n=We(s);if(is(n.auth.app))return Promise.reject(Xs(n.auth,"operation-not-supported-in-this-environment"));Qd(n.auth,e,Ji);const a=Fc(n.auth,t);return new Di(n.auth,"reauthViaPopup",e,a,n).executeNotNull()}async function x$(s,e,t){const n=We(s);Qd(n.auth,e,Ji);const a=Fc(n.auth,t);return new Di(n.auth,"linkViaPopup",e,a,n).executeNotNull()}class Di extends NC{constructor(e,t,n,a,l){super(e,t,a,l),this.provider=n,this.authWindow=null,this.pollId=null,Di.currentPopupAction&&Di.currentPopupAction.cancel(),Di.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return De(e,this.auth,"internal-error"),e}async onExecution(){_a(this.filter.length===1,"Popup operations only handle one event");const e=$m();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Xs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Xs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Di.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if((n=(t=this.authWindow)==null?void 0:t.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Xs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,m$.get())};e()}}Di.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b$="pendingRedirect",Mf=new Map;class y$ extends NC{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Mf.get(this.auth._key());if(!e){try{const n=await w$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Mf.set(this.auth._key(),e)}return this.bypassAuthState||Mf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function w$(s,e){const t=TC(e),n=SC(s);if(!await n._isAvailable())return!1;const a=await n._get(t)==="true";return await n._remove(t),a}async function kj(s,e){return SC(s)._set(TC(e),"true")}function v$(){Mf.clear()}function Cj(s,e){Mf.set(s._key(),e)}function SC(s){return Ir(s._redirectPersistence)}function TC(s){return dc(b$,s.config.apiKey,s.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _$(s,e,t){return j$(s,e,t)}async function j$(s,e,t){if(is(s.app))return Promise.reject(cn(s));const n=xs(s);Qd(s,e,Ji),await n._initializationPromise;const a=Fc(n,t);return await kj(a,n),a._openRedirect(n,e,"signInViaRedirect")}function N$(s,e,t){return S$(s,e,t)}async function S$(s,e,t){const n=We(s);if(Qd(n.auth,e,Ji),is(n.auth.app))return Promise.reject(cn(n.auth));await n.auth._initializationPromise;const a=Fc(n.auth,t);await kj(a,n.auth);const l=await EC(n);return a._openRedirect(n.auth,e,"reauthViaRedirect",l)}function T$(s,e,t){return E$(s,e,t)}async function E$(s,e,t){const n=We(s);Qd(n.auth,e,Ji),await n.auth._initializationPromise;const a=Fc(n.auth,t);await hx(!1,n,e.providerId),await kj(a,n.auth);const l=await EC(n);return a._openRedirect(n.auth,e,"linkViaRedirect",l)}async function I$(s,e){return await xs(s)._initializationPromise,bx(s,e,!1)}async function bx(s,e,t=!1){if(is(s.app))return Promise.reject(cn(s));const n=xs(s),a=Fc(n,e),c=await new y$(n,a,t).execute();return c&&!t&&(delete c.user._redirectEventId,await n._persistUserIfCurrent(c.user),await n._setRedirectUser(null,e)),c}async function EC(s){const e=$m(`${s.uid}:::`);return s._redirectEventId=e,await s.auth._setRedirectUser(s),await s.auth._persistUserIfCurrent(s),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A$=600*1e3;class IC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!k$(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!AC(e)){const a=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";t.onError(Xs(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=A$&&this.cachedEventUids.clear(),this.cachedEventUids.has(UE(e))}saveEventToCache(e){this.cachedEventUids.add(UE(e)),this.lastProcessedEventTime=Date.now()}}function UE(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function AC({type:s,error:e}){return s==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function k$(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return AC(s);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kC(s,e={}){return Ns(s,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,R$=/^https?/;async function D$(s){if(s.config.emulator)return;const{authorizedDomains:e}=await kC(s);for(const t of e)try{if(O$(t))return}catch{}Tn(s,"unauthorized-domain")}function O$(s){const e=lm(),{protocol:t,hostname:n}=new URL(e);if(s.startsWith("chrome-extension://")){const c=new URL(s);return c.hostname===""&&n===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===n}if(!R$.test(t))return!1;if(C$.test(s))return n===s;const a=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P$=new Mm(3e4,6e4);function FE(){const s=zs().___jsl;if(s!=null&&s.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function M$(s){return new Promise((e,t)=>{var a,l,c;function n(){FE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{FE(),t(Xs(s,"network-request-failed"))},timeout:P$.get()})}if((l=(a=zs().gapi)==null?void 0:a.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((c=zs().gapi)!=null&&c.load)n();else{const d=rC("iframefcb");return zs()[d]=()=>{gapi.load?n():t(Xs(s,"network-request-failed"))},yj(`${k7()}?onload=${d}`).catch(f=>t(f))}}).catch(e=>{throw Wp=null,e})}let Wp=null;function L$(s){return Wp=Wp||M$(s),Wp}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V$=new Mm(5e3,15e3),U$="__/auth/iframe",F$="emulator/auth/iframe",$$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},B$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function z$(s){const e=s.config;De(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?bj(e,F$):`https://${s.config.authDomain}/${U$}`,n={apiKey:e.apiKey,appName:s.name,v:Hi},a=B$.get(s.config.apiHost);a&&(n.eid=a);const l=s._getFrameworks();return l.length&&(n.fw=l.join(",")),`${t}?${Ud(n).slice(1)}`}async function q$(s){const e=await L$(s),t=zs().gapi;return De(t,s,"internal-error"),e.open({where:document.body,url:z$(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$$,dontclear:!0},n=>new Promise(async(a,l)=>{await n.restyle({setHideOnLeave:!1});const c=Xs(s,"network-request-failed"),d=zs().setTimeout(()=>{l(c)},V$.get());function f(){zs().clearTimeout(d),a(n)}n.ping(f).then(f,()=>{l(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},G$=500,W$=600,K$="_blank",Q$="http://localhost";class $E{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Y$(s,e,t,n=G$,a=W$){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-n)/2,0).toString();let d="";const f={...H$,width:n.toString(),height:a.toString(),top:l,left:c},m=ps().toLowerCase();t&&(d=X4(m)?K$:t),Y4(m)&&(e=e||Q$,f.scrollbars="yes");const x=Object.entries(f).reduce((w,[v,T])=>`${w}${v}=${T},`,"");if(w7(m)&&d!=="_self")return J$(e||"",d),new $E(null);const y=window.open(e||"",d,x);De(y,s,"popup-blocked");try{y.focus()}catch{}return new $E(y)}function J$(s,e){const t=document.createElement("a");t.href=s,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X$="__/auth/handler",Z$="emulator/auth/handler",eB=encodeURIComponent("fac");async function iv(s,e,t,n,a,l){De(s.config.authDomain,s,"auth-domain-config-required"),De(s.config.apiKey,s,"invalid-api-key");const c={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:n,v:Hi,eventId:a};if(e instanceof Ji){e.setDefaultLanguage(s.languageCode),c.providerId=e.providerId||"",jO(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,y]of Object.entries(l||{}))c[x]=y}if(e instanceof Jd){const x=e.getScopes().filter(y=>y!=="");x.length>0&&(c.scopes=x.join(","))}s.tenantId&&(c.tid=s.tenantId);const d=c;for(const x of Object.keys(d))d[x]===void 0&&delete d[x];const f=await s._getAppCheckToken(),m=f?`#${eB}=${encodeURIComponent(f)}`:"";return`${tB(s)}?${Ud(d).slice(1)}${m}`}function tB({config:s}){return s.emulator?bj(s,Z$):`https://${s.authDomain}/${X$}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw="webStorageSupport";class sB{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=kc,this._completeRedirectFn=bx,this._overrideRedirectResult=Cj}async _openPopup(e,t,n,a){var c;_a((c=this.eventManagers[e._key()])==null?void 0:c.manager,"_initialize() not called before _openPopup()");const l=await iv(e,t,n,lm(),a);return Y$(e,l,$m())}async _openRedirect(e,t,n,a){await this._originValidation(e);const l=await iv(e,t,n,lm(),a);return qF(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(_a(l,"If manager is not set, promise should be"),l)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await q$(e),n=new IC(e);return t.register("authEvent",a=>(De(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(tw,{type:tw},a=>{var c;const l=(c=a==null?void 0:a[0])==null?void 0:c[tw];l!==void 0&&t(!!l),Tn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=D$(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return sC()||J4()||Vm()}}const nB=sB;class rB{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return Za("unexpected MultiFactorSessionType")}}}class Rj extends rB{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Rj(e)}_finalizeEnroll(e,t,n){return LF(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return ZF(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class CC{constructor(){}static assertion(e){return Rj._fromCredential(e)}}CC.FACTOR_ID="phone";var BE="@firebase/auth",zE="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aB{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){De(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iB(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function oB(s){dr(new un("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:d}=n.options;De(c&&!c.includes(":"),"invalid-api-key",{appName:n.name});const f={apiKey:c,authDomain:d,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:nC(s)},m=new T7(n,a,l,f);return F7(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),dr(new un("auth-internal",e=>{const t=xs(e.getProvider("auth").getImmediate());return(n=>new aB(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),vn(BE,zE,iB(s)),vn(BE,zE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lB=300;dO("authIdTokenMaxAge");function cB(){var s;return((s=document.getElementsByTagName("head"))==null?void 0:s[0])??document}E7({loadJS(s){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",s),n.onload=e,n.onerror=a=>{const l=Xs("internal-error");l.customData=a,t(l)},n.type="text/javascript",n.charset="UTF-8",cB().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});oB("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rc(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uB=2e3;async function dB(s,e,t){const{BuildInfo:n}=Rc();_a(e.sessionId,"AuthEvent did not contain a session ID");const a=await pB(e.sessionId),l={};return Vm()?l.ibi=n.packageName:Lm()?l.apn=n.packageName:Tn(s,"operation-not-supported-in-this-environment"),n.displayName&&(l.appDisplayName=n.displayName),l.sessionId=a,iv(s,t,e.type,void 0,e.eventId??void 0,l)}async function hB(s){const{BuildInfo:e}=Rc(),t={};Vm()?t.iosBundleId=e.packageName:Lm()?t.androidPackageName=e.packageName:Tn(s,"operation-not-supported-in-this-environment"),await kC(s,t)}function fB(s){const{cordova:e}=Rc();return new Promise(t=>{e.plugins.browsertab.isAvailable(n=>{let a=null;n?e.plugins.browsertab.openUrl(s):a=e.InAppBrowser.open(s,y7()?"_blank":"_system","location=yes"),t(a)})})}async function mB(s,e,t){const{cordova:n}=Rc();let a=()=>{};try{await new Promise((l,c)=>{let d=null;function f(){var w;l();const y=(w=n.plugins.browsertab)==null?void 0:w.close;typeof y=="function"&&y(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function m(){d||(d=window.setTimeout(()=>{c(Xs(s,"redirect-cancelled-by-user"))},uB))}function x(){(document==null?void 0:document.visibilityState)==="visible"&&m()}e.addPassiveListener(f),document.addEventListener("resume",m,!1),Lm()&&document.addEventListener("visibilitychange",x,!1),a=()=>{e.removePassiveListener(f),document.removeEventListener("resume",m,!1),document.removeEventListener("visibilitychange",x,!1),d&&window.clearTimeout(d)}})}finally{a()}}function gB(s){var t,n,a,l,c,d,f,m,x,y;const e=Rc();De(typeof((t=e==null?void 0:e.universalLinks)==null?void 0:t.subscribe)=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),De(typeof((n=e==null?void 0:e.BuildInfo)==null?void 0:n.packageName)<"u",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),De(typeof((c=(l=(a=e==null?void 0:e.cordova)==null?void 0:a.plugins)==null?void 0:l.browsertab)==null?void 0:c.openUrl)=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),De(typeof((m=(f=(d=e==null?void 0:e.cordova)==null?void 0:d.plugins)==null?void 0:f.browsertab)==null?void 0:m.isAvailable)=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),De(typeof((y=(x=e==null?void 0:e.cordova)==null?void 0:x.InAppBrowser)==null?void 0:y.open)=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function pB(s){const e=xB(s),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(a=>a.toString(16).padStart(2,"0")).join("")}function xB(s){if(_a(/[0-9a-zA-Z]+/.test(s),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(s);const e=new ArrayBuffer(s.length),t=new Uint8Array(e);for(let n=0;n<s.length;n++)t[n]=s.charCodeAt(n);return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bB=20;class yB extends IC{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function wB(s,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:jB(),postBody:null,tenantId:s.tenantId,error:Xs(s,"no-auth-event")}}function vB(s,e){return ov()._set(lv(s),e)}async function qE(s){const e=await ov()._get(lv(s));return e&&await ov()._remove(lv(s)),e}function _B(s,e){var n,a;const t=SB(e);if(t.includes("/__/auth/callback")){const l=Kp(t),c=l.firebaseError?NB(decodeURIComponent(l.firebaseError)):null,d=(a=(n=c==null?void 0:c.code)==null?void 0:n.split("auth/"))==null?void 0:a[1],f=d?Xs(d):null;return f?{type:s.type,eventId:s.eventId,tenantId:s.tenantId,error:f,urlResponse:null,sessionId:null,postBody:null}:{type:s.type,eventId:s.eventId,tenantId:s.tenantId,sessionId:s.sessionId,urlResponse:t,postBody:null}}return null}function jB(){const s=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<bB;t++){const n=Math.floor(Math.random()*e.length);s.push(e.charAt(n))}return s.join("")}function ov(){return Ir(Tj)}function lv(s){return dc("authEvent",s.config.apiKey,s.name)}function NB(s){try{return JSON.parse(s)}catch{return null}}function SB(s){const e=Kp(s),t=e.link?decodeURIComponent(e.link):void 0,n=Kp(t).link,a=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Kp(a).link||a||n||t||s}function Kp(s){if(!(s!=null&&s.includes("?")))return{};const[e,...t]=s.split("?");return ed(t.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TB=500;class EB{constructor(){this._redirectPersistence=kc,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=bx,this._overrideRedirectResult=Cj}async _initialize(e){const t=e._key();let n=this.eventManagers.get(t);return n||(n=new yB(e),this.eventManagers.set(t,n),this.attachCallbackListeners(e,n)),n}_openPopup(e){Tn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,n,a){gB(e);const l=await this._initialize(e);await l.initialized(),l.resetRedirect(),v$(),await this._originValidation(e);const c=wB(e,n,a);await vB(e,c);const d=await dB(e,c,t),f=await fB(d);return mB(e,l,f)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=hB(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:n,handleOpenURL:a,BuildInfo:l}=Rc(),c=setTimeout(async()=>{await qE(e),t.onEvent(HE())},TB),d=async x=>{clearTimeout(c);const y=await qE(e);let w=null;y&&(x!=null&&x.url)&&(w=_B(y,x.url)),t.onEvent(w||HE())};typeof n<"u"&&typeof n.subscribe=="function"&&n.subscribe(null,d);const f=a,m=`${l.packageName.toLowerCase()}://`;Rc().handleOpenURL=async x=>{if(x.toLowerCase().startsWith(m)&&d({url:x}),typeof f=="function")try{f(x)}catch(y){console.error(y)}}}}const IB=EB;function HE(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Xs("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AB(s,e){xs(s)._logFramework(e)}var kB="@firebase/auth-compat",CB="0.6.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RB=1e3;function Lf(){var s;return((s=self==null?void 0:self.location)==null?void 0:s.protocol)||null}function DB(){return Lf()==="http:"||Lf()==="https:"}function RC(s=ps()){return!!((Lf()==="file:"||Lf()==="ionic:"||Lf()==="capacitor:")&&s.toLowerCase().match(/iphone|ipad|ipod|android/))}function OB(){return Fv()||D0()}function PB(){return nI()&&(document==null?void 0:document.documentMode)===11}function MB(s=ps()){return/Edge\/\d+/.test(s)}function LB(s=ps()){return PB()||MB(s)}function DC(){try{const s=self.localStorage,e=$m();if(s)return s.setItem(e,"1"),s.removeItem(e),LB()?mc():!0}catch{return Dj()&&mc()}return!1}function Dj(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function sw(){return(DB()||sI()||RC())&&!OB()&&DC()&&!Dj()}function OC(){return RC()&&typeof document<"u"}async function VB(){return OC()?new Promise(s=>{const e=setTimeout(()=>{s(!1)},RB);document.addEventListener("deviceready",()=>{clearTimeout(e),s(!0)})}):!1}function UB(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sr={LOCAL:"local",NONE:"none",SESSION:"session"},lf=De,PC="persistence";function FB(s,e){if(lf(Object.values(Sr).includes(e),s,"invalid-persistence-type"),Fv()){lf(e!==Sr.SESSION,s,"unsupported-persistence-type");return}if(D0()){lf(e===Sr.NONE,s,"unsupported-persistence-type");return}if(Dj()){lf(e===Sr.NONE||e===Sr.LOCAL&&mc(),s,"unsupported-persistence-type");return}lf(e===Sr.NONE||DC(),s,"unsupported-persistence-type")}async function cv(s){await s._initializationPromise;const e=MC(),t=dc(PC,s.config.apiKey,s.name);e&&e.setItem(t,s._getPersistenceType())}function $B(s,e){const t=MC();if(!t)return[];const n=dc(PC,s,e);switch(t.getItem(n)){case Sr.NONE:return[Pd];case Sr.LOCAL:return[dm,kc];case Sr.SESSION:return[kc];default:return[]}}function MC(){var s;try{return((s=UB())==null?void 0:s.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BB=De;class zo{constructor(){this.browserResolver=Ir(nB),this.cordovaResolver=Ir(IB),this.underlyingResolver=null,this._redirectPersistence=kc,this._completeRedirectFn=bx,this._overrideRedirectResult=Cj}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,n,a){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,n,a)}async _openRedirect(e,t,n,a){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,n,a)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return OC()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return BB(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await VB();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LC(s){return s.unwrap()}function zB(s){return s.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qB(s){return VC(s)}function HB(s,e){var n;const t=(n=e.customData)==null?void 0:n._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const a=e;a.resolver=new GB(s,MF(s,e))}else if(t){const a=VC(e),l=e;a&&(l.credential=a,l.tenantId=t.tenantId||void 0,l.email=t.email||void 0,l.phoneNumber=t.phoneNumber||void 0)}}function VC(s){const{_tokenResponse:e}=s instanceof wn?s.customData:s;if(!e)return null;if(!(s instanceof wn)&&"temporaryProof"in e&&"phoneNumber"in e)return Cc.credentialFromResult(s);const t=e.providerId;if(!t||t===af.PASSWORD)return null;let n;switch(t){case af.GOOGLE:n=Wa;break;case af.FACEBOOK:n=Ga;break;case af.GITHUB:n=Ka;break;case af.TWITTER:n=Qa;break;default:const{oauthIdToken:a,oauthAccessToken:l,oauthTokenSecret:c,pendingToken:d,nonce:f}=e;return!l&&!c&&!a&&!d?null:d?t.startsWith("saml.")?Md._create(t,d):ii._fromParams({providerId:t,signInMethod:t,pendingToken:d,idToken:a,accessToken:l}):new ud(t).credential({idToken:a,accessToken:l,rawNonce:f})}return s instanceof wn?n.credentialFromError(s):n.credentialFromResult(s)}function rr(s,e){return e.catch(t=>{throw t instanceof wn&&HB(s,t),t}).then(t=>{const n=t.operationType,a=t.user;return{operationType:n,credential:qB(t),additionalUserInfo:PF(t),user:Oi.getOrCreate(a)}})}async function uv(s,e){const t=await e;return{verificationId:t.verificationId,confirm:n=>rr(s,t.confirm(n))}}class GB{constructor(e,t){this.resolver=t,this.auth=zB(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return rr(LC(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(e){this._delegate=e,this.multiFactor=UF(e)}static getOrCreate(e){return Oi.USER_MAP.has(e)||Oi.USER_MAP.set(e,new Oi(e)),Oi.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return rr(this.auth,fC(this._delegate,e))}async linkWithPhoneNumber(e,t){return uv(this.auth,l$(this._delegate,e,t))}async linkWithPopup(e){return rr(this.auth,x$(this._delegate,e,zo))}async linkWithRedirect(e){return await cv(xs(this.auth)),T$(this._delegate,e,zo)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return rr(this.auth,mC(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return uv(this.auth,c$(this._delegate,e,t))}reauthenticateWithPopup(e){return rr(this.auth,p$(this._delegate,e,zo))}async reauthenticateWithRedirect(e){return await cv(xs(this.auth)),N$(this._delegate,e,zo)}sendEmailVerification(e){return NF(this._delegate,e)}async unlink(e){return await uF(this._delegate,e),this}updateEmail(e){return IF(this._delegate,e)}updatePassword(e){return AF(this._delegate,e)}updatePhoneNumber(e){return u$(this._delegate,e)}updateProfile(e){return EF(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return SF(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Oi.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf=De;class dv{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:n}=e.options;cf(n,"invalid-api-key",{appName:e.name}),cf(n,"invalid-api-key",{appName:e.name});const a=typeof window<"u"?zo:void 0;this._delegate=t.initialize({options:{persistence:WB(n,e.name),popupRedirectResolver:a}}),this._delegate._updateErrorMap(ZU),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Oi.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){$7(this._delegate,e,t)}applyActionCode(e){return gF(this._delegate,e)}checkActionCode(e){return gC(this._delegate,e)}confirmPasswordReset(e,t){return mF(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return rr(this._delegate,xF(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return jF(this._delegate,e)}isSignInWithEmailLink(e){return wF(this._delegate,e)}async getRedirectResult(){cf(sw(),this._delegate,"operation-not-supported-in-this-environment");const e=await I$(this._delegate,zo);return e?rr(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){AB(this._delegate,e)}onAuthStateChanged(e,t,n){const{next:a,error:l,complete:c}=GE(e,t,n);return this._delegate.onAuthStateChanged(a,l,c)}onIdTokenChanged(e,t,n){const{next:a,error:l,complete:c}=GE(e,t,n);return this._delegate.onIdTokenChanged(a,l,c)}sendSignInLinkToEmail(e,t){return yF(this._delegate,e,t)}sendPasswordResetEmail(e,t){return fF(this._delegate,e,t||void 0)}async setPersistence(e){FB(this._delegate,e);let t;switch(e){case Sr.SESSION:t=kc;break;case Sr.LOCAL:t=await Ir(dm)._isAvailable()?dm:Tj;break;case Sr.NONE:t=Pd;break;default:return Tn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return rr(this._delegate,cF(this._delegate))}signInWithCredential(e){return rr(this._delegate,fx(this._delegate,e))}signInWithCustomToken(e){return rr(this._delegate,hF(this._delegate,e))}signInWithEmailAndPassword(e,t){return rr(this._delegate,bF(this._delegate,e,t))}signInWithEmailLink(e,t){return rr(this._delegate,vF(this._delegate,e,t))}signInWithPhoneNumber(e,t){return uv(this._delegate,o$(this._delegate,e,t))}async signInWithPopup(e){return cf(sw(),this._delegate,"operation-not-supported-in-this-environment"),rr(this._delegate,g$(this._delegate,e,zo))}async signInWithRedirect(e){return cf(sw(),this._delegate,"operation-not-supported-in-this-environment"),await cv(this._delegate),_$(this._delegate,e,zo)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return pF(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}dv.Persistence=Sr;function GE(s,e,t){let n=s;typeof s!="function"&&({next:n,error:e,complete:t}=s);const a=n;return{next:c=>a(c&&Oi.getOrCreate(c)),error:e,complete:t}}function WB(s,e){const t=$B(s,e);if(typeof self<"u"&&!t.includes(dm)&&t.push(dm),typeof window<"u")for(const n of[Tj,kc])t.includes(n)||t.push(n);return t.includes(Pd)||t.push(Pd),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{static credential(e,t){return Cc.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new Cc(LC(qs.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}Oj.PHONE_SIGN_IN_METHOD=Cc.PHONE_SIGN_IN_METHOD;Oj.PROVIDER_ID=Cc.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KB=De;class QB{constructor(e,t,n=qs.app()){var a;KB((a=n.options)==null?void 0:a.apiKey,"invalid-api-key",{appName:n.name}),this._delegate=new a$(n.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YB="auth-compat";function JB(s){s.INTERNAL.registerComponent(new un(YB,e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new dv(t,n)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Pu.EMAIL_SIGNIN,PASSWORD_RESET:Pu.PASSWORD_RESET,RECOVER_EMAIL:Pu.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Pu.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Pu.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Pu.VERIFY_EMAIL}},EmailAuthProvider:fl,FacebookAuthProvider:Ga,GithubAuthProvider:Ka,GoogleAuthProvider:Wa,OAuthProvider:ud,SAMLAuthProvider:v0,PhoneAuthProvider:Oj,PhoneMultiFactorGenerator:CC,RecaptchaVerifier:QB,TwitterAuthProvider:Qa,Auth:dv,AuthCredential:Yd,Error:wn}).setInstantiationMode("LAZY").setMultipleInstances(!1)),s.registerVersion(kB,CB)}JB(qs);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC="firebasestorage.googleapis.com",FC="storageBucket",XB=120*1e3,ZB=600*1e3,ez=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rs=class $C extends wn{constructor(e,t,n=0){super(nw(e),`Firebase Storage: ${t} (${nw(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,$C.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return nw(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}};var ls;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ls||(ls={}));function nw(s){return"storage/"+s}function Pj(){const s="An unknown error occurred, please check the error payload for server response.";return new Rs(ls.UNKNOWN,s)}function tz(s){return new Rs(ls.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function sz(s){return new Rs(ls.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function nz(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Rs(ls.UNAUTHENTICATED,s)}function rz(){return new Rs(ls.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function az(s){return new Rs(ls.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function BC(){return new Rs(ls.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function zC(){return new Rs(ls.CANCELED,"User canceled the upload/download.")}function iz(s){return new Rs(ls.INVALID_URL,"Invalid URL '"+s+"'.")}function oz(s){return new Rs(ls.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function lz(){return new Rs(ls.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+FC+"' property when initializing the app?")}function qC(){return new Rs(ls.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function cz(){return new Rs(ls.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function uz(){return new Rs(ls.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function dz(s){return new Rs(ls.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function hd(s){return new Rs(ls.INVALID_ARGUMENT,s)}function HC(){return new Rs(ls.APP_DELETED,"The Firebase app was deleted.")}function GC(s){return new Rs(ls.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Vf(s,e){return new Rs(ls.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function uf(s){throw new Rs(ls.INTERNAL_ERROR,"Internal error: "+s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=Dn.makeFromUrl(e,t)}catch{return new Dn(e,"")}if(n.path==="")return n;throw oz(e)}static makeFromUrl(e,t){let n=null;const a="([A-Za-z0-9.\\-_]+)";function l(q){q.path.charAt(q.path.length-1)==="/"&&(q.path_=q.path_.slice(0,-1))}const c="(/(.*))?$",d=new RegExp("^gs://"+a+c,"i"),f={bucket:1,path:3};function m(q){q.path_=decodeURIComponent(q.path)}const x="v[A-Za-z0-9_]+",y=t.replace(/[.]/g,"\\."),w="(/([^?#]*).*)?$",v=new RegExp(`^https?://${y}/${x}/b/${a}/o${w}`,"i"),T={bucket:1,path:3},I=t===UC?"(?:storage.googleapis.com|storage.cloud.google.com)":t,N="([^?#]*)",P=new RegExp(`^https?://${I}/${a}/${N}`,"i"),V=[{regex:d,indices:f,postModify:l},{regex:v,indices:T,postModify:m},{regex:P,indices:{bucket:1,path:2},postModify:m}];for(let q=0;q<V.length;q++){const W=V[q],z=W.regex.exec(e);if(z){const k=z[W.indices.bucket];let M=z[W.indices.path];M||(M=""),n=new Dn(k,M),W.postModify(n);break}}if(n==null)throw iz(e);return n}}class hz{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fz(s,e,t){let n=1,a=null,l=null,c=!1,d=0;function f(){return d===2}let m=!1;function x(...N){m||(m=!0,e.apply(null,N))}function y(N){a=setTimeout(()=>{a=null,s(v,f())},N)}function w(){l&&clearTimeout(l)}function v(N,...P){if(m){w();return}if(N){w(),x.call(null,N,...P);return}if(f()||c){w(),x.call(null,N,...P);return}n<64&&(n*=2);let V;d===1?(d=2,V=0):V=(n+Math.random())*1e3,y(V)}let T=!1;function I(N){T||(T=!0,w(),!m&&(a!==null?(N||(d=2),clearTimeout(a),y(0)):N||(d=1)))}return y(0),l=setTimeout(()=>{c=!0,I(!0)},t),I}function mz(s){s(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gz(s){return s!==void 0}function pz(s){return typeof s=="function"}function xz(s){return typeof s=="object"&&!Array.isArray(s)}function yx(s){return typeof s=="string"||s instanceof String}function WE(s){return Mj()&&s instanceof Blob}function Mj(){return typeof Blob<"u"}function hv(s,e,t,n){if(n<e)throw hd(`Invalid value for '${s}'. Expected ${e} or greater.`);if(n>t)throw hd(`Invalid value for '${s}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ml(s,e,t){let n=e;return t==null&&(n=`https://${e}`),`${t}://${n}/v0${s}`}function WC(s){const e=encodeURIComponent;let t="?";for(const n in s)if(s.hasOwnProperty(n)){const a=e(n)+"="+e(s[n]);t=t+a+"&"}return t=t.slice(0,-1),t}var fc;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(fc||(fc={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KC(s,e){const t=s>=500&&s<600,a=[408,429].indexOf(s)!==-1,l=e.indexOf(s)!==-1;return t||a||l}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bz{constructor(e,t,n,a,l,c,d,f,m,x,y,w=!0,v=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=a,this.successCodes_=l,this.additionalRetryCodes_=c,this.callback_=d,this.errorCallback_=f,this.timeout_=m,this.progressCallback_=x,this.connectionFactory_=y,this.retry=w,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,I)=>{this.resolve_=T,this.reject_=I,this.start_()})}start_(){const e=(n,a)=>{if(a){n(!1,new vp(!1,null,!0));return}const l=this.connectionFactory_();this.pendingConnection_=l;const c=d=>{const f=d.loaded,m=d.lengthComputable?d.total:-1;this.progressCallback_!==null&&this.progressCallback_(f,m)};this.progressCallback_!==null&&l.addUploadProgressListener(c),l.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&l.removeUploadProgressListener(c),this.pendingConnection_=null;const d=l.getErrorCode()===fc.NO_ERROR,f=l.getStatus();if(!d||KC(f,this.additionalRetryCodes_)&&this.retry){const x=l.getErrorCode()===fc.ABORT;n(!1,new vp(!1,null,x));return}const m=this.successCodes_.indexOf(f)!==-1;n(!0,new vp(m,l))})},t=(n,a)=>{const l=this.resolve_,c=this.reject_,d=a.connection;if(a.wasSuccessCode)try{const f=this.callback_(d,d.getResponse());gz(f)?l(f):l()}catch(f){c(f)}else if(d!==null){const f=Pj();f.serverResponse=d.getErrorText(),this.errorCallback_?c(this.errorCallback_(d,f)):c(f)}else if(a.canceled){const f=this.appDelete_?HC():zC();c(f)}else{const f=BC();c(f)}};this.canceled_?t(!1,new vp(!1,null,!0)):this.backoffId_=fz(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&mz(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class vp{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function yz(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function wz(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function vz(s,e){e&&(s["X-Firebase-GMPID"]=e)}function _z(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function jz(s,e,t,n,a,l,c=!0,d=!1){const f=WC(s.urlParams),m=s.url+f,x=Object.assign({},s.headers);return vz(x,e),yz(x,t),wz(x,l),_z(x,n),new bz(m,s.method,x,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,a,c,d)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nz(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Sz(...s){const e=Nz();if(e!==void 0){const t=new e;for(let n=0;n<s.length;n++)t.append(s[n]);return t.getBlob()}else{if(Mj())return new Blob(s);throw new Rs(ls.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Tz(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ez(s){if(typeof atob>"u")throw dz("base-64");return atob(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class rw{constructor(e,t){this.data=e,this.contentType=t||null}}function QC(s,e){switch(s){case Kr.RAW:return new rw(YC(e));case Kr.BASE64:case Kr.BASE64URL:return new rw(JC(s,e));case Kr.DATA_URL:return new rw(Az(e),kz(e))}throw Pj()}function YC(s){const e=[];for(let t=0;t<s.length;t++){let n=s.charCodeAt(t);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const l=n,c=s.charCodeAt(++t);n=65536|(l&1023)<<10|c&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function Iz(s){let e;try{e=decodeURIComponent(s)}catch{throw Vf(Kr.DATA_URL,"Malformed data URL.")}return YC(e)}function JC(s,e){switch(s){case Kr.BASE64:{const a=e.indexOf("-")!==-1,l=e.indexOf("_")!==-1;if(a||l)throw Vf(s,"Invalid character '"+(a?"-":"_")+"' found: is it base64url encoded?");break}case Kr.BASE64URL:{const a=e.indexOf("+")!==-1,l=e.indexOf("/")!==-1;if(a||l)throw Vf(s,"Invalid character '"+(a?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=Ez(e)}catch(a){throw a.message.includes("polyfill")?a:Vf(s,"Invalid character found")}const n=new Uint8Array(t.length);for(let a=0;a<t.length;a++)n[a]=t.charCodeAt(a);return n}class XC{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Vf(Kr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;n!=null&&(this.base64=Cz(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function Az(s){const e=new XC(s);return e.base64?JC(Kr.BASE64,e.rest):Iz(e.rest)}function kz(s){return new XC(s).contentType}function Cz(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e,t){let n=0,a="";WE(e)?(this.data_=e,n=e.size,a=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=a}size(){return this.size_}type(){return this.type_}slice(e,t){if(WE(this.data_)){const n=this.data_,a=Tz(n,e,t);return a===null?null:new ki(a)}else{const n=new Uint8Array(this.data_.buffer,e,t-e);return new ki(n,!0)}}static getBlob(...e){if(Mj()){const t=e.map(n=>n instanceof ki?n.data_:n);return new ki(Sz.apply(null,t))}else{const t=e.map(c=>yx(c)?QC(Kr.RAW,c).data:c.data_);let n=0;t.forEach(c=>{n+=c.byteLength});const a=new Uint8Array(n);let l=0;return t.forEach(c=>{for(let d=0;d<c.length;d++)a[l++]=c[d]}),new ki(a,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lj(s){let e;try{e=JSON.parse(s)}catch{return null}return xz(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rz(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function Dz(s,e){const t=e.split("/").filter(n=>n.length>0).join("/");return s.length===0?t:s+"/"+t}function ZC(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oz(s,e){return e}class Fn{constructor(e,t,n,a){this.server=e,this.local=t||e,this.writable=!!n,this.xform=a||Oz}}let _p=null;function Pz(s){return!yx(s)||s.length<2?s:ZC(s)}function wx(){if(_p)return _p;const s=[];s.push(new Fn("bucket")),s.push(new Fn("generation")),s.push(new Fn("metageneration")),s.push(new Fn("name","fullPath",!0));function e(l,c){return Pz(c)}const t=new Fn("name");t.xform=e,s.push(t);function n(l,c){return c!==void 0?Number(c):c}const a=new Fn("size");return a.xform=n,s.push(a),s.push(new Fn("timeCreated")),s.push(new Fn("updated")),s.push(new Fn("md5Hash",null,!0)),s.push(new Fn("cacheControl",null,!0)),s.push(new Fn("contentDisposition",null,!0)),s.push(new Fn("contentEncoding",null,!0)),s.push(new Fn("contentLanguage",null,!0)),s.push(new Fn("contentType",null,!0)),s.push(new Fn("metadata","customMetadata",!0)),_p=s,_p}function Mz(s,e){function t(){const n=s.bucket,a=s.fullPath,l=new Dn(n,a);return e._makeStorageReference(l)}Object.defineProperty(s,"ref",{get:t})}function Lz(s,e,t){const n={};n.type="file";const a=t.length;for(let l=0;l<a;l++){const c=t[l];n[c.local]=c.xform(n,e[c.server])}return Mz(n,s),n}function eR(s,e,t){const n=Lj(e);return n===null?null:Lz(s,n,t)}function Vz(s,e,t,n){const a=Lj(e);if(a===null||!yx(a.downloadTokens))return null;const l=a.downloadTokens;if(l.length===0)return null;const c=encodeURIComponent;return l.split(",").map(m=>{const x=s.bucket,y=s.fullPath,w="/b/"+c(x)+"/o/"+c(y),v=ml(w,t,n),T=WC({alt:"media",token:m});return v+T})[0]}function Vj(s,e){const t={},n=e.length;for(let a=0;a<n;a++){const l=e[a];l.writable&&(t[l.server]=s[l.local])}return JSON.stringify(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE="prefixes",QE="items";function Uz(s,e,t){const n={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[KE])for(const a of t[KE]){const l=a.replace(/\/$/,""),c=s._makeStorageReference(new Dn(e,l));n.prefixes.push(c)}if(t[QE])for(const a of t[QE]){const l=s._makeStorageReference(new Dn(e,a.name));n.items.push(l)}return n}function Fz(s,e,t){const n=Lj(t);return n===null?null:Uz(s,e,n)}class Xi{constructor(e,t,n,a){this.url=e,this.method=t,this.handler=n,this.timeout=a,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ni(s){if(!s)throw Pj()}function vx(s,e){function t(n,a){const l=eR(s,a,e);return ni(l!==null),l}return t}function $z(s,e){function t(n,a){const l=Fz(s,e,a);return ni(l!==null),l}return t}function Bz(s,e){function t(n,a){const l=eR(s,a,e);return ni(l!==null),Vz(l,a,s.host,s._protocol)}return t}function Xd(s){function e(t,n){let a;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?a=rz():a=nz():t.getStatus()===402?a=sz(s.bucket):t.getStatus()===403?a=az(s.path):a=n,a.status=t.getStatus(),a.serverResponse=n.serverResponse,a}return e}function _x(s){const e=Xd(s);function t(n,a){let l=e(n,a);return n.getStatus()===404&&(l=tz(s.path)),l.serverResponse=a.serverResponse,l}return t}function tR(s,e,t){const n=e.fullServerUrl(),a=ml(n,s.host,s._protocol),l="GET",c=s.maxOperationRetryTime,d=new Xi(a,l,vx(s,t),c);return d.errorHandler=_x(e),d}function zz(s,e,t,n,a){const l={};e.isRoot?l.prefix="":l.prefix=e.path+"/",t.length>0&&(l.delimiter=t),n&&(l.pageToken=n),a&&(l.maxResults=a);const c=e.bucketOnlyServerUrl(),d=ml(c,s.host,s._protocol),f="GET",m=s.maxOperationRetryTime,x=new Xi(d,f,$z(s,e.bucket),m);return x.urlParams=l,x.errorHandler=Xd(e),x}function qz(s,e,t){const n=e.fullServerUrl(),a=ml(n,s.host,s._protocol),l="GET",c=s.maxOperationRetryTime,d=new Xi(a,l,Bz(s,t),c);return d.errorHandler=_x(e),d}function Hz(s,e,t,n){const a=e.fullServerUrl(),l=ml(a,s.host,s._protocol),c="PATCH",d=Vj(t,n),f={"Content-Type":"application/json; charset=utf-8"},m=s.maxOperationRetryTime,x=new Xi(l,c,vx(s,n),m);return x.headers=f,x.body=d,x.errorHandler=_x(e),x}function Gz(s,e){const t=e.fullServerUrl(),n=ml(t,s.host,s._protocol),a="DELETE",l=s.maxOperationRetryTime;function c(f,m){}const d=new Xi(n,a,c,l);return d.successCodes=[200,204],d.errorHandler=_x(e),d}function Wz(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function sR(s,e,t){const n=Object.assign({},t);return n.fullPath=s.path,n.size=e.size(),n.contentType||(n.contentType=Wz(null,e)),n}function Kz(s,e,t,n,a){const l=e.bucketOnlyServerUrl(),c={"X-Goog-Upload-Protocol":"multipart"};function d(){let V="";for(let q=0;q<2;q++)V=V+Math.random().toString().slice(2);return V}const f=d();c["Content-Type"]="multipart/related; boundary="+f;const m=sR(e,n,a),x=Vj(m,t),y="--"+f+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+x+`\r
--`+f+`\r
Content-Type: `+m.contentType+`\r
\r
`,w=`\r
--`+f+"--",v=ki.getBlob(y,n,w);if(v===null)throw qC();const T={name:m.fullPath},I=ml(l,s.host,s._protocol),N="POST",P=s.maxUploadRetryTime,U=new Xi(I,N,vx(s,t),P);return U.urlParams=T,U.headers=c,U.body=v.uploadData(),U.errorHandler=Xd(e),U}class S0{constructor(e,t,n,a){this.current=e,this.total=t,this.finalized=!!n,this.metadata=a||null}}function Uj(s,e){let t=null;try{t=s.getResponseHeader("X-Goog-Upload-Status")}catch{ni(!1)}return ni(!!t&&(e||["active"]).indexOf(t)!==-1),t}function Qz(s,e,t,n,a){const l=e.bucketOnlyServerUrl(),c=sR(e,n,a),d={name:c.fullPath},f=ml(l,s.host,s._protocol),m="POST",x={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.size()}`,"X-Goog-Upload-Header-Content-Type":c.contentType,"Content-Type":"application/json; charset=utf-8"},y=Vj(c,t),w=s.maxUploadRetryTime;function v(I){Uj(I);let N;try{N=I.getResponseHeader("X-Goog-Upload-URL")}catch{ni(!1)}return ni(yx(N)),N}const T=new Xi(f,m,v,w);return T.urlParams=d,T.headers=x,T.body=y,T.errorHandler=Xd(e),T}function Yz(s,e,t,n){const a={"X-Goog-Upload-Command":"query"};function l(m){const x=Uj(m,["active","final"]);let y=null;try{y=m.getResponseHeader("X-Goog-Upload-Size-Received")}catch{ni(!1)}y||ni(!1);const w=Number(y);return ni(!isNaN(w)),new S0(w,n.size(),x==="final")}const c="POST",d=s.maxUploadRetryTime,f=new Xi(t,c,l,d);return f.headers=a,f.errorHandler=Xd(e),f}const YE=256*1024;function Jz(s,e,t,n,a,l,c,d){const f=new S0(0,0);if(c?(f.current=c.current,f.total=c.total):(f.current=0,f.total=n.size()),n.size()!==f.total)throw cz();const m=f.total-f.current;let x=m;a>0&&(x=Math.min(x,a));const y=f.current,w=y+x;let v="";x===0?v="finalize":m===x?v="upload, finalize":v="upload";const T={"X-Goog-Upload-Command":v,"X-Goog-Upload-Offset":`${f.current}`},I=n.slice(y,w);if(I===null)throw qC();function N(q,W){const z=Uj(q,["active","final"]),k=f.current+x,M=n.size();let B;return z==="final"?B=vx(e,l)(q,W):B=null,new S0(k,M,z==="final",B)}const P="POST",U=e.maxUploadRetryTime,V=new Xi(t,P,N,U);return V.headers=T,V.body=I.uploadData(),V.progressCallback=d||null,V.errorHandler=Xd(s),V}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xz={STATE_CHANGED:"state_changed"},zn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function aw(s){switch(s){case"running":case"pausing":case"canceling":return zn.RUNNING;case"paused":return zn.PAUSED;case"success":return zn.SUCCESS;case"canceled":return zn.CANCELED;case"error":return zn.ERROR;default:return zn.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zz{constructor(e,t,n){if(pz(e)||t!=null||n!=null)this.next=e,this.error=t??void 0,this.complete=n??void 0;else{const l=e;this.next=l.next,this.error=l.error,this.complete=l.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mu(s){return(...e)=>{Promise.resolve().then(()=>s(...e))}}class eq{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=fc.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=fc.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=fc.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,a,l){if(this.sent_)throw uf("cannot .send() more than once");if(ol(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),l!==void 0)for(const c in l)l.hasOwnProperty(c)&&this.xhr_.setRequestHeader(c,l[c].toString());return a!==void 0?this.xhr_.send(a):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw uf("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw uf("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw uf("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw uf("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class tq extends eq{initXhr(){this.xhr_.responseType="text"}}function Ya(){return new tq}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,t,n=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=wx(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=a=>{if(this._request=void 0,this._chunkMultiplier=1,a._codeEquals(ls.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const l=this.isExponentialBackoffExpired();if(KC(a.status,[]))if(l)a=BC();else{this.sleepTime=Math.max(this.sleepTime*2,ez),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=a,this._transition("error")}},this._metadataErrorHandler=a=>{this._request=void 0,a._codeEquals(ls.CANCELED)?this.completeTransitions_():(this._error=a,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((a,l)=>{this._resolve=a,this._reject=l,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,n])=>{switch(this._state){case"running":e(t,n);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{const n=Qz(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),a=this._ref.storage._makeRequest(n,Ya,e,t);this._request=a,a.getPromise().then(l=>{this._request=void 0,this._uploadUrl=l,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,n)=>{const a=Yz(this._ref.storage,this._ref._location,e,this._blob),l=this._ref.storage._makeRequest(a,Ya,t,n);this._request=l,l.getPromise().then(c=>{c=c,this._request=void 0,this._updateProgress(c.current),this._needToFetchStatus=!1,c.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=YE*this._chunkMultiplier,t=new S0(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken((a,l)=>{let c;try{c=Jz(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(f){this._error=f,this._transition("error");return}const d=this._ref.storage._makeRequest(c,Ya,a,l,!1);this._request=d,d.getPromise().then(f=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(f.current),f.finalized?(this._metadata=f.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){YE*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const n=tR(this._ref.storage,this._ref._location,this._mappings),a=this._ref.storage._makeRequest(n,Ya,e,t);this._request=a,a.getPromise().then(l=>{this._request=void 0,this._metadata=l,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const n=Kz(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),a=this._ref.storage._makeRequest(n,Ya,e,t);this._request=a,a.getPromise().then(l=>{this._request=void 0,this._metadata=l,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=zC(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=aw(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,a){const l=new Zz(t||void 0,n||void 0,a||void 0);return this._addObserver(l),()=>{this._removeObserver(l)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(aw(this._state)){case zn.SUCCESS:Mu(this._resolve.bind(null,this.snapshot))();break;case zn.CANCELED:case zn.ERROR:const t=this._reject;Mu(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(aw(this._state)){case zn.RUNNING:case zn.PAUSED:e.next&&Mu(e.next.bind(e,this.snapshot))();break;case zn.SUCCESS:e.complete&&Mu(e.complete.bind(e))();break;case zn.CANCELED:case zn.ERROR:e.error&&Mu(e.error.bind(e,this._error))();break;default:e.error&&Mu(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e,t){this._service=e,t instanceof Dn?this._location=t:this._location=Dn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Dc(e,t)}get root(){const e=new Dn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return ZC(this._location.path)}get storage(){return this._service}get parent(){const e=Rz(this._location.path);if(e===null)return null;const t=new Dn(this._location.bucket,e);return new Dc(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw GC(e)}}function sq(s,e,t){return s._throwIfRoot("uploadBytesResumable"),new nR(s,new ki(e),t)}function nq(s){const e={prefixes:[],items:[]};return rR(s,e).then(()=>e)}async function rR(s,e,t){const a=await aR(s,{pageToken:t});e.prefixes.push(...a.prefixes),e.items.push(...a.items),a.nextPageToken!=null&&await rR(s,e,a.nextPageToken)}function aR(s,e){e!=null&&typeof e.maxResults=="number"&&hv("options.maxResults",1,1e3,e.maxResults);const t=e||{},n=zz(s.storage,s._location,"/",t.pageToken,t.maxResults);return s.storage.makeRequestWithTokens(n,Ya)}function rq(s){s._throwIfRoot("getMetadata");const e=tR(s.storage,s._location,wx());return s.storage.makeRequestWithTokens(e,Ya)}function aq(s,e){s._throwIfRoot("updateMetadata");const t=Hz(s.storage,s._location,e,wx());return s.storage.makeRequestWithTokens(t,Ya)}function iq(s){s._throwIfRoot("getDownloadURL");const e=qz(s.storage,s._location,wx());return s.storage.makeRequestWithTokens(e,Ya).then(t=>{if(t===null)throw uz();return t})}function oq(s){s._throwIfRoot("deleteObject");const e=Gz(s.storage,s._location);return s.storage.makeRequestWithTokens(e,Ya)}function iR(s,e){const t=Dz(s._location.path,e),n=new Dn(s._location.bucket,t);return new Dc(s.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lq(s){return/^[A-Za-z]+:\/\//.test(s)}function cq(s,e){return new Dc(s,e)}function oR(s,e){if(s instanceof Fj){const t=s;if(t._bucket==null)throw lz();const n=new Dc(t,t._bucket);return e!=null?oR(n,e):n}else return e!==void 0?iR(s,e):s}function uq(s,e){if(e&&lq(e)){if(s instanceof Fj)return cq(s,e);throw hd("To use ref(service, url), the first argument must be a Storage instance.")}else return oR(s,e)}function JE(s,e){const t=e==null?void 0:e[FC];return t==null?null:Dn.makeFromBucketSpec(t,s)}function dq(s,e,t,n={}){s.host=`${e}:${t}`;const a=ol(e);a&&(Vv(`https://${s.host}/b`),Uv("Storage",!0)),s._isUsingEmulator=!0,s._protocol=a?"https":"http";const{mockUserToken:l}=n;l&&(s._overrideAuthToken=typeof l=="string"?l:eI(l,s.app.options.projectId))}class Fj{constructor(e,t,n,a,l,c=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=a,this._firebaseVersion=l,this._isUsingEmulator=c,this._bucket=null,this._host=UC,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=XB,this._maxUploadRetryTime=ZB,this._requests=new Set,a!=null?this._bucket=Dn.makeFromBucketSpec(a,this._host):this._bucket=JE(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Dn.makeFromBucketSpec(this._url,e):this._bucket=JE(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){hv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){hv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(is(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Dc(this,e)}_makeRequest(e,t,n,a,l=!0){if(this._deleted)return new hz(HC());{const c=jz(e,this._appId,n,a,t,this._firebaseVersion,l,this._isUsingEmulator);return this._requests.add(c),c.getPromise().then(()=>this._requests.delete(c),()=>this._requests.delete(c)),c}}async makeRequestWithTokens(e,t){const[n,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,a).getPromise()}}const XE="@firebase/storage",ZE="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hq="storage";function fq(s,e,t){return s=We(s),sq(s,e,t)}function mq(s){return s=We(s),rq(s)}function gq(s,e){return s=We(s),aq(s,e)}function pq(s,e){return s=We(s),aR(s,e)}function xq(s){return s=We(s),nq(s)}function bq(s){return s=We(s),iq(s)}function yq(s){return s=We(s),oq(s)}function e5(s,e){return s=We(s),uq(s,e)}function wq(s,e){return iR(s,e)}function vq(s,e,t,n={}){dq(s,e,t,n)}function _q(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),n=s.getProvider("auth-internal"),a=s.getProvider("app-check-internal");return new Fj(t,n,a,e,Hi)}function jq(){dr(new un(hq,_q,"PUBLIC").setMultipleInstances(!0)),vn(XE,ZE,""),vn(XE,ZE,"esm2020")}jq();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e,t,n){this._delegate=e,this.task=t,this.ref=n}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t5{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new jp(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(n=>{if(e)return e(new jp(n,this,this._ref))},t)}on(e,t,n,a){let l;return t&&(typeof t=="function"?l=c=>t(new jp(c,this,this._ref)):l={next:t.next?c=>t.next(new jp(c,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,l,n||void 0,a||void 0)}}class s5{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Vi(e,this._service))}get items(){return this._delegate.items.map(e=>new Vi(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=wq(this._delegate,e);return new Vi(t,this.storage)}get root(){return new Vi(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return e==null?null:new Vi(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new t5(fq(this._delegate,e,t),this)}putString(e,t=Kr.RAW,n){this._throwIfRoot("putString");const a=QC(t,e),l={...n};return l.contentType==null&&a.contentType!=null&&(l.contentType=a.contentType),new t5(new nR(this._delegate,new ki(a.data,!0),l),this)}listAll(){return xq(this._delegate).then(e=>new s5(e,this.storage))}list(e){return pq(this._delegate,e||void 0).then(t=>new s5(t,this.storage))}getMetadata(){return mq(this._delegate)}updateMetadata(e){return gq(this._delegate,e)}getDownloadURL(){return bq(this._delegate)}delete(){return this._throwIfRoot("delete"),yq(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw GC(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lR{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(n5(e))throw hd("ref() expected a child path but got a URL, use refFromURL instead.");return new Vi(e5(this._delegate,e),this)}refFromURL(e){if(!n5(e))throw hd("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Dn.makeFromUrl(e,this._delegate.host)}catch{throw hd("refFromUrl() expected a valid full URL but got an invalid one.")}return new Vi(e5(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,n={}){vq(this._delegate,e,t,n)}}function n5(s){return/^[A-Za-z]+:\/\//.test(s)}const Nq="@firebase/storage-compat",Sq="0.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tq="storage-compat";function Eq(s,{instanceIdentifier:e}){const t=s.getProvider("app-compat").getImmediate(),n=s.getProvider("storage").getImmediate({identifier:e});return new lR(t,n)}function Iq(s){const e={TaskState:zn,TaskEvent:Xz,StringFormat:Kr,Storage:lR,Reference:Vi};s.INTERNAL.registerComponent(new un(Tq,Eq,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),s.registerVersion(Nq,Sq)}Iq(qs);const vf={project_id:"goo-now-1ce44",private_key_id:"56b453f3324317c51dbfacd19f32bb364f9b5a84",private_key:`-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC8LfXvjw05i6QA
eGMpaExBT38HlBOar3Ykux8w38ZlYL/1+X/HCe0n/QS2Sb7NVKBUGVFxWTjlX5aG
cGQeRYeSX9dJnohRE9IPbmu7I6YWX13mys6RSijKPQAxM7x9a9acVjbIaQyAP7V7
dwjnl4+ICb+QVMpkz4F87P2s9algCOYt5NY+1YNujoGzAfiiDl598Ib3hlnwwWiA
a52aDY51baXEa3LrrmYKDqxJDe59nAdVWZJS79h09m34lLHgVtPBWzhUnQ70dRhl
1ESI47dL2tEHb9wwgSMAB7iZv0Z59SwRHFr6+dsolzfcgZKWcwu2Gnno/NoV+CNT
Hvtis6K1AgMBAAECggEAAtcaFQK5OzWe2jz27jCQpL8Llp8xs+N9v9ctL4J+eZg+
EtCFu7OBfK7by9k4GTGeS+FSnTMwtybmsY0aYxSUk8KA5YUQNKe9GMDcvRHa12VF
bbmA6FN7YyC26Ic0i0YTPVUrICzpuePRnD/zMUpUfxlP5rXzlMBHCY4q1ASkiPpY
GIxWuV9ilT0lzbri2+a7CjJMRPLpffFJyt7fGcXqin0Fg8xGsXnsCeC1iEwXksDW
wqKGSqV7rShBfJxWvO1hn6cqUFuNlLTSmxeKE8w0RylIQNfQjJ1LMrv5fyo4SYUK
EFiUMFDhta6LLQ5j93XaYl4Ri2TwpmLGgm/DqNCpkQKBgQDtBuAYEQ2Uhv7W4wUA
+jnvbuZPDHFcLEFqUrXpu/vUoqTKRy7wG5vnD9NNr5gxPo9+wHKUevp67XftUmUv
pt9noy2bj+E4pIT22EUcTfLLXR4w31lZfszzWZoIzi9DT9ZEziv3T5/zm7ziW8HS
g4knJIK3dJ9BUzPFEegWk6YivQKBgQDLPhyysZHw5lY+tRELd0frLIraTAALIjNe
irUQIv4w8OA8Mvh9s2bGobM4CTscT3ZsghvDcGi1UEzceQa+Pb++qtl3c6IaI1G/
qTawUSAXMAaqY9qgFjQVatvgljFjjNAegKt+0+wJIpdtSXorV+52Te2IXNySVfWc
cTHdirA7WQKBgFdXz0BPGGgBDut0oKVpj+vRPAEpHqTOkhRyAiLtaLFEdeEsNfm4
0sxkooLgD/8lhI86r35TivW9iBHl6O+UWILCOM44SNAsn+qua1kwyCV0XOm5hB1c
gn2yKPbRs8zkIJseNkleCB0m6IWpNlUyr1nDNIAR85WI6WzXWmTnZ7MpAoGABbAF
SZLijKVFgJe8lF+QKaqjcBx0W9tnKJwlGQCBsIjtHYInpgzhMWnRBB5uAwrOO5cg
g8WfiINowzq3z5cWyJUrZMZdoPGgFgb8Os7qYPu9FAObWKOGbZsB8DUDyM9l+5SK
OBBiKJdJOYu22YOqbrEblpdSrN2u8+PPC24YJHECgYEAmLxOkqzcDiPHaoWBygRt
MMIctJTkgQfTzvLK0zWwBQIEd0hEe7J59g4gIepFQGFmX40hsVJKcgmk45EVfGSE
L2g2suJ5GV838jB0tioO0QQLo6RdDCfZ6Se6+Bp0AusZ4pg4Fe2q6dp/xVJQgcb/
G1UYnMbznK6Kq3HHG6lYCLU=
-----END PRIVATE KEY-----
`,client_email:"firebase-adminsdk-fbsvc@goo-now-1ce44.iam.gserviceaccount.com",token_uri:"https://oauth2.googleapis.com/token"};function fv(s){return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function Aq(s){const e=new Uint8Array(s);let t="";for(let n=0;n<e.byteLength;n++)t+=String.fromCharCode(e[n]);return fv(t)}function kq(s){const e=window.atob(s),t=e.length,n=new Uint8Array(t);for(let a=0;a<t;a++)n[a]=e.charCodeAt(a);return n.buffer}let Np=null,r5=0;const cR=async()=>{if(Np&&Date.now()<r5)return Np;try{const s={alg:"RS256",typ:"JWT"},e=Math.floor(Date.now()/1e3),t={iss:vf.client_email,scope:"https://www.googleapis.com/auth/firebase.messaging",aud:vf.token_uri,exp:e+3600,iat:e},n=fv(JSON.stringify(s)),a=fv(JSON.stringify(t)),l=`${n}.${a}`,c=vf.private_key.replace(/-----BEGIN PRIVATE KEY-----/,"").replace(/-----END PRIVATE KEY-----/,"").replace(/\s/g,""),d=kq(c),f=await window.crypto.subtle.importKey("pkcs8",d,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),m=await window.crypto.subtle.sign("RSASSA-PKCS1-v1_5",f,new TextEncoder().encode(l)),x=`${l}.${Aq(m)}`,w=await(await fetch(vf.token_uri,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer&assertion=${x}`})).json();return w.access_token?(Np=w.access_token,r5=Date.now()+w.expires_in*1e3-6e4,console.log("FCM V1 Token Generated successfully"),Np):(console.error("Failed to generate FCM Token",w),null)}catch(s){return console.error("Error generating FCM V1 Token:",s),null}};let gs,a5=!1;const Oc=(s,e=new WeakSet)=>{if(s==null)return null;if(typeof s!="object")return s;if(s instanceof Date)return s.toISOString();if(typeof s.toDate=="function")try{return s.toDate().toISOString()}catch{return null}if(Object.prototype.hasOwnProperty.call(s,"seconds")&&Object.prototype.hasOwnProperty.call(s,"nanoseconds"))return new Date(s.seconds*1e3).toISOString();if(e.has(s))return null;if(e.add(s),Array.isArray(s))return s.map(n=>Oc(n,e)).filter(n=>n!==void 0);const t={};for(const n in s)if(Object.prototype.hasOwnProperty.call(s,n)){const a=s[n];if(n.startsWith("_")||typeof a=="function")continue;const l=Oc(a,e);l!==void 0&&(t[n]=l)}return t},uR=s=>{if(!qs.apps.length)try{if(gs=qs.initializeApp(s).firestore(),!a5){try{gs.settings({ignoreUndefinedProperties:!0,merge:!0,cacheSizeBytes:qs.firestore.CACHE_SIZE_UNLIMITED})}catch(t){console.warn("Firestore settings error (might be already applied):",t)}gs.enablePersistence({synchronizeTabs:!0}).catch(t=>{t.code==="failed-precondition"?console.warn("Persistence failed: Multiple tabs open"):t.code==="unimplemented"&&console.warn("Persistence not supported by browser")}),a5=!0}return!0}catch(e){return console.error("Firebase Init Error:",e),!1}return gs||(gs=qs.firestore()),!0},Cq=async()=>{if(!gs)return{success:!1,error:"Firebase not initialized"};try{const s=new Promise((e,t)=>setTimeout(()=>t(new Error("Connection timeout")),5e3));return await Promise.race([gs.collection("users").limit(1).get(),s]),{success:!0}}catch(s){return{success:!1,error:s.message}}},qn=(s,e)=>{if(!gs)return()=>{};const t=new Map;let n=!1;return gs.collection(s).onSnapshot({includeMetadataChanges:!0},a=>{let l=!1;if(a.docChanges().forEach(c=>{if(l=!0,c.type==="removed")t.delete(c.doc.id);else{const d=c.doc.data(),f=Oc(d);t.set(c.doc.id,{id:c.doc.id,...f})}}),l||!n){n=!0;const c=Array.from(t.values());e(c)}},a=>console.error(`Subscription error [${s}]:`,a))},Lo=async(s,e)=>{if(!gs||e.length===0)return;const t=400,n=Oc(e);for(let a=0;a<n.length;a+=t){const l=n.slice(a,a+t),c=gs.batch();l.forEach(d=>{if(!d.id)return;const f=gs.collection(s).doc(String(d.id));c.set(f,{...d,serverUpdatedAt:qs.firestore.FieldValue.serverTimestamp()},{merge:!0})}),await c.commit()}},Rq=async(s,e)=>{if(!gs)throw new Error("Firebase not initialized");if(!(!e||e.length===0))try{await Lo(s,e)}catch(t){throw new Error(`Migration failed for ${s}: ${t.message}`)}},ut=async(s,e,t)=>{if(!gs)return;const n=Oc(t);return await gs.collection(s).doc(e).set({...n,serverUpdatedAt:qs.firestore.FieldValue.serverTimestamp()},{merge:!0})},kn=async(s,e)=>{if(!(!gs||!e))return await gs.collection(s).doc(String(e)).delete()},iw=700*1024,Dq=async(s,e="files",t)=>{if(!gs)throw new Error("Firebase DB not initialized");return new Promise((n,a)=>{const l=new FileReader;l.onload=async c=>{var d;try{const f=((d=c.target)==null?void 0:d.result).split(",")[1],m=Math.ceil(f.length/iw),x=`FILE-${Date.now()}`;await gs.collection("stored_files").doc(x).set({name:s.name,size:s.size,type:s.type,totalChunks:m,createdAt:qs.firestore.FieldValue.serverTimestamp(),isChunked:!0});for(let y=0;y<m;y++){const w=f.slice(y*iw,(y+1)*iw);await gs.collection("stored_files").doc(x).collection("chunks").doc(y.toString()).set({data:w,index:y});const v=Math.round((y+1)/m*100);t&&t(v),console.log(`[Firestore Upload] Chunk ${y+1}/${m} uploaded.`)}n(`FIRESTORE_FILE:${x}`)}catch(f){console.error("Firestore chunk upload failed:",f),a(f)}},l.onerror=c=>a(c),l.readAsDataURL(s)})},Oq=async s=>{if(!gs)throw new Error("Firebase DB not initialized");const e=await gs.collection("stored_files").doc(s).get();if(!e.exists)throw new Error("File not found");const t=e.data();if(!t)throw new Error("File metadata missing");const n=await gs.collection("stored_files").doc(s).collection("chunks").orderBy("index").get();let a="";n.forEach(m=>{a+=m.data().data});const l=atob(a),c=new Array(l.length);for(let m=0;m<l.length;m++)c[m]=l.charCodeAt(m);const d=new Uint8Array(c),f=new Blob([d],{type:t.type||"application/vnd.android.package-archive"});return URL.createObjectURL(f)},Pq=async(s,e="updates",t)=>{if(!qs.apps.length)throw new Error("Firebase not initialized");const n=qs.app();if(n.options.storageBucket)try{console.log(`[Upload] Attempting Storage upload to ${n.options.storageBucket}...`);const c=qs.storage().ref().child(`${e}/${Date.now()}_${s.name}`),d={contentType:s.type||"application/vnd.android.package-archive"},f=c.put(s,d);return await new Promise((m,x)=>{f.on("state_changed",y=>{const w=y.bytesTransferred/y.totalBytes*100;t&&t(w)},y=>{console.warn("[Storage Upload Failed] Switching to Firestore fallback...",y),x(y)},()=>{f.snapshot.ref.getDownloadURL().then(m).catch(x)})})}catch{console.log("Storage failed, trying Firestore Chunking...")}else console.log("No storage bucket defined. Using Firestore Chunking...");return await Dq(s,e,t)},Jt=async(s,e)=>{try{const t=s.toLowerCase();let n=t;t==="customer"&&(n="user");let a="";e.targetId&&e.targetId!=="all"&&e.targetId!=="multiple"?a=`${n}_${e.targetId}_v2`:n==="admin"?a="admin_v2":a=`${n}s_v2`,console.log(`[Notification] Preparing to send to topic: ${a}`);const l=await cR();if(!l)return console.error("[Notification] Failed to generate access token"),!1;console.log("[Notification] Access Token generated successfully.");const c=vf.project_id,d={message:{topic:a,notification:{title:e.title,body:e.body},data:{click_action:"FLUTTER_NOTIFICATION_CLICK",type:"order_update",url:e.url||"/",title:e.title,body:e.body,target_id:e.targetId||"",timestamp:new Date().toISOString(),sound:"default"},android:{priority:"HIGH",ttl:"2419200s",notification:{channel_id:"high_importance_channel",sound:"default",default_sound:!0,default_vibrate_timings:!0,notification_priority:"PRIORITY_HIGH",visibility:"PUBLIC"}},apns:{headers:{"apns-priority":"10"},payload:{aps:{sound:"default",badge:1,"content-available":1}}}}},f=await fetch(`https://fcm.googleapis.com/v1/projects/${c}/messages:send`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify(d)});if(f.ok)return console.log(`[Notification] Sent successfully to ${a}`),!0;{const m=await f.text();return console.error(`[Notification] FCM Error: ${m}`),!1}}catch(t){return console.error("[Notification] Failed to send:",t),!1}},i5=async s=>{try{if(!qs.messaging.isSupported())return;const t=await qs.messaging().getToken({vapidKey:"YOUR_VAPID_KEY_IF_NEEDED"});if(!t){console.warn("[WebNotification] No FCM token available.");return}const n=await cR();if(!n)return;const a=await fetch(`https://iid.googleapis.com/iid/v1/${t}/rel/topics/${s}`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});a.ok?console.log(`[WebNotification] Subscribed content-available to ${s}`):console.error(`[WebNotification] Failed to subscribe to ${s}:`,await a.text())}catch(e){console.error("[WebNotification] Subscription Error:",e)}};function jx(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(s);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(s,n[a])&&(t[n[a]]=s[n[a]]);return t}function Mq(s,e,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(x){try{m(n.next(x))}catch(y){c(y)}}function f(x){try{m(n.throw(x))}catch(y){c(y)}}function m(x){x.done?l(x.value):a(x.value).then(d,f)}m((n=n.apply(s,e||[])).next())})}const Lq=s=>s?(...e)=>s(...e):(...e)=>fetch(...e);class $j extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class Vq extends $j{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class o5 extends $j{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class l5 extends $j{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var mv;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(mv||(mv={}));class Uq{constructor(e,{headers:t={},customFetch:n,region:a=mv.Any}={}){this.url=e,this.headers=t,this.region=a,this.fetch=Lq(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Mq(this,arguments,void 0,function*(t,n={}){var a;let l,c;try{const{headers:d,method:f,body:m,signal:x,timeout:y}=n;let w={},{region:v}=n;v||(v=this.region);const T=new URL(`${this.url}/${t}`);v&&v!=="any"&&(w["x-region"]=v,T.searchParams.set("forceFunctionRegion",v));let I;m&&(d&&!Object.prototype.hasOwnProperty.call(d,"Content-Type")||!d)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(w["Content-Type"]="application/octet-stream",I=m):typeof m=="string"?(w["Content-Type"]="text/plain",I=m):typeof FormData<"u"&&m instanceof FormData?I=m:(w["Content-Type"]="application/json",I=JSON.stringify(m)):m&&typeof m!="string"&&!(typeof Blob<"u"&&m instanceof Blob)&&!(m instanceof ArrayBuffer)&&!(typeof FormData<"u"&&m instanceof FormData)?I=JSON.stringify(m):I=m;let N=x;y&&(c=new AbortController,l=setTimeout(()=>c.abort(),y),x?(N=c.signal,x.addEventListener("abort",()=>c.abort())):N=c.signal);const P=yield this.fetch(T.toString(),{method:f||"POST",headers:Object.assign(Object.assign(Object.assign({},w),this.headers),d),body:I,signal:N}).catch(W=>{throw new Vq(W)}),U=P.headers.get("x-relay-error");if(U&&U==="true")throw new o5(P);if(!P.ok)throw new l5(P);let V=((a=P.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),q;return V==="application/json"?q=yield P.json():V==="application/octet-stream"||V==="application/pdf"?q=yield P.blob():V==="text/event-stream"?q=P:V==="multipart/form-data"?q=yield P.formData():q=yield P.text(),{data:q,error:null,response:P}}catch(d){return{data:null,error:d,response:d instanceof l5||d instanceof o5?d.context:void 0}}finally{l&&clearTimeout(l)}})}}var Fq=class extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}},$q=class{constructor(s){var e,t;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(e=s.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=s.signal,this.isMaybeSingle=(t=s.isMaybeSingle)!==null&&t!==void 0?t:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,e){return this.headers=new Headers(this.headers),this.headers.set(s,e),this}then(s,e){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{let c=null,d=null,f=null,m=l.status,x=l.statusText;if(l.ok){var y,w;if(t.method!=="HEAD"){var v;const P=await l.text();P===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((v=t.headers.get("Accept"))===null||v===void 0)&&v.includes("application/vnd.pgrst.plan+text"))?d=P:d=JSON.parse(P))}const I=(y=t.headers.get("Prefer"))===null||y===void 0?void 0:y.match(/count=(exact|planned|estimated)/),N=(w=l.headers.get("content-range"))===null||w===void 0?void 0:w.split("/");I&&N&&N.length>1&&(f=parseInt(N[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(d)&&(d.length>1?(c={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,f=null,m=406,x="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{var T;const I=await l.text();try{c=JSON.parse(I),Array.isArray(c)&&l.status===404&&(d=[],c=null,m=200,x="OK")}catch{l.status===404&&I===""?(m=204,x="No Content"):c={message:I}}if(c&&t.isMaybeSingle&&(!(c==null||(T=c.details)===null||T===void 0)&&T.includes("0 rows"))&&(c=null,m=200,x="OK"),c&&t.shouldThrowOnError)throw new Fq(c)}return{error:c,data:d,count:f,status:m,statusText:x}});return this.shouldThrowOnError||(a=a.catch(l=>{var c;let d="";const f=l==null?void 0:l.cause;if(f){var m,x,y,w;const T=(m=f==null?void 0:f.message)!==null&&m!==void 0?m:"",I=(x=f==null?void 0:f.code)!==null&&x!==void 0?x:"";d=`${(y=l==null?void 0:l.name)!==null&&y!==void 0?y:"FetchError"}: ${l==null?void 0:l.message}`,d+=`

Caused by: ${(w=f==null?void 0:f.name)!==null&&w!==void 0?w:"Error"}: ${T}`,I&&(d+=` (${I})`),f!=null&&f.stack&&(d+=`
${f.stack}`)}else{var v;d=(v=l==null?void 0:l.stack)!==null&&v!==void 0?v:""}return{error:{message:`${(c=l==null?void 0:l.name)!==null&&c!==void 0?c:"FetchError"}: ${l==null?void 0:l.message}`,details:d,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(s,e)}returns(){return this}overrideTypes(){return this}},Bq=class extends $q{select(s){let e=!1;const t=(s??"*").split("").map(n=>/\s/.test(n)&&!e?"":(n==='"'&&(e=!e),n)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:e=!0,nullsFirst:t,foreignTable:n,referencedTable:a=n}={}){const l=a?`${a}.order`:"order",c=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${c?`${c},`:""}${s}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:e,referencedTable:t=e}={}){const n=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(n,`${s}`),this}range(s,e,{foreignTable:t,referencedTable:n=t}={}){const a=typeof n>"u"?"offset":`${n}.offset`,l=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${s}`),this.url.searchParams.set(l,`${e-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:e=!1,settings:t=!1,buffers:n=!1,wal:a=!1,format:l="text"}={}){var c;const d=[s?"analyze":null,e?"verbose":null,t?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),f=(c=this.headers.get("Accept"))!==null&&c!==void 0?c:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${f}"; options=${d};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}};const c5=new RegExp("[,()]");var Ju=class extends Bq{eq(s,e){return this.url.searchParams.append(s,`eq.${e}`),this}neq(s,e){return this.url.searchParams.append(s,`neq.${e}`),this}gt(s,e){return this.url.searchParams.append(s,`gt.${e}`),this}gte(s,e){return this.url.searchParams.append(s,`gte.${e}`),this}lt(s,e){return this.url.searchParams.append(s,`lt.${e}`),this}lte(s,e){return this.url.searchParams.append(s,`lte.${e}`),this}like(s,e){return this.url.searchParams.append(s,`like.${e}`),this}likeAllOf(s,e){return this.url.searchParams.append(s,`like(all).{${e.join(",")}}`),this}likeAnyOf(s,e){return this.url.searchParams.append(s,`like(any).{${e.join(",")}}`),this}ilike(s,e){return this.url.searchParams.append(s,`ilike.${e}`),this}ilikeAllOf(s,e){return this.url.searchParams.append(s,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(s,e){return this.url.searchParams.append(s,`ilike(any).{${e.join(",")}}`),this}regexMatch(s,e){return this.url.searchParams.append(s,`match.${e}`),this}regexIMatch(s,e){return this.url.searchParams.append(s,`imatch.${e}`),this}is(s,e){return this.url.searchParams.append(s,`is.${e}`),this}isDistinct(s,e){return this.url.searchParams.append(s,`isdistinct.${e}`),this}in(s,e){const t=Array.from(new Set(e)).map(n=>typeof n=="string"&&c5.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(s,`in.(${t})`),this}notIn(s,e){const t=Array.from(new Set(e)).map(n=>typeof n=="string"&&c5.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(s,`not.in.(${t})`),this}contains(s,e){return typeof e=="string"?this.url.searchParams.append(s,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(s,`cs.{${e.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(e)}`),this}containedBy(s,e){return typeof e=="string"?this.url.searchParams.append(s,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(s,`cd.{${e.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(e)}`),this}rangeGt(s,e){return this.url.searchParams.append(s,`sr.${e}`),this}rangeGte(s,e){return this.url.searchParams.append(s,`nxl.${e}`),this}rangeLt(s,e){return this.url.searchParams.append(s,`sl.${e}`),this}rangeLte(s,e){return this.url.searchParams.append(s,`nxr.${e}`),this}rangeAdjacent(s,e){return this.url.searchParams.append(s,`adj.${e}`),this}overlaps(s,e){return typeof e=="string"?this.url.searchParams.append(s,`ov.${e}`):this.url.searchParams.append(s,`ov.{${e.join(",")}}`),this}textSearch(s,e,{config:t,type:n}={}){let a="";n==="plain"?a="pl":n==="phrase"?a="ph":n==="websearch"&&(a="w");const l=t===void 0?"":`(${t})`;return this.url.searchParams.append(s,`${a}fts${l}.${e}`),this}match(s){return Object.entries(s).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(s,e,t){return this.url.searchParams.append(s,`not.${e}.${t}`),this}or(s,{foreignTable:e,referencedTable:t=e}={}){const n=t?`${t}.or`:"or";return this.url.searchParams.append(n,`(${s})`),this}filter(s,e,t){return this.url.searchParams.append(s,`${e}.${t}`),this}},zq=class{constructor(s,{headers:e={},schema:t,fetch:n}){this.url=s,this.headers=new Headers(e),this.schema=t,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(s,e){const{head:t=!1,count:n}=e??{},a=t?"HEAD":"GET";let l=!1;const c=(s??"*").split("").map(m=>/\s/.test(m)&&!l?"":(m==='"'&&(l=!l),m)).join(""),{url:d,headers:f}=this.cloneRequestState();return d.searchParams.set("select",c),n&&f.append("Prefer",`count=${n}`),new Ju({method:a,url:d,headers:f,schema:this.schema,fetch:this.fetch})}insert(s,{count:e,defaultToNull:t=!0}={}){var n;const a="POST",{url:l,headers:c}=this.cloneRequestState();if(e&&c.append("Prefer",`count=${e}`),t||c.append("Prefer","missing=default"),Array.isArray(s)){const d=s.reduce((f,m)=>f.concat(Object.keys(m)),[]);if(d.length>0){const f=[...new Set(d)].map(m=>`"${m}"`);l.searchParams.set("columns",f.join(","))}}return new Ju({method:a,url:l,headers:c,schema:this.schema,body:s,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(s,{onConflict:e,ignoreDuplicates:t=!1,count:n,defaultToNull:a=!0}={}){var l;const c="POST",{url:d,headers:f}=this.cloneRequestState();if(f.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),e!==void 0&&d.searchParams.set("on_conflict",e),n&&f.append("Prefer",`count=${n}`),a||f.append("Prefer","missing=default"),Array.isArray(s)){const m=s.reduce((x,y)=>x.concat(Object.keys(y)),[]);if(m.length>0){const x=[...new Set(m)].map(y=>`"${y}"`);d.searchParams.set("columns",x.join(","))}}return new Ju({method:c,url:d,headers:f,schema:this.schema,body:s,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}update(s,{count:e}={}){var t;const n="PATCH",{url:a,headers:l}=this.cloneRequestState();return e&&l.append("Prefer",`count=${e}`),new Ju({method:n,url:a,headers:l,schema:this.schema,body:s,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}delete({count:s}={}){var e;const t="DELETE",{url:n,headers:a}=this.cloneRequestState();return s&&a.append("Prefer",`count=${s}`),new Ju({method:t,url:n,headers:a,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},qq=class dR{constructor(e,{headers:t={},schema:n,fetch:a}={}){this.url=e,this.headers=new Headers(t),this.schemaName=n,this.fetch=a}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new zq(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new dR(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:n=!1,get:a=!1,count:l}={}){var c;let d;const f=new URL(`${this.url}/rpc/${e}`);let m;const x=v=>v!==null&&typeof v=="object"&&(!Array.isArray(v)||v.some(x)),y=n&&Object.values(t).some(x);y?(d="POST",m=t):n||a?(d=n?"HEAD":"GET",Object.entries(t).filter(([v,T])=>T!==void 0).map(([v,T])=>[v,Array.isArray(T)?`{${T.join(",")}}`:`${T}`]).forEach(([v,T])=>{f.searchParams.append(v,T)})):(d="POST",m=t);const w=new Headers(this.headers);return y?w.set("Prefer",l?`count=${l},return=minimal`:"return=minimal"):l&&w.set("Prefer",`count=${l}`),new Ju({method:d,url:f,headers:w,schema:this.schemaName,body:m,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}};class Hq{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const n=t.versions;if(n&&n.node){const a=n.node,l=parseInt(a.replace(/^v/,"").split(".")[0]);return l>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${l} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${l} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const n=this.getWebSocketConstructor();return new n(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Gq="2.90.1",Wq=`realtime-js/${Gq}`,hR="1.0.0",Kq="2.0.0",u5=hR,gv=1e4,Qq=1e3,Yq=100;var Vo;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(Vo||(Vo={}));var Ys;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(Ys||(Ys={}));var fa;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(fa||(fa={}));var pv;(function(s){s.websocket="websocket"})(pv||(pv={}));var tc;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(tc||(tc={}));class Jq{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,n;const a=(n=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(e){var t,n;const a=(n=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:{},c=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,c)}_encodeUserBroadcastPush(e,t,n){var a,l;const c=e.topic,d=(a=e.ref)!==null&&a!==void 0?a:"",f=(l=e.join_ref)!==null&&l!==void 0?l:"",m=e.payload.event,x=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},y=Object.keys(x).length===0?"":JSON.stringify(x);if(f.length>255)throw new Error(`joinRef length ${f.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`ref length ${d.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`topic length ${c.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`userEvent length ${m.length} exceeds maximum of 255`);if(y.length>255)throw new Error(`metadata length ${y.length} exceeds maximum of 255`);const w=this.USER_BROADCAST_PUSH_META_LENGTH+f.length+d.length+c.length+m.length+y.length,v=new ArrayBuffer(this.HEADER_LENGTH+w);let T=new DataView(v),I=0;T.setUint8(I++,this.KINDS.userBroadcastPush),T.setUint8(I++,f.length),T.setUint8(I++,d.length),T.setUint8(I++,c.length),T.setUint8(I++,m.length),T.setUint8(I++,y.length),T.setUint8(I++,t),Array.from(f,P=>T.setUint8(I++,P.charCodeAt(0))),Array.from(d,P=>T.setUint8(I++,P.charCodeAt(0))),Array.from(c,P=>T.setUint8(I++,P.charCodeAt(0))),Array.from(m,P=>T.setUint8(I++,P.charCodeAt(0))),Array.from(y,P=>T.setUint8(I++,P.charCodeAt(0)));var N=new Uint8Array(v.byteLength+n.byteLength);return N.set(new Uint8Array(v),0),N.set(new Uint8Array(n),v.byteLength),N.buffer}decode(e,t){if(this._isArrayBuffer(e)){let n=this._binaryDecode(e);return t(n)}if(typeof e=="string"){const n=JSON.parse(e),[a,l,c,d,f]=n;return t({join_ref:a,ref:l,topic:c,event:d,payload:f})}return t({})}_binaryDecode(e){const t=new DataView(e),n=t.getUint8(0),a=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,a)}}_decodeUserBroadcast(e,t,n){const a=t.getUint8(1),l=t.getUint8(2),c=t.getUint8(3),d=t.getUint8(4);let f=this.HEADER_LENGTH+4;const m=n.decode(e.slice(f,f+a));f=f+a;const x=n.decode(e.slice(f,f+l));f=f+l;const y=n.decode(e.slice(f,f+c));f=f+c;const w=e.slice(f,e.byteLength),v=d===this.JSON_ENCODING?JSON.parse(n.decode(w)):w,T={type:this.BROADCAST_EVENT,event:x,payload:v};return c>0&&(T.meta=JSON.parse(y)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST_EVENT,payload:T}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([n])=>t.includes(n)))}}class fR{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var es;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(es||(es={}));const d5=(s,e,t={})=>{var n;const a=(n=t.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((l,c)=>(l[c]=Xq(c,s,e,a),l),{}):{}},Xq=(s,e,t,n)=>{const a=e.find(d=>d.name===s),l=a==null?void 0:a.type,c=t[s];return l&&!n.includes(l)?mR(l,c):xv(c)},mR=(s,e)=>{if(s.charAt(0)==="_"){const t=s.slice(1,s.length);return sH(e,t)}switch(s){case es.bool:return Zq(e);case es.float4:case es.float8:case es.int2:case es.int4:case es.int8:case es.numeric:case es.oid:return eH(e);case es.json:case es.jsonb:return tH(e);case es.timestamp:return nH(e);case es.abstime:case es.date:case es.daterange:case es.int4range:case es.int8range:case es.money:case es.reltime:case es.text:case es.time:case es.timestamptz:case es.timetz:case es.tsrange:case es.tstzrange:return xv(e);default:return xv(e)}},xv=s=>s,Zq=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},eH=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},tH=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch{return s}return s},sH=(s,e)=>{if(typeof s!="string")return s;const t=s.length-1,n=s[t];if(s[0]==="{"&&n==="}"){let l;const c=s.slice(1,t);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(d=>mR(e,d))}return s},nH=s=>typeof s=="string"?s.replace(" ","T"):s,gR=s=>{const e=new URL(s);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class ow{constructor(e,t,n={},a=gv){this.channel=e,this.event=t,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var h5;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(h5||(h5={}));class Uf{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Uf.syncState(this.state,a,l,c),this.pendingDiffs.forEach(f=>{this.state=Uf.syncDiff(this.state,f,l,c)}),this.pendingDiffs=[],d()}),this.channel._on(n.diff,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Uf.syncDiff(this.state,a,l,c),d())}),this.onJoin((a,l,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:c})}),this.onLeave((a,l,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,a){const l=this.cloneDeep(e),c=this.transformState(t),d={},f={};return this.map(l,(m,x)=>{c[m]||(f[m]=x)}),this.map(c,(m,x)=>{const y=l[m];if(y){const w=x.map(N=>N.presence_ref),v=y.map(N=>N.presence_ref),T=x.filter(N=>v.indexOf(N.presence_ref)<0),I=y.filter(N=>w.indexOf(N.presence_ref)<0);T.length>0&&(d[m]=T),I.length>0&&(f[m]=I)}else d[m]=x}),this.syncDiff(l,{joins:d,leaves:f},n,a)}static syncDiff(e,t,n,a){const{joins:l,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(l,(d,f)=>{var m;const x=(m=e[d])!==null&&m!==void 0?m:[];if(e[d]=this.cloneDeep(f),x.length>0){const y=e[d].map(v=>v.presence_ref),w=x.filter(v=>y.indexOf(v.presence_ref)<0);e[d].unshift(...w)}n(d,x,f)}),this.map(c,(d,f)=>{let m=e[d];if(!m)return;const x=f.map(y=>y.presence_ref);m=m.filter(y=>x.indexOf(y.presence_ref)<0),e[d]=m,a(d,m,f),m.length===0&&delete e[d]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const a=e[n];return"metas"in a?t[n]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[n]=a,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var f5;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(f5||(f5={}));var Ff;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(Ff||(Ff={}));var Ai;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(Ai||(Ai={}));class td{constructor(e,t={config:{}},n){var a,l;if(this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=Ys.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new ow(this,fa.join,this.params,this.timeout),this.rejoinTimer=new fR(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ys.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ys.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Ys.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ys.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Ys.errored,this.rejoinTimer.scheduleTimeout())}),this._on(fa.reply,{},(c,d)=>{this._trigger(this._replyEventName(d),c)}),this.presence=new Uf(this),this.broadcastEndpointURL=gR(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var n,a,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Ys.closed){const{config:{broadcast:c,presence:d,private:f}}=this.params,m=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(v=>v.filter))!==null&&a!==void 0?a:[],x=!!this.bindings[Ff.PRESENCE]&&this.bindings[Ff.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,y={},w={broadcast:c,presence:Object.assign(Object.assign({},d),{enabled:x}),postgres_changes:m,private:f};this.socket.accessTokenValue&&(y.access_token=this.socket.accessTokenValue),this._onError(v=>e==null?void 0:e(Ai.CHANNEL_ERROR,v)),this._onClose(()=>e==null?void 0:e(Ai.CLOSED)),this.updateJoinPayload(Object.assign({config:w},y)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:v})=>{var T;if(this.socket._isManualToken()||this.socket.setAuth(),v===void 0){e==null||e(Ai.SUBSCRIBED);return}else{const I=this.bindings.postgres_changes,N=(T=I==null?void 0:I.length)!==null&&T!==void 0?T:0,P=[];for(let U=0;U<N;U++){const V=I[U],{filter:{event:q,schema:W,table:z,filter:k}}=V,M=v&&v[U];if(M&&M.event===q&&td.isFilterValueEqual(M.schema,W)&&td.isFilterValueEqual(M.table,z)&&td.isFilterValueEqual(M.filter,k))P.push(Object.assign(Object.assign({},V),{id:M.id}));else{this.unsubscribe(),this.state=Ys.errored,e==null||e(Ai.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=P,e&&e(Ai.SUBSCRIBED);return}}).receive("error",v=>{this.state=Ys.errored,e==null||e(Ai.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Ai.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===Ys.joined&&e===Ff.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,n)}async httpSend(e,t,n={}){var a;if(t==null)return Promise.reject("Payload is required for httpSend()");const l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(d.status===202)return{success:!0};let f=d.statusText;try{const m=await d.json();f=m.error||m.message||f}catch{}return Promise.reject(new Error(f))}async send(e,t={}){var n,a;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=e,d={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(d.Authorization=`Bearer ${this.socket.accessTokenValue}`);const f={method:"POST",headers:d,body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=m.body)===null||a===void 0?void 0:a.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,d,f;const m=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((f=(d=(c=this.params)===null||c===void 0?void 0:c.config)===null||d===void 0?void 0:d.broadcast)===null||f===void 0)&&f.ack)&&l("ok"),m.receive("ok",()=>l("ok")),m.receive("error",()=>l("error")),m.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ys.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(fa.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new ow(this,fa.leave,{},e),n.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ys.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const a=new AbortController,l=setTimeout(()=>a.abort(),n),c=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(l),c}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new ow(this,e,t,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Yq){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var a,l;const c=e.toLocaleLowerCase(),{close:d,error:f,leave:m,join:x}=fa;if(n&&[d,f,m,x].indexOf(c)>=0&&n!==this._joinRef())return;let w=this._onMessage(c,t,n);if(t&&!w)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(v=>{var T,I,N;return((T=v.filter)===null||T===void 0?void 0:T.event)==="*"||((N=(I=v.filter)===null||I===void 0?void 0:I.event)===null||N===void 0?void 0:N.toLocaleLowerCase())===c}).map(v=>v.callback(w,n)):(l=this.bindings[c])===null||l===void 0||l.filter(v=>{var T,I,N,P,U,V,q,W;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in v){const z=v.id,k=(T=v.filter)===null||T===void 0?void 0:T.event;return z&&((I=t.ids)===null||I===void 0?void 0:I.includes(z))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((N=t.data)===null||N===void 0?void 0:N.type.toLocaleLowerCase()))&&(!(!((P=v.filter)===null||P===void 0)&&P.table)||v.filter.table===((U=t.data)===null||U===void 0?void 0:U.table))}else{const z=(q=(V=v==null?void 0:v.filter)===null||V===void 0?void 0:V.event)===null||q===void 0?void 0:q.toLocaleLowerCase();return z==="*"||z===((W=t==null?void 0:t.event)===null||W===void 0?void 0:W.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===c}).map(v=>{if(typeof w=="object"&&"ids"in w){const T=w.data,{schema:I,table:N,commit_timestamp:P,type:U,errors:V}=T;w=Object.assign(Object.assign({},{schema:I,table:N,commit_timestamp:P,eventType:U,new:{},old:{},errors:V}),this._getPayloadRecords(T))}v.callback(w,n)})}_isClosed(){return this.state===Ys.closed}_isJoined(){return this.state===Ys.joined}_isJoining(){return this.state===Ys.joining}_isLeaving(){return this.state===Ys.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const a=e.toLocaleLowerCase(),l={type:a,filter:t,callback:n};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&td.isEqual(a.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(fa.close,{},e)}_onError(e){this._on(fa.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ys.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=d5(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=d5(e.columns,e.old_record)),t}}const lw=()=>{},Sp={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},rH=[1e3,2e3,5e3,1e4],aH=1e4,iH=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class oH{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=gv,this.transport=null,this.heartbeatIntervalMs=Sp.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=lw,this.ref=0,this.reconnectTimer=null,this.vsn=u5,this.logger=lw,this.conn=null,this.sendBuffer=[],this.serializer=new Jq,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...l)=>a(...l):(...l)=>fetch(...l),!(!((n=t==null?void 0:t.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${pv.websocket}`,this.httpEndpoint=gR(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Hq.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Vo.connecting:return tc.Connecting;case Vo.open:return tc.Open;case Vo.closing:return tc.Closing;default:return tc.Closed}}isConnected(){return this.connectionState()===tc.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const n=`realtime:${e}`,a=this.getChannels().find(l=>l.topic===n);if(a)return a;{const l=new td(`realtime:${e}`,t,this);return this.channels.push(l),l}}push(e){const{topic:t,event:n,payload:a,ref:l}=e,c=()=>{this.encode(e,d=>{var f;(f=this.conn)===null||f===void 0||f.send(d)})};this.log("push",`${t} ${n} (${l})`,a),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Qq,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Sp.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const m=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",m)}catch(x){this.log("error","error in heartbeat callback",x)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:a,payload:l,ref:c}=t,d=c?`(${c})`:"",f=l.status||"";this.log("receive",`${f} ${n} ${a} ${d}`.trim(),l),this.channels.filter(m=>m._isMember(n)).forEach(m=>m._trigger(a,l,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Vo.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Vo.open||this.conn.readyState===Vo.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(fa.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${e}${n}${a}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([iH],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,n=!1;if(e)t=e,n=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),t=this.accessTokenValue}else t=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(a=>{const l={access_token:t,version:Wq};t&&a.updateJoinPayload(l),a.joinedOnce&&a._isJoined()&&a._push(fa.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new fR(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Sp.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,a,l,c,d,f,m,x,y,w,v;switch(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:gv,this.heartbeatIntervalMs=(a=e==null?void 0:e.heartbeatIntervalMs)!==null&&a!==void 0?a:Sp.HEARTBEAT_INTERVAL,this.worker=(l=e==null?void 0:e.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=e==null?void 0:e.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(d=e==null?void 0:e.heartbeatCallback)!==null&&d!==void 0?d:lw,this.vsn=(f=e==null?void 0:e.vsn)!==null&&f!==void 0?f:u5,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=e==null?void 0:e.reconnectAfterMs)!==null&&m!==void 0?m:(T=>rH[T-1]||aH),this.vsn){case hR:this.encode=(x=e==null?void 0:e.encode)!==null&&x!==void 0?x:((T,I)=>I(JSON.stringify(T))),this.decode=(y=e==null?void 0:e.decode)!==null&&y!==void 0?y:((T,I)=>I(JSON.parse(T)));break;case Kq:this.encode=(w=e==null?void 0:e.encode)!==null&&w!==void 0?w:this.serializer.encode.bind(this.serializer),this.decode=(v=e==null?void 0:e.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var hm=class extends Error{constructor(s,e){var t;super(s),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((t=e.icebergType)==null?void 0:t.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function lH(s,e,t){const n=new URL(e,s);if(t)for(const[a,l]of Object.entries(t))l!==void 0&&n.searchParams.set(a,l);return n.toString()}async function cH(s){return!s||s.type==="none"?{}:s.type==="bearer"?{Authorization:`Bearer ${s.token}`}:s.type==="header"?{[s.name]:s.value}:s.type==="custom"?await s.getHeaders():{}}function uH(s){const e=s.fetchImpl??globalThis.fetch;return{async request({method:t,path:n,query:a,body:l,headers:c}){const d=lH(s.baseUrl,n,a),f=await cH(s.auth),m=await e(d,{method:t,headers:{...l?{"Content-Type":"application/json"}:{},...f,...c},body:l?JSON.stringify(l):void 0}),x=await m.text(),y=(m.headers.get("content-type")||"").includes("application/json"),w=y&&x?JSON.parse(x):x;if(!m.ok){const v=y?w:void 0,T=v==null?void 0:v.error;throw new hm((T==null?void 0:T.message)??`Request failed with status ${m.status}`,{status:m.status,icebergType:T==null?void 0:T.type,icebergCode:T==null?void 0:T.code,details:v})}return{status:m.status,headers:m.headers,data:w}}}}function Tp(s){return s.join("")}var dH=class{constructor(s,e=""){this.client=s,this.prefix=e}async listNamespaces(s){const e=s?{parent:Tp(s.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(s,e){const t={namespace:s.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(s){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Tp(s.namespace)}`})}async loadNamespaceMetadata(s){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Tp(s.namespace)}`})).data.properties}}async namespaceExists(s){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Tp(s.namespace)}`}),!0}catch(e){if(e instanceof hm&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(s,e){try{return await this.createNamespace(s,e)}catch(t){if(t instanceof hm&&t.status===409)return;throw t}}};function Lu(s){return s.join("")}var hH=class{constructor(s,e="",t){this.client=s,this.prefix=e,this.accessDelegation=t}async listTables(s){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Lu(s.namespace)}/tables`})).data.identifiers}async createTable(s,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Lu(s.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(s,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Lu(s.namespace)}/tables/${s.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(s,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Lu(s.namespace)}/tables/${s.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(s){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Lu(s.namespace)}/tables/${s.name}`,headers:e})).data.metadata}async tableExists(s){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Lu(s.namespace)}/tables/${s.name}`,headers:e}),!0}catch(t){if(t instanceof hm&&t.status===404)return!1;throw t}}async createTableIfNotExists(s,e){try{return await this.createTable(s,e)}catch(t){if(t instanceof hm&&t.status===409)return await this.loadTable({namespace:s.namespace,name:e.name});throw t}}},fH=class{constructor(s){var n;let e="v1";s.catalogName&&(e+=`/${s.catalogName}`);const t=s.baseUrl.endsWith("/")?s.baseUrl:`${s.baseUrl}/`;this.client=uH({baseUrl:t,auth:s.auth,fetchImpl:s.fetch}),this.accessDelegation=(n=s.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new dH(this.client,e),this.tableOps=new hH(this.client,e,this.accessDelegation)}async listNamespaces(s){return this.namespaceOps.listNamespaces(s)}async createNamespace(s,e){return this.namespaceOps.createNamespace(s,e)}async dropNamespace(s){await this.namespaceOps.dropNamespace(s)}async loadNamespaceMetadata(s){return this.namespaceOps.loadNamespaceMetadata(s)}async listTables(s){return this.tableOps.listTables(s)}async createTable(s,e){return this.tableOps.createTable(s,e)}async updateTable(s,e){return this.tableOps.updateTable(s,e)}async dropTable(s,e){await this.tableOps.dropTable(s,e)}async loadTable(s){return this.tableOps.loadTable(s)}async namespaceExists(s){return this.namespaceOps.namespaceExists(s)}async tableExists(s){return this.tableOps.tableExists(s)}async createNamespaceIfNotExists(s,e){return this.namespaceOps.createNamespaceIfNotExists(s,e)}async createTableIfNotExists(s,e){return this.tableOps.createTableIfNotExists(s,e)}},Nx=class extends Error{constructor(s){super(s),this.__isStorageError=!0,this.name="StorageError"}};function ms(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}var mH=class extends Nx{constructor(s,e,t){super(s),this.name="StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},bv=class extends Nx{constructor(s,e){super(s),this.name="StorageUnknownError",this.originalError=e}};const Bj=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),gH=()=>Response,yv=s=>{if(Array.isArray(s))return s.map(t=>yv(t));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([t,n])=>{const a=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[a]=yv(n)}),e},pH=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},xH=s=>!s||typeof s!="string"||s.length===0||s.length>100||s.trim()!==s||s.includes("/")||s.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(s);function fm(s){"@babel/helpers - typeof";return fm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fm(s)}function bH(s,e){if(fm(s)!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e);if(fm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function yH(s){var e=bH(s,"string");return fm(e)=="symbol"?e:e+""}function wH(s,e,t){return(e=yH(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function m5(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),t.push.apply(t,n)}return t}function ct(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?m5(Object(t),!0).forEach(function(n){wH(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):m5(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}const cw=s=>{var e;return s.msg||s.message||s.error_description||(typeof s.error=="string"?s.error:(e=s.error)===null||e===void 0?void 0:e.message)||JSON.stringify(s)},vH=async(s,e,t)=>{s instanceof await gH()&&!(t!=null&&t.noResolveJson)?s.json().then(n=>{const a=s.status||500,l=(n==null?void 0:n.statusCode)||a+"";e(new mH(cw(n),a,l))}).catch(n=>{e(new bv(cw(n),n))}):e(new bv(cw(s),s))},_H=(s,e,t,n)=>{const a={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"||!n?a:(pH(n)?(a.headers=ct({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(n)):a.body=n,e!=null&&e.duplex&&(a.duplex=e.duplex),ct(ct({},a),t))};async function zm(s,e,t,n,a,l){return new Promise((c,d)=>{s(t,_H(e,n,a,l)).then(f=>{if(!f.ok)throw f;return n!=null&&n.noResolveJson?f:f.json()}).then(f=>c(f)).catch(f=>vH(f,d,n))})}async function mm(s,e,t,n){return zm(s,"GET",e,t,n)}async function da(s,e,t,n,a){return zm(s,"POST",e,n,a,t)}async function wv(s,e,t,n,a){return zm(s,"PUT",e,n,a,t)}async function jH(s,e,t,n){return zm(s,"HEAD",e,ct(ct({},t),{},{noResolveJson:!0}),n)}async function zj(s,e,t,n,a){return zm(s,"DELETE",e,n,a,t)}var NH=class{constructor(s,e){this.downloadFn=s,this.shouldThrowOnError=e}then(s,e){return this.execute().then(s,e)}async execute(){var s=this;try{return{data:(await s.downloadFn()).body,error:null}}catch(e){if(s.shouldThrowOnError)throw e;if(ms(e))return{data:null,error:e};throw e}}};let pR;pR=Symbol.toStringTag;var SH=class{constructor(s,e){this.downloadFn=s,this.shouldThrowOnError=e,this[pR]="BlobDownloadBuilder",this.promise=null}asStream(){return new NH(this.downloadFn,this.shouldThrowOnError)}then(s,e){return this.getPromise().then(s,e)}catch(s){return this.getPromise().catch(s)}finally(s){return this.getPromise().finally(s)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var s=this;try{return{data:await(await s.downloadFn()).blob(),error:null}}catch(e){if(s.shouldThrowOnError)throw e;if(ms(e))return{data:null,error:e};throw e}}};const TH={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},g5={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var EH=class{constructor(s,e={},t,n){this.shouldThrowOnError=!1,this.url=s,this.headers=e,this.bucketId=t,this.fetch=Bj(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(s,e,t,n){var a=this;try{let l;const c=ct(ct({},g5),n);let d=ct(ct({},a.headers),s==="POST"&&{"x-upsert":String(c.upsert)});const f=c.metadata;typeof Blob<"u"&&t instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),f&&l.append("metadata",a.encodeMetadata(f)),l.append("",t)):typeof FormData<"u"&&t instanceof FormData?(l=t,l.has("cacheControl")||l.append("cacheControl",c.cacheControl),f&&!l.has("metadata")&&l.append("metadata",a.encodeMetadata(f))):(l=t,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType,f&&(d["x-metadata"]=a.toBase64(a.encodeMetadata(f))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!c.duplex&&(c.duplex="half")),n!=null&&n.headers&&(d=ct(ct({},d),n.headers));const m=a._removeEmptyFolders(e),x=a._getFinalPath(m),y=await(s=="PUT"?wv:da)(a.fetch,`${a.url}/object/${x}`,l,ct({headers:d},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{data:{path:m,id:y.Id,fullPath:y.Key},error:null}}catch(l){if(a.shouldThrowOnError)throw l;if(ms(l))return{data:null,error:l};throw l}}async upload(s,e,t){return this.uploadOrUpdate("POST",s,e,t)}async uploadToSignedUrl(s,e,t,n){var a=this;const l=a._removeEmptyFolders(s),c=a._getFinalPath(l),d=new URL(a.url+`/object/upload/sign/${c}`);d.searchParams.set("token",e);try{let f;const m=ct({upsert:g5.upsert},n),x=ct(ct({},a.headers),{"x-upsert":String(m.upsert)});return typeof Blob<"u"&&t instanceof Blob?(f=new FormData,f.append("cacheControl",m.cacheControl),f.append("",t)):typeof FormData<"u"&&t instanceof FormData?(f=t,f.append("cacheControl",m.cacheControl)):(f=t,x["cache-control"]=`max-age=${m.cacheControl}`,x["content-type"]=m.contentType),{data:{path:l,fullPath:(await wv(a.fetch,d.toString(),f,{headers:x})).Key},error:null}}catch(f){if(a.shouldThrowOnError)throw f;if(ms(f))return{data:null,error:f};throw f}}async createSignedUploadUrl(s,e){var t=this;try{let n=t._getFinalPath(s);const a=ct({},t.headers);e!=null&&e.upsert&&(a["x-upsert"]="true");const l=await da(t.fetch,`${t.url}/object/upload/sign/${n}`,{},{headers:a}),c=new URL(t.url+l.url),d=c.searchParams.get("token");if(!d)throw new Nx("No token returned by API");return{data:{signedUrl:c.toString(),path:s,token:d},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(ms(n))return{data:null,error:n};throw n}}async update(s,e,t){return this.uploadOrUpdate("PUT",s,e,t)}async move(s,e,t){var n=this;try{return{data:await da(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:s,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:n.headers}),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(ms(a))return{data:null,error:a};throw a}}async copy(s,e,t){var n=this;try{return{data:{path:(await da(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:s,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:n.headers})).Key},error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(ms(a))return{data:null,error:a};throw a}}async createSignedUrl(s,e,t){var n=this;try{let a=n._getFinalPath(s),l=await da(n.fetch,`${n.url}/object/sign/${a}`,ct({expiresIn:e},t!=null&&t.transform?{transform:t.transform}:{}),{headers:n.headers});const c=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return l={signedUrl:encodeURI(`${n.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(ms(a))return{data:null,error:a};throw a}}async createSignedUrls(s,e,t){var n=this;try{const a=await da(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:e,paths:s},{headers:n.headers}),l=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{data:a.map(c=>ct(ct({},c),{},{signedUrl:c.signedURL?encodeURI(`${n.url}${c.signedURL}${l}`):null})),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(ms(a))return{data:null,error:a};throw a}}download(s,e){const t=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),a=n?`?${n}`:"",l=this._getFinalPath(s),c=()=>mm(this.fetch,`${this.url}/${t}/${l}${a}`,{headers:this.headers,noResolveJson:!0});return new SH(c,this.shouldThrowOnError)}async info(s){var e=this;const t=e._getFinalPath(s);try{return{data:yv(await mm(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ms(n))return{data:null,error:n};throw n}}async exists(s){var e=this;const t=e._getFinalPath(s);try{return await jH(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ms(n)&&n instanceof bv){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}}getPublicUrl(s,e){const t=this._getFinalPath(s),n=[],a=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";a!==""&&n.push(a);const l=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});c!==""&&n.push(c);let d=n.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${t}${d}`)}}}async remove(s){var e=this;try{return{data:await zj(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:s},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ms(t))return{data:null,error:t};throw t}}async list(s,e,t){var n=this;try{const a=ct(ct(ct({},TH),e),{},{prefix:s||""});return{data:await da(n.fetch,`${n.url}/object/list/${n.bucketId}`,a,{headers:n.headers},t),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(ms(a))return{data:null,error:a};throw a}}async listV2(s,e){var t=this;try{const n=ct({},s);return{data:await da(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,n,{headers:t.headers},e),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(ms(n))return{data:null,error:n};throw n}}encodeMetadata(s){return JSON.stringify(s)}toBase64(s){return typeof Buffer<"u"?Buffer.from(s).toString("base64"):btoa(s)}_getFinalPath(s){return`${this.bucketId}/${s.replace(/^\/+/,"")}`}_removeEmptyFolders(s){return s.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(s){const e=[];return s.width&&e.push(`width=${s.width}`),s.height&&e.push(`height=${s.height}`),s.resize&&e.push(`resize=${s.resize}`),s.format&&e.push(`format=${s.format}`),s.quality&&e.push(`quality=${s.quality}`),e.join("&")}};const xR="2.90.1",bR={"X-Client-Info":`storage-js/${xR}`};var IH=class{constructor(s,e={},t,n){this.shouldThrowOnError=!1;const a=new URL(s);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=ct(ct({},bR),e),this.fetch=Bj(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(s){var e=this;try{const t=e.listBucketOptionsToQueryString(s);return{data:await mm(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ms(t))return{data:null,error:t};throw t}}async getBucket(s){var e=this;try{return{data:await mm(e.fetch,`${e.url}/bucket/${s}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ms(t))return{data:null,error:t};throw t}}async createBucket(s,e={public:!1}){var t=this;try{return{data:await da(t.fetch,`${t.url}/bucket`,{id:s,name:s,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(ms(n))return{data:null,error:n};throw n}}async updateBucket(s,e){var t=this;try{return{data:await wv(t.fetch,`${t.url}/bucket/${s}`,{id:s,name:s,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(ms(n))return{data:null,error:n};throw n}}async emptyBucket(s){var e=this;try{return{data:await da(e.fetch,`${e.url}/bucket/${s}/empty`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ms(t))return{data:null,error:t};throw t}}async deleteBucket(s){var e=this;try{return{data:await zj(e.fetch,`${e.url}/bucket/${s}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ms(t))return{data:null,error:t};throw t}}listBucketOptionsToQueryString(s){const e={};return s&&("limit"in s&&(e.limit=String(s.limit)),"offset"in s&&(e.offset=String(s.offset)),s.search&&(e.search=s.search),s.sortColumn&&(e.sortColumn=s.sortColumn),s.sortOrder&&(e.sortOrder=s.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},AH=class{constructor(s,e={},t){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=ct(ct({},bR),e),this.fetch=Bj(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(s){var e=this;try{return{data:await da(e.fetch,`${e.url}/bucket`,{name:s},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ms(t))return{data:null,error:t};throw t}}async listBuckets(s){var e=this;try{const t=new URLSearchParams;(s==null?void 0:s.limit)!==void 0&&t.set("limit",s.limit.toString()),(s==null?void 0:s.offset)!==void 0&&t.set("offset",s.offset.toString()),s!=null&&s.sortColumn&&t.set("sortColumn",s.sortColumn),s!=null&&s.sortOrder&&t.set("sortOrder",s.sortOrder),s!=null&&s.search&&t.set("search",s.search);const n=t.toString(),a=n?`${e.url}/bucket?${n}`:`${e.url}/bucket`;return{data:await mm(e.fetch,a,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ms(t))return{data:null,error:t};throw t}}async deleteBucket(s){var e=this;try{return{data:await zj(e.fetch,`${e.url}/bucket/${s}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ms(t))return{data:null,error:t};throw t}}from(s){var e=this;if(!xH(s))throw new Nx("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new fH({baseUrl:this.url,catalogName:s,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(t,{get(a,l){const c=a[l];return typeof c!="function"?c:async(...d)=>{try{return{data:await c.apply(a,d),error:null}}catch(f){if(n)throw f;return{data:null,error:f}}}}})}};const qj={"X-Client-Info":`storage-js/${xR}`,"Content-Type":"application/json"};var yR=class extends Error{constructor(s){super(s),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Tr(s){return typeof s=="object"&&s!==null&&"__isStorageVectorsError"in s}var uw=class extends yR{constructor(s,e,t){super(s),this.name="StorageVectorsApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},kH=class extends yR{constructor(s,e){super(s),this.name="StorageVectorsUnknownError",this.originalError=e}};const Hj=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),CH=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},p5=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),RH=async(s,e,t)=>{if(s&&typeof s=="object"&&"status"in s&&"ok"in s&&typeof s.status=="number"&&!(t!=null&&t.noResolveJson)){const n=s.status||500,a=s;if(typeof a.json=="function")a.json().then(l=>{const c=(l==null?void 0:l.statusCode)||(l==null?void 0:l.code)||n+"";e(new uw(p5(l),n,c))}).catch(()=>{const l=n+"";e(new uw(a.statusText||`HTTP ${n} error`,n,l))});else{const l=n+"";e(new uw(a.statusText||`HTTP ${n} error`,n,l))}}else e(new kH(p5(s),s))},DH=(s,e,t,n)=>{const a={method:s,headers:(e==null?void 0:e.headers)||{}};return n?(CH(n)?(a.headers=ct({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(n)):a.body=n,ct(ct({},a),t)):a};async function OH(s,e,t,n,a,l){return new Promise((c,d)=>{s(t,DH(e,n,a,l)).then(f=>{if(!f.ok)throw f;if(n!=null&&n.noResolveJson)return f;const m=f.headers.get("content-type");return!m||!m.includes("application/json")?{}:f.json()}).then(f=>c(f)).catch(f=>RH(f,d,n))})}async function Er(s,e,t,n,a){return OH(s,"POST",e,n,a,t)}var PH=class{constructor(s,e={},t){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=ct(ct({},qj),e),this.fetch=Hj(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(s){var e=this;try{return{data:await Er(e.fetch,`${e.url}/CreateIndex`,s,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Tr(t))return{data:null,error:t};throw t}}async getIndex(s,e){var t=this;try{return{data:await Er(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:s,indexName:e},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Tr(n))return{data:null,error:n};throw n}}async listIndexes(s){var e=this;try{return{data:await Er(e.fetch,`${e.url}/ListIndexes`,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Tr(t))return{data:null,error:t};throw t}}async deleteIndex(s,e){var t=this;try{return{data:await Er(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:s,indexName:e},{headers:t.headers})||{},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Tr(n))return{data:null,error:n};throw n}}},MH=class{constructor(s,e={},t){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=ct(ct({},qj),e),this.fetch=Hj(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(s){var e=this;try{if(s.vectors.length<1||s.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Er(e.fetch,`${e.url}/PutVectors`,s,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Tr(t))return{data:null,error:t};throw t}}async getVectors(s){var e=this;try{return{data:await Er(e.fetch,`${e.url}/GetVectors`,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Tr(t))return{data:null,error:t};throw t}}async listVectors(s){var e=this;try{if(s.segmentCount!==void 0){if(s.segmentCount<1||s.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(s.segmentIndex!==void 0&&(s.segmentIndex<0||s.segmentIndex>=s.segmentCount))throw new Error(`segmentIndex must be between 0 and ${s.segmentCount-1}`)}return{data:await Er(e.fetch,`${e.url}/ListVectors`,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Tr(t))return{data:null,error:t};throw t}}async queryVectors(s){var e=this;try{return{data:await Er(e.fetch,`${e.url}/QueryVectors`,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Tr(t))return{data:null,error:t};throw t}}async deleteVectors(s){var e=this;try{if(s.keys.length<1||s.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Er(e.fetch,`${e.url}/DeleteVectors`,s,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Tr(t))return{data:null,error:t};throw t}}},LH=class{constructor(s,e={},t){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=ct(ct({},qj),e),this.fetch=Hj(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(s){var e=this;try{return{data:await Er(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:s},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Tr(t))return{data:null,error:t};throw t}}async getBucket(s){var e=this;try{return{data:await Er(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:s},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Tr(t))return{data:null,error:t};throw t}}async listBuckets(s={}){var e=this;try{return{data:await Er(e.fetch,`${e.url}/ListVectorBuckets`,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Tr(t))return{data:null,error:t};throw t}}async deleteBucket(s){var e=this;try{return{data:await Er(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:s},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Tr(t))return{data:null,error:t};throw t}}},VH=class extends LH{constructor(s,e={}){super(s,e.headers||{},e.fetch)}from(s){return new UH(this.url,this.headers,s,this.fetch)}async createBucket(s){var e=()=>super.createBucket,t=this;return e().call(t,s)}async getBucket(s){var e=()=>super.getBucket,t=this;return e().call(t,s)}async listBuckets(s={}){var e=()=>super.listBuckets,t=this;return e().call(t,s)}async deleteBucket(s){var e=()=>super.deleteBucket,t=this;return e().call(t,s)}},UH=class extends PH{constructor(s,e,t,n){super(s,e,n),this.vectorBucketName=t}async createIndex(s){var e=()=>super.createIndex,t=this;return e().call(t,ct(ct({},s),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(s={}){var e=()=>super.listIndexes,t=this;return e().call(t,ct(ct({},s),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(s){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,s)}async deleteIndex(s){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,s)}index(s){return new FH(this.url,this.headers,this.vectorBucketName,s,this.fetch)}},FH=class extends MH{constructor(s,e,t,n,a){super(s,e,a),this.vectorBucketName=t,this.indexName=n}async putVectors(s){var e=()=>super.putVectors,t=this;return e().call(t,ct(ct({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(s){var e=()=>super.getVectors,t=this;return e().call(t,ct(ct({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(s={}){var e=()=>super.listVectors,t=this;return e().call(t,ct(ct({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(s){var e=()=>super.queryVectors,t=this;return e().call(t,ct(ct({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(s){var e=()=>super.deleteVectors,t=this;return e().call(t,ct(ct({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},$H=class extends IH{constructor(s,e={},t,n){super(s,e,t,n)}from(s){return new EH(this.url,this.headers,s,this.fetch)}get vectors(){return new VH(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new AH(this.url+"/iceberg",this.headers,this.fetch)}};const wR="2.90.1",Xu=30*1e3,vv=3,dw=vv*Xu,BH="http://localhost:9999",zH="supabase.auth.token",qH={"X-Client-Info":`gotrue-js/${wR}`},_v="X-Supabase-Api-Version",vR={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},HH=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,GH=600*1e3;class gm extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function Ze(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class WH extends gm{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function KH(s){return Ze(s)&&s.name==="AuthApiError"}class sc extends gm{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Zi extends gm{constructor(e,t,n,a){super(e,n,a),this.name=t,this.status=n}}class jr extends Zi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function QH(s){return Ze(s)&&s.name==="AuthSessionMissingError"}class Vu extends Zi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ep extends Zi{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ip extends Zi{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function YH(s){return Ze(s)&&s.name==="AuthImplicitGrantRedirectError"}class x5 extends Zi{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class JH extends Zi{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class jv extends Zi{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function hw(s){return Ze(s)&&s.name==="AuthRetryableFetchError"}class b5 extends Zi{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class Nv extends Zi{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const T0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),y5=` 	
\r=`.split(""),XH=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<y5.length;e+=1)s[y5[e].charCodeAt(0)]=-2;for(let e=0;e<T0.length;e+=1)s[T0[e].charCodeAt(0)]=e;return s})();function w5(s,e,t){if(s!==null)for(e.queue=e.queue<<8|s,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(T0[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(T0[n]),e.queuedBits-=6}}function _R(s,e,t){const n=XH[s];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function v5(s){const e=[],t=c=>{e.push(String.fromCodePoint(c))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=c=>{tG(c,n,t)};for(let c=0;c<s.length;c+=1)_R(s.charCodeAt(c),a,l);return e.join("")}function ZH(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function eG(s,e){for(let t=0;t<s.length;t+=1){let n=s.charCodeAt(t);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(s.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}ZH(n,e)}}function tG(s,e,t){if(e.utf8seq===0){if(s<=127){t(s);return}for(let n=1;n<6;n+=1)if((s>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function fd(s){const e=[],t={queue:0,queuedBits:0},n=a=>{e.push(a)};for(let a=0;a<s.length;a+=1)_R(s.charCodeAt(a),t,n);return new Uint8Array(e)}function sG(s){const e=[];return eG(s,t=>e.push(t)),new Uint8Array(e)}function lc(s){const e=[],t={queue:0,queuedBits:0},n=a=>{e.push(a)};return s.forEach(a=>w5(a,t,n)),w5(null,t,n),e.join("")}function nG(s){return Math.round(Date.now()/1e3)+s}function rG(){return Symbol("auth-callback")}const xn=()=>typeof window<"u"&&typeof document<"u",ql={tested:!1,writable:!1},jR=()=>{if(!xn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ql.tested)return ql.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),ql.tested=!0,ql.writable=!0}catch{ql.tested=!0,ql.writable=!1}return ql.writable};function aG(s){const e={},t=new URL(s);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,l)=>{e[l]=a})}catch{}return t.searchParams.forEach((n,a)=>{e[a]=n}),e}const NR=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),iG=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",Zu=async(s,e,t)=>{await s.setItem(e,JSON.stringify(t))},Hl=async(s,e)=>{const t=await s.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},pn=async(s,e)=>{await s.removeItem(e)};class Sx{constructor(){this.promise=new Sx.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Sx.promiseConstructor=Promise;function fw(s){const e=s.split(".");if(e.length!==3)throw new Nv("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!HH.test(e[n]))throw new Nv("JWT not in base64url format");return{header:JSON.parse(v5(e[0])),payload:JSON.parse(v5(e[1])),signature:fd(e[2]),raw:{header:e[0],payload:e[1]}}}async function oG(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function lG(s,e){return new Promise((n,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await s(l);if(!e(l,null,c)){n(c);return}}catch(c){if(!e(l,c)){a(c);return}}})()})}function cG(s){return("0"+s.toString(16)).substr(-2)}function uG(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let a="";for(let l=0;l<56;l++)a+=t.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(e),Array.from(e,cG).join("")}async function dG(s){const t=new TextEncoder().encode(s),n=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(n);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function hG(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const t=await dG(s);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Uu(s,e,t=!1){const n=uG();let a=n;t&&(a+="/PASSWORD_RECOVERY"),await Zu(s,`${e}-code-verifier`,a);const l=await hG(n);return[l,n===l?"plain":"s256"]}const fG=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function mG(s){const e=s.headers.get(_v);if(!e||!e.match(fG))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function gG(s){if(!s)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(s<=e)throw new Error("JWT has expired")}function pG(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const xG=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Fu(s){if(!xG.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function mw(){const s={};return new Proxy(s,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function bG(s,e){return new Proxy(s,{get:(t,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const l=n.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,n,a)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,n,a)}})}function _5(s){return JSON.parse(JSON.stringify(s))}const Ql=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),yG=[502,503,504];async function j5(s){var e;if(!iG(s))throw new jv(Ql(s),0);if(yG.includes(s.status))throw new jv(Ql(s),s.status);let t;try{t=await s.json()}catch(l){throw new sc(Ql(l),l)}let n;const a=mG(s);if(a&&a.getTime()>=vR["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new b5(Ql(t),s.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new jr}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new b5(Ql(t),s.status,t.weak_password.reasons);throw new WH(Ql(t),s.status||500,n)}const wG=(s,e,t,n)=>{const a={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),t))};async function lt(s,e,t,n){var a;const l=Object.assign({},n==null?void 0:n.headers);l[_v]||(l[_v]=vR["2024-01-01"].name),n!=null&&n.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const c=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(c.redirect_to=n.redirectTo);const d=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",f=await vG(s,e,t+d,{headers:l,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(f):{data:Object.assign({},f),error:null}}async function vG(s,e,t,n,a,l){const c=wG(e,n,a,l);let d;try{d=await s(t,Object.assign({},c))}catch(f){throw console.error(f),new jv(Ql(f),0)}if(d.ok||await j5(d),n!=null&&n.noResolveJson)return d;try{return await d.json()}catch(f){await j5(f)}}function ua(s){var e;let t=null;NG(s)&&(t=Object.assign({},s),s.expires_at||(t.expires_at=nG(s.expires_in)));const n=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:t,user:n},error:null}}function N5(s){const e=ua(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=s.weak_password),e}function Fo(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function _G(s){return{data:s,error:null}}function jG(s){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:a,verification_type:l}=s,c=jx(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:e,email_otp:t,hashed_token:n,redirect_to:a,verification_type:l},f=Object.assign({},c);return{data:{properties:d,user:f},error:null}}function S5(s){return s}function NG(s){return s.access_token&&s.refresh_token&&s.expires_in}const gw=["global","local","others"];class SG{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=NR(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=gw[0]){if(gw.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${gw.join(", ")}`);try{return await lt(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ze(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await lt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Fo})}catch(n){if(Ze(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=jx(e,["options"]),a=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await lt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:jG,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Ze(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await lt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Fo})}catch(t){if(Ze(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,a,l,c,d,f;try{const m={nextPage:null,lastPage:0,total:0},x=await lt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(l=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:S5});if(x.error)throw x.error;const y=await x.json(),w=(c=x.headers.get("x-total-count"))!==null&&c!==void 0?c:0,v=(f=(d=x.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&f!==void 0?f:[];return v.length>0&&(v.forEach(T=>{const I=parseInt(T.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(T.split(";")[1].split("=")[1]);m[`${N}Page`]=I}),m.total=parseInt(w)),{data:Object.assign(Object.assign({},y),m),error:null}}catch(m){if(Ze(m))return{data:{users:[]},error:m};throw m}}async getUserById(e){Fu(e);try{return await lt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Fo})}catch(t){if(Ze(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Fu(e);try{return await lt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Fo})}catch(n){if(Ze(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){Fu(e);try{return await lt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Fo})}catch(n){if(Ze(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Fu(e.userId);try{const{data:t,error:n}=await lt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:n}}catch(t){if(Ze(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Fu(e.userId),Fu(e.id);try{return{data:await lt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ze(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,n,a,l,c,d,f;try{const m={nextPage:null,lastPage:0,total:0},x=await lt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(l=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:S5});if(x.error)throw x.error;const y=await x.json(),w=(c=x.headers.get("x-total-count"))!==null&&c!==void 0?c:0,v=(f=(d=x.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&f!==void 0?f:[];return v.length>0&&(v.forEach(T=>{const I=parseInt(T.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(T.split(";")[1].split("=")[1]);m[`${N}Page`]=I}),m.total=parseInt(w)),{data:Object.assign(Object.assign({},y),m),error:null}}catch(m){if(Ze(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(e){try{return await lt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ze(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await lt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ze(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await lt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ze(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await lt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(Ze(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await lt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ze(t))return{data:null,error:t};throw t}}}function T5(s={}){return{getItem:e=>s[e]||null,setItem:(e,t)=>{s[e]=t},removeItem:e=>{delete s[e]}}}const $u={debug:!!(globalThis&&jR()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class SR extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class TG extends SR{}async function EG(s,e,t){$u.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),$u.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){$u.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,a.name);try{return await t()}finally{$u.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,a.name)}}else{if(e===0)throw $u.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new TG(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if($u.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function IG(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function TR(s){if(!/^0x[a-fA-F0-9]{40}$/.test(s))throw new Error(`@supabase/auth-js: Address "${s}" is invalid.`);return s.toLowerCase()}function AG(s){return parseInt(s,16)}function kG(s){const e=new TextEncoder().encode(s);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function CG(s){var e;const{chainId:t,domain:n,expirationTime:a,issuedAt:l=new Date,nonce:c,notBefore:d,requestId:f,resources:m,scheme:x,uri:y,version:w}=s;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!y)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(w!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${w}`);if(!((e=s.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${s.statement}`)}const v=TR(s.address),T=x?`${x}://${n}`:n,I=s.statement?`${s.statement}
`:"",N=`${T} wants you to sign in with your Ethereum account:
${v}

${I}`;let P=`URI: ${y}
Version: ${w}
Chain ID: ${t}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(a&&(P+=`
Expiration Time: ${a.toISOString()}`),d&&(P+=`
Not Before: ${d.toISOString()}`),f&&(P+=`
Request ID: ${f}`),m){let U=`
Resources:`;for(const V of m){if(!V||typeof V!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${V}`);U+=`
- ${V}`}P+=U}return`${N}
${P}`}class Bs extends Error{constructor({message:e,code:t,cause:n,name:a}){var l;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(l=a??(n instanceof Error?n.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=t}}class E0 extends Bs{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function RG({error:s,options:e}){var t,n,a;const{publicKey:l}=e;if(!l)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Bs({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else if(s.name==="ConstraintError"){if(((t=l.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new Bs({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:s});if(e.mediation==="conditional"&&((n=l.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Bs({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:s});if(((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Bs({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:s})}else{if(s.name==="InvalidStateError")return new Bs({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:s});if(s.name==="NotAllowedError")return new Bs({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="NotSupportedError")return l.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new Bs({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:s}):new Bs({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:s});if(s.name==="SecurityError"){const c=window.location.hostname;if(ER(c)){if(l.rp.id!==c)return new Bs({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new Bs({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Bs({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:s})}else if(s.name==="UnknownError")return new Bs({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new Bs({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}function DG({error:s,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Bs({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else{if(s.name==="NotAllowedError")return new Bs({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="SecurityError"){const n=window.location.hostname;if(ER(n)){if(t.rpId!==n)return new Bs({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new Bs({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="UnknownError")return new Bs({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new Bs({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}class OG{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const PG=new OG;function MG(s){if(!s)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(s);const{challenge:e,user:t,excludeCredentials:n}=s,a=jx(s,["challenge","user","excludeCredentials"]),l=fd(e).buffer,c=Object.assign(Object.assign({},t),{id:fd(t.id).buffer}),d=Object.assign(Object.assign({},a),{challenge:l,user:c});if(n&&n.length>0){d.excludeCredentials=new Array(n.length);for(let f=0;f<n.length;f++){const m=n[f];d.excludeCredentials[f]=Object.assign(Object.assign({},m),{id:fd(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return d}function LG(s){if(!s)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(s);const{challenge:e,allowCredentials:t}=s,n=jx(s,["challenge","allowCredentials"]),a=fd(e).buffer,l=Object.assign(Object.assign({},n),{challenge:a});if(t&&t.length>0){l.allowCredentials=new Array(t.length);for(let c=0;c<t.length;c++){const d=t[c];l.allowCredentials[c]=Object.assign(Object.assign({},d),{id:fd(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function VG(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const t=s;return{id:s.id,rawId:s.id,response:{attestationObject:lc(new Uint8Array(s.response.attestationObject)),clientDataJSON:lc(new Uint8Array(s.response.clientDataJSON))},type:"public-key",clientExtensionResults:s.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function UG(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const t=s,n=s.getClientExtensionResults(),a=s.response;return{id:s.id,rawId:s.id,response:{authenticatorData:lc(new Uint8Array(a.authenticatorData)),clientDataJSON:lc(new Uint8Array(a.clientDataJSON)),signature:lc(new Uint8Array(a.signature)),userHandle:a.userHandle?lc(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function ER(s){return s==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(s)}function E5(){var s,e;return!!(xn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((s=navigator==null?void 0:navigator.credentials)===null||s===void 0?void 0:s.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function FG(s){try{const e=await navigator.credentials.create(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new E0("Browser returned unexpected credential type",e)}:{data:null,error:new E0("Empty credential response",e)}}catch(e){return{data:null,error:RG({error:e,options:s})}}}async function $G(s){try{const e=await navigator.credentials.get(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new E0("Browser returned unexpected credential type",e)}:{data:null,error:new E0("Empty credential response",e)}}catch(e){return{data:null,error:DG({error:e,options:s})}}}const BG={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},zG={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function I0(...s){const e=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),t=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of s)if(a)for(const l in a){const c=a[l];if(c!==void 0)if(Array.isArray(c))n[l]=c;else if(t(c))n[l]=c;else if(e(c)){const d=n[l];e(d)?n[l]=I0(d,c):n[l]=I0(c)}else n[l]=c}return n}function qG(s,e){return I0(BG,s,e||{})}function HG(s,e){return I0(zG,s,e||{})}class GG{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:n,signal:a},l){try{const{data:c,error:d}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!c)return{data:null,error:d};const f=a??PG.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:m}=c.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${n}`),m.displayName||(m.displayName=m.name)}switch(c.webauthn.type){case"create":{const m=qG(c.webauthn.credential_options.publicKey,l==null?void 0:l.create),{data:x,error:y}=await FG({publicKey:m,signal:f});return x?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:x}},error:null}:{data:null,error:y}}case"request":{const m=HG(c.webauthn.credential_options.publicKey,l==null?void 0:l.request),{data:x,error:y}=await $G(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:m,signal:f}));return x?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:x}},error:null}:{data:null,error:y}}}}catch(c){return Ze(c)?{data:null,error:c}:{data:null,error:new sc("Unexpected error in challenge",c)}}}async _verify({challengeId:e,factorId:t,webauthn:n}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},l){if(!t)return{data:null,error:new gm("rpId is required for WebAuthn authentication")};try{if(!E5())return{data:null,error:new sc("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:n},signal:a},{request:l});if(!c)return{data:null,error:d};const{webauthn:f}=c;return this._verify({factorId:e,challengeId:c.challengeId,webauthn:{type:f.type,rpId:t,rpOrigins:n,credential_response:f.credential_response}})}catch(c){return Ze(c)?{data:null,error:c}:{data:null,error:new sc("Unexpected error in authenticate",c)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},l){if(!t)return{data:null,error:new gm("rpId is required for WebAuthn registration")};try{if(!E5())return{data:null,error:new sc("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this._enroll({friendlyName:e});if(!c)return await this.client.mfa.listFactors().then(x=>{var y;return(y=x.data)===null||y===void 0?void 0:y.all.find(w=>w.factor_type==="webauthn"&&w.friendly_name===e&&w.status!=="unverified")}).then(x=>x?this.client.mfa.unenroll({factorId:x==null?void 0:x.id}):void 0),{data:null,error:d};const{data:f,error:m}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:t,rpOrigins:n},signal:a},{create:l});return f?this._verify({factorId:c.id,challengeId:f.challengeId,webauthn:{rpId:t,rpOrigins:n,type:f.webauthn.type,credential_response:f.webauthn.credential_response}}):{data:null,error:m}}catch(c){return Ze(c)?{data:null,error:c}:{data:null,error:new sc("Unexpected error in register",c)}}}}IG();const WG={url:BH,storageKey:zH,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:qH,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function I5(s,e,t){return await t()}const Bu={};class pm{get jwks(){var e,t;return(t=(e=Bu[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Bu[this.storageKey]=Object.assign(Object.assign({},Bu[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Bu[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Bu[this.storageKey]=Object.assign(Object.assign({},Bu[this.storageKey]),{cachedAt:e})}constructor(e){var t,n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},WG),e);if(this.storageKey=l.storageKey,this.instanceID=(t=pm.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,pm.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&xn()){const c=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(c),this.logDebugMessages&&console.trace(c)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new SG({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=NR(l.fetch),this.lock=l.lock||I5,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,this.lockAcquireTimeout=l.lockAcquireTimeout,l.lock?this.lock=l.lock:this.persistSession&&xn()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=EG:this.lock=I5,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new GG(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:jR()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=T5(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=T5(this.memoryStorage)),xn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${wR}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},n="none";if(xn()&&(t=aG(window.location.href),this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce")),xn()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:l}=await this._getSessionFromURL(t,n);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),YH(l)){const f=(e=l.details)===null||e===void 0?void 0:e.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:l}}return{error:l}}const{session:c,redirectType:d}=a;return this._debug("#_initialize()","detected session in URL",c,"redirect type",d),await this._saveSession(c),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ze(t)?this._returnResult({error:t}):this._returnResult({error:new sc("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,a;try{const l=await lt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:ua}),{data:c,error:d}=l;if(d||!c)return this._returnResult({data:{user:null,session:null},error:d});const f=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:m,session:f},error:null})}catch(l){if(Ze(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(e){var t,n,a;try{let l;if("email"in e){const{email:x,password:y,options:w}=e;let v=null,T=null;this.flowType==="pkce"&&([v,T]=await Uu(this.storage,this.storageKey)),l=await lt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:w==null?void 0:w.emailRedirectTo,body:{email:x,password:y,data:(t=w==null?void 0:w.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:w==null?void 0:w.captchaToken},code_challenge:v,code_challenge_method:T},xform:ua})}else if("phone"in e){const{phone:x,password:y,options:w}=e;l=await lt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:x,password:y,data:(n=w==null?void 0:w.data)!==null&&n!==void 0?n:{},channel:(a=w==null?void 0:w.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:w==null?void 0:w.captchaToken}},xform:ua})}else throw new Ep("You must provide either an email or phone number and a password");const{data:c,error:d}=l;if(d||!c)return await pn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:d});const f=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:m,session:f},error:null})}catch(l){if(await pn(this.storage,`${this.storageKey}-code-verifier`),Ze(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(e){try{let t;if("email"in e){const{email:l,password:c,options:d}=e;t=await lt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:N5})}else if("phone"in e){const{phone:l,password:c,options:d}=e;t=await lt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:N5})}else throw new Ep("You must provide either an email or phone number and a password");const{data:n,error:a}=t;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const l=new Vu;return this._returnResult({data:{user:null,session:null},error:l})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(t){if(Ze(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,n,a,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,n,a,l,c,d,f,m,x,y,w;let v,T;if("message"in e)v=e.message,T=e.signature;else{const{chain:I,wallet:N,statement:P,options:U}=e;let V;if(xn())if(typeof N=="object")V=N;else{const B=window;if("ethereum"in B&&typeof B.ethereum=="object"&&"request"in B.ethereum&&typeof B.ethereum.request=="function")V=B.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!(U!=null&&U.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");V=N}const q=new URL((t=U==null?void 0:U.url)!==null&&t!==void 0?t:window.location.href),W=await V.request({method:"eth_requestAccounts"}).then(B=>B).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!W||W.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const z=TR(W[0]);let k=(n=U==null?void 0:U.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!k){const B=await V.request({method:"eth_chainId"});k=AG(B)}const M={domain:q.host,address:z,statement:P,uri:q.href,version:"1",chainId:k,nonce:(a=U==null?void 0:U.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(c=(l=U==null?void 0:U.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(d=U==null?void 0:U.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(f=U==null?void 0:U.signInWithEthereum)===null||f===void 0?void 0:f.notBefore,requestId:(m=U==null?void 0:U.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(x=U==null?void 0:U.signInWithEthereum)===null||x===void 0?void 0:x.resources};v=CG(M),T=await V.request({method:"personal_sign",params:[kG(v),z]})}try{const{data:I,error:N}=await lt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:T},!((y=e.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(w=e.options)===null||w===void 0?void 0:w.captchaToken}}:null),xform:ua});if(N)throw N;if(!I||!I.session||!I.user){const P=new Vu;return this._returnResult({data:{user:null,session:null},error:P})}return I.session&&(await this._saveSession(I.session),await this._notifyAllSubscribers("SIGNED_IN",I.session)),this._returnResult({data:Object.assign({},I),error:N})}catch(I){if(Ze(I))return this._returnResult({data:{user:null,session:null},error:I});throw I}}async signInWithSolana(e){var t,n,a,l,c,d,f,m,x,y,w,v;let T,I;if("message"in e)T=e.message,I=e.signature;else{const{chain:N,wallet:P,statement:U,options:V}=e;let q;if(xn())if(typeof P=="object")q=P;else{const z=window;if("solana"in z&&typeof z.solana=="object"&&("signIn"in z.solana&&typeof z.solana.signIn=="function"||"signMessage"in z.solana&&typeof z.solana.signMessage=="function"))q=z.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof P!="object"||!(V!=null&&V.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");q=P}const W=new URL((t=V==null?void 0:V.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in q&&q.signIn){const z=await q.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},V==null?void 0:V.signInWithSolana),{version:"1",domain:W.host,uri:W.href}),U?{statement:U}:null));let k;if(Array.isArray(z)&&z[0]&&typeof z[0]=="object")k=z[0];else if(z&&typeof z=="object"&&"signedMessage"in z&&"signature"in z)k=z;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)T=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),I=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in q)||typeof q.signMessage!="function"||!("publicKey"in q)||typeof q!="object"||!q.publicKey||!("toBase58"in q.publicKey)||typeof q.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");T=[`${W.host} wants you to sign in with your Solana account:`,q.publicKey.toBase58(),...U?["",U,""]:[""],"Version: 1",`URI: ${W.href}`,`Issued At: ${(a=(n=V==null?void 0:V.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((l=V==null?void 0:V.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${V.signInWithSolana.notBefore}`]:[],...!((c=V==null?void 0:V.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${V.signInWithSolana.expirationTime}`]:[],...!((d=V==null?void 0:V.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${V.signInWithSolana.chainId}`]:[],...!((f=V==null?void 0:V.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${V.signInWithSolana.nonce}`]:[],...!((m=V==null?void 0:V.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${V.signInWithSolana.requestId}`]:[],...!((y=(x=V==null?void 0:V.signInWithSolana)===null||x===void 0?void 0:x.resources)===null||y===void 0)&&y.length?["Resources",...V.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const z=await q.signMessage(new TextEncoder().encode(T),"utf8");if(!z||!(z instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");I=z}}try{const{data:N,error:P}=await lt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:T,signature:lc(I)},!((w=e.options)===null||w===void 0)&&w.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:ua});if(P)throw P;if(!N||!N.session||!N.user){const U=new Vu;return this._returnResult({data:{user:null,session:null},error:U})}return N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),this._returnResult({data:Object.assign({},N),error:P})}catch(N){if(Ze(N))return this._returnResult({data:{user:null,session:null},error:N});throw N}}async _exchangeCodeForSession(e){const t=await Hl(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(t??"").split("/");try{if(!n&&this.flowType==="pkce")throw new JH;const{data:l,error:c}=await lt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:ua});if(await pn(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!l||!l.session||!l.user){const d=new Vu;return this._returnResult({data:{user:null,session:null,redirectType:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:c})}catch(l){if(await pn(this.storage,`${this.storageKey}-code-verifier`),Ze(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(e){try{const{options:t,provider:n,token:a,access_token:l,nonce:c}=e,d=await lt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:ua}),{data:f,error:m}=d;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!f||!f.session||!f.user){const x=new Vu;return this._returnResult({data:{user:null,session:null},error:x})}return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),this._returnResult({data:f,error:m})}catch(t){if(Ze(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,n,a,l,c;try{if("email"in e){const{email:d,options:f}=e;let m=null,x=null;this.flowType==="pkce"&&([m,x]=await Uu(this.storage,this.storageKey));const{error:y}=await lt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},create_user:(n=f==null?void 0:f.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:m,code_challenge_method:x},redirectTo:f==null?void 0:f.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:y})}if("phone"in e){const{phone:d,options:f}=e,{data:m,error:x}=await lt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(a=f==null?void 0:f.data)!==null&&a!==void 0?a:{},create_user:(l=f==null?void 0:f.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},channel:(c=f==null?void 0:f.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:x})}throw new Ep("You must provide either an email or phone number.")}catch(d){if(await pn(this.storage,`${this.storageKey}-code-verifier`),Ze(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async verifyOtp(e){var t,n;try{let a,l;"options"in e&&(a=(t=e.options)===null||t===void 0?void 0:t.redirectTo,l=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:c,error:d}=await lt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:ua});if(d)throw d;if(!c)throw new Error("An error occurred on token verification.");const f=c.session,m=c.user;return f!=null&&f.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),this._returnResult({data:{user:m,session:f},error:null})}catch(a){if(Ze(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(e){var t,n,a,l,c;try{let d=null,f=null;this.flowType==="pkce"&&([d,f]=await Uu(this.storage,this.storageKey));const m=await lt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:d,code_challenge_method:f}),headers:this.headers,xform:_G});return!((l=m.data)===null||l===void 0)&&l.url&&xn()&&!(!((c=e.options)===null||c===void 0)&&c.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(d){if(await pn(this.storage,`${this.storageKey}-code-verifier`),Ze(d))return this._returnResult({data:null,error:d});throw d}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new jr;const{error:a}=await lt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(e){if(Ze(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:a,options:l}=e,{error:c}=await lt(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in e){const{phone:n,type:a,options:l}=e,{data:c,error:d}=await lt(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d})}throw new Ep("You must provide either an email or phone number and a type")}catch(t){if(Ze(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Hl(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<dw:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const c=await Hl(this.userStorage,this.storageKey+"-user");c!=null&&c.user?e.user=c.user:e.user=mw()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};e.user=bG(e.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await lt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Fo}):await this._useSession(async t=>{var n,a,l;const{data:c,error:d}=t;if(d)throw d;return!(!((n=c.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new jr}:await lt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:Fo})})}catch(t){if(Ze(t))return QH(t)&&(await this._removeSession(),await pn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:a,error:l}=n;if(l)throw l;if(!a.session)throw new jr;const c=a.session;let d=null,f=null;this.flowType==="pkce"&&e.email!=null&&([d,f]=await Uu(this.storage,this.storageKey));const{data:m,error:x}=await lt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:d,code_challenge_method:f}),jwt:c.access_token,xform:Fo});if(x)throw x;return c.user=m.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(n){if(await pn(this.storage,`${this.storageKey}-code-verifier`),Ze(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new jr;const t=Date.now()/1e3;let n=t,a=!0,l=null;const{payload:c}=fw(e.access_token);if(c.exp&&(n=c.exp,a=n<=t),a){const{data:d,error:f}=await this._callRefreshToken(e.refresh_token);if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:f}=await this._getUser(e.access_token);if(f)throw f;l={access_token:e.access_token,refresh_token:e.refresh_token,user:d.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(t){if(Ze(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:c,error:d}=t;if(d)throw d;e=(n=c.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new jr;const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(Ze(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!xn())throw new Ip("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ip(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new x5("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ip("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new x5("No code detected.");const{data:U,error:V}=await this._exchangeCodeForSession(e.code);if(V)throw V;const q=new URL(window.location.href);return q.searchParams.delete("code"),window.history.replaceState(window.history.state,"",q.toString()),{data:{session:U.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:l,refresh_token:c,expires_in:d,expires_at:f,token_type:m}=e;if(!l||!d||!c||!m)throw new Ip("No session defined in URL");const x=Math.round(Date.now()/1e3),y=parseInt(d);let w=x+y;f&&(w=parseInt(f));const v=w-x;v*1e3<=Xu&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${y}s`);const T=w-y;x-T>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",T,w,x):x-T<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",T,w,x);const{data:I,error:N}=await this._getUser(l);if(N)throw N;const P={provider_token:n,provider_refresh_token:a,access_token:l,expires_in:y,expires_at:w,refresh_token:c,token_type:m,user:I.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:P,redirectType:e.type},error:null})}catch(n){if(Ze(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Hl(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:a,error:l}=t;if(l)return this._returnResult({error:l});const c=(n=a.session)===null||n===void 0?void 0:n.access_token;if(c){const{error:d}=await this.admin.signOut(c,e);if(d&&!(KH(d)&&(d.status===404||d.status===401||d.status===403)))return this._returnResult({error:d})}return e!=="others"&&(await this._removeSession(),await pn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=rG(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,a;try{const{data:{session:l},error:c}=t;if(c)throw c;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,t={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Uu(this.storage,this.storageKey,!0));try{return await lt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(await pn(this.storage,`${this.storageKey}-code-verifier`),Ze(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(Ze(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:n,error:a}=await this._useSession(async l=>{var c,d,f,m,x;const{data:y,error:w}=l;if(w)throw w;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(d=e.options)===null||d===void 0?void 0:d.scopes,queryParams:(f=e.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await lt(this.fetch,"GET",v,{headers:this.headers,jwt:(x=(m=y.session)===null||m===void 0?void 0:m.access_token)!==null&&x!==void 0?x:void 0})});if(a)throw a;return xn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:e.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Ze(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var n;try{const{error:a,data:{session:l}}=t;if(a)throw a;const{options:c,provider:d,token:f,access_token:m,nonce:x}=e,y=await lt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=l==null?void 0:l.access_token)!==null&&n!==void 0?n:void 0,body:{provider:d,id_token:f,access_token:m,nonce:x,link_identity:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:ua}),{data:w,error:v}=y;return v?this._returnResult({data:{user:null,session:null},error:v}):!w||!w.session||!w.user?this._returnResult({data:{user:null,session:null},error:new Vu}):(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("USER_UPDATED",w.session)),this._returnResult({data:w,error:v}))}catch(a){if(await pn(this.storage,`${this.storageKey}-code-verifier`),Ze(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,a;const{data:l,error:c}=t;if(c)throw c;return await lt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(Ze(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await lG(async a=>(a>0&&await oG(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await lt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ua})),(a,l)=>{const c=200*Math.pow(2,a);return l&&hw(l)&&Date.now()+c-n<Xu})}catch(n){if(this._debug(t,"error",n),Ze(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),xn()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Hl(this.storage,this.storageKey);if(a&&this.userStorage){let c=await Hl(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:a.user},await Zu(this.userStorage,this.storageKey+"-user",c)),a.user=(e=c==null?void 0:c.user)!==null&&e!==void 0?e:mw()}else if(a&&!a.user&&!a.user){const c=await Hl(this.storage,this.storageKey+"-user");c&&(c!=null&&c.user)?(a.user=c.user,await pn(this.storage,this.storageKey+"-user"),await Zu(this.storage,this.storageKey,a)):a.user=mw()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const l=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<dw;if(this._debug(n,`session has${l?"":" not"} expired with margin of ${dw}s`),l){if(this.autoRefreshToken&&a.refresh_token){const{error:c}=await this._callRefreshToken(a.refresh_token);c&&(console.error(c),hw(c)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:d}=await this._getUser(a.access_token);!d&&(c!=null&&c.user)?(a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(n,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new jr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Sx;const{data:l,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!l.session)throw new jr;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={data:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(a,"error",l),Ze(l)){const c={data:null,error:l};return hw(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t,n=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(e,t)}catch(f){l.push(f)}});if(await Promise.all(c),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await pn(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await Zu(this.userStorage,this.storageKey+"-user",{user:t.user});const a=Object.assign({},t);delete a.user;const l=_5(a);await Zu(this.storage,this.storageKey,l)}else{const a=_5(t);await Zu(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await pn(this.storage,this.storageKey),await pn(this.storage,this.storageKey+"-code-verifier"),await pn(this.storage,this.storageKey+"-user"),this.userStorage&&await pn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&xn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Xu);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-e)/Xu);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Xu}ms, refresh threshold is ${vv} ticks`),a<=vv&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof SR)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!xn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const a=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[l,c]=await Uu(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});a.push(d.toString())}if(n!=null&&n.queryParams){const l=new URLSearchParams(n.queryParams);a.push(l.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:a,error:l}=t;return l?this._returnResult({data:null,error:l}):await lt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(Ze(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,a;const{data:l,error:c}=t;if(c)return this._returnResult({data:null,error:c});const d=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:f,error:m}=await lt(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(n=l==null?void 0:l.session)===null||n===void 0?void 0:n.access_token});return m?this._returnResult({data:null,error:m}):(e.factorType==="totp"&&f.type==="totp"&&(!((a=f==null?void 0:f.totp)===null||a===void 0)&&a.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),this._returnResult({data:f,error:null}))})}catch(t){if(Ze(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:l}=t;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?VG(e.webauthn.credential_response):UG(e.webauthn.credential_response)})}:{code:e.code}),{data:d,error:f}=await lt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:c,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return f?this._returnResult({data:null,error:f}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),this._returnResult({data:d,error:f}))})}catch(t){if(Ze(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:l}=t;if(l)return this._returnResult({data:null,error:l});const c=await lt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});if(c.error)return c;const{data:d}=c;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:MG(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:LG(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(Ze(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const l of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])a.all.push(l),l.status==="verified"&&a[l.factor_type].push(l);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:n},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=fw(n.access_token);let c=null;l.aal&&(c=l.aal);let d=c;((t=(e=n.user.factors)===null||e===void 0?void 0:e.filter(x=>x.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(d="aal2");const m=l.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:m},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:n},error:a}=t;return a?this._returnResult({data:null,error:a}):n?await lt(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new jr})})}catch(t){if(Ze(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:a},error:l}=n;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new jr});const c=await lt(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:d=>({data:d,error:null})});return c.data&&c.data.redirect_url&&xn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(n){if(Ze(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:a},error:l}=n;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new jr});const c=await lt(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:d=>({data:d,error:null})});return c.data&&c.data.redirect_url&&xn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(n){if(Ze(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;return n?this._returnResult({data:null,error:n}):t?await lt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new jr})})}catch(e){if(Ze(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:n},error:a}=t;return a?this._returnResult({data:null,error:a}):n?(await lt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new jr})})}catch(t){if(Ze(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(d=>d.kid===e);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(d=>d.kid===e),n&&this.jwks_cached_at+GH>a)return n;const{data:l,error:c}=await lt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=a,n=l.keys.find(d=>d.kid===e),!n)?null:n}async getClaims(e,t={}){try{let n=e;if(!n){const{data:v,error:T}=await this.getSession();if(T||!v.session)return this._returnResult({data:null,error:T});n=v.session.access_token}const{header:a,payload:l,signature:c,raw:{header:d,payload:f}}=fw(n);t!=null&&t.allowExpired||gG(l.exp);const m=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!m){const{error:v}=await this.getUser(n);if(v)throw v;return{data:{claims:l,header:a,signature:c},error:null}}const x=pG(a.alg),y=await crypto.subtle.importKey("jwk",m,x,!0,["verify"]);if(!await crypto.subtle.verify(x,y,c,sG(`${d}.${f}`)))throw new Nv("Invalid JWT signature");return{data:{claims:l,header:a,signature:c},error:null}}catch(n){if(Ze(n))return this._returnResult({data:null,error:n});throw n}}}pm.nextInstanceID={};const KG=pm,QG="2.90.1";let _f="";typeof Deno<"u"?_f="deno":typeof document<"u"?_f="web":typeof navigator<"u"&&navigator.product==="ReactNative"?_f="react-native":_f="node";const YG={"X-Client-Info":`supabase-js-${_f}/${QG}`},JG={headers:YG},XG={schema:"public"},ZG={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},eW={};function xm(s){"@babel/helpers - typeof";return xm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xm(s)}function tW(s,e){if(xm(s)!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e);if(xm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function sW(s){var e=tW(s,"string");return xm(e)=="symbol"?e:e+""}function nW(s,e,t){return(e=sW(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function A5(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),t.push.apply(t,n)}return t}function vs(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?A5(Object(t),!0).forEach(function(n){nW(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):A5(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}const rW=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),aW=()=>Headers,iW=(s,e,t)=>{const n=rW(t),a=aW();return async(l,c)=>{var d;const f=(d=await e())!==null&&d!==void 0?d:s;let m=new a(c==null?void 0:c.headers);return m.has("apikey")||m.set("apikey",s),m.has("Authorization")||m.set("Authorization",`Bearer ${f}`),n(l,vs(vs({},c),{},{headers:m}))}};function oW(s){return s.endsWith("/")?s:s+"/"}function lW(s,e){var t,n;const{db:a,auth:l,realtime:c,global:d}=s,{db:f,auth:m,realtime:x,global:y}=e,w={db:vs(vs({},f),a),auth:vs(vs({},m),l),realtime:vs(vs({},x),c),storage:{},global:vs(vs(vs({},y),d),{},{headers:vs(vs({},(t=y==null?void 0:y.headers)!==null&&t!==void 0?t:{}),(n=d==null?void 0:d.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return s.accessToken?w.accessToken=s.accessToken:delete w.accessToken,w}function cW(s){const e=s==null?void 0:s.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(oW(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var uW=class extends KG{constructor(s){super(s)}},dW=class{constructor(s,e,t){var n,a;this.supabaseUrl=s,this.supabaseKey=e;const l=cW(s);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:XG,realtime:eW,auth:vs(vs({},ZG),{},{storageKey:c}),global:JG},f=lW(t??{},d);if(this.storageKey=(n=f.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=f.global.headers)!==null&&a!==void 0?a:{},f.accessToken)this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(x,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}});else{var m;this.auth=this._initSupabaseAuthClient((m=f.auth)!==null&&m!==void 0?m:{},this.headers,f.global.fetch)}this.fetch=iW(e,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(vs({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.accessToken&&this.accessToken().then(x=>this.realtime.setAuth(x)).catch(x=>console.warn("Failed to set initial Realtime auth token:",x)),this.rest=new qq(new URL("rest/v1",l).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new $H(this.storageUrl.href,this.headers,this.fetch,t==null?void 0:t.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new Uq(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(s){return this.rest.from(s)}schema(s){return this.rest.schema(s)}rpc(s,e={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(s,e,t)}channel(s,e={config:{}}){return this.realtime.channel(s,e)}getChannels(){return this.realtime.getChannels()}removeChannel(s){return this.realtime.removeChannel(s)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var s=this,e,t;if(s.accessToken)return await s.accessToken();const{data:n}=await s.auth.getSession();return(e=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:s.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:s,persistSession:e,detectSessionInUrl:t,storage:n,userStorage:a,storageKey:l,flowType:c,lock:d,debug:f,throwOnError:m},x,y){const w={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new uW({url:this.authUrl.href,headers:vs(vs({},w),x),storageKey:l,autoRefreshToken:s,persistSession:e,detectSessionInUrl:t,storage:n,userStorage:a,flowType:c,lock:d,debug:f,throwOnError:m,fetch:y,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(s){return new oH(this.realtimeUrl.href,vs(vs({},s),{},{params:vs(vs({},{apikey:this.supabaseKey}),s==null?void 0:s.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,e)=>{this._handleTokenChanged(s,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(s,e,t){(s==="TOKEN_REFRESHED"||s==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):s==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const hW=(s,e,t)=>new dW(s,e,t);function fW(){if(typeof window<"u")return!1;const s=globalThis.process;if(!s)return!1;const e=s.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}fW()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");let Ld=null;const mW=s=>{if(s===null||typeof s!="object"||Array.isArray(s))return s;const e={};for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)){const n=t.replace(/[A-Z]/g,a=>`_${a.toLowerCase()}`);e[n]=s[t]}return e},gW=(s,e)=>{try{return!s||!s.startsWith("http")?(console.error("Invalid Supabase URL: Must start with http or https"),!1):e?(Ld=hW(s,e,{auth:{persistSession:!0,autoRefreshToken:!0},db:{schema:"public"}}),console.log("Supabase initialized successfully"),!0):(console.error("Supabase Key missing"),!1)}catch(t){return console.error("Error initializing Supabase:",t),!1}},pW=async()=>{if(!Ld)return{success:!1,error:"    (Not Initialized)"};try{const{error:s}=await Ld.from("users").select("id").limit(1);return s?s.code==="42P01"?{success:!1,error:" :  'users'  .    SQL   ."}:s.code==="42501"||s.message.includes("security policy")?{success:!1,error:" :       (RLS).    SQL  RLS."}:s.message.toLowerCase().includes("invalid api key")?{success:!1,error:" :  API  .     'anon' ."}:{success:!1,error:` : ${s.message}`}:{success:!0}}catch(s){let e=s.message||"";return e.includes("Failed to fetch")&&(e=" :     (URL)   ."),{success:!1,error:e}}},Sv=(s,e=new WeakSet)=>{if(s===null||typeof s!="object")return typeof s>"u"?null:s;if(s instanceof Date)return s.toISOString();if(e.has(s))return null;if(e.add(s),Array.isArray(s))return s.map(a=>Sv(a,e));if(s.nodeType&&typeof s.nodeType=="number"||s._reactInternals||s._reactFiber||s.nativeEvent&&s.target)return null;const t=s.constructor?s.constructor.name:"";if(t&&(t.includes("HTML")||t.includes("Element")||t.includes("Node")||t.includes("Event")))return null;const n={};for(const a in s)if(Object.prototype.hasOwnProperty.call(s,a)){const l=s[a];if(["source","target","currentTarget","_owner","_store","view","nativeEvent"].includes(a))continue;l!==void 0&&(n[a]=Sv(l,e))}return n},xW=async(s,e)=>{if(!Ld)throw new Error("Supabase not initialized");if(e.length!==0)try{const t=e.map(a=>mW(Sv(a))),n=500;for(let a=0;a<t.length;a+=n){const l=t.slice(a,a+n),{error:c}=await Ld.from(s).upsert(l,{onConflict:"id"});if(c)throw c}console.log(` Successfully batched ${e.length} items to ${s} (Supabase)`)}catch(t){throw console.error(` Batch save failed for ${s}:`,t.message||JSON.stringify(t)),t}},bW=async(s,e)=>{var t;if(!Ld)throw new Error("Supabase not initialized");if(!(!e||e.length===0))try{console.log(`Syncing ${e.length} items to ${s}...`),await xW(s,e),console.log(`Sync for ${s} completed.`)}catch(n){throw console.error(`Error migrating ${s}:`,n.message||n),n.code==="42P01"?new Error(`     '${s}'.    SQL  Supabase.`):n.code==="42501"||(t=n.message)!=null&&t.includes("row-level security")?new Error(`   (RLS)  '${s}'.     SQL      RLS.`):new Error(`Migration failed for ${s}: ${n.message||JSON.stringify(n)}`)}},yW=s=>{try{return localStorage.getItem(s)}catch(e){return console.warn(`Failed to get item ${s}:`,e),null}},df=(s,e)=>{try{localStorage.setItem(s,e)}catch(t){console.warn(`Failed to set item ${s}:`,t)}},wW=s=>{try{localStorage.removeItem(s)}catch(e){console.warn(`Failed to remove item ${s}:`,e)}},k5=`
/* 
   ===================================================================
   GOO NOW - Database Schema & Repair Script
   ===================================================================
*/

-- 1. Create Tables (If Not Exists)
create table if not exists users (
  id text primary key, 
  name text, 
  role text, 
  password text, 
  status text, 
  phone text, 
  created_at timestamp with time zone, 
  commission_rate numeric, 
  commission_type text, 
  daily_log_status text, 
  incentives_active boolean, 
  permissions jsonb, 
  daily_log_mode text, 
  daily_log_started_at timestamp with time zone,
  address text,
  addresses jsonb,
  store_name text,
  store_image text,
  store_category text,
  working_hours jsonb,
  has_free_delivery boolean,
  response_time text,
  email text,
  fcm_token text,
  max_concurrent_orders numeric,
  appointed_by text,
  products jsonb,
  points_balance numeric
);

create table if not exists orders (
  id text primary key, 
  customer jsonb, 
  created_at timestamp with time zone, 
  status text, 
  notes text, 
  driver_id text, 
  merchant_id text, 
  merchant_name text, 
  delivery_fee numeric, 
  delivered_at timestamp with time zone, 
  reconciled boolean,
  type text,
  items jsonb,
  total_price numeric
);

create table if not exists messages (id text primary key, text text, image text, target_role text, target_id text, created_at timestamp with time zone, read_by jsonb, deleted_by jsonb);
create table if not exists payments (id text primary key, driver_id text, amount numeric, created_at timestamp with time zone, reconciled_order_ids jsonb);
create table if not exists reset_requests (phone text primary key, requested_at timestamp with time zone);
create table if not exists notifications (id serial primary key, type text, order_id text, merchant_name text, customer_address text, target_role text, created_at timestamp with time zone, body text, target_id text);
create table if not exists slider_images (id text primary key, url text, active boolean, created_at timestamp with time zone, linked_merchant_id text, linked_category_id text);
create table if not exists settings (id text primary key, is_enabled boolean, theme_config jsonb, points_config jsonb, app_name text, app_version text, support_config jsonb, update_config jsonb);

-- NEW TABLES FOR LOYALTY & AUDIT
create table if not exists audit_logs (id text primary key, actor_id text, actor_name text, action_type text, target text, details text, created_at timestamp with time zone);
create table if not exists promo_codes (id text primary key, code text, type text, value numeric, is_active boolean, expiry_date timestamp with time zone, usage_count numeric, max_usage numeric);
create table if not exists support_chats (id text primary key, user_id text, user_name text, user_phone text, last_message text, last_updated timestamp with time zone, unread_count numeric, messages jsonb);

-- 2. Add Missing Columns
do $$ 
begin 
  if not exists (select 1 from information_schema.columns where table_name='users' and column_name='points_balance') then alter table users add column points_balance numeric; end if;
  if not exists (select 1 from information_schema.columns where table_name='settings' and column_name='points_config') then alter table settings add column points_config jsonb; end if;
  if not exists (select 1 from information_schema.columns where table_name='settings' and column_name='app_name') then alter table settings add column app_name text; end if;
  if not exists (select 1 from information_schema.columns where table_name='settings' and column_name='app_version') then alter table settings add column app_version text; end if;
  if not exists (select 1 from information_schema.columns where table_name='messages' and column_name='deleted_by') then alter table messages add column deleted_by jsonb; end if;
  if not exists (select 1 from information_schema.columns where table_name='settings' and column_name='update_config') then alter table settings add column update_config jsonb; end if;
end $$;

-- 3. Enable Replication
alter table users replica identity full;
alter table orders replica identity full;
alter table messages replica identity full;
alter table payments replica identity full;
alter table reset_requests replica identity full;
alter table notifications replica identity full;
alter table slider_images replica identity full;
alter table settings replica identity full;
alter table audit_logs replica identity full;
alter table promo_codes replica identity full;
alter table support_chats replica identity full;

-- 4. Publication
begin;
  drop publication if exists supabase_realtime;
  create publication supabase_realtime for all tables;
commit;

-- 5. Disable RLS
alter table users disable row level security;
alter table orders disable row level security;
alter table messages disable row level security;
alter table payments disable row level security;
alter table reset_requests disable row level security;
alter table notifications disable row level security;
alter table slider_images disable row level security;
alter table settings disable row level security;
alter table audit_logs disable row level security;
alter table promo_codes disable row level security;
alter table support_chats disable row level security;
`,vW=({onClose:s})=>{const[e,t]=j.useState(!1),n=()=>{navigator.clipboard.writeText(k5),t(!0),setTimeout(()=>t(!1),2e3)};return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50 p-4",onClick:s,children:r.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl text-white flex flex-col max-h-[90vh]",onClick:a=>a.stopPropagation(),children:[r.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[r.jsx("h3",{className:"text-lg font-bold text-green-400",children:"   (SQL Repair)"}),r.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:r.jsx(rt,{className:"w-6 h-6"})})]}),r.jsxs("div",{className:"p-4 overflow-y-auto bg-gray-900 font-mono text-sm text-gray-300",children:[r.jsxs("div",{className:"mb-4 text-gray-400 font-sans",children:[r.jsxs("div",{className:"p-3 bg-yellow-500/10 border border-yellow-500/30 rounded mb-3 text-yellow-200",children:[r.jsx("strong",{children:" :"}),"         ."]}),r.jsxs("ol",{className:"list-decimal list-inside space-y-2",children:[r.jsx("li",{children:"  ."}),r.jsxs("li",{children:["  ",r.jsx("a",{href:"https://supabase.com/dashboard",target:"_blank",rel:"noreferrer",className:"text-blue-400 underline hover:text-blue-300",children:"Supabase SQL Editor"}),"."]}),r.jsxs("li",{children:["   ",r.jsx("strong",{children:"Run"}),"."]}),r.jsx("li",{children:'    "Success".'})]})]}),r.jsx("pre",{className:"p-4 bg-black rounded border border-gray-700 whitespace-pre-wrap select-all",children:k5})]}),r.jsxs("div",{className:"p-4 border-t border-gray-700 bg-gray-800 flex justify-end gap-2 rounded-b-lg",children:[r.jsxs("button",{onClick:n,className:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors font-bold shadow-lg",children:[e?r.jsx(nt,{className:"w-5 h-5 mr-2"}):r.jsx(Wn,{className:"w-5 h-5 mr-2"}),e?" !":"  "]}),r.jsx("button",{onClick:s,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-md transition-colors",children:""})]})]})})},_W=({onSuccess:s,onDisconnect:e,appConfig:t,onUpdateAppConfig:n})=>{const[a,l]=j.useState("firebase"),[c,d]=j.useState(null),[f,m]=j.useState((t==null?void 0:t.appName)||"GOO NOW"),[x,y]=j.useState((t==null?void 0:t.appVersion)||"VERSION 1.0.5"),[w,v]=j.useState(!1),[T,I]=j.useState(""),[N,P]=j.useState(""),[U,V]=j.useState(""),[q,W]=j.useState("idle"),[z,k]=j.useState(""),[M,B]=j.useState(!1),[D,S]=j.useState(!1),[F,E]=j.useState(""),[Y,X]=j.useState(""),[R,J]=j.useState(""),[O,K]=j.useState("apk"),[Q,L]=j.useState(""),[G,ee]=j.useState(!1),[ne,je]=j.useState(!1),[se,_e]=j.useState(0),[Te,be]=j.useState(!1),[ye,et]=j.useState(!1),[Je,bt]=j.useState(!1),yt=j.useRef(null),[Ae,fe]=j.useState([]);j.useEffect(()=>{let Se;return c==="firebase"&&(Se=qn("update_history",Fe=>{const it=Fe.sort((at,Gt)=>{const Ks=at.releaseDate?new Date(at.releaseDate).getTime():0;return(Gt.releaseDate?new Date(Gt.releaseDate).getTime():0)-Ks});fe(it)})),()=>{Se&&Se()}},[c]);const $e=j.useRef(null);j.useEffect(()=>{t&&(m(t.appName),y(t.appVersion))},[t]),Ht(()=>Te?(be(!1),!0):Je?(bt(!1),!0):ye?(et(!1),!0):!1,[Je,ye,Te]);const ce=Se=>{try{window.history.pushState({view:"settings",modal:Se},"",window.location.pathname)}catch{}},Oe=()=>{var Se;(Se=window.history.state)!=null&&Se.modal?window.history.back():(et(!1),bt(!1))};j.useEffect(()=>{const Se=Fe=>{var it;(it=Fe.state)!=null&&it.modal||(et(!1),bt(!1))};return window.addEventListener("popstate",Se),()=>window.removeEventListener("popstate",Se)},[]);const Pe=()=>{!f.trim()||!x.trim()||(v(!0),n&&n({appName:f,appVersion:x}),setTimeout(()=>v(!1),1e3))},Ge=async Se=>{var it;const Fe=(it=Se.target.files)==null?void 0:it[0];if(Fe){if(!Fe.name.endsWith(".apk")){Le("    .apk","error");return}je(!0),_e(0);try{const at=await Pq(Fe,"app_updates",Gt=>{_e(Math.round(Gt))});J(at),K("apk")}catch(at){console.error("APK Upload Error:",at),Le(`  . : ${at.message||"  "}`,"error")}finally{je(!1),_e(0),$e.current&&($e.current.value="")}}},[Ke,Ie]=j.useState(null),Le=(Se,Fe="info",it,at)=>{Ie({message:Se,type:Fe,isLink:it,url:at}),setTimeout(()=>Ie(null),4e3)},Lt=async()=>{if(!Y||!R)return;ee(!0),be(!1);const Se={id:`UPDATE-${Date.now()}`,version:Y,url:R,type:O,description:Q,isActive:!0,releaseDate:new Date};try{await ut("settings","app_update",Se),await ut("update_history",Se.id,Se);const it=["driver","merchant","customer","supervisor"].map(at=>Jt(at,{title:`   ${Y}`,body:Q||"        .  .",url:R}));await Promise.all(it),ee(!1),Le("      !","success"),X(""),J(""),L("")}catch(Fe){console.error("Failed to push update:",Fe),ee(!1),Le("    .","error")}},bs=async()=>{try{await ut("settings","app_update",{isActive:!1,id:null,url:null,version:null}),X(""),J(""),L(""),Le("   .        .","success")}catch(Se){console.error("Failed to delete update:",Se),Le("  .","error")}},Zt=f||"GOO NOW",[Ws,...Ds]=Zt.split(" "),En=Ds.join(" "),hr=()=>Ke?r.jsx("div",{className:"fixed top-5 left-1/2 transform -translate-x-1/2 z-[200] animate-slide-down",children:r.jsxs("div",{className:`px-6 py-4 rounded-2xl shadow-2xl flex items-center gap-4 min-w-[320px] max-w-md backdrop-blur-md border ${Ke.type==="success"?"bg-green-900/90 border-green-500/50 text-green-100":Ke.type==="error"?"bg-red-900/90 border-red-500/50 text-red-100":"bg-gray-800/90 border-gray-600/50 text-white"}`,children:[r.jsx("div",{className:`p-2 rounded-full ${Ke.type==="success"?"bg-green-500/20 text-green-400":Ke.type==="error"?"bg-red-500/20 text-red-400":"bg-blue-500/20 text-blue-400"}`,children:Ke.type==="success"?r.jsx(nt,{className:"w-6 h-6"}):Ke.type==="error"?r.jsx(rt,{className:"w-6 h-6"}):r.jsx(an,{className:"w-6 h-6"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"font-bold text-sm",children:Ke.message}),Ke.url&&r.jsx("a",{href:Ke.url,target:"_blank",rel:"noreferrer",className:"text-xs underline mt-1 block opacity-80 hover:opacity-100",children:" "})]}),r.jsx("button",{onClick:()=>Ie(null),className:"p-1 hover:bg-white/10 rounded-full transition-colors",children:r.jsx(rt,{className:"w-4 h-4"})})]})}):null;if(D)return r.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-[#111827] animate-fadeIn",children:[r.jsxs("div",{className:"text-5xl font-bold mb-8 flex items-center gap-2",children:[a==="firebase"?r.jsx(hp,{className:"w-12 h-12 text-red-500"}):r.jsx(Ci,{className:"w-12 h-12 text-green-500"}),r.jsxs("div",{children:[r.jsx("span",{className:"text-red-500",children:Ws}),r.jsx("span",{className:"text-white ml-2",children:En})]})]}),r.jsx("div",{className:"relative w-64 h-2 bg-gray-700 rounded-full overflow-hidden mb-4",children:r.jsx("div",{className:`absolute top-0 left-0 h-full ${a==="firebase"?"bg-red-600":"bg-green-500"} animate-[progress_2s_ease-in-out_infinite] w-1/3 rounded-full`})}),r.jsx("p",{className:"text-gray-200 text-lg font-bold animate-pulse",children:F}),r.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"    ..."})]});const we=c===a,pe=()=>{yt.current&&yt.current.click()},Re=Se=>{var at;const Fe=(at=Se.target.files)==null?void 0:at[0];if(!Fe)return;const it=new FileReader;it.onload=Gt=>{var Ks,Mn,$c,gl;try{const fr=(Ks=Gt.target)==null?void 0:Ks.result,Ln=JSON.parse(fr);let pl={};if(Ln.project_info&&Ln.client){const ja=Ln.client[0],Na=Ln.project_info;pl={apiKey:($c=(Mn=ja.api_key)==null?void 0:Mn[0])==null?void 0:$c.current_key,authDomain:`${Na.project_id}.firebaseapp.com`,projectId:Na.project_id,storageBucket:Na.storage_bucket,messagingSenderId:Na.project_number,appId:(gl=ja.client_info)==null?void 0:gl.mobilesdk_app_id},W("idle"),k("")}else if(Ln.apiKey&&Ln.projectId)pl=Ln,W("idle"),k("");else{k("     ."),W("error");return}I(Pi(pl))}catch{k("  "),W("error")}},it.readAsText(Fe),Se.target.value=""},he=async()=>{try{if(S(!0),E("  ..."),await new Promise(Se=>setTimeout(Se,1e3)),wW("system_status"),a==="firebase"){const Se=JSON.parse(T);if(!Se.apiKey||!Se.projectId)throw new Error("  .");if(!uR(Se))throw new Error("    Firebase.");E("   ...");const it=await Cq();if(!it.success)throw new Error(`${it.error||"  "}`);await ze(Rq),df("firebase_config",Pi(Se)),df("db_provider","firebase"),d("firebase"),"serviceWorker"in navigator&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"FIREBASE_CONFIG",config:Se})}else{const Se=N.trim(),Fe=U.trim();if(!Se||!Fe)throw new Error("  .");if(!Se.startsWith("http"))throw new Error("  .");if(!gW(Se,Fe))throw new Error(" .");E("   ...");const at=await pW();if(!at.success)throw new Error(`${at.error||"  "}`);await ze(bW),df("supabase_config",Pi({url:Se,key:Fe})),df("db_provider","supabase"),d("supabase")}B(!0),W("success"),E("  !"),await new Promise(Se=>setTimeout(Se,2e3)),s?s():S(!1)}catch(Se){S(!1),k(Se.message||" ."),W("error"),console.error(Se)}},Me=Se=>{if(!Array.isArray(Se))return[];const Fe=new Map;return Se.forEach(it=>{it&&it.id?Fe.set(String(it.id),it):it&&it.phone&&Fe.set(String(it.phone),it)}),Array.from(Fe.values())},ze=async Se=>{E("   ...");try{const Fe=it=>{const at=yW(it);if(!at)return[];try{return Me(JSON.parse(at))}catch{return[]}};E("   ..."),await Se("users",Fe("users")),E("   ..."),await Se("orders",Fe("orders")),E("   ..."),await Se("messages",Fe("messages")),await Se("payments",Fe("payments")),await Se("reset_requests",Fe("passwordResetRequests")),E("   ..."),await Se("slider_images",Fe("sliderImages"))}catch(Fe){throw console.error("Migration failed:",Fe),Fe.message&&(Fe.message.includes("column")||Fe.message.includes("relation"))&&k("    .    SQL ."),new Error(`${Fe.message}`)}},tt=()=>{Oe(),S(!0),E("    ..."),setTimeout(()=>{E("   ..."),df("system_status","stopped"),d(null),W("idle"),setTimeout(()=>{e?e():S(!1)},1500)},2e3)};return r.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 text-white p-4 pb-32",children:[r.jsxs("div",{className:"text-center",children:[r.jsxs("h2",{className:"text-3xl font-bold mb-2 flex items-center justify-center gap-3",children:[r.jsx(on,{className:"w-10 h-10 text-blue-500"}),r.jsx("span",{children:" "})]}),r.jsx("p",{className:"text-gray-400",children:"       ."})]}),r.jsxs("div",{className:"bg-gray-800 p-6 rounded-xl shadow-lg border-t-4 border-purple-500 relative overflow-hidden",children:[r.jsx("div",{className:"flex items-center justify-between mb-6",children:r.jsxs("h3",{className:"text-xl font-bold text-gray-200 flex items-center gap-2",children:[r.jsx(zt,{className:"w-5 h-5 text-purple-400"}),"  "]})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"  "}),r.jsx("input",{type:"text",value:Y,onChange:Se=>X(Se.target.value),placeholder:": 1.1.0",className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 outline-none font-mono"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:" "}),r.jsxs("div",{className:"flex bg-gray-700 p-1 rounded-lg",children:[r.jsxs("button",{onClick:()=>K("apk"),className:`flex-1 py-2 text-xs font-bold rounded-md transition-all ${O==="apk"?"bg-purple-600 text-white shadow":"text-gray-400 hover:text-white"}`,children:[r.jsx(jw,{className:"w-4 h-4 inline ml-1"}),"  (APK)"]}),r.jsxs("button",{onClick:()=>K("link"),className:`flex-1 py-2 text-xs font-bold rounded-md transition-all ${O==="link"?"bg-purple-600 text-white shadow":"text-gray-400 hover:text-white"}`,children:[r.jsx($f,{className:"w-4 h-4 inline ml-1"}),"  (Link)"]})]})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"  /  "}),r.jsxs("div",{className:"flex gap-2 items-center",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx("input",{type:"url",value:R,onChange:Se=>J(Se.target.value),placeholder:ne?` ... ${se}%`:"https://...",disabled:ne,className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 outline-none dir-ltr disabled:opacity-70 disabled:cursor-wait"}),ne&&r.jsx("div",{className:"absolute top-0 left-0 bottom-0 bg-purple-500/10 transition-all duration-300 pointer-events-none",style:{width:`${se}%`}}),ne&&r.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:r.jsx("div",{className:"w-5 h-5 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"})})]}),r.jsx("button",{onClick:()=>{var Se;return(Se=$e.current)==null?void 0:Se.click()},disabled:ne,className:"px-4 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg border border-gray-600 transition-colors flex items-center justify-center",title:"  APK  ",children:r.jsx(ur,{className:"w-5 h-5"})}),r.jsx("input",{ref:$e,type:"file",accept:".apk",className:"hidden",onChange:Ge})]})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"  ( )"}),r.jsx("textarea",{value:Q,onChange:Se=>L(Se.target.value),placeholder:"   ...",className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 outline-none resize-none h-24"})]})]}),r.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[r.jsxs("button",{onClick:bs,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-xl transition-all shadow-lg active:scale-95 flex items-center gap-2 group border border-red-500/50",children:[r.jsx(rt,{className:"w-5 h-5 group-hover:rotate-90 transition-transform"}),"  "]}),r.jsx("button",{onClick:()=>be(!0),disabled:!Y||!R||G||ne,className:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-8 rounded-xl transition-all shadow-lg active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 group",children:G?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"})," ..."]}):r.jsxs(r.Fragment,{children:[r.jsx(an,{className:"w-5 h-5 group-hover:animate-swing"}),"   "]})})]}),r.jsx("div",{className:"absolute -bottom-10 -left-10 w-40 h-40 bg-purple-500/10 rounded-full blur-2xl pointer-events-none"})]}),r.jsxs("div",{className:"bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700",children:[r.jsxs("h3",{className:"text-xl font-bold text-gray-200 mb-4 flex items-center gap-2",children:[r.jsx(Wn,{className:"w-5 h-5 text-gray-400"})," "]}),r.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto custom-scrollbar",children:Ae.length>0?Ae.map(Se=>r.jsxs("div",{className:"bg-gray-700/50 p-3 rounded-lg flex items-center justify-between border border-gray-600/30",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-white font-bold",children:Se.version}),r.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded ${Se.isActive?"bg-green-500/20 text-green-400":"bg-gray-600 text-gray-400"}`,children:Se.isActive?"":""})]}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(Se.releaseDate||new Date).toLocaleDateString("ar-EG")})]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsx("button",{onClick:async()=>{confirm("      ")&&(await kn("update_history",Se.id),Se.isActive&&await bs())},className:"text-red-400 hover:text-red-300 p-2",children:r.jsx(rt,{className:"w-4 h-4"})})})]},Se.id)):r.jsx("p",{className:"text-center text-gray-500 text-sm py-4",children:"   ."})})]}),r.jsxs("div",{className:"bg-gray-800 p-6 rounded-xl shadow-lg border-t-4 border-blue-500",children:[r.jsx("div",{className:"flex items-center justify-between mb-6",children:r.jsxs("h3",{className:"text-xl font-bold text-gray-200 flex items-center gap-2",children:[r.jsx(on,{className:"w-5 h-5 text-blue-400"})," "]})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:" "}),r.jsx("input",{type:"text",value:f,onChange:Se=>m(Se.target.value),placeholder:"GOO NOW",className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 outline-none"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"  "}),r.jsx("input",{type:"text",value:x,onChange:Se=>y(Se.target.value),placeholder:"VERSION 1.0.5",className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 outline-none"})]})]}),r.jsx("div",{className:"mt-4 flex justify-end",children:r.jsx("button",{onClick:Pe,disabled:w,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg transition-colors flex items-center gap-2 shadow-lg disabled:opacity-50",children:w?" ...":r.jsxs(r.Fragment,{children:["  ",r.jsx(nt,{className:"w-4 h-4"})]})})})]}),r.jsx("div",{className:"text-center mt-8",children:r.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center justify-center gap-3",children:[a==="firebase"?r.jsx(hp,{className:"w-8 h-8 text-red-500"}):r.jsx(Ci,{className:"w-8 h-8 text-green-500"}),r.jsx("span",{children:" "})]})}),r.jsxs("div",{className:"flex bg-gray-800 p-1 rounded-lg max-w-md mx-auto mb-6 relative",children:[r.jsxs("button",{onClick:()=>{l("firebase"),k("")},className:`flex-1 py-2 px-4 rounded-md font-bold transition-colors flex items-center justify-center gap-2 relative ${a==="firebase"?"bg-red-600 text-white":"text-gray-400 hover:text-white"}`,children:[r.jsx(hp,{className:"w-5 h-5"}),"Firebase",c==="firebase"&&r.jsx("span",{className:"absolute top-2 left-2 w-2.5 h-2.5 bg-green-400 rounded-full border-2 border-gray-800 animate-pulse"})]}),r.jsxs("button",{onClick:()=>{l("supabase"),k("")},className:`flex-1 py-2 px-4 rounded-md font-bold transition-colors flex items-center justify-center gap-2 relative ${a==="supabase"?"bg-green-600 text-white":"text-gray-400 hover:text-white"}`,children:[r.jsx(Ci,{className:"w-5 h-5"}),"Supabase",c==="supabase"&&r.jsx("span",{className:"absolute top-2 left-2 w-2.5 h-2.5 bg-green-400 rounded-full border-2 border-gray-800 animate-pulse"})]})]}),r.jsxs("div",{className:`bg-gray-800 p-6 rounded-xl shadow-lg border-t-4 ${we?"border-green-500":"border-red-500"}`,children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-200",children:a==="firebase"?" Firebase":" Supabase"}),r.jsxs("span",{className:`px-4 py-2 rounded-full font-bold text-sm flex items-center gap-2 ${we?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:[we&&r.jsx("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),we?"  (Online)":"  (Stopped)"]})]}),a==="firebase"?r.jsxs("div",{className:"space-y-4",children:[!M&&r.jsxs("div",{className:"bg-blue-900/30 border border-blue-500/30 p-4 rounded-lg mb-6 text-sm text-blue-200",children:[r.jsx("p",{className:"font-bold mb-1",children:" :"}),r.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[r.jsxs("li",{children:["   ",r.jsx("code",{children:"google-services.json"}),"  Firebase Console."]}),r.jsx("li",{children:"   ."})]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"block text-sm font-medium text-gray-400 mb-2",children:"  (google-services.json)"}),r.jsx("div",{onClick:pe,className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-600 border-dashed rounded-lg cursor-pointer hover:bg-gray-700 transition-colors",children:r.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6 pointer-events-none",children:[r.jsx(ur,{className:"w-10 h-10 text-gray-400 mb-3"}),r.jsx("p",{className:"mb-2 text-sm text-gray-400",children:r.jsx("span",{className:"font-semibold",children:"  "})})]})}),r.jsx("input",{ref:yt,type:"file",className:"hidden",accept:".json",onChange:Re})]}),T&&!z&&r.jsxs("div",{className:"bg-[#0f172a] border border-gray-700 rounded-xl p-4 mt-4 relative group",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2 border-b border-gray-700/50 pb-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(nt,{className:"w-4 h-4 text-green-500"}),r.jsx("h4",{className:"text-sm font-bold text-white",children:"   (Active Config)"})]}),r.jsx("span",{className:"text-[10px] font-mono bg-blue-900/30 text-blue-400 px-2 py-1 rounded border border-blue-500/20",children:(()=>{try{return JSON.parse(T).projectId}catch{return"Unknown"}})()})]}),r.jsx("div",{className:"max-h-32 overflow-y-auto custom-scrollbar",children:r.jsx("pre",{className:"text-[10px] text-green-400 font-mono whitespace-pre-wrap",children:T})}),r.jsx("div",{className:"mt-3 pt-2 border-t border-gray-700/50 text-[10px] text-gray-500",children:"        ."})]})]}):r.jsxs("div",{className:"space-y-4",children:[!M&&r.jsxs("div",{className:"bg-blue-900/30 border border-blue-500/30 p-4 rounded-lg mb-6 text-sm text-blue-200",children:[r.jsx("p",{className:"font-bold mb-1",children:" :"}),r.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[r.jsx("li",{children:"    Supabase."}),r.jsx("li",{children:"       SQL  ."}),r.jsxs("li",{children:["   ",r.jsx("strong",{children:"SQL Editor"}),"  Supabase."]}),r.jsxs("li",{children:[" ",r.jsx("code",{children:"Project URL"}),"  ",r.jsx("code",{children:"Anon Key"}),"."]})]}),r.jsxs("button",{onClick:()=>{ce("schema"),bt(!0)},className:"mt-3 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded text-sm transition-colors flex items-center",children:[r.jsx(Wn,{className:"w-4 h-4 mr-2"}),"    (SQL)"]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Project URL"}),r.jsx("input",{type:"text",value:N,onChange:Se=>P(Se.target.value),placeholder:"https://xyz.supabase.co",className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-green-500 outline-none"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"API Key (anon/public)"}),r.jsx("input",{type:"text",value:U,onChange:Se=>V(Se.target.value),placeholder:"eyJhbGciOiJIUzI1NiIsInR...",className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-green-500 outline-none"})]})]}),z&&r.jsxs("div",{className:"mt-4 p-4 bg-red-900/50 border border-red-500/50 rounded-lg flex flex-col items-start gap-2 text-red-200 text-sm",children:[r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx(rt,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-bold",children:":"}),r.jsx("p",{children:z})]})]}),(z.includes("RLS")||z.includes("SQL")||z.includes("policy")||z.includes("column"))&&r.jsx("button",{onClick:()=>{ce("schema"),bt(!0)},className:"mt-2 mr-7 text-blue-300 hover:text-blue-200 underline text-xs",children:"  SQL "})]}),r.jsxs("div",{className:"flex gap-4 pt-6 border-t border-gray-700 mt-6",children:[we?r.jsxs("div",{className:"flex-1 bg-gray-700/50 text-gray-400 font-bold py-3 rounded-lg flex justify-center items-center gap-2 cursor-default border border-gray-600",children:[r.jsx(nt,{className:"w-5 h-5 text-green-500"}),r.jsx("span",{children:"  "})]}):r.jsxs("button",{onClick:he,disabled:a==="firebase"?!T:!N||!U,className:`flex-1 ${a==="firebase"?"bg-red-600 hover:bg-red-700 focus:ring-red-500":"bg-green-600 hover:bg-green-700 focus:ring-green-500"} disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-bold py-3 rounded-lg transition-colors flex justify-center items-center gap-2`,children:[a==="firebase"?r.jsx(hp,{className:"w-5 h-5"}):r.jsx(Ci,{className:"w-5 h-5"}),r.jsx("span",{children:"  "})]}),we&&r.jsx("button",{onClick:()=>{ce("disconnect"),et(!0)},className:"px-6 bg-gray-700 hover:bg-gray-600 text-gray-200 font-bold py-3 rounded-lg transition-colors",children:""})]})]}),Te&&r.jsx(os,{title:"  ",message:"               .",onClose:()=>be(!1),onConfirm:Lt,confirmButtonText:"  ",confirmVariant:"success"}),ye&&r.jsx(os,{title:"  ",message:"                .",onClose:Oe,onConfirm:tt,confirmButtonText:" ",confirmVariant:"danger"}),Je&&r.jsx(vW,{onClose:Oe}),r.jsx(hr,{})]})},jW=({options:s,value:e,onChange:t,placeholder:n="Select an option"})=>{const[a,l]=j.useState(!1),[c,d]=j.useState(""),f=j.useRef(null),m=j.useMemo(()=>s.find(w=>w.value===e),[s,e]),x=j.useMemo(()=>c?s.filter(w=>w.label.toLowerCase().includes(c.toLowerCase())||w.sublabel&&w.sublabel.toLowerCase().includes(c.toLowerCase())):s,[s,c]);j.useEffect(()=>{const w=v=>{f.current&&!f.current.contains(v.target)&&l(!1)};return document.addEventListener("mousedown",w),()=>{document.removeEventListener("mousedown",w)}},[]);const y=w=>{t(w),l(!1),d("")};return r.jsxs("div",{className:"relative",ref:f,children:[r.jsxs("button",{type:"button",onClick:()=>l(!a),className:"w-full flex justify-between items-center text-right px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none",children:[r.jsx("span",{className:m?"text-neutral-100":"text-neutral-400",children:m?m.label:n}),r.jsx(k0,{className:`w-5 h-5 text-neutral-400 transition-transform ${a?"transform rotate-180":""}`})]}),a&&r.jsxs("div",{className:"absolute z-30 mt-1 w-full bg-gray-800 shadow-lg rounded-md border border-gray-600 max-h-60 flex flex-col",children:[r.jsxs("div",{className:"p-2 border-b border-gray-700 relative",children:[r.jsx(Kn,{className:"absolute top-1/2 left-4 transform -translate-y-1/2 w-5 h-5 text-neutral-400"}),r.jsx("input",{type:"text",placeholder:"...",value:c,onChange:w=>d(w.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-900 text-white border border-gray-600 rounded-md focus:outline-none focus:ring-1 focus:ring-red-500 placeholder:text-neutral-500",autoFocus:!0})]}),r.jsx("div",{className:"overflow-y-auto flex-1",children:x.length>0?x.map(w=>r.jsxs("button",{type:"button",onClick:()=>y(w.value),className:`w-full text-right px-4 py-3 text-sm flex justify-between items-center transition-colors ${e===w.value?"bg-red-500/20 text-red-400":"text-neutral-200 hover:bg-gray-700"}`,children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-semibold",children:w.label}),w.sublabel&&r.jsx("p",{className:"text-xs text-neutral-400",children:w.sublabel})]}),e===w.value&&r.jsx(nt,{className:"w-5 h-5"})]},w.value)):r.jsx("p",{className:"text-center text-neutral-500 py-4",children:"  ."})})]})]})},NW=({onClose:s,onSave:e,merchants:t,adminUser:n,initialMerchantId:a,initialCategoryId:l,initialText:c})=>{const[d,f]=j.useState(a||""),[m,x]=j.useState(l||""),[y,w]=j.useState(c||"");Ht(()=>(s(),!0),[]);const v=j.useMemo(()=>{const P=t.map(U=>({value:U.id,label:U.name,sublabel:U.phone}));return n&&P.unshift({value:n.id,label:`${n.name} ()`,sublabel:"  "}),P},[t,n]),T=j.useMemo(()=>{if(!d)return[];if(n&&d===n.id)return[];const P=t.find(V=>V.id===d);if(!P||!P.products)return[];const U=new Set(P.products.map(V=>V.category||""));return Array.from(U).map(V=>({value:V,label:V}))},[d,t,n]),I=()=>e(d,m||void 0,y||void 0),N=n&&d===n.id;return r.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-md flex items-center justify-center z-[150] p-4 animate-fadeIn",onClick:s,children:r.jsxs("div",{className:"bg-[#1e293b] rounded-2xl shadow-2xl w-full max-w-md border border-gray-700 overflow-hidden animate-pop-in flex flex-col max-h-[90vh]",onClick:P=>P.stopPropagation(),children:[r.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[r.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[r.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg shadow-lg shadow-blue-900/20",children:r.jsx($f,{className:"w-5 h-5 text-blue-400"})}),"  "]}),r.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white transition-colors bg-gray-800 p-2 rounded-full hover:bg-gray-700",children:r.jsx(rt,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"p-6 space-y-8 overflow-y-auto custom-scrollbar bg-[#1e293b]",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-blue-400 mb-1",children:[r.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 flex items-center justify-center text-xs border border-blue-500/30",children:"1"}),"  (  )"]}),r.jsx(jW,{options:v,value:d,onChange:P=>{f(P),x("")},placeholder:"  ..."})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-purple-400 mb-1",children:[r.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 flex items-center justify-center text-xs border border-purple-500/30",children:"2"}),"  ()"]}),r.jsx("input",{type:"text",value:y,onChange:P=>w(P.target.value),placeholder:":  50%  !",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3 text-white focus:border-purple-500 outline-none transition-colors"}),r.jsx("p",{className:"text-[10px] text-gray-500",children:"    "})]}),r.jsxs("div",{className:`transition-all duration-500 ease-in-out ${d&&!N?"opacity-100 translate-y-0":"opacity-50 translate-y-4 grayscale pointer-events-none"}`,children:[r.jsx("div",{className:"h-px bg-gray-700 mb-6"}),r.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-orange-400 mb-4",children:[r.jsx("span",{className:"w-6 h-6 rounded-full bg-orange-500/20 flex items-center justify-center text-xs border border-orange-500/30",children:"3"}),"     ()"]}),N?r.jsxs("div",{className:"flex flex-col items-center justify-center p-6 bg-blue-900/10 rounded-xl border border-blue-500/20 text-center",children:[r.jsx("div",{className:"w-12 h-12 bg-blue-500/10 rounded-full flex items-center justify-center mb-2",children:r.jsx(pt,{className:"w-6 h-6 text-blue-400"})}),r.jsx("p",{className:"text-blue-200 text-sm font-bold",children:"   "}),r.jsx("p",{className:"text-blue-400/60 text-xs mt-1",children:"    "})]}):T.length>0?r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("button",{onClick:()=>x(""),className:`relative p-3 rounded-xl border-2 transition-all flex flex-col items-center justify-center gap-2 h-24 group ${m===""?"bg-red-600/10 border-red-500 shadow-lg shadow-red-900/20":"bg-gray-800 border-gray-700 hover:border-gray-500"}`,children:[r.jsx(Qo,{className:`w-6 h-6 ${m===""?"text-red-500":"text-gray-500 group-hover:text-gray-300"}`}),r.jsx("span",{className:`text-xs font-bold ${m===""?"text-white":"text-gray-400 group-hover:text-gray-300"}`,children:" "}),m===""&&r.jsx("div",{className:"absolute top-2 right-2",children:r.jsx(nt,{className:"w-4 h-4 text-red-500"})})]}),T.map(P=>r.jsxs("button",{onClick:()=>x(P.value),className:`relative p-3 rounded-xl border-2 transition-all flex flex-col items-center justify-center gap-2 h-24 group ${m===P.value?"bg-red-600/10 border-red-500 shadow-lg shadow-red-900/20":"bg-gray-800 border-gray-700 hover:border-gray-500"}`,children:[r.jsx(Sn,{className:`w-6 h-6 ${m===P.value?"text-red-500":"text-gray-500 group-hover:text-gray-300"}`}),r.jsx("span",{className:`text-xs font-bold text-center line-clamp-2 leading-tight ${m===P.value?"text-white":"text-gray-400 group-hover:text-gray-300"}`,children:P.label}),m===P.value&&r.jsx("div",{className:"absolute top-2 right-2",children:r.jsx(nt,{className:"w-4 h-4 text-red-500"})})]},P.value))]}):r.jsxs("div",{className:"flex flex-col items-center justify-center p-6 bg-gray-800/50 rounded-xl border border-gray-700 text-center border-dashed",children:[r.jsx(Sn,{className:"w-10 h-10 text-gray-600 mb-2 opacity-50"}),r.jsx("p",{className:"text-gray-400 text-xs",children:"     ."})]})]})]}),r.jsxs("div",{className:"p-5 border-t border-gray-700 bg-[#151e2d] flex gap-3",children:[r.jsxs("button",{onClick:I,disabled:!d,className:"flex-1 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white font-bold py-3.5 rounded-xl transition-all shadow-lg active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[r.jsx(nt,{className:"w-5 h-5"})," "]}),a&&r.jsx("button",{onClick:()=>e("",void 0,""),className:"px-4 bg-red-500/10 hover:bg-red-500/20 text-red-400 font-bold py-3.5 rounded-xl transition-colors border border-red-500/20 flex items-center justify-center",title:" ",children:r.jsx(Pt,{className:"w-5 h-5"})})]})]})})},IR=({images:s,isEnabled:e,onAddImage:t,onDeleteImage:n,onUpdateImage:a,onToggleSlider:l,merchants:c=[],adminUser:d})=>{var k,M,B;const f=j.useRef(null),m=j.useRef(null),[x,y]=j.useState(null),[w,v]=j.useState(null),[T,I]=j.useState(!1),[N,P]=j.useState(0);j.useEffect(()=>{if(s.length>1){const D=setInterval(()=>{P(S=>(S+1)%s.length)},3e3);return()=>clearInterval(D)}else P(0)},[s.length]);const U=j.useMemo(()=>s.filter(D=>D.active!==!1),[s]);U.length>0;const V=D=>{if(!D.linkedMerchantId)return{name:" ",type:"none"};if(d&&D.linkedMerchantId===d.id)return{name:" ( )",type:"admin"};const S=c.find(F=>F.id===D.linkedMerchantId);return{name:S?S.name:"  ",category:D.linkedCategoryId,type:"merchant"}},q=D=>new Promise((S,F)=>{const E=new FileReader;E.readAsDataURL(D),E.onload=Y=>{var R;const X=new Image;X.src=(R=Y.target)==null?void 0:R.result,X.onload=()=>{const J=document.createElement("canvas"),O=1920,K=1920;let Q=X.width,L=X.height;Q>L?Q>O&&(L*=O/Q,Q=O):L>K&&(Q*=K/L,L=K),J.width=Q,J.height=L;const G=J.getContext("2d");G?(G.imageSmoothingEnabled=!0,G.imageSmoothingQuality="high",G.drawImage(X,0,0,Q,L),S(J.toDataURL("image/jpeg",.95))):F(new Error("Canvas context failed"))},X.onerror=J=>F(J)},E.onerror=Y=>F(Y)}),W=async D=>{var F;const S=(F=D.target.files)==null?void 0:F[0];if(S&&t){I(!0);try{const E=await q(S),Y={id:`SLIDE-${Date.now()}`,url:E,active:!0,createdAt:new Date,linkedMerchantId:"",linkedCategoryId:""};t(Y)}catch(E){console.error("Image upload failed",E),alert("  .    .")}finally{I(!1)}}f.current&&(f.current.value="")},z=async D=>{var F;const S=(F=D.target.files)==null?void 0:F[0];if(S&&a&&x){I(!0);try{const E=await q(S);a(x,{url:E}),y(null)}catch(E){console.error("Image update failed",E),alert("  .")}finally{I(!1)}}m.current&&(m.current.value="")};return r.jsxs("div",{className:"space-y-8 pb-32 animate-fadeIn",children:[r.jsxs("div",{className:"bg-[#111] p-6 rounded-[2.5rem] border border-gray-800 shadow-2xl relative overflow-hidden",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6 px-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-red-600 rounded-full flex items-center justify-center shadow-lg shadow-red-900/20",children:r.jsx(Qr,{className:"w-5 h-5 text-white"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-black text-white tracking-wide",children:" "}),r.jsx("p",{className:"text-xs text-gray-400 font-medium",children:"    "})]})]}),r.jsxs("button",{onClick:()=>l&&l(!e),className:`group relative flex items-center gap-3 pl-1 pr-4 py-1.5 rounded-full transition-all duration-300 border ${e?"bg-green-900/20 border-green-500/30":"bg-red-900/20 border-red-500/30"}`,children:[r.jsx("span",{className:`text-[10px] font-bold ${e?"text-green-400":"text-red-400"}`,children:e?"":""}),r.jsx("div",{className:`w-10 h-6 rounded-full relative transition-colors duration-300 ${e?"bg-green-600":"bg-red-600"}`,children:r.jsx("div",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full shadow-md transition-transform duration-300 ease-spring ${e?"translate-x-4":"translate-x-0"}`})})]})]}),r.jsxs("div",{className:"relative w-full max-w-sm mx-auto aspect-[16/9] sm:aspect-[2/1] rounded-2xl overflow-hidden shadow-2xl border border-gray-700 bg-gray-900 group",children:[U.length>0?U.map((D,S)=>{const F=S===N,E=!!D.textOverlay,Y=d&&D.linkedMerchantId===d.id;return r.jsxs("div",{className:`absolute inset-0 transition-opacity duration-700 ease-in-out ${F?"opacity-100 z-10":"opacity-0 z-0"}`,children:[r.jsx("img",{src:D.url,className:"w-full h-full object-cover",alt:"Slide"}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent pointer-events-none"}),Y&&d&&r.jsxs("div",{className:"absolute bottom-4 left-4 z-20 flex items-center gap-2 bg-black/40 backdrop-blur-md border border-white/10 px-3 py-1.5 rounded-full animate-fade-slide-up",children:[r.jsx("div",{className:"w-6 h-6 rounded-full border border-white/50 overflow-hidden bg-gray-800",children:d.storeImage?r.jsx("img",{src:d.storeImage,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-full h-full p-1 text-gray-400"})}),D.textOverlay?r.jsx("span",{className:"text-[10px] font-bold text-white max-w-[150px] truncate",children:D.textOverlay}):r.jsx("span",{className:"text-[10px] font-bold text-white",children:""})]}),E&&!Y&&r.jsx("div",{className:"absolute bottom-4 right-4 max-w-[70%] text-right z-20",children:r.jsx("p",{className:"text-white font-bold text-sm drop-shadow-md bg-black/30 backdrop-blur-sm px-3 py-1 rounded-lg inline-block border border-white/10",children:D.textOverlay})})]},D.id)}):r.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-gray-600",children:[r.jsx(Qr,{className:"w-12 h-12 mb-2 opacity-20"}),r.jsx("span",{className:"text-xs font-bold opacity-50",children:"   "})]}),U.length>1&&r.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1 z-30",children:U.map((D,S)=>r.jsx("div",{className:`h-1 rounded-full transition-all duration-300 ${S===N?"bg-white w-4":"bg-white/30 w-1"}`},S))})]}),r.jsx("p",{className:"text-center text-[10px] text-gray-600 mt-3 font-mono",children:"LIVE PREVIEW MODE"})]}),r.jsxs("div",{className:"flex justify-between items-center px-2",children:[r.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[r.jsx(Sn,{className:"w-5 h-5 text-gray-400"}),"  (",s.length,")"]}),r.jsxs("button",{onClick:()=>{var D;return(D=f.current)==null?void 0:D.click()},disabled:T,className:"bg-red-600 hover:bg-red-700 text-white pl-4 pr-5 py-2.5 rounded-xl font-bold shadow-lg shadow-red-900/20 active:scale-95 transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[T?r.jsx("div",{className:"w-4 h-4 border-2 border-white/50 border-t-white rounded-full animate-spin"}):r.jsx(ur,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm",children:" "})]}),r.jsx("input",{ref:f,type:"file",className:"hidden",accept:"image/*",onChange:W}),r.jsx("input",{ref:m,type:"file",className:"hidden",accept:"image/*",onChange:z})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:[s.map(D=>{const S=V(D),F=D.active!==!1;return r.jsxs("div",{className:`group relative bg-[#1e1e1e] rounded-3xl overflow-hidden border transition-all duration-300 ${F?"border-gray-700 shadow-lg hover:border-gray-500":"border-gray-800 opacity-60 hover:opacity-100"}`,children:[r.jsxs("div",{className:"relative aspect-video w-full bg-gray-900 overflow-hidden",children:[r.jsx("img",{src:D.url,alt:"Slider",className:`w-full h-full object-cover transition-transform duration-700 group-hover:scale-105 ${F?"":"grayscale"}`}),D.textOverlay&&r.jsx("div",{className:"absolute bottom-2 right-2 left-2 z-10",children:r.jsx("span",{className:"text-[10px] text-white bg-black/50 backdrop-blur-sm px-2 py-1 rounded truncate block text-center border border-white/10",children:D.textOverlay})}),r.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3 backdrop-blur-[2px] z-20",children:[r.jsx("button",{onClick:()=>{var E;y(D.id),(E=m.current)==null||E.click()},className:"w-9 h-9 rounded-full bg-white text-black flex items-center justify-center shadow-lg hover:scale-110 transition-transform",title:" ",children:r.jsx(cr,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>v(D.id),className:"w-9 h-9 rounded-full bg-blue-500 text-white flex items-center justify-center shadow-lg hover:scale-110 transition-transform",title:" ",children:r.jsx($f,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>n&&n(D.id),className:"w-9 h-9 rounded-full bg-red-600 text-white flex items-center justify-center shadow-lg hover:scale-110 transition-transform",title:"",children:r.jsx(Pt,{className:"w-4 h-4"})})]}),r.jsx("div",{className:"absolute top-3 left-3 z-20",children:r.jsx("button",{onClick:()=>a&&a(D.id,{active:!F}),className:`p-1.5 rounded-full backdrop-blur-md border shadow-sm transition-colors ${F?"bg-green-500/20 border-green-500/30 text-green-400":"bg-black/40 border-white/10 text-gray-400"}`,children:F?r.jsx(wa,{className:"w-3.5 h-3.5"}):r.jsx(Ui,{className:"w-3.5 h-3.5"})})})]}),r.jsx("div",{className:"p-4 border-t border-gray-700/50 bg-[#252525]",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border border-white/5 ${S.type==="admin"?"bg-blue-500/10 text-blue-400":S.type==="merchant"?"bg-purple-500/10 text-purple-400":"bg-gray-700 text-gray-500"}`,children:S.type==="admin"?r.jsx(pt,{className:"w-4 h-4"}):S.type==="merchant"?r.jsx(Qo,{className:"w-4 h-4"}):r.jsx($f,{className:"w-4 h-4"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-xs font-bold text-white truncate",children:S.name}),r.jsx("p",{className:"text-[10px] text-gray-500 truncate flex items-center gap-1",children:S.category?r.jsxs(r.Fragment,{children:[r.jsx(Sn,{className:"w-3 h-3"}),S.category]}):S.type==="none"?" ":" "})]})]})})]},D.id)}),s.length===0&&r.jsxs("div",{className:"col-span-full py-20 text-center border-2 border-dashed border-gray-800 rounded-[2rem] bg-[#1a1a1a]/50",children:[r.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4 mx-auto shadow-inner border border-gray-700",children:r.jsx(Qr,{className:"w-10 h-10 text-gray-600 opacity-50"})}),r.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:"   "}),r.jsx("p",{className:"text-xs text-gray-500",children:"     "})]})]}),w&&r.jsx(NW,{onClose:()=>v(null),onSave:(D,S,F)=>{a&&w&&(a(w,{linkedMerchantId:D||void 0,linkedCategoryId:S||void 0,textOverlay:F||void 0}),v(null))},merchants:c,adminUser:d,initialMerchantId:(k=s.find(D=>D.id===w))==null?void 0:k.linkedMerchantId,initialCategoryId:(M=s.find(D=>D.id===w))==null?void 0:M.linkedCategoryId,initialText:(B=s.find(D=>D.id===w))==null?void 0:B.textOverlay})]})},AR=({merchants:s,onClose:e,onSave:t})=>{const[n,a]=j.useState({phone:"",address:""}),[l,c]=j.useState(""),[d,f]=j.useState(""),[m,x]=j.useState(1),[y,w]=j.useState(""),[v,T]=j.useState("idle"),[I,N]=j.useState(0),[P,U]=j.useState(!1),[V,q]=j.useState(""),[W,z]=j.useState("all");Ht(()=>P?(U(!1),!0):(e(),!0),[P,e]);const k=()=>U(!0),M=()=>U(!1),B=j.useMemo(()=>["all",...Array.from(new Set(s.map(K=>K.storeCategory||" ")))],[s]),D=j.useMemo(()=>s.filter(O=>{const K=O.name.toLowerCase().includes(V.toLowerCase())||O.phone&&O.phone.includes(V),Q=W==="all"||(O.storeCategory||" ")===W;return K&&Q}),[s,V,W]),S=j.useMemo(()=>s.find(O=>O.id===d),[s,d]),F=async()=>{if(!n.phone||!n.address||!d){w("      .");return}if(!/^\d{11}$/.test(n.phone)){w("      11 .");return}const O=(S==null?void 0:S.name)||"  ";w(""),T("saving"),N(0);try{if(m===1)await t({customer:{...n},notes:l,merchantId:d,merchantName:O}),N(100);else{const K=[];for(let Q=0;Q<m;Q++)K.push({customer:{...n},notes:l,merchantId:d,merchantName:O});N(50),await t(K),N(100)}T("success"),setTimeout(()=>{e()},1800)}catch(K){T("idle"),w("    ."),console.error(K)}},E=()=>{m<1e3&&x(O=>O+1)},Y=()=>{m>1&&x(O=>O-1)},X=O=>{let K=parseInt(O.target.value);isNaN(K)&&(K=1),K<1&&(K=1),K>1e3&&(K=1e3),x(K)},R=O=>{f(O),U(!1),q("")},J=O=>O==="restaurant"||O===""?r.jsx(Xr,{className:"w-4 h-4"}):O==="market"||O===" "?r.jsx(Nn,{className:"w-4 h-4"}):r.jsx(Sn,{className:"w-4 h-4"});return r.jsxs("div",{className:"flex flex-col h-full w-full bg-[#111827] animate-page-enter relative overflow-hidden",children:[r.jsxs("div",{className:`absolute inset-0 z-[60] bg-[#111827] flex flex-col items-center justify-center transition-all duration-500 ${v==="success"?"opacity-100 visible":"opacity-0 invisible pointer-events-none"}`,children:[r.jsxs("div",{className:`relative w-32 h-32 flex items-center justify-center mb-8 transition-transform duration-700 ${v==="success"?"scale-100":"scale-50"}`,children:[r.jsx("div",{className:"absolute inset-0 bg-green-500 rounded-full opacity-20 animate-ping"}),r.jsx("div",{className:"relative bg-gradient-to-br from-green-500 to-emerald-600 rounded-full p-6 shadow-[0_0_40px_rgba(16,185,129,0.4)]",children:r.jsx(nt,{className:"w-20 h-20 text-white"})})]}),r.jsx("h2",{className:`text-4xl font-black text-white mb-2 tracking-tight transition-all duration-500 delay-100 ${v==="success"?"translate-y-0 opacity-100":"translate-y-10 opacity-0"}`,children:" !"}),r.jsx("p",{className:`text-gray-400 text-lg transition-all duration-500 delay-200 ${v==="success"?"translate-y-0 opacity-100":"translate-y-10 opacity-0"}`,children:m>1?`  ${m}   `:"    "})]}),r.jsxs("div",{className:"flex-none bg-[#1f2937]/90 backdrop-blur-md border-b border-gray-700 flex items-center justify-between px-4 shadow-lg z-20 pt-safe h-16 box-content",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:e,disabled:v==="saving",className:"bg-gray-800 p-2.5 rounded-full text-gray-400 hover:text-white transition-colors active:bg-gray-700 border border-gray-700",children:r.jsx(Gs,{className:"w-5 h-5 rotate-180"})}),r.jsx("h2",{className:"text-lg font-bold text-white",children:"  "})]}),v==="saving"&&r.jsxs("div",{className:"flex items-center gap-2 bg-yellow-500/10 px-3 py-1 rounded-full border border-yellow-500/20",children:[r.jsx("div",{className:"w-3 h-3 border-2 border-yellow-500 border-t-transparent rounded-full animate-spin"}),r.jsx("span",{className:"text-xs font-bold text-yellow-500",children:I===100?"":" ..."})]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-5 space-y-6 scroll-smooth pb-4 bg-[#111827]",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-bold text-gray-400 block px-1 uppercase tracking-wider",children:" ()"}),r.jsxs("button",{onClick:k,disabled:v==="saving",className:`w-full p-4 rounded-2xl border transition-all flex items-center justify-between group ${S?"bg-gradient-to-r from-[#1f2937] to-[#1a202c] border-red-500/50 shadow-lg shadow-red-900/10":"bg-[#1f2937] border-gray-700 hover:border-gray-500 hover:bg-[#2d3748]"}`,children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center overflow-hidden border ${S?"bg-[#111] border-red-500/30":"bg-gray-800 border-gray-600"}`,children:S&&S.storeImage?r.jsx("img",{src:S.storeImage,alt:S.name,className:"w-full h-full object-cover"}):r.jsx(Qo,{className:`w-6 h-6 ${S?"text-red-500":"text-gray-500"}`})}),r.jsxs("div",{className:"text-right",children:[r.jsx("span",{className:`block font-bold text-base ${S?"text-white":"text-gray-400"}`,children:S?S.name:"  "}),S?r.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[r.jsx("span",{className:"text-xs text-gray-500 font-mono",children:S.phone}),r.jsx("span",{className:"text-[10px] bg-black/30 px-2 py-0.5 rounded text-gray-300 border border-gray-700",children:S.storeCategory||""})]}):r.jsx("span",{className:"text-xs text-gray-500",children:"  "})]})]}),r.jsx("div",{className:"p-2 rounded-full bg-gray-800 group-hover:bg-gray-700 transition-colors",children:r.jsx(k0,{className:"w-4 h-4 text-gray-400 group-hover:text-white"})})]})]}),r.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-700 to-transparent"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h3",{className:"text-xs font-bold text-gray-400 flex items-center gap-2 px-1 uppercase tracking-wider",children:[r.jsx(pt,{className:"w-4 h-4"}),"   ()"]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-4 text-gray-500 group-focus-within:text-red-500 transition-colors",children:r.jsx(Js,{className:"w-5 h-5"})}),r.jsx("input",{type:"tel",value:n.phone,onChange:O=>a({...n,phone:O.target.value}),placeholder:"  (11 )",className:"w-full bg-[#1f2937] border border-gray-700 rounded-xl py-4 pl-12 pr-4 text-white text-right placeholder:text-right focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all font-mono shadow-sm",dir:"rtl",maxLength:11,disabled:v==="saving"})]}),r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"absolute top-4 left-4 text-gray-500 group-focus-within:text-red-500 transition-colors",children:r.jsx(jn,{className:"w-5 h-5"})}),r.jsx("textarea",{value:n.address,onChange:O=>a({...n,address:O.target.value}),placeholder:"  (   )...",className:"w-full bg-[#1f2937] border border-gray-700 rounded-xl py-3.5 pl-12 pr-4 text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all shadow-sm resize-none h-24 leading-relaxed",disabled:v==="saving"})]})]})]}),r.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-700 to-transparent"}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("h3",{className:"text-xs font-bold text-gray-400 flex items-center gap-2 px-1 uppercase tracking-wider",children:[r.jsx(Wn,{className:"w-4 h-4"}),"  "]})}),r.jsxs("div",{className:"bg-[#1f2937] p-4 rounded-xl border border-gray-700 flex items-center justify-between shadow-sm",children:[r.jsx("span",{className:"text-sm text-gray-200 font-bold",children:"  "}),r.jsxs("div",{className:"flex items-center gap-3 bg-[#111] p-1.5 rounded-lg border border-gray-700 shadow-inner",children:[r.jsx("button",{onClick:Y,disabled:v==="saving",className:"w-9 h-9 flex items-center justify-center bg-gray-800 text-white rounded-md hover:bg-gray-700 active:scale-95 transition-all",children:r.jsx(F5,{className:"w-4 h-4"})}),r.jsx("div",{className:"w-10 text-center",children:r.jsx("input",{type:"number",min:"1",max:"1000",value:m,onChange:X,onFocus:O=>O.target.select(),disabled:v==="saving",className:"w-full bg-transparent text-center font-black text-xl text-white outline-none border-none p-0 focus:ring-0 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})}),r.jsx("button",{onClick:E,disabled:v==="saving",className:"w-9 h-9 flex items-center justify-center bg-red-600 text-white rounded-md hover:bg-red-700 active:scale-95 transition-all shadow-lg shadow-red-900/20",children:r.jsx(ln,{className:"w-4 h-4"})})]})]}),r.jsx("div",{className:"relative group",children:r.jsx("textarea",{value:l,onChange:O=>c(O.target.value),placeholder:"   ()...",rows:3,className:"w-full bg-[#1f2937] border border-gray-700 rounded-xl p-4 text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all resize-none shadow-sm",disabled:v==="saving"})})]}),y&&r.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 p-4 rounded-xl text-center animate-fadeIn flex items-center justify-center gap-2",children:[r.jsx(rt,{className:"w-5 h-5 text-red-500"}),r.jsx("p",{className:"text-red-400 text-sm font-bold",children:y})]})]}),r.jsx("div",{className:"flex-none bg-[#1f2937] border-t border-gray-700 p-4 z-20 pb-6 sm:pb-4 shadow-[0_-5px_20px_rgba(0,0,0,0.3)]",children:r.jsx("button",{onClick:F,disabled:v==="saving",className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-bold py-4 rounded-xl shadow-lg shadow-red-900/30 active:scale-[0.98] transition-all flex items-center justify-center gap-2 disabled:bg-none disabled:bg-gray-700 disabled:text-gray-500 disabled:cursor-not-allowed disabled:shadow-none group",children:v==="saving"?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),r.jsxs("span",{children:["  (",I,"%)"]})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-lg",children:" "}),m>1&&r.jsxs("span",{className:"bg-white/20 px-2 py-0.5 rounded text-sm font-mono",children:["x",m]}),r.jsx(Gs,{className:"w-5 h-5 opacity-0 -translate-x-2 group-hover:opacity-100 group-hover:translate-x-0 transition-all duration-300"})]})})}),P&&r.jsxs("div",{className:"fixed inset-0 z-[120] bg-black/90 backdrop-blur-sm flex flex-col animate-fadeIn",children:[r.jsxs("div",{className:"flex-none p-4 pt-safe flex items-center gap-4 bg-[#1f2937] border-b border-gray-700 shadow-md z-30",children:[r.jsx("button",{onClick:M,className:"bg-gray-800 hover:bg-gray-700 text-white p-2.5 rounded-full transition-colors active:scale-95",children:r.jsx(Gs,{className:"w-6 h-6 rotate-180"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-lg font-bold text-white",children:" "}),r.jsxs("p",{className:"text-xs text-gray-400",children:[D.length,"  "]})]})]}),r.jsxs("div",{className:"flex-none bg-[#1f2937] p-4 pt-2 space-y-3 border-b border-gray-800 z-20",children:[r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"text",placeholder:"    ...",value:V,onChange:O=>q(O.target.value),className:"w-full bg-[#111] border border-gray-700 rounded-xl py-3 pl-4 pr-11 text-white focus:ring-1 focus:ring-red-500 focus:border-red-500 placeholder-gray-500 shadow-inner outline-none transition-all",autoFocus:!0}),r.jsx(Kn,{className:"absolute right-3.5 top-3.5 w-5 h-5 text-gray-500"})]}),r.jsx("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide pb-1",children:B.map(O=>r.jsx("button",{onClick:()=>z(O),className:`px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-all border ${W===O?"bg-red-600 text-white border-red-600 shadow-md":"bg-gray-800 text-gray-400 border-gray-700 hover:border-gray-500"}`,children:O==="all"?"":O},O))})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-[#111] custom-scrollbar",children:D.length>0?r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:D.map(O=>r.jsxs("button",{onClick:()=>R(O.id),className:`w-full flex items-center p-3 rounded-xl border transition-all active:scale-[0.98] ${d===O.id?"bg-red-900/10 border-red-500 shadow-lg shadow-red-900/10 ring-1 ring-red-500/30":"bg-[#1e1e1e] border-gray-800 hover:border-gray-600 hover:bg-[#252525]"}`,children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center overflow-hidden border-2 shadow-sm ${d===O.id?"border-red-500":"border-gray-700 bg-gray-800"}`,children:O.storeImage?r.jsx("img",{src:O.storeImage,alt:O.name,className:"w-full h-full object-cover"}):r.jsx("span",{className:"text-lg font-bold text-gray-500",children:O.name.charAt(0)})}),d===O.id&&r.jsx("div",{className:"absolute -bottom-1 -right-1 bg-red-500 text-white rounded-full p-0.5 border-2 border-[#1e1e1e] shadow-sm animate-bounce",children:r.jsx(nt,{className:"w-3 h-3"})})]}),r.jsxs("div",{className:"mr-3 flex-1 text-right min-w-0",children:[r.jsx("div",{className:"flex justify-between items-start",children:r.jsx("p",{className:`font-bold text-sm truncate ${d===O.id?"text-white":"text-gray-200"}`,children:O.name})}),r.jsx("p",{className:"text-xs text-gray-500 font-mono mt-0.5",children:O.phone}),r.jsx("div",{className:"flex items-center gap-2 mt-1.5",children:r.jsxs("span",{className:"text-[10px] bg-black/40 text-gray-400 px-2 py-0.5 rounded border border-gray-700 flex items-center gap-1",children:[J(O.storeCategory||""),O.storeCategory||" "]})})]})]},O.id))}):r.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[r.jsx(Qo,{className:"w-16 h-16 mb-4 opacity-10"}),r.jsx("p",{className:"text-sm font-bold",children:"    "})]})})]})]})},kR=({activeView:s,onNavigate:e,availableViews:t,isVisible:n=!0,mode:a="dark"})=>{const l=[{id:"orders",label:"",icon:Bt},{id:"users",label:"",icon:Vd},{id:"stores",label:"",icon:lr},{id:"support",label:"",icon:Dr},{id:"messages",label:"",icon:kr},{id:"slider",label:"",icon:Qr},{id:"wallet",label:"",icon:Pc},{id:"settings",label:"",icon:on}],c=m=>{try{e(m)}catch(x){console.error("Navigation error:",x)}},d=t?l.filter(m=>t.includes(m.id)):l.filter(m=>["orders","users","stores","support","messages","wallet","settings"].includes(m.id)),f=a==="light";return r.jsx("div",{className:`fixed left-4 right-4 z-40 transition-transform duration-300 ease-in-out ${n?"translate-y-0 bottom-8":"translate-y-[150%] bottom-8"}`,children:r.jsx("nav",{className:`${f?"bg-white/95 border-gray-200 shadow-[0_10px_30px_rgba(0,0,0,0.12)]":"bg-gray-800/95 border-gray-700 shadow-[0_10px_40px_rgba(0,0,0,0.4)]"} backdrop-blur-xl border flex justify-around items-center h-[70px] rounded-[30px] px-2 transition-colors duration-300`,children:d.map(m=>{const x=m.icon,y=s===m.id;return r.jsxs("button",{onClick:()=>c(m.id),className:"group relative flex-1 h-full flex flex-col items-center justify-center outline-none select-none",type:"button",style:{WebkitTapHighlightColor:"transparent"},children:[r.jsxs("div",{className:`relative transition-all duration-300 ease-out p-2 rounded-2xl ${y?"-translate-y-2":"translate-y-1"}`,children:[r.jsx("div",{className:`absolute inset-0 bg-red-600 rounded-2xl transition-all duration-300 ${y?"opacity-100 scale-100 rotate-3":"opacity-0 scale-50 rotate-0"}`}),r.jsx(x,{className:`w-6 h-6 transition-all duration-300 z-10 relative ${y?"text-white":f?"text-gray-400":"text-gray-500"}`})]}),r.jsx("span",{className:`text-[10px] font-bold tracking-wide transition-all duration-300 absolute bottom-2 ${y?"text-red-600 opacity-100 translate-y-0":`${f?"text-gray-400":"text-gray-500"} opacity-0 translate-y-2`}`,children:m.label})]},m.id)})})})},C5=({status:s,icon:e,color:t,onClick:n,subLabel:a})=>r.jsxs("button",{type:"button",onClick:l=>{l.stopPropagation(),n()},className:`w-full text-right p-4 rounded-xl flex items-center space-x-4 space-x-reverse transition-all duration-200 border border-gray-700 bg-gray-900 active:bg-gray-800 group relative z-10 ${t}`,children:[r.jsx("div",{className:"p-3 bg-white/5 rounded-full group-active:bg-white/10 transition-colors pointer-events-none",children:e}),r.jsxs("div",{className:"pointer-events-none",children:[r.jsx("p",{className:"font-bold text-neutral-100 text-md",children:s}),r.jsx("p",{className:"text-xs text-neutral-400",children:a})]})]}),CR=({order:s,onClose:e,onSelectStatus:t,onTransferOrder:n})=>{Ht(()=>(e(),!0),[e]);const a=s.type==="shopping_order",c=[{status:ue.WaitingMerchant,icon:a?r.jsx(zt,{className:"w-6 h-6 text-purple-400"}):r.jsx(wt,{className:"w-6 h-6 text-purple-400"}),color:"hover:border-purple-500/50",label:a?" ":ue.WaitingMerchant,sub:a?"    ":"  "},{status:ue.Preparing,icon:r.jsx(Xr,{className:"w-6 h-6 text-orange-400"}),color:"hover:border-orange-500/50",label:a?" ":ue.Preparing,sub:a?"  / ":"  "},{status:ue.Pending,icon:r.jsx(Nn,{className:"w-6 h-6 text-yellow-400"}),color:"hover:border-yellow-500/50",label:a?" ":ue.Pending,sub:a?"    ":"  "},{status:ue.InTransit,icon:r.jsx(V5,{className:"w-6 h-6 text-sky-400"}),color:"hover:border-sky-500/50",label:ue.InTransit,sub:"  "},{status:ue.Delivered,icon:r.jsx(nt,{className:"w-6 h-6 text-green-400"}),color:"hover:border-green-500/50",label:ue.Delivered,sub:"   "},{status:ue.Cancelled,icon:r.jsx(rt,{className:"w-6 h-6 text-red-400"}),color:"hover:border-red-500/50",label:ue.Cancelled,sub:"  "}].filter(d=>d.status===s.status||s.status===ue.Pending&&d.status===ue.Delivered?!1:a?!0:d.status!==ue.WaitingMerchant&&d.status!==ue.Preparing);return Cv.createPortal(r.jsx("div",{className:"fixed inset-0 z-[99999] flex items-end sm:items-center justify-center p-0 sm:p-4",style:{backgroundColor:"rgba(0,0,0,0.85)",backdropFilter:"blur(2px)",touchAction:"none"},onClick:d=>{d.preventDefault(),d.stopPropagation(),e()},children:r.jsxs("div",{className:"bg-gray-800 w-full max-w-md rounded-t-2xl sm:rounded-2xl border border-gray-700 shadow-2xl relative flex flex-col max-h-[85vh] animate-sheet-up",onClick:d=>{d.stopPropagation()},children:[r.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-2xl",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-neutral-100",children:"  "}),r.jsxs("p",{className:"font-mono text-xs text-red-400 mt-0.5 tracking-wider",children:[a?"  ":"  ","#",s.id]})]}),r.jsx("button",{type:"button",onClick:d=>{d.stopPropagation(),e()},className:"text-neutral-400 hover:text-white p-3 rounded-full bg-gray-800 hover:bg-gray-700 transition-colors",children:r.jsx(rt,{className:"w-6 h-6"})})]}),r.jsxs("div",{className:"p-5 overflow-y-auto space-y-4 bg-gray-800",children:[r.jsxs("div",{className:"flex justify-between items-center bg-black/20 p-3 rounded-lg border border-white/5",children:[r.jsx("p",{className:"text-sm text-neutral-400 font-medium",children:" :"}),r.jsx("span",{className:"font-bold text-white bg-gray-700 px-3 py-1 rounded-full text-xs border border-gray-600 shadow-sm",children:s.status})]}),s.status===ue.InTransit&&n&&r.jsxs("div",{className:"mb-2",children:[r.jsx(C5,{status:"   ",subLabel:"   ",icon:r.jsx(pt,{className:"w-6 h-6 text-indigo-400"}),color:"bg-indigo-900/10 border-indigo-500/30 hover:bg-indigo-900/20",onClick:()=>n(s)}),r.jsxs("div",{className:"flex items-center gap-2 my-4 opacity-50",children:[r.jsx("div",{className:"h-px bg-gray-600 flex-1"}),r.jsx("span",{className:"text-[10px] text-gray-400 font-bold",children:"  "}),r.jsx("div",{className:"h-px bg-gray-600 flex-1"})]})]}),r.jsx("div",{className:"space-y-3",children:c.map(d=>r.jsx(C5,{status:d.label,subLabel:d.sub,icon:d.icon,color:d.color,onClick:()=>t(s,d.status)},d.status))})]}),r.jsx("div",{className:"p-4 border-t border-gray-700 bg-gray-900 rounded-b-2xl",children:r.jsx("button",{type:"button",onClick:d=>{d.stopPropagation(),e()},className:"w-full py-3.5 rounded-xl bg-gray-800 text-gray-300 font-bold hover:bg-gray-700 transition-colors border border-gray-600 active:bg-gray-600",children:""})})]})}),document.body)},A0=({order:s,drivers:e,onClose:t,onSave:n,targetStatus:a})=>{const[l,c]=j.useState(""),[d,f]=j.useState(s.deliveryFee||""),[m,x]=j.useState(""),[y,w]=j.useState("");Ht(()=>(t(),!0),[t]);const v="w-full px-4 py-4 border border-gray-600 bg-[#111] text-white rounded-xl shadow-inner focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-lg font-bold text-center font-mono",T=s.status===ue.InTransit&&a===ue.InTransit,I=T?"   ":a===ue.Delivered?"  ":"  ",N=T?" ":a===ue.Delivered?"  ":"  ",P=T?"bg-indigo-600 hover:bg-indigo-700":a===ue.Delivered?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700",U=j.useMemo(()=>e.filter(q=>q.name.toLowerCase().includes(m.toLowerCase())||q.phone&&q.phone.includes(m)),[e,m]),V=()=>{const q=d!==""?parseFloat(String(d)):void 0;if(!l||q===void 0||q<0){w("      .");return}w(""),n(l,q)};return Cv.createPortal(r.jsx("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center p-0 sm:p-4 bg-black/80 backdrop-blur-sm transition-all duration-300 animate-fadeIn",style:{touchAction:"none"},onClick:q=>{q.stopPropagation(),t()},children:r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-lg rounded-t-[2rem] sm:rounded-[2rem] border border-gray-700 shadow-2xl relative flex flex-col max-h-[85vh] animate-sheet-up overflow-hidden",onClick:q=>q.stopPropagation(),children:[r.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d] relative z-10",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`p-3 rounded-xl shadow-lg ${T?"bg-indigo-500/20 text-indigo-400":"bg-blue-500/20 text-blue-400"}`,children:r.jsx(Bt,{className:"w-6 h-6"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-white",children:I}),r.jsxs("p",{className:"font-mono text-xs text-gray-400 mt-0.5 tracking-wider",children:["ORDER #",s.id]})]})]}),r.jsx("button",{type:"button",onClick:t,className:"text-gray-400 hover:text-white p-2 rounded-full bg-gray-800 hover:bg-gray-700 transition-colors",children:r.jsx(rt,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto custom-scrollbar bg-[#1e293b] relative",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 uppercase tracking-wide",children:" "}),r.jsxs("div",{className:"bg-[#111] rounded-2xl border border-gray-700 overflow-hidden shadow-sm",children:[r.jsxs("div",{className:"relative border-b border-gray-700",children:[r.jsx(Kn,{className:"absolute top-1/2 right-4 transform -translate-y-1/2 w-5 h-5 text-gray-500"}),r.jsx("input",{type:"text",placeholder:"   ...",value:m,onChange:q=>x(q.target.value),className:"w-full pr-12 pl-4 py-4 bg-[#111] text-white placeholder:text-gray-600 focus:outline-none transition-colors text-sm"})]}),r.jsxs("div",{className:"max-h-48 overflow-y-auto p-2 space-y-1 custom-scrollbar",children:[U.map(q=>r.jsxs("button",{type:"button",onClick:()=>c(q.id),className:`w-full flex justify-between items-center text-right p-3 rounded-xl transition-all duration-200 border ${l===q.id?"bg-blue-600 text-white border-blue-500 shadow-md transform scale-[1.02]":"bg-transparent border-transparent text-gray-300 hover:bg-gray-800"}`,children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-bold block text-sm",children:q.name}),r.jsxs("span",{className:`text-xs font-mono flex items-center gap-1 mt-0.5 ${l===q.id?"text-blue-200":"text-gray-500"}`,children:[r.jsx(Js,{className:"w-3 h-3"}),q.phone]})]}),l===q.id&&r.jsx(nt,{className:"w-5 h-5 text-white"})]},q.id)),U.length===0&&r.jsx("div",{className:"text-center py-6 text-gray-500 text-sm",children:"   "})]})]})]}),r.jsxs("div",{className:"bg-[#151e2d] p-4 rounded-2xl border border-gray-700",children:[r.jsx("label",{htmlFor:"deliveryFee",className:"block text-xs font-bold text-gray-400 mb-3 text-center uppercase tracking-wide",children:T?"  ()":"  "}),r.jsxs("div",{className:"relative max-w-[200px] mx-auto",children:[r.jsx("input",{type:"number",id:"deliveryFee",value:d,onChange:q=>f(q.target.value),placeholder:"0",className:v}),r.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-bold text-sm pointer-events-none",children:"."})]})]}),y&&r.jsx("div",{className:"text-red-400 text-xs font-bold bg-red-900/20 p-3 rounded-xl border border-red-500/30 text-center animate-bounce",children:y})]}),r.jsx("div",{className:"p-5 bg-[#151e2d] border-t border-gray-700 relative z-10",children:r.jsx("button",{type:"button",onClick:V,className:`w-full py-4 text-base font-bold text-white rounded-xl shadow-lg shadow-black/20 transition-all active:scale-[0.98] flex justify-center items-center gap-2 ${P}`,children:N})})]})}),document.body)},SW=({users:s,onClose:e,onSelect:t,title:n})=>{const[a,l]=j.useState(""),[c,d]=j.useState(7),f=j.useMemo(()=>{const x=a.toLowerCase();return s.filter(y=>{const w=y.role==="driver"?"":y.role==="merchant"?"":y.role==="admin"?"":"";return y.name.toLowerCase().includes(x)||y.phone&&y.phone.includes(x)||w.includes(x)})},[s,a]),m=[{label:"24 ",value:1},{label:"3 ",value:3},{label:"",value:7},{label:"",value:30},{label:"",value:null}];return r.jsx("div",{className:"fixed inset-0 z-[80] bg-black/90 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-2xl border border-gray-700 shadow-2xl flex flex-col max-h-[85vh]",onClick:x=>x.stopPropagation(),children:[r.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-[#151e2d] rounded-t-2xl",children:[r.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[r.jsx(sd,{className:"w-5 h-5 text-yellow-400"}),n]}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:r.jsx(rt,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"p-4 border-b border-gray-700/50 space-y-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"text-xs font-bold text-gray-400 mb-2 flex items-center gap-1",children:[r.jsx(wt,{className:"w-3 h-3"}),"  ( )"]}),r.jsx("div",{className:"flex bg-[#0f172a] p-1 rounded-xl border border-gray-600 overflow-x-auto scrollbar-hide",children:m.map(x=>r.jsx("button",{onClick:()=>d(x.value),className:`flex-1 min-w-[60px] py-2 text-[10px] font-bold rounded-lg transition-all whitespace-nowrap ${c===x.value?"bg-blue-600 text-white shadow-md":"text-gray-400 hover:text-white"}`,children:x.label},x.label))})]}),r.jsxs("div",{className:"relative",children:[r.jsx(Kn,{className:"absolute right-3 top-2.5 w-4 h-4 text-gray-500"}),r.jsx("input",{type:"text",placeholder:"   ...",value:a,onChange:x=>l(x.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-2 pl-4 pr-10 text-white text-sm focus:border-blue-500 outline-none",autoFocus:!0})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-2 custom-scrollbar",children:f.length>0?f.map(x=>r.jsxs("button",{onClick:()=>t(x,c),className:"w-full flex items-center justify-between p-3 hover:bg-gray-700/50 rounded-xl transition-colors border-b border-gray-700/30 last:border-0 group",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border border-gray-600",children:x.storeImage?r.jsx("img",{src:x.storeImage,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-5 h-5 text-gray-400"})}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-sm font-bold text-white group-hover:text-yellow-400 transition-colors",children:x.name}),r.jsxs("p",{className:"text-[10px] text-gray-500 flex items-center gap-1",children:[r.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${x.role==="driver"?"bg-orange-500":x.role==="merchant"?"bg-purple-500":x.role==="admin"?"bg-red-500":"bg-blue-500"}`}),x.role==="driver"?"":x.role==="merchant"?"":x.role==="admin"?"":""]})]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-1",children:[r.jsx("div",{className:"bg-blue-600 text-white px-3 py-1 rounded-lg text-xs font-bold shadow-lg shadow-blue-900/20",children:""}),c&&r.jsxs("span",{className:"text-[9px] text-gray-400",children:[c," "]})]})]},x.id)):r.jsx("p",{className:"text-center text-gray-500 py-8 text-sm",children:"  "})})]})})},Ap={All:({className:s})=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),Restaurant:({className:s})=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[r.jsx("path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"}),r.jsx("path",{d:"M7 2v20"}),r.jsx("path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"})]}),Market:({className:s})=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),Pharmacy:({className:s})=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[r.jsx("path",{d:"M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8z"}),r.jsx("path",{d:"M12 7v10"}),r.jsx("path",{d:"M7 12h10"})]})},RR=({onClose:s,currentTheme:e,onUpdateTheme:t,appConfig:n,onUpdateAppConfig:a,users:l,onUpdateUser:c,sendNotification:d,currentUser:f})=>{const[m,x]=j.useState("main"),[y,w]=j.useState("frames"),[v,T]=j.useState(!1),[I,N]=j.useState(!1),[P,U]=j.useState(!1),[V,q]=j.useState(""),[W,z]=j.useState(null),[k,M]=j.useState("frame"),[B,D]=j.useState(!1),[S,F]=j.useState(null),[E,Y]=j.useState(""),[X,R]=j.useState(!1),[J,O]=j.useState([]),[K,Q]=j.useState(n==null?void 0:n.customFont),[L,G]=j.useState(null),ee=j.useRef(null),ne=j.useRef(null),je=j.useRef(null),[se,_e]=j.useState(null),[Te,be]=j.useState(null);Ht(()=>B?(D(!1),!0):L!=null&&L.isOpen?(G(null),!0):I?(N(!1),!0):P?(U(!1),!0):m!=="main"?(x("main"),!0):(s(),!0),[m,I,L,P,B]),j.useEffect(()=>{Q(n==null?void 0:n.customFont)},[n==null?void 0:n.customFont]),j.useEffect(()=>{var we;(we=e.customer)!=null&&we.categories&&e.customer.categories.length>0?O(e.customer.categories):O([{id:"all",key:"cat_all",label:"",isVisible:!0,sortOrder:0},{id:"restaurant",key:"cat_restaurant",label:"",isVisible:!0,sortOrder:1},{id:"market",key:"cat_market",label:"",isVisible:!0,sortOrder:2},{id:"pharmacy",key:"cat_pharmacy",label:"",isVisible:!0,sortOrder:3}])},[e]);const ye=(we,pe)=>{const he={...e[we]||{icons:{},splash:{},layout:{}},...pe};t(we,he),T(!0),setTimeout(()=>T(!1),1500)},et=we=>{var Re;_e(we);const pe=J.find(he=>he.id===we);be((pe==null?void 0:pe.icon)||null),(Re=ee.current)==null||Re.click()},Je=we=>new Promise((pe,Re)=>{const he=new FileReader;he.onload=Me=>{var tt;const ze=new Image;ze.src=(tt=Me.target)==null?void 0:tt.result,ze.onload=()=>{const Se=document.createElement("canvas"),Fe=128;Se.width=Fe,Se.height=Fe;const it=Se.getContext("2d");if(!it){Re("Canvas error");return}const at=Math.min(Fe/ze.width,Fe/ze.height),Gt=Fe/2-ze.width/2*at,Ks=Fe/2-ze.height/2*at;it.drawImage(ze,Gt,Ks,ze.width*at,ze.height*at),pe(Se.toDataURL("image/png"))},ze.onerror=Re},he.onerror=Re,he.readAsDataURL(we)}),bt=async we=>{var Re;const pe=(Re=we.target.files)==null?void 0:Re[0];if(pe&&se){R(!0);try{const he=await Je(pe),Me=J.map(ze=>ze.id===se?{...ze,icon:he}:ze);O(Me),ye("customer",{categories:Me}),be(he)}catch(he){console.error("Error processing icon:",he),alert("    ")}finally{R(!1)}}ee.current&&(ee.current.value="")},yt=async we=>{var Re;const pe=(Re=we.target.files)==null?void 0:Re[0];if(pe){if(!pe.name.endsWith(".ttf")){alert("       .ttf");return}R(!0);const he=new FileReader;he.onload=Me=>{var tt;const ze=(tt=Me.target)==null?void 0:tt.result;Q(ze),a&&n&&(a({...n,customFont:ze}),T(!0),setTimeout(()=>T(!1),2e3)),R(!1)},he.onerror=()=>{R(!1),alert("   ")},he.readAsDataURL(pe)}je.current&&(je.current.value="")},Ae=()=>{G({isOpen:!0,title:"  ",message:"         ",variant:"danger",onConfirm:()=>{Q(void 0),a&&n&&(a({...n,customFont:""}),T(!0),setTimeout(()=>T(!1),2e3)),G(null)}})},fe=we=>{var Re;const pe=(Re=we.target.files)==null?void 0:Re[0];if(pe){if(!pe.type.includes("png")&&!pe.type.includes("gif")){alert("    PNG  GIF");return}const he=new FileReader;he.onload=Me=>{var ze;z((ze=Me.target)==null?void 0:ze.result)},he.readAsDataURL(pe)}ne.current&&(ne.current.value="")},$e=()=>{if(!V||!W)return;const pe={id:`${k}_${Date.now()}`,label:V,url:W,type:k},he=[...k==="frame"?e.customer.customFrames||[]:e.customer.customBadges||[],pe];ye("customer",k==="frame"?{customFrames:he}:{customBadges:he}),q(""),z(null),U(!1)},ce=(we,pe)=>{G({isOpen:!0,title:` ${pe==="frame"?"":""}`,message:"    ",variant:"danger",onConfirm:()=>{const he=(pe==="frame"?e.customer.customFrames||[]:e.customer.customBadges||[]).filter(Me=>Me.id!==we);ye("customer",pe==="frame"?{customFrames:he}:{customBadges:he}),G(null)}})},Oe=we=>{F(we),D(!0)},Pe=(we,pe)=>{if(!S)return;const Re={},he=S.type==="frame"?"":"";let Me=null;if(pe){const Se=new Date;Se.setDate(Se.getDate()+pe),Me=Se.toISOString()}S.type==="frame"?(Re.specialFrame=S.url,Re.specialFrameExpiry=Me):(Re.specialBadge=S.url,Re.specialBadgeExpiry=Me),c(we.id,Re);const ze=pe?` ${pe} `:" ",tt=`!   ${he}  (${S.label}) ${ze}.     !`;d(we.role,{title:" ! ",body:tt,targetId:we.id,url:"/?target=profile"}),D(!1),F(null),T(!0),setTimeout(()=>T(!1),2e3)},Ge=()=>{if(!E.trim())return;const we=`cat_${Date.now()}`,pe={id:we,key:we,label:E,isVisible:!0,sortOrder:J.length},Re=[...J,pe];O(Re),ye("customer",{categories:Re}),Y(""),N(!1)},Ke=we=>{G({isOpen:!0,title:" ",message:"      ",variant:"danger",onConfirm:()=>{const pe=J.filter(Re=>Re.id!==we);O(pe),ye("customer",{categories:pe}),G(null)}})},Ie=we=>{const pe=J.map(Re=>Re.id===we?{...Re,isVisible:!Re.isVisible}:Re);O(pe),ye("customer",{categories:pe})},Le=we=>{G({isOpen:!0,title:" ",message:"      ",variant:"primary",onConfirm:()=>{const pe=J.map(Re=>Re.id===we?{...Re,icon:void 0}:Re);O(pe),ye("customer",{categories:pe}),G(null)}})},Lt=(we,pe)=>{const Re=J.map(he=>he.id===we?{...he,label:pe}:he);O(Re)},bs=()=>{ye("customer",{categories:J})},Zt=j.useMemo(()=>l.filter(we=>we.specialFrame||we.specialBadge),[l]),Ws=(we,pe)=>{G({isOpen:!0,title:` ${pe==="frame"?"":""}`,message:`     ${pe==="frame"?"":""}  ${we.name}`,variant:"danger",onConfirm:()=>{const Re={};pe==="frame"?(Re.specialFrame=null,Re.specialFrameExpiry=null):(Re.specialBadge=null,Re.specialBadgeExpiry=null),c(we.id,Re),G(null)}})},Ds=e.customer.customFrames||[],En=e.customer.customBadges||[],hr=()=>{switch(m){case"categories":return" ";case"decorations":return" ";case"active_gifts":return"  ";default:return" "}};return f==null||f.role,r.jsxs("div",{className:"fixed inset-0 z-[60] bg-[#0f172a] text-white flex flex-col overflow-hidden animate-fadeIn",children:[v&&r.jsx("div",{className:"absolute inset-0 z-[70] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-fadeIn",children:r.jsxs("div",{className:"bg-green-600 px-6 py-3 rounded-full shadow-2xl flex items-center gap-2 animate-bounce",children:[r.jsx(nt,{className:"w-6 h-6 text-white"}),r.jsx("span",{className:"font-bold text-white",children:"  "})]})}),r.jsx("div",{className:"flex-none px-4 pt-safe h-16 box-content flex items-center justify-between border-b border-gray-800 bg-[#1e293b]/90 backdrop-blur-md sticky top-0 z-20 shadow-md",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:m==="main"?s:()=>x("main"),className:"p-2 rounded-full bg-gray-800 hover:bg-gray-700 transition-colors border border-gray-700",children:r.jsx(Gs,{className:"w-6 h-6 rotate-180"})}),r.jsx("h1",{className:"text-xl font-black tracking-wide",children:hr()})]})}),r.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[r.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-blue-600/5 rounded-full blur-[120px] pointer-events-none translate-x-1/2 -translate-y-1/2"}),m==="main"&&r.jsx("div",{className:"h-full overflow-y-auto custom-scrollbar",children:r.jsxs("div",{className:"max-w-5xl mx-auto w-full p-6 flex flex-col gap-8 min-h-full",children:[r.jsxs("div",{className:"bg-[#1e293b]/80 backdrop-blur-sm rounded-[2rem] p-6 border border-gray-700 shadow-xl relative overflow-hidden group",children:[r.jsx("div",{className:"absolute top-0 left-0 w-1.5 h-full bg-blue-500"}),r.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start md:items-center",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[r.jsx(Bf,{className:"w-6 h-6 text-blue-400"})," "]}),K&&r.jsxs("span",{className:"bg-green-500/20 text-green-400 text-[10px] font-bold px-2 py-1 rounded-full border border-green-500/20 flex items-center gap-1",children:[r.jsx(nt,{className:"w-3 h-3"})," "]})]}),r.jsxs("p",{className:"text-gray-400 text-sm leading-relaxed",children:["     ",r.jsx("code",{children:".ttf"}),"        ."]})]}),r.jsxs("div",{className:"flex gap-3 w-full md:w-auto",children:[r.jsx("button",{onClick:()=>{var we;return(we=je.current)==null?void 0:we.click()},disabled:X,className:"flex-1 md:flex-none bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg active:scale-95 transition-all flex justify-center items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed min-w-[160px]",children:X?r.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):r.jsxs(r.Fragment,{children:[r.jsx(ur,{className:"w-5 h-5"}),r.jsx("span",{children:"  (.ttf)"})]})}),K&&r.jsx("button",{onClick:Ae,className:"px-4 bg-red-500/10 hover:bg-red-500/20 text-red-400 font-bold py-3 rounded-xl transition-colors border border-red-500/20",title:"  ",children:r.jsx(Pt,{className:"w-5 h-5"})})]}),r.jsx("input",{type:"file",ref:je,accept:".ttf",className:"hidden",onChange:yt})]})]}),r.jsxs("div",{children:[r.jsxs("h2",{className:"text-lg font-bold text-gray-400 mb-4 px-2 flex items-center gap-2",children:[r.jsx(Av,{className:"w-5 h-5"})," "]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[r.jsxs("button",{onClick:()=>x("categories"),className:"group relative overflow-hidden bg-gradient-to-br from-cyan-900 to-blue-900 rounded-[2rem] p-8 flex items-center justify-between shadow-lg hover:shadow-cyan-500/20 transition-all active:scale-98 border border-white/5 h-40",children:[r.jsxs("div",{className:"z-10 text-right",children:[r.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:translate-x-1 transition-transform",children:" "}),r.jsx("p",{className:"text-cyan-200 text-sm font-medium",children:"   "})]}),r.jsx("div",{className:"w-16 h-16 bg-white/10 rounded-2xl flex items-center justify-center z-10 backdrop-blur-sm border border-white/10 group-hover:scale-110 transition-transform duration-500",children:r.jsx(Sn,{className:"w-8 h-8 text-cyan-300"})}),r.jsx("div",{className:"absolute -bottom-10 -left-10 w-40 h-40 bg-cyan-500/20 rounded-full blur-[50px] group-hover:bg-cyan-400/30 transition-colors"})]}),r.jsxs("button",{onClick:()=>x("decorations"),className:"group relative overflow-hidden bg-gradient-to-br from-purple-900 to-pink-900 rounded-[2rem] p-8 flex items-center justify-between shadow-lg hover:shadow-purple-500/20 transition-all active:scale-98 border border-white/5 h-40",children:[r.jsxs("div",{className:"z-10 text-right",children:[r.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:translate-x-1 transition-transform",children:" "}),r.jsx("p",{className:"text-purple-200 text-sm font-medium",children:"   "})]}),r.jsx("div",{className:"w-16 h-16 bg-white/10 rounded-2xl flex items-center justify-center z-10 backdrop-blur-sm border border-white/10 group-hover:scale-110 transition-transform duration-500",children:r.jsx(va,{className:"w-8 h-8 text-purple-300"})}),r.jsx("div",{className:"absolute -bottom-10 -left-10 w-40 h-40 bg-purple-500/20 rounded-full blur-[50px] group-hover:bg-purple-400/30 transition-colors"})]}),r.jsxs("button",{onClick:()=>x("active_gifts"),className:"group relative overflow-hidden bg-gradient-to-br from-gray-800 to-gray-900 rounded-[2rem] p-8 flex items-center justify-between shadow-lg hover:shadow-gray-500/20 transition-all active:scale-98 border border-white/5 h-40 md:col-span-2",children:[r.jsxs("div",{className:"z-10 text-right",children:[r.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:translate-x-1 transition-transform",children:"  "}),r.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"   "})]}),r.jsx("div",{className:"w-16 h-16 bg-white/10 rounded-2xl flex items-center justify-center z-10 backdrop-blur-sm border border-white/10 group-hover:scale-110 transition-transform duration-500",children:r.jsx(Wn,{className:"w-8 h-8 text-white"})})]})]})]})]})}),m==="active_gifts"&&r.jsx("div",{className:"h-full overflow-y-auto custom-scrollbar p-6 bg-[#0f172a]",children:r.jsx("div",{className:"max-w-4xl mx-auto space-y-4",children:Zt.length===0?r.jsxs("div",{className:"text-center py-20 text-gray-500 bg-gray-800/30 rounded-3xl border border-dashed border-gray-700",children:[r.jsx(sd,{className:"w-16 h-16 mx-auto mb-4 opacity-30"}),r.jsx("p",{className:"font-bold",children:"   "})]}):r.jsx("div",{className:"grid gap-4",children:Zt.map(we=>{const pe=we.specialFrameExpiry?new Date(we.specialFrameExpiry):null,Re=we.specialBadgeExpiry?new Date(we.specialBadgeExpiry):null,he=new Date,Me=ze=>{if(!ze)return"";const tt=ze.getTime()-he.getTime(),Se=Math.ceil(tt/(1e3*60*60*24));return Se>0?` ${Se} `:""};return r.jsxs("div",{className:"bg-[#1e293b] p-4 rounded-2xl border border-gray-700 shadow-md flex flex-col md:flex-row items-center justify-between gap-4",children:[r.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[r.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border border-gray-600",children:we.storeImage?r.jsx("img",{src:we.storeImage,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-6 h-6 text-gray-400"})}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-bold text-white text-lg",children:we.name}),r.jsx("p",{className:"text-gray-400 text-xs font-mono",children:we.phone})]})]}),r.jsxs("div",{className:"flex flex-col md:flex-row gap-4 w-full md:w-auto",children:[we.specialFrame&&r.jsxs("div",{className:"bg-black/20 p-3 rounded-xl border border-white/5 flex items-center gap-3 flex-1",children:[r.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center overflow-hidden",children:we.specialFrame.startsWith("http")||we.specialFrame.startsWith("data:")?r.jsx("img",{src:we.specialFrame,className:"w-full h-full object-cover"}):r.jsx("span",{className:"text-[10px]",children:""})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"text-xs text-gray-300 font-bold",children:""}),r.jsx("p",{className:"text-[10px] text-yellow-500",children:Me(pe)})]}),r.jsx("button",{onClick:()=>Ws(we,"frame"),className:"text-red-400 hover:bg-red-500/10 p-2 rounded-lg transition-colors",children:r.jsx(Pt,{className:"w-4 h-4"})})]}),we.specialBadge&&r.jsxs("div",{className:"bg-black/20 p-3 rounded-xl border border-white/5 flex items-center gap-3 flex-1",children:[r.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center overflow-hidden",children:we.specialBadge.startsWith("http")||we.specialBadge.startsWith("data:")?r.jsx("img",{src:we.specialBadge,className:"w-full h-full object-cover"}):r.jsx("span",{className:"text-[10px]",children:""})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"text-xs text-gray-300 font-bold",children:""}),r.jsx("p",{className:"text-[10px] text-blue-400",children:Me(Re)})]}),r.jsx("button",{onClick:()=>Ws(we,"badge"),className:"text-red-400 hover:bg-red-500/10 p-2 rounded-lg transition-colors",children:r.jsx(Pt,{className:"w-4 h-4"})})]})]})]},we.id)})})})}),m==="decorations"&&r.jsxs("div",{className:"flex flex-col h-full",children:[r.jsxs("div",{className:"flex border-b border-gray-800 bg-[#151e2d] z-10 shadow-sm flex-none",children:[r.jsxs("button",{onClick:()=>w("frames"),className:`flex-1 py-4 font-bold text-sm transition-colors relative ${y==="frames"?"text-white":"text-gray-500 hover:text-gray-300"}`,children:[" (Frames)",y==="frames"&&r.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-purple-500"})]}),r.jsxs("button",{onClick:()=>w("badges"),className:`flex-1 py-4 font-bold text-sm transition-colors relative ${y==="badges"?"text-white":"text-gray-500 hover:text-gray-300"}`,children:[" (Badges)",y==="badges"&&r.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-500"})]})]}),r.jsxs("div",{className:"flex-none p-4 bg-[#1a1a1a] border-b border-gray-800 flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h3",{className:`font-bold text-lg ${y==="frames"?"text-purple-400":"text-blue-400"}`,children:y==="frames"?" ":" "}),r.jsx("p",{className:"text-xs text-gray-400",children:y==="frames"?" GIF  PNG .":"   ."})]}),r.jsxs("button",{onClick:()=>{M(y==="frames"?"frame":"badge"),U(!0)},className:`px-4 py-2 rounded-xl text-sm font-bold flex items-center gap-2 transition-colors shadow-lg active:scale-95 ${y==="frames"?"bg-purple-600 hover:bg-purple-700 text-white shadow-purple-900/20":"bg-blue-600 hover:bg-blue-700 text-white shadow-blue-900/20"}`,children:[r.jsx(ln,{className:"w-4 h-4"}),"  "]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar bg-[#0f172a]",children:y==="frames"?r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 pb-10",children:Ds.length>0?Ds.map(we=>r.jsxs("div",{className:"bg-[#1e293b] p-4 rounded-xl border border-gray-700 flex flex-col items-center gap-3 relative group hover:border-purple-500 transition-colors shadow-sm",children:[r.jsxs("div",{className:"relative w-24 h-24 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 m-auto w-20 h-20 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border-2 border-gray-600",children:r.jsx(pt,{className:"w-10 h-10 text-gray-500"})}),r.jsx("img",{src:we.url,className:"absolute inset-0 w-full h-full object-contain pointer-events-none z-10",alt:we.label})]}),r.jsx("div",{className:"text-center w-full",children:r.jsx("p",{className:"font-bold text-sm truncate w-full text-gray-200",children:we.label})}),r.jsxs("div",{className:"flex gap-2 w-full justify-center",children:[r.jsxs("button",{onClick:()=>Oe(we),className:"px-3 py-1.5 bg-yellow-500/10 text-yellow-400 rounded-lg text-xs font-bold hover:bg-yellow-500/20 transition-colors flex items-center gap-1",children:[r.jsx(sd,{className:"w-3 h-3"})," "]}),(f==null?void 0:f.role)==="admin"&&r.jsx("button",{onClick:()=>ce(we.id,"frame"),className:"p-1.5 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500/20 transition-colors",title:"  ",children:r.jsx(Pt,{className:"w-4 h-4"})})]})]},we.id)):r.jsxs("div",{className:"col-span-full py-20 text-center text-gray-500 border-2 border-dashed border-gray-800 rounded-2xl",children:[r.jsx(Qr,{className:"w-12 h-12 mx-auto mb-2 opacity-30"}),r.jsx("p",{className:"font-bold",children:" "}),r.jsx("p",{className:"text-xs",children:"    "})]})}):r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3 pb-10",children:En.length>0?En.map(we=>r.jsxs("div",{className:"bg-[#1e293b] p-3 rounded-2xl border border-gray-700 flex flex-col items-center gap-3 relative group hover:border-blue-500 transition-colors shadow-sm",children:[r.jsxs("div",{className:"w-20 h-20 bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl flex items-center justify-center border border-gray-600 shadow-inner relative overflow-hidden group-hover:border-blue-500 transition-colors",children:[r.jsx("div",{className:"absolute inset-0 bg-blue-500/5 opacity-0 group-hover:opacity-100 transition-opacity"}),r.jsx("img",{src:we.url,className:"w-full h-full object-contain p-3 drop-shadow-md",alt:we.label})]}),r.jsx("p",{className:"font-bold text-xs truncate w-full text-center text-gray-200",children:we.label}),r.jsxs("div",{className:"flex gap-2 w-full justify-center mt-auto",children:[r.jsx("button",{onClick:()=>Oe(we),className:"px-3 py-1.5 bg-yellow-500/10 text-yellow-400 rounded-lg text-xs font-bold hover:bg-yellow-500/20 transition-colors flex-1 flex items-center justify-center gap-1",title:"",children:r.jsx(sd,{className:"w-3 h-3"})}),(f==null?void 0:f.role)==="admin"&&r.jsx("button",{onClick:()=>ce(we.id,"badge"),className:"p-1.5 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500/20 transition-colors",title:"  ",children:r.jsx(Pt,{className:"w-3 h-3"})})]})]},we.id)):r.jsxs("div",{className:"col-span-full py-20 text-center text-gray-500 border-2 border-dashed border-gray-800 rounded-2xl",children:[r.jsx(va,{className:"w-12 h-12 mx-auto mb-2 opacity-30"}),r.jsx("p",{className:"font-bold",children:" "}),r.jsx("p",{className:"text-xs",children:"   "})]})})})]}),m==="categories"&&r.jsxs("div",{className:"flex flex-col h-full",children:[r.jsxs("div",{className:"flex-none p-6 border-b border-gray-800 bg-[#1a1a1a] flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-bold text-lg text-white",children:" "}),r.jsx("p",{className:"text-xs text-gray-400",children:"     "})]}),r.jsxs("button",{onClick:()=>N(!0),className:"bg-cyan-600 hover:bg-cyan-700 text-white px-4 py-2 rounded-xl text-sm font-bold flex items-center gap-2 transition-colors shadow-lg shadow-cyan-900/20 active:scale-95",children:[r.jsx(ln,{className:"w-4 h-4"}),"  "]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-[#0f172a] custom-scrollbar",children:r.jsx("div",{className:"grid gap-3 max-w-4xl mx-auto pb-10",children:J.map((we,pe)=>{const Re=we.key==="cat_all"?Ap.All:we.key==="cat_restaurant"?Ap.Restaurant:we.key==="cat_market"?Ap.Market:we.key==="cat_pharmacy"?Ap.Pharmacy:Sn;return r.jsxs("div",{className:"bg-[#1e293b] p-3 rounded-2xl border border-gray-700 flex items-center gap-4 group hover:border-gray-500 transition-colors shadow-sm",children:[r.jsxs("div",{onClick:()=>et(we.id),className:"w-14 h-14 bg-[#0f172a] rounded-xl flex items-center justify-center cursor-pointer border border-gray-600 hover:border-blue-500 relative overflow-hidden flex-shrink-0 shadow-inner group-hover:scale-105 transition-transform",children:[X&&se===we.id?r.jsx("div",{className:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}):we.icon?r.jsx("img",{src:we.icon,alt:we.label,className:"w-full h-full object-contain p-3"}):r.jsx(Re,{className:"w-6 h-6 text-gray-500"}),r.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center transition-opacity backdrop-blur-[1px]",children:r.jsx(cr,{className:"w-4 h-4 text-white"})})]}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("input",{type:"text",value:we.label,onChange:he=>Lt(we.id,he.target.value),onBlur:bs,className:"w-full bg-transparent text-white font-bold text-lg outline-none border-b border-transparent focus:border-blue-500 pb-1 transition-colors"}),r.jsxs("p",{className:"text-[10px] text-gray-500 truncate font-mono mt-1 opacity-60",children:["ID: ",we.key]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[we.icon&&r.jsx("button",{onClick:()=>Le(we.id),className:"p-2.5 rounded-xl text-yellow-400 bg-yellow-400/10 hover:bg-yellow-400/20 transition-colors border border-yellow-400/20",title:" ",children:r.jsx(Qp,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>Ie(we.id),className:`p-2.5 rounded-xl transition-colors border ${we.isVisible?"text-green-400 bg-green-400/10 border-green-400/20":"text-gray-500 bg-gray-800 border-gray-700"}`,title:we.isVisible?"":"",children:we.isVisible?r.jsx(wa,{className:"w-4 h-4"}):r.jsx(Ui,{className:"w-4 h-4"})}),we.id!=="all"&&r.jsx("button",{onClick:()=>Ke(we.id),className:"p-2.5 rounded-xl text-red-400 bg-red-400/10 hover:bg-red-400/20 transition-colors border border-red-400/20",title:"",children:r.jsx(Pt,{className:"w-4 h-4"})})]})]},we.id)})})})]})]}),P&&r.jsx("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>U(!1),children:r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-3xl border border-gray-700 shadow-2xl p-6 animate-pop-in",onClick:we=>we.stopPropagation(),children:[r.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2",children:[r.jsx(ur,{className:"w-6 h-6 text-green-500"}),k==="frame"?"  ":"  "]}),r.jsxs("div",{className:"space-y-5",children:[r.jsx("div",{onClick:()=>{var we;return(we=ne.current)==null?void 0:we.click()},className:`w-full h-40 bg-[#0f172a] border-2 border-dashed ${W?"border-green-500":"border-gray-600"} rounded-2xl flex flex-col items-center justify-center cursor-pointer hover:bg-gray-800 transition-colors group relative overflow-hidden`,children:W?r.jsx("img",{src:W,alt:"Preview",className:"h-full object-contain p-4 animate-fadeIn"}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-12 h-12 bg-gray-800 rounded-full flex items-center justify-center mb-2 group-hover:scale-110 transition-transform",children:r.jsx(Qr,{className:"w-6 h-6 text-gray-500 group-hover:text-white"})}),r.jsx("span",{className:"text-xs text-gray-400 font-medium",children:"   (PNG/GIF)"})]})}),r.jsx("input",{ref:ne,type:"file",accept:"image/png, image/gif",className:"hidden",onChange:fe}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2",children:" / "}),r.jsx("input",{type:"text",value:V,onChange:we=>q(we.target.value),placeholder:k==="frame"?":   ":":   ",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3.5 text-white focus:border-green-500 outline-none transition-colors"})]}),r.jsx("button",{onClick:$e,disabled:!V.trim()||!W,className:"w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3.5 rounded-xl shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all active:scale-95",children:" "})]})]})}),B&&S&&r.jsx(SW,{users:l,onClose:()=>D(!1),onSelect:Pe,title:` ${S.type==="frame"?"":""} "${S.label}"`}),I&&r.jsx("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>N(!1),children:r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-3xl border border-gray-700 shadow-2xl p-6 animate-pop-in",onClick:we=>we.stopPropagation(),children:[r.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2",children:[r.jsx(ln,{className:"w-6 h-6 text-blue-500"}),"  "]}),r.jsxs("div",{className:"space-y-5",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2",children:"  (  )"}),r.jsx("input",{type:"text",value:E,onChange:we=>Y(we.target.value),placeholder:":  ...",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3.5 text-white focus:border-blue-500 outline-none transition-colors",autoFocus:!0})]}),r.jsx("button",{onClick:Ge,disabled:!E.trim(),className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3.5 rounded-xl shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all active:scale-95",children:""})]})]})}),L&&r.jsx(os,{title:L.title,message:L.message,onClose:()=>G(null),onConfirm:L.onConfirm,confirmVariant:L.variant||"primary",confirmButtonText:" "}),r.jsx("input",{type:"file",ref:ee,className:"hidden",accept:"image/*",onChange:bt})]})},DR=({logs:s,onClearLogs:e})=>{const[t,n]=j.useState(""),[a,l]=j.useState("all"),[c,d]=j.useState(!1),[f,m]=j.useState(20),x=j.useMemo(()=>(m(20),s.filter(N=>{const P=N.actorName.toLowerCase().includes(t.toLowerCase())||N.target.toLowerCase().includes(t.toLowerCase())||N.details.toLowerCase().includes(t.toLowerCase()),U=a==="all"||N.actionType===a;return P&&U}).sort((N,P)=>{const U=new Date(N.createdAt).getTime();return new Date(P.createdAt).getTime()-U})),[s,t,a]),y=j.useMemo(()=>x.slice(0,f),[x,f]),w=N=>{switch(N){case"create":return"text-green-400 bg-green-500/10 border-green-500/20";case"delete":return"text-red-400 bg-red-500/10 border-red-500/20";case"update":return"text-blue-400 bg-blue-500/10 border-blue-500/20";case"login":return"text-purple-400 bg-purple-500/10 border-purple-500/20";case"financial":return"text-yellow-400 bg-yellow-500/10 border-yellow-500/20";default:return"text-gray-400 bg-gray-500/10 border-gray-500/20"}},v=N=>{switch(N){case"create":return" ";case"delete":return" ";case"update":return" ";case"login":return" ";case"financial":return" ";default:return N}},T=N=>{try{const P=new Date(N);if(isNaN(P.getTime()))return{dayName:" ",dateStr:"--",timeStr:"--"};const U=P.toLocaleDateString("ar-EG-u-nu-latn",{weekday:"long"}),V=P.toLocaleDateString("ar-EG-u-nu-latn",{day:"numeric",month:"long",year:"numeric"}),q=P.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"2-digit",minute:"2-digit",hour12:!0});return{dayName:U,dateStr:V,timeStr:q}}catch{return{dayName:"-",dateStr:"-",timeStr:"-"}}},I=()=>{e(),d(!1)};return r.jsxs("div",{className:"space-y-6 pb-24 animate-fadeIn",children:[r.jsxs("div",{className:"bg-gray-800 p-4 rounded-2xl shadow-lg border border-gray-700/50 flex flex-col md:flex-row gap-4 items-center",children:[r.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[r.jsx("div",{className:"p-3 bg-blue-500/20 rounded-xl text-blue-400",children:r.jsx(Yr,{className:"w-6 h-6"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-white",children:" "}),r.jsx("p",{className:"text-xs text-gray-400",children:"     "})]})]}),r.jsxs("div",{className:"relative flex-1 w-full flex items-center gap-3",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(Kn,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 w-5 h-5"}),r.jsx("input",{type:"text",placeholder:"     ...",value:t,onChange:N=>n(N.target.value),className:"w-full bg-gray-900 text-white rounded-xl py-3 pr-12 pl-4 border border-gray-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition-all placeholder-gray-500"})]}),s.length>0&&r.jsx("button",{onClick:()=>d(!0),className:"bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/20 p-3 rounded-xl transition-all active:scale-95",title:" ",children:r.jsx(Pt,{className:"w-6 h-6"})})]})]}),r.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:["all","create","update","delete","financial","login"].map(N=>r.jsx("button",{onClick:()=>l(N),className:`px-4 py-2 rounded-lg text-xs font-bold whitespace-nowrap transition-colors border ${a===N?"bg-blue-600 text-white border-blue-600 shadow-lg":"bg-gray-800 text-gray-400 border-gray-700 hover:bg-gray-700"}`,children:N==="all"?"":v(N)},N))}),r.jsx("div",{className:"space-y-3",children:y.length>0?y.map(N=>{const{dayName:P,dateStr:U,timeStr:V}=T(N.createdAt);return r.jsxs("div",{className:"bg-[#1e293b] rounded-xl p-4 border border-gray-700 hover:border-gray-500 transition-all flex flex-col md:flex-row gap-4 items-start md:items-center justify-between shadow-sm group",children:[r.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[r.jsx("div",{className:`p-2.5 rounded-xl border mt-1 shadow-inner ${w(N.actionType)}`,children:r.jsx(Yr,{className:"w-5 h-5"})}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsxs("span",{className:"text-white font-bold text-sm flex items-center gap-1",children:[r.jsx(pt,{className:"w-3 h-3 text-gray-500"}),N.actorName]}),r.jsx("span",{className:"text-gray-600 text-xs",children:"|"}),r.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded border font-bold ${w(N.actionType)}`,children:v(N.actionType)}),r.jsx("span",{className:"text-gray-500 text-xs bg-black/20 px-2 py-0.5 rounded border border-white/5 font-mono",children:N.target})]}),r.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:N.details})]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-1 text-xs text-gray-500 bg-black/20 px-3 py-2 rounded-lg border border-white/5 w-full md:w-auto",children:[r.jsxs("div",{className:"flex items-center gap-1.5 text-gray-400",children:[r.jsx(il,{className:"w-3 h-3"}),r.jsxs("span",{children:[P," ",U]})]}),r.jsxs("div",{className:"flex items-center gap-1.5 text-gray-300 font-bold font-mono",children:[r.jsx(wt,{className:"w-3 h-3 text-blue-400"}),r.jsx("span",{children:V})]})]})]},N.id)}):r.jsxs("div",{className:"text-center py-16 text-gray-500 bg-gray-800/30 rounded-2xl border border-dashed border-gray-700",children:[r.jsx(Yr,{className:"w-16 h-16 mx-auto mb-4 opacity-20"}),r.jsx("h3",{className:"text-lg font-bold text-gray-400",children:"  "}),r.jsx("p",{className:"text-xs mt-1",children:"       ."})]})}),x.length>f&&r.jsxs("button",{onClick:()=>m(N=>N+20),className:"w-full py-3 bg-gray-800 hover:bg-gray-700 text-gray-300 font-bold rounded-xl transition-all",children:["  (",x.length-f," )"]}),c&&r.jsx(os,{title:"  ",message:"               .",onClose:()=>d(!1),onConfirm:I,confirmButtonText:"  ",confirmVariant:"danger"})]})},OR=({promoCodes:s,pointsConfig:e,onAddPromo:t,onDeletePromo:n,onUpdatePointsConfig:a})=>{const[l,c]=j.useState("promos"),[d,f]=j.useState(!1),[m,x]=j.useState(""),[y,w]=j.useState(""),[v,T]=j.useState("percentage"),[I,N]=j.useState(""),[P,U]=j.useState((e==null?void 0:e.isPointsEnabled)??!0),[V,q]=j.useState("1"),[W,z]=j.useState(String((e==null?void 0:e.pointsPerCurrency)||1)),[k,M]=j.useState((e==null?void 0:e.currencyPerPoint)||.1);j.useEffect(()=>{U((e==null?void 0:e.isPointsEnabled)??!0),M((e==null?void 0:e.currencyPerPoint)||.1);const S=(e==null?void 0:e.pointsPerCurrency)||1;S<1&&1/S%10===0?(q(String(1/S)),z("1")):(q("1"),z(String(S)))},[e]);const B=()=>{if(!m||!y)return;const S={id:`PROMO-${Date.now()}`,code:m.toUpperCase(),type:v,value:parseFloat(y),isActive:!0,usageCount:0,maxUsage:I?parseInt(I):void 0};t(S),x(""),w(""),N("")},D=()=>{const S=parseFloat(V),F=parseFloat(W);if(isNaN(S)||S<=0||isNaN(F)||F<0){alert("      .");return}const E=F/S;a({pointsPerCurrency:E,currencyPerPoint:k,isPointsEnabled:P}),f(!0),setTimeout(()=>f(!1),2e3)};return r.jsxs("div",{className:"space-y-6 pb-24 animate-fadeIn relative",children:[d&&r.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm animate-fadeIn",children:r.jsxs("div",{className:"bg-gray-800 border border-green-500/50 rounded-2xl p-6 shadow-2xl flex flex-col items-center animate-pop-in",children:[r.jsx("div",{className:"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mb-4",children:r.jsx(nt,{className:"w-10 h-10 text-green-500"})}),r.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),r.jsx("p",{className:"text-gray-400",children:"   ."})]})}),r.jsxs("h2",{className:"text-2xl font-bold text-white mb-6 flex items-center gap-3",children:[r.jsx(Bf,{className:"w-8 h-8 text-yellow-500"})," "]}),r.jsxs("div",{className:"flex bg-gray-800 p-1 rounded-xl w-fit mb-6",children:[r.jsx("button",{onClick:()=>c("promos"),className:`px-6 py-2 rounded-lg text-sm font-bold transition-all ${l==="promos"?"bg-yellow-500 text-black shadow-lg":"text-gray-400 hover:text-white"}`,children:" "}),r.jsx("button",{onClick:()=>c("points"),className:`px-6 py-2 rounded-lg text-sm font-bold transition-all ${l==="points"?"bg-yellow-500 text-black shadow-lg":"text-gray-400 hover:text-white"}`,children:" "})]}),l==="promos"?r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-gray-800 p-5 rounded-2xl border border-gray-700 shadow-lg",children:[r.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[r.jsx(ln,{className:"w-5 h-5 text-green-500"}),"  "]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsx("input",{type:"text",placeholder:" (: SALE20)",value:m,onChange:S=>x(S.target.value),className:"bg-gray-900 border border-gray-600 rounded-xl px-4 py-3 text-white focus:border-yellow-500 outline-none uppercase font-mono"}),r.jsxs("div",{className:"flex bg-gray-900 rounded-xl border border-gray-600 overflow-hidden",children:[r.jsx("input",{type:"number",placeholder:"",value:y,onChange:S=>w(S.target.value),className:"flex-1 bg-transparent px-4 py-3 text-white outline-none"}),r.jsxs("select",{value:v,onChange:S=>T(S.target.value),className:"bg-gray-800 text-gray-300 px-3 text-xs outline-none border-r border-gray-600",children:[r.jsx("option",{value:"percentage",children:"%"}),r.jsx("option",{value:"fixed",children:"."})]})]}),r.jsx("input",{type:"number",placeholder:"   ()",value:I,onChange:S=>N(S.target.value),className:"bg-gray-900 border border-gray-600 rounded-xl px-4 py-3 text-white focus:border-yellow-500 outline-none"}),r.jsx("button",{onClick:B,disabled:!m||!y,className:"bg-green-600 hover:bg-green-700 text-white font-bold rounded-xl py-3 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:" "})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[s.map(S=>r.jsxs("div",{className:"bg-[#1e293b] rounded-xl p-4 border border-gray-700 flex justify-between items-center group relative overflow-hidden",children:[r.jsx("div",{className:"absolute top-0 right-0 w-1 h-full bg-yellow-500"}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-mono font-bold text-white text-lg tracking-wider",children:S.code}),r.jsx("span",{className:"text-xs bg-yellow-500/20 text-yellow-400 px-2 py-0.5 rounded border border-yellow-500/20",children:S.type==="percentage"?`${S.value}%`:`${S.value} .`})]}),r.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[" : ",r.jsx("span",{className:"text-white font-bold",children:S.usageCount})," ",S.maxUsage?`/ ${S.maxUsage}`:""]})]}),r.jsx("button",{onClick:()=>n(S.id),className:"p-2 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500/20 transition-colors",children:r.jsx(Pt,{className:"w-5 h-5"})})]},S.id)),s.length===0&&r.jsxs("div",{className:"col-span-full text-center py-10 text-gray-500 bg-gray-800/30 rounded-xl border border-dashed border-gray-700",children:[r.jsx(Bf,{className:"w-12 h-12 mx-auto mb-2 opacity-20"}),"   "]})]})]}):r.jsxs("div",{className:"bg-gray-800 p-6 rounded-2xl border border-gray-700 shadow-lg max-w-xl",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6 border-b border-gray-700 pb-4",children:[r.jsx("h3",{className:"text-lg font-bold text-white",children:" "}),r.jsx("button",{onClick:()=>U(!P),className:`relative w-14 h-7 rounded-full transition-colors duration-300 ${P?"bg-green-600":"bg-gray-600"}`,children:r.jsx("div",{className:`absolute top-1 left-1 bg-white w-5 h-5 rounded-full transition-transform duration-300 shadow-md ${P?"translate-x-7":"translate-x-0"}`})})]}),r.jsxs("div",{className:`space-y-6 transition-opacity duration-300 ${P?"opacity-100":"opacity-50 pointer-events-none"}`,children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-gray-400 mb-2 font-bold",children:"  "}),r.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-600 flex items-center gap-3",children:[r.jsx("span",{className:"text-gray-400 text-sm",children:"  "}),r.jsx("div",{className:"relative w-20",children:r.jsx("input",{type:"number",value:W,onChange:S=>z(S.target.value),className:"w-full bg-gray-800 border border-gray-500 rounded-lg px-2 py-1.5 text-center text-white font-bold focus:border-yellow-500 outline-none"})}),r.jsx("span",{className:"text-yellow-500 font-bold text-sm",children:""}),r.jsx("span",{className:"text-gray-400 text-sm",children:" "}),r.jsxs("div",{className:"relative w-24",children:[r.jsx("input",{type:"number",value:V,onChange:S=>q(S.target.value),className:"w-full bg-gray-800 border border-gray-500 rounded-lg px-2 py-1.5 text-center text-white font-bold focus:border-green-500 outline-none"}),r.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-[10px] text-gray-500",children:"."})]})]}),r.jsx("p",{className:"text-[10px] text-gray-500 mt-2 mr-1",children:": 1    100   0.5    1 ."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-gray-400 mb-2 font-bold",children:"   "}),r.jsxs("div",{className:"flex items-center gap-3 bg-gray-900/50 p-4 rounded-xl border border-gray-600",children:[r.jsx(R0,{className:"w-5 h-5 text-yellow-500"}),r.jsx("span",{className:"text-white font-bold text-sm",children:"1  ="}),r.jsx("input",{type:"number",value:k,onChange:S=>M(parseFloat(S.target.value)),className:"w-24 bg-gray-800 border border-gray-500 rounded-lg px-3 py-1.5 text-center text-white font-bold focus:border-green-500 outline-none"}),r.jsx("span",{className:"text-green-500 font-bold text-sm",children:"."})]})]}),r.jsxs("div",{className:"bg-blue-900/20 p-4 rounded-xl border border-blue-500/20 text-sm text-blue-200",children:[r.jsx("p",{className:"font-bold mb-1 text-white",children:" :"}),"    ",r.jsxs("strong",{children:[V||0," ."]}),"   ",r.jsx("strong",{children:W||0})," .",r.jsx("br",{}),"    ",r.jsx("strong",{children:(parseFloat(W||"0")*k).toFixed(2)})," ."]})]}),r.jsx("button",{onClick:D,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl transition-colors shadow-lg mt-6",children:" "})]})]})},TW=["    ","     .","  .","    ","  .    "],R5=["","","","","",""],PR=({users:s,currentUser:e,isRestricted:t,onBack:n})=>{const[a,l]=j.useState([]),[c,d]=j.useState(null),[f,m]=j.useState(""),[x,y]=j.useState(""),[w,v]=j.useState(null),[T,I]=j.useState(!1),[N,P]=j.useState(!1),[U,V]=j.useState(null),[q,W]=j.useState(null),[z,k]=j.useState(null),[M,B]=j.useState(null),[D,S]=j.useState(null),[F,E]=j.useState(!1),[Y,X]=j.useState({isWhatsappEnabled:!0,whatsappNumber:"",isChatEnabled:!0,allowImageSending:!0,isAutoReplyEnabled:!1,autoReplyText:"   .   ."}),R=j.useRef(null),J=j.useRef(null),O=j.useRef(null),K=j.useRef(null),[Q,L]=j.useState(null);Ht(()=>D?(S(null),!0):F?(E(!1),!0):Q?(L(null),!0):c?(d(null),!0):n?(n(),!0):!1,[Q,c,n,F,D]),j.useEffect(()=>{const ce=qn("support_chats",Pe=>{const Ge=Pe.sort((Ke,Ie)=>new Date(Ie.lastUpdated).getTime()-new Date(Ke.lastUpdated).getTime());l(Ge)}),Oe=qn("settings",Pe=>{const Ge=Pe.find(Ke=>Ke.id==="support_config");if(Ge){const{allowVoiceNotes:Ke,...Ie}=Ge;X(Le=>({...Le,...Ie}))}});return()=>{ce(),Oe()}},[]),j.useEffect(()=>{c&&O.current&&!q&&!D&&O.current.scrollIntoView({behavior:"smooth"})},[a,c,q]),j.useEffect(()=>{if(c){const ce=a.find(Oe=>Oe.id===c);ce&&ce.unreadCount>0&&ut("support_chats",c,{unreadCount:0})}},[c,a]);const G=j.useMemo(()=>a.find(ce=>ce.id===c),[a,c]),ee=j.useMemo(()=>G?s.find(ce=>ce.id===G.userId):null,[G,s]),ne=j.useMemo(()=>f?a.filter(ce=>ce.userName.toLowerCase().includes(f.toLowerCase())||ce.userPhone.includes(f)):a,[a,f]),je=async(ce=x,Oe=w)=>{if(!ce.trim()&&!Oe||!c||!G)return;let Pe=[...G.messages||[]],Ge=ce;if(q)Pe=Pe.map(Ke=>Ke.id===q.id?{...Ke,text:ce,image:Oe||Ke.image}:Ke),Ge=" "+ce;else{let Ke=ce;U&&(Ke=`[ : ${U.text.substring(0,50)+(U.text.length>50?"...":"")}]
${ce}`);const Ie=Pe.reduce((Zt,Ws)=>{const Ds=parseInt(Ws.id);return isNaN(Ds)?Zt:Math.max(Zt,Ds)},0),Lt={id:String(Ie+1),text:Ke,image:Oe||void 0,sender:"admin",createdAt:new Date,isRead:!1};Pe.push(Lt);const bs=(ee==null?void 0:ee.role)||"user";Jt(bs,{title:"   ",body:Ke||"   ",targetId:c,url:"/?target=support"})}await ut("support_chats",c,{messages:Pe,lastMessage:Oe?" ":Ge,lastUpdated:new Date}),y(""),v(null),W(null),V(null),I(!1),P(!1)},se=async(ce,Oe)=>{if(!c||!G)return;const Pe=ce.reactions||[],Ge=Pe.includes(Oe)?Pe.filter(Ie=>Ie!==Oe):[...Pe,Oe],Ke=G.messages.map(Ie=>Ie.id===ce.id?{...Ie,reactions:Ge}:Ie);await ut("support_chats",c,{messages:Ke}),S(null)},_e=async()=>{if(!z||!c||!G)return;const ce=G.messages.filter(Pe=>Pe.id!==z.id),Oe=ce.length>0?ce[ce.length-1].text:"  ";await ut("support_chats",c,{messages:ce,lastMessage:Oe}),k(null)},Te=async()=>{M&&(await kn("support_chats",M),B(null),d(null))},be=ce=>{S(ce)},ye=ce=>{K.current=setTimeout(()=>be(ce),500)},et=()=>{K.current&&clearTimeout(K.current)},Je=ce=>{var Pe,Ge;const Oe=document.querySelectorAll(".message-text");for(let Ke=0;Ke<Oe.length;Ke++)if((Pe=Oe[Ke].textContent)!=null&&Pe.includes(ce)){Oe[Ke].scrollIntoView({behavior:"smooth",block:"center"}),(Ge=Oe[Ke].parentElement)==null||Ge.classList.add("ring-2","ring-yellow-400"),setTimeout(()=>{var Ie;return(Ie=Oe[Ke].parentElement)==null?void 0:Ie.classList.remove("ring-2","ring-yellow-400")},1500);break}},bt=ce=>{const Oe=ce.match(/^\[ : (.*?)\]\n(.*)/s);if(Oe){const Pe=Oe[1],Ge=Oe[2];return r.jsxs(r.Fragment,{children:[r.jsx("div",{onClick:Ke=>{Ke.stopPropagation(),Je(Pe)},className:"mb-2 pb-1 border-b border-white/10 cursor-pointer active:opacity-70",children:r.jsxs("p",{className:"text-[10px] text-white/50 line-clamp-1 italic flex items-center gap-1",children:[r.jsx(nd,{className:"w-3 h-3"}),Pe]})}),r.jsx("span",{className:"message-text",children:yt(Ge)})]})}return r.jsx("span",{className:"message-text",children:yt(ce)})},yt=ce=>ce.split(/(https?:\/\/[^\s]+)/g).map((Pe,Ge)=>Pe.match(/^https?:\/\//)?r.jsx("a",{href:Pe,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 underline break-all",children:Pe},Ge):Pe),Ae=ce=>{var Pe;const Oe=(Pe=ce.target.files)==null?void 0:Pe[0];if(Oe){const Ge=new FileReader;Ge.onloadend=()=>v(Ge.result),Ge.readAsDataURL(Oe)}},fe=async()=>{await ut("settings","support_config",{id:"support_config",...Y}),E(!1)},$e=ce=>ce.startsWith("http");return r.jsxs("div",{className:"flex h-full bg-[#0f172a] text-white relative overflow-hidden",children:[r.jsxs("div",{className:`w-full md:w-80 lg:w-96 bg-[#1e293b] border-l border-gray-700 flex flex-col absolute md:relative z-20 h-full transition-transform duration-300 ${c?"-translate-x-full md:translate-x-0":"translate-x-0"}`,children:[r.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[r.jsxs("h2",{className:"font-bold text-lg flex items-center gap-2",children:[r.jsx(Dr,{className:"w-6 h-6 text-teal-400"})," "]}),r.jsxs("div",{className:"flex items-center gap-2",children:[!t&&r.jsx("button",{onClick:()=>E(!0),className:"p-2 hover:bg-gray-700 rounded-full text-gray-400 hover:text-white transition-colors",children:r.jsx(on,{className:"w-5 h-5"})}),n&&r.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-700 rounded-full md:hidden",children:r.jsx(Gs,{className:"w-5 h-5 rotate-180"})})]})]}),r.jsx("div",{className:"p-3",children:r.jsxs("div",{className:"relative",children:[r.jsx(Kn,{className:"absolute right-3 top-2.5 w-4 h-4 text-gray-500"}),r.jsx("input",{type:"text",placeholder:"  ...",value:f,onChange:ce=>m(ce.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-2 pl-4 pr-10 text-sm focus:border-teal-500 outline-none text-white"})]})}),r.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:ne.map(ce=>{const Oe=s.find(Pe=>Pe.id===ce.userId);return r.jsxs("button",{onClick:()=>d(ce.id),className:`w-full p-4 flex items-center gap-3 hover:bg-[#2a3649] transition-colors border-b border-gray-700/50 ${c===ce.id?"bg-[#2a3649] border-r-4 border-r-teal-500":""}`,children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-700 flex items-center justify-center text-gray-400 overflow-hidden border border-gray-600",children:Oe!=null&&Oe.storeImage?r.jsx("img",{src:Oe.storeImage,alt:ce.userName,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-6 h-6"})}),ce.unreadCount>0&&r.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full border-2 border-[#1e293b]",children:ce.unreadCount})]}),r.jsxs("div",{className:"flex-1 text-right overflow-hidden",children:[r.jsxs("div",{className:"flex justify-between items-center mb-1",children:[r.jsx("span",{className:"font-bold text-sm text-white truncate",children:ce.userName}),r.jsx("span",{className:"text-[10px] text-gray-500",children:new Date(ce.lastUpdated).toLocaleDateString()})]}),r.jsx("p",{className:`text-xs truncate ${ce.unreadCount>0?"text-white font-bold":"text-gray-400"}`,children:ce.lastMessage||" "})]})]},ce.id)})})]}),r.jsx("div",{className:`flex-1 flex flex-col bg-[#0f172a] absolute md:relative inset-0 z-10 transition-transform duration-300 ${c?"translate-x-0":"translate-x-full md:translate-x-0"}`,children:G?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"p-3 border-b border-gray-700 flex justify-between items-center bg-[#151e2d] shadow-sm z-20",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:()=>d(null),className:"md:hidden p-2 hover:bg-gray-700 rounded-full text-gray-400",children:r.jsx(Gs,{className:"w-6 h-6"})}),r.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border border-gray-600",children:ee!=null&&ee.storeImage?r.jsx("img",{src:ee.storeImage,alt:G.userName,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-5 h-5 text-gray-400"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-bold text-white text-sm",children:G.userName}),r.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-400",children:[r.jsx(Js,{className:"w-3 h-3"}),r.jsx("span",{className:"font-mono",children:G.userPhone})]})]})]}),!t&&r.jsx("button",{onClick:()=>B(G.id),className:"p-2 text-red-400 hover:bg-red-500/10 rounded-full transition-colors",children:r.jsx(Pt,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-[#0b1120] custom-scrollbar",children:[G.messages.map((ce,Oe)=>{const Pe=ce.sender==="admin",Ge=ce.image&&$e(ce.image);return r.jsx("div",{className:`flex ${Pe?"justify-end":"justify-start"}`,onTouchStart:()=>ye(ce),onTouchEnd:et,onMouseDown:()=>ye(ce),onMouseUp:et,onContextMenu:Ke=>{Ke.preventDefault(),be(ce)},children:r.jsxs("div",{className:`relative max-w-[75%] rounded-2xl p-2 select-none shadow-sm ${Ge?"bg-transparent shadow-none":Pe?"bg-teal-700 text-white rounded-br-none":"bg-gray-700 text-gray-100 rounded-bl-none"}`,children:[ce.image&&r.jsx("img",{src:ce.image,className:Ge?"w-32 h-32 object-contain cursor-pointer drop-shadow-lg":"rounded-lg mb-2 max-h-48 object-cover cursor-pointer",onClick:Ke=>{Ke.stopPropagation(),L(ce.image)},alt:"attachment"}),ce.text&&r.jsx("div",{className:"text-sm whitespace-pre-wrap leading-relaxed px-1",children:bt(ce.text)}),r.jsxs("div",{className:`flex items-center justify-end gap-1 mt-1 text-[10px] ${Ge?"text-gray-400":Pe?"text-teal-200":"text-gray-400"}`,children:[r.jsx("span",{children:new Date(ce.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),Pe&&r.jsx(nt,{className:"w-3 h-3"})]}),ce.reactions&&ce.reactions.length>0&&r.jsx("div",{className:`absolute -bottom-2 ${Pe?"left-0":"right-0"} flex -space-x-1`,children:ce.reactions.map((Ke,Ie)=>r.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-800 border border-gray-600 flex items-center justify-center text-[10px] shadow-sm",children:Ke},Ie))})]})},Oe)}),r.jsx("div",{ref:O})]}),r.jsxs("div",{className:"p-3 bg-[#151e2d] border-t border-gray-700",children:[(U||q)&&r.jsxs("div",{className:"flex justify-between items-center bg-gray-800 p-2 rounded-t-lg border-b border-gray-700 mb-2",children:[r.jsx("div",{className:"flex items-center gap-2 text-xs",children:q?r.jsxs(r.Fragment,{children:[r.jsx(cr,{className:"w-4 h-4 text-blue-400"}),r.jsx("span",{className:"text-blue-300 font-bold",children:"  "})]}):r.jsxs(r.Fragment,{children:[r.jsx(nd,{className:"w-4 h-4 text-purple-400"}),r.jsx("span",{className:"text-purple-300 font-bold",children:" :"}),r.jsx("span",{className:"text-gray-400 truncate max-w-[150px]",children:U==null?void 0:U.text})]})}),r.jsx("button",{onClick:()=>{V(null),W(null),y(""),v(null)},className:"text-gray-500 hover:text-white",children:r.jsx(rt,{className:"w-4 h-4"})})]}),w&&r.jsxs("div",{className:"relative w-fit mb-2",children:[r.jsx("img",{src:w,className:"h-20 w-20 rounded-lg object-cover border border-gray-600",alt:"preview"}),r.jsx("button",{onClick:()=>v(null),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5",children:r.jsx(rt,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"flex items-end gap-2",children:[r.jsxs("div",{className:"flex-1 bg-gray-800 rounded-2xl flex items-center px-2 border border-gray-600 focus-within:border-teal-500 transition-colors",children:[Y.allowImageSending&&r.jsx("button",{onClick:()=>{var ce;return(ce=R.current)==null?void 0:ce.click()},className:"p-2 text-gray-400 hover:text-teal-400",children:r.jsx(jS,{className:"w-5 h-5"})}),r.jsx("button",{onClick:()=>P(!N),className:`p-2 transition-colors ${N?"text-yellow-400":"text-gray-400 hover:text-yellow-400"}`,children:r.jsx(Ci,{className:"w-5 h-5"})}),r.jsx("textarea",{ref:J,value:x,onChange:ce=>y(ce.target.value),placeholder:"  ...",rows:1,className:"flex-1 bg-transparent text-white p-3 text-sm outline-none resize-none max-h-24 custom-scrollbar"}),r.jsx("button",{onClick:()=>I(!T),className:"p-2 text-gray-400 hover:text-yellow-400",children:r.jsx("span",{className:"text-lg",children:""})})]}),r.jsx("button",{onClick:()=>je(),disabled:!x.trim()&&!w,className:`p-3 text-white rounded-full shadow-lg transition-transform active:scale-95 ${q?"bg-blue-600 hover:bg-blue-500":"bg-teal-600 hover:bg-teal-500"} disabled:opacity-50 disabled:cursor-not-allowed`,children:q?r.jsx(nt,{className:"w-5 h-5"}):r.jsx(B5,{className:"w-5 h-5 ml-0.5"})})]}),r.jsx("input",{ref:R,type:"file",accept:"image/*",className:"hidden",onChange:Ae}),(N||T)&&r.jsxs("div",{className:"absolute bottom-20 left-4 right-4 bg-gray-800 border border-gray-600 rounded-xl p-2 shadow-2xl flex gap-2 overflow-x-auto z-30",children:[N&&TW.map((ce,Oe)=>r.jsx("button",{onClick:()=>{y(ce),P(!1)},className:"whitespace-nowrap px-3 py-1.5 bg-gray-700 rounded-full text-xs text-white",children:ce},Oe)),T&&R5.map(ce=>r.jsx("button",{onClick:()=>y(Oe=>Oe+ce),className:"text-2xl hover:bg-white/10 p-2 rounded",children:ce},ce))]})]})]}):r.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-500",children:[r.jsx(Dr,{className:"w-16 h-16 opacity-50 mb-4"}),r.jsx("h3",{className:"text-xl font-bold text-gray-300",children:"  "}),r.jsx("p",{className:"text-sm mt-2",children:"  "})]})}),D&&r.jsx("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fadeIn",onClick:()=>S(null),children:r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-gray-700 shadow-2xl p-4 animate-sheet-up",onClick:ce=>ce.stopPropagation(),children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h3",{className:"text-white font-bold",children:" "}),r.jsx("button",{onClick:()=>S(null),children:r.jsx(rt,{className:"w-5 h-5 text-gray-400"})})]}),r.jsx("div",{className:"flex gap-4 justify-center mb-6 bg-black/20 p-3 rounded-xl",children:R5.slice(0,5).map(ce=>r.jsx("button",{onClick:()=>se(D,ce),className:"text-2xl hover:scale-125 transition-transform",children:ce},ce))}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("button",{onClick:()=>{var ce;V(D),S(null),(ce=J.current)==null||ce.focus()},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 transition-colors text-white",children:[r.jsx("div",{className:"p-2 bg-blue-500/20 rounded-full text-blue-400",children:r.jsx(nd,{className:"w-4 h-4"})}),r.jsx("span",{className:"font-bold",children:"  "})]}),D.sender==="admin"&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>{W(D),y(D.text),v(D.image||null),S(null)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 transition-colors text-white",children:[r.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-full text-yellow-400",children:r.jsx(cr,{className:"w-4 h-4"})}),r.jsx("span",{className:"font-bold",children:""})]}),!t&&r.jsxs("button",{onClick:()=>{k(D),S(null)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 transition-colors text-red-400",children:[r.jsx("div",{className:"p-2 bg-red-500/20 rounded-full text-red-500",children:r.jsx(Pt,{className:"w-4 h-4"})}),r.jsx("span",{className:"font-bold",children:""})]})]}),!t&&D.sender!=="admin"&&r.jsxs("button",{onClick:()=>{k(D),S(null)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 transition-colors text-red-400",children:[r.jsx("div",{className:"p-2 bg-red-500/20 rounded-full text-red-500",children:r.jsx(Pt,{className:"w-4 h-4"})}),r.jsx("span",{className:"font-bold",children:" ()"})]})]})]})}),F&&r.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>E(!1),children:r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-2xl p-6 border border-gray-700 shadow-2xl",onClick:ce=>ce.stopPropagation(),children:[r.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[r.jsx(on,{className:"w-6 h-6 text-teal-400"}),"  "]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"bg-blue-500/5 p-4 rounded-xl border border-blue-500/20 mb-2",children:[r.jsx("h4",{className:"text-xs font-bold text-blue-400 mb-3 uppercase tracking-wider",children:" "}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("label",{className:"flex items-center justify-between text-white cursor-pointer",children:[r.jsxs("span",{className:"text-sm font-bold flex items-center gap-2",children:[r.jsx(kv,{className:"w-4 h-4 text-blue-400"}),"  (In-App)"]}),r.jsx("input",{type:"checkbox",checked:Y.isChatEnabled,onChange:ce=>X({...Y,isChatEnabled:ce.target.checked}),className:"h-5 w-5 rounded bg-gray-700 border-gray-600 text-blue-500 focus:ring-blue-500"})]}),r.jsx("div",{className:"h-px bg-blue-500/10 w-full"}),r.jsxs("label",{className:"flex items-center justify-between text-white cursor-pointer",children:[r.jsxs("span",{className:"text-sm font-bold flex items-center gap-2",children:[r.jsx(cc,{className:"w-4 h-4 text-green-500"})," "]}),r.jsx("input",{type:"checkbox",checked:Y.isWhatsappEnabled,onChange:ce=>X({...Y,isWhatsappEnabled:ce.target.checked}),className:"h-5 w-5 rounded bg-gray-700 border-gray-600 text-green-500 focus:ring-green-500"})]}),Y.isWhatsappEnabled&&r.jsx("div",{className:"mt-1 mr-6",children:r.jsx("input",{type:"text",value:Y.whatsappNumber,onChange:ce=>X({...Y,whatsappNumber:ce.target.value}),className:"w-full bg-[#0f172a] border border-gray-600 rounded-lg p-2.5 text-white text-sm outline-none focus:border-green-500 font-mono dir-ltr placeholder-gray-500",placeholder:"201xxxxxxxxx"})})]})]}),r.jsxs("label",{className:"flex items-center justify-between text-white cursor-pointer p-3 bg-gray-800 rounded-xl hover:bg-gray-750 transition-colors",children:[r.jsxs("span",{className:"text-sm flex items-center gap-2",children:[r.jsx(jS,{className:"w-4 h-4 text-blue-400"}),"  "]}),r.jsx("input",{type:"checkbox",checked:Y.allowImageSending,onChange:ce=>X({...Y,allowImageSending:ce.target.checked}),className:"h-5 w-5 rounded bg-gray-700 border-gray-600 text-teal-500 focus:ring-teal-500"})]}),r.jsxs("div",{className:"p-3 bg-gray-800 rounded-xl",children:[r.jsxs("label",{className:"flex items-center justify-between text-white cursor-pointer mb-2",children:[r.jsxs("span",{className:"text-sm flex items-center gap-2",children:[r.jsx(Ci,{className:"w-4 h-4 text-yellow-400"}),"  "]}),r.jsx("input",{type:"checkbox",checked:Y.isAutoReplyEnabled,onChange:ce=>X({...Y,isAutoReplyEnabled:ce.target.checked}),className:"h-5 w-5 rounded bg-gray-700 border-gray-600 text-teal-500 focus:ring-teal-500"})]}),Y.isAutoReplyEnabled&&r.jsx("textarea",{value:Y.autoReplyText,onChange:ce=>X({...Y,autoReplyText:ce.target.value}),className:"w-full bg-[#0f172a] rounded-lg p-2 text-white text-sm border border-gray-600 focus:border-teal-500 outline-none resize-none h-20"})]})]}),r.jsx("button",{onClick:fe,className:"w-full bg-teal-600 hover:bg-teal-700 text-white font-bold py-3.5 rounded-xl mt-6 transition-colors shadow-lg",children:" "})]})}),Q&&r.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex items-center justify-center p-4",onClick:()=>L(null),children:[r.jsx("img",{src:Q,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl"}),r.jsx("button",{className:"absolute top-4 right-4 bg-white/10 p-2 rounded-full text-white hover:bg-white/20",children:r.jsx(rt,{className:"w-6 h-6"})})]}),z&&r.jsx(os,{title:" ",message:"      ",onClose:()=>k(null),onConfirm:_e,confirmButtonText:"",confirmVariant:"danger"}),M&&r.jsx(os,{title:" ",message:":     .",onClose:()=>B(null),onConfirm:Te,confirmButtonText:" ",confirmVariant:"danger"})]})},nr=({icon:s,label:e,onClick:t,isActive:n,danger:a})=>r.jsxs("button",{onClick:t,className:`w-full flex items-center gap-4 p-4 rounded-2xl transition-all duration-300 group relative overflow-hidden active:scale-95 mb-2 ${a?"text-red-400 hover:bg-red-500/10":n?"bg-red-600/20 text-white border border-red-500/30 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[n&&r.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 bg-red-600 rounded-l-full"}),r.jsx("div",{className:`relative z-10 transition-transform group-hover:scale-110 duration-300 ${n?"text-red-500":""}`,children:s}),r.jsx("span",{className:`relative z-10 font-bold text-sm ${n?"translate-x-1":""} transition-transform duration-300`,children:e})]}),EW=s=>{var et,Je,bt,yt;const[e,t]=j.useState("orders"),[n,a]=j.useState(!1),[l,c]=j.useState(null),[d,f]=j.useState(null),[m,x]=j.useState(null),[y,w]=j.useState(null),[v,T]=j.useState(null),[I,N]=j.useState(null);j.useEffect(()=>{const Ae=fe=>{const{target:$e,id:ce}=fe.detail;$e==="orders"||$e==="order"&&ce?t("orders"):$e==="users"?t("users"):$e==="reports"?t("reports"):$e==="messages"?t("messages"):$e==="stores"?t("stores"):$e==="notifications"?t("notifications"):$e==="support"&&t("support")};return window.addEventListener("app-navigation",Ae),()=>window.removeEventListener("app-navigation",Ae)},[]);const[P,U]=j.useState([]),[V,q]=j.useState(!0),W=j.useRef(0);j.useEffect(()=>{const Ae=qn("support_chats",fe=>{const $e=fe.filter(ce=>ce.unreadCount>0);U($e)});return()=>Ae()},[]),j.useEffect(()=>{const fe=new URLSearchParams(window.location.search).get("target");fe&&(fe==="messages"?t("messages"):fe==="orders"||fe==="order"?t("orders"):fe==="notifications"&&t("notifications"))},[window.location.search]),Ht(()=>I?(N(null),!0):y?(w(null),!0):v?(T(null),!0):m?(x(null),!0):l?(c(null),!0):d?(f(null),!0):n?(a(!1),!0):e!=="orders"?(t("orders"),!0):!1,[n,l,d,m,y,v,I,e]);const z=j.useMemo(()=>s.users.find(Ae=>Ae.id===s.user.id)||s.user,[s.users,s.user]),k=((Je=(et=s.currentTheme)==null?void 0:et.admin)==null?void 0:Je.mode)||"dark",M=s.users.filter(Ae=>Ae.status==="pending"&&Ae.role!=="admin").length,B=s.orders.filter(Ae=>Ae.status===ue.Pending).length,D=P.length,S=M+s.passwordResetRequests.length+B+D,F=j.useMemo(()=>s.users.filter(Ae=>Ae.role==="driver"),[s.users]),E=j.useMemo(()=>s.users.filter(Ae=>Ae.role==="merchant"),[s.users]),Y=j.useCallback(()=>t("add_order"),[]),X=j.useCallback(Ae=>x(Ae),[]),R=j.useCallback(async(Ae,fe)=>{const $e=s.orders.filter(Oe=>Oe.status===ue.Pending&&!Oe.driverId);if($e.length===0)return;const ce=$e.map(Oe=>({...Oe,driverId:Ae,deliveryFee:fe,status:ue.InTransit}));await s.onBulkUpdate(ce),s.showNotification(`  ${ce.length}   `,"success")},[s.orders,s.onBulkUpdate,s.showNotification]),J=j.useCallback(async Ae=>{let fe=[];Ae===ue.Pending?fe=s.orders.filter(ce=>ce.status!==ue.Pending&&ce.status!==ue.Delivered&&ce.status!==ue.Cancelled).map(ce=>({id:ce.id,status:ue.Pending,driverId:null,deliveryFee:null})):Ae===ue.Delivered&&(fe=s.orders.filter(ce=>ce.status===ue.InTransit).map(ce=>({id:ce.id,status:ue.Delivered,deliveredAt:new Date}))),fe.length>0?(await s.onBulkUpdate(fe),s.showNotification(`   ${fe.length}  `,"success")):s.showNotification("    ","info")},[s.orders,s.onBulkUpdate,s.showNotification]),O=j.useCallback(async Ae=>{const fe=Ae==="all"?s.orders:s.orders.filter($e=>$e.status===Ae);if(fe.length!==0){for(const $e of fe)await s.deleteOrder($e.id);s.showNotification(`  ${fe.length}  `,"success")}},[s.orders,s.deleteOrder,s.showNotification]),K=j.useRef(null),Q=j.useRef(0),L=j.useCallback(async()=>{if(!I)return;const{order:Ae,newStatus:fe}=I;s.updateOrderStatus(Ae.id,fe),N(null)},[I,s.updateOrderStatus]),G=Ae=>{const fe=Ae.currentTarget.scrollTop;e==="orders"&&(Q.current=fe);const $e=fe-W.current;Math.abs($e)>5&&($e>0&&fe>20?q(!1):q(!0)),W.current=fe};j.useEffect(()=>{e==="orders"&&K.current&&requestAnimationFrame(()=>{K.current&&(K.current.scrollTop=Q.current)})},[e]);const ee=((bt=s.appConfig)==null?void 0:bt.appName.split(" "))||["GOO","NOW"],ne=ee[0],je=ee.slice(1).join(" "),se=((yt=s.appConfig)==null?void 0:yt.appName)||"GOO NOW",_e=Ae=>{if(Ae!=null&&Ae.startsWith("data:")||Ae!=null&&Ae.startsWith("http"))return"p-0";switch(Ae){case"gold":return"p-[3px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[3px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[3px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[3px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-[2px] bg-gradient-to-br from-red-600 to-red-800"}},Te=Ae=>{if(!Ae||Ae==="none")return null;if(Ae!=null&&Ae.startsWith("data:")||Ae!=null&&Ae.startsWith("http"))return r.jsx("div",{className:"w-8 h-8 min-w-[2rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:r.jsx("img",{src:Ae,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let fe=null,$e="";switch(Ae){case"verified":fe=qi,$e="text-blue-400 fill-blue-500/20";break;case"vip":fe=va,$e="text-yellow-400 fill-yellow-500/20";break;case"star":fe=Rr,$e="text-purple-400 fill-purple-500/20";break;case"popular":fe=zt,$e="text-red-400 fill-red-500/20";break;case"admin-badge":fe=on,$e="text-red-500";break;case"mod-badge":fe=Yr,$e="text-green-500";break}return fe?r.jsx(fe,{className:`w-5 h-5 ${$e}`}):null},be=Ae=>(Ae==null?void 0:Ae.startsWith("data:"))||(Ae==null?void 0:Ae.startsWith("http")),ye=e==="support";return r.jsxs("div",{className:`flex flex-col h-screen overflow-hidden ${k==="light"?"bg-gray-100":"bg-gray-900"}`,children:[n&&r.jsxs("div",{className:"fixed inset-0 z-[100] flex justify-start animate-fadeIn",dir:"rtl",children:[r.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-md transition-all duration-500",onClick:()=>a(!1)}),r.jsxs("div",{className:`w-[290px] h-full ${k==="light"?"bg-white/90":"bg-gray-900/80"} backdrop-blur-2xl border-l border-white/10 shadow-2xl relative flex flex-col z-10 pt-safe rounded-l-[40px] overflow-hidden transform transition-transform duration-300 animate-slide-in-right`,children:[r.jsxs("div",{className:"p-8 border-b border-white/5 flex flex-col items-center relative",children:[r.jsx("button",{onClick:()=>a(!1),className:"absolute top-4 left-4 p-2.5 rounded-full bg-white/5 hover:bg-red-500/20 text-gray-400 hover:text-red-400 border border-white/10 transition-all duration-300 shadow-sm active:scale-90 z-50",children:r.jsx(rt,{className:"w-5 h-5"})}),r.jsxs("button",{onClick:()=>{c(z),a(!1)},className:`relative w-24 h-24 flex items-center justify-center rounded-full shadow-2xl mb-4 group/avatar cursor-pointer transition-transform active:scale-95 ${be(z.specialFrame)?"":_e(z.specialFrame)}`,children:[be(z.specialFrame)&&r.jsx("img",{src:z.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.65] pointer-events-none",alt:"frame"}),r.jsxs("div",{className:`${be(z.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-gray-900 overflow-hidden border-2 border-white/10 flex items-center justify-center relative z-0`,children:[z.storeImage?r.jsx("img",{src:z.storeImage,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-10 h-10 text-gray-500"}),r.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover/avatar:opacity-100 transition-opacity",children:r.jsx(on,{className:"w-6 h-6 text-white"})})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("h3",{className:`font-black text-xl tracking-tight ${k==="light"?"text-gray-900":"text-white"}`,children:z.name}),Te(z.specialBadge)]}),r.jsx("p",{className:"text-[10px] font-bold text-red-500 uppercase tracking-[0.2em] mt-1",children:"Administrator"})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-1 custom-scrollbar",children:[r.jsx("div",{className:"px-4 py-2 text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2",children:" "}),r.jsx(nr,{icon:r.jsx(Bt,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("orders"),a(!1)},isActive:e==="orders"}),r.jsx(nr,{icon:r.jsx(ym,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("reports"),a(!1)},isActive:e==="reports"}),r.jsx(nr,{icon:r.jsx(Pc,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("wallet"),a(!1)},isActive:e==="wallet"}),r.jsx(nr,{icon:r.jsx(Dr,{className:"w-5 h-5"}),label:"  (Chat)",onClick:()=>{t("support"),a(!1)},isActive:e==="support"}),r.jsx(nr,{icon:r.jsx(Vd,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("users"),a(!1)},isActive:e==="users"}),r.jsx(nr,{icon:r.jsx(lr,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("stores"),a(!1)},isActive:e==="stores"}),r.jsx(nr,{icon:r.jsx(an,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("notifications"),a(!1)},isActive:e==="notifications"}),r.jsx(nr,{icon:r.jsx(Yr,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("logs"),a(!1)},isActive:e==="logs"}),r.jsx(nr,{icon:r.jsx(Bf,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("loyalty"),a(!1)},isActive:e==="loyalty"}),r.jsx(nr,{icon:r.jsx(kr,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("messages"),a(!1)},isActive:e==="messages"}),r.jsx(nr,{icon:r.jsx(Qr,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("slider"),a(!1)},isActive:e==="slider"}),r.jsx(nr,{icon:r.jsx(Av,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("customizer"),a(!1)},isActive:e==="customizer"}),r.jsx(nr,{icon:r.jsx(on,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("settings"),a(!1)},isActive:e==="settings"})]}),r.jsx("div",{className:"p-6 border-t border-white/5 bg-black/20 pb-safe",children:r.jsx(nr,{icon:r.jsx(bm,{className:"w-5 h-5"}),label:" ",onClick:s.onLogout,danger:!0})})]})]}),!ye&&e!=="add_order"&&r.jsx("header",{className:`${k==="light"?"bg-white/95":"bg-gray-800/95"} backdrop-blur-md border-b border-red-500/20 sticky top-0 z-30 shadow-xl pt-safe rounded-b-[35px] mx-2 mt-1 transition-all duration-300`,children:r.jsxs("div",{className:"max-w-7xl mx-auto py-3 px-4 flex justify-between items-center relative h-14",children:[r.jsx("button",{onClick:()=>a(!0),className:"flex items-center gap-3 active:scale-95 transition-transform group focus:outline-none",children:r.jsxs("div",{className:`relative w-11 h-11 flex items-center justify-center rounded-full shadow-lg transition-all duration-300 group-hover:shadow-red-500/20 group-hover:ring-2 group-hover:ring-red-500/50 ${be(z.specialFrame)?"":_e(z.specialFrame)}`,children:[be(z.specialFrame)&&r.jsx("img",{src:z.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.5] pointer-events-none",alt:"frame"}),r.jsx("div",{className:`${be(z.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-white flex items-center justify-center overflow-hidden relative z-0`,children:z.storeImage?r.jsx("img",{src:z.storeImage,className:"w-full h-full object-cover"}):r.jsx("div",{className:"text-gray-900 font-bold",children:z.name.charAt(0)})})]})}),r.jsxs("h1",{className:"text-xl font-black absolute left-1/2 -translate-x-1/2 select-none",children:[r.jsx("span",{className:"text-red-600",children:ne}),r.jsx("span",{className:k==="light"?"text-gray-900 ml-1":"text-white ml-1",children:je})]}),r.jsx("div",{className:"flex items-center gap-1",children:r.jsxs("button",{onClick:()=>t("notifications"),className:"relative p-2.5 rounded-xl bg-white/5 hover:bg-white/10 transition-colors",children:[r.jsx(an,{className:`w-6 h-6 ${S>0?"text-yellow-500":"text-gray-400"}`}),S>0&&r.jsx("span",{className:"absolute top-1.5 right-1.5 w-4 h-4 flex items-center justify-center bg-red-600 text-[9px] font-bold text-white rounded-full ring-2 ring-gray-800 animate-pulse",children:S})]})})]})}),r.jsxs("main",{ref:K,className:e==="add_order"?"flex-1 bg-[#111] h-full":ye?"flex-1 h-full relative":"flex-1 overflow-y-auto p-4 sm:p-6 pb-24 relative",onScroll:ye?void 0:G,children:[r.jsx("div",{className:e==="orders"?"block":"hidden",children:r.jsx(q5,{orders:s.orders,users:s.users,deleteOrder:s.deleteOrder,updateOrderStatus:s.updateOrderStatus,editOrder:s.editOrder,assignDriverAndSetStatus:s.assignDriverAndSetStatus,adminAddOrder:s.adminAddOrder,onOpenStatusModal:X,onNavigateToAdd:Y,onBulkAssign:R,onBulkStatusUpdate:J,onBulkDelete:O,appName:se})}),e==="reports"&&r.jsx(J5,{orders:s.orders,users:s.users,payments:s.payments,currentUser:s.user}),e==="add_order"&&r.jsx(AR,{merchants:E,onClose:()=>t("orders"),onSave:s.adminAddOrder}),e==="users"&&r.jsx(H5,{users:s.users,updateUser:s.updateUser,onDeleteUser:s.deleteUser,onAdminAddUser:s.adminAddUser,setEditingUser:c,onViewUser:f,appName:se,currentUser:s.user}),e==="stores"&&r.jsx(W5,{users:s.users,orders:s.orders,updateUser:s.updateUser}),e==="notifications"&&r.jsx(K5,{users:s.users,updateUser:s.updateUser,onDeleteUser:s.deleteUser,passwordResetRequests:s.passwordResetRequests,resolvePasswordResetRequest:s.resolvePasswordResetRequest,setEditingUser:c,pendingOrders:s.orders.filter(Ae=>Ae.status===ue.Pending&&!Ae.driverId),onNavigateToOrders:()=>t("orders"),unreadChats:P,onNavigateToSupport:()=>t("support")}),e==="wallet"&&r.jsx(Q5,{orders:s.orders,users:s.users,payments:s.payments,updateUser:s.updateUser,handleDriverPayment:s.handleDriverPayment,onDeletePayment:Ae=>kn("payments",Ae),currentUser:s.user}),e==="messages"&&r.jsx(Y5,{users:s.users,onSendMessage:s.sendMessage,messages:s.messages,deleteMessage:s.deleteMessage}),e==="slider"&&r.jsx(IR,{images:s.sliderImages,isEnabled:s.sliderConfig.isEnabled,onAddImage:s.onAddSliderImage,onDeleteImage:s.onDeleteSliderImage,onUpdateImage:s.onUpdateSliderImage,onToggleSlider:s.onToggleSlider,merchants:E,adminUser:s.user}),e==="customizer"&&r.jsx(RR,{currentTheme:s.currentTheme,onUpdateTheme:s.onUpdateTheme,onClose:()=>t("orders"),appConfig:s.appConfig,onUpdateAppConfig:s.onUpdateAppConfig,users:s.users,onUpdateUser:s.updateUser,sendNotification:Jt,currentUser:s.user}),e==="logs"&&r.jsx(DR,{logs:s.auditLogs,onClearLogs:s.onClearLogs}),e==="loyalty"&&r.jsx(OR,{promoCodes:s.promoCodes,pointsConfig:s.pointsConfig,onAddPromo:s.onAddPromo,onDeletePromo:s.onDeletePromo,onUpdatePointsConfig:s.onUpdatePointsConfig}),e==="support"&&r.jsx(PR,{users:s.users,currentUser:s.user,onBack:()=>t("orders")}),e==="settings"&&r.jsx(_W,{onSuccess:()=>window.location.reload(),onDisconnect:()=>window.location.reload(),appConfig:s.appConfig,onUpdateAppConfig:s.onUpdateAppConfig})]}),!ye&&e!=="add_order"&&r.jsx(kR,{activeView:e,onNavigate:Ae=>t(Ae),isVisible:V,mode:k}),l&&r.jsx(Rv,{user:l,onClose:()=>c(null),onSave:(Ae,fe)=>{s.updateUser(Ae,fe),c(null)},isLastAdmin:l.role==="admin",isPrimaryAdmin:l.id==="5",appName:se,currentUser:s.user}),d&&r.jsx(Dv,{user:d,onClose:()=>f(null),onApprove:(Ae,fe)=>{s.updateUser(Ae,fe),f(null)},onDelete:Ae=>{s.deleteUser(Ae),f(null)}}),m&&r.jsx(CR,{order:m,onClose:()=>x(null),onSelectStatus:(Ae,fe)=>{x(null),setTimeout(()=>{fe===ue.InTransit?w(Ae):N({order:Ae,newStatus:fe})},150)},onTransferOrder:Ae=>{x(null),setTimeout(()=>{T(Ae)},100)}}),y&&r.jsx(A0,{order:y,drivers:F,targetStatus:ue.InTransit,onClose:()=>w(null),onSave:(Ae,fe)=>{s.assignDriverAndSetStatus(y.id,Ae,fe,ue.InTransit),w(null)}}),v&&r.jsx(A0,{order:v,drivers:F,targetStatus:ue.InTransit,onClose:()=>T(null),onSave:(Ae,fe)=>{s.assignDriverAndSetStatus(v.id,Ae,fe,ue.InTransit),T(null)}}),I&&r.jsx(os,{title:"  ",message:"    ",onClose:()=>N(null),onConfirm:L,confirmVariant:I.newStatus===ue.Delivered?"success":"primary"})]})},IW=({addOrder:s})=>{const[e,t]=j.useState({phone:"",address:""}),[n,a]=j.useState(""),[l,c]=j.useState(""),[d,f]=j.useState("idle"),m=j.useRef(null),x=j.useRef(null),y=j.useRef(null),w=T=>{const{name:I,value:N}=T.target;if(I==="phone"){const P=N.replace(/\D/g,"");P.length<=11&&t({...e,phone:P})}else t({...e,[I]:N})},v=async T=>{if(T.preventDefault(),!e.phone||!e.address){c("    .");return}if(!/^\d{11}$/.test(e.phone)){c("       11 .");return}c(""),f("submitting");const I={customer:{...e},notes:n};try{await s(I),f("success"),setTimeout(()=>{m.current&&(m.current.value=""),x.current&&(x.current.value=""),y.current&&(y.current.value=""),t({phone:"",address:""}),a(""),f("idle")},1500)}catch{f("idle"),c("    .")}};return r.jsxs("div",{className:"bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700 relative overflow-hidden transition-all duration-300",children:[r.jsxs("div",{className:`absolute inset-0 bg-gray-800 z-10 flex flex-col items-center justify-center transition-opacity duration-300 ${d==="success"?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:[r.jsx("div",{className:"scale-125 transform transition-transform duration-500 animate-bounce",children:r.jsx(nt,{className:"w-20 h-20 text-green-500"})}),r.jsx("h3",{className:"text-xl font-bold text-white mt-4",children:"   !"})]}),r.jsx("h2",{className:"text-2xl font-bold text-neutral-100 mb-6 flex items-center justify-between",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(_S,{className:"w-6 h-6 ml-3 text-red-500"}),r.jsx("span",{children:"  "})]})}),r.jsxs("form",{onSubmit:v,className:`space-y-4 transition-opacity duration-300 ${d==="success"?"opacity-0":"opacity-100"}`,children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-neutral-300 mb-2",children:" "}),r.jsx("input",{ref:m,type:"tel",inputMode:"numeric",pattern:"[0-9]*",maxLength:11,name:"phone",id:"phone",value:e.phone,onChange:w,required:!0,disabled:d==="submitting",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-neutral-100 placeholder:text-neutral-500 focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none disabled:opacity-50 text-right placeholder:text-right font-mono",placeholder:"    11 ",dir:"rtl"})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-neutral-300 mb-2",children:" "}),r.jsx("input",{ref:x,type:"text",name:"address",id:"address",value:e.address,onChange:w,required:!0,disabled:d==="submitting",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-neutral-100 placeholder:text-neutral-500 focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none disabled:opacity-50"})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-neutral-300 mb-2",children:" ()"}),r.jsx("textarea",{ref:y,id:"notes",value:n,onChange:T=>a(T.target.value),rows:3,disabled:d==="submitting",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-neutral-100 placeholder:text-neutral-500 focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none disabled:opacity-50"})]}),l&&r.jsx("p",{className:"text-red-400 text-sm text-center",children:l}),r.jsx("div",{className:"pt-2",children:r.jsx("button",{type:"submit",disabled:d==="submitting",className:"w-full flex justify-center items-center bg-red-600 text-white font-bold px-6 py-3 rounded-lg shadow-md hover:bg-red-700 transition-colors disabled:bg-gray-600 disabled:cursor-not-allowed",children:d==="submitting"?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin ml-2"}),r.jsx("span",{children:"  ..."})]}):r.jsxs(r.Fragment,{children:[r.jsx(_S,{className:"w-5 h-5 ml-2"}),r.jsx("span",{children:" "})]})})})]})]})},AW=({order:s,driver:e,viewingMerchant:t})=>{var c,d;const n=(()=>{try{const f=s.createdAt;let m;if(f.seconds?m=new Date(f.seconds*1e3):m=new Date(f),isNaN(m.getTime()))return"";const x=m.toLocaleDateString("ar-EG-u-nu-latn",{weekday:"short"}),y=m.toLocaleDateString("ar-EG-u-nu-latn",{day:"numeric",month:"numeric"}),w=m.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric"});return`${x} ${y} - ${w}`}catch{return""}})(),a=j.useMemo(()=>{if(!(t!=null&&t.canShowDeliveryTime)||s.status!==ue.Delivered||!s.deliveredAt)return null;try{let f;return s.deliveredAt.seconds?f=new Date(s.deliveredAt.seconds*1e3):f=new Date(s.deliveredAt),isNaN(f.getTime())?null:f.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric",hour12:!0})}catch{return null}},[s.deliveredAt,s.status,t]),l=s.type==="shopping_order";return r.jsxs("div",{className:`bg-gray-800 rounded-2xl p-4 space-y-3 transition-all border shadow-sm hover:shadow-md relative overflow-hidden group ${l?"border-purple-500/30":"border-gray-700"}`,children:[l&&r.jsx("div",{className:"absolute top-0 left-0 bg-purple-600 text-white text-[9px] px-2 py-0.5 rounded-br-lg font-bold z-10",children:" "}),r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1.5 flex-wrap",children:[r.jsxs("span",{className:"font-mono text-xs text-red-400 bg-red-900/10 px-2 py-0.5 rounded-md border border-red-900/30 font-bold tracking-wider",children:["#",s.id]}),r.jsxs("span",{className:"text-[10px] text-gray-400 font-medium flex items-center gap-1 bg-black/20 px-2 py-0.5 rounded-md",children:[r.jsx(wt,{className:"w-3 h-3 opacity-70"}),n]}),a&&r.jsxs("span",{className:"text-[10px] text-green-400 font-bold flex items-center gap-1 bg-green-900/20 px-2 py-0.5 rounded-md border border-green-500/20 animate-fadeIn",children:[r.jsx(nt,{className:"w-3 h-3"}),": ",a]})]}),r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx("div",{className:"mt-0.5",children:l?r.jsx(zt,{className:"w-4 h-4 text-purple-400"}):r.jsx(Nn,{className:"w-4 h-4 text-gray-500"})}),r.jsx("p",{className:"font-bold text-white text-sm leading-snug line-clamp-2",children:((c=s.customer)==null?void 0:c.address)||"  "})]}),s.notes&&r.jsxs("div",{className:"mt-2 bg-red-900/10 p-2.5 rounded-lg border border-red-500/20",children:[r.jsx("p",{className:"text-[11px] font-bold text-red-400 mb-1",children:":"}),r.jsx("p",{className:"text-xs text-gray-200 leading-relaxed font-medium",children:s.notes})]}),r.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[r.jsxs("p",{className:"text-xs text-gray-400 flex items-center gap-1 bg-gray-700/30 px-2 py-1 rounded-lg",children:[r.jsx(pt,{className:"w-3 h-3"}),r.jsx("span",{className:"font-mono dir-ltr copyable-phone",children:((d=s.customer)==null?void 0:d.phone)||""})]}),s.totalPrice&&r.jsxs("p",{className:"text-xs font-bold text-green-400 bg-green-900/10 px-2 py-1 rounded-lg border border-green-500/10",children:[s.totalPrice.toLocaleString("en-US")," ."]})]})]}),r.jsx("div",{className:"flex-shrink-0 mr-2 flex flex-col items-end gap-2",children:r.jsx(z5,{status:s.status})})]}),r.jsx("div",{className:"pt-3 border-t border-gray-700/50",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-1.5 bg-gray-700 rounded-full ml-2 border border-gray-600",children:r.jsx(Bt,{className:`w-3.5 h-3.5 ${e.name!==" "?"text-blue-400":"text-gray-500"}`})}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-gray-500",children:" "}),r.jsx("span",{className:`text-xs font-bold ${e.name===" "?"text-gray-500 italic":"text-white"}`,children:e.name})]})]}),e.phone&&(s.status===ue.InTransit||s.status===ue.Delivered)&&r.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[r.jsx("a",{href:`https://wa.me/2${e.phone}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-green-600/10 text-green-400 rounded-lg hover:bg-green-600/20 transition-colors border border-green-500/10",children:r.jsx(cc,{className:"w-4 h-4"})}),r.jsx("a",{href:`tel:${e.phone}`,className:"p-2 bg-blue-600/10 text-blue-400 rounded-lg hover:bg-blue-600/20 transition-colors border border-blue-500/10",children:r.jsx(Js,{className:"w-4 h-4"})})]})]})})]})},pw=({active:s,label:e,count:t,onClick:n,icon:a})=>r.jsxs("button",{onClick:n,className:`flex items-center gap-2 px-4 py-2.5 rounded-xl text-xs font-bold transition-all border whitespace-nowrap ${s?"bg-red-600 text-white border-red-500 shadow-lg shadow-red-900/20":"bg-gray-800 text-gray-400 border-gray-700 hover:bg-gray-700 hover:text-gray-200"}`,children:[a&&r.jsx("span",{className:s?"text-white":"text-gray-500",children:a}),e,t!==void 0&&r.jsx("span",{className:`px-1.5 py-0.5 rounded-md text-[10px] ${s?"bg-white/20 text-white":"bg-black/20 text-gray-500"}`,children:t})]}),kW=({orders:s,users:e,viewingMerchant:t})=>{const[n,a]=j.useState(""),[l,c]=j.useState("today"),[d,f]=j.useState(!1),[m,x]=j.useState(new Date().toISOString().split("T")[0]),[y,w]=j.useState(20),v=j.useRef(null),T=q=>{const W=q.createdAt;return typeof W.toDate=="function"?W.toDate():W.seconds?new Date(W.seconds*1e3):new Date(W)},I=q=>{const W=new Date(q);return W.getHours()<6&&W.setDate(W.getDate()-1),W.setHours(0,0,0,0),W},N=j.useMemo(()=>{if(l==="all")return s;const q=l==="today"?I(new Date):new Date(m);return q.setHours(0,0,0,0),s.filter(W=>{const z=T(W);return I(z).getTime()===q.getTime()})},[s,l,m]),P=j.useMemo(()=>N.filter(q=>!d||q.type==="shopping_order").filter(q=>{var W,z;return q.id.toLowerCase().includes(n.toLowerCase())||(((W=q.customer)==null?void 0:W.address)||"").toLowerCase().includes(n.toLowerCase())||(((z=q.customer)==null?void 0:z.phone)||"").includes(n)}).sort((q,W)=>T(W).getTime()-T(q).getTime()),[N,d,n]),U=j.useMemo(()=>{const q=I(new Date);return{today:s.filter(W=>I(T(W)).getTime()===q.getTime()).length,all:s.length,shopping:s.filter(W=>W.type==="shopping_order").length}},[s]);j.useEffect(()=>{w(20)},[P.length]),j.useEffect(()=>{const q=new IntersectionObserver(W=>{W[0].isIntersecting&&y<P.length&&w(z=>z+20)},{threshold:.1});return v.current&&q.observe(v.current),()=>q.disconnect()},[P.length,y]);const V=j.useMemo(()=>P.slice(0,y),[P,y]);return r.jsxs("div",{className:"bg-gray-900 flex flex-col h-full min-h-full",children:[r.jsxs("div",{className:"px-4 py-4 flex items-center gap-2 bg-gray-900 border-b border-gray-800",children:[r.jsx("div",{className:"p-2 bg-red-600/10 rounded-xl text-red-500",children:r.jsx(ym,{className:"w-6 h-6"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-black text-white",children:" "}),r.jsx("p",{className:"text-xs text-gray-400 font-medium",children:"   "})]})]}),r.jsxs("div",{className:"bg-gray-900 border-b border-gray-800 pb-2",children:[r.jsx("div",{className:"px-4 pt-3 pb-3",children:r.jsxs("div",{className:"relative",children:[r.jsx(Kn,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 w-5 h-5"}),r.jsx("input",{type:"text",placeholder:"    ...",value:n,onChange:q=>a(q.target.value),className:"w-full pl-4 pr-10 py-3 bg-gray-800 border border-gray-700 rounded-xl text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all placeholder-gray-500 text-sm shadow-inner"})]})}),r.jsxs("div",{className:"flex gap-2 overflow-x-auto px-4 pb-2 scrollbar-hide items-center",children:[r.jsx(pw,{active:l==="today"&&!d,label:" ",count:U.today,onClick:()=>{c("today"),f(!1)},icon:r.jsx(wt,{className:"w-4 h-4"})}),r.jsx(pw,{active:d,label:" ",count:U.shopping,onClick:()=>f(!d),icon:r.jsx(zt,{className:"w-4 h-4"})}),r.jsx(pw,{active:l==="all"&&!d,label:" ( )",count:U.all,onClick:()=>{c("all"),f(!1)},icon:r.jsx(Wn,{className:"w-4 h-4"})}),r.jsxs("div",{className:`flex items-center gap-2 px-2 py-1.5 rounded-xl border transition-all ${l==="custom"?"bg-blue-900/20 border-blue-500":"bg-gray-800 border-gray-700"}`,children:[r.jsx("input",{type:"date",value:m,onChange:q=>{x(q.target.value),c("custom"),f(!1)},className:"bg-transparent text-white text-xs font-bold outline-none cursor-pointer"}),r.jsx(il,{className:`w-4 h-4 ${l==="custom"?"text-blue-400":"text-gray-500"}`})]})]})]}),r.jsx("div",{className:"p-4 space-y-3 pb-24",children:V.length===0?r.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 py-20 bg-gray-800/20 rounded-3xl border border-dashed border-gray-700 mt-4",children:[r.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4 shadow-inner",children:r.jsx(C0,{className:"w-10 h-10 opacity-30"})}),r.jsx("h3",{className:"text-lg font-bold text-gray-300",children:"  "}),r.jsx("p",{className:"text-sm mt-1",children:"     ."})]}):r.jsxs(r.Fragment,{children:[V.map(q=>{var W,z;return r.jsx(AW,{order:q,driver:{name:((W=e.find(k=>k.id===q.driverId))==null?void 0:W.name)||" ",phone:(z=e.find(k=>k.id===q.driverId))==null?void 0:z.phone},viewingMerchant:t},q.id)}),r.jsx("div",{ref:v,className:"h-10 flex items-center justify-center",children:y<P.length&&r.jsx("div",{className:"w-6 h-6 border-2 border-red-500 border-t-transparent rounded-full animate-spin"})})]})})]})},CW=({orders:s,onUpdateStatus:e,theme:t,users:n})=>{var y,w;const[a,l]=j.useState(null),c=s.filter(v=>v.status===ue.WaitingMerchant||v.status===ue.Preparing).sort((v,T)=>{const I=new Date(v.createdAt).getTime()||0,N=new Date(T.createdAt).getTime()||0;return I-N});if(c.length===0)return r.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 min-h-[60vh]",children:[(w=(y=t==null?void 0:t.merchant)==null?void 0:y.icons)!=null&&w.img_empty_list?r.jsx("img",{src:t.merchant.icons.img_empty_list,className:"w-24 h-24 mb-6 object-contain",alt:"Empty"}):r.jsx(C0,{className:"w-24 h-24 mb-6 opacity-20"}),r.jsx("h3",{className:"text-xl font-bold text-neutral-300 mb-2",children:"   "}),r.jsx("p",{className:"text-sm text-gray-400",children:"       ."})]});const d=({name:v,Default:T,className:I})=>{var P,U;const N=(U=(P=t==null?void 0:t.merchant)==null?void 0:P.icons)==null?void 0:U[v];return N?r.jsx("img",{src:N,className:`${I} object-contain`,alt:v}):r.jsx(T,{className:I})},f=v=>{if(v!=null&&v.startsWith("data:")||v!=null&&v.startsWith("http"))return"p-0";switch(v){case"gold":return"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[2px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[2px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-0"}},m=v=>(v==null?void 0:v.startsWith("data:"))||(v==null?void 0:v.startsWith("http")),x=()=>{a&&(e(a,ue.Cancelled),l(null))};return r.jsxs("div",{className:"space-y-6 pb-24",children:[r.jsxs("h2",{className:"text-2xl font-bold text-white mb-6 flex items-center gap-3 border-b border-gray-700 pb-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-500 opacity-20"}),r.jsx(d,{name:"ic_notification",Default:Nn,className:"w-8 h-8 text-red-500 relative"})]}),"   (",c.length,")"]}),c.map(v=>{var P,U,V,q,W,z,k;const T=v.status===ue.WaitingMerchant,I=new Date(v.createdAt).toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric"}),N=n==null?void 0:n.find(M=>{var B;return M.phone===((B=v.customer)==null?void 0:B.phone)});return r.jsxs("div",{className:`rounded-2xl border shadow-xl overflow-hidden transition-all duration-300 ${T?"bg-gray-800 border-purple-500/50 shadow-purple-900/10":"bg-gray-800 border-orange-500/50 shadow-orange-900/10"}`,children:[r.jsxs("div",{className:`p-4 flex justify-between items-center ${T?"bg-gradient-to-r from-purple-900/40 to-gray-800":"bg-gradient-to-r from-orange-900/40 to-gray-800"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:`text-xs font-bold px-3 py-1.5 rounded-full text-white shadow-sm ${T?"bg-purple-600":"bg-orange-600"}`,children:T?" ":" "}),r.jsxs("span",{className:"text-gray-300 text-sm font-mono font-semibold tracking-wider",children:["#",v.id]})]}),r.jsxs("div",{className:"flex items-center text-gray-400 text-xs bg-black/20 px-2 py-1 rounded-lg",children:[r.jsx(d,{name:"ic_time",Default:wt,className:"w-3.5 h-3.5 ml-1.5"}),I]})]}),r.jsxs("div",{className:"p-5 border-b border-gray-700/50",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:`relative w-10 h-10 flex items-center justify-center rounded-full ${m(N==null?void 0:N.specialFrame)?"":f(N==null?void 0:N.specialFrame)}`,children:[m(N==null?void 0:N.specialFrame)&&r.jsx("img",{src:N==null?void 0:N.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-125 pointer-events-none",alt:"frame"}),r.jsx("div",{className:`${m(N==null?void 0:N.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-gray-700/50 flex items-center justify-center overflow-hidden border border-gray-600 relative z-0`,children:N!=null&&N.storeImage?r.jsx("img",{src:N.storeImage,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-5 h-5 text-gray-300"})})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-400 text-xs mb-0.5",children:""}),r.jsx("p",{className:"text-white font-bold text-lg",children:((P=v.customer)==null?void 0:P.name)||" "}),r.jsx("p",{className:"text-gray-500 text-sm font-mono dir-ltr text-right",children:((U=v.customer)==null?void 0:U.phone)||""})]})]}),r.jsxs("div",{className:"text-left bg-gray-700/30 p-2 rounded-lg border border-gray-600/30",children:[r.jsx("p",{className:"text-gray-400 text-xs mb-1",children:""}),r.jsxs("p",{className:"text-green-400 font-bold text-xl",children:[(V=v.totalPrice)==null?void 0:V.toLocaleString("en-US")," ",r.jsx("span",{className:"text-xs",children:"."})]})]})]}),v.notes&&r.jsxs("div",{className:"mt-4 bg-red-900/10 border border-red-500/20 p-3 rounded-lg",children:[r.jsx("p",{className:"text-xs text-red-400 font-bold mb-1",children:" :"}),r.jsx("p",{className:"text-sm text-gray-300",children:v.notes})]})]}),r.jsxs("div",{className:"p-5 space-y-3 bg-[#1a1a1a]/50",children:[r.jsxs("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:["  (",((q=v.items)==null?void 0:q.length)||0,")"]}),(W=v.items)==null?void 0:W.map((M,B)=>{var D,S;return r.jsxs("div",{className:"flex gap-4 bg-[#252525] p-3 rounded-xl border border-gray-700/50 items-center",children:[r.jsx("div",{className:"w-16 h-16 bg-gray-800 rounded-lg overflow-hidden flex-shrink-0 border border-gray-600",children:M.image?r.jsx("img",{src:M.image,alt:M.name,className:"w-full h-full object-cover"}):r.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:(S=(D=t==null?void 0:t.merchant)==null?void 0:D.icons)!=null&&S.img_default_product?r.jsx("img",{src:t.merchant.icons.img_default_product,className:"w-6 h-6 object-contain"}):r.jsx(Qr,{className:"w-6 h-6 opacity-50"})})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"flex justify-between items-start mb-1",children:r.jsx("h4",{className:"text-white font-bold text-sm truncate pl-2",children:M.name})}),r.jsxs("p",{className:"text-gray-400 text-xs",children:[M.price.toLocaleString("en-US")," . "]}),r.jsxs("p",{className:"text-green-500 font-bold text-sm mt-1",children:[": ",(M.price*M.quantity).toLocaleString("en-US")," ."]})]}),r.jsxs("div",{className:"flex flex-col items-center justify-center bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 min-w-[3.5rem]",children:[r.jsx("span",{className:"text-[10px] text-gray-400 mb-0.5",children:""}),r.jsx("span",{className:"text-xl font-black text-white",children:M.quantity})]})]},B)})]}),r.jsx("div",{className:"p-4 bg-gray-800 border-t border-gray-700",children:r.jsx("div",{className:"flex gap-3",children:T?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>l(v.id),className:"flex-1 bg-gray-700 hover:bg-red-900/50 text-gray-300 hover:text-red-400 py-3.5 rounded-xl font-bold transition-colors border border-gray-600 hover:border-red-500/50 flex items-center justify-center gap-2",children:[((k=(z=t==null?void 0:t.merchant)==null?void 0:z.icons)==null?void 0:k.btn_delete)&&r.jsx("img",{src:t.merchant.icons.btn_delete,className:"w-4 h-4 object-contain"})," "]}),r.jsxs("button",{onClick:()=>e(v.id,ue.Preparing),className:"flex-[2] bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-500 hover:to-purple-600 text-white py-3.5 rounded-xl font-bold shadow-lg shadow-purple-900/30 transition-all active:scale-95 flex items-center justify-center gap-2 border border-purple-500/20",children:[r.jsx(nt,{className:"w-5 h-5"}),"  "]})]}):r.jsxs("button",{onClick:()=>e(v.id,ue.Pending),className:"w-full bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-500 hover:to-orange-600 text-white py-4 rounded-xl font-bold shadow-lg shadow-orange-900/30 transition-all active:scale-95 flex items-center justify-center gap-2 border border-orange-500/20",children:[r.jsx(Nn,{className:"w-5 h-5"}),"  ( )"]})})})]},v.id)}),a&&r.jsx(os,{title:" ",message:"            .",onClose:()=>l(null),onConfirm:x,confirmButtonText:" ",confirmVariant:"danger"})]})},RW=({messages:s,onMarkAsSeen:e,hideMessage:t})=>{const[n,a]=j.useState(null);j.useEffect(()=>{s.forEach(c=>{e(c.id)})},[s,e]);const l=()=>{n&&(t(n),a(null))};return r.jsxs("div",{className:"space-y-6 pb-24 animate-fadeIn p-1",children:[r.jsxs("h2",{className:"text-2xl font-bold text-white mb-2 flex items-center gap-3 px-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-0 bg-red-500 blur-lg opacity-20 rounded-full"}),r.jsx(kr,{className:"w-8 h-8 text-red-500 relative"})]}),r.jsx("span",{children:" "})]}),s.length===0?r.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 min-h-[50vh] bg-gray-800/30 rounded-3xl border border-gray-700/50 p-8 mx-2",children:[r.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4 shadow-inner border border-gray-700",children:r.jsx(kr,{className:"w-8 h-8 text-gray-600"})}),r.jsx("p",{className:"text-lg font-semibold text-gray-300",children:"  "}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"   ."})]}):r.jsx("div",{className:"space-y-5 px-2",children:s.map(c=>{const d=(()=>{try{const f=new Date(c.createdAt);return isNaN(f.getTime())?"":f.toLocaleString("ar-EG-u-nu-latn",{weekday:"short",day:"numeric",hour:"numeric",minute:"numeric"})}catch{return""}})();return r.jsxs("div",{className:"relative bg-[#1e1e1e] rounded-2xl shadow-lg border border-gray-700 overflow-hidden group hover:border-gray-500 transition-colors duration-300",children:[r.jsxs("div",{className:"bg-gradient-to-r from-[#2a2a2a] to-[#1e1e1e] p-4 flex justify-between items-start border-b border-gray-700/50",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 bg-purple-600/10 rounded-xl border border-purple-500/20",children:r.jsx(pt,{className:"w-5 h-5 text-purple-400"})}),r.jsxs("div",{children:[r.jsx("span",{className:"block text-sm font-bold text-white",children:" "}),r.jsx("span",{className:"text-[10px] text-purple-400 bg-purple-900/20 px-2 py-0.5 rounded border border-purple-500/20",children:" "})]})]}),r.jsxs("div",{className:"text-[10px] font-medium text-gray-400 flex items-center gap-1.5 bg-black/30 px-2 py-1 rounded-md border border-white/5",children:[r.jsx(wt,{className:"w-3 h-3"}),d]})]}),r.jsxs("div",{className:"p-5",children:[c.image&&r.jsx("div",{className:"mb-4 rounded-xl overflow-hidden border border-gray-600 bg-black",children:r.jsx("img",{src:c.image,alt:"",className:"w-full h-auto max-h-64 object-contain mx-auto"})}),r.jsx("p",{className:"text-gray-200 text-sm leading-7 whitespace-pre-wrap",children:c.text})]}),r.jsx("div",{className:"px-4 py-3 bg-[#151515] flex justify-end border-t border-gray-800",children:r.jsxs("button",{onClick:()=>a(c.id),className:"flex items-center gap-2 text-gray-500 hover:text-red-400 transition-colors text-xs font-bold px-3 py-1.5 rounded-lg hover:bg-red-500/5",children:[r.jsx(Pt,{className:"w-4 h-4"}),r.jsx("span",{children:""})]})})]},c.id)})}),n&&r.jsx(os,{title:" ",message:"              .",onClose:()=>a(null),onConfirm:l,confirmButtonText:"",confirmVariant:"danger"})]})},kp=({icon:s,label:e,subLabel:t,onClick:n,danger:a,active:l})=>r.jsxs("button",{onClick:n,className:`w-full flex items-center justify-between p-4 rounded-xl border border-transparent transition-all active:scale-[0.98] ${a?"bg-red-900/10 hover:bg-red-900/20 text-red-500":"bg-[#252525] hover:bg-[#303030] text-white hover:border-[#333]"}`,children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:`p-2.5 rounded-full ${a?"bg-red-500/10":l?"bg-green-500/20 text-green-400":"bg-gray-800 text-gray-300"}`,children:Ar.cloneElement(s,{className:`w-5 h-5 ${a?"text-red-500":""}`})}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:`font-bold text-sm ${a?"text-red-400":"text-gray-200"}`,children:e}),t&&r.jsx("p",{className:`text-xs mt-0.5 ${l?"text-green-400":"text-gray-500"}`,children:t})]})]}),!a&&r.jsx(Gs,{className:"w-5 h-5 text-gray-600"})]}),DW=({merchant:s,onLogout:e,onUpdateUser:t,onUpdateTheme:n,currentTheme:a})=>{var Q,L;const[l,c]=j.useState("menu"),[d,f]=j.useState(""),[m,x]=j.useState(""),[y,w]=j.useState(!1),[v,T]=j.useState(((Q=s.workingHours)==null?void 0:Q.start)||"09:00"),[I,N]=j.useState(((L=s.workingHours)==null?void 0:L.end)||"23:00"),[P,U]=j.useState(s.storeImage||null),[V,q]=j.useState(!1),W=j.useRef(null),[z,k]=j.useState(null),[M,B]=j.useState(!1),[D,S]=j.useState(!1),F=()=>{if(!d||d.length<6){k({text:"     6   .",type:"error"});return}if(d!==m){k({text:"   .",type:"error"});return}t(s.id,{password:d}),k({text:"    .",type:"success"}),setTimeout(()=>{c("menu"),f(""),x(""),k(null)},1500)},E=()=>{t(s.id,{workingHours:{start:v,end:I}}),k({text:"    .",type:"success"}),setTimeout(()=>{c("menu"),k(null)},1500)},Y=()=>{s.hasFreeDelivery?t(s.id,{hasFreeDelivery:!1}):S(!0)},X=()=>{t(s.id,{hasFreeDelivery:!0}),Jt("admin",{title:"    ",body:`  "${s.name}"    .   .`,url:"/?target=stores",targetId:"all"}),S(!1)},R=G=>{var ne;const ee=(ne=G.target.files)==null?void 0:ne[0];if(ee){q(!0);const je=new FileReader;je.onloadend=()=>{const se=new Image;se.src=je.result,se.onload=()=>{const _e=document.createElement("canvas"),Te=1200,be=Te/se.width;_e.width=Te,_e.height=se.height*be;const ye=_e.getContext("2d");if(ye){ye.imageSmoothingEnabled=!0,ye.imageSmoothingQuality="high",ye.drawImage(se,0,0,_e.width,_e.height);const et=_e.toDataURL("image/jpeg",.9);setTimeout(()=>{U(et),t(s.id,{storeImage:et}),q(!1)},800)}}},je.readAsDataURL(ee)}},J=G=>{if(G!=null&&G.startsWith("data:")||G!=null&&G.startsWith("http"))return"p-0";switch(G){case"gold":return"p-[4px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_15px_rgba(252,246,186,0.5)]";case"neon":return"p-[4px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_15px_rgba(34,211,238,0.6)]";case"royal":return"p-[4px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-xl border border-purple-500/30";case"fire":return"p-[4px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_15px_rgba(239,68,68,0.5)]";default:return"p-0"}},O=G=>{if(!G||G==="none")return null;if(G!=null&&G.startsWith("data:")||G!=null&&G.startsWith("http"))return r.jsx("div",{className:"w-8 h-8 min-w-[2rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:r.jsx("img",{src:G,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let ee=null,ne="";switch(G){case"verified":ee=qi,ne="text-blue-400 fill-blue-500/20";break;case"vip":ee=va,ne="text-yellow-400 fill-yellow-500/20";break;case"star":ee=Rr,ne="text-purple-400 fill-purple-500/20";break;case"popular":ee=zt,ne="text-red-400 fill-red-500/20";break}return ee?r.jsx(ee,{className:`w-6 h-6 ml-2 ${ne}`}):null},K=G=>(G==null?void 0:G.startsWith("data:"))||(G==null?void 0:G.startsWith("http"));return r.jsxs("div",{className:"pb-24 animate-fadeIn",children:[r.jsxs("div",{className:"flex items-center gap-4 py-4 mb-2",children:[l!=="menu"?r.jsx("button",{onClick:()=>c("menu"),className:"bg-[#252525] p-2 rounded-full text-gray-400 hover:text-white",children:r.jsx(Gs,{className:"w-6 h-6 rotate-180"})}):r.jsx("div",{className:"w-10"}),r.jsx("h2",{className:"text-2xl font-bold text-white flex-1 text-center",children:l==="menu"?" ":l==="settings"?"":" "}),r.jsx("div",{className:"w-10"})]}),l==="menu"&&r.jsxs("div",{className:"space-y-8",children:[r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsxs("div",{className:`relative w-full aspect-video max-h-48 rounded-2xl overflow-hidden bg-[#252525] border-2 border-[#333] shadow-lg group ${K(s.specialFrame)?"":J(s.specialFrame)}`,children:[K(s.specialFrame)&&r.jsx("img",{src:s.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain pointer-events-none border-4 border-transparent",alt:"frame"}),r.jsxs("div",{className:`${K(s.specialFrame)?"w-[92%] h-[92%] m-auto":"w-full h-full"} overflow-hidden rounded-xl relative z-0 flex items-center justify-center`,children:[V&&r.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 z-50 backdrop-blur-sm",children:r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full opacity-75 animate-ping absolute top-0 left-0"}),r.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center relative z-10 shadow-lg shadow-blue-500/50",children:r.jsx(ur,{className:"w-6 h-6 text-white animate-bounce"})}),r.jsx("div",{className:"w-20 h-20 border-4 border-blue-400/30 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"})]})}),P?r.jsx("img",{src:P,alt:s.name,className:"w-full h-full object-cover"}):r.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:r.jsx(Qo,{className:"w-12 h-12"})}),r.jsxs("button",{onClick:()=>{var G;return!V&&((G=W.current)==null?void 0:G.click())},className:"absolute bottom-3 left-3 bg-purple-600 text-white px-3 py-1.5 rounded-lg text-xs font-bold shadow-lg flex items-center gap-2 transition-transform active:scale-95 z-20",children:[r.jsx(ga,{className:"w-4 h-4"})," "]}),r.jsx("input",{ref:W,type:"file",accept:"image/*",className:"absolute opacity-0 w-0 h-0 pointer-events-none",onChange:R})]})]}),r.jsxs("div",{className:"mt-4 text-center flex items-center gap-2 justify-center",children:[r.jsx("h3",{className:"text-2xl font-bold text-white",children:s.name}),O(s.specialBadge)]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-xs font-bold text-gray-500 mr-2 uppercase tracking-wider",children:""}),r.jsx(kp,{icon:r.jsx(Bt,{}),label:"  ",subLabel:s.hasFreeDelivery?"  ":"  ( )",onClick:Y,active:s.hasFreeDelivery})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-xs font-bold text-gray-500 mr-2 uppercase tracking-wider",children:" "}),r.jsx(kp,{icon:r.jsx(wt,{}),label:" ",subLabel:s.workingHours?`${s.workingHours.start} - ${s.workingHours.end}`:" ",onClick:()=>c("hours")}),r.jsx(kp,{icon:r.jsx(on,{}),label:"  ",onClick:()=>c("settings")}),r.jsx(kp,{icon:r.jsx(bm,{}),label:" ",danger:!0,onClick:()=>B(!0)})]})]}),l==="hours"&&r.jsxs("div",{className:"bg-[#252525] p-6 rounded-2xl border border-[#333] space-y-6 animate-fadeIn",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 text-center",children:" "}),r.jsx("input",{type:"time",value:v,onChange:G=>T(G.target.value),className:"w-full px-2 py-4 bg-[#1a1a1a] border border-[#333] rounded-xl text-white text-center font-mono text-lg outline-none"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 text-center",children:" "}),r.jsx("input",{type:"time",value:I,onChange:G=>N(G.target.value),className:"w-full px-2 py-4 bg-[#1a1a1a] border border-[#333] rounded-xl text-white text-center font-mono text-lg outline-none"})]})]}),z&&r.jsx("div",{className:`p-4 rounded-xl text-sm font-bold text-center ${z.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:z.text}),r.jsx("button",{onClick:E,className:"w-full bg-purple-600 text-white font-bold py-4 rounded-xl shadow-lg active:scale-95",children:" "})]}),l==="settings"&&r.jsxs("div",{className:"bg-[#252525] p-6 rounded-2xl border border-[#333] space-y-6 animate-fadeIn",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:"  "}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:y?"text":"password",value:d,onChange:G=>f(G.target.value),className:"w-full bg-[#1a1a1a] border border-[#333] rounded-xl p-4 text-white outline-none",placeholder:"******"}),r.jsx("button",{onClick:()=>w(!y),className:"absolute left-4 top-4 text-gray-500",children:y?r.jsx(Ui,{className:"w-5 h-5"}):r.jsx(wa,{className:"w-5 h-5"})})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:"  "}),r.jsx("input",{type:"password",value:m,onChange:G=>x(G.target.value),className:"w-full bg-[#1a1a1a] border border-[#333] rounded-xl p-4 text-white outline-none",placeholder:"******"})]})]}),z&&r.jsx("div",{className:`p-4 rounded-xl text-sm font-bold text-center ${z.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:z.text}),r.jsx("button",{onClick:F,className:"w-full bg-blue-600 text-white font-bold py-4 rounded-xl shadow-lg active:scale-95",children:" "})]}),M&&r.jsx(os,{title:" ",message:"      ",onClose:()=>B(!1),onConfirm:()=>{B(!1),e()},confirmButtonText:" ",cancelButtonText:"",confirmVariant:"danger"}),D&&r.jsx(os,{title:"  ",message:"                   .",onClose:()=>S(!1),onConfirm:X,confirmButtonText:" ",cancelButtonText:"",confirmVariant:"success"})]})},OW=({activePage:s,onNavigate:e,messageCount:t=0,theme:n,showMenu:a=!0})=>{const l=[{id:"home",key:"nav_home",label:"",icon:Ev},{id:"messages",key:"nav_messages",label:"",icon:kr},...a?[{id:"menu",key:"nav_menu",label:"",icon:Xr}]:[],{id:"history",key:"nav_history",label:"",icon:Wn}];return r.jsx("div",{className:"fixed left-4 right-4 z-40 transition-transform duration-300 ease-in-out",style:{bottom:"calc(1.5rem + env(safe-area-inset-bottom))"},children:r.jsx("nav",{className:"bg-gray-900/95 backdrop-blur-xl border border-gray-700 shadow-[0_10px_40px_rgba(0,0,0,0.6)] flex justify-around items-center h-[70px] rounded-[30px] px-2 safe-area-pb",children:l.map(c=>{var x,y;const d=c.icon,f=(y=(x=n==null?void 0:n.merchant)==null?void 0:x.icons)==null?void 0:y[c.key],m=s===c.id;return r.jsxs("button",{onClick:()=>e(c.id),className:"group relative flex-1 h-full flex flex-col items-center justify-center outline-none select-none",style:{WebkitTapHighlightColor:"transparent"},children:[r.jsxs("div",{className:`relative transition-all duration-300 ease-out p-1.5 rounded-2xl ${m?"-translate-y-2":"translate-y-1"}`,children:[r.jsx("div",{className:`absolute inset-0 bg-red-500/20 blur-xl rounded-full transition-opacity duration-300 ${m?"opacity-100":"opacity-0"}`}),f?r.jsx("img",{src:f,alt:c.label,className:`w-6 h-6 object-contain z-10 relative ${m?"drop-shadow-md":"grayscale opacity-70"}`},f):r.jsx("div",{className:"relative z-10",children:r.jsx(d,{className:`w-6 h-6 transition-all duration-300 ${m?"text-red-500 drop-shadow-[0_2px_8px_rgba(239,68,68,0.4)]":"text-gray-500"}`})}),c.id==="messages"&&t>0&&r.jsx("span",{className:"absolute -top-1 -right-2 bg-red-600 text-white text-[10px] rounded-full w-4 h-4 flex items-center justify-center font-bold border-2 border-gray-900 animate-pulse z-20 shadow-sm",children:t})]}),r.jsx("span",{className:`text-[10px] font-bold tracking-wide transition-all duration-300 absolute bottom-2 ${m?"text-white translate-y-0 opacity-100":"text-gray-500 translate-y-2 opacity-0"}`,children:c.label}),m&&r.jsx("span",{className:"absolute bottom-1 w-1 h-1 bg-red-500 rounded-full shadow-[0_0_5px_rgba(239,68,68,0.8)]"})]},c.id)})})})},PW=({message:s,onClose:e})=>r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50 p-4",onClick:e,children:r.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-sm text-white",onClick:t=>t.stopPropagation(),children:[r.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[r.jsx("h3",{className:"text-lg font-bold text-neutral-100",children:"  "}),r.jsx("button",{onClick:e,className:"text-neutral-400 hover:text-white",children:r.jsx(rt,{className:"w-6 h-6"})})]}),r.jsxs("div",{className:"p-6 space-y-4 max-h-[60vh] overflow-y-auto",children:[s.image&&r.jsx("img",{src:s.image,alt:"",className:"w-full h-auto rounded-md object-contain"}),r.jsx("p",{className:"text-neutral-200 whitespace-pre-wrap",children:s.text})]}),r.jsx("div",{className:"bg-gray-900 px-4 py-3 flex justify-end rounded-b-lg",children:r.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none",children:""})})]})}),MW=({merchant:s,orders:e,users:t,addOrder:n,messages:a,seenMessageIds:l,markMessageAsSeen:c,hideMessage:d,deletedMessageIds:f,onUpdateUser:m,onUpdateOrderStatus:x,onLogout:y,appTheme:w,onUpdateTheme:v,initialRoute:T,appConfig:I})=>{const[N,P]=j.useState("home"),[U,V]=j.useState(null),q=s.canManageMenu!==!1;j.useEffect(()=>{(T==null?void 0:T.target)==="incoming"||(T==null?void 0:T.target)==="orders"?P("incoming"):(T==null?void 0:T.target)==="messages"?P("messages"):(T==null?void 0:T.target)==="profile"&&P("profile")},[T]),j.useEffect(()=>{wm("merchant",s.id)},[s.id]),j.useEffect(()=>{Is.reportContext(N)},[N]),Ht(()=>U?(V(null),!0):N!=="home"?(P("home"),!0):!1,[N,U]);const W=j.useMemo(()=>e.filter(R=>R.merchantId===s.id),[e,s.id]),z=j.useMemo(()=>W.filter(R=>R.status===ue.WaitingMerchant).length,[W]),k=j.useMemo(()=>a.filter(R=>!f.includes(R.id)&&R.targetRole==="merchant").sort((R,J)=>new Date(J.createdAt).getTime()-new Date(R.createdAt).getTime()),[a,f]),M=j.useMemo(()=>k.filter(R=>{var J;return!((J=R.readBy)!=null&&J.includes(s.id))}).length,[k,s.id]),B=R=>{if(R!=null&&R.startsWith("data:")||R!=null&&R.startsWith("http"))return"p-0";switch(R){case"gold":return"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[2px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[2px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-0"}},D=R=>(R==null?void 0:R.startsWith("data:"))||(R==null?void 0:R.startsWith("http")),S=()=>{switch(N){case"home":return r.jsxs("div",{className:"max-w-2xl mx-auto space-y-6 animate-fadeIn",children:[r.jsx(IW,{addOrder:n}),z>0&&r.jsxs("button",{onClick:()=>P("incoming"),className:"w-full bg-purple-600/20 border border-purple-500 text-purple-200 p-4 rounded-xl flex justify-between items-center animate-pulse",children:[r.jsxs("span",{className:"font-bold",children:[" ",z,"  "]}),r.jsx("span",{className:"bg-purple-600 text-white px-3 py-1 rounded-full text-xs font-black",children:""})]})]});case"incoming":return r.jsx(CW,{orders:W,onUpdateStatus:x||(()=>{}),theme:w,users:t});case"history":return r.jsx(kW,{orders:W,users:t,viewingMerchant:s});case"menu":return q?r.jsx(G5,{merchant:s,onUpdateMerchant:m||(()=>{})}):null;case"messages":return r.jsx(RW,{messages:k,onMarkAsSeen:c,hideMessage:d});case"profile":return r.jsx(DW,{merchant:s,onLogout:y,onUpdateUser:m||(()=>{}),onUpdateTheme:v,currentTheme:w});default:return null}},F=(I==null?void 0:I.appName)||"GOO NOW",[E,...Y]=F.split(" "),X=Y.join(" ");return r.jsxs("div",{className:"fixed inset-0 bg-gray-900 text-white flex flex-col",children:[r.jsxs("header",{className:"flex-none border-b border-gray-700 flex justify-between items-center bg-gray-900 z-30 shadow-md pt-safe px-4 h-16 box-content",children:[r.jsx("div",{className:"flex items-center",children:r.jsxs("button",{onClick:()=>P("profile"),className:`relative w-10 h-10 flex items-center justify-center rounded-full transition-transform active:scale-95 ${D(s.specialFrame)?"":B(s.specialFrame)}`,children:[D(s.specialFrame)&&r.jsx("img",{src:s.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-125 pointer-events-none",alt:"frame"}),r.jsx("div",{className:`${D(s.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full overflow-hidden border border-gray-600 relative z-0 flex items-center justify-center ${N==="profile"?"ring-2 ring-red-500":""}`,children:s.storeImage?r.jsx("img",{src:s.storeImage,className:"w-full h-full object-cover"}):r.jsx("div",{className:"w-full h-full bg-gray-800 flex items-center justify-center",children:r.jsx(pt,{className:"w-5 h-5 text-gray-400"})})})]})}),r.jsxs("h1",{className:"text-xl font-bold font-sans",children:[r.jsx("span",{className:"text-red-500",children:E}),r.jsx("span",{className:"text-white ml-1",children:X})]}),r.jsxs("button",{onClick:()=>P("incoming"),className:"relative p-2",children:[r.jsx(an,{className:`w-6 h-6 ${z>0?"text-yellow-400":"text-gray-400"}`}),z>0&&r.jsx("span",{className:"absolute top-1 right-1 w-2.5 h-2.5 bg-red-500 rounded-full animate-bounce"})]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto pb-24 p-4 hardware-accelerated",children:[U&&r.jsx(PW,{message:U,onClose:()=>{c(U.id),V(null)}}),S()]}),r.jsx(OW,{activePage:N,onNavigate:R=>P(R),messageCount:M,theme:w,showMenu:q})]})},LW=Ar.memo(({order:s,users:e,onViewDetails:t,theme:n})=>{var x;const a=s.status===ue.Pending,l=s.type==="shopping_order",c=j.useMemo(()=>e==null?void 0:e.find(y=>y.id===s.merchantId),[e,s.merchantId]),d=j.useMemo(()=>{try{let y;const w=s.createdAt;return w&&typeof w.toDate=="function"?y=w.toDate():w&&w.seconds?y=new Date(w.seconds*1e3):w instanceof Date?y=w:y=new Date(w),isNaN(y.getTime())?{day:"---",date:"---",time:"---"}:{day:y.toLocaleDateString("ar-EG-u-nu-latn",{weekday:"long"}),date:y.toLocaleDateString("ar-EG-u-nu-latn",{day:"numeric",month:"numeric",year:"numeric"}),time:y.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric",hour12:!0})}}catch{return{day:"---",date:"---",time:"---"}}},[s.createdAt]),f=y=>{if(y!=null&&y.startsWith("data:")||y!=null&&y.startsWith("http"))return"p-0";switch(y){case"gold":return"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[2px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[2px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-0"}},m=y=>(y==null?void 0:y.startsWith("data:"))||(y==null?void 0:y.startsWith("http"));return r.jsxs("button",{type:"button",onClick:y=>{y.stopPropagation(),t()},className:`w-full text-right bg-[#1e1e1e] rounded-2xl overflow-hidden shadow-lg transition-all duration-200 relative group border ${l?"border-purple-500/30":"border-white/5"} active:scale-[0.98] mb-1 cursor-pointer select-none`,children:[r.jsx("div",{className:`absolute right-0 top-0 bottom-0 w-1.5 z-10 ${l?"bg-gradient-to-b from-purple-600 to-indigo-500":a?"bg-gradient-to-b from-blue-500 to-blue-700":"bg-gradient-to-b from-green-500 to-emerald-700"}`}),l&&r.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-900/10 to-transparent pointer-events-none"}),r.jsxs("div",{className:"p-4 pl-3 relative z-0",children:[r.jsxs("div",{className:"flex justify-between items-center mb-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"font-mono text-base font-black text-red-500 tracking-wider",children:["#",s.id]}),l&&r.jsxs("span",{className:"bg-purple-500/10 text-purple-400 text-[9px] font-bold px-2 py-0.5 rounded border border-purple-500/20 flex items-center gap-1",children:[r.jsx(zt,{className:"w-3 h-3"})," "]})]}),r.jsx("div",{className:"flex items-center gap-1",children:r.jsx("span",{className:`text-[10px] font-black px-2 py-1 rounded-lg ${a?"bg-blue-500/10 text-blue-400 border border-blue-500/20 animate-pulse":"bg-green-500/10 text-green-400 border border-green-500/20"}`,children:a?" ":s.status})})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[r.jsxs("div",{className:"flex items-center gap-1.5 bg-black/30 px-2 py-1 rounded border border-white/5 shadow-inner",children:[r.jsx(il,{className:"w-3.5 h-3.5 text-blue-400"}),r.jsxs("span",{className:"text-[10px] font-black text-gray-300",children:[d.day," ",d.date]})]}),r.jsxs("div",{className:"flex items-center gap-1.5 bg-black/30 px-2 py-1 rounded border border-white/5 shadow-inner",children:[r.jsx(wt,{className:"w-3.5 h-3.5 text-yellow-400"}),r.jsx("span",{className:"text-[10px] font-black text-gray-300 font-mono",children:d.time})]})]}),r.jsxs("div",{className:"space-y-3 pr-1",children:[r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"mt-0.5 p-1.5 rounded-full bg-blue-500/10 text-blue-400 flex-shrink-0",children:r.jsx(jn,{className:"w-4 h-4"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-[9px] text-gray-500 font-bold mb-0.5 uppercase",children:"  ()"}),r.jsx("p",{className:"text-gray-200 font-bold text-sm leading-tight line-clamp-2",children:((x=s.customer)==null?void 0:x.address)||"  "})]})]}),r.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-xl border ${l?"bg-purple-900/10 border-purple-500/10":"bg-white/5 border-white/5"}`,children:[r.jsxs("div",{className:`relative flex items-center justify-center rounded-full flex-shrink-0 ${m(c==null?void 0:c.specialFrame)?"":f(c==null?void 0:c.specialFrame)}`,children:[m(c==null?void 0:c.specialFrame)&&r.jsx("img",{src:c==null?void 0:c.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-125 pointer-events-none",alt:"frame"}),r.jsx("div",{className:`${m(c==null?void 0:c.specialFrame)?"w-[85%] h-[85%]":"w-8 h-8"} rounded-full overflow-hidden bg-purple-500/10 flex items-center justify-center border border-purple-500/20 relative z-0`,children:l?r.jsx(zt,{className:"w-4 h-4 text-purple-400"}):r.jsx(lr,{className:"w-4 h-4 text-purple-400"})})]}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:`text-[9px] font-bold mb-0.5 uppercase ${l?"text-purple-300":"text-purple-400"}`,children:l?" ":" ()"}),l?r.jsxs("p",{className:"text-gray-200 text-xs leading-relaxed line-clamp-2 italic",children:['"',s.notes||"   ",'"']}):r.jsx("h4",{className:"font-black text-white text-sm truncate group-hover:text-red-400 transition-colors",children:(c==null?void 0:c.name)||s.merchantName||"   "})]})]})]}),r.jsxs("div",{className:"mt-4 pt-3 flex justify-between items-center bg-black/20 -mx-4 -mb-4 px-4 py-3",children:[r.jsx("div",{className:"flex flex-col",children:s.deliveryFee&&(s.status===ue.InTransit||s.status===ue.Delivered)?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-[9px] text-gray-500 font-bold",children:" "}),r.jsxs("span",{className:"text-green-400 font-black text-base leading-none",children:[s.deliveryFee.toLocaleString("en-US")," ",r.jsx("span",{className:"text-[9px] font-medium",children:"."})]})]}):r.jsx("span",{className:"text-[10px] font-bold text-gray-400 italic",children:"    "})}),r.jsxs("div",{className:"flex items-center gap-1.5 text-gray-400 text-[10px] font-black bg-white/5 px-3 py-1.5 rounded-xl border border-white/5 group-hover:bg-white/10 transition-all",children:[r.jsx("span",{children:" "}),r.jsx(Gs,{className:"w-3.5 h-3.5 group-hover:-translate-x-1 transition-transform"})]})]})]})]})},(s,e)=>s.order.id===e.order.id&&s.order.status===e.order.status&&s.order.driverId===e.order.driverId&&s.order.deliveryFee===e.order.deliveryFee&&s.order.totalPrice===e.order.totalPrice&&s.users===e.users&&s.theme===e.theme),VW=({customImage:s})=>r.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 min-h-[60vh]",children:[r.jsx("div",{className:"relative mb-4 opacity-50",children:s?r.jsx("img",{src:s,alt:"Empty",className:"w-40 h-40 object-contain"}):r.jsxs("svg",{className:"w-40 h-40",viewBox:"0 0 100 100",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"grad1",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[r.jsx("stop",{offset:"0%",style:{stopColor:"rgb(59, 130, 246)",stopOpacity:.5}}),r.jsx("stop",{offset:"100%",style:{stopColor:"rgb(239, 68, 68)",stopOpacity:.5}})]})}),r.jsx("path",{d:"M 50,5 L 95,27.5 L 95,72.5 L 50,95 L 5,72.5 L 5,27.5 Z",fill:"url(#grad1)",fillOpacity:"0.1"}),r.jsx("path",{d:"M 50,5 L 95,27.5 L 50,50 L 5,27.5 Z",fill:"url(#grad1)",fillOpacity:"0.15"}),r.jsx("path",{d:"M 95,27.5 L 95,72.5 L 50,50 Z",fill:"url(#grad1)",fillOpacity:"0.1"}),r.jsx("path",{d:"M 5,27.5 L 5,72.5 L 50,50 Z",fill:"url(#grad1)",fillOpacity:"0.2"}),r.jsx("g",{transform:"translate(35, 30) scale(1.2)",children:r.jsx(C0,{})})]})}),r.jsx("h3",{className:"text-lg font-semibold text-neutral-400 mt-2",children:"   "})]}),xw=({orders:s,users:e,onViewOrder:t,theme:n})=>{var a,l;return s.length===0?r.jsx(VW,{customImage:(l=(a=n==null?void 0:n.driver)==null?void 0:a.icons)==null?void 0:l.img_empty_orders}):r.jsx("div",{className:"p-4 space-y-3",children:s.map(c=>r.jsx(LW,{order:c,users:e,onViewDetails:()=>t(c),theme:n},c.id))})},UW=({onStartShift:s})=>r.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-white h-[calc(100vh-8rem)] p-4",children:[r.jsxs("div",{className:"relative mb-6",children:[r.jsx("div",{className:"absolute inset-0 bg-red-500 rounded-full blur-2xl opacity-30 animate-pulse"}),r.jsx(AD,{className:"w-24 h-24 text-gray-500 relative z-10"})]}),r.jsx("h2",{className:"text-2xl font-bold text-neutral-100 mb-2",children:"   "}),r.jsx("p",{className:"text-neutral-400 mb-8 max-w-xs",children:"  .           ."}),r.jsx("button",{onClick:s,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-lg transition-transform transform hover:scale-105 shadow-lg",children:" "})]}),FW=s=>{const{activeTab:e,users:t}=s,n=()=>{s.customStartShift?s.customStartShift():s.onUpdateUser(s.driver.id,{dailyLogStatus:"active",dailyLogStartedAt:new Date})};return s.driver.dailyLogMode==="12_hour"&&s.driver.dailyLogStatus!=="active"?r.jsx(UW,{onStartShift:n}):r.jsxs("div",{className:"bg-[#1A1A1A] min-h-full",children:[e==="home"&&r.jsx(xw,{orders:s.standardNewOrders,users:t,listType:"new",onViewOrder:s.onViewOrder,theme:s.theme}),e==="in-transit"&&r.jsx(xw,{orders:s.inTransitOrders,users:t,listType:"in-transit",onViewOrder:s.onViewOrder,theme:s.theme}),e==="delinow"&&r.jsx(xw,{orders:s.delinowNewOrders,users:t,listType:"new",onViewOrder:s.onViewOrder,theme:s.theme})]})},bw=({label:s,value:e,currency:t=".",colorClass:n="text-white"})=>r.jsxs("div",{className:"flex justify-between items-baseline bg-[#2A2A2A] p-3 rounded-md",children:[r.jsx("span",{className:"text-sm font-medium text-gray-400",children:s}),r.jsxs("span",{className:`text-lg font-bold ${n}`,children:[e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})," ",t]})]}),$W=({driver:s,orders:e,users:t})=>{const n=e.filter(v=>{const T=String(v.driverId)===String(s.id),I=v.status===ue.Delivered,N=v.status!==ue.Cancelled,P=!v.reconciled;return T&&I&&N&&P}),a=v=>Math.round((v+Number.EPSILON)*100)/100,l=v=>typeof v=="number"?v:typeof v=="string"&&parseFloat(v)||0,c=n.reduce((v,T)=>v+l(T.deliveryFee),0),d=l(s.commissionRate);let f=0;s.commissionType==="fixed"?f=n.length*d:f=c*(d/100);const m=a(c),x=a(f),y=a(m-x),w=s.commissionType==="fixed"?`${d} ./`:`${d}%`;return r.jsxs("div",{className:"p-4 text-white",children:[r.jsxs("div",{className:"bg-[#1F1F1F] p-5 rounded-xl shadow-lg flex flex-col space-y-4 border-t-4 border-red-500",children:[r.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[r.jsx("div",{className:"p-3 bg-gray-700 rounded-full",children:r.jsx(L5,{className:"w-6 h-6 text-red-400"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-bold text-lg text-white",children:""}),r.jsx("p",{className:"text-xs text-gray-400",children:"  ( )"})]})]}),r.jsxs("div",{className:"space-y-2 pt-3 border-t border-gray-700",children:[r.jsxs("h4",{className:"text-sm font-semibold text-gray-400 mb-2",children:["  (",n.length," ",n.length===1?"":"",")"]}),r.jsx(bw,{label:"  ()",value:m,colorClass:"text-blue-400"}),r.jsx(bw,{label:`  (${w})`,value:x,colorClass:"text-red-400"}),r.jsx(bw,{label:" ",value:y,colorClass:"text-green-400"})]}),r.jsx("div",{className:"text-center pt-4",children:r.jsx("p",{className:"text-xs text-gray-500",children:"         ."})})]}),r.jsxs("div",{className:"mt-6",children:[r.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"   "}),n.length>0?r.jsx("div",{className:"space-y-4",children:n.map(v=>{const T=t.find(N=>N.id===v.merchantId),I=(()=>{try{if(!v.deliveredAt)return"";const N=new Date(v.deliveredAt);return isNaN(N.getTime())?"":N.toLocaleString("ar-EG-u-nu-latn",{month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"})}catch{return""}})();return r.jsxs("div",{className:"bg-[#2A2A2A] p-4 rounded-lg shadow-md border border-gray-700 flex flex-col space-y-4",children:[r.jsxs("div",{className:"flex justify-between items-center pb-3 border-b border-gray-700",children:[r.jsx("span",{className:"font-mono text-sm text-gray-400",children:v.id}),r.jsxs("span",{className:"text-xl font-bold text-green-400",children:[l(v.deliveryFee).toLocaleString("en-US")," ."]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-start space-x-3 space-x-reverse",children:[r.jsx(jn,{className:"w-5 h-5 text-red-400 mt-1 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400",children:""}),r.jsx("p",{className:"font-semibold text-white",children:v.customer.address}),r.jsxs("p",{className:"text-sm text-gray-300 flex items-center mt-1",children:[r.jsx(Js,{className:"w-4 h-4 ml-2"}),r.jsx("span",{children:v.customer.phone})]})]})]}),r.jsxs("div",{className:"flex items-start space-x-3 space-x-reverse",children:[r.jsx(Qo,{className:"w-5 h-5 text-blue-400 mt-1 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-400",children:""}),r.jsx("p",{className:"font-semibold text-white",children:v.merchantName}),(T==null?void 0:T.phone)&&r.jsxs("p",{className:"text-sm text-gray-300 flex items-center mt-1",children:[r.jsx(Js,{className:"w-4 h-4 ml-2"}),r.jsx("span",{children:T.phone})]})]})]})]}),r.jsxs("div",{className:"flex items-center justify-end text-xs text-neutral-500 pt-3 border-t border-gray-700",children:[r.jsx(wt,{className:"w-4 h-4 ml-2"}),r.jsxs("span",{children:[" : ",I]})]})]},v.id)})}):r.jsx("div",{className:"bg-[#1F1F1F] p-8 rounded-lg text-center text-gray-500 border border-gray-800",children:r.jsx("p",{children:" !    ."})})]})]})},BW=({activePage:s,onNavigate:e,messageCount:t=0,theme:n})=>{const a=[{id:"home",key:"nav_home",label:"",icon:Ev},{id:"wallet",key:"nav_wallet",label:"",icon:Pc}];return r.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-[#1A1A1A] border-t border-[#333] flex justify-around items-end h-[90px] z-40 pb-6 safe-area-pb transition-all duration-300",children:a.map(l=>{var m,x;const c=l.icon,d=(x=(m=n==null?void 0:n.driver)==null?void 0:m.icons)==null?void 0:x[l.key],f=s===l.id;return r.jsxs("button",{onClick:()=>e(l.id),className:"group relative flex-1 h-full flex flex-col items-center justify-center outline-none select-none",style:{WebkitTapHighlightColor:"transparent"},children:[r.jsx("span",{className:`absolute top-0 w-10 h-1 rounded-b-full bg-red-500 transition-all duration-500 ease-out ${f?"opacity-100 shadow-[0_0_15px_rgba(239,68,68,0.8)] scale-x-100":"opacity-0 scale-x-0"}`}),r.jsxs("div",{className:`relative transition-all duration-300 ease-out p-1.5 rounded-2xl ${f?"-translate-y-1.5":"group-active:scale-90 translate-y-1"}`,children:[r.jsx("div",{className:`absolute inset-0 bg-red-500/10 blur-xl rounded-full transition-opacity duration-500 ${f?"opacity-100":"opacity-0"}`}),d?r.jsx("img",{src:d,alt:l.label,className:`w-6 h-6 object-contain z-10 relative ${f?"drop-shadow-md":"grayscale opacity-70"}`},d):r.jsx(c,{className:`w-6 h-6 transition-all duration-300 z-10 relative ${f?"text-red-500 drop-shadow-[0_2px_8px_rgba(239,68,68,0.4)]":"text-gray-500 group-hover:text-gray-300"}`})]}),r.jsx("span",{className:`text-[10px] font-bold tracking-wide transition-all duration-300 ${f?"text-white translate-y-0 opacity-100":"text-gray-500 group-hover:text-gray-400 translate-y-1"}`,children:l.label})]},l.id)})})},yw=({phone:s})=>s?r.jsxs("div",{className:"flex gap-3 mt-3 pt-3 border-t border-white/5",children:[r.jsxs("a",{href:`tel:${s}`,className:"flex-1 bg-blue-500/10 hover:bg-blue-500/20 text-blue-400 border border-blue-500/20 py-2.5 rounded-xl flex items-center justify-center gap-2 transition-all active:scale-95 clickable",children:[r.jsx(Js,{className:"w-4 h-4"}),r.jsx("span",{className:"font-bold text-sm",children:""})]}),r.jsxs("a",{href:`https://wa.me/2${s}`,target:"_blank",rel:"noopener noreferrer",className:"flex-1 bg-green-500/10 hover:bg-green-500/20 text-green-400 border border-green-500/20 py-2.5 rounded-xl flex items-center justify-center gap-2 transition-all active:scale-95 clickable",children:[r.jsx(cc,{className:"w-4 h-4"}),r.jsx("span",{className:"font-bold text-sm",children:""})]})]}):null,zW=({order:s,users:e,listType:t,driver:n,onAcceptOrder:a,onUpdateStatus:l,onBack:c,theme:d})=>{var z,k,M,B,D,S;const[f,m]=j.useState(""),[x,y]=j.useState(""),w=e.find(F=>F.id===s.merchantId),v=()=>{const F=parseFloat(f);if(isNaN(F)||F<=0){y("  ");return}y(""),a(s.id,n.id,F)},T=(()=>{try{const F=new Date(s.createdAt);if(isNaN(F.getTime()))return"";const E=F.toLocaleDateString("ar-EG",{weekday:"long"}),Y=F.toLocaleDateString("ar-EG",{day:"numeric",month:"numeric"}),X=F.toLocaleTimeString("ar-EG",{hour:"numeric",minute:"numeric"});return`${E} ${Y} - ${X}`}catch{return""}})(),I=s.type==="shopping_order"&&(!s.items||s.items.length===0);let N=s.notes||"",P="",U=null;if(I&&s.notes){const F=s.notes.split("-----------");if(N=F[0].trim(),F.length>1){P=F[1].trim();const E=P.match(/01[0125][0-9]{8}/);E&&(U=E[0])}}const V=s.finalPrice??s.totalPrice??0,q=(s.deliveryFee||0)+V,W=f!==""&&!isNaN(parseFloat(f))&&parseFloat(f)>0;return r.jsxs("div",{className:"fixed inset-0 flex flex-col bg-[#1A1A1A] text-white overflow-hidden z-[60]",children:[r.jsx("div",{className:"flex-none bg-[#1F1F1F] border-b border-white/5 shadow-sm z-10 pt-safe",children:r.jsxs("div",{className:"px-5 py-3 flex justify-between items-center",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:c,className:"p-2 -mr-2 text-gray-300 hover:text-white bg-white/5 hover:bg-white/10 rounded-full transition-colors active:scale-95 clickable",children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5 rotate-180",children:[r.jsx("path",{d:"M5 12h14"}),r.jsx("path",{d:"M12 5l7 7-7 7"})]})}),r.jsxs("div",{children:[r.jsxs("h1",{className:"text-xl font-black text-red-500 font-mono tracking-wider leading-none",children:["#",s.id]}),r.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] text-gray-400 mt-1.5",children:[r.jsx(wt,{className:"w-3 h-3 text-gray-500"}),r.jsx("span",{children:T})]})]})]}),s.type==="shopping_order"?r.jsxs("div",{className:"bg-purple-500/10 text-purple-300 px-3 py-1.5 rounded-lg text-[10px] font-bold border border-purple-500/20 flex items-center gap-1.5",children:[r.jsx(zt,{className:"w-3.5 h-3.5"}),I?" ":""]}):r.jsxs("div",{className:"bg-blue-500/10 text-blue-300 px-3 py-1.5 rounded-lg text-[10px] font-bold border border-blue-500/20 flex items-center gap-1.5",children:[r.jsx(Nn,{className:"w-3.5 h-3.5"})," "]})]})}),r.jsxs("div",{className:`flex-1 overflow-y-auto p-4 space-y-5 custom-scrollbar ${t==="in-transit"?"pb-44":"pb-10"}`,children:[r.jsx("div",{className:"bg-[#252525] rounded-2xl border border-white/5 p-4 shadow-lg relative overflow-hidden",children:r.jsxs("div",{className:"flex items-start gap-4 relative z-10",children:[r.jsx("div",{className:"w-10 h-10 rounded-full bg-[#1A1A1A] border-2 border-red-500/30 flex items-center justify-center shadow-lg text-red-400 flex-shrink-0",children:r.jsx(jn,{className:"w-5 h-5"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-[10px] text-gray-400 font-bold mb-0.5 uppercase tracking-wider",children:" ( )"}),r.jsx("h3",{className:"text-lg font-bold text-white leading-snug break-words",children:((z=s.customer)==null?void 0:z.address)||"  "}),r.jsx("p",{className:"text-sm text-gray-300 font-medium mt-1",children:((k=s.customer)==null?void 0:k.name)||""})]}),r.jsx("span",{className:"text-xs text-cyan-400 font-bold font-mono bg-black/20 px-2 py-1 rounded text-left mt-1 selectable",dir:"ltr",children:(M=s.customer)==null?void 0:M.phone})]}),r.jsx(yw,{phone:((B=s.customer)==null?void 0:B.phone)||""})]})]})}),I?r.jsxs("div",{className:"bg-[#2A2A2A] rounded-2xl border border-dashed border-purple-500/30 p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(Wn,{className:"w-4 h-4 text-purple-400"}),r.jsx("h4",{className:"text-xs font-bold text-gray-300",children:"  "})]}),r.jsx("p",{className:"text-sm text-white leading-relaxed whitespace-pre-wrap font-medium",children:N}),U&&r.jsxs("div",{className:"mt-3 pt-2 border-t border-white/5",children:[r.jsxs("p",{className:"text-[10px] text-green-400 flex items-center gap-1 mb-2",children:[r.jsx(nt,{className:"w-3 h-3"}),"    : ",r.jsx("span",{className:"font-mono text-white ml-1 text-left selectable",dir:"ltr",children:U})]}),r.jsx(yw,{phone:U})]})]}):r.jsxs("div",{className:"bg-[#252525] rounded-2xl border border-white/5 p-4 relative overflow-hidden",children:[(!s.items||s.items.length===0)&&s.notes?r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(Wn,{className:"w-4 h-4 text-purple-400"}),r.jsx("h4",{className:"text-xs font-bold text-gray-300",children:"  ( )"})]}),r.jsx("p",{className:"text-sm text-white leading-relaxed whitespace-pre-wrap font-medium bg-[#1A1A1A] p-3 rounded-xl border border-white/5",children:s.notes})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center justify-between mb-3 relative z-10",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Nn,{className:"w-4 h-4 text-yellow-500"}),r.jsx("h4",{className:"text-xs font-bold text-gray-300",children:s.items&&s.items.length>0?" ":" "})]}),r.jsxs("span",{className:"text-xs font-bold text-gray-400 bg-black/20 px-2 py-0.5 rounded",children:[((D=s.items)==null?void 0:D.length)||0," "]})]}),r.jsx("div",{className:"space-y-3 relative z-10",children:(S=s.items)==null?void 0:S.map((F,E)=>r.jsxs("div",{className:"flex justify-between items-center bg-[#1A1A1A] p-2 rounded-lg border border-white/5",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:"w-6 h-6 rounded bg-gray-700 flex items-center justify-center text-xs font-bold text-white",children:[F.quantity,"x"]}),r.jsx("span",{className:"text-sm text-gray-200",children:F.name})]}),r.jsx("span",{className:"text-sm font-mono text-gray-400",children:F.price})]},E))}),V>0&&r.jsxs("div",{className:"mt-4 pt-3 border-t border-white/5 flex justify-between items-center",children:[r.jsx("span",{className:"text-xs text-gray-400",children:" "}),r.jsxs("span",{className:"text-lg font-bold text-white",children:[V," ."]})]})]}),w&&r.jsxs("div",{className:"mt-4 pt-3 border-t border-white/5",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsxs("div",{children:[r.jsxs("span",{className:"text-xs text-purple-400 font-bold flex items-center gap-1",children:[r.jsx(Qo,{className:"w-3 h-3"})," "]}),r.jsx("span",{className:"text-sm text-white font-bold block mt-1",children:w.name})]}),w.phone&&r.jsx("span",{className:"text-xs text-purple-300 font-bold font-mono bg-black/20 px-2 py-1 rounded text-left mt-1 selectable",dir:"ltr",children:w.phone})]}),r.jsx(yw,{phone:w.phone||""})]})]}),t==="new"&&r.jsx("div",{className:"bg-[#1F1F1F] p-4 rounded-2xl border border-white/5 shadow-lg mt-2",children:r.jsxs("div",{className:"flex gap-3 items-center",children:[r.jsxs("div",{className:"flex-1 relative",children:[r.jsx("input",{type:"number",inputMode:"decimal",value:f,onChange:F=>{m(F.target.value),y("")},placeholder:"0",className:"w-full bg-[#111] border border-gray-600 rounded-xl px-4 py-3 text-white font-bold text-center text-lg outline-none focus:border-red-500 transition-colors"}),r.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 text-xs font-bold pointer-events-none",children:"."}),x&&r.jsx("div",{className:"absolute -top-8 left-0 right-0 text-red-500 text-xs text-center font-bold bg-[#1F1F1F] py-1 rounded shadow-md border border-red-500/30",children:x})]}),r.jsxs("button",{onClick:v,disabled:!W,className:`flex-[2] text-white font-bold py-3.5 rounded-xl shadow-lg transition-all flex items-center justify-center gap-2 clickable
                                    ${W?"bg-red-600 hover:bg-red-700 active:scale-95":"bg-gray-700 text-gray-400 opacity-50 cursor-not-allowed shadow-none"}`,children:[r.jsx(nt,{className:"w-5 h-5"}),"  "]})]})})]}),t==="in-transit"&&r.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-[#1F1F1F] border-t border-white/5 z-50 shadow-[0_-5px_20px_rgba(0,0,0,0.4)] transition-all duration-200",style:{paddingBottom:"calc(1rem + env(safe-area-inset-bottom))"},children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-center bg-black/20 p-3 rounded-xl border border-white/5",children:[r.jsx("span",{className:"text-xs text-gray-400",children:"  ( )"}),r.jsxs("span",{className:"text-xl font-black text-green-400",children:[q," ",r.jsx("span",{className:"text-xs font-bold text-gray-500",children:"."})]})]}),r.jsxs("button",{onClick:()=>l(s.id,ue.Delivered),className:"w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 rounded-xl shadow-lg active:scale-95 transition-all flex items-center justify-center gap-2 clickable",children:[r.jsx(nt,{className:"w-5 h-5"}),"  "]})]})})]})},Cp=({icon:s,label:e,subLabel:t,onClick:n,danger:a,active:l,disabled:c})=>r.jsxs("button",{onClick:c?void 0:n,className:`w-full flex items-center justify-between p-4 rounded-xl border border-transparent transition-all ${c?"cursor-default opacity-80":"active:scale-[0.98]"} ${a?"bg-red-900/10 hover:bg-red-900/20 text-red-500":"bg-[#252525] hover:bg-[#303030] text-white hover:border-[#333]"}`,children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:`p-2.5 rounded-full ${a?"bg-red-500/10":l?"bg-green-500/20 text-green-400":"bg-gray-800 text-gray-300"}`,children:Ar.cloneElement(s,{className:`w-5 h-5 ${a?"text-red-500":""}`})}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:`font-bold text-sm ${a?"text-red-400":"text-gray-200"}`,children:e}),t&&r.jsx("p",{className:`text-xs mt-0.5 ${l?"text-green-400":"text-gray-500"}`,children:t})]})]}),!a&&!c&&r.jsx(Gs,{className:"w-5 h-5 text-gray-600"}),c&&l&&r.jsx(nt,{className:"w-5 h-5 text-green-500"})]}),qW=({driver:s,onClose:e,onLogout:t,onUpdateUser:n,onUpdateTheme:a,currentTheme:l})=>{const[c,d]=j.useState("menu"),[f,m]=j.useState(""),[x,y]=j.useState(""),[w,v]=j.useState(!1),[T,I]=j.useState(s.storeImage||null),[N,P]=j.useState(!1),[U,V]=j.useState(null),q=j.useRef(null),W=s.dailyLogStatus==="active",z=s.dailyLogMode==="always_open",k=()=>{if(!f||f.length<6){V({text:"     6   .",type:"error"});return}if(f!==x){V({text:"   .",type:"error"});return}n(s.id,{password:f}),V({text:"    .",type:"success"}),setTimeout(()=>{d("menu"),m(""),y(""),V(null)},1500)},M=()=>{if(s.dailyLogMode==="always_open")return;const E=s.dailyLogStatus==="active"?"closed":"active",Y={dailyLogStatus:E};E==="active"&&(Y.dailyLogStartedAt=new Date),n(s.id,Y)},B=E=>{var X;const Y=(X=E.target.files)==null?void 0:X[0];if(Y){P(!0);const R=new FileReader;R.onloadend=()=>{const J=new Image;J.src=R.result,J.onload=()=>{const O=document.createElement("canvas"),K=1024,Q=K/J.width;O.width=K,O.height=J.height*Q;const L=O.getContext("2d");if(L){L.imageSmoothingEnabled=!0,L.imageSmoothingQuality="high",L.drawImage(J,0,0,O.width,O.height);const G=O.toDataURL("image/jpeg",.9);setTimeout(()=>{I(G),n(s.id,{storeImage:G}),P(!1)},800)}}},R.readAsDataURL(Y)}},D=E=>{if(E!=null&&E.startsWith("data:")||E!=null&&E.startsWith("http"))return"p-0";switch(E){case"gold":return"p-[4px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_15px_rgba(252,246,186,0.5)]";case"neon":return"p-[4px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_15px_rgba(34,211,238,0.6)]";case"royal":return"p-[4px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-xl border border-purple-500/30";case"fire":return"p-[4px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_15px_rgba(239,68,68,0.5)]";default:return"p-0"}},S=E=>{if(!E||E==="none")return null;if(E!=null&&E.startsWith("data:")||E!=null&&E.startsWith("http"))return r.jsx("div",{className:"w-8 h-8 min-w-[2rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:r.jsx("img",{src:E,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let Y=null,X="";switch(E){case"verified":Y=qi,X="text-blue-400 fill-blue-500/20";break;case"vip":Y=va,X="text-yellow-400 fill-yellow-500/20";break;case"star":Y=Rr,X="text-purple-400 fill-purple-500/20";break;case"popular":Y=zt,X="text-red-400 fill-red-500/20";break}return Y?r.jsx(Y,{className:`w-6 h-6 ml-2 ${X}`}):null},F=E=>(E==null?void 0:E.startsWith("data:"))||(E==null?void 0:E.startsWith("http"));return r.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm flex justify-center items-end sm:items-center z-50 animate-fadeIn",onClick:e,children:r.jsxs("div",{className:"bg-[#1a1a1a] w-full sm:max-w-md h-[90vh] sm:h-auto rounded-t-3xl sm:rounded-3xl border-t sm:border border-[#333] shadow-2xl flex flex-col relative overflow-hidden",onClick:E=>E.stopPropagation(),children:[r.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-[#333]",children:[c==="settings"?r.jsxs("button",{onClick:()=>d("menu"),className:"text-gray-400 hover:text-white flex items-center gap-1",children:[r.jsx(Gs,{className:"w-5 h-5 rotate-180"}),r.jsx("span",{className:"text-sm font-bold",children:""})]}):r.jsx("h3",{className:"text-xl font-bold text-white",children:" "}),r.jsx("button",{onClick:e,className:"bg-[#252525] p-2 rounded-full text-gray-400 hover:text-white hover:bg-[#333] transition-colors",children:r.jsx(rt,{className:"w-5 h-5"})})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6 scroll-smooth",children:c==="menu"?r.jsxs("div",{className:"space-y-8",children:[r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsxs("div",{className:"relative",children:[r.jsxs("div",{className:`relative w-24 h-24 flex items-center justify-center rounded-full ${F(s.specialFrame)?"":D(s.specialFrame)}`,children:[F(s.specialFrame)&&r.jsx("img",{src:s.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.7] pointer-events-none",alt:"frame"}),r.jsxs("div",{className:`${F(s.specialFrame)?"w-[85%] h-[85%]":"w-24 h-24"} bg-[#252525] rounded-full flex items-center justify-center border-4 border-[#1a1a1a] shadow-xl overflow-hidden relative group z-0`,children:[N&&r.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 z-50 backdrop-blur-sm",children:r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full opacity-75 animate-ping absolute top-0 left-0"}),r.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center relative z-10 shadow-lg shadow-blue-500/50",children:r.jsx(ur,{className:"w-4 h-4 text-white animate-bounce"})}),r.jsx("div",{className:"w-14 h-14 border-4 border-blue-400/30 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"})]})}),T?r.jsx("img",{src:T,alt:s.name,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-10 h-10 text-gray-500"})]})]}),r.jsx("button",{onClick:()=>{var E;return!N&&((E=q.current)==null?void 0:E.click())},className:"absolute bottom-0 right-0 bg-red-600 text-white p-2 rounded-full border-4 border-[#1a1a1a] shadow-lg active:scale-95 z-20",children:r.jsx(ga,{className:"w-4 h-4"})}),r.jsx("input",{ref:q,type:"file",accept:"image/*",className:"absolute opacity-0 w-0 h-0 pointer-events-none",onChange:B})]}),r.jsxs("div",{className:"flex items-center gap-2 mt-3 justify-center",children:[r.jsx("h2",{className:"text-2xl font-bold text-white",children:s.name}),S(s.specialBadge)]}),r.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[r.jsx("span",{className:"bg-orange-500/10 text-orange-400 text-xs font-bold px-3 py-1 rounded-full border border-orange-500/20",children:" "}),r.jsx("span",{className:"text-gray-500 font-mono text-xs",children:s.phone})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-xs font-bold text-gray-500 mr-2 uppercase tracking-wider",children:" "}),z?r.jsx(Cp,{icon:r.jsx(Yr,{}),label:":  ",subLabel:"    (  )",onClick:()=>{},active:!0,disabled:!0}):r.jsx(Cp,{icon:r.jsx(wt,{}),label:W?"  ( )":"  ( )",subLabel:" 12  -   ",onClick:M,active:W,danger:W})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-xs font-bold text-gray-500 mr-2 uppercase tracking-wider",children:""}),r.jsx(Cp,{icon:r.jsx(on,{}),label:"  ",onClick:()=>d("settings")}),r.jsx(Cp,{icon:r.jsx(bm,{}),label:" ",danger:!0,onClick:()=>{e(),t()}})]})]}):r.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[r.jsxs("div",{className:"text-center mb-6",children:[r.jsx("div",{className:"w-16 h-16 bg-blue-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-blue-500/20",children:r.jsx(on,{className:"w-8 h-8 text-blue-400"})}),r.jsx("h3",{className:"text-lg font-bold text-white",children:"  "})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:"  "}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:w?"text":"password",value:f,onChange:E=>m(E.target.value),className:"w-full bg-[#252525] border border-[#333] rounded-xl p-4 text-white focus:border-blue-500 outline-none",placeholder:"******"}),r.jsx("button",{onClick:()=>v(!w),className:"absolute left-4 top-4 text-gray-500 hover:text-white",children:w?r.jsx(Ui,{className:"w-5 h-5"}):r.jsx(wa,{className:"w-5 h-5"})})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:"  "}),r.jsx("input",{type:"password",value:x,onChange:E=>y(E.target.value),className:"w-full bg-[#252525] border border-[#333] rounded-xl p-4 text-white focus:border-blue-500 outline-none",placeholder:"******"})]})]}),U&&r.jsx("div",{className:`p-4 rounded-xl text-sm font-bold text-center ${U.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:U.text}),r.jsx("button",{onClick:k,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-xl shadow-lg mt-4",children:" "})]})})]})})},HW=({onClose:s,currentCount:e,maxLimit:t})=>r.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-md flex justify-center items-center z-[100] p-4 animate-fadeIn",onClick:s,children:r.jsxs("div",{className:"bg-[#1a1a1a] w-full max-w-sm rounded-3xl border border-red-500/30 shadow-2xl overflow-hidden relative flex flex-col items-center p-8 text-center",onClick:n=>n.stopPropagation(),children:[r.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-white transition-colors bg-gray-800 p-1.5 rounded-full",children:r.jsx(rt,{className:"w-5 h-5"})}),r.jsxs("div",{className:"relative w-24 h-24 mb-6 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-red-500/20 rounded-full animate-ping"}),r.jsx("div",{className:"relative bg-gradient-to-br from-red-600 to-red-800 w-20 h-20 rounded-full flex items-center justify-center shadow-lg border-2 border-red-400/50",children:r.jsx(Iv,{className:"w-10 h-10 text-white animate-pulse"})})]}),r.jsx("h2",{className:"text-2xl font-black text-white mb-2 tracking-tight",children:"   !"}),r.jsxs("p",{className:"text-gray-400 text-sm leading-relaxed mb-6",children:["        .",r.jsx("br",{})," ",r.jsx("span",{className:"text-red-400 font-bold",children:e}),"      ",r.jsx("span",{className:"text-white font-bold bg-gray-700 px-2 rounded",children:t}),"."]}),r.jsxs("div",{className:"w-full bg-gray-800 rounded-xl p-4 border border-gray-700 mb-6",children:[r.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"  "}),r.jsx("div",{className:"w-full h-2.5 bg-gray-900 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-red-500 rounded-full w-full shadow-[0_0_10px_rgba(239,68,68,0.7)] animate-pulse"})}),r.jsxs("div",{className:"flex justify-between items-center mt-2 text-xs font-mono font-bold",children:[r.jsxs("span",{className:"text-white",children:[e," / ",t]}),r.jsx("span",{className:"text-red-400",children:""})]})]}),r.jsx("button",{onClick:s,className:"w-full bg-white text-black font-bold py-3.5 rounded-xl hover:bg-gray-200 transition-transform active:scale-95 shadow-lg",children:" "})]})}),zu=s=>s?s.seconds?s.seconds*1e3:typeof s.toDate=="function"?s.toDate().getTime():s instanceof Date?s.getTime():new Date(s).getTime()||0:0,GW=s=>{var F;const[e,t]=j.useState("home"),[n,a]=j.useState("home"),[l,c]=j.useState(null),[d,f]=j.useState(!1),[m,x]=j.useState(!1),[y,w]=j.useState(!1),v=j.useRef(null),T=((F=s.appConfig)==null?void 0:F.appName)||"GOO NOW",[I,...N]=T.split(" "),P=N.join(" "),U=T;j.useEffect(()=>{var E,Y;if(((E=s.initialRoute)==null?void 0:E.target)==="order"&&s.initialRoute.id){const X=s.orders.find(R=>{var J;return R.id===((J=s.initialRoute)==null?void 0:J.id)});X&&(c(X),X.status===ue.InTransit&&a("in-transit"))}else((Y=s.initialRoute)==null?void 0:Y.target)==="messages"&&w(!0)},[s.initialRoute,s.orders]),j.useEffect(()=>{wm("driver",s.driver.id)},[s.driver.id]),j.useEffect(()=>{Is.reportContext(e)},[e]),j.useEffect(()=>{const E=Y=>{v.current&&!v.current.contains(Y.target)&&w(!1)};return document.addEventListener("mousedown",E),()=>document.removeEventListener("mousedown",E)},[]),Ht(()=>y?(w(!1),!0):d?(f(!1),!0):m?(x(!1),!0):l?(c(null),!0):e!=="home"?(t("home"),!0):n!=="home"?(a("home"),!0):!1,[d,m,l,e,n,y]);const{standardNewOrders:V,delinowNewOrders:q,inTransitOrders:W}=j.useMemo(()=>{const E=[],Y=[],X=s.driver.id;for(const R of s.orders)R.status===ue.Pending&&!R.driverId?E.push(R):R.driverId===X&&R.status===ue.InTransit&&Y.push(R);return E.sort((R,J)=>zu(R.createdAt)-zu(J.createdAt)),Y.sort((R,J)=>zu(R.createdAt)-zu(J.createdAt)),{standardNewOrders:E.filter(R=>R.type!=="shopping_order"),delinowNewOrders:E.filter(R=>R.type==="shopping_order"),inTransitOrders:Y}},[s.orders,s.driver.id]),z=j.useMemo(()=>s.messages.filter(E=>{var Y;return E.targetRole==="driver"&&(E.targetId==="all"||E.targetId===s.driver.id)&&!s.deletedMessageIds.includes(E.id)&&!((Y=E.deletedBy)!=null&&Y.includes(s.driver.id))}).sort((E,Y)=>zu(Y.createdAt)-zu(E.createdAt)),[s.messages,s.driver.id,s.deletedMessageIds]),k=j.useMemo(()=>z.filter(E=>{var Y;return!((Y=E.readBy)!=null&&Y.includes(s.driver.id))}).length,[z,s.driver.id]);j.useEffect(()=>{y&&z.forEach(E=>{var Y;(Y=E.readBy)!=null&&Y.includes(s.driver.id)||s.markMessageAsSeen(E.id)})},[y,z,s.driver.id]);const M=E=>{if(E!=null&&E.startsWith("data:")||E!=null&&E.startsWith("http"))return"p-0";switch(E){case"gold":return"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[2px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[2px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-0"}},B=E=>{if(!E||E==="none")return null;if(E!=null&&E.startsWith("data:")||E!=null&&E.startsWith("http"))return r.jsx("div",{className:"w-7 h-7 min-w-[1.75rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:r.jsx("img",{src:E,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let Y=null,X="";switch(E){case"verified":Y=qi,X="text-blue-400 fill-blue-500/20";break;case"vip":Y=va,X="text-yellow-400 fill-yellow-500/20";break;case"star":Y=Rr,X="text-purple-400 fill-purple-500/20";break;case"popular":Y=zt,X="text-red-400 fill-red-500/20";break}return Y?r.jsx(Y,{className:`w-4 h-4 ml-1 ${X}`}):null},D=E=>(E==null?void 0:E.startsWith("data:"))||(E==null?void 0:E.startsWith("http")),S=()=>{w(!1)};return r.jsxs("div",{className:"fixed inset-0 flex flex-col bg-[#1A1A1A] text-white overflow-hidden",dir:"rtl",children:[d&&r.jsx(qW,{driver:s.driver,onClose:()=>f(!1),onLogout:s.onLogout,onUpdateUser:s.onUpdateUser,currentTheme:s.appTheme,onUpdateTheme:s.onUpdateTheme}),m&&r.jsx(HW,{onClose:()=>x(!1),currentCount:W.length,maxLimit:s.driver.maxConcurrentOrders||0}),l?r.jsxs("div",{className:"fixed inset-0 bg-[#1A1A1A] z-50 flex flex-col animate-fadeIn",children:[r.jsxs("header",{className:"flex-none flex bg-[#1A1A1A] border-b border-gray-800 h-14 items-center px-4 pt-safe box-content",children:[r.jsxs("button",{onClick:()=>c(null),className:"text-white flex items-center p-2",children:[r.jsx("span",{className:"text-2xl ml-2 rotate-180",children:""}),r.jsx("span",{className:"font-bold",children:""})]}),r.jsx("div",{className:"flex-1 text-center font-bold",children:" "})]}),r.jsx(zW,{order:l,users:s.users,listType:l.status===ue.InTransit?"in-transit":"new",driver:s.driver,onAcceptOrder:(E,Y,X)=>{s.onAcceptOrder(E,Y,X),c(null)},onUpdateStatus:(E,Y)=>{s.onUpdateOrderStatus(E,Y),c(null)},onBack:()=>c(null),theme:s.appTheme})]}):r.jsxs(r.Fragment,{children:[r.jsxs("header",{className:"flex-none bg-[#1A1A1A] z-30 border-b border-gray-800 h-14 flex justify-between items-center px-4 pt-safe box-content relative",children:[r.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 bg-white/5 py-1 px-3 rounded-full hover:bg-white/10 transition-colors",children:[r.jsxs("div",{className:`relative flex items-center justify-center rounded-full ${D(s.driver.specialFrame)?"":M(s.driver.specialFrame)}`,children:[D(s.driver.specialFrame)&&r.jsx("img",{src:s.driver.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-125 pointer-events-none",alt:"frame"}),r.jsx("div",{className:`${D(s.driver.specialFrame),"w-8 h-8"} rounded-full overflow-hidden border border-white/20 relative z-0 flex items-center justify-center`,children:s.driver.storeImage?r.jsx("img",{src:s.driver.storeImage,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-5 h-5 m-1.5"})})]}),r.jsx("span",{className:"text-sm font-bold truncate max-w-[80px]",children:s.driver.name}),B(s.driver.specialBadge)]}),r.jsxs("h1",{className:"text-xl font-bold",children:[r.jsx("span",{className:"text-red-500",children:I}),r.jsx("span",{className:"text-white ml-1",children:P})]}),r.jsxs("div",{className:"relative",ref:v,children:[r.jsxs("button",{onClick:()=>w(!y),className:`relative p-2 transition-colors ${y?"text-red-500":"text-gray-400 hover:text-white"}`,children:[r.jsx(an,{className:"w-6 h-6"}),k>0&&r.jsx("span",{className:"absolute top-1 right-1 w-2.5 h-2.5 bg-red-600 rounded-full animate-pulse border border-[#1A1A1A]"})]}),y&&r.jsxs("div",{className:"absolute top-12 left-0 w-80 bg-[#1e1e1e] border border-gray-700/50 rounded-2xl shadow-2xl overflow-hidden z-50 animate-pop-in origin-top-left",children:[r.jsxs("div",{className:"p-3 border-b border-gray-700/50 bg-[#252525] flex justify-between items-center",children:[r.jsx("span",{className:"text-xs font-bold text-white",children:""}),z.length>0&&r.jsx("button",{onClick:S,className:"text-[10px] text-gray-400 hover:text-white transition-colors",children:""})]}),r.jsx("div",{className:"max-h-80 overflow-y-auto custom-scrollbar p-2 space-y-2",children:z.length===0?r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(an,{className:"w-8 h-8 mx-auto mb-2 opacity-20"}),r.jsx("p",{className:"text-[10px]",children:"   "})]}):z.map(E=>{const Y=(()=>{try{const X=new Date(E.createdAt);return isNaN(X.getTime())?"":X.toLocaleString("ar-EG",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"})}catch{return""}})();return r.jsxs("div",{className:"group relative bg-[#252525] rounded-xl border border-gray-700/50 shadow-sm overflow-hidden p-3 transition-all hover:bg-[#2a2a2a]",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-red-900/20 flex items-center justify-center text-red-500",children:r.jsx(an,{className:"w-4 h-4"})}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-xs font-bold text-white leading-tight",children:" "}),r.jsx("span",{className:"text-[9px] text-gray-500 font-mono",children:Y})]})]}),r.jsx("button",{onClick:X=>{X.stopPropagation(),s.hideMessage(E.id)},className:"text-gray-600 hover:text-red-400 transition-colors p-1",children:r.jsx(Pt,{className:"w-3.5 h-3.5"})})]}),r.jsxs("div",{children:[E.image&&r.jsx("div",{className:"mb-2 rounded-lg overflow-hidden border border-gray-600/30",children:r.jsx("img",{src:E.image,alt:"",className:"w-full h-32 object-contain bg-black/40"})}),r.jsx("p",{className:"text-gray-300 text-xs leading-relaxed font-medium",children:E.text})]}),r.jsxs("div",{className:"mt-2 flex items-center gap-1 text-[9px] text-gray-500",children:[r.jsx(nt,{className:"w-2.5 h-2.5 text-green-500"}),r.jsx("span",{children:" "})]})]},E.id)})})]})]})]}),e==="home"&&r.jsx("div",{className:"flex-none px-3 py-2",children:r.jsxs("div",{className:"flex bg-[#2A2A2A] rounded-xl p-1 border border-gray-700",children:[r.jsxs("button",{onClick:()=>a("home"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${n==="home"?"bg-red-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[" (",V.length,")"]}),r.jsxs("button",{onClick:()=>a("in-transit"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${n==="in-transit"?"bg-red-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[" (",W.length,")"]}),r.jsxs("button",{onClick:()=>a("delinow"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${n==="delinow"?"bg-red-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[U," (",q.length,")"]})]})}),r.jsxs("main",{className:"flex-1 overflow-y-auto pb-28 scroll-smooth",children:[e==="home"&&r.jsx(FW,{driver:s.driver,users:s.users,standardNewOrders:V,delinowNewOrders:q,inTransitOrders:W,onViewOrder:c,onUpdateUser:s.onUpdateUser,activeTab:n,theme:s.appTheme}),e==="wallet"&&r.jsx($W,{driver:s.driver,orders:s.orders,users:s.users})]}),r.jsx(BW,{activePage:e,onNavigate:E=>t(E),messageCount:k,theme:s.appTheme})]})]})},Rp=({title:s,description:e,icon:t,colors:n,onClick:a,delay:l=0})=>r.jsxs("button",{onClick:a,className:"relative w-full h-32 sm:h-36 mt-4 group animate-fade-slide-up select-none",style:{animationDelay:`${l}ms`},children:[r.jsx("div",{className:"absolute -top-5 left-1/2 -translate-x-1/2 z-20",children:r.jsx("div",{className:"w-10 h-10 rounded-full p-1 bg-[#252525] shadow-lg group-hover:-translate-y-1 transition-transform duration-300",children:r.jsx("div",{className:`w-full h-full rounded-full flex items-center justify-center ${n.iconBg} border border-white/5`,children:t})})}),r.jsxs("div",{className:"relative w-full h-full transition-all duration-300 active:scale-95 rounded-[1.2rem]",children:[r.jsx("div",{className:"absolute -inset-[1px] rounded-[1.25rem] overflow-hidden z-0",children:r.jsx("div",{className:"absolute top-[-50%] left-[-50%] w-[200%] h-[200%] animate-[spin_3s_linear_infinite] bg-[conic-gradient(transparent,transparent,#ff0000,#ff8000,#ffff00,#00ff00,#00ffff,#0000ff,#ff00ff,#ff0000)] opacity-100"})}),r.jsxs("div",{className:"relative w-full h-full bg-[#252525] rounded-[1.2rem] p-3 pt-8 flex flex-col items-center text-center overflow-hidden z-10 shadow-md group-hover:shadow-xl",children:[r.jsx("div",{className:`absolute top-0 left-0 right-0 h-12 bg-gradient-to-b ${n.accent} to-transparent opacity-10 group-hover:opacity-20 transition-opacity`}),r.jsxs("div",{className:"relative z-10 w-full mt-1",children:[r.jsx("h3",{className:`text-xs font-bold ${n.text} mb-1 leading-tight group-hover:text-white transition-colors`,children:s}),r.jsx("p",{className:"text-[9px] text-gray-500 font-medium line-clamp-2 leading-relaxed px-1",children:e})]}),r.jsx("div",{className:`absolute bottom-0 left-1/2 -translate-x-1/2 w-0 h-0.5 ${n.text.replace("text-","bg-")} transition-all duration-500 group-hover:w-1/2 opacity-50`})]})]})]}),WW=s=>{if(s!=null&&s.startsWith("data:")||s!=null&&s.startsWith("http"))return"p-0";switch(s){case"gold":return"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.5)]";case"neon":return"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.6)]";case"royal":return"p-[4px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-xl border border-purple-500/30";case"fire":return"p-[4px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_15px_rgba(239,68,68,0.5)]";default:return"p-0"}},ww=s=>(s==null?void 0:s.startsWith("data:"))||(s==null?void 0:s.startsWith("http")),KW=({user:s,onNavigate:e,sliderImages:t=[],sliderConfig:n,adminUser:a,merchants:l=[],messageCount:c=0,onOpenMessages:d,onOpenSupport:f,unreadSupportCount:m=0})=>{const[x,y]=j.useState(0),[w,v]=j.useState(""),[T,I]=j.useState(0),N=j.useRef(null),[P,U]=j.useState(!1),V=j.useRef(null);Ht(()=>P?(U(!1),!0):!1,[P]),j.useEffect(()=>{const D=S=>{V.current&&!V.current.contains(S.target)&&U(!1)};return document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[]),j.useEffect(()=>{const D=N.current;if(!D)return;const S=()=>{const F=D.scrollTop,E=Math.min(F/80,.95);I(E)};return D.addEventListener("scroll",S,{passive:!0}),()=>D.removeEventListener("scroll",S)},[]);const q=(n==null?void 0:n.isEnabled)!==!1,W=j.useMemo(()=>!t||!Array.isArray(t)?[]:t.filter(D=>D&&D.url&&D.active!==!1),[t]);j.useEffect(()=>{const D=new Date().getHours();D<12?v(" "):D<18?v(" "):v(" ")},[]),j.useEffect(()=>{y(0)},[W.length]),j.useEffect(()=>{if(q&&W.length>1){const D=setInterval(()=>{y(S=>(S+1)%W.length)},4e3);return()=>clearInterval(D)}},[W.length,q]);const z=D=>{if(!D||D==="none")return null;if(D!=null&&D.startsWith("data:")||D!=null&&D.startsWith("http"))return r.jsx("div",{className:"w-6 h-6 min-w-[1.5rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-1 backdrop-blur-sm",children:r.jsx("img",{src:D,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let S=null,F="";switch(D){case"verified":S=qi,F="text-blue-400 fill-blue-500/20";break;case"vip":S=va,F="text-yellow-400 fill-yellow-500/20";break;case"star":S=Rr,F="text-purple-400 fill-purple-500/20";break;case"popular":S=zt,F="text-red-400 fill-red-500/20";break}return S?r.jsx(S,{className:`w-4 h-4 ml-1 ${F}`}):null},k=(m||0)+(c||0),M=D=>{U(!1),D==="support"?f&&f():d&&d()},B=()=>{U(!1),d&&d()};return r.jsxs("div",{className:"h-full bg-[#1A1A1A] text-white flex flex-col font-sans overflow-hidden",children:[r.jsx("div",{className:"px-5 pt-safe pb-3 absolute top-0 left-0 right-0 z-50 transition-colors duration-200 box-content will-change-transform",style:{backgroundColor:`rgba(26, 26, 26, ${T})`,backdropFilter:`blur(${T*12}px)`,borderBottom:`1px solid rgba(255,255,255,${T*.05})`,boxShadow:`0 4px 20px rgba(0,0,0,${T*.1})`},children:r.jsxs("div",{className:"flex justify-between items-center mt-1",children:[r.jsxs("button",{onClick:()=>e("profile"),className:"bg-white/10 backdrop-blur-md border border-white/10 rounded-full pr-1 pl-4 py-1 flex items-center gap-3 shadow-lg active:scale-95 transition-all",children:[r.jsx("div",{className:"relative",children:r.jsxs("div",{className:`w-9 h-9 rounded-full relative flex items-center justify-center ${ww(s.specialFrame)?"":WW(s.specialFrame)}`,children:[ww(s.specialFrame)&&r.jsx("img",{src:s.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.7] pointer-events-none",alt:"frame"}),r.jsx("div",{className:`${ww(s.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-[#1A1A1A] overflow-hidden relative z-0 flex items-center justify-center`,children:s.storeImage?r.jsx("img",{src:s.storeImage,alt:"User",className:"w-full h-full object-cover rounded-full"}):r.jsx("div",{className:"w-full h-full bg-[#252525] flex items-center justify-center",children:r.jsx(pt,{className:"w-4 h-4 text-gray-400"})})})]})}),r.jsxs("div",{className:"flex flex-col items-start animate-fade-slide-up",children:[r.jsxs("span",{className:"text-gray-300 text-[9px] font-medium mb-0.5 flex items-center gap-1 opacity-90",children:[w,"",r.jsx("span",{className:"text-yellow-500 animate-pulse",children:""})]}),r.jsxs("h1",{className:"text-xs font-black text-white tracking-wide leading-none flex items-center gap-1",children:[s.name.split(" ")[0],z(s.specialBadge)]})]})]}),r.jsxs("div",{className:"relative pointer-events-auto",ref:V,children:[r.jsxs("button",{onClick:()=>U(!P),className:`relative w-10 h-10 bg-white/5 hover:bg-white/10 backdrop-blur-md rounded-full flex items-center justify-center border border-white/10 transition-all active:scale-90 shadow-sm ${k>0?"animate-swing":""}`,children:[r.jsx(an,{className:`w-5 h-5 ${k>0?"text-white":"text-gray-300"}`}),k>0&&r.jsx("span",{className:"absolute top-2 right-2 w-2.5 h-2.5 bg-red-600 rounded-full border-2 border-[#1A1A1A] animate-pulse"})]}),P&&r.jsxs("div",{className:"absolute top-12 left-0 w-64 bg-[#1e1e1e] border border-gray-700/50 rounded-2xl shadow-2xl overflow-hidden z-50 animate-pop-in origin-top-left",children:[r.jsxs("div",{className:"p-3 border-b border-gray-700/50 bg-[#252525] flex justify-between items-center",children:[r.jsx("span",{className:"text-xs font-bold text-white",children:""}),k>0&&r.jsx("button",{onClick:B,className:"text-[10px] text-gray-400 hover:text-white transition-colors",children:" "})]}),r.jsx("div",{className:"max-h-60 overflow-y-auto custom-scrollbar p-2 space-y-2",children:k===0?r.jsxs("div",{className:"text-center py-6 text-gray-500",children:[r.jsx(an,{className:"w-8 h-8 mx-auto mb-2 opacity-20"}),r.jsx("p",{className:"text-[10px]",children:"   "})]}):r.jsxs(r.Fragment,{children:[m!==void 0&&m>0&&r.jsxs("button",{onClick:()=>M("support"),className:"w-full flex items-center gap-3 p-2 rounded-xl hover:bg-white/5 transition-colors group text-right",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center text-green-400 shrink-0 border border-green-500/30",children:r.jsx(Dr,{className:"w-4 h-4"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-xs font-bold text-white mb-0.5",children:"   "}),r.jsxs("p",{className:"text-[10px] text-gray-400 truncate",children:[" ",m,"   "]})]}),r.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})]}),c!==void 0&&c>0&&r.jsxs("button",{onClick:()=>M("message"),className:"w-full flex items-center gap-3 p-2 rounded-xl hover:bg-white/5 transition-colors group text-right",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400 shrink-0 border border-blue-500/30",children:r.jsx(kr,{className:"w-4 h-4"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-xs font-bold text-white mb-0.5",children:" "}),r.jsxs("p",{className:"text-[10px] text-gray-400 truncate",children:[" ",c,"    "]})]}),r.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]})]})})]})]})]})}),r.jsxs("div",{ref:N,className:"flex-1 overflow-y-auto pb-20 space-y-4 relative z-0 pt-24",onScroll:D=>{const S=D.currentTarget,F=Math.min(S.scrollTop/80,.95);I(F)},children:[q&&W.length>0&&r.jsx("div",{className:"px-4 mt-3 w-full relative z-10 h-40 sm:h-44",children:r.jsxs("div",{className:"relative w-full h-full rounded-[1.5rem] overflow-hidden shadow-2xl border border-white/5 bg-gray-800",children:[W.map((D,S)=>{const F=D.linkedMerchantId?D.linkedMerchantId===(a==null?void 0:a.id)?a:l.find(E=>E.id===D.linkedMerchantId):null;return r.jsxs("div",{onClick:()=>{D.linkedMerchantId&&e("store-list")},className:`absolute inset-0 w-full h-full transition-opacity duration-700 ease-in-out cursor-pointer ${S===x?"opacity-100 z-10":"opacity-0 z-0"}`,children:[r.jsx("img",{src:D.url,className:"w-full h-full object-cover block",alt:"Offer"}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent pointer-events-none"}),F&&r.jsx("div",{className:"absolute bottom-3 right-3 z-20 flex items-center justify-between pointer-events-none",children:r.jsxs("div",{className:"flex items-center gap-2 bg-black/40 backdrop-blur-md border border-white/10 pr-1 pl-3 py-1 rounded-full animate-fade-slide-up",children:[r.jsx("div",{className:"w-7 h-7 rounded-full border border-white/50 overflow-hidden bg-gray-800",children:F.storeImage?r.jsx("img",{src:F.storeImage,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-full h-full p-1 text-gray-400"})}),r.jsx("span",{className:"text-[10px] font-bold text-white max-w-[100px] truncate",children:F.id===(a==null?void 0:a.id)?"DELI NOW":F.name})]})}),D.textOverlay&&r.jsx("div",{className:"absolute bottom-3 left-3 max-w-[50%] z-20 flex flex-col items-start animate-fade-slide-up",children:r.jsx("div",{className:"bg-black/30 backdrop-blur-md border border-white/10 px-3 py-2 rounded-xl shadow-lg",children:r.jsx("p",{className:"text-white font-bold text-xs leading-relaxed drop-shadow-md",children:D.textOverlay})})})]},D.id)}),W.length>1&&r.jsx("div",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 flex gap-1 z-20 pointer-events-none",children:W.map((D,S)=>r.jsx("div",{className:`h-1 rounded-full transition-all duration-300 ${S===x?"bg-white w-4":"bg-white/30 w-1"}`},S))})]})}),r.jsxs("div",{className:"px-4 pb-4 relative z-10",children:[r.jsxs("h2",{className:"text-sm font-bold text-white mb-2 flex items-center gap-2",children:[r.jsx("span",{className:"w-1 h-4 bg-red-600 rounded-full"})," "]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(Rp,{title:"  ",description:"   ",icon:r.jsx(zt,{className:"w-5 h-5 text-purple-300"}),colors:{bg:"bg-[#252525]",border:"border-purple-500/20",text:"text-purple-400",iconBg:"bg-purple-500/10",accent:"from-purple-900"},onClick:()=>e("special-request"),delay:100}),r.jsx(Rp,{title:" ",description:"   ",icon:r.jsx(Nn,{className:"w-5 h-5 text-orange-300"}),colors:{bg:"bg-[#252525]",border:"border-orange-500/20",text:"text-orange-400",iconBg:"bg-orange-500/10",accent:"from-orange-900"},onClick:()=>e("store-list"),delay:200}),r.jsx(Rp,{title:"",description:" -  ",icon:r.jsx(ED,{className:"w-5 h-5 text-blue-300"}),colors:{bg:"bg-[#252525]",border:"border-blue-500/20",text:"text-blue-400",iconBg:"bg-blue-500/10",accent:"from-blue-900"},onClick:()=>e("ride"),delay:300}),r.jsx(Rp,{title:" ",description:" -  ",icon:r.jsx(Bt,{className:"w-5 h-5 text-green-300"}),colors:{bg:"bg-[#252525]",border:"border-green-500/20",text:"text-green-400",iconBg:"bg-green-500/10",accent:"from-green-900"},onClick:()=>e("transport"),delay:400})]})]})]})]})},qo={All:({className:s})=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),Restaurant:({className:s})=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[r.jsx("path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"}),r.jsx("path",{d:"M7 2v20"}),r.jsx("path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"})]}),Market:({className:s})=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),Pharmacy:({className:s})=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[r.jsx("path",{d:"M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8z"}),r.jsx("path",{d:"M12 7v10"}),r.jsx("path",{d:"M7 12h10"})]})},QW=[{id:"all",key:"cat_all",label:"",Icon:qo.All},{id:"restaurant",key:"cat_restaurant",label:"",Icon:qo.Restaurant},{id:"market",key:"cat_market",label:"",Icon:qo.Market},{id:"pharmacy",key:"cat_pharmacy",label:"",Icon:qo.Pharmacy}],YW=s=>{if(!s.workingHours||!s.workingHours.start||!s.workingHours.end)return!0;const e=new Date,t=e.getHours()*60+e.getMinutes(),[n,a]=s.workingHours.start.split(":").map(Number),[l,c]=s.workingHours.end.split(":").map(Number);if(isNaN(n)||isNaN(l))return!0;const d=n*60+(a||0),f=l*60+(c||0);return f<d?t>=d||t<f:t>=d&&t<f},Dp=()=>r.jsxs("div",{className:"bg-[#252525] rounded-[1.5rem] p-3 flex flex-col items-center border border-white/5 animate-pulse h-36",children:[r.jsx("div",{className:"-mt-6 mb-2",children:r.jsx("div",{className:"w-14 h-14 rounded-full bg-gray-700 border-2 border-[#1A1A1A]"})}),r.jsx("div",{className:"h-3 w-20 bg-gray-700 rounded-full mb-2"}),r.jsx("div",{className:"h-2 w-10 bg-gray-700 rounded-full mb-3"})]}),JW=({merchant:s,onClick:e,theme:t})=>{const n=YW(s),a=(l,c,d)=>{var m,x;const f=(x=(m=t==null?void 0:t.customer)==null?void 0:m.icons)==null?void 0:x[l];return f?r.jsx("img",{src:f,className:`${d} object-contain`,alt:l}):r.jsx(c,{className:d})};return r.jsxs("button",{onClick:e,className:`group relative bg-[#252525] rounded-[1.2rem] p-3 pt-7 flex flex-col items-center text-center transition-all duration-300 hover:-translate-y-1 active:scale-95 shadow-md border ${n?"border-white/5 hover:border-white/10":"border-red-900/20 opacity-80"} overflow-visible h-full`,children:[r.jsx("div",{className:"absolute -top-5",children:r.jsx("div",{className:`w-14 h-14 rounded-full p-0.5 bg-[#252525] shadow-lg ${n?"":"grayscale"}`,children:r.jsxs("div",{className:"w-full h-full rounded-full overflow-hidden border-2 border-[#1A1A1A] relative",children:[s.storeImage?r.jsx("img",{src:s.storeImage,alt:s.name,className:"w-full h-full object-cover transition-transform duration-700 group-hover:rotate-6 group-hover:scale-110"}):r.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-800 text-gray-500",children:r.jsx(Xr,{className:"w-5 h-5"})}),!n&&r.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:r.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"})})]})})}),r.jsx("h3",{className:"text-white font-bold text-xs mb-0.5 leading-tight line-clamp-1 w-full mt-2",children:s.name}),r.jsx("p",{className:"text-gray-500 text-[9px] mb-2 font-medium",children:s.storeCategory||""}),r.jsxs("div",{className:"flex items-center justify-center gap-1.5 w-full mt-auto",children:[r.jsxs("div",{className:"flex items-center gap-0.5 bg-[#1A1A1A] px-1.5 py-0.5 rounded border border-white/5",children:[r.jsx(wt,{className:"w-2.5 h-2.5 text-blue-400"}),r.jsxs("span",{className:"text-gray-300 text-[8px] font-bold",children:[s.responseTime||"30"," "]})]}),r.jsxs("div",{className:"flex items-center gap-0.5 bg-[#1A1A1A] px-1.5 py-0.5 rounded border border-white/5",children:[a("ic_star",Rr,"w-2.5 h-2.5 text-yellow-500 fill-current"),r.jsx("span",{className:"text-gray-300 text-[8px] font-bold",children:"4.8"})]})]}),s.hasFreeDelivery&&r.jsx("div",{className:"absolute top-2 right-2",children:r.jsx(Bt,{className:"w-2.5 h-2.5 text-green-500"})})]})},XW=({user:s,merchants:e,onSelectMerchant:t,sliderImages:n=[],sliderConfig:a,onSpecialRequest:l,onOpenFavorites:c,adminUser:d,theme:f,messageCount:m=0,onOpenMessages:x,onOpenSupport:y,unreadSupportCount:w=0})=>{var je;const[v,T]=j.useState("all"),[I,N]=j.useState(""),[P,U]=j.useState(0),[V,q]=j.useState(""),[W,z]=j.useState(!0),[k,M]=j.useState(0),B=j.useRef(null),[D,S]=j.useState(!1),F=j.useRef(null);Ht(()=>D?(S(!1),!0):!1,[D]),j.useEffect(()=>{const se=_e=>{F.current&&!F.current.contains(_e.target)&&S(!1)};return document.addEventListener("mousedown",se),()=>document.removeEventListener("mousedown",se)},[]),j.useEffect(()=>{const se=B.current;if(!se)return;const _e=()=>{const Te=se.scrollTop,be=Math.min(Te/80,.95);M(be)};return se.addEventListener("scroll",_e,{passive:!0}),()=>se.removeEventListener("scroll",_e)},[]),j.useEffect(()=>{const se=s.name?s.name.split(" ")[0]:" ";q(` ${se}`);const _e=setTimeout(()=>z(!1),800);return()=>clearTimeout(_e)},[s.name]);const E=(a==null?void 0:a.isEnabled)!==!1,Y=j.useMemo(()=>!n||!Array.isArray(n)?[]:n.filter(se=>se&&se.url&&se.active!==!1&&String(se.active)!=="false"),[n]),X=j.useMemo(()=>{var se;return(se=f==null?void 0:f.customer)!=null&&se.categories&&f.customer.categories.length>0?[...f.customer.categories].sort((Te,be)=>Te.sortOrder-be.sortOrder).filter(Te=>Te.isVisible).map(Te=>{let be=qo.All;return Te.key==="cat_restaurant"?be=qo.Restaurant:Te.key==="cat_market"?be=qo.Market:Te.key==="cat_pharmacy"&&(be=qo.Pharmacy),{id:Te.id,label:Te.label,Icon:be,customIcon:Te.icon}}):QW},[(je=f==null?void 0:f.customer)==null?void 0:je.categories]);j.useEffect(()=>{X.length>0&&!X.find(se=>se.id===v)&&T(X[0].id)},[X,v]),j.useEffect(()=>{U(0)},[Y.length]),j.useEffect(()=>{if(E&&Y.length>1){const se=setInterval(()=>{U(_e=>(_e+1)%Y.length)},4e3);return()=>clearInterval(se)}},[Y.length,E]);const R=e.filter(se=>{const _e=se.name.toLowerCase().includes(I.toLowerCase());let Te=!0;if(v!=="all"){const be=X.find(ye=>ye.id===v);be&&(Te=se.storeCategory===be.label||se.storeCategory===be.id,!Te&&be.id==="restaurant"&&se.storeCategory===""&&(Te=!0),!Te&&be.id==="market"&&se.storeCategory===" "&&(Te=!0),!Te&&be.id==="pharmacy"&&se.storeCategory===""&&(Te=!0))}return _e&&Te}),J=se=>{if(se.linkedMerchantId){const _e=e.find(Te=>Te.id===se.linkedMerchantId);_e&&t(_e,se.linkedCategoryId)}},O=(se,_e,Te)=>{var ye,et;const be=(et=(ye=f==null?void 0:f.customer)==null?void 0:ye.icons)==null?void 0:et[se];return be?r.jsx("img",{src:be,className:`${Te} object-contain`,alt:se}):r.jsx(_e,{className:Te})},K=se=>{if(se!=null&&se.startsWith("data:")||se!=null&&se.startsWith("http"))return"p-0";switch(se){case"gold":return"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[2px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[2px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-[2px] bg-gradient-to-tr from-red-500 to-orange-500"}},Q=se=>{if(!se||se==="none")return null;if(se!=null&&se.startsWith("data:")||se!=null&&se.startsWith("http"))return r.jsx("div",{className:"w-6 h-6 min-w-[1.5rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-1 backdrop-blur-sm",children:r.jsx("img",{src:se,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let _e=null,Te="";switch(se){case"verified":_e=qi,Te="text-blue-400 fill-blue-500/20";break;case"vip":_e=va,Te="text-yellow-400 fill-yellow-500/20";break;case"star":_e=Rr,Te="text-purple-400 fill-purple-500/20";break;case"popular":_e=zt,Te="text-red-400 fill-red-500/20";break}return _e?r.jsx(_e,{className:`w-4 h-4 ml-1 ${Te}`}):null},L=se=>(se==null?void 0:se.startsWith("data:"))||(se==null?void 0:se.startsWith("http")),G=(w||0)+(m||0),ee=se=>{S(!1),se==="support"?y&&y():x&&x()},ne=()=>{S(!1),x&&x()};return r.jsxs("div",{className:"h-[100dvh] flex flex-col relative overflow-hidden bg-[#1A1A1A] text-white font-sans",children:[r.jsx("div",{className:"absolute top-0 right-0 w-[200px] h-[200px] bg-red-500/5 rounded-full blur-[80px] -translate-y-1/2 translate-x-1/2 pointer-events-none"}),r.jsxs("div",{className:"px-5 pt-safe pb-3 absolute top-0 left-0 right-0 z-50 transition-colors duration-200 box-content will-change-transform",style:{backgroundColor:`rgba(26, 26, 26, ${k})`,backdropFilter:`blur(${k*12}px)`,borderBottom:`1px solid rgba(255,255,255,${k*.05})`,boxShadow:`0 4px 20px rgba(0,0,0,${k*.1})`},children:[r.jsxs("div",{className:"flex justify-between items-center mb-3 mt-1",children:[r.jsx("div",{className:"flex items-center",children:r.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/10 rounded-full pr-1 pl-4 py-1 flex items-center gap-3 shadow-lg",children:[r.jsx("div",{className:"relative",children:r.jsxs("div",{className:`w-9 h-9 rounded-full relative flex items-center justify-center ${L(s.specialFrame)?"":K(s.specialFrame)}`,children:[L(s.specialFrame)&&r.jsx("img",{src:s.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-125 pointer-events-none",alt:"frame"}),r.jsx("div",{className:`${L(s.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-[#1A1A1A] overflow-hidden relative z-0 flex items-center justify-center`,children:s.storeImage?r.jsx("img",{src:s.storeImage,alt:"User",className:"w-full h-full object-cover rounded-full"}):r.jsx("div",{className:"w-full h-full bg-[#252525] flex items-center justify-center",children:r.jsx(pt,{className:"w-4 h-4 text-gray-400"})})})]})}),r.jsxs("div",{className:"flex flex-col items-start animate-fade-slide-up",children:[r.jsxs("span",{className:"text-gray-300 text-[9px] font-medium mb-0.5 flex items-center gap-1 opacity-90",children:[V,"",r.jsx("span",{className:"text-yellow-500 animate-pulse",children:""})]}),r.jsxs("h1",{className:"text-xs font-black text-white tracking-wide leading-none flex items-center gap-1",children:[s.name.split(" ")[0],Q(s.specialBadge)]})]})]})}),r.jsxs("div",{className:"relative",ref:F,children:[r.jsxs("button",{onClick:()=>S(!D),className:`relative w-10 h-10 bg-white/5 hover:bg-white/10 backdrop-blur-md rounded-full flex items-center justify-center border border-white/10 transition-all active:scale-90 shadow-sm ${G>0?"animate-swing":""}`,children:[r.jsx(an,{className:`w-5 h-5 ${G>0?"text-white":"text-gray-300"}`}),G>0&&r.jsx("span",{className:"absolute top-2 right-2 w-2.5 h-2.5 bg-red-600 rounded-full border-2 border-[#1A1A1A] animate-pulse"})]}),D&&r.jsxs("div",{className:"absolute top-12 left-0 w-64 bg-[#1e1e1e] border border-gray-700/50 rounded-2xl shadow-2xl overflow-hidden z-50 animate-pop-in origin-top-left",children:[r.jsxs("div",{className:"p-3 border-b border-gray-700/50 bg-[#252525] flex justify-between items-center",children:[r.jsx("span",{className:"text-xs font-bold text-white",children:""}),G>0&&r.jsx("button",{onClick:ne,className:"text-[10px] text-gray-400 hover:text-white transition-colors",children:" "})]}),r.jsx("div",{className:"max-h-60 overflow-y-auto custom-scrollbar p-2 space-y-2",children:G===0?r.jsxs("div",{className:"text-center py-6 text-gray-500",children:[r.jsx(an,{className:"w-8 h-8 mx-auto mb-2 opacity-20"}),r.jsx("p",{className:"text-[10px]",children:"   "})]}):r.jsxs(r.Fragment,{children:[w>0&&r.jsxs("button",{onClick:()=>ee("support"),className:"w-full flex items-center gap-3 p-2 rounded-xl hover:bg-white/5 transition-colors group text-right",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center text-green-400 shrink-0 border border-green-500/30",children:r.jsx(Dr,{className:"w-4 h-4"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-xs font-bold text-white mb-0.5",children:"   "}),r.jsxs("p",{className:"text-[10px] text-gray-400 truncate",children:[" ",w,"   "]})]}),r.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})]}),m!==void 0&&m>0&&r.jsxs("button",{onClick:()=>ee("message"),className:"w-full flex items-center gap-3 p-2 rounded-xl hover:bg-white/5 transition-colors group text-right",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400 shrink-0 border border-blue-500/30",children:r.jsx(kr,{className:"w-4 h-4"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-xs font-bold text-white mb-0.5",children:" "}),r.jsxs("p",{className:"text-[10px] text-gray-400 truncate",children:[" ",m,"    "]})]}),r.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]})]})})]})]})]}),r.jsxs("div",{className:"relative mb-1",children:[r.jsx("div",{className:"absolute inset-y-0 right-3.5 flex items-center pointer-events-none",children:O("ic_search",Kn,"w-3.5 h-3.5 text-gray-500")}),r.jsx("input",{type:"text",className:"w-full bg-[#252525] text-white text-xs rounded-xl py-2.5 pr-9 pl-4 outline-none focus:ring-1 focus:ring-red-500/30 transition-all placeholder-gray-500 border border-white/5 shadow-inner",placeholder:"   ...",value:I,onChange:se=>N(se.target.value)})]})]}),r.jsx("div",{ref:B,className:"flex-1 overflow-y-auto pb-28 pt-28 scroll-smooth overscroll-none relative",onScroll:se=>{const _e=se.currentTarget,Te=Math.min(_e.scrollTop/80,.95);M(Te)},children:r.jsxs("div",{className:"space-y-4 pt-safe",children:[E&&Y.length>0&&r.jsx("div",{className:"px-5 relative z-10 h-36 sm:h-40",children:r.jsxs("div",{className:"relative w-full h-full rounded-2xl overflow-hidden shadow-lg group cursor-pointer border border-white/5 bg-gray-800",children:[Y.map((se,_e)=>{const Te=se.linkedMerchantId?se.linkedMerchantId===(d==null?void 0:d.id)?d:e.find(ye=>ye.id===se.linkedMerchantId):null,be=_e===P;return r.jsxs("div",{onClick:()=>J(se),className:`absolute inset-0 w-full h-full transition-opacity duration-1000 ease-in-out cursor-pointer ${be?"opacity-100 z-10":"opacity-0 z-0"}`,children:[r.jsx("img",{src:se.url,className:`w-full h-full object-cover block transition-transform duration-[10000ms] ease-linear ${be?"scale-110":"scale-100"}`,alt:"Banner"}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black/60 via-transparent to-transparent pointer-events-none"}),Te&&r.jsx("div",{className:"absolute bottom-3 right-3 z-20 flex items-center justify-between pointer-events-none",children:r.jsxs("div",{className:"flex items-center gap-2 bg-black/40 backdrop-blur-md border border-white/10 pr-1 pl-3 py-1 rounded-full animate-fade-slide-up",children:[r.jsx("div",{className:"w-6 h-6 rounded-full border border-white/50 overflow-hidden bg-gray-800",children:Te.storeImage?r.jsx("img",{src:Te.storeImage,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-full h-full p-1 text-gray-400"})}),r.jsx("span",{className:"text-[9px] font-bold text-white max-w-[80px] truncate",children:Te.name})]})}),se.textOverlay&&r.jsx("div",{className:"absolute bottom-3 left-3 max-w-[50%] z-20 flex flex-col items-start animate-fade-slide-up",children:r.jsx("div",{className:"bg-black/30 backdrop-blur-md border border-white/10 px-2 py-1.5 rounded-lg shadow-lg",children:r.jsx("p",{className:"text-white font-bold text-[10px] leading-relaxed drop-shadow-md",children:se.textOverlay})})})]},se.id)}),r.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1 z-20",children:Y.map((se,_e)=>r.jsx("div",{className:`w-1 h-1 rounded-full transition-all ${_e===P?"bg-white w-3":"bg-white/40"}`},_e))})]})}),r.jsx("div",{className:"px-5 animate-fade-slide-up",style:{animationDelay:"0.05s"},children:r.jsxs("button",{onClick:l,className:"w-full bg-gradient-to-r from-[#2A1010] to-[#1A0B0B] rounded-2xl border border-red-500/20 p-2.5 flex items-center justify-between group active:scale-98 transition-all",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-red-500/10 flex items-center justify-center text-red-400 group-hover:bg-red-500/20 transition-colors",children:O("ic_special",zt,"w-3.5 h-3.5")}),r.jsxs("div",{className:"text-right",children:[r.jsx("h3",{className:"text-white font-bold text-xs",children:" "}),r.jsx("p",{className:"text-gray-500 text-[9px] mt-0.5",children:"   ."})]})]}),r.jsx("div",{className:"text-gray-600 group-hover:text-red-500 transition-colors",children:r.jsx(Gs,{className:"w-4 h-4"})})]})}),r.jsxs("div",{className:"px-5 animate-fade-slide-up",style:{animationDelay:"0.1s"},children:[r.jsx("div",{className:"flex items-center justify-between mb-2",children:r.jsx("h3",{className:"text-xs font-bold text-white flex items-center gap-2",children:""})}),r.jsx("div",{className:"flex gap-2.5 overflow-x-auto pb-1 scrollbar-hide",children:W?[1,2,3,4].map(se=>r.jsx("div",{className:"h-8 w-16 bg-[#252525] rounded-xl animate-pulse"},se)):X.map(se=>{const _e=v===se.id,Te=se.Icon,be=se.customIcon;return r.jsxs("button",{onClick:()=>T(se.id),className:`
                                        flex items-center gap-1.5 pl-3 pr-1.5 py-1.5 rounded-xl text-[10px] font-bold whitespace-nowrap transition-all duration-200 border
                                        ${_e?"bg-white text-black border-white shadow-sm scale-105 z-10":"bg-[#252525] text-gray-400 border-transparent hover:bg-[#303030]"}
                                    `,children:[r.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center ${_e?"bg-black text-white":"bg-white/5 text-gray-500"}`,children:be?r.jsx("div",{className:`w-3 h-3 ${_e?"bg-white":"bg-gray-500"}`,style:{maskImage:`url(${be})`,maskSize:"contain",maskRepeat:"no-repeat",maskPosition:"center",WebkitMaskImage:`url(${be})`,WebkitMaskSize:"contain",WebkitMaskRepeat:"no-repeat",WebkitMaskPosition:"center"}}):r.jsx(Te,{className:"w-3 h-3"})}),se.label]},se.id)})})]}),r.jsx("div",{className:"px-5 pb-10 animate-fade-slide-up",style:{animationDelay:"0.2s"},children:r.jsx("div",{className:"grid grid-cols-2 gap-3 mt-1",children:W?r.jsxs(r.Fragment,{children:[r.jsx(Dp,{}),r.jsx(Dp,{}),r.jsx(Dp,{}),r.jsx(Dp,{})]}):R.length>0?R.map(se=>r.jsx(JW,{merchant:se,onClick:()=>t(se),theme:f},se.id)):r.jsxs("div",{className:"col-span-2 py-12 text-center flex flex-col items-center justify-center bg-[#252525] rounded-2xl border border-white/5 border-dashed",children:[r.jsx(Kn,{className:"w-8 h-8 text-gray-600 mb-2 opacity-50"}),r.jsx("p",{className:"text-gray-400 text-[10px] font-bold",children:"   "})]})})})]})})]})},ZW=({product:s,onClose:e,onConfirm:t})=>{var n;return r.jsx("div",{className:"fixed inset-0 z-[60] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-gray-700 shadow-2xl overflow-hidden animate-pop-in",onClick:a=>a.stopPropagation(),children:[r.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[r.jsx("h3",{className:"font-bold text-white text-base",children:" "}),r.jsx("button",{onClick:e,className:"p-1 rounded-full bg-gray-700 text-gray-400 hover:text-white clickable",children:r.jsx(rt,{className:"w-4 h-4"})})]}),r.jsx("div",{className:"p-4 space-y-2",children:(n=s.sizes)==null?void 0:n.map((a,l)=>r.jsxs("button",{onClick:()=>t(a),className:"w-full flex justify-between items-center p-3 rounded-xl bg-gray-800 hover:bg-gray-700 border border-gray-700 hover:border-gray-500 transition-all group clickable",children:[r.jsx("span",{className:"font-bold text-gray-200 group-hover:text-white text-sm",children:a.name}),r.jsxs("span",{className:"font-bold text-green-400 text-sm",children:[a.price," ."]})]},l))})]})})},eK=({merchant:s,onBack:e,addToCart:t,cart:n,onViewCart:a,initialCategory:l,toggleFavorite:c,favoriteIds:d,appTheme:f})=>{const[m,x]=j.useState(""),[y,w]=j.useState(null),[v,T]=j.useState(0),[I,N]=j.useState(null),P=j.useRef(null),U=j.useRef(null),V=j.useRef({}),q=j.useRef(!1);j.useEffect(()=>{const E=P.current;if(!E)return;const Y=()=>{const X=E.scrollTop,R=Math.min(X/100,.95);T(R)};return E.addEventListener("scroll",Y),()=>E.removeEventListener("scroll",Y)},[]);const W=j.useMemo(()=>Array.from(new Set((s.products||[]).map(Y=>Y.category||""))),[s.products]);j.useEffect(()=>{const E=P.current;if(!E)return;const Y={root:E,rootMargin:"-80px 0px -70% 0px",threshold:0},X=J=>{q.current||J.forEach(O=>{if(O.isIntersecting){const K=O.target.getAttribute("data-category");if(K){x(K);const Q=document.getElementById(`cat-btn-${K}`);if(Q&&U.current){const L=U.current,G=Q.offsetLeft-L.offsetWidth/2+Q.offsetWidth/2;L.scrollTo({left:G,behavior:"smooth"})}}}})},R=new IntersectionObserver(X,Y);return Object.values(V.current).forEach(J=>{J&&R.observe(J)}),()=>R.disconnect()},[W]),j.useEffect(()=>{l&&W.includes(l)?setTimeout(()=>F(l),100):W.length>0&&x(W[0])},[l]),Ht(()=>I?(N(null),!0):y?(w(null),!0):!1,[y,I]);const z=n.reduce((E,Y)=>E+Y.quantity,0),k=n.reduce((E,Y)=>E+Y.price*Y.quantity,0),M=j.useMemo(()=>{const E={};return(s.products||[]).forEach(X=>{const R=X.category||"";E[R]||(E[R]=[]),E[R].push(X)}),E},[s.products]),B=E=>n.filter(Y=>Y.id===E).reduce((Y,X)=>Y+X.quantity,0),D=E=>{E.sizes&&E.sizes.length>0?N(E):t(E)},S=E=>{if(I){const Y={...I,price:E.price};t(Y,E),N(null)}},F=E=>{q.current=!0,x(E);const Y=V.current[E],X=P.current;if(Y&&X){const J=Y.offsetTop-120;X.scrollTo({top:J,behavior:"smooth"}),setTimeout(()=>{q.current=!1},600)}};return r.jsxs("div",{className:"bg-[#1A1A1A] text-white h-[100dvh] flex flex-col relative animate-page-enter font-sans overflow-hidden",children:[r.jsxs("div",{className:"absolute top-0 left-0 right-0 z-50 pt-safe px-4 pb-2 flex items-center justify-between transition-colors duration-200 pointer-events-none box-content h-12 will-change-transform",style:{backgroundColor:`rgba(26, 26, 26, ${v})`,backdropFilter:`blur(${v*12}px)`,borderBottom:`1px solid rgba(255,255,255,${v*.05})`,boxShadow:`0 4px 20px rgba(0,0,0,${v*.1})`},children:[r.jsx("button",{onClick:e,className:"w-9 h-9 rounded-full flex items-center justify-center text-white transition-all active:scale-95 shadow-lg pointer-events-auto bg-black/40 backdrop-blur-md border border-white/10 clickable",children:r.jsx(ma,{className:"w-5 h-5"})}),r.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 translate-y-1 pt-safe transition-opacity duration-300 pointer-events-none",style:{opacity:v>.8?1:0},children:r.jsx("h1",{className:"text-sm font-bold text-white shadow-sm text-center",children:s.name})})]}),r.jsxs("div",{ref:P,className:"flex-1 overflow-y-auto overflow-x-hidden scroll-smooth pb-safe overscroll-none",onScroll:E=>{const Y=E.currentTarget.scrollTop,X=Math.min(Y/100,.95);T(X)},children:[r.jsxs("div",{className:"relative h-44 w-full flex-shrink-0",children:[s.storeImage?r.jsx("img",{src:s.storeImage,alt:"cover",className:"w-full h-full object-cover"}):r.jsx("div",{className:"w-full h-full bg-[#252525] flex items-center justify-center text-gray-600",children:r.jsx(Sn,{className:"w-12 h-12 opacity-20"})}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#1A1A1A] via-[#1A1A1A]/40 to-transparent"}),r.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 pt-8 bg-gradient-to-t from-[#1A1A1A] to-transparent",children:[r.jsxs("div",{className:"flex justify-between items-end mb-1",children:[r.jsx("h1",{className:"text-xl font-black text-white leading-tight shadow-sm drop-shadow-md",children:s.name}),r.jsxs("div",{className:"bg-white text-black text-[10px] font-bold px-1.5 py-0.5 rounded mb-1 flex items-center gap-0.5",children:["4.8 ",r.jsx(Rr,{className:"w-2.5 h-2.5 inline pb-0.5 fill-current"})]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-300 font-medium opacity-90 mb-2",children:[r.jsx("span",{className:"bg-red-500/20 text-red-300 px-1.5 py-0.5 rounded text-[10px] border border-red-500/30",children:s.storeCategory||""}),s.phone&&r.jsx("span",{className:"text-[10px] text-gray-400 font-mono selectable",children:s.phone})]}),r.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold w-fit",children:[r.jsxs("div",{className:"flex items-center gap-1 text-gray-300 bg-white/5 px-2 py-1 rounded-full backdrop-blur-md border border-white/10",children:[r.jsx(wt,{className:"w-3 h-3 text-blue-400"}),r.jsxs("span",{children:[s.responseTime||"30"," "]})]}),s.hasFreeDelivery&&r.jsxs("div",{className:"flex items-center gap-1 text-gray-300 bg-white/5 px-2 py-1 rounded-full backdrop-blur-md border border-white/10",children:[r.jsx(Bt,{className:"w-3 h-3 text-green-400"}),r.jsx("span",{children:""})]})]})]})]}),r.jsx("div",{className:"sticky top-0 z-40 bg-[#1A1A1A] border-b border-white/5 shadow-xl pt-1 pb-1",children:r.jsx("div",{ref:U,className:"flex gap-2 overflow-x-auto px-4 pb-2 scrollbar-hide",children:W.map(E=>r.jsx("button",{id:`cat-btn-${E}`,onClick:()=>F(E),className:`
                            px-4 py-1.5 rounded-full text-[11px] font-bold whitespace-nowrap transition-all duration-300 border clickable
                            ${m===E?"bg-white text-black border-white shadow-sm scale-105":"bg-[#252525] text-gray-400 border-transparent hover:bg-[#303030]"}
                        `,children:E},E))})}),r.jsx("div",{className:"px-4 pt-3 space-y-5 pb-32",children:W.map(E=>{var Y;return r.jsxs("div",{ref:X=>{V.current[E]=X},"data-category":E,className:"min-h-[60px]",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("h4",{className:"text-base font-black text-white",children:E}),r.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-gray-800 to-transparent"})]}),r.jsx("div",{className:"grid gap-2",children:(Y=M[E])==null?void 0:Y.map(X=>{var O;const R=B(X.id),J=X.sizes&&X.sizes.length>0;return r.jsxs("div",{className:"group bg-[#252525] rounded-xl p-2 border border-white/5 flex gap-3 relative overflow-hidden transition-all duration-300 active:bg-[#2a2a2a]",children:[R>0&&r.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-green-500"}),r.jsxs("div",{className:"w-20 h-20 bg-[#1A1A1A] rounded-lg overflow-hidden flex-shrink-0 cursor-pointer relative clickable",onClick:()=>X.image&&w(X.image),children:[X.image?r.jsx("img",{src:X.image,className:"w-full h-full object-cover",alt:X.name}):r.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:r.jsx(Sn,{className:"w-5 h-5 opacity-30"})}),!X.available&&r.jsx("div",{className:"absolute inset-0 bg-black/70 flex items-center justify-center backdrop-blur-sm",children:r.jsx("span",{className:"text-[9px] font-bold text-white bg-red-600 px-2 py-0.5 rounded shadow-lg",children:" "})})]}),r.jsxs("div",{className:"flex-1 min-w-0 py-0.5 flex flex-col justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"flex justify-between items-start",children:r.jsx("h4",{className:"font-bold text-white text-xs mb-0.5 truncate",children:X.name})}),r.jsx("p",{className:"text-[9px] text-gray-400 line-clamp-2 leading-tight opacity-80",children:X.description})]}),r.jsxs("div",{className:"flex items-end justify-between mt-1",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsxs("span",{className:"font-black text-white text-sm",children:[X.price>0?X.price:J?(O=X.sizes)==null?void 0:O[0].price:0,r.jsx("span",{className:"text-[9px] text-red-500 font-bold ml-0.5",children:"."})]}),J&&r.jsx("span",{className:"text-[8px] text-green-400 font-bold",children:" "})]}),R>0&&!J?r.jsxs("div",{className:"flex items-center bg-[#1A1A1A] rounded-full p-0.5 border border-green-500/30 shadow-lg",children:[r.jsx("div",{className:"px-2 text-xs font-bold text-white",children:R}),r.jsx("button",{onClick:()=>t(X),className:"w-5 h-5 bg-green-500 text-white rounded-full flex items-center justify-center active:scale-90 transition-transform clickable",children:r.jsx(ln,{className:"w-3 h-3"})})]}):r.jsx("button",{onClick:()=>D(X),disabled:!X.available,className:`h-6 px-3 rounded-full flex items-center justify-center transition-all shadow active:scale-90 clickable ${X.available?R>0?"bg-green-600 text-white":"bg-white text-black hover:bg-gray-200":"bg-gray-700 text-gray-500 cursor-not-allowed"}`,children:R>0&&J?r.jsxs("span",{className:"text-[9px] font-bold flex items-center gap-1",children:[r.jsx(ln,{className:"w-2 h-2"})," "]}):r.jsx(ln,{className:"w-3.5 h-3.5"})})]})]})]},X.id)})})]},E)})})]}),z>0&&r.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-[#1A1A1A] via-[#1A1A1A] to-transparent z-50 animate-slide-up",children:r.jsxs("button",{onClick:a,className:"w-full bg-red-600 hover:bg-red-700 text-white py-3.5 rounded-2xl shadow-xl shadow-red-600/30 flex items-center justify-between px-5 transition-all active:scale-[0.98] group border border-red-500/50 clickable",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"bg-white text-red-600 w-6 h-6 rounded-full flex items-center justify-center text-xs font-black shadow-sm",children:z}),r.jsx("span",{className:"font-bold text-base",children:" "})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"font-black text-lg text-white",children:[k," ",r.jsx("span",{className:"text-[10px] font-medium opacity-80",children:"."})]}),r.jsx(ma,{className:"w-4 h-4 rotate-180 opacity-80 group-hover:translate-x-1 transition-transform"})]})]})}),y&&r.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-xl flex items-center justify-center p-4 animate-fadeIn",onClick:()=>w(null),children:[r.jsx("img",{src:y,className:"max-w-full max-h-full object-contain rounded-2xl shadow-2xl animate-pop-in border border-white/10",onClick:E=>E.stopPropagation()}),r.jsx("button",{onClick:()=>w(null),className:"absolute top-6 right-6 p-2 bg-gray-800 rounded-full text-white hover:bg-gray-700 transition-colors border border-white/10 clickable",children:r.jsx(rt,{className:"w-5 h-5"})})]}),I&&r.jsx(ZW,{product:I,onClose:()=>N(null),onConfirm:S})]})},tK=({cart:s,onBack:e,onUpdateQuantity:t,onRemoveItem:n,onPlaceOrder:a,savedAddresses:l=[],appTheme:c,promoCodes:d,userPoints:f,pointsConfig:m,userPhone:x,onGoToStores:y})=>{const[w,v]=j.useState("all"),[T,I]=j.useState(!1),[N,P]=j.useState(""),[U,V]=j.useState(""),[q,W]=j.useState(!1),[z,k]=j.useState(""),[M,B]=j.useState(null),[D,S]=j.useState(!1),[F,E]=j.useState(""),[Y,X]=j.useState(0),R=j.useRef(null),J=(m==null?void 0:m.isPointsEnabled)??!0;j.useEffect(()=>{const be=R.current;if(!be)return;const ye=()=>{const et=be.scrollTop,Je=Math.min(et/60,.95);X(Je)};return be.addEventListener("scroll",ye),()=>be.removeEventListener("scroll",ye)},[]),j.useEffect(()=>{l.length>0&&v(l[0])},[l]);const O=s.reduce((be,ye)=>be+ye.price*ye.quantity,0),K=f*m.currencyPerPoint,Q=D&&J?Math.min(K,O):0,L=D&&J?Math.ceil(Q/m.currencyPerPoint):0;let G=0;M&&(M.type==="percentage"?G=O*M.value/100:G=M.value);const ee=Math.min(Q+G,O),ne=O-ee,je=()=>{if(E(""),!z.trim())return;const be=z.trim().toUpperCase(),ye=d.find(et=>et.code===be&&et.isActive);if(!ye){E("     ."),B(null);return}if(ye.expiryDate&&new Date(ye.expiryDate)<new Date){E("   ."),B(null);return}if(ye.maxUsage&&ye.usageCount>=ye.maxUsage){E("      ."),B(null);return}B(ye),k("")},se=()=>{B(null),E("")},_e=()=>{N.trim()&&(v(N),I(!1))},Te=()=>{if(T&&N.trim())v(N),I(!1);else if(!w||w==="all"){I(!0);return}W(!0);const be=T&&N.trim()?N:w,ye={discountAmount:ee,promoCode:M==null?void 0:M.code,pointsUsed:D&&J?L:0,finalPrice:ne};a(U,be,x,ye)};return r.jsxs("div",{className:"bg-[#1A1A1A] h-full flex flex-col relative animate-page-enter font-sans overflow-hidden fixed inset-0",children:[r.jsxs("div",{className:"absolute top-0 left-0 right-0 z-40 pt-safe px-4 pb-2 flex items-center justify-between transition-all duration-300 pointer-events-none box-content h-12",style:{backgroundColor:`rgba(26, 26, 26, ${Y})`,backdropFilter:Y>.5?"blur(12px)":"none",borderBottom:Y>.5?"1px solid rgba(255,255,255,0.05)":"none"},children:[r.jsxs("div",{className:"flex items-center gap-3 pointer-events-auto",children:[r.jsx("button",{onClick:e,className:"bg-[#252525] hover:opacity-80 p-2 rounded-full text-white transition-colors border border-white/5 active:scale-95 shadow-sm",children:r.jsx(ma,{className:"w-5 h-5"})}),r.jsx("div",{style:{opacity:Y>.2?1:0,transition:"opacity 0.3s"},children:r.jsx("h1",{className:"text-lg font-black text-white leading-none",children:" "})})]}),r.jsxs("div",{className:"bg-red-600/10 text-red-400 px-2 py-1 rounded-lg text-xs font-bold border border-red-500/20 font-mono shadow-sm pointer-events-auto",children:[s.reduce((be,ye)=>be+ye.quantity,0)," "]})]}),r.jsxs("div",{ref:R,className:"flex-1 overflow-y-auto pt-20 px-4 space-y-5 pb-48",style:{overscrollBehavior:"none",WebkitOverflowScrolling:"touch"},onScroll:be=>{const ye=Math.min(be.currentTarget.scrollTop/60,.95);X(ye)},children:[!Y&&r.jsx("div",{className:"mb-2 transition-opacity duration-300",children:r.jsx("h1",{className:"text-2xl font-black text-white leading-none",children:" "})}),s.length===0?r.jsxs("div",{className:"flex flex-col items-center justify-center h-full min-h-[50vh] animate-fadeIn",children:[r.jsx("div",{className:"w-24 h-24 bg-[#252525] rounded-full flex items-center justify-center mb-4 border border-dashed border-gray-700 shadow-inner",children:r.jsx(Nn,{className:"w-10 h-10 text-gray-600 opacity-50"})}),r.jsx("h2",{className:"text-xl font-bold text-white mb-1",children:" "}),r.jsx("p",{className:"text-gray-500 text-xs mb-6",children:"   ."}),r.jsx("button",{onClick:y||e,className:"bg-white text-black font-bold py-3 px-8 rounded-xl hover:bg-gray-200 transition-all shadow-lg active:scale-95 text-sm",children:" "})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"space-y-3",children:s.map((be,ye)=>{var et;return r.jsxs("div",{className:"flex gap-3 p-2 bg-[#252525] rounded-2xl border border-white/5 shadow-sm items-center",children:[r.jsx("div",{className:"w-16 h-16 bg-[#1A1A1A] rounded-xl overflow-hidden flex-shrink-0 border border-white/5",children:be.image?r.jsx("img",{src:be.image,className:"w-full h-full object-cover",alt:be.name}):r.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:r.jsx(Nn,{className:"w-6 h-6 opacity-20"})})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex justify-between items-start mb-1",children:[r.jsx("h4",{className:"font-bold text-white text-sm truncate pl-2",children:be.name}),r.jsx("button",{onClick:()=>n(be.id),className:"text-gray-500 hover:text-red-500 p-1",children:r.jsx(Pt,{className:"w-3.5 h-3.5"})})]}),be.selectedSize&&r.jsx("span",{className:"text-[9px] text-green-400 bg-green-900/20 px-1.5 py-0.5 rounded mb-1 inline-block",children:be.selectedSize.name}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("span",{className:"font-bold text-red-400 text-xs",children:[be.price.toLocaleString("en-US")," ."]}),r.jsxs("div",{className:"flex items-center bg-[#1A1A1A] rounded-lg p-0.5 border border-white/5 h-7",children:[r.jsx("button",{onClick:()=>t(be.id,1),className:"w-7 h-full flex items-center justify-center text-white hover:bg-white/10 rounded",children:r.jsx(ln,{className:"w-2.5 h-2.5"})}),r.jsx("span",{className:"w-6 text-center font-bold text-xs text-white",children:be.quantity}),r.jsx("button",{onClick:()=>t(be.id,-1),className:"w-7 h-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 rounded",children:r.jsx(F5,{className:"w-2.5 h-2.5"})})]})]})]})]},be.id+(((et=be.selectedSize)==null?void 0:et.name)||""))})}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between px-1",children:[r.jsx("h3",{className:"font-bold text-white text-xs",children:" "}),!T&&l.length>0&&r.jsx("button",{onClick:()=>{I(!0),P("")},className:"text-[10px] text-red-400 font-bold hover:text-red-300 transition-colors",children:"+ "})]}),T?r.jsxs("div",{className:"flex gap-2 items-center animate-fadeIn",children:[r.jsx("input",{type:"text",value:N,onChange:be=>P(be.target.value),placeholder:"    ( ...)",className:"flex-1 bg-[#252525] border border-white/10 rounded-xl px-4 py-3 text-xs text-white outline-none focus:border-red-500 transition-all placeholder-gray-500",autoFocus:!0}),r.jsx("button",{onClick:_e,className:"bg-red-600 hover:bg-red-700 text-white p-3 rounded-xl transition-all shadow-lg active:scale-95 flex-shrink-0",children:r.jsx(nt,{className:"w-5 h-5"})}),r.jsx("button",{onClick:()=>I(!1),className:"bg-gray-700 hover:bg-gray-600 text-gray-300 p-3 rounded-xl transition-all active:scale-95 flex-shrink-0",children:r.jsx(rt,{className:"w-5 h-5"})})]}):l.length>0?r.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-1 scrollbar-hide",children:[l.map((be,ye)=>r.jsx("button",{onClick:()=>v(be),className:`flex-shrink-0 min-w-[200px] p-3 rounded-xl border text-right transition-all text-xs ${w===be?"bg-red-900/20 border-red-500 text-white":"bg-[#252525] text-gray-400 border-white/5"}`,children:r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx(jn,{className:`w-3.5 h-3.5 ${w===be?"text-red-500":"text-gray-500"}`}),r.jsx("span",{className:"font-bold line-clamp-1",children:be})]})},ye)),w&&w!=="all"&&!l.includes(w)&&r.jsx("button",{onClick:()=>v(w),className:"flex-shrink-0 min-w-[200px] p-3 rounded-xl border text-right transition-all text-xs bg-red-900/20 border-red-500 text-white",children:r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx(jn,{className:"w-3.5 h-3.5 text-red-500"}),r.jsx("span",{className:"font-bold line-clamp-1",children:w})]})})]}):r.jsxs("button",{onClick:()=>I(!0),className:"w-full p-4 rounded-xl border border-dashed border-gray-600 text-gray-400 text-xs flex items-center justify-center gap-2 hover:border-red-500/50 hover:text-red-400 transition-colors",children:[r.jsx(ln,{className:"w-4 h-4"}),"  "]}),r.jsx("textarea",{value:U,onChange:be=>V(be.target.value),placeholder:" ()...",className:"w-full bg-[#252525] border border-white/5 rounded-xl p-3 text-white text-xs outline-none focus:border-red-500/50 resize-none h-16"})]}),r.jsxs("div",{className:"space-y-2",children:[J&&f>0&&K>=1&&r.jsxs("div",{className:`p-3 rounded-xl border flex items-center justify-between transition-all ${D?"bg-yellow-900/20 border-yellow-500/30":"bg-[#252525] border-white/5"}`,children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(R0,{className:"w-4 h-4 text-yellow-500"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-bold text-white",children:" "}),r.jsxs("p",{className:"text-[10px] text-gray-400",children:[" ",r.jsx("span",{className:"text-yellow-400",children:f})," = ",K.toLocaleString("en-US",{minimumFractionDigits:2})," ."]})]})]}),r.jsx("input",{type:"checkbox",checked:D,onChange:()=>S(!D),className:"w-4 h-4 accent-yellow-500 rounded"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"text",value:z,onChange:be=>k(be.target.value),placeholder:" ",className:"flex-1 bg-[#252525] border border-white/5 rounded-xl px-3 py-2 text-xs text-white outline-none focus:border-white/20",disabled:!!M}),M?r.jsxs("button",{onClick:se,className:"bg-green-600/20 text-green-400 px-3 py-2 rounded-xl text-xs font-bold border border-green-500/20",children:[" (",M.code,")"]}):r.jsx("button",{onClick:je,className:"bg-[#252525] text-white px-4 py-2 rounded-xl text-xs font-bold border border-white/10 hover:bg-white/5",children:""})]}),F&&r.jsx("p",{className:"text-red-400 text-[10px] px-1",children:F})]}),r.jsxs("div",{className:"bg-[#eee] text-black rounded-xl p-4 shadow-lg font-mono text-xs space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:""}),r.jsxs("span",{className:"font-bold",children:[O.toLocaleString("en-US")," ."]})]}),ee>0&&r.jsxs("div",{className:"flex justify-between text-green-700",children:[r.jsx("span",{children:""}),r.jsxs("span",{className:"font-bold",children:["-",ee.toLocaleString("en-US",{minimumFractionDigits:2})]})]}),r.jsxs("div",{className:"border-t border-black/10 pt-2 flex justify-between items-end",children:[r.jsx("span",{className:"font-bold",children:""}),r.jsxs("span",{className:"font-black text-lg",children:[ne.toLocaleString("en-US",{minimumFractionDigits:2})," ",r.jsx("span",{className:"text-[10px]",children:"."})]})]})]})]})]}),s.length>0&&r.jsx("div",{className:"fixed bottom-[74px] left-0 right-0 p-4 bg-[#1A1A1A] border-t border-white/5 z-30",children:r.jsxs("button",{onClick:Te,disabled:q,className:"w-full bg-white text-black hover:bg-gray-200 py-3.5 rounded-xl font-black text-sm transition-all flex justify-between items-center px-5 active:scale-[0.98]",children:[r.jsx("span",{children:q?" ...":" "}),!q&&r.jsxs("span",{className:"text-xs bg-black text-white px-2 py-0.5 rounded",children:[ne.toLocaleString("en-US",{minimumFractionDigits:2})," ."]})]})})]})},D5=s=>{switch(s){case ue.WaitingMerchant:return{color:"text-purple-400",bg:"bg-purple-500/10",border:"border-purple-500/20",icon:wt,label:" ",progress:10};case ue.Preparing:return{color:"text-orange-400",bg:"bg-orange-500/10",border:"border-orange-500/20",icon:Xr,label:" ",progress:35};case ue.Pending:return{color:"text-yellow-400",bg:"bg-yellow-500/10",border:"border-yellow-500/20",icon:Nn,label:" ",progress:15};case ue.InTransit:return{color:"text-blue-400",bg:"bg-blue-500/10",border:"border-blue-500/20",icon:Bt,label:" ",progress:65};case ue.Delivered:return{color:"text-teal-400",bg:"bg-teal-500/10",border:"border-teal-500/20",icon:nt,label:" ",progress:100};case ue.Cancelled:return{color:"text-red-400",bg:"bg-red-500/10",border:"border-red-500/20",icon:rt,label:"",progress:0};default:return{color:"text-gray-400",bg:"bg-gray-500/10",border:"border-gray-500/20",icon:wt,label:s,progress:0}}},sK=({orders:s,onDeleteOrder:e,appTheme:t})=>{const[n,a]=j.useState("current"),[l,c]=j.useState(null),[d,f]=j.useState(0),m=j.useRef(null);j.useEffect(()=>{const I=m.current;if(!I)return;const N=()=>{const P=I.scrollTop,U=Math.min(P/60,.95);f(U)};return I.addEventListener("scroll",N),()=>I.removeEventListener("scroll",N)},[]);const x={cardBg:"bg-[#1e1e1e]",border:"border-white/5",textMain:"text-white",textSub:"text-gray-400"},{currentOrders:y,historyOrders:w}=j.useMemo(()=>{const I=[],N=[];s.forEach(U=>{U.status===ue.Delivered||U.status===ue.Cancelled?N.push(U):I.push(U)});const P=(U,V)=>new Date(V.createdAt).getTime()-new Date(U.createdAt).getTime();return{currentOrders:I.sort(P),historyOrders:N.sort(P)}},[s]),v=I=>{var W,z;const N=D5(I.status),P=(I.totalPrice||0)+(I.deliveryFee||0),U=I.type==="shopping_order",V=I.deliveryFee&&I.deliveryFee>0,q=U?"bg-gradient-to-br from-[#2a1b36] to-[#1a1a1a] border-purple-500/30":`${x.cardBg} ${x.border}`;return r.jsxs("div",{className:"rounded-2xl p-0.5 relative overflow-hidden group shadow-lg transition-all duration-300 active:scale-[0.99] mb-3",children:[I.status===ue.InTransit&&r.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-blue-500/20 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000 z-10 pointer-events-none"}),r.jsxs("div",{className:`${q} rounded-[20px] p-4 relative z-0 flex flex-col border`,children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[r.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center shadow-inner flex-shrink-0 ${U?"bg-purple-500/20 text-purple-300":`${N.bg} ${N.color}`}`,children:U?r.jsx(zt,{className:"w-5 h-5 animate-pulse"}):r.jsx(N.icon,{className:"w-5 h-5"})}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("h3",{className:`font-bold text-base truncate ${U?"text-purple-100":x.textMain}`,children:U?" ":I.merchantName}),r.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[r.jsxs("span",{className:`text-[10px] font-mono tracking-wider px-1.5 py-0.5 rounded ${U?"bg-purple-500/10 text-purple-300":"bg-white/5 text-gray-500"}`,children:["#",I.id]}),r.jsx("span",{className:"text-[10px] text-gray-500 font-medium",children:new Date(I.createdAt).toLocaleTimeString("ar-EG-u-nu-latn",{hour:"2-digit",minute:"2-digit"})})]})]})]}),r.jsxs("div",{className:`px-2.5 py-1 rounded-lg text-[10px] font-bold border backdrop-blur-md flex items-center gap-1 flex-shrink-0 ${U?"bg-purple-500/10 border-purple-500/30 text-purple-300":`${N.bg} ${N.border} ${N.color}`}`,children:[I.status===ue.InTransit&&r.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-current animate-ping"}),N.label]})]}),U?r.jsx("div",{className:"bg-purple-900/10 border border-purple-500/10 rounded-lg p-2.5 mb-3",children:r.jsxs("p",{className:"text-xs text-gray-300 leading-relaxed line-clamp-2 italic",children:['"',I.notes,'"']})}):r.jsxs("div",{className:"flex items-center gap-2 mb-3 px-1",children:[r.jsx(Nn,{className:"w-3.5 h-3.5 text-gray-500"}),r.jsxs("span",{className:"text-xs text-gray-300",children:[((W=I.items)==null?void 0:W.length)||0," "]})]}),r.jsxs("div",{className:"flex justify-between items-end border-t border-white/5 pt-2 mt-auto",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[9px] text-gray-500 font-bold mb-0.5",children:" "}),V?r.jsxs("div",{className:"flex items-baseline gap-1",children:[r.jsx("span",{className:`text-lg font-black ${U?"text-purple-400":"text-white"}`,children:P>0?P.toLocaleString("en-US"):(z=I.totalPrice)==null?void 0:z.toLocaleString("en-US")}),r.jsx("span",{className:"text-[10px] text-gray-500 font-bold",children:"."})]}):r.jsxs("span",{className:"text-xs text-yellow-500 font-bold flex items-center gap-1",children:[r.jsx(wt,{className:"w-3 h-3"}),"  "]})]}),I.driverId&&I.status===ue.InTransit&&r.jsxs("div",{className:"flex items-center gap-1 bg-blue-500/10 px-2 py-1 rounded border border-blue-500/20 text-blue-400",children:[r.jsx(Bt,{className:"w-3.5 h-3.5"}),r.jsx("span",{className:"text-[10px] font-bold",children:"  "})]})]})]})]},I.id)},T=I=>{const N=D5(I.status),P=(I.totalPrice||0)+(I.deliveryFee||0),U=I.type==="shopping_order";return r.jsxs("div",{className:`${x.cardBg} rounded-xl p-3 border ${x.border} shadow-sm flex items-center justify-between gap-3 mb-2`,children:[r.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[r.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 ${U?"bg-purple-500/10 text-purple-400":I.status===ue.Cancelled?"bg-red-500/10 text-red-500":"bg-teal-500/10 text-teal-500"}`,children:U?r.jsx(zt,{className:"w-5 h-5"}):I.status===ue.Cancelled?r.jsx(rt,{className:"w-5 h-5"}):r.jsx(nt,{className:"w-5 h-5"})}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("h4",{className:`font-bold text-sm truncate ${x.textMain}`,children:U?" ":I.merchantName}),r.jsxs("div",{className:"flex items-center gap-2 text-[10px]",children:[r.jsx("span",{className:x.textSub,children:new Date(I.createdAt).toLocaleDateString("ar-EG-u-nu-latn")}),r.jsx("span",{className:`px-1.5 rounded border ${N.border} ${N.color} bg-transparent font-bold`,children:N.label})]})]})]}),r.jsxs("div",{className:"flex flex-col items-end gap-1 flex-shrink-0",children:[r.jsx("span",{className:`font-mono text-sm font-black ${x.textMain}`,children:P>0?`${P.toLocaleString("en-US")} .`:"--"}),r.jsx("button",{onClick:()=>c(I.id),className:"text-gray-600 hover:text-red-400 transition-colors p-1.5",children:r.jsx(Pt,{className:"w-4 h-4"})})]})]},I.id)};return r.jsxs("div",{className:"bg-[#1A1A1A] h-[100dvh] flex flex-col font-sans overflow-hidden",children:[r.jsxs("div",{className:"absolute top-0 left-0 right-0 z-40 pt-safe px-4 pb-3 transition-all duration-300 box-content",style:{backgroundColor:`rgba(26, 26, 26, ${d})`,backdropFilter:d>.5?"blur(12px)":"none",borderBottom:d>.5?"1px solid rgba(255,255,255,0.05)":"none",boxShadow:d>.5?"0 4px 30px rgba(0,0,0,0.1)":"none"},children:[r.jsx("div",{className:"flex justify-between items-center mb-3 mt-1",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`p-2 ${x.cardBg} rounded-full border ${x.border} shadow-sm`,children:r.jsx(Wn,{className:"w-5 h-5 text-gray-200"})}),r.jsxs("div",{children:[r.jsx("h1",{className:`text-lg font-black ${x.textMain} leading-none`,children:""}),r.jsx("p",{className:`text-[10px] ${x.textSub} font-medium mt-0.5`,children:"  "})]})]})}),r.jsxs("div",{className:`flex ${x.cardBg} p-1 rounded-lg shadow-inner border ${x.border}`,children:[r.jsxs("button",{onClick:()=>a("current"),className:`flex-1 py-2 text-xs font-bold rounded-md transition-all ${n==="current"?"bg-[#333] text-white shadow-sm border border-white/10":"text-gray-500 hover:text-gray-400"}`,children:[" (",y.length,")"]}),r.jsxs("button",{onClick:()=>a("history"),className:`flex-1 py-2 text-xs font-bold rounded-md transition-all ${n==="history"?"bg-[#333] text-white shadow-sm border border-white/10":"text-gray-500 hover:text-gray-400"}`,children:[" (",w.length,")"]})]})]}),r.jsx("div",{ref:m,className:"flex-1 overflow-y-auto p-4 space-y-2 pb-24 pt-36 scroll-smooth overscroll-none",onScroll:I=>{const N=Math.min(I.currentTarget.scrollTop/60,.95);f(N)},children:n==="current"?y.length===0?r.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-600 min-h-[40vh]",children:[r.jsx(C0,{className:"w-16 h-16 mb-4 opacity-10"}),r.jsx("p",{className:"text-sm font-bold text-gray-500",children:"   "})]}):r.jsx("div",{className:"animate-fadeIn pb-4",children:y.map(I=>v(I))}):w.length===0?r.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-600 min-h-[40vh]",children:[r.jsx(wt,{className:"w-16 h-16 mb-4 opacity-10"}),r.jsx("p",{className:"text-sm font-bold text-gray-500",children:" "})]}):r.jsx("div",{className:"animate-fadeIn pb-4",children:w.map(I=>T(I))})}),l&&r.jsx(os,{title:" ",message:"        ",onClose:()=>c(null),onConfirm:()=>{l&&(e(l),c(null))},confirmButtonText:"",confirmVariant:"danger"})]})},nK=({messages:s,onMarkAsSeen:e,hideMessage:t,appTheme:n})=>{var w;const[a,l]=j.useState(null),[c,d]=j.useState(0),f=j.useRef(null);j.useEffect(()=>{const v=f.current;if(!v)return;const T=()=>{const I=v.scrollTop,N=Math.min(I/60,.95);d(N)};return v.addEventListener("scroll",T),()=>v.removeEventListener("scroll",T)},[]);const m=((w=n==null?void 0:n.customer)==null?void 0:w.mode)!=="light",x={bg:m?"bg-[#0f172a]":"bg-gray-50",text:m?"text-white":"text-gray-900",subText:m?"text-gray-400":"text-gray-500",card:m?"bg-[#1e293b]":"bg-white",border:m?"border-white/5":"border-gray-200",footerBg:m?"bg-[#181818]":"bg-gray-50",footerBorder:m?"border-[#2a2a2a]":"border-gray-200"};j.useEffect(()=>{s.forEach(v=>{e(v.id)})},[s,e]);const y=()=>{a&&(t(a),l(null))};return r.jsxs("div",{className:`h-[100dvh] ${x.bg} flex flex-col animate-fadeIn overflow-hidden relative`,children:[r.jsx("div",{className:`absolute top-0 left-0 right-0 z-40 pt-safe px-4 pb-4 flex items-center justify-between transition-all duration-300 pointer-events-none border-b box-content h-14 ${c>.5?x.border:"border-transparent"}`,style:{backgroundColor:m?`rgba(15, 23, 42, ${c})`:`rgba(255, 255, 255, ${c})`,backdropFilter:c>.5?"blur(12px)":"none",boxShadow:c>.5?"0 4px 30px rgba(0,0,0,0.1)":"none"},children:r.jsxs("div",{className:"flex items-center gap-3 mt-2 pointer-events-auto",children:[r.jsx("div",{className:"p-2.5 bg-gradient-to-br from-red-600 to-red-800 rounded-2xl shadow-lg shadow-red-900/30",children:r.jsx(kr,{className:"w-5 h-5 text-white"})}),r.jsxs("div",{children:[r.jsx("h1",{className:`text-xl font-black ${x.text} leading-none`,children:" "}),r.jsx("p",{className:`text-xs ${x.subText} font-medium mt-1`,children:"   "})]})]})}),r.jsx("div",{ref:f,className:`flex-1 overflow-y-auto p-4 space-y-5 pb-24 pt-24 ${x.bg} overscroll-none`,onScroll:v=>{const T=Math.min(v.currentTarget.scrollTop/60,.95);d(T)},children:s.length===0?r.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 h-[70vh]",children:[r.jsx("div",{className:`w-24 h-24 ${m?"bg-[#1E1E1E]":"bg-white"} rounded-full flex items-center justify-center mb-6 border ${m?"border-[#333]":"border-gray-200"} shadow-xl`,children:r.jsx(an,{className:"w-10 h-10 text-gray-400"})}),r.jsx("h3",{className:`text-xl font-bold ${x.text} mb-2`,children:"   "}),r.jsx("p",{className:`text-sm ${x.subText} max-w-xs leading-relaxed`,children:"          ."})]}):s.map(v=>{const T=new Date(v.createdAt).toLocaleDateString("ar-EG-u-nu-latn",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx("div",{className:"self-center",children:r.jsx("span",{className:`text-[10px] ${x.subText} ${m?"bg-[#1E1E1E] border-[#333]":"bg-gray-200 border-gray-300"} px-2 py-0.5 rounded-full border`,children:T})}),r.jsxs("div",{className:`${x.card} rounded-2xl rounded-tr-sm border ${x.border} shadow-lg overflow-hidden relative group`,children:[r.jsxs("div",{className:"p-5",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx("div",{className:"w-6 h-6 rounded-full bg-red-600 flex items-center justify-center shadow-md",children:r.jsx(an,{className:"w-3 h-3 text-white"})}),r.jsx("span",{className:`text-xs font-bold ${m?"text-gray-300":"text-gray-600"}`,children:"  "})]}),v.image&&r.jsx("div",{className:`mb-4 rounded-xl overflow-hidden border ${m?"border-[#444]":"border-gray-200"} shadow-inner`,children:r.jsx("img",{src:v.image,alt:"",className:"w-full h-auto"})}),r.jsx("p",{className:`${x.text} text-sm leading-relaxed whitespace-pre-wrap font-medium`,children:v.text})]}),r.jsxs("div",{className:`${x.footerBg} p-2 flex justify-between items-center border-t ${x.footerBorder}`,children:[r.jsx("span",{className:`text-[10px] ${x.subText} px-2`,children:" "}),r.jsx("button",{onClick:()=>l(v.id),className:`p-2 text-gray-500 hover:text-red-500 ${m?"hover:bg-red-500/10":"hover:bg-red-100"} rounded-full transition-all`,title:"",children:r.jsx(Pt,{className:"w-4 h-4"})})]})]})]},v.id)})}),a&&r.jsx(os,{title:" ",message:"      ",onClose:()=>l(null),onConfirm:y,confirmButtonText:"",confirmVariant:"danger"})]})},rK=({user:s,onBack:e,onPlaceOrder:t,appTheme:n})=>{const[a,l]=j.useState(""),c=j.useMemo(()=>((s==null?void 0:s.addresses)||[]).filter(S=>!S.includes("")&&!S.includes("")&&!S.includes("Pickup")),[s==null?void 0:s.addresses]),d=c.length>0?c[0]:"",[f,m]=j.useState(d),[x,y]=j.useState(!d),w=(s==null?void 0:s.phone)||"",[v,T]=j.useState(w),[I,N]=j.useState(!w),[P,U]=j.useState(!1),[V,q]=j.useState(0),W=j.useRef(null);j.useEffect(()=>{const S=W.current;if(!S)return;const F=()=>{const E=S.scrollTop,Y=Math.min(E/100,.95);q(Y)};return S.addEventListener("scroll",F),()=>S.removeEventListener("scroll",F)},[]);const z=()=>{if(!a.trim())return;if(!f.trim()){alert("   ");return}if(!v.trim()){alert("   ");return}if(v.length<11){alert("   ");return}U(!0);const S=a;setTimeout(()=>{t(S,f,v)},1500)},k=S=>{m(S),y(!1)},M=()=>{m(""),y(!0)},B=S=>{T(S),N(!1)},D=()=>{T(""),N(!0)};return r.jsxs("div",{className:"bg-[#0f0f13] h-[100dvh] flex flex-col relative animate-page-enter font-sans overflow-hidden",children:[r.jsx("div",{className:"absolute top-0 inset-x-0 h-[500px] bg-gradient-to-b from-[#2D1B36] via-[#15101a] to-[#0f0f13] pointer-events-none"}),r.jsx("div",{className:"absolute -top-40 -right-20 w-96 h-96 bg-purple-600/20 rounded-full blur-[100px] pointer-events-none animate-pulse-slow"}),r.jsx("div",{className:"absolute top-20 -left-20 w-72 h-72 bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"}),r.jsxs("div",{className:"absolute top-0 left-0 right-0 z-40 pt-safe px-4 pb-4 flex items-center justify-between transition-all duration-500 pointer-events-none box-content h-14",style:{backgroundColor:`rgba(15, 15, 19, ${V})`,backdropFilter:V>.5?"blur(16px)":"none",borderBottom:V>.5?"1px solid rgba(255,255,255,0.05)":"none",boxShadow:V>.5?"0 10px 40px rgba(0,0,0,0.2)":"none"},children:[r.jsx("button",{onClick:e,className:"bg-white/5 hover:bg-white/10 backdrop-blur-md p-3 rounded-full text-white transition-all border border-white/10 active:scale-95 pointer-events-auto group",children:r.jsx(ma,{className:"w-5 h-5 group-hover:-translate-x-0.5 transition-transform"})}),r.jsxs("div",{className:`flex items-center gap-2 bg-white/5 backdrop-blur-xl px-4 py-2 rounded-full border border-white/10 pointer-events-auto transition-all duration-500 ${V>.5?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}`,children:[r.jsx(zt,{className:"w-4 h-4 text-purple-400"}),r.jsx("span",{className:"text-sm font-bold text-white tracking-wide",children:" "})]}),r.jsx("div",{className:"w-10"})]}),r.jsxs("div",{ref:W,className:"flex-1 overflow-y-auto pt-28 px-5 space-y-8 pb-44 scroll-smooth relative z-10 overscroll-none",onScroll:S=>{const F=Math.min(S.currentTarget.scrollTop/100,.95);q(F)},children:[r.jsxs("div",{className:"text-center space-y-4 mt-2 mb-8 relative",style:{opacity:Math.max(0,1-V*2),transform:`translateY(${V*-20}px)`,transition:"all 0.1s"},children:[r.jsxs("div",{className:"inline-flex items-center justify-center p-4 bg-gradient-to-tr from-purple-500/20 to-blue-500/20 rounded-3xl border border-white/10 shadow-2xl shadow-purple-900/20 mb-2 relative group",children:[r.jsx("div",{className:"absolute inset-0 bg-white/5 blur-xl rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-1000"}),r.jsx(zt,{className:"w-10 h-10 text-purple-300 animate-pulse"})]}),r.jsxs("h1",{className:"text-4xl font-black text-white leading-tight tracking-tight",children:[" ",r.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-purple-400 via-pink-400 to-orange-400",children:" "}),"",r.jsx("br",{})," ",r.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-300",children:" "}),"."]}),r.jsx("p",{className:"text-sm text-gray-400 max-w-[280px] mx-auto leading-relaxed font-medium",children:"     .     ."})]}),r.jsxs("div",{className:"group relative",children:[r.jsx("div",{className:"absolute -inset-0.5 bg-gradient-to-r from-purple-600 to-blue-600 rounded-[2.2rem] opacity-30 blur group-hover:opacity-60 transition duration-1000"}),r.jsx("div",{className:"relative bg-[#18181b] border border-white/10 rounded-[2rem] p-1 shadow-2xl",children:r.jsxs("div",{className:"bg-[#131316] rounded-[1.8rem] p-6 space-y-5",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-purple-600 to-indigo-600 flex items-center justify-center text-white shadow-lg shadow-purple-900/30",children:r.jsx(cr,{className:"w-5 h-5"})}),r.jsx("h3",{className:"font-bold text-white text-lg tracking-wide",children:" "})]}),r.jsxs("div",{className:"relative",children:[r.jsx("textarea",{value:a,onChange:S=>l(S.target.value),placeholder:`   ...
: '     '  '      '...`,className:"w-full h-44 bg-[#0a0a0c] border border-white/5 rounded-2xl p-5 text-white placeholder-gray-600 focus:border-purple-500/50 focus:ring-1 focus:ring-purple-500/20 outline-none transition-all resize-none text-base leading-relaxed shadow-inner",autoFocus:!0}),r.jsx("div",{className:"absolute bottom-4 left-4 pointer-events-none",children:r.jsx(sd,{className:`w-5 h-5 text-purple-500 transition-opacity duration-500 ${a?"opacity-100":"opacity-0"}`})})]})]})})]}),r.jsxs("div",{className:"space-y-4 pt-2",children:[r.jsxs("h3",{className:"text-sm font-bold text-gray-400 px-4 flex items-center gap-2 uppercase tracking-wider",children:[r.jsx(jn,{className:"w-4 h-4 text-purple-500"})," "]}),r.jsxs("div",{className:"grid gap-3",children:[c.map((S,F)=>r.jsxs("button",{onClick:()=>k(S),className:`w-full text-right p-4 rounded-2xl border transition-all duration-300 flex items-center justify-between group relative overflow-hidden ${f===S&&!x?"bg-gradient-to-r from-purple-900/30 to-[#18181b] border-purple-500/50 shadow-lg shadow-purple-900/10 scale-[1.02]":"bg-[#18181b] border-white/5 hover:border-white/10 hover:bg-[#1f1f22]"}`,children:[r.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[r.jsx("div",{className:`p-2.5 rounded-full transition-colors ${f===S&&!x?"bg-purple-600 text-white shadow-md":"bg-[#27272a] text-gray-500"}`,children:r.jsx(Rr,{className:"w-4 h-4"})}),r.jsx("span",{className:`text-sm font-bold line-clamp-1 ${f===S&&!x?"text-white":"text-gray-400 group-hover:text-gray-300"}`,children:S})]}),f===S&&!x&&r.jsx("div",{className:"bg-purple-500 rounded-full p-1",children:r.jsx(nt,{className:"w-4 h-4 text-white"})})]},F)),r.jsxs("button",{onClick:M,className:`w-full text-right p-4 rounded-2xl border border-dashed transition-all duration-300 flex items-center gap-4 group ${x?"border-blue-500 bg-blue-900/10":"border-gray-700 bg-transparent hover:bg-white/5 hover:border-gray-500"}`,children:[r.jsx("div",{className:`p-2.5 rounded-full transition-colors ${x?"bg-blue-600 text-white shadow-md":"bg-[#27272a] text-gray-500 group-hover:text-white"}`,children:r.jsx(ln,{className:"w-4 h-4"})}),x?r.jsx("input",{type:"text",value:f,onChange:S=>m(S.target.value),placeholder:"  ...",className:"bg-transparent text-white text-sm font-bold outline-none w-full placeholder-blue-300/50",autoFocus:!0}):r.jsx("span",{className:"text-sm font-bold text-gray-400 group-hover:text-gray-300",children:"  ..."})]})]})]}),r.jsxs("div",{className:"space-y-4 pt-2",children:[r.jsxs("h3",{className:"text-sm font-bold text-gray-400 px-4 flex items-center gap-2 uppercase tracking-wider",children:[r.jsx(Js,{className:"w-4 h-4 text-green-500"})," "]}),r.jsxs("div",{className:"grid gap-3",children:[(s==null?void 0:s.phone)&&r.jsxs("button",{onClick:()=>B(s.phone||""),className:`w-full text-right p-4 rounded-2xl border transition-all duration-300 flex items-center justify-between group relative overflow-hidden ${v===s.phone&&!I?"bg-gradient-to-r from-green-900/30 to-[#18181b] border-green-500/50 shadow-lg shadow-green-900/10 scale-[1.02]":"bg-[#18181b] border-white/5 hover:border-white/10 hover:bg-[#1f1f22]"}`,children:[r.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[r.jsx("div",{className:`p-2.5 rounded-full transition-colors ${v===s.phone&&!I?"bg-green-600 text-white shadow-md":"bg-[#27272a] text-gray-500"}`,children:r.jsx(Js,{className:"w-4 h-4"})}),r.jsxs("span",{className:`text-sm font-bold font-mono tracking-wide ${v===s.phone&&!I?"text-white":"text-gray-400 group-hover:text-gray-300"}`,children:[s.phone," ()"]})]}),v===s.phone&&!I&&r.jsx("div",{className:"bg-green-500 rounded-full p-1",children:r.jsx(nt,{className:"w-4 h-4 text-white"})})]}),r.jsxs("button",{onClick:D,className:`w-full text-right p-4 rounded-2xl border border-dashed transition-all duration-300 flex items-center gap-4 group ${I?"border-green-500 bg-green-900/10":"border-gray-700 bg-transparent hover:bg-white/5 hover:border-gray-500"}`,children:[r.jsx("div",{className:`p-2.5 rounded-full transition-colors ${I?"bg-green-600 text-white shadow-md":"bg-[#27272a] text-gray-500 group-hover:text-white"}`,children:r.jsx(ln,{className:"w-4 h-4"})}),I?r.jsx("input",{type:"tel",value:v,onChange:S=>T(S.target.value),placeholder:"  ...",className:"bg-transparent text-white text-sm font-bold outline-none w-full placeholder-green-300/50 font-mono",autoFocus:!0,dir:"ltr"}):r.jsx("span",{className:"text-sm font-bold text-gray-400 group-hover:text-gray-300",children:"  ..."})]})]})]})]}),r.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-6 pb-8 bg-gradient-to-t from-[#0f0f13] via-[#0f0f13] to-transparent z-30",children:r.jsxs("button",{onClick:z,disabled:P||!a,className:"group relative w-full bg-white text-black hover:bg-gray-100 py-4 rounded-[2rem] font-black text-lg transition-all disabled:bg-gray-800 disabled:text-gray-600 disabled:cursor-not-allowed shadow-2xl shadow-white/10 active:scale-[0.98] overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-gray-200/50 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000"}),r.jsxs("div",{className:"relative z-10 flex justify-between items-center px-6",children:[r.jsx("span",{className:"flex items-center gap-3",children:P?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-5 h-5 border-2 border-black/30 border-t-black rounded-full animate-spin"})," ..."]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"bg-black text-white p-1.5 rounded-full",children:r.jsx(zt,{className:"w-4 h-4"})})," "]})}),!P&&r.jsx("span",{className:"text-xs font-bold bg-black/5 px-3 py-1 rounded-lg border border-black/10",children:"  "})]})]})})]})},aK=({merchants:s,favoriteIds:e,toggleFavorite:t,addToCart:n,onBack:a,appTheme:l})=>{const[c,d]=j.useState(0),f=j.useRef(null);j.useEffect(()=>{const y=f.current;if(!y)return;const w=()=>{const v=y.scrollTop,T=Math.min(v/60,.95);d(T)};return y.addEventListener("scroll",w),()=>y.removeEventListener("scroll",w)},[]);const m=j.useMemo(()=>{const y=[];return s.forEach(w=>{w.products&&w.products.forEach(v=>{e.includes(v.id)&&y.push({product:v,merchant:w})})}),y},[s,e]),x=y=>{n(y.product,y.merchant)};return r.jsxs("div",{className:"bg-[#1A1A1A] h-[100dvh] flex flex-col relative animate-page-enter font-sans overflow-hidden",children:[r.jsx("div",{className:"absolute top-0 left-0 right-0 z-40 pt-safe px-4 pb-4 flex items-center justify-between transition-all duration-300 pointer-events-none box-content h-14",style:{backgroundColor:`rgba(26, 26, 26, ${c})`,backdropFilter:c>.5?"blur(12px)":"none",borderBottom:c>.5?"1px solid rgba(255,255,255,0.05)":"none",boxShadow:c>.5?"0 4px 30px rgba(0,0,0,0.1)":"none"},children:r.jsxs("div",{className:"flex items-center gap-3 pointer-events-auto",children:[r.jsx("button",{onClick:a,className:"bg-[#252525] hover:opacity-80 p-2.5 rounded-full text-white transition-colors border border-white/5 active:scale-95 shadow-sm",children:r.jsx(ma,{className:"w-5 h-5"})}),r.jsxs("div",{style:{opacity:c>.2?1:0,transition:"opacity 0.3s"},children:[r.jsxs("h1",{className:"text-xl font-black text-white leading-none flex items-center gap-2",children:["",r.jsx(ff,{className:"w-5 h-5 text-red-500 fill-current animate-pulse"})]}),r.jsxs("p",{className:"text-xs text-gray-400 font-medium mt-1",children:["  (",m.length,")"]})]})]})}),r.jsxs("div",{ref:f,className:"flex-1 overflow-y-auto pt-24 px-4 pb-24 scroll-smooth overscroll-none",onScroll:y=>{const w=Math.min(y.currentTarget.scrollTop/60,.95);d(w)},children:[!c&&r.jsxs("div",{className:"mb-4 transition-opacity duration-300",children:[r.jsxs("h1",{className:"text-2xl font-black text-white leading-none flex items-center gap-2",children:["",r.jsx(ff,{className:"w-6 h-6 text-red-500 fill-current"})]}),r.jsxs("p",{className:"text-sm text-gray-400 font-medium mt-2",children:["  (",m.length,")"]})]}),m.length===0?r.jsxs("div",{className:"flex flex-col items-center justify-center h-[60vh] text-center animate-fadeIn",children:[r.jsxs("div",{className:"relative mb-6",children:[r.jsx("div",{className:"absolute inset-0 bg-red-500/10 rounded-full blur-xl"}),r.jsx("div",{className:"w-24 h-24 bg-[#252525] rounded-full flex items-center justify-center relative z-10 shadow-inner border border-white/5",children:r.jsx(ff,{className:"w-10 h-10 text-gray-500"})})]}),r.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),r.jsxs("p",{className:"text-sm text-gray-400 max-w-[200px] leading-relaxed",children:["    ",r.jsx(ff,{className:"w-3 h-3 inline text-red-500"}),"      ."]})]}):r.jsx("div",{className:"grid grid-cols-2 gap-4",children:m.map(({product:y,merchant:w},v)=>r.jsxs("div",{className:"group bg-[#252525] rounded-[1.5rem] overflow-hidden border border-white/5 shadow-md hover:shadow-xl hover:border-gray-600 transition-all duration-300 flex flex-col animate-fade-slide-up",style:{animationDelay:`${v*50}ms`},children:[r.jsxs("div",{className:"relative aspect-square w-full bg-[#1A1A1A] overflow-hidden",children:[y.image?r.jsx("img",{src:y.image,alt:y.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}):r.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:r.jsx(Sn,{className:"w-8 h-8 opacity-20"})}),r.jsx("button",{onClick:()=>t(y.id),className:"absolute top-2 right-2 p-1.5 rounded-full bg-black/40 backdrop-blur-md text-white hover:bg-red-500 hover:text-white transition-all z-20 shadow-sm",children:r.jsx(rt,{className:"w-3 h-3"})}),r.jsxs("div",{className:"absolute bottom-2 left-2 bg-black/60 backdrop-blur-md px-2 py-1 rounded-lg flex items-center gap-1 max-w-[80%]",children:[r.jsx(lr,{className:"w-3 h-3 text-gray-300"}),r.jsx("span",{className:"text-[9px] text-white font-bold truncate",children:w.name})]})]}),r.jsxs("div",{className:"p-3 flex-1 flex flex-col",children:[r.jsx("h3",{className:"font-bold text-white text-sm mb-1 line-clamp-1 leading-snug",children:y.name}),r.jsx("p",{className:"text-[10px] text-gray-400 line-clamp-2 leading-relaxed mb-3 flex-1 opacity-80",children:y.description}),r.jsxs("div",{className:"flex justify-between items-center mt-auto pt-2 border-t border-white/5",children:[r.jsxs("div",{className:"flex items-baseline gap-0.5",children:[r.jsx("span",{className:"text-white font-black text-sm",children:y.price}),r.jsx("span",{className:"text-red-500 text-[9px] font-bold",children:"."})]}),r.jsx("button",{onClick:()=>x({product:y,merchant:w}),className:"w-8 h-8 bg-white text-black rounded-full flex items-center justify-center hover:bg-gray-200 active:scale-90 transition-all shadow-lg",children:r.jsx(ln,{className:"w-4 h-4"})})]})]})]},y.id))})]})]})},iK=({onBack:s,title:e,description:t})=>{const[n,a]=j.useState(!1);return j.useEffect(()=>{a(!0)},[]),r.jsxs("div",{className:"fixed inset-0 bg-[#1A1A1A] z-50 flex flex-col items-center justify-center p-6 text-white overflow-hidden",children:[r.jsx("div",{className:"absolute top-0 right-0 w-[300px] h-[300px] bg-red-600/10 rounded-full blur-[100px] pointer-events-none"}),r.jsx("div",{className:"absolute bottom-0 left-0 w-[300px] h-[300px] bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"}),r.jsx("button",{onClick:s,className:"absolute top-safe-offset right-5 p-3 bg-white/5 rounded-full text-white hover:bg-white/10 transition-colors z-20 backdrop-blur-md border border-white/10",style:{top:"calc(var(--safe-area-top) + 20px)"},children:r.jsx(ma,{className:"w-6 h-6"})}),r.jsxs("div",{className:`flex flex-col items-center text-center max-w-sm transition-all duration-700 transform ${n?"translate-y-0 opacity-100":"translate-y-10 opacity-0"}`,children:[r.jsxs("div",{className:"relative mb-10",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-red-500 to-orange-500 rounded-full blur-2xl opacity-40 animate-pulse"}),r.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-[#2a2a2a] to-[#1a1a1a] rounded-full flex items-center justify-center border-4 border-[#333] shadow-2xl relative z-10",children:r.jsx(zt,{className:"w-16 h-16 text-red-500 animate-bounce"})}),r.jsx("div",{className:"absolute -top-2 -right-4 bg-[#252525] p-2 rounded-xl border border-white/5 shadow-lg animate-bounce delay-100",children:r.jsx(wt,{className:"w-6 h-6 text-blue-400"})})]}),r.jsx("h1",{className:"text-4xl font-black mb-4 bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-400",children:e}),r.jsxs("p",{className:"text-gray-400 text-lg leading-relaxed mb-8",children:[t,r.jsx("br",{}),r.jsx("span",{className:"text-red-400 text-sm font-bold mt-2 block",children:"   !"})]}),r.jsx("div",{className:"w-full h-1.5 bg-gray-800 rounded-full overflow-hidden mb-2",children:r.jsx("div",{className:"h-full bg-gradient-to-r from-red-600 to-orange-500 w-[75%] rounded-full animate-pulse"})}),r.jsx("p",{className:"text-xs text-gray-500 font-mono tracking-widest uppercase",children:"Work in progress"})]})]})},O5=["https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Grinning%20Face%20with%20Big%20Eyes.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Face%20with%20Tears%20of%20Joy.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Smiling%20Face%20with%20Heart-Eyes.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Smiling%20Face%20with%20Hearts.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Star-Struck.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Red%20Heart.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Hand%20gestures/Thumbs%20Up.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Thinking%20Face.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Winking%20Face.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Hand%20gestures/Waving%20Hand.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Face%20Screaming%20in%20Fear.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Pleading%20Face.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Angry%20Face.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Face%20Blowing%20a%20Kiss.png"],oK=({onClose:s,onOpenChat:e,onOpenWhatsapp:t,config:n})=>r.jsx("div",{className:"fixed inset-0 z-[80] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:s,children:r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-[2rem] border border-gray-700 shadow-2xl p-6 animate-pop-in",onClick:a=>a.stopPropagation(),children:[r.jsxs("div",{className:"text-center mb-6",children:[r.jsx("div",{className:"w-16 h-16 bg-blue-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-blue-500/20",children:r.jsx(Dr,{className:"w-8 h-8 text-blue-400"})}),r.jsx("h3",{className:"text-xl font-bold text-white",children:" "}),r.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"   "})]}),r.jsxs("div",{className:"space-y-3",children:[(n==null?void 0:n.isChatEnabled)!==!1&&r.jsxs("button",{onClick:()=>{s(),e()},className:"w-full flex items-center gap-4 p-4 rounded-2xl bg-gray-800 hover:bg-gray-700 transition-colors border border-gray-700",children:[r.jsx("div",{className:"p-2 bg-blue-500/20 rounded-full text-blue-400",children:r.jsx(kv,{className:"w-6 h-6"})}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"font-bold text-white",children:" "}),r.jsx("p",{className:"text-xs text-gray-400",children:"    "})]})]}),(n==null?void 0:n.isWhatsappEnabled)!==!1&&r.jsxs("button",{onClick:()=>{s(),t()},className:"w-full flex items-center gap-4 p-4 rounded-2xl bg-green-900/20 hover:bg-green-900/30 transition-colors border border-green-500/20",children:[r.jsx("div",{className:"p-2 bg-green-500/20 rounded-full text-green-400",children:r.jsx(cc,{className:"w-6 h-6"})}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"font-bold text-white",children:""}),r.jsx("p",{className:"text-xs text-gray-400",children:"   "})]})]}),(n==null?void 0:n.isChatEnabled)===!1&&(n==null?void 0:n.isWhatsappEnabled)===!1&&r.jsx("div",{className:"text-center text-gray-500 py-4 bg-gray-900/50 rounded-xl border border-dashed border-gray-700",children:r.jsx("p",{className:"text-sm",children:"     ."})})]}),r.jsx("button",{onClick:s,className:"mt-6 w-full py-3 text-gray-400 font-bold hover:text-white transition-colors",children:""})]})}),lK=({user:s,onClose:e,config:t})=>{const[n,a]=j.useState([]),[l,c]=j.useState(""),[d,f]=j.useState(null),m=j.useRef(null),x=j.useRef(null),y=j.useRef(null),[w,v]=j.useState(null),[T,I]=j.useState(null),[N,P]=j.useState(null),[U,V]=j.useState(!1),q=j.useRef(null);Ht(()=>N?(P(null),!0):w?(v(null),!0):T?(I(null),!0):U?(V(!1),!0):(e(),!0),[N,w,T,U]),j.useEffect(()=>{const X=qn("support_chats",J=>{const O=J.find(K=>K.id===s.id);O?O.messages&&a(O.messages):n.length>0&&(a([]),alert("     ."),e())});ut("support_chats",s.id,{lastUpdated:new Date});const R=setInterval(()=>{ut("support_chats",s.id,{lastUpdated:new Date})},6e4);return()=>{X(),clearInterval(R)}},[s.id]),j.useEffect(()=>{if(n.filter(R=>R.sender==="admin"&&!R.isRead).length>0){const R=n.map(J=>J.sender==="admin"?{...J,isRead:!0}:J);ut("support_chats",s.id,{messages:R})}m.current&&(m.current.scrollTop=m.current.scrollHeight)},[n.length]);const W=async()=>{if(!l.trim()&&!d)return;let X=l;T&&(X=`[ : ${T.text.substring(0,50)+(T.text.length>50?"...":"")}]
${l}`);const R=n.reduce((Q,L)=>{const G=parseInt(L.id);return isNaN(G)?Q:Math.max(Q,G)},0),O={id:String(R+1),text:X,image:d||void 0,sender:"user",createdAt:new Date,isRead:!1},K=[...n,O];a(K),c(""),f(null),I(null),V(!1),await ut("support_chats",s.id,{id:s.id,userId:s.id,userName:s.name,userPhone:s.phone,lastMessage:d?" ":O.text,lastUpdated:new Date,unreadCount:1,messages:K}),Jt("admin",{title:"  ",body:`${s.name}: ${d?" ":X}`,url:"/?target=support"})},z=X=>{var J;const R=(J=X.target.files)==null?void 0:J[0];if(R){const O=new FileReader;O.onloadend=()=>{const K=new Image;K.src=O.result,K.onload=()=>{const Q=document.createElement("canvas"),L=600/K.width;Q.width=600,Q.height=K.height*L;const G=Q.getContext("2d");G==null||G.drawImage(K,0,0,Q.width,Q.height),f(Q.toDataURL("image/jpeg",.7))}},O.readAsDataURL(R)}x.current&&(x.current.value="")},k=X=>{v(X)},M=X=>{q.current=setTimeout(()=>k(X),500)},B=()=>{q.current&&clearTimeout(q.current)},D=async X=>{if(!w)return;const R=w.reactions||[],J=R.includes(X)?R.filter(K=>K!==X):[...R,X],O=n.map(K=>K.id===w.id?{...K,reactions:J}:K);a(O),v(null),await ut("support_chats",s.id,{messages:O})},S=X=>{var J,O;const R=document.querySelectorAll(".message-text");for(let K=0;K<R.length;K++)if((J=R[K].textContent)!=null&&J.includes(X)){R[K].scrollIntoView({behavior:"smooth",block:"center"}),(O=R[K].parentElement)==null||O.classList.add("ring-2","ring-teal-400"),setTimeout(()=>{var Q;return(Q=R[K].parentElement)==null?void 0:Q.classList.remove("ring-2","ring-teal-400")},1500);break}},F=X=>{const R=X.match(/^\[ : (.*?)\]\n(.*)/s);if(R){const J=R[1],O=R[2];return r.jsxs(r.Fragment,{children:[" ",r.jsxs("div",{onClick:K=>{K.stopPropagation(),S(J)},className:"mb-1 pb-1 border-b border-white/10 cursor-pointer active:opacity-70",children:[" ",r.jsxs("p",{className:"text-[10px] text-white/50 line-clamp-1 italic flex items-center gap-1",children:[" ",r.jsx(nd,{className:"w-3 h-3"})," ",J," "]})," "]})," ",r.jsx("span",{className:"message-text",children:O})," "]})}return r.jsx("span",{className:"message-text",children:X})},E=X=>{X.currentTarget.style.display="none"},Y=X=>X.startsWith("http");return r.jsxs("div",{className:"fixed inset-0 z-[90] bg-[#0b141a] flex flex-col animate-slide-up select-none touch-callout-none font-sans",onContextMenu:X=>X.preventDefault(),children:[r.jsx("div",{className:"absolute inset-0 z-0 opacity-[0.06] pointer-events-none",style:{backgroundImage:"url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png')"}}),r.jsx("style",{children:".touch-callout-none { -webkit-touch-callout: none; } .select-none { -webkit-user-select: none; user-select: none; }"}),r.jsx("div",{className:"flex-none bg-[#202c33] border-b border-[#2f3b43] z-20 pt-safe shadow-sm",children:r.jsxs("div",{className:"flex items-center gap-2 px-2 py-2 h-14",children:[r.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-white/10 text-[#aebac1] transition-colors flex items-center justify-center",children:r.jsx(ma,{className:"w-6 h-6 rotate-180"})}),r.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[r.jsx("div",{className:"relative flex-shrink-0",children:r.jsx("div",{className:"w-10 h-10 bg-teal-600 rounded-full flex items-center justify-center text-white",children:r.jsx(Dr,{className:"w-6 h-6"})})}),r.jsxs("div",{className:"flex flex-col justify-center flex-1",children:[r.jsx("h3",{className:"font-bold text-[#e9edef] text-base leading-tight truncate",children:" "}),r.jsx("p",{className:"text-xs text-[#8696a0] truncate",children:"  "})]})]})]})}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-1 relative z-10 custom-scrollbar",ref:m,children:[n.length===0&&r.jsxs("div",{className:"text-center text-[#8696a0] py-4 bg-[#202c33]/80 rounded-lg mx-4 mt-4 shadow-sm text-xs border border-[#2f3b43]",children:[r.jsx("p",{className:"text-[#ffd279] mb-1 font-bold",children:"  "}),r.jsx("p",{children:" !    "})]}),n.map(X=>{const R=X.sender==="user",J=X.image&&Y(X.image);return r.jsxs("div",{className:`flex w-full relative z-10 ${R?"justify-end":"justify-start"} mb-1`,children:[" ",r.jsxs("div",{onTouchStart:()=>M(X),onTouchEnd:B,onMouseDown:()=>M(X),onMouseUp:B,className:`relative max-w-[80%] rounded-lg p-2 px-3 shadow-sm text-sm ${J?"bg-transparent shadow-none":R?"bg-[#005c4b] text-[#e9edef] rounded-tr-none":"bg-[#202c33] text-[#e9edef] rounded-tl-none"}`,children:[" ",X.image&&r.jsxs("div",{className:"mb-1.5 rounded-lg overflow-hidden relative group",children:[" ",r.jsx("img",{src:X.image,alt:"attached",className:J?"w-28 h-28 object-contain cursor-pointer drop-shadow-lg":"w-full h-auto object-cover max-h-64 pointer-events-auto cursor-pointer",onClick:O=>{O.stopPropagation(),P(X.image)}})," "]})," ",X.text&&r.jsx("div",{className:"leading-relaxed whitespace-pre-wrap dir-rtl pt-0.5",children:F(X.text)})," ",r.jsxs("div",{className:`flex items-end justify-between gap-4 mt-1 -mb-1 ml-[-4px] ${J?"text-gray-300":"text-[#8696a0]"}`,children:[" ",r.jsxs("button",{onClick:O=>{O.stopPropagation(),I(X)},className:"opacity-50 hover:opacity-100 transition-opacity p-0.5",children:[" ",r.jsx(nd,{className:"w-3.5 h-3.5"})," "]})," ",r.jsxs("div",{className:"flex items-center gap-1",children:[" ",r.jsx("span",{className:"text-[10px] min-w-fit",children:new Date(X.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})," ",R&&r.jsx("div",{className:"flex -space-x-1 space-x-reverse",children:r.jsx(nt,{className:`w-3.5 h-3.5 ${X.isRead?"text-[#53bdeb]":"text-[#8696a0]"}`})})," "]})," "]})," ",X.reactions&&X.reactions.length>0&&r.jsxs("div",{className:`absolute -bottom-2.5 ${R?"left-0":"right-0"} flex items-center -space-x-1 space-x-reverse`,children:[" ",X.reactions.map((O,K)=>r.jsx("div",{className:"w-5 h-5 rounded-full bg-[#202c33] border border-[#0b141a] shadow-sm flex items-center justify-center p-0.5 scale-110",children:r.jsx("img",{src:O,className:"w-full h-full object-contain"})},K))," "]})," "]})," "]},X.id)})]}),N&&r.jsxs("div",{className:"fixed inset-0 z-[200] bg-black/95 backdrop-blur-md flex items-center justify-center p-4 animate-fadeIn",onClick:()=>P(null),children:[r.jsx("img",{src:N,className:"max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl animate-pop-in",onClick:X=>X.stopPropagation()}),r.jsx("button",{onClick:()=>P(null),className:"absolute top-4 right-4 bg-white/10 text-white p-3 rounded-full hover:bg-white/20 transition-colors",children:r.jsx(rt,{className:"w-6 h-6"})})]}),w&&r.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fadeIn",onClick:()=>v(null),children:[" ",r.jsxs("div",{className:"bg-[#202c33] w-full max-w-sm rounded-2xl border border-[#2f3b43] shadow-2xl p-6 animate-sheet-up",onClick:X=>X.stopPropagation(),children:[" ",r.jsxs("div",{className:"mb-4",children:[" ",r.jsx("p",{className:"text-xs font-bold text-[#8696a0] mb-3 text-center",children:"  "})," ",r.jsxs("div",{className:"flex justify-between gap-2 bg-[#111b21] p-3 rounded-xl border border-[#2f3b43]",children:[" ",O5.slice(0,5).map((X,R)=>r.jsx("button",{onClick:()=>D(X),className:"hover:scale-125 transition-transform p-1",children:r.jsx("img",{src:X,className:"w-8 h-8 object-contain drop-shadow-md"})},R))," "]})," "]})," ",r.jsxs("button",{onClick:()=>{I(w),v(null)},className:"w-full flex items-center gap-3 p-4 bg-[#111b21] hover:bg-[#2a3942] rounded-xl transition-colors border border-[#2f3b43]",children:[" ",r.jsx(nd,{className:"w-5 h-5 text-blue-400"})," ",r.jsx("span",{className:"font-bold text-sm text-[#e9edef]",children:"  "})," "]})," "]})," "]}),r.jsxs("div",{className:"bg-[#202c33] py-2 px-2 z-20 pb-safe relative border-t border-[#2f3b43]",children:[T&&r.jsxs("div",{className:"flex justify-between items-center bg-[#1e2a30] p-2 border-r-4 border-teal-500 mb-2 rounded-lg mx-1",children:[" ",r.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden pr-2",children:[" ",r.jsx("span",{className:"text-teal-500 text-xs font-bold mb-0.5",children:"  "})," ",r.jsx("p",{className:"text-[#aebac1] text-xs truncate",children:T.image?Y(T.image)?"":" ":T.text})," "]})," ",r.jsx("button",{onClick:()=>I(null),className:"p-1 text-[#8696a0] hover:text-white",children:r.jsx(rt,{className:"w-4 h-4"})})," "]}),r.jsxs("div",{className:"flex items-end gap-2 px-1",children:[r.jsxs("div",{className:"flex-1 bg-[#2a3942] rounded-3xl flex items-center px-3 py-1.5 min-h-[45px] border border-transparent focus-within:border-[#00a884] transition-colors",children:[r.jsx("button",{onClick:()=>V(!U),className:"text-[#8696a0] hover:text-[#e9edef] transition-colors p-1",children:r.jsx("span",{className:"text-xl grayscale opacity-70 hover:opacity-100 transition-all",children:""})}),r.jsx("textarea",{ref:y,value:l,onChange:X=>c(X.target.value),placeholder:"",rows:1,className:"flex-1 bg-transparent text-[#e9edef] text-base outline-none resize-none max-h-24 py-1.5 px-2 placeholder-[#8696a0] leading-relaxed",style:{minHeight:"24px"}}),(t==null?void 0:t.allowImageSending)!==!1&&r.jsx("button",{onClick:()=>{var X;return(X=x.current)==null?void 0:X.click()},className:"text-[#8696a0] hover:text-[#e9edef] p-1.5 -rotate-45 transform",children:r.jsx(Ci,{className:"w-6 h-6"})}),r.jsx("input",{ref:x,type:"file",accept:"image/*",className:"hidden",onChange:z})]}),(l.trim()||d)&&r.jsxs("button",{onClick:()=>{(l.trim()||d)&&W()},className:"w-12 h-12 rounded-full flex items-center justify-center shadow-lg active:scale-90 transition-all z-20 bg-[#00a884] hover:bg-[#008f6f] text-white",children:[" ",r.jsx(B5,{className:"w-5 h-5 ml-0.5"})," "]})]}),d&&r.jsx("div",{className:"absolute bottom-20 right-4 bg-[#202c33] p-2 rounded-xl border border-[#2f3b43] shadow-xl animate-pop-in",children:r.jsxs("div",{className:"relative",children:[r.jsx("img",{src:d,className:"h-20 w-20 rounded-lg object-cover"}),r.jsx("button",{onClick:()=>f(null),className:"absolute -top-2 -right-2 bg-[#2a3942] text-[#e9edef] p-1 rounded-full border border-[#8696a0]",children:r.jsx(rt,{className:"w-3 h-3"})})]})}),U&&r.jsxs("div",{className:"mt-2 bg-[#202c33] border border-[#2f3b43] rounded-t-2xl p-3 shadow-2xl grid grid-cols-6 gap-2 h-60 overflow-y-auto custom-scrollbar",children:[" ",O5.map((X,R)=>r.jsx("button",{onClick:()=>{const J=n.reduce((L,G)=>{const ee=parseInt(G.id);return isNaN(ee)?L:Math.max(L,ee)},0),K={id:String(J+1),text:"",image:X,sender:"user",createdAt:new Date,isRead:!1},Q=[...n,K];a(Q),V(!1),ut("support_chats",s.id,{messages:Q,lastMessage:"  ",lastUpdated:new Date,unreadCount:1}),Jt("admin",{title:"  ",body:`${s.name}  `,url:"/?target=support"})},className:"hover:bg-white/5 p-1.5 rounded-xl transition-colors",children:r.jsx("img",{src:X,className:"w-8 h-8 object-contain",onError:E})},R))," "]})]})]})},qu=({icon:s,label:e,subLabel:t,onClick:n,danger:a,hasArrow:l=!0})=>r.jsxs("button",{onClick:n,className:`w-full flex items-center justify-between p-3 transition-all active:bg-black/5 group ${a?"text-red-500":"text-white"}`,children:[" ",r.jsxs("div",{className:"flex items-center gap-4",children:[" ",r.jsxs("div",{className:`p-2 rounded-xl ${a?"bg-red-500/10":"bg-gray-800 text-gray-400 group-hover:text-white transition-colors"}`,children:[" ",s," "]})," ",r.jsxs("div",{className:"text-right",children:[" ",r.jsx("p",{className:`font-bold text-sm ${a?"text-red-500":"text-gray-200"}`,children:e})," ",t&&r.jsx("p",{className:"text-[10px] text-gray-500 mt-0.5",children:t})," "]})," "]})," ",!a&&l&&r.jsx(Gs,{className:"w-4 h-4 text-gray-600 group-hover:text-gray-400 group-hover:-translate-x-1 transition-all"})," "]}),cK=({title:s,content:e,onClose:t})=>r.jsxs("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:t,children:[" ",r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-3xl border border-gray-700 shadow-2xl overflow-hidden animate-pop-in flex flex-col max-h-[80vh]",onClick:n=>n.stopPropagation(),children:[" ",r.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[" ",r.jsx("h3",{className:"text-lg font-bold text-white",children:s})," ",r.jsx("button",{onClick:t,className:"p-2 rounded-full bg-gray-800 text-gray-400 hover:text-white transition-colors",children:r.jsx(rt,{className:"w-5 h-5"})})," "]})," ",r.jsxs("div",{className:"p-6 overflow-y-auto text-gray-300 text-sm leading-relaxed whitespace-pre-wrap",children:[" ",e," "]})," "]})," "]}),uK=({user:s,onClose:e,onUpdate:t})=>{const n=s.addresses&&s.addresses.length>0?s.addresses[0]:s.address||"",[a,l]=j.useState(n),[c,d]=j.useState(!1),[f,m]=j.useState(""),x=()=>{f.trim()&&(l(f),t([f]),d(!1))};return r.jsxs("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:[" ",r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-[2rem] border border-gray-700 shadow-2xl overflow-hidden animate-pop-in flex flex-col",onClick:y=>y.stopPropagation(),children:[" ",r.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[" ",r.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[r.jsx(jn,{className:"w-5 h-5 text-red-500"})," "]})," ",r.jsx("button",{onClick:e,className:"p-2 rounded-full bg-gray-800 text-gray-400 hover:text-white transition-colors",children:r.jsx(rt,{className:"w-5 h-5"})})," "]})," ",r.jsxs("div",{className:"p-6",children:[" ",r.jsx("p",{className:"text-xs text-gray-400 mb-3 font-medium",children:"  (  )"})," ",r.jsxs("div",{className:"bg-[#0f172a] rounded-xl p-4 border border-gray-700 group transition-all hover:border-gray-600 shadow-inner",children:[" ",c?r.jsxs("div",{className:"space-y-3 animate-fade-slide-up",children:[" ",r.jsx("textarea",{value:f,onChange:y=>m(y.target.value),className:"w-full bg-[#1e293b] border border-gray-600 rounded-lg p-3 text-white text-sm focus:border-red-500 outline-none resize-none h-28 leading-relaxed",placeholder:" ...",autoFocus:!0})," ",r.jsxs("div",{className:"flex gap-2",children:[" ",r.jsx("button",{onClick:x,className:"flex-1 bg-green-600 text-white py-2.5 rounded-lg text-xs font-bold hover:bg-green-700 transition-colors shadow-lg",children:" "})," ",r.jsx("button",{onClick:()=>d(!1),className:"flex-1 bg-gray-700 text-gray-300 py-2.5 rounded-lg text-xs font-bold hover:bg-gray-600 transition-colors",children:""})," "]})," "]}):r.jsxs("div",{className:"flex justify-between items-start gap-3",children:[" ",r.jsxs("div",{className:"flex-1",children:[" ",a?r.jsx("p",{className:"text-sm text-gray-200 leading-relaxed font-medium",children:a}):r.jsxs("p",{className:"text-sm text-red-400 italic font-medium flex items-center gap-2",children:[r.jsx(Iv,{className:"w-4 h-4"}),"   "]})," "]})," ",r.jsx("button",{onClick:()=>{d(!0),m(a)},className:"p-2 bg-blue-500/10 text-blue-400 rounded-lg hover:bg-blue-500/20 transition-colors flex-shrink-0",title:" ",children:r.jsx(cr,{className:"w-4 h-4"})})," "]})," "]})," "]})," "]})," "]})},dK=({onClose:s,onSave:e})=>{const[t,n]=j.useState(""),[a,l]=j.useState(""),[c,d]=j.useState(!1),[f,m]=j.useState(""),x=()=>{if(t.length<6){m("     6   ");return}if(t!==a){m("   ");return}e(t),s()};return r.jsxs("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:s,children:[" ",r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-3xl border border-gray-700 shadow-2xl p-6 animate-pop-in",onClick:y=>y.stopPropagation(),children:[" ",r.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"  "})," ",r.jsxs("div",{className:"space-y-3",children:[" ",r.jsxs("div",{className:"relative",children:[" ",r.jsx("input",{type:c?"text":"password",value:t,onChange:y=>n(y.target.value),placeholder:"  ",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3 text-white outline-none focus:border-red-500"})," ",r.jsx("button",{onClick:()=>d(!c),className:"absolute left-3 top-3.5 text-gray-500",children:c?r.jsx(Ui,{className:"w-5 h-5"}):r.jsx(wa,{className:"w-5 h-5"})})," "]})," ",r.jsx("input",{type:"password",value:a,onChange:y=>l(y.target.value),placeholder:"  ",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3 text-white outline-none focus:border-red-500"})," ",f&&r.jsx("p",{className:"text-red-400 text-xs font-bold",children:f})," ",r.jsx("button",{onClick:x,className:"w-full bg-red-600 text-white font-bold py-3 rounded-xl hover:bg-red-700 transition-colors",children:""})," "]})," "]})," "]})},hK=({user:s,onClose:e,onSave:t})=>{const[n,a]=j.useState(s.name),[l,c]=j.useState(s.phone||""),[d,f]=j.useState(s.storeImage||null),m=j.useRef(null),x=y=>{var v;const w=(v=y.target.files)==null?void 0:v[0];if(w){const T=new FileReader;T.onloadend=()=>{const I=new Image;I.src=T.result,I.onload=()=>{const N=document.createElement("canvas"),P=1024,U=P/I.width;N.width=P,N.height=I.height*U;const V=N.getContext("2d");V&&(V.imageSmoothingEnabled=!0,V.imageSmoothingQuality="high",V.drawImage(I,0,0,N.width,N.height),f(N.toDataURL("image/jpeg",.9)))}},T.readAsDataURL(w)}};return r.jsxs("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:[" ",r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-[2rem] border border-gray-700 shadow-2xl overflow-hidden animate-pop-in",onClick:y=>y.stopPropagation(),children:[" ",r.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[" ",r.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[r.jsx(on,{className:"w-5 h-5 text-blue-500"})," "]})," ",r.jsx("button",{onClick:e,className:"p-1.5 rounded-full bg-gray-800 text-gray-400 hover:text-white transition-colors",children:r.jsx(rt,{className:"w-5 h-5"})})," "]})," ",r.jsxs("div",{className:"p-6 space-y-5",children:[" ",r.jsxs("div",{className:"flex flex-col items-center mb-2",children:[" ",r.jsxs("div",{className:"relative cursor-pointer group",onClick:()=>{var y;return(y=m.current)==null?void 0:y.click()},children:[" ",r.jsxs("div",{className:"w-24 h-24 rounded-full overflow-hidden border-4 border-[#0f172a] shadow-lg relative bg-gray-800 flex items-center justify-center",children:[" ",d?r.jsx("img",{src:d,alt:"Profile",className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-10 h-10 text-gray-500"})," ",r.jsxs("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:[" ",r.jsx(ga,{className:"w-8 h-8 text-white"})," "]})," "]})," ",r.jsxs("div",{className:"absolute bottom-0 right-0 bg-blue-600 rounded-full p-1.5 border-2 border-[#1e293b] shadow-md",children:[" ",r.jsx(ga,{className:"w-4 h-4 text-white"})," "]})," "]})," ",r.jsx("input",{ref:m,type:"file",accept:"image/*",className:"hidden",onChange:x})," ",r.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"  "})," "]})," ",r.jsxs("div",{children:[" ",r.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2",children:" "})," ",r.jsxs("div",{className:"relative",children:[" ",r.jsx("input",{type:"text",value:n,onChange:y=>a(y.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3 text-white outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all pl-10"})," ",r.jsx(pt,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500"})," "]})," "]})," ",r.jsxs("div",{children:[" ",r.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2",children:" "})," ",r.jsxs("div",{className:"relative",children:[" ",r.jsx("input",{type:"tel",value:l,onChange:y=>c(y.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3 text-white outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all pl-10 text-right placeholder:text-right font-mono",dir:"rtl"})," ",r.jsx(Js,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500"})," "]})," ",r.jsx("p",{className:"text-[10px] text-yellow-500/80 mt-2 bg-yellow-500/10 p-2 rounded-lg border border-yellow-500/20",children:":         ."})," "]})," ",r.jsx("button",{onClick:()=>t(n,l,d||void 0),className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white font-bold py-3.5 rounded-xl shadow-lg active:scale-95 transition-all mt-2",children:" "})," "]})," "]})," "]})},fK=({type:s,onClose:e})=>r.jsxs("div",{className:"fixed inset-0 z-[80] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:[" ",r.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-[2rem] border border-gray-700 shadow-2xl p-8 text-center animate-pop-in",onClick:t=>t.stopPropagation(),children:[" ",r.jsxs("div",{className:`w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg ${s==="success"?"bg-green-500/20 text-green-500 ring-4 ring-green-500/10":"bg-yellow-500/20 text-yellow-500 ring-4 ring-yellow-500/10"}`,children:[" ",s==="success"?r.jsx(nt,{className:"w-10 h-10 animate-pulse"}):r.jsx(wt,{className:"w-10 h-10 animate-pulse"})," "]})," ",r.jsx("h3",{className:"text-xl font-black text-white mb-2",children:s==="success"?"  ":"  "})," ",r.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-8",children:s==="success"?"      .":"        .      ."})," ",r.jsx("button",{onClick:e,className:`w-full font-bold py-3.5 rounded-xl shadow-lg active:scale-95 transition-all text-white ${s==="success"?"bg-green-600 hover:bg-green-500":"bg-gray-700 hover:bg-gray-600"}`,children:" "})," "]})," "]}),mK=({user:s,merchants:e,orders:t,onPlaceOrder:n,onLogout:a,onDeleteOrder:l,sliderImages:c,sliderConfig:d,messages:f,markMessageAsSeen:m,hideMessage:x,seenMessageIds:y,deletedMessageIds:w,onUpdateUser:v,adminUser:T,appTheme:I,onUpdateTheme:N,promoCodes:P,pointsConfig:U,initialRoute:V,appConfig:q})=>{const[W,z]=j.useState("landing"),[k,M]=j.useState(null),[B,D]=j.useState([]),[S,F]=j.useState(()=>{try{return JSON.parse(localStorage.getItem("favoriteProductIds")||"[]")}catch{return[]}}),[E,Y]=j.useState(!1),[X,R]=j.useState(!1),[J,O]=j.useState({title:"",desc:""}),[K,Q]=j.useState(null),[L,G]=j.useState(!1),[ee,ne]=j.useState(null),[je,se]=j.useState(!1),_e=j.useRef(null),[Te,be]=j.useState(!1),[ye,et]=j.useState(!1),[Je,bt]=j.useState(void 0),[yt,Ae]=j.useState(void 0),[fe,$e]=j.useState([]),ce=(q==null?void 0:q.appVersion)||"VERSION 1.0.5",Oe=(q==null?void 0:q.appName)||"GOO NOW";j.useEffect(()=>{const he=qn("support_chats",ze=>{const tt=ze.find(Se=>Se.id===s.id);if(tt&&tt.messages){const Se=tt.messages.filter(Fe=>Fe.sender==="admin"&&!Fe.isRead);$e(Se)}}),Me=qn("settings",ze=>{const tt=ze.find(Se=>Se.id==="support_config");tt&&bt(tt)});return()=>{he(),Me()}},[s.id]),j.useEffect(()=>{Is.reportContext(W)},[W]);const Pe={bg:"bg-[#1A1A1A]",text:"text-white",navBg:"bg-[#1A1A1A]/90",navBorder:"border-white/10"};j.useEffect(()=>{wm("user",s.id)},[s.id]),Ht(()=>ye?(et(!1),!0):Te?(be(!1),!0):ee?(ne(null),!0):L?(G(!1),!0):je?(se(!1),!0):K?(Q(null),!0):E?(Y(!1),!0):X?(R(!1),!0):W==="store"?(M(null),z("store-list"),!0):W==="cart"||W==="favorites"||W==="messages"||W==="special-request"||W==="coming-soon"||W==="store-list"||W==="profile"?(z("landing"),!0):W==="landing"?!1:(z("landing"),!0),[W,E,X,K,L,je,ee,ye,Te]);const Ge=j.useMemo(()=>{if(!s.phone)return[];const he=s.phone.trim();return t.filter(Me=>{var tt,Se;return((Se=(tt=Me.customer)==null?void 0:tt.phone)==null?void 0:Se.trim())===he})},[t,s.phone]),Ke=(he,Me)=>{M(he),Me&&Ae(Me),z("store")},Ie=(he,Me)=>{const ze=Me?`${he.id}-${Me.name}`:he.id;D(tt=>tt.find(Fe=>Fe.id===ze)?tt.map(Fe=>Fe.id===ze?{...Fe,quantity:Fe.quantity+1}:Fe):[...tt,{...he,id:ze,quantity:1,merchantId:k==null?void 0:k.id,selectedSize:Me}])},Le=he=>{F(Me=>{const ze=Me.includes(he)?Me.filter(tt=>tt!==he):[...Me,he];return localStorage.setItem("favoriteProductIds",JSON.stringify(ze)),ze})},Lt=(he,Me,ze,tt)=>{var it;const Se=B.length===0,Fe={id:Date.now().toString(),customer:{phone:ze||s.phone||"",address:Me,name:s.name},merchantId:Se?"delinow":B[0].merchantId||"",merchantName:Se?" ":((it=e.find(at=>at.id===B[0].merchantId))==null?void 0:it.name)||"",status:Se?ue.Pending:ue.WaitingMerchant,createdAt:new Date,notes:he,type:"shopping_order"};Se||(Fe.items=[...B],Fe.totalPrice=B.reduce((at,Gt)=>at+Gt.price*Gt.quantity,0),tt&&Object.assign(Fe,tt)),n(Fe),D([]),z("orders")},bs=(he,Me)=>{he==="ride"?(O({title:" ",desc:"           ."}),z("coming-soon")):he==="transport"?(O({title:" ",desc:"       ."}),z("coming-soon")):z(he)},Zt=he=>{var ze;const Me=(ze=he.target.files)==null?void 0:ze[0];if(Me){const tt=new FileReader;tt.onloadend=()=>{const Se=new Image;Se.src=tt.result,Se.onload=()=>{const Fe=document.createElement("canvas"),it=1024,at=it/Se.width;Fe.width=it,Fe.height=Se.height*at;const Gt=Fe.getContext("2d");if(Gt){Gt.imageSmoothingEnabled=!0,Gt.imageSmoothingQuality="high",Gt.drawImage(Se,0,0,Fe.width,Fe.height);const Ks=Fe.toDataURL("image/jpeg",.9);v(s.id,{storeImage:Ks})}}},tt.readAsDataURL(Me)}},Ws=(he,Me,ze)=>{if(Me!==s.phone)Jt("admin",{title:"   ",body:` ${s.name}     ${s.phone}  ${Me}`,url:"/?target=users"}),Jt("supervisor",{title:"   ",body:` ${s.name}     ${s.phone}  ${Me}`,url:"/?target=users"}),ne("pending");else if(he!==s.name||ze&&ze!==s.storeImage){const tt={name:he};ze&&(tt.storeImage=ze),v(s.id,tt),ne("success")}Y(!1)},Ds=()=>{const he=(Je==null?void 0:Je.whatsappNumber)||"201000000000";window.open(`https://wa.me/${he}`,"_blank")},En=()=>r.jsx("nav",{className:`fixed left-4 right-4 ${Pe.navBg} backdrop-blur-xl border ${Pe.navBorder} rounded-[2rem] flex justify-between items-center h-[60px] z-50 shadow-2xl px-4`,style:{bottom:"calc(3rem + env(safe-area-inset-bottom))"},children:[{id:"landing",icon:Ev,label:""},{id:"orders",icon:Wn,label:""},{id:"cart",icon:Nn,label:"",badge:B.length},{id:"profile",icon:pt,label:""}].map(he=>r.jsxs("button",{onClick:()=>z(he.id),className:`relative flex flex-col items-center transition-all ${W===he.id?"text-red-500 -translate-y-2":"text-gray-400"}`,children:[r.jsx("div",{className:`p-2 rounded-full ${W===he.id?"bg-[#1A1A1A] ring-4 ring-[#252525]":""}`,children:r.jsx(he.icon,{className:"w-5 h-5"})}),he.badge?r.jsx("span",{className:"absolute -top-1 -right-1 bg-red-600 text-white text-[8px] rounded-full w-3.5 h-3.5 flex items-center justify-center",children:he.badge}):null]},he.id))}),hr=he=>{if(he!=null&&he.startsWith("data:")||he!=null&&he.startsWith("http"))return"p-0";switch(he){case"gold":return"p-[4px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_15px_rgba(252,246,186,0.5)]";case"neon":return"p-[4px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_15px_rgba(34,211,238,0.6)]";case"royal":return"p-[4px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-xl border border-purple-500/30";case"fire":return"p-[4px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_15px_rgba(239,68,68,0.5)]";default:return"p-0"}},we=he=>{if(!he||he==="none")return null;if(he!=null&&he.startsWith("data:")||he!=null&&he.startsWith("http"))return r.jsx("div",{className:"w-8 h-8 min-w-[2rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:r.jsx("img",{src:he,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let Me=null,ze="";switch(he){case"verified":Me=qi,ze="text-blue-400 fill-blue-500/20";break;case"vip":Me=va,ze="text-yellow-400 fill-yellow-500/20";break;case"star":Me=Rr,ze="text-purple-400 fill-purple-500/20";break;case"popular":Me=zt,ze="text-red-400 fill-red-500/20";break}return Me?r.jsx(Me,{className:`w-4 h-4 ml-1 ${ze}`}):null},pe=he=>(he==null?void 0:he.startsWith("data:"))||(he==null?void 0:he.startsWith("http")),Re=j.useMemo(()=>f.filter(he=>!w.includes(he.id)&&!y.includes(he.id)&&(he.targetId==="all"||he.targetId===s.id)).length,[f,y,w,s.id]);return r.jsxs("div",{className:`fixed inset-0 h-[100dvh] ${Pe.bg} ${Pe.text} flex flex-col transition-colors duration-300`,dir:"rtl",children:[r.jsx("div",{className:"flex-1 relative flex flex-col overflow-hidden bg-[#1A1A1A]",children:r.jsxs("div",{className:"flex-1 flex flex-col h-full animate-page-enter",children:[W==="landing"&&r.jsx(KW,{user:s,onNavigate:bs,sliderImages:c,sliderConfig:d,adminUser:T,merchants:e,messageCount:Re,onOpenMessages:()=>z("messages"),onOpenSupport:()=>et(!0),unreadSupportCount:fe.length}),W==="store-list"&&r.jsx(XW,{user:s,merchants:e,onSelectMerchant:Ke,sliderImages:c,sliderConfig:d,onSpecialRequest:()=>z("special-request"),onOpenFavorites:()=>z("favorites"),adminUser:T,theme:I,messageCount:Re,onOpenMessages:()=>z("messages"),onOpenSupport:()=>et(!0),unreadSupportCount:fe.length}),W==="store"&&k&&r.jsx(eK,{merchant:k,onBack:()=>z("store-list"),addToCart:Ie,cart:B,onViewCart:()=>z("cart"),toggleFavorite:Le,favoriteIds:S,appTheme:I,initialCategory:yt}),W==="cart"&&r.jsx(tK,{cart:B,onBack:()=>z("landing"),onGoToStores:()=>z("store-list"),onUpdateQuantity:(he,Me)=>D(ze=>ze.map(tt=>tt.id===he?{...tt,quantity:Math.max(1,tt.quantity+Me)}:tt)),onRemoveItem:he=>D(Me=>Me.filter(ze=>ze.id!==he)),onPlaceOrder:Lt,userPhone:s.phone||"",savedAddresses:s.addresses,appTheme:I,promoCodes:P,userPoints:s.pointsBalance||0,pointsConfig:U}),W==="profile"&&r.jsxs("div",{className:"h-full overflow-y-auto bg-[#121212] pb-24",children:[r.jsxs("div",{className:"relative h-36 bg-gradient-to-br from-[#1e1e1e] to-[#121212]",children:[r.jsx("div",{className:"absolute inset-0 bg-pattern opacity-10"}),r.jsx("div",{className:"absolute -bottom-10 left-1/2 -translate-x-1/2",children:r.jsx("div",{className:"relative",children:r.jsxs("div",{className:`relative w-24 h-24 flex items-center justify-center rounded-full ${pe(s.specialFrame)?"":hr(s.specialFrame)}`,children:[pe(s.specialFrame)&&r.jsx("img",{src:s.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.7] pointer-events-none",alt:"frame"}),r.jsxs("div",{className:`${pe(s.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full overflow-hidden bg-[#252525] border-4 border-[#121212] flex items-center justify-center shadow-2xl relative z-0`,children:[s.storeImage?r.jsx("img",{src:s.storeImage,alt:s.name,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-8 h-8 text-gray-500"}),r.jsx("button",{onClick:()=>{var he;return(he=_e.current)==null?void 0:he.click()},className:"absolute bottom-0 right-0 bg-[#252525] p-1 rounded-full border-2 border-[#121212] text-gray-400 active:scale-90 hover:text-white transition-all",children:r.jsx(ga,{className:"w-3 h-3"})}),r.jsx("input",{ref:_e,type:"file",accept:"image/*",className:"hidden",onChange:Zt})]})]})})})]}),r.jsxs("div",{className:"pt-12 px-5 text-center",children:[r.jsxs("div",{className:"flex items-center justify-center gap-2 mb-0.5",children:[r.jsx("h2",{className:"text-lg font-bold text-white",children:s.name}),we(s.specialBadge)]}),r.jsx("p",{className:"text-gray-500 text-xs font-mono mb-4",children:s.phone}),r.jsxs("div",{className:"flex justify-center gap-2 mb-6",children:[r.jsxs("div",{className:`bg-[#1E1E1E] rounded-xl p-2 border border-white/5 shadow-sm ${(U==null?void 0:U.isPointsEnabled)===!0?"flex-1":"w-full"}`,children:[r.jsx("p",{className:"text-[9px] text-gray-500 mb-0.5",children:""}),r.jsx("p",{className:"text-base font-black text-white",children:Ge.filter(he=>he.status===ue.Delivered).length})]}),(U==null?void 0:U.isPointsEnabled)===!0&&r.jsxs("div",{className:"flex-1 bg-[#1E1E1E] rounded-xl p-2 border border-white/5 shadow-sm",children:[r.jsx("p",{className:"text-[9px] text-gray-500 mb-0.5",children:""}),r.jsx("p",{className:"text-base font-black text-yellow-500",children:s.pointsBalance||0})]})]}),r.jsxs("div",{className:"space-y-3 text-right",children:[r.jsxs("button",{onClick:()=>be(!0),className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white font-bold p-3 rounded-2xl shadow-lg shadow-blue-900/20 flex items-center justify-between mb-3 active:scale-[0.98] transition-all",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-1.5 rounded-lg bg-white/20 text-white",children:r.jsx(Dr,{className:"w-5 h-5"})}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"font-bold text-sm",children:" "}),r.jsx("p",{className:"text-[9px] text-blue-200",children:"  "})]})]}),r.jsx(Gs,{className:"w-4 h-4 text-blue-200"})]}),r.jsxs("div",{className:"bg-[#1E1E1E] rounded-2xl overflow-hidden border border-white/5",children:[r.jsx(qu,{icon:r.jsx(on,{className:"w-4 h-4"}),label:" ",onClick:()=>Y(!0)}),r.jsx("div",{className:"h-px bg-white/5 mx-4"}),r.jsx(qu,{icon:r.jsx(wa,{className:"w-4 h-4"}),label:"  ",onClick:()=>se(!0)}),r.jsx("div",{className:"h-px bg-white/5 mx-4"}),r.jsx(qu,{icon:r.jsx(jn,{className:"w-4 h-4"}),label:" ",onClick:()=>R(!0)})]}),r.jsxs("div",{className:"bg-[#1E1E1E] rounded-2xl overflow-hidden border border-white/5",children:[r.jsx(qu,{icon:r.jsx(Yr,{className:"w-4 h-4"}),label:" ",onClick:()=>Q({title:" ",content:"..."})}),r.jsx("div",{className:"h-px bg-white/5 mx-4"}),r.jsx(qu,{icon:r.jsx(Wn,{className:"w-4 h-4"}),label:" ",onClick:()=>Q({title:" ",content:"..."})})]}),r.jsx("div",{className:"bg-[#1E1E1E] rounded-2xl overflow-hidden border border-white/5 mt-4",children:r.jsx(qu,{icon:r.jsx(bm,{className:"w-4 h-4"}),label:" ",danger:!0,onClick:()=>G(!0)})}),r.jsxs("p",{className:"text-center text-[9px] text-gray-700 mt-4 font-mono",children:[Oe," ",ce]})]})]})]}),W==="orders"&&r.jsx(sK,{orders:Ge,onDeleteOrder:l,appTheme:I}),W==="messages"&&r.jsx(nK,{messages:f.filter(he=>!w.includes(he.id)&&(he.targetId==="all"||he.targetId===s.id)),onMarkAsSeen:m,hideMessage:x,appTheme:I}),W==="special-request"&&r.jsx(rK,{user:s,onBack:()=>z("landing"),onPlaceOrder:Lt,appTheme:I}),W==="favorites"&&r.jsx(aK,{merchants:e,favoriteIds:S,toggleFavorite:Le,addToCart:(he,Me)=>{M(Me),Ie(he)},onBack:()=>z("store-list"),appTheme:I}),W==="coming-soon"&&r.jsx(iK,{title:J.title,description:J.desc,onBack:()=>z("landing")})]},W)}),K&&r.jsx(cK,{title:K.title,content:K.content,onClose:()=>Q(null)}),E&&r.jsx(hK,{user:s,onClose:()=>Y(!1),onSave:Ws}),ee&&r.jsx(fK,{type:ee,onClose:()=>ne(null)}),je&&r.jsx(dK,{onClose:()=>se(!1),onSave:he=>v(s.id,{password:he})}),X&&r.jsx(uK,{user:s,onClose:()=>R(!1),onUpdate:he=>v(s.id,{addresses:he})}),Te&&r.jsx(oK,{onClose:()=>be(!1),onOpenChat:()=>et(!0),onOpenWhatsapp:Ds,config:Je}),ye&&r.jsx(lK,{user:s,onClose:()=>et(!1),config:Je}),L&&r.jsx(os,{title:" ",message:"      ",onClose:()=>G(!1),onConfirm:()=>{G(!1),a()},confirmButtonText:" ",cancelButtonText:"",confirmVariant:"danger"}),W!=="store"&&W!=="special-request"&&W!=="coming-soon"&&En()]})},za=({icon:s,label:e,onClick:t,isActive:n,danger:a})=>r.jsxs("button",{onClick:t,className:`w-full flex items-center gap-4 p-4 rounded-2xl transition-all duration-300 group relative overflow-hidden active:scale-95 mb-2 ${a?"text-red-400 hover:bg-red-500/10":n?"bg-cyan-600/20 text-white border border-cyan-500/30 shadow-[0_0_15px_rgba(6,182,212,0.1)]":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[n&&r.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 bg-cyan-500 rounded-l-full"}),r.jsx("div",{className:`relative z-10 transition-transform group-hover:scale-110 duration-300 ${n?"text-cyan-400":""}`,children:s}),r.jsx("span",{className:`relative z-10 font-bold text-sm ${n?"translate-x-1":""} transition-transform duration-300`,children:e})]}),gK=s=>{var K;const e=s.user.permissions||[],[t,n]=j.useState(!1),[a,l]=j.useState(null),[c,d]=j.useState(null),[f,m]=j.useState(null),[x,y]=j.useState(null),[w,v]=j.useState(null),T=j.useMemo(()=>s.users.filter(Q=>Q.role==="merchant"),[s.users]),I=j.useMemo(()=>s.users.filter(Q=>Q.role==="driver"),[s.users]),[N,P]=j.useState(!0),U=s.users.filter(Q=>Q.status==="pending"&&Q.role!=="admin").length,V=s.orders.filter(Q=>Q.status===ue.Pending&&!Q.driverId).length,q=U+s.passwordResetRequests.length+V,W=()=>e.includes("manage_orders")||e.includes("view_orders")?"orders":e.includes("view_reports")?"reports":e.includes("view_users")?"users":e.includes("send_messages")?"messages":e.includes("manage_support")?"support":e.includes("manage_decorations")?"customizer":"orders",[z,k]=j.useState(W());Ht(()=>t?(n(!1),!0):c?(d(null),!0):f?(m(null),!0):x?(y(null),!0):w?(v(null),!0):a?(l(null),!0):z==="add_order"||z==="notifications"||z!=="orders"&&(e.includes("view_orders")||e.includes("manage_orders"))?(k("orders"),!0):!1,[z,a,c,f,x,w,e,t]);const M=async(Q,L)=>{if(!e.includes("manage_orders"))return;const G=s.orders.filter(ne=>ne.status===ue.Pending&&!ne.driverId);if(G.length===0)return;const ee=G.map(ne=>({...ne,driverId:Q,deliveryFee:L,status:ue.InTransit}));await s.onBulkUpdate(ee),s.showNotification(`  ${ee.length}   `,"success")},B=async Q=>{if(!e.includes("delete_orders"))return;const L=Q==="all"?s.orders:s.orders.filter(G=>G.status===Q);if(L.length!==0){for(const G of L)await s.deleteOrder(G.id);s.showNotification(`  ${L.length}  `,"success")}},D=()=>{switch(z){case"orders":return e.includes("view_orders")||e.includes("manage_orders")?r.jsx(q5,{...s,permissions:e,onNavigateToAdd:()=>k("add_order"),onOpenStatusModal:e.includes("manage_orders")?d:void 0,onBulkAssign:e.includes("manage_orders")?M:void 0,onBulkDelete:e.includes("delete_orders")?B:void 0}):null;case"reports":return e.includes("view_reports")?r.jsx(J5,{orders:s.orders,users:s.users,payments:s.payments,currentUser:s.user}):null;case"add_order":return r.jsx(AR,{merchants:T,onClose:()=>k("orders"),onSave:async L=>{await s.adminAddOrder(L)}});case"notifications":return r.jsx(K5,{users:s.users.filter(L=>L.role!=="admin"),updateUser:s.updateUser,onDeleteUser:s.deleteUser,passwordResetRequests:s.passwordResetRequests,resolvePasswordResetRequest:s.resolvePasswordResetRequest,setEditingUser:l,pendingOrders:s.orders.filter(L=>L.status===ue.Pending&&!L.driverId),onNavigateToOrders:()=>k("orders")});case"users":const Q=s.users.filter(L=>L.role!=="admin");return e.includes("view_users")||e.includes("manage_users")?r.jsx(H5,{...s,users:Q,onAdminAddUser:s.adminAddUser,onDeleteUser:s.deleteUser,permissions:e,setEditingUser:l,currentUser:s.user}):null;case"stores":return e.includes("manage_stores")?r.jsx(W5,{users:s.users,orders:s.orders,updateUser:s.updateUser}):null;case"slider":return e.includes("manage_slider")?r.jsx(IR,{images:s.sliderImages,isEnabled:s.sliderConfig.isEnabled,onAddImage:s.onAddSliderImage,onDeleteImage:s.onDeleteSliderImage,onUpdateImage:s.onUpdateSliderImage,onToggleSlider:s.onToggleSlider,merchants:T,adminUser:void 0}):null;case"wallet":return e.includes("view_wallet")?r.jsx(Q5,{...s}):null;case"logs":return e.includes("view_logs")?r.jsx(DR,{logs:s.auditLogs,onClearLogs:()=>{}}):null;case"loyalty":return e.includes("manage_promo")?r.jsx(OR,{promoCodes:s.promoCodes,pointsConfig:s.pointsConfig,onAddPromo:s.onAddPromo,onDeletePromo:s.onDeletePromo,onUpdatePointsConfig:s.onUpdatePointsConfig}):null;case"messages":return e.includes("send_messages")?r.jsx(Y5,{users:s.users.filter(L=>L.role!=="admin"),onSendMessage:s.sendMessage,messages:s.messages,deleteMessage:s.deleteMessage}):null;case"support":return e.includes("manage_support")?r.jsx(PR,{users:s.users,isRestricted:!0,currentUser:s.user}):null;case"customizer":return e.includes("manage_decorations")&&s.currentTheme&&s.onUpdateTheme?r.jsx(RR,{onClose:()=>k("orders"),currentTheme:s.currentTheme,onUpdateTheme:s.onUpdateTheme,users:s.users,onUpdateUser:s.updateUser,sendNotification:Jt,currentUser:s.user}):null;default:return null}},S=[{id:"orders",condition:e.includes("view_orders")||e.includes("manage_orders")},{id:"users",condition:e.includes("view_users")||e.includes("manage_users")},{id:"wallet",condition:e.includes("view_wallet")},{id:"stores",condition:e.includes("manage_stores")},{id:"slider",condition:e.includes("manage_slider")},{id:"messages",condition:e.includes("send_messages")},{id:"support",condition:e.includes("manage_support")},{id:"customizer",condition:e.includes("manage_decorations")}].filter(Q=>Q.condition).map(Q=>Q.id),F=((K=s.appConfig)==null?void 0:K.appName)||"GOO NOW",[E,...Y]=F.split(" "),X=Y.join(" "),R=Q=>{if(Q!=null&&Q.startsWith("data:")||Q!=null&&Q.startsWith("http"))return"p-0";switch(Q){case"gold":return"p-[3px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[3px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[3px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[3px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-[2px] bg-gradient-to-br from-cyan-500 to-blue-600"}},J=Q=>(Q==null?void 0:Q.startsWith("data:"))||(Q==null?void 0:Q.startsWith("http")),O=Q=>{if(!Q||Q==="none")return null;if(Q!=null&&Q.startsWith("data:")||Q!=null&&Q.startsWith("http"))return r.jsx("div",{className:"w-8 h-8 min-w-[2rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:r.jsx("img",{src:Q,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let L=null,G="";switch(Q){case"verified":L=qi,G="text-blue-400 fill-blue-500/20";break;case"vip":L=va,G="text-yellow-400 fill-yellow-500/20";break;case"star":L=Rr,G="text-purple-400 fill-purple-500/20";break;case"popular":L=zt,G="text-red-400 fill-red-500/20";break;case"admin-badge":L=on,G="text-red-500";break;case"mod-badge":L=Yr,G="text-green-500";break}return L?r.jsx(L,{className:`w-5 h-5 ${G}`}):null};return r.jsxs("div",{className:"flex flex-col h-screen bg-gray-900 text-white overflow-hidden",children:[t&&r.jsxs("div",{className:"fixed inset-0 z-[60] flex justify-start animate-fadeIn",dir:"rtl",children:[r.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-md transition-all duration-500",onClick:()=>n(!1)}),r.jsxs("div",{className:"w-[290px] h-full bg-[#111827]/60 backdrop-blur-3xl border-l border-white/10 shadow-2xl relative flex flex-col z-10 pt-safe rounded-l-[40px] overflow-hidden transform animate-slide-in-right",children:[r.jsxs("div",{className:"p-8 border-b border-white/5 relative flex flex-col items-center",children:[r.jsx("button",{onClick:()=>n(!1),className:"absolute top-4 left-4 p-2 rounded-full bg-white/5 hover:bg-white/10 text-gray-400 active:scale-90",children:r.jsx(rt,{className:"w-5 h-5"})}),r.jsxs("button",{onClick:()=>{l(s.user),n(!1)},className:`w-24 h-24 rounded-full flex items-center justify-center shadow-2xl mb-4 relative group/avatar cursor-pointer transition-transform active:scale-95 ${J(s.user.specialFrame)?"":R(s.user.specialFrame)}`,children:[J(s.user.specialFrame)&&r.jsx("img",{src:s.user.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.65] pointer-events-none",alt:"frame"}),r.jsxs("div",{className:`${J(s.user.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-gray-900 overflow-hidden border-2 border-white/10 flex items-center justify-center relative z-0`,children:[s.user.storeImage?r.jsx("img",{src:s.user.storeImage,className:"w-full h-full object-cover"}):r.jsx(pt,{className:"w-10 h-10 text-gray-500"}),r.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover/avatar:opacity-100 transition-opacity",children:r.jsx(on,{className:"w-6 h-6 text-white"})})]})]}),r.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[r.jsx("h3",{className:"font-black text-xl tracking-tight text-white",children:s.user.name}),O(s.user.specialBadge)]}),r.jsx("p",{className:"text-[10px] font-bold text-cyan-400 uppercase tracking-[0.2em] mt-1",children:"Supervisor"})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-1 custom-scrollbar",children:[e.includes("view_reports")&&r.jsx(za,{icon:r.jsx(ym,{className:"w-5 h-5"}),label:" ",onClick:()=>{k("reports"),n(!1)},isActive:z==="reports"}),e.includes("manage_support")&&r.jsx(za,{icon:r.jsx(Dr,{className:"w-5 h-5"}),label:" ",onClick:()=>{k("support"),n(!1)},isActive:z==="support"}),e.includes("view_users")&&r.jsx(za,{icon:r.jsx(Vd,{className:"w-5 h-5"}),label:"",onClick:()=>{k("users"),n(!1)},isActive:z==="users"}),e.includes("manage_stores")&&r.jsx(za,{icon:r.jsx(lr,{className:"w-5 h-5"}),label:" ",onClick:()=>{k("stores"),n(!1)},isActive:z==="stores"}),e.includes("manage_slider")&&r.jsx(za,{icon:r.jsx(Qr,{className:"w-5 h-5"}),label:" ",onClick:()=>{k("slider"),n(!1)},isActive:z==="slider"}),e.includes("send_messages")&&r.jsx(za,{icon:r.jsx(kr,{className:"w-5 h-5"}),label:"",onClick:()=>{k("messages"),n(!1)},isActive:z==="messages"}),e.includes("view_logs")&&r.jsx(za,{icon:r.jsx(Yr,{className:"w-5 h-5"}),label:" ",onClick:()=>{k("logs"),n(!1)},isActive:z==="logs"}),e.includes("manage_promo")&&r.jsx(za,{icon:r.jsx(R0,{className:"w-5 h-5"}),label:"",onClick:()=>{k("loyalty"),n(!1)},isActive:z==="loyalty"}),e.includes("manage_decorations")&&r.jsx(za,{icon:r.jsx(Av,{className:"w-5 h-5"}),label:" ",onClick:()=>{k("customizer"),n(!1)},isActive:z==="customizer"})]}),r.jsx("div",{className:"p-6 border-t border-white/5 bg-black/20 pb-safe",children:r.jsx(za,{icon:r.jsx(bm,{className:"w-5 h-5"}),label:" ",onClick:s.onLogout,danger:!0})})]})]}),z!=="add_order"&&r.jsx("header",{className:"bg-gray-800/95 backdrop-blur-md border-b border-cyan-500/30 sticky top-0 z-30 shadow-lg transition-all duration-300 pt-safe rounded-b-[35px] mx-2 mt-1",children:r.jsxs("div",{className:"max-w-7xl mx-auto py-3 px-4 flex justify-between items-center relative h-14",children:[r.jsx("button",{onClick:()=>n(!0),className:"flex items-center gap-3 active:scale-90 transition-transform",children:r.jsxs("div",{className:`relative w-10 h-10 flex items-center justify-center rounded-full shadow-lg ${J(s.user.specialFrame)?"":R(s.user.specialFrame)}`,children:[J(s.user.specialFrame)&&r.jsx("img",{src:s.user.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.5] pointer-events-none",alt:"frame"}),r.jsx("div",{className:`${J(s.user.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-gray-900 flex items-center justify-center overflow-hidden relative z-0`,children:s.user.storeImage?r.jsx("img",{src:s.user.storeImage,className:"w-full h-full object-cover"}):r.jsx("div",{className:"text-cyan-500 font-bold text-sm",children:s.user.name.charAt(0)})})]})}),r.jsxs("h1",{className:"text-2xl font-black absolute left-1/2 -translate-x-1/2 select-none",children:[r.jsx("span",{className:"text-red-600",children:E}),r.jsx("span",{className:"text-white ml-1",children:X})]}),r.jsx("div",{className:"flex items-center gap-1",children:r.jsxs("button",{onClick:()=>k("notifications"),className:"relative p-2.5 rounded-xl bg-cyan-500/10 hover:bg-cyan-500/20 transition-colors",children:[r.jsx(an,{className:`w-6 h-6 ${q>0?"text-yellow-500":"text-gray-400"}`}),q>0&&r.jsx("span",{className:"absolute top-1.5 right-1.5 w-4 h-4 flex items-center justify-center bg-red-600 text-[9px] font-bold text-white rounded-full ring-2 ring-gray-800 animate-pulse",children:q})]})})]})}),r.jsx("main",{className:z==="add_order"?"flex-1 bg-[#111] h-full":"flex-1 overflow-y-auto p-4 sm:p-6 pb-24 relative",children:D()}),z!=="add_order"&&S.length>0&&r.jsx(kR,{activeView:z,onNavigate:Q=>k(Q),availableViews:S,isVisible:N}),a&&r.jsx(Rv,{user:a,onClose:()=>l(null),onSave:(Q,L)=>{s.updateUser(Q,L),l(null)},isLastAdmin:!1,currentUser:s.user}),c&&r.jsx(CR,{order:c,onClose:()=>d(null),onSelectStatus:(Q,L)=>{d(null),setTimeout(()=>{L===ue.InTransit?m(Q):v({order:Q,newStatus:L})},150)},onTransferOrder:Q=>{d(null),setTimeout(()=>{y(Q)},100)}}),f&&r.jsx(A0,{order:f,drivers:I,targetStatus:ue.InTransit,onClose:()=>m(null),onSave:(Q,L)=>{s.assignDriverAndSetStatus(f.id,Q,L,ue.InTransit),m(null)}}),x&&r.jsx(A0,{order:x,drivers:I,targetStatus:ue.InTransit,onClose:()=>y(null),onSave:(Q,L)=>{s.assignDriverAndSetStatus(x.id,Q,L,ue.InTransit),y(null)}}),w&&r.jsx(os,{title:"  ",message:"    ",onClose:()=>v(null),onConfirm:()=>{s.updateOrderStatus(w.order.id,w.newStatus),v(null)},confirmVariant:"primary"})]})},pK=({onClose:s,onRequestReset:e})=>{Ht(()=>(s(),!0));const[t,n]=j.useState(""),[a,l]=j.useState(""),[c,d]=j.useState(!1),[f,m]=j.useState(""),[x,y]=j.useState(!1),w=async v=>{if(v.preventDefault(),m(""),l(""),!t){m("   .");return}if(!/^\d{11}$/.test(t)){m("      11 .");return}y(!0);const T=await e(t);y(!1),T.success?(d(!0),l(T.message)):m(T.message)};return r.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-md flex justify-center items-center z-[60] p-4 animate-fadeIn",onClick:s,children:r.jsxs("div",{className:"bg-[#1e293b] rounded-[2rem] shadow-2xl w-full max-w-sm text-white border border-white/10 overflow-hidden relative",onClick:v=>v.stopPropagation(),children:[r.jsxs("div",{className:"p-5 border-b border-white/5 flex justify-between items-center bg-[#151e2d]",children:[r.jsx("h3",{className:"text-lg font-bold text-white tracking-wide",children:"   "}),r.jsx("button",{onClick:s,className:"w-8 h-8 flex items-center justify-center rounded-full bg-white/5 text-gray-400 hover:text-white hover:bg-white/10 transition-colors",children:r.jsx(rt,{className:"w-5 h-5"})})]}),r.jsx("div",{className:"p-6",children:c?r.jsxs("div",{className:"text-center py-6 animate-fade-slide-up",children:[r.jsx("div",{className:"w-20 h-20 bg-green-500/10 rounded-full flex items-center justify-center mx-auto mb-4 ring-1 ring-green-500/30",children:r.jsx(Js,{className:"w-10 h-10 text-green-500"})}),r.jsx("h4",{className:"text-xl font-bold text-white mb-2",children:" "}),r.jsx("p",{className:"text-green-400 font-medium text-sm leading-relaxed",children:a}),r.jsx("button",{onClick:s,className:"mt-6 w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 rounded-xl transition-all",children:""})]}):r.jsxs("form",{onSubmit:w,className:"space-y-5 animate-fade-slide-up",children:[r.jsx("p",{className:"text-sm text-gray-400 leading-relaxed text-center px-2",children:"   .         ."}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{htmlFor:"reset-phone",className:"block text-xs font-bold text-gray-400 mr-1",children:" "}),r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-4 text-gray-500 group-focus-within:text-red-500 transition-colors z-10 pointer-events-none",children:r.jsx(Js,{className:"w-5 h-5"})}),r.jsx("input",{type:"tel",inputMode:"numeric",id:"reset-phone",value:t,onChange:v=>n(v.target.value.replace(/\D/g,"")),placeholder:"01xxxxxxxxx",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-4 pl-12 pr-4 text-white placeholder-gray-600 focus:border-red-500 focus:ring-1 focus:ring-red-500/50 outline-none transition-all text-right font-mono text-lg shadow-inner",required:!0,maxLength:11,dir:"rtl",disabled:x})]})]}),f&&r.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-3 flex items-center justify-center animate-pulse",children:r.jsx("p",{className:"text-red-400 text-xs font-bold",children:f})}),r.jsx("button",{type:"submit",disabled:x,className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-red-900/20 active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed flex justify-center items-center",children:x?r.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):" "})]})})]})})},xK=({onPasswordLogin:s,onGoToSignUp:e,onPasswordResetRequest:t,appConfig:n})=>{const[a,l]=j.useState(""),[c,d]=j.useState(""),[f,m]=j.useState(""),[x,y]=j.useState(!1),[w,v]=j.useState(!1),[T,I]=j.useState(!1),N=n||{appName:"GOO NOW",appVersion:"VERSION 1.0.5"},P=N.appName.split(" "),U=P[0],V=P.slice(1).join(" ");j.useEffect(()=>{Is.reportContext("login")},[]),Ht(()=>x?(y(!1),!0):!1,[x]);const q=()=>{y(!0)},W=()=>{y(!1)},z=async k=>{if(k.preventDefault(),m(""),!a){m("   .");return}if(!c){m("   .");return}I(!0),await new Promise(B=>setTimeout(B,300));const M=s(a,c);I(!1),M.success||m(M.message)};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"bg-black h-dvh flex flex-col items-center justify-center p-6 pt-safe text-white relative overflow-hidden",dir:"rtl",style:{fontFamily:N!=null&&N.customFont?"'AppCustomFont', 'Cairo', sans-serif":void 0},children:[r.jsx("div",{className:"absolute top-[-20%] left-[-20%] w-[70%] h-[50%] bg-red-600/10 rounded-full blur-[120px] pointer-events-none animate-pulse-slow"}),r.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[60%] h-[50%] bg-blue-600/5 rounded-full blur-[100px] pointer-events-none"}),r.jsxs("div",{className:"w-full max-w-sm relative z-10 flex flex-col justify-center h-full max-h-[800px]",children:[r.jsxs("div",{className:"text-center mb-10 transform transition-all duration-700 animate-slide-down",children:[r.jsxs("div",{className:"inline-block relative",children:[r.jsxs("h1",{className:"text-5xl md:text-6xl font-black tracking-tighter mb-2 drop-shadow-2xl relative z-10",children:[r.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-red-500 to-red-600",children:U}),V&&r.jsx("span",{className:"text-white ml-2",children:V})]}),r.jsx("div",{className:"absolute -bottom-2 left-1/2 -translate-x-1/2 w-1/2 h-1 bg-gradient-to-r from-transparent via-red-500 to-transparent opacity-50 rounded-full blur-[1px]"})]}),r.jsx("p",{className:"text-gray-400 text-sm font-medium tracking-widest uppercase opacity-80 mt-2",children:"   "})]}),r.jsxs("form",{onSubmit:z,className:"space-y-6 w-full animate-fade-slide-up",style:{animationDelay:"0.1s"},children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{htmlFor:"identifier",className:"block text-xs font-bold text-gray-400 mr-1 transition-colors",children:" "}),r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-4 text-gray-500 group-focus-within:text-red-500 transition-colors z-10 pointer-events-none",children:r.jsx(Js,{className:"w-5 h-5"})}),r.jsx("input",{type:"tel",inputMode:"numeric",id:"identifier",value:a,onChange:k=>l(k.target.value.replace(/\D/g,"")),placeholder:"01xxxxxxxxx",className:"w-full bg-[#1e293b]/80 border border-gray-700 rounded-2xl py-4 pl-12 pr-5 text-white placeholder-gray-600 focus:border-red-500 focus:ring-1 focus:ring-red-500/50 focus:bg-[#1e293b] outline-none transition-all duration-300 shadow-sm text-right font-mono text-lg tracking-wide",required:!0,dir:"rtl",disabled:T})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{htmlFor:"password",className:"block text-xs font-bold text-gray-400 mr-1 transition-colors",children:" "}),r.jsxs("div",{className:"relative group",children:[r.jsx("button",{type:"button",onClick:()=>v(!w),className:"absolute top-1/2 -translate-y-1/2 left-0 p-4 text-gray-500 hover:text-white transition-colors z-20 outline-none",tabIndex:-1,children:w?r.jsx(Ui,{className:"w-5 h-5"}):r.jsx(wa,{className:"w-5 h-5"})}),r.jsx("input",{type:w?"text":"password",id:"password",value:c,onChange:k=>d(k.target.value),className:"w-full bg-[#1e293b]/80 border border-gray-700 rounded-2xl py-4 pl-12 pr-5 text-white placeholder-gray-600 focus:border-red-500 focus:ring-1 focus:ring-red-500/50 focus:bg-[#1e293b] outline-none transition-all duration-300 shadow-sm text-lg",required:!0,placeholder:"",disabled:T})]})]}),r.jsx("div",{className:"flex justify-end pt-1",children:r.jsx("button",{type:"button",onClick:q,className:"text-xs font-bold text-gray-400 hover:text-red-400 transition-colors focus:outline-none",children:"   "})}),f&&r.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-3 flex items-center justify-center gap-2 animate-pulse",children:[r.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-red-500"}),r.jsx("p",{className:"text-red-400 text-xs font-bold",children:f})]}),r.jsx("button",{type:"submit",disabled:T,className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-bold py-4 rounded-2xl transition-all shadow-lg shadow-red-900/30 active:scale-[0.98] flex justify-center items-center text-lg mt-6 group relative overflow-hidden disabled:opacity-70 disabled:cursor-not-allowed",children:T?r.jsx("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"relative z-10",children:" "}),r.jsx("div",{className:"absolute inset-0 bg-white/10 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"})]})})]}),r.jsx("div",{className:"text-center mt-10 animate-fade-slide-up",style:{animationDelay:"0.2s"},children:r.jsxs("p",{className:"text-sm text-gray-500 font-medium",children:["  ",r.jsx("button",{onClick:e,className:"text-white font-bold hover:text-red-500 transition-colors mr-2 hover:underline decoration-red-500 underline-offset-4",children:"  "})]})})]}),r.jsx("div",{className:"absolute bottom-6 left-0 right-0 text-center opacity-40",children:r.jsx("p",{className:"text-[10px] text-gray-500 font-mono tracking-widest",children:N.appVersion})})]}),x&&r.jsx(pK,{onClose:W,onRequestReset:t})]})},vw=[{id:"restaurant",label:"",icon:Xr,color:"text-orange-500",bg:"bg-orange-500/10",border:"border-orange-500/20"},{id:"market",label:" ",icon:Nn,color:"text-green-500",bg:"bg-green-500/10",border:"border-green-500/20"},{id:"pharmacy",label:"",icon:ln,color:"text-blue-500",bg:"bg-blue-500/10",border:"border-blue-500/20"},{id:"bakery",label:"/",icon:Sn,color:"text-yellow-500",bg:"bg-yellow-500/10",border:"border-yellow-500/20"},{id:"electronics",label:"",icon:Ci,color:"text-cyan-500",bg:"bg-cyan-500/10",border:"border-cyan-500/20"},{id:"fashion",label:"",icon:CD,color:"text-purple-500",bg:"bg-purple-500/10",border:"border-purple-500/20"},{id:"logistics",label:" ",icon:Bt,color:"text-indigo-500",bg:"bg-indigo-500/10",border:"border-indigo-500/20"},{id:"other",label:"",icon:Sn,color:"text-gray-400",bg:"bg-gray-800",border:"border-gray-700"}],hf=({icon:s,iconColor:e,colSpan:t="col-span-1",...n})=>r.jsxs("div",{className:`relative group ${t}`,children:[r.jsx("div",{className:`absolute top-1/2 -translate-y-1/2 left-3 transition-colors pointer-events-none z-10 ${e||"text-gray-500"} group-focus-within:text-white`,children:r.jsx(s,{className:"w-5 h-5"})}),r.jsx("input",{...n,className:`w-full bg-[#1F2937]/50 border border-gray-700 rounded-xl py-3.5 pl-10 pr-4 text-sm text-white placeholder-gray-500 focus:border-red-500 focus:ring-1 focus:ring-red-500 focus:bg-[#1F2937] outline-none transition-all duration-300 ${n.className||""}`})]}),bK=({onSignUp:s,onBackToLogin:e})=>{const[t,n]=j.useState("role-selection");j.useEffect(()=>{Is.reportContext("signup")},[]),Ht(()=>F?(E(!1),!0):t==="form"?(n("role-selection"),!0):(e(),!0),[t,e]);const[a,l]=j.useState(""),[c,d]=j.useState(""),[f,m]=j.useState(""),[x,y]=j.useState(""),[w,v]=j.useState("customer"),[T,I]=j.useState(""),[N,P]=j.useState(""),[U,V]=j.useState(null),[q,W]=j.useState("restaurant"),[z,k]=j.useState(""),[M,B]=j.useState("09:00"),[D,S]=j.useState("23:00"),[F,E]=j.useState(!1),[Y,X]=j.useState(!1),[R,J]=j.useState(""),[O,K]=j.useState(!1),[Q,L]=j.useState(!1),[G,ee]=j.useState(!1),ne=j.useRef(null),je=ye=>{v(ye),n("form"),J("")},se=ye=>new Promise((et,Je)=>{const bt=new FileReader;bt.readAsDataURL(ye),bt.onload=yt=>{var fe;const Ae=new Image;Ae.src=(fe=yt.target)==null?void 0:fe.result,Ae.onload=()=>{const $e=document.createElement("canvas"),ce=1200,Oe=1200;let Pe=Ae.width,Ge=Ae.height;Pe>Ge?Pe>ce&&(Ge*=ce/Pe,Pe=ce):Ge>Oe&&(Pe*=Oe/Ge,Ge=Oe),$e.width=Pe,$e.height=Ge;const Ke=$e.getContext("2d");Ke?(Ke.imageSmoothingEnabled=!0,Ke.imageSmoothingQuality="high",Ke.drawImage(Ae,0,0,Pe,Ge),et($e.toDataURL("image/jpeg",.9))):Je(new Error("Canvas context error"))},Ae.onerror=$e=>Je($e)},bt.onerror=yt=>Je(yt)}),_e=async ye=>{var Je;const et=(Je=ye.target.files)==null?void 0:Je[0];if(et){L(!0);try{const bt=await se(et);setTimeout(()=>{V(bt),L(!1)},800)}catch(bt){console.error("Error resizing image:",bt),L(!1),J("        .")}}},Te=async ye=>{if(ye.preventDefault(),J(""),!a||!c||!f||!x){J("    .");return}if(w!=="driver"&&!N.trim()){J("  .");return}if(!U){J(w==="merchant"?"  .":"  .");return}if(!/^\d{11}$/.test(c)){J("      11 .");return}if(f.length<6){J("     6   .");return}if(f!==x){J("   .");return}let et=q;if(w==="merchant"&&q==="other"){if(!z.trim()){J("     .");return}et=z.trim()}K(!0);const Je={name:a,phone:c,password:f,role:w,storeImage:U,email:T||void 0,address:N||void 0};w==="merchant"&&(Je.storeCategory=et,Je.storeName=a,Je.workingHours={start:M,end:D});const bt=await s(Je);K(!1),bt.success?(ee(!0),setTimeout(()=>{e()},4e3)):J(bt.message)},be=vw.find(ye=>ye.id===q)||vw[0];return t==="role-selection"?r.jsxs("div",{className:"h-dvh flex flex-col items-center justify-center p-6 pt-safe bg-black relative overflow-hidden",dir:"rtl",children:[r.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-red-600/10 rounded-full blur-[100px] pointer-events-none"}),r.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"}),r.jsxs("div",{className:"w-full max-w-sm space-y-8 relative z-10",children:[r.jsxs("div",{className:"text-center space-y-2",children:[r.jsx("h1",{className:"text-3xl font-black text-white",children:"  "}),r.jsx("p",{className:"text-gray-400 text-sm",children:"   "})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("button",{onClick:()=>je("customer"),className:"w-full group bg-[#1e293b] hover:bg-[#253347] border border-gray-700/50 hover:border-cyan-500/50 p-4 rounded-2xl flex items-center justify-between transition-all duration-300 shadow-lg hover:shadow-cyan-900/20 active:scale-95",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-12 h-12 rounded-full bg-cyan-500/10 flex items-center justify-center group-hover:bg-cyan-500/20 transition-colors",children:r.jsx(pt,{className:"w-6 h-6 text-cyan-400"})}),r.jsxs("div",{className:"text-right",children:[r.jsx("h3",{className:"font-bold text-white text-lg group-hover:text-cyan-400 transition-colors",children:""}),r.jsx("p",{className:"text-xs text-gray-500",children:" "})]})]}),r.jsx(ma,{className:"w-5 h-5 text-gray-600 group-hover:text-cyan-400 rotate-180 transition-colors"})]}),r.jsxs("button",{onClick:()=>je("driver"),className:"w-full group bg-[#1e293b] hover:bg-[#253347] border border-gray-700/50 hover:border-red-500/50 p-4 rounded-2xl flex items-center justify-between transition-all duration-300 shadow-lg hover:shadow-red-900/20 active:scale-95",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-12 h-12 rounded-full bg-red-500/10 flex items-center justify-center group-hover:bg-red-500/20 transition-colors",children:r.jsx(Bt,{className:"w-6 h-6 text-red-500"})}),r.jsxs("div",{className:"text-right",children:[r.jsx("h3",{className:"font-bold text-white text-lg group-hover:text-red-500 transition-colors",children:" "}),r.jsx("p",{className:"text-xs text-gray-500",children:"  "})]})]}),r.jsx(ma,{className:"w-5 h-5 text-gray-600 group-hover:text-red-500 rotate-180 transition-colors"})]}),r.jsxs("button",{onClick:()=>je("merchant"),className:"w-full group bg-[#1e293b] hover:bg-[#253347] border border-gray-700/50 hover:border-purple-500/50 p-4 rounded-2xl flex items-center justify-between transition-all duration-300 shadow-lg hover:shadow-purple-900/20 active:scale-95",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-500/10 flex items-center justify-center group-hover:bg-purple-500/20 transition-colors",children:r.jsx(Qo,{className:"w-6 h-6 text-purple-400"})}),r.jsxs("div",{className:"text-right",children:[r.jsx("h3",{className:"font-bold text-white text-lg group-hover:text-purple-400 transition-colors",children:" / "}),r.jsx("p",{className:"text-xs text-gray-500",children:"  "})]})]}),r.jsx(ma,{className:"w-5 h-5 text-gray-600 group-hover:text-purple-400 rotate-180 transition-colors"})]})]}),r.jsx("div",{className:"text-center pt-6",children:r.jsxs("button",{onClick:e,className:"text-sm text-gray-500 hover:text-white transition-colors",children:["   ",r.jsx("span",{className:"text-red-500 font-bold hover:underline",children:" "})]})})]})]}):r.jsxs("div",{className:"h-dvh flex flex-col text-white relative bg-black overflow-hidden",dir:"rtl",children:[r.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[r.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-red-600/10 rounded-full blur-[100px]"}),r.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-blue-600/10 rounded-full blur-[100px]"})]}),F&&r.jsx("div",{className:"fixed inset-0 z-[60] flex items-end sm:items-center justify-center bg-black/80 backdrop-blur-sm animate-fadeIn p-0 sm:p-4",onClick:()=>E(!1),children:r.jsxs("div",{className:"bg-[#1e293b] w-full sm:max-w-lg rounded-t-3xl sm:rounded-3xl border-t sm:border border-gray-700 shadow-2xl overflow-hidden flex flex-col max-h-[80vh]",onClick:ye=>ye.stopPropagation(),children:[r.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-[#0f172a]",children:[r.jsx("h3",{className:"text-lg font-bold text-white",children:"  "}),r.jsx("button",{onClick:()=>E(!1),className:"text-gray-400 hover:text-white p-1 rounded-full hover:bg-gray-800",children:r.jsx(rt,{className:"w-5 h-5"})})]}),r.jsx("div",{className:"p-4 overflow-y-auto bg-[#0f172a]",children:r.jsx("div",{className:"grid grid-cols-2 gap-3",children:vw.map(ye=>r.jsxs("button",{type:"button",onClick:()=>{W(ye.id),E(!1)},className:`flex flex-col items-center justify-center p-3 rounded-xl border transition-all duration-200 ${q===ye.id?"bg-[#1e293b] border-red-500 shadow-lg shadow-red-900/20":"bg-[#1e293b]/50 border-gray-700 hover:bg-[#1e293b]"}`,children:[r.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center mb-2 ${q===ye.id?"bg-red-600 text-white":`${ye.bg} ${ye.color}`}`,children:r.jsx(ye.icon,{className:"w-5 h-5"})}),r.jsx("span",{className:`text-xs font-bold ${q===ye.id?"text-white":"text-gray-400"}`,children:ye.label})]},ye.id))})})]})}),G&&r.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/90 backdrop-blur-md animate-fadeIn p-4",children:r.jsxs("div",{className:"bg-[#1e293b] p-8 rounded-3xl shadow-2xl flex flex-col items-center text-center max-w-sm border border-gray-700 w-full transform transition-all scale-100",children:[r.jsx("div",{className:"w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mb-6 ring-2 ring-green-500/50 shadow-lg shadow-green-900/20 animate-bounce",children:r.jsx(nt,{className:"w-10 h-10 text-green-400"})}),r.jsx("h3",{className:"text-2xl font-black text-white mb-2",children:"   !"}),r.jsxs("div",{className:"space-y-3 mb-6 bg-yellow-500/10 p-4 rounded-xl border border-yellow-500/20",children:[r.jsxs("p",{className:"text-gray-300 text-sm font-medium",children:["  ",r.jsx("span",{className:"text-yellow-400 font-bold text-base",children:" "}),"   ."]}),r.jsx("p",{className:"text-gray-400 text-xs",children:"       .   ."})]}),r.jsx("div",{className:"w-full bg-gray-800 h-1.5 rounded-full overflow-hidden mb-2",children:r.jsx("div",{className:"h-full bg-green-500 rounded-full animate-progress",style:{animationDuration:"4s"}})}),r.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"   ..."})]})}),r.jsxs("div",{className:"px-5 pt-safe pb-2 flex-none relative",children:[r.jsx("button",{onClick:()=>n("role-selection"),className:"absolute top-safe-offset right-5 p-1 bg-gray-800 rounded-full text-gray-400 hover:text-white transition-colors z-20",style:{top:"calc(var(--safe-area-top) + 1.25rem)"},children:r.jsx(ma,{className:"w-5 h-5"})}),r.jsx("div",{className:"text-center",children:r.jsxs("h1",{className:"text-2xl font-black text-white tracking-tight",children:[w==="driver"?" ":w==="merchant"?" ":" ",r.jsx("span",{className:"text-red-500",children:"."})]})})]}),r.jsx("div",{className:"flex-1 px-5 flex flex-col relative z-10 min-h-0 pt-2",children:r.jsx("form",{onSubmit:Te,className:"flex-1 flex flex-col h-full",children:r.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-hide",children:[r.jsxs("div",{className:"flex justify-center mb-6 mt-4",children:[w==="merchant"?r.jsxs("div",{onClick:()=>{var ye;return!Q&&((ye=ne.current)==null?void 0:ye.click())},className:`relative w-full h-36 rounded-2xl border border-dashed cursor-pointer overflow-hidden group flex items-center justify-center shadow-lg transition-all ${U?"border-transparent":"border-gray-600 bg-[#1e293b] hover:border-red-500"}`,children:[Q&&r.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:r.jsxs("div",{className:"grid place-items-center",children:[r.jsx("div",{className:"col-start-1 row-start-1 w-20 h-20 border-4 border-blue-400/30 rounded-full animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"}),r.jsx("div",{className:"col-start-1 row-start-1 w-12 h-12 bg-blue-500 rounded-full opacity-75 animate-ping"}),r.jsx("div",{className:"col-start-1 row-start-1 w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center z-10 shadow-lg shadow-blue-500/50",children:r.jsx(ur,{className:"w-6 h-6 text-white animate-bounce"})})]})}),U?r.jsxs(r.Fragment,{children:[r.jsx("img",{src:U,alt:"Store",className:"w-full h-full object-cover opacity-70"}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30",children:r.jsx(ga,{className:"w-8 h-8 text-white p-1.5 bg-black/50 rounded-full"})})]}):r.jsxs("div",{className:"flex flex-col items-center text-gray-400 group-hover:text-white transition-colors",children:[r.jsx(ga,{className:"w-8 h-8 mb-2"}),r.jsx("span",{className:"text-xs font-bold",children:"  "})]})]}):r.jsxs("div",{onClick:()=>{var ye;return!Q&&((ye=ne.current)==null?void 0:ye.click())},className:`w-28 h-28 rounded-full border-2 border-dashed flex items-center justify-center cursor-pointer overflow-hidden relative shadow-lg group hover:border-red-500 transition-all ${U?"border-red-500":"border-gray-600 bg-[#1e293b]"}`,children:[Q&&r.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:r.jsxs("div",{className:"grid place-items-center",children:[r.jsx("div",{className:"col-start-1 row-start-1 w-14 h-14 border-4 border-blue-400/30 rounded-full animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"}),r.jsx("div",{className:"col-start-1 row-start-1 w-8 h-8 bg-blue-500 rounded-full opacity-75 animate-ping"}),r.jsx("div",{className:"col-start-1 row-start-1 w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center z-10 shadow-lg shadow-blue-500/50",children:r.jsx(ur,{className:"w-4 h-4 text-white animate-bounce"})})]})}),U?r.jsx("img",{src:U,className:"w-full h-full object-cover"}):r.jsxs("div",{className:"flex flex-col items-center text-gray-400 group-hover:text-white",children:[r.jsx(ga,{className:"w-8 h-8 mb-1"}),r.jsx("span",{className:"text-[10px]",children:" "})]}),r.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:r.jsx(ga,{className:"w-6 h-6 text-white"})})]}),r.jsx("input",{ref:ne,type:"file",accept:"image/*",className:"hidden",onChange:_e})]}),r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsx(hf,{icon:pt,iconColor:"text-cyan-500",type:"text",value:a,onChange:ye=>l(ye.target.value),placeholder:w==="merchant"?" ":" "}),r.jsx(hf,{icon:Js,iconColor:"text-emerald-500",type:"tel",value:c,onChange:ye=>d(ye.target.value),placeholder:"  (11 )",maxLength:11,className:"text-right placeholder:text-right",dir:"rtl"}),w!=="driver"&&r.jsxs(r.Fragment,{children:[r.jsx(hf,{icon:jn,iconColor:"text-rose-500",type:"text",value:N,onChange:ye=>P(ye.target.value),placeholder:" "}),r.jsx(hf,{icon:_w,iconColor:"text-purple-500",type:"email",value:T,onChange:ye=>I(ye.target.value),placeholder:"  ()"})]}),w==="driver"&&r.jsx(hf,{icon:_w,iconColor:"text-purple-500",type:"email",value:T,onChange:ye=>I(ye.target.value),placeholder:"  ()"}),w==="merchant"&&r.jsxs("div",{className:"flex flex-col gap-3 bg-[#1e293b]/50 p-3 rounded-xl border border-gray-700/50",children:[r.jsxs("button",{type:"button",onClick:()=>E(!0),className:"bg-[#0f172a] border border-gray-700 rounded-xl py-3.5 px-4 text-white flex justify-between items-center text-sm hover:border-gray-500 transition-colors w-full",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(be.icon,{className:`w-4 h-4 ${be.color}`}),r.jsx("span",{children:be.label})]}),r.jsx(k0,{className:"w-4 h-4 text-gray-500"})]}),q==="other"&&r.jsx("input",{type:"text",value:z,onChange:ye=>k(ye.target.value),placeholder:"  ...",className:"bg-[#0f172a] border border-gray-700 rounded-xl py-3 px-4 text-sm text-white outline-none focus:border-red-500 w-full"}),r.jsxs("div",{className:"flex items-center gap-2 bg-[#0f172a] border border-gray-700 rounded-xl px-3 py-2",children:[r.jsx(wt,{className:"w-4 h-4 text-orange-500 flex-shrink-0"}),r.jsx("span",{className:"text-xs text-gray-400",children:" :"}),r.jsx("input",{type:"time",value:M,onChange:ye=>B(ye.target.value),className:"bg-transparent text-white text-xs flex-1 text-center outline-none"}),r.jsx("span",{className:"text-gray-500",children:"-"}),r.jsx("input",{type:"time",value:D,onChange:ye=>S(ye.target.value),className:"bg-transparent text-white text-xs flex-1 text-center outline-none"})]})]}),r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-3 z-20 text-gray-500",children:r.jsx("button",{type:"button",onClick:()=>X(!Y),children:Y?r.jsx(Ui,{className:"w-5 h-5"}):r.jsx(wa,{className:"w-5 h-5"})})}),r.jsx("input",{type:Y?"text":"password",value:f,onChange:ye=>m(ye.target.value),placeholder:"  (6   )",className:"w-full bg-[#1F2937]/50 border border-gray-700 rounded-xl py-3.5 pl-4 pr-4 text-sm text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all"})]}),r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-3 z-20 text-gray-500",children:r.jsx("button",{type:"button",onClick:()=>X(!Y),children:Y?r.jsx(Ui,{className:"w-5 h-5"}):r.jsx(wa,{className:"w-5 h-5"})})}),r.jsx("input",{type:Y?"text":"password",value:x,onChange:ye=>y(ye.target.value),placeholder:"  ",className:"w-full bg-[#1F2937]/50 border border-gray-700 rounded-xl py-3.5 pl-4 pr-4 text-sm text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all"})]}),R&&r.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3 flex items-center justify-center mt-1",children:r.jsx("p",{className:"text-red-400 text-xs font-bold",children:R})})]}),r.jsxs("div",{className:"pt-8 pb-10",children:[r.jsx("button",{type:"submit",disabled:O,className:"w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3.5 rounded-xl transition-all shadow-lg active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center text-base",children:O?r.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):" "}),r.jsx("div",{className:"text-center mt-4",children:r.jsxs("button",{type:"button",onClick:e,className:"text-xs text-gray-500 hover:text-white transition-colors",children:["   ",r.jsx("span",{className:"text-red-500 font-bold hover:underline",children:" "})]})})]})]})})})]})},yK=({message:s,type:e,onClose:t})=>{const n=j.useRef(t);j.useEffect(()=>{n.current=t},[t]),j.useEffect(()=>{const c=setTimeout(()=>{n.current()},4e3);return()=>clearTimeout(c)},[]);const l=(()=>{const c=(s==null?void 0:s.toLowerCase())||"";return c.includes(" ")||c.includes("new order")||c.includes("")?{icon:r.jsx(Nn,{className:"h-5 w-5 text-amber-900"}),bgClass:"bg-gradient-to-r from-amber-200 via-yellow-400 to-amber-500",textClass:"text-amber-950",borderClass:"border-amber-300/50",shadowClass:"shadow-[0_8px_30px_rgb(251,191,36,0.4)]",glowClass:"bg-yellow-400",title:" "}:c.includes(" ")||c.includes("preparing")?{icon:r.jsx(Xr,{className:"h-5 w-5 text-indigo-100"}),bgClass:"bg-gradient-to-r from-indigo-500 via-purple-500 to-purple-600",textClass:"text-white",borderClass:"border-indigo-400/50",shadowClass:"shadow-[0_8px_30px_rgb(99,102,241,0.4)]",glowClass:"bg-indigo-400",title:" "}:c.includes("")||c.includes("admin")||c.includes("")?{icon:r.jsx(kr,{className:"h-5 w-5 text-rose-100"}),bgClass:"bg-gradient-to-r from-rose-500 via-red-500 to-red-600",textClass:"text-white",borderClass:"border-rose-400/50",shadowClass:"shadow-[0_8px_30px_rgb(244,63,94,0.4)]",glowClass:"bg-rose-400",title:" "}:c.includes("")||c.includes("")||c.includes("transit")?{icon:r.jsx(Bt,{className:"h-5 w-5 text-cyan-900"}),bgClass:"bg-gradient-to-r from-cyan-300 via-sky-400 to-blue-500",textClass:"text-cyan-950",borderClass:"border-cyan-300/50",shadowClass:"shadow-[0_8px_30px_rgb(34,211,238,0.4)]",glowClass:"bg-cyan-400",title:" "}:e==="success"?{icon:r.jsx(nt,{className:"h-5 w-5 text-emerald-900"}),bgClass:"bg-gradient-to-r from-emerald-300 via-green-400 to-green-500",textClass:"text-emerald-950",borderClass:"border-emerald-300/50",shadowClass:"shadow-[0_8px_30px_rgb(52,211,153,0.4)]",glowClass:"bg-emerald-400",title:" "}:e==="error"?{icon:r.jsx(rt,{className:"h-5 w-5 text-white"}),bgClass:"bg-gradient-to-r from-red-500 to-red-700",textClass:"text-white",borderClass:"border-red-400/50",shadowClass:"shadow-[0_8px_30px_rgb(239,68,68,0.4)]",glowClass:"bg-red-500",title:""}:{icon:r.jsx(an,{className:"h-5 w-5 text-white"}),bgClass:"bg-[#1a1a1a]/90 backdrop-blur-xl",textClass:"text-white",borderClass:"border-white/10",shadowClass:"shadow-2xl",glowClass:"bg-white",title:""}})();return r.jsxs("div",{dir:"rtl",className:"fixed top-6 left-0 right-0 mx-auto z-[9999] w-fit max-w-[92%] min-w-[320px] sm:min-w-[350px] animate-fadeInDown",children:[r.jsx("style",{children:`
                @keyframes fadeInDown {
                    from { opacity: 0; transform: translateY(-20px); }
                    to { opacity: 1; transform: translateY(0); }
                }
                .animate-fadeInDown {
                    animation: fadeInDown 0.3s ease-out forwards;
                }
            `}),r.jsxs("div",{className:`
                relative flex items-center justify-between gap-4 p-1.5 pr-2 rounded-full 
                ${l.bgClass} ${l.borderClass} border ${l.shadowClass}
                shadow-2xl cursor-pointer
            `,onClick:t,children:[r.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[r.jsx("div",{className:"relative flex-shrink-0",children:r.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center bg-white/20 backdrop-blur-sm shadow-inner",children:l.icon})}),r.jsxs("div",{className:`flex flex-col ${l.textClass}`,children:[r.jsx("span",{className:"text-[10px] font-black uppercase tracking-wider opacity-80 leading-none mb-0.5",children:l.title}),r.jsx("span",{className:"text-sm font-bold leading-tight line-clamp-2",children:s})]})]}),r.jsx("button",{onClick:c=>{c.stopPropagation(),t()},className:`
                        w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0
                        bg-black/10 hover:bg-black/20 transition-colors backdrop-blur-sm
                        ${l.textClass}
                    `,children:r.jsx(rt,{className:"h-4 w-4"})})]}),r.jsx("div",{className:"absolute bottom-1 left-4 right-4 h-0.5 bg-white/20 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-white/80 animate-progress origin-left",style:{animationDuration:"4s"}})}),r.jsx("style",{children:`
                @keyframes progress {
                    from { transform: scaleX(1); }
                    to { transform: scaleX(0); }
                }
                .animate-progress {
                    animation: progress linear forwards;
                }
            `})]})},wK=()=>{j.useEffect(()=>{const e=setInterval(()=>{navigator.onLine&&(clearInterval(e),window.AndroidSplash&&window.AndroidSplash.showSplash&&window.AndroidSplash.showSplash(),setTimeout(()=>{window.location.reload()},500))},2e3),t=()=>{window.AndroidSplash&&window.AndroidSplash.showSplash&&window.AndroidSplash.showSplash(),setTimeout(()=>{window.location.reload()},300)};return window.addEventListener("online",t),()=>{clearInterval(e),window.removeEventListener("online",t)}},[]);const s=()=>{navigator.onLine&&(window.AndroidSplash&&window.AndroidSplash.showSplash&&window.AndroidSplash.showSplash(),window.location.reload())};return r.jsxs("div",{dir:"rtl",className:"fixed inset-0 z-[9999] bg-[#0f172a] flex flex-col items-center justify-center p-6 pt-safe text-white overflow-hidden font-sans",children:[r.jsx("style",{children:`
        @keyframes ripple {
          0% { transform: scale(0.8); opacity: 1; }
          100% { transform: scale(2.4); opacity: 0; }
        }
        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .ripple-container {
            position: relative;
            width: 140px;
            height: 140px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .ripple-circle {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 2px solid rgba(239, 68, 68, 0.5); /* Red-500 */
            animation: ripple 2s infinite cubic-bezier(0, 0.2, 0.8, 1);
        }
        .ripple-circle:nth-child(2) { animation-delay: -0.5s; }
        .ripple-circle:nth-child(3) { animation-delay: -1s; }
        
        .wifi-icon-container {
            animation: floating 3s ease-in-out infinite;
        }
      `}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-[#0f172a] via-[#1e293b] to-[#0f172a] pointer-events-none"}),r.jsx("div",{className:"absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] pointer-events-none"}),r.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center max-w-sm w-full",children:[r.jsxs("div",{className:"mb-10 ripple-container",children:[r.jsx("div",{className:"ripple-circle"}),r.jsx("div",{className:"ripple-circle"}),r.jsx("div",{className:"ripple-circle"}),r.jsx("div",{className:"w-24 h-24 bg-[#1e293b] rounded-full flex items-center justify-center border-4 border-[#334155] shadow-2xl z-10 wifi-icon-container",children:r.jsx(kD,{className:"w-12 h-12 text-red-500 drop-shadow-[0_0_10px_rgba(239,68,68,0.5)]"})})]}),r.jsx("h1",{className:"text-4xl font-black mb-2 tracking-tight text-white drop-shadow-lg",children:" "}),r.jsx("p",{className:"text-red-400 font-bold text-lg mb-6 uppercase tracking-widest opacity-90",children:"No Internet Connection"}),r.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-10 max-w-[280px] mx-auto border-t border-gray-700/50 pt-6",children:"  .         .       ."}),r.jsxs("button",{onClick:s,className:"group relative w-full overflow-hidden rounded-2xl bg-red-600 p-[2px] focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-2 focus:ring-offset-slate-900",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600 via-orange-500 to-red-600 opacity-100 transition-opacity duration-500 group-hover:opacity-100"}),r.jsxs("div",{className:"relative flex items-center justify-center gap-3 rounded-2xl bg-[#0f172a] px-8 py-4 transition-all duration-200 group-hover:bg-transparent group-hover:text-white",children:[r.jsx(Qp,{className:`w-5 h-5 ${navigator.onLine?"animate-spin":""} text-red-500 group-hover:text-white transition-colors`}),r.jsx("span",{className:"font-bold text-lg text-white",children:" "})]})]}),r.jsxs("div",{className:"mt-12 flex flex-col items-center gap-2 opacity-30 hover:opacity-100 transition-opacity duration-500",children:[r.jsx("div",{className:"h-1 w-12 bg-gray-500 rounded-full mb-2"}),r.jsx("p",{className:"text-[10px] uppercase font-mono tracking-[0.2em] text-gray-500",children:"System Offline Mode"})]})]})]})},P5=({config:s,onDismiss:e})=>{const[t,n]=j.useState(!1),[a,l]=j.useState(""),c=async()=>{if(s.url){n(!0);try{let d=s.url;if(s.url.startsWith("FIRESTORE_FILE:")){l("   ...");const m=s.url.split(":")[1];d=await Oq(m),l(" !  ...")}const f=document.createElement("a");f.href=d,f.target="_blank",s.type==="apk"&&(f.download=`App_Update_v${s.version}.apk`),document.body.appendChild(f),f.click(),document.body.removeChild(f),setTimeout(()=>{n(!1),l("")},3e3)}catch(d){console.error("Update failed:",d),l("  "),setTimeout(()=>{n(!1),l("")},2e3)}}};return r.jsxs("div",{className:"fixed inset-0 z-[200] bg-[#0f172a] flex flex-col items-center justify-center p-6 animate-fadeIn font-sans text-white overflow-hidden",children:[r.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-blue-600/10 rounded-full blur-[120px] pointer-events-none -translate-y-1/2 translate-x-1/2"}),r.jsx("div",{className:"absolute bottom-0 left-0 w-[500px] h-[500px] bg-purple-600/10 rounded-full blur-[120px] pointer-events-none translate-y-1/2 -translate-x-1/2"}),r.jsxs("div",{className:"relative z-10 w-full max-w-sm text-center",children:[r.jsxs("div",{className:"relative mb-10 flex justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-blue-500 rounded-full blur-2xl opacity-20 animate-pulse"}),r.jsxs("div",{className:"w-28 h-28 bg-gradient-to-br from-[#1e293b] to-[#0f172a] rounded-[2rem] flex items-center justify-center border-4 border-[#334155] shadow-2xl relative z-10 animate-bounce-slow",children:[s.type==="apk"?r.jsx(jw,{className:"w-14 h-14 text-blue-400"}):r.jsx(zt,{className:"w-14 h-14 text-purple-400"}),r.jsx("div",{className:"absolute -top-2 -right-2 bg-red-500 w-8 h-8 rounded-full flex items-center justify-center border-4 border-[#0f172a] animate-ping"}),r.jsx("div",{className:"absolute -top-2 -right-2 bg-red-600 w-8 h-8 rounded-full flex items-center justify-center border-4 border-[#0f172a] text-xs font-bold shadow-lg",children:"1"})]})]}),r.jsxs("div",{className:"bg-[#1e293b]/80 backdrop-blur-xl border border-white/10 rounded-3xl p-8 shadow-2xl animate-slide-up",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 bg-blue-500/10 border border-blue-500/20 px-3 py-1 rounded-full mb-4",children:[r.jsx(vK,{className:"w-4 h-4 text-blue-400 animate-spin-slow"}),r.jsx("span",{className:"text-xs font-bold text-blue-300 tracking-wider",children:"  "})]}),r.jsxs("h2",{className:"text-3xl font-black mb-2 text-white",children:[" ",s.version]}),r.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-8",children:s.description||"         .       ."}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("button",{onClick:c,disabled:t,className:`group relative w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-2xl shadow-lg shadow-blue-600/30 active:scale-95 transition-all overflow-hidden ${t?"cursor-wait opacity-80":""}`,children:[r.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),r.jsx("div",{className:"relative flex items-center justify-center gap-3",children:t?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),r.jsx("span",{children:a||" ..."})]}):r.jsxs(r.Fragment,{children:[s.type==="apk"?r.jsx(jw,{className:"w-5 h-5"}):r.jsx($f,{className:"w-5 h-5"}),r.jsx("span",{children:s.type==="apk"?"  ":" "})]})})]}),!s.forceUpdate&&!t&&r.jsx("button",{onClick:e,className:"w-full bg-transparent hover:bg-white/5 text-gray-400 font-bold py-3 rounded-2xl transition-colors text-sm",children:" "})]})]}),r.jsx("div",{className:"mt-8 text-xs text-gray-600 font-mono",children:"DELI NOW UPDATE CENTER"})]})]})},vK=({className:s})=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:r.jsx("path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"})}),MR={apiKey:"AIzaSyC4bv_RLpS-jxunMs7nWjux806bYk6XnVY",authDomain:"goo-now-1ce44.firebaseapp.com",databaseURL:"https://goo-now-1ce44-default-rtdb.firebaseio.com",projectId:"goo-now-1ce44",storageBucket:"goo-now-1ce44.firebasestorage.app",messagingSenderId:"742306376566",appId:"1:742306376566:android:9298a84980b239e528a857"},_K=()=>{try{const s=localStorage.getItem("firebase_config");if(s){const e=JSON.parse(s);if(e&&e.apiKey&&e.projectId)return e}}catch(s){console.warn("Failed to load custom firebase config, using default.",s)}return MR};uR(_K());const jK=s=>{const[e,t]=j.useState([]),[n,a]=j.useState([]),[l,c]=j.useState([]),[d,f]=j.useState([]),[m,x]=j.useState([]),[y,w]=j.useState([]),[v,T]=j.useState([]),[I,N]=j.useState({isEnabled:!0}),[P,U]=j.useState({pointsPerCurrency:1,currencyPerPoint:.1,isPointsEnabled:!0}),[V,q]=j.useState(()=>{try{const X=localStorage.getItem("app_config_cache");if(X)return JSON.parse(X)}catch{}return{appName:"GOO NOW",appVersion:"VERSION 1.0.5"}}),[W,z]=j.useState(null),[k,M]=j.useState(!1),[B,D]=j.useState(!0),[S,F]=j.useState(()=>{try{const X=localStorage.getItem("currentUser");return X?JSON.parse(X):null}catch{return null}}),[E,Y]=j.useState(()=>{try{const X=localStorage.getItem("app_theme");if(X)return JSON.parse(X)}catch{}return{driver:{icons:{}},merchant:{icons:{}},admin:{mode:"dark"},customer:{icons:{},mode:"dark"}}});return j.useEffect(()=>{const X="custom-app-font";let R=document.getElementById(X);V.customFont?(R||(R=document.createElement("style"),R.id=X,document.head.appendChild(R)),R.innerHTML=`
                @font-face {
                    font-family: 'AppCustomFont';
                    src: url('${V.customFont}') format('truetype');
                    font-weight: normal;
                    font-style: normal;
                }
                :root, body, html, * {
                    font-family: 'AppCustomFont', 'Cairo', sans-serif !important;
                }
                input, textarea, select, button, h1, h2, h3, h4, h5, h6, span, p, div, a {
                    font-family: 'AppCustomFont', 'Cairo', sans-serif !important;
                }
            `):R&&R.remove()},[V.customFont]),j.useEffect(()=>{const X=qn("users",ee=>{if(t(ee),D(!1),S){const ne=ee.find(je=>je.id===S.id);if(ne&&ne.status==="blocked"){F(null),localStorage.removeItem("currentUser"),Hu(),s("      .     .","error");return}ne&&Pi(ne)!==Pi(S)&&(F(ne),localStorage.setItem("currentUser",Pi(Oc(ne))))}}),R=qn("orders",ee=>a(ee)),J=qn("messages",ee=>c(ee)),O=qn("payments",ee=>w(ee)),K=qn("reset_requests",ee=>f(ee)),Q=qn("slider_images",ee=>x(ee)),L=qn("audit_logs",ee=>T(ee)),G=qn("settings",ee=>{const ne=ee.find(Te=>Te.id==="slider_config");N(ne||{isEnabled:!0});const je=ee.find(Te=>Te.id==="points_config");je&&U(Te=>({pointsPerCurrency:je.pointsPerCurrency??1,currencyPerPoint:je.currencyPerPoint??.1,isPointsEnabled:je.isPointsEnabled??!0}));const se=ee.find(Te=>Te.id==="app_config");if(se){const Te={appName:se.appName||"GOO NOW",appVersion:se.appVersion||"VERSION 1.0.5",customFont:se.customFont};q(Te),localStorage.setItem("app_config_cache",JSON.stringify(Te))}const _e=ee.find(Te=>Te.id==="app_update");if(_e){const Te=_e;z(Te);const be="1.0.6";if(Te.isActive&&Te.version!==be){const ye=Te.version.toLowerCase().replace(/[^0-9.]/g,""),et=be.toLowerCase().replace(/[^0-9.]/g,"");if(ye.localeCompare(et,void 0,{numeric:!0,sensitivity:"base"})>0){const bt=localStorage.getItem("skipped_update_version");(Te.forceUpdate||bt!==Te.version)&&M(!0)}}}});return()=>{X(),R(),J(),O(),K(),Q(),G(),L()}},[S==null?void 0:S.id,V.appVersion]),j.useEffect(()=>{S&&wm(S.role,S.id)},[S==null?void 0:S.id]),j.useEffect(()=>{const X=setTimeout(()=>{B&&(console.warn("Loading timeout reached."),D(!1))},3e4);return()=>clearTimeout(X)},[B]),{users:e,orders:n,messages:l,payments:y,sliderImages:m,auditLogs:v,passwordResetRequests:d,sliderConfig:I,pointsConfig:P,appConfig:V,updateConfig:W,showUpdate:k,setShowUpdate:M,isLoading:B,setIsLoading:D,currentUser:S,setCurrentUser:F,appTheme:E,setAppTheme:Y}},NK=({users:s,orders:e,messages:t,currentUser:n,showNotify:a})=>{const l=w=>{const v=w.reduce((T,I)=>{const N=parseInt(I.id);return isNaN(N)?T:Math.max(T,N)},0);return String(v+1)},c=(w,v,T)=>{if(!n)return;const I={id:`LOG-${Date.now()}-${Math.floor(Math.random()*1e3)}`,actorId:n.id,actorName:n.name,actionType:w,target:v,details:T,createdAt:new Date};ut("audit_logs",I.id,I)};return{logAction:c,handleDriverPayment:async w=>{const v=s.find(D=>D.id===w);if(!v)return;const T=e.filter(D=>String(D.driverId)===String(w)&&D.status===ue.Delivered&&!D.reconciled);if(T.length===0){a("   ","info");return}const I=D=>Math.round((D+Number.EPSILON)*100)/100,N=D=>typeof D=="number"?D:typeof D=="string"&&parseFloat(D)||0,P=T.reduce((D,S)=>D+N(S.deliveryFee),0);let U=0;const V=N(v.commissionRate);v.commissionType==="fixed"?U=T.length*V:U=P*(V/100);const q=I(U),W=I(P);let z=new Date;const k=[...T].sort((D,S)=>{const F=D.deliveredAt?new Date(D.deliveredAt).getTime():0;return(S.deliveredAt?new Date(S.deliveredAt).getTime():0)-F});if(k.length>0&&k[0].deliveredAt){const D=new Date(k[0].deliveredAt),S=new Date,F=S.getDate()!==D.getDate()||S.getMonth()!==D.getMonth(),E=S.getHours()<6;F&&E&&(z=new Date(D.getFullYear(),D.getMonth(),D.getDate(),23,59,59))}const M=`PAY-${Date.now()}`,B={id:M,driverId:w,amount:q,totalCollected:W,ordersCount:T.length,createdAt:z,reconciledOrderIds:T.map(D=>D.id)};try{const D=T.map(S=>({...S,reconciled:!0}));await Lo("orders",D),await ut("payments",M,B),c("financial"," ",`    ${v.name}. : ${q} .  ${T.length} .`),a(`  ${T.length}  `,"success"),Jt("driver",{title:"  ",body:`   .     ${T.length} .`,targetId:w,url:"/?target=wallet"})}catch(D){console.error("Payment Error",D),a("   ","error")}},handleSignUp:async w=>{if(s.find(N=>N.phone===w.phone))return{success:!1,message:"   ."};const T=l(s),I={...w,id:T,status:"pending",createdAt:new Date,pointsBalance:0};I.role==="driver"&&(I.commissionRate=25,I.commissionType="percentage",I.dailyLogMode="always_open");try{await ut("users",T,I);const N=`LOG-${Date.now()}`;ut("audit_logs",N,{id:N,actorId:T,actorName:I.name,actionType:"create",target:" ",details:`  : ${I.name} (${I.role})`,createdAt:new Date});const P=I.role==="driver"?"":I.role==="merchant"?"":"",U={title:"  ",body:`   : ${I.name} (${P}).  .`,url:"/?target=users"};return await Jt("admin",U),{success:!0,message:"   "}}catch{return{success:!1,message:"    "}}},handleHideMessage:async(w,v,T)=>{const I=[...v,w];if(T(I),localStorage.setItem("deleted_msgs",JSON.stringify(I)),n){const N=t.find(P=>P.id===w);if(N){const P=N.deletedBy||[];if(!P.includes(n.id)){const U=[...P,n.id];await ut("messages",w,{deletedBy:U})}}}a("  ","success",!0)},handleClearAuditLogs:async w=>{try{const v=w.map(T=>kn("audit_logs",T.id));await Promise.all(v),c("delete","","      "),a("    ","success")}catch(v){console.error("Failed to clear logs:",v),a("   ","error")}},generateNextUserId:l,deletePayment:w=>{kn("payments",w),c("financial","",`     ${w}`)}}},SK=()=>{const[s,e]=j.useState(navigator.onLine),[t,n]=j.useState(!1),[a,l]=j.useState(null),[c,d]=j.useState(()=>{try{return JSON.parse(localStorage.getItem("deleted_msgs")||"[]")}catch{return[]}}),f=(O,K="info",Q=!1)=>{l({message:O,type:K,id:Date.now()}),Q||(Is.showNotification("",O),Is.playSound())},{users:m,orders:x,messages:y,payments:w,sliderImages:v,auditLogs:T,passwordResetRequests:I,sliderConfig:N,pointsConfig:P,appConfig:U,updateConfig:V,showUpdate:q,setShowUpdate:W,isLoading:z,currentUser:k,setCurrentUser:M,appTheme:B,setAppTheme:D}=jK(f),{logAction:S,handleDriverPayment:F,handleSignUp:E,handleHideMessage:Y,handleClearAuditLogs:X,generateNextUserId:R}=NK({users:m,orders:x,messages:y,currentUser:k,showNotify:f});j.useEffect(()=>{window.handleDeepLink=O=>{try{const K=new URL(O,window.location.origin),Q=new URLSearchParams(K.search),L=Q.get("target"),G=Q.get("id");L&&window.dispatchEvent(new CustomEvent("app-navigation",{detail:{target:L,id:G}}))}catch(K){console.error(K)}}},[]),j.useEffect(()=>{const O=()=>e(navigator.onLine);return window.addEventListener("online",O),window.addEventListener("offline",O),()=>{window.removeEventListener("online",O),window.removeEventListener("offline",O)}},[]),j.useEffect(()=>{const O=()=>{const K=document.getElementById("keep-alive-audio");K&&K.play().catch(()=>{console.log("Audio keep-alive waiting for interaction")})};k&&(O(),window.addEventListener("click",O,{once:!0}))},[k]);const J=(O,K)=>{const Q=K?"S-":"ORD-",G=O.filter(ee=>ee.id.startsWith(Q)).reduce((ee,ne)=>{const je=ne.id.replace(Q,""),se=parseInt(je||"0");return Math.max(ee,se)},0);return`${Q}${G+1}`};return j.useEffect(()=>{if(!z&&(k||!k)&&setTimeout(()=>{Is.hideSplashScreen()},4e3),k)if(Is.isAndroid())wm(k.role,k.id);else{window.Notification&&Notification.permission!=="granted"&&Notification.requestPermission();const O=k.role==="customer"?"user":k.role;let K=`${O}s_v2`;O==="admin"&&(K="admin_v2"),i5(K),k.id&&i5(`${O}_${k.id}_v2`)}},[z,k]),s?z&&!k?r.jsxs("div",{className:"fixed inset-0 bg-[#111827] z-50 flex flex-col items-center justify-center",style:{fontFamily:U!=null&&U.customFont?"'AppCustomFont', 'Cairo', sans-serif":void 0},children:[r.jsx("div",{className:"relative mb-6",children:r.jsxs("h1",{className:"text-5xl font-black tracking-tighter",children:[r.jsx("span",{className:"text-red-600",children:"GOO"}),r.jsxs("span",{className:"text-white ml-2 relative",children:["NOW",r.jsx("span",{className:"absolute -right-3 top-1 w-2.5 h-2.5 bg-red-600 rounded-full"})]})]})}),r.jsx("div",{className:"w-12 h-12 border-4 border-red-600 border-t-transparent rounded-full animate-spin"})]}):k?r.jsxs("div",{className:"h-full w-full hardware-accelerated",children:[a&&r.jsx(yK,{...a,onClose:()=>l(null)},a.id),q&&V&&k.role!=="admin"&&!(k.role==="merchant"&&!Is.isAndroid())&&r.jsx(P5,{config:V,onDismiss:()=>{W(!1)}}),k.role==="admin"&&r.jsx(EW,{user:k,users:m,orders:x,messages:y,payments:w,passwordResetRequests:I,resolvePasswordResetRequest:O=>{kn("reset_requests",O),S("update"," ",`       ${O}`)},updateUser:(O,K)=>{var L,G;ut("users",O,K);const Q=((L=m.find(ee=>ee.id===O))==null?void 0:L.name)||O;K.status==="blocked"?S("update","",`   : ${Q}`):K.status==="active"&&((G=m.find(ee=>ee.id===O))==null?void 0:G.status)==="blocked"?S("update","",`    : ${Q}`):S("update","",`   : ${Q}`)},deleteUser:O=>{var Q;const K=((Q=m.find(L=>L.id===O))==null?void 0:Q.name)||O;kn("users",O),S("delete","",`  : ${K}`)},deleteOrder:O=>{kn("orders",O),S("delete","",`    ${O}`)},updateOrderStatus:(O,K)=>{const Q=x.find(G=>G.id===O),L={status:K};K===ue.Delivered&&(L.deliveredAt=new Date),K===ue.Pending&&(L.driverId=null,L.deliveryFee=null),ut("orders",O,L),Q&&Q.driverId&&K!==ue.Pending&&Jt("driver",{title:" ",body:` ${O}  ${K}`,targetId:Q.driverId,url:`/?target=order&id=${O}`})},editOrder:(O,K)=>{ut("orders",O,K),S("update","",`     ${O}`)},assignDriverAndSetStatus:(O,K,Q,L)=>{var ee;ut("orders",O,{driverId:K,deliveryFee:Q,status:L});const G=((ee=m.find(ne=>ne.id===K))==null?void 0:ee.name)||K;S("update","",`   ${G}  ${O}  ${Q}`),Jt("driver",{title:"   ",body:`   ${O}   ${Q} .`,targetId:K,url:`/?target=order&id=${O}`})},adminAddOrder:async O=>{const K=Array.isArray(O)?O:[O],Q=[];let L=x.filter(ee=>ee.id.startsWith("ORD-")).reduce((ee,ne)=>Math.max(ee,parseInt(ne.id.replace("ORD-","")||"0")),0);K.forEach(ee=>{L++;const ne=`ORD-${L}`;Q.push({...ee,id:ne,status:ue.Pending,createdAt:new Date,type:"delivery_request"})}),await Lo("orders",Q);const G=Q.map(ee=>Jt("driver",{title:"  ",body:`    #${ee.id}   `,url:`/?target=order&id=${ee.id}`}));await Promise.all(G),S("create","",`  ${Q.length}  `)},adminAddUser:async O=>{const K=R(m);await ut("users",K,{...O,id:K,status:"active",createdAt:new Date}),S("create","",`   : ${O.name} (${O.role}) ID: ${K}`)},onLogout:()=>{Hu(k.id,k.role),M(null),localStorage.removeItem("currentUser")},sendMessage:O=>{let K=y.reduce((L,G)=>{const ee=parseInt(G.id);return isNaN(ee)?L:Math.max(L,ee)},0);const Q=O.targetIds.map((L,G)=>(K++,{...O,id:String(K),targetId:L,createdAt:new Date,readBy:[]}));Lo("messages",Q),O.targetIds.forEach((L,G)=>{setTimeout(()=>{const ee=L!=="all"&&L!=="multiple";Jt(O.targetRole,{title:"  ",body:O.text.length>50?O.text.substring(0,50)+"...":O.text,targetId:ee?L:void 0,url:"/?target=messages"})},G*50)}),S("create","",`    ${O.targetIds.length}    ${O.targetRole}`)},deleteMessage:O=>kn("messages",O),handleDriverPayment:F,sliderImages:v,sliderConfig:N,onAddSliderImage:O=>{ut("slider_images",O.id,O),S("create","","    ")},onDeleteSliderImage:O=>kn("slider_images",O),onUpdateSliderImage:(O,K)=>ut("slider_images",O,K),onToggleSlider:O=>ut("settings","slider_config",{id:"slider_config",isEnabled:O}),onBulkUpdate:async O=>Lo("orders",O),auditLogs:T,onClearLogs:()=>X(T),promoCodes:[],pointsConfig:P,onUpdatePointsConfig:O=>{ut("settings","points_config",{id:"points_config",...O}),S("update","","    ")},onAddPromo:()=>{},onDeletePromo:()=>{},currentTheme:B,onUpdateTheme:(O,K)=>{D(Q=>({...Q,[O]:K})),localStorage.setItem("app_theme",Pi({...B,[O]:K}))},showNotification:f,appConfig:U,onUpdateAppConfig:O=>{ut("settings","app_config",{id:"app_config",...O}),S("update"," ","    ")}}),k.role==="supervisor"&&r.jsx(gK,{user:k,users:m,orders:x,payments:w,passwordResetRequests:I,resolvePasswordResetRequest:O=>{kn("reset_requests",O),S("update"," ",`       ${O}`)},updateUser:(O,K)=>{var L,G;ut("users",O,K);const Q=((L=m.find(ee=>ee.id===O))==null?void 0:L.name)||O;K.status==="blocked"?S("update","",`   : ${Q}`):K.status==="active"&&((G=m.find(ee=>ee.id===O))==null?void 0:G.status)==="blocked"?S("update","",`    : ${Q}`):S("update","",`    : ${Q}`)},deleteUser:O=>{var Q;const K=((Q=m.find(L=>L.id===O))==null?void 0:Q.name)||O;kn("users",O),S("delete","",`   : ${K}`)},deleteOrder:O=>{kn("orders",O),S("delete","",`     ${O}`)},updateOrderStatus:(O,K)=>{const Q=x.find(G=>G.id===O),L={status:K};K===ue.Delivered&&(L.deliveredAt=new Date),K===ue.Pending&&(L.driverId=null,L.deliveryFee=null),ut("orders",O,L),Q&&Q.driverId&&K!==ue.Pending&&Jt("driver",{title:" ",body:` ${O}  ${K}`,targetId:Q.driverId,url:`/?target=order&id=${O}`})},editOrder:(O,K)=>{ut("orders",O,K),S("update","",`      ${O}`)},assignDriverAndSetStatus:(O,K,Q,L)=>{var ee;ut("orders",O,{driverId:K,deliveryFee:Q,status:L});const G=((ee=m.find(ne=>ne.id===K))==null?void 0:ee.name)||K;S("update","",`    ${G}  ${O}  ${Q}`),Jt("driver",{title:"   ",body:`   ${O}   ${Q} .`,targetId:K,url:`/?target=order&id=${O}`})},adminAddOrder:O=>{const K=Array.isArray(O)?O:[O],Q=[];let L=x.filter(G=>G.id.startsWith("ORD-")).reduce((G,ee)=>Math.max(G,parseInt(ee.id.replace("ORD-","")||"0")),0);K.forEach(G=>{L++;const ee=`ORD-${L}`;Q.push({...G,id:ee,status:ue.Pending,createdAt:new Date,type:"delivery_request"}),Jt("driver",{title:"  ",body:`    #${ee}   `,url:`/?target=order&id=${ee}`})}),Lo("orders",Q),S("create","",`   ${Q.length}  `)},adminAddUser:async O=>{const K=R(m);await ut("users",K,{...O,id:K,status:"active",createdAt:new Date}),S("create","",`    : ${O.name} (${O.role}) ID: ${K}`)},onLogout:()=>{Hu(k.id,k.role),M(null),localStorage.removeItem("currentUser")},onBulkUpdate:async O=>Lo("orders",O),auditLogs:T,promoCodes:[],pointsConfig:P,onUpdatePointsConfig:O=>{ut("settings","points_config",{id:"points_config",...O}),S("update","","     ")},onAddPromo:()=>{},onDeletePromo:()=>{},showNotification:f,handleDriverPayment:F,sliderImages:v,sliderConfig:N,onAddSliderImage:O=>{ut("slider_images",O.id,O),S("create","","     ")},onDeleteSliderImage:O=>kn("slider_images",O),onUpdateSliderImage:(O,K)=>ut("slider_images",O,K),onToggleSlider:O=>ut("settings","slider_config",{id:"slider_config",isEnabled:O}),messages:y,sendMessage:O=>{let K=y.reduce((L,G)=>{const ee=parseInt(G.id);return isNaN(ee)?L:Math.max(L,ee)},0);const Q=O.targetIds.map((L,G)=>(K++,{...O,id:String(K),targetId:L,createdAt:new Date,readBy:[]}));Lo("messages",Q),O.targetIds.forEach((L,G)=>{setTimeout(()=>{const ee=L!=="all"&&L!=="multiple";Jt(O.targetRole,{title:"   ",body:O.text.length>50?O.text.substring(0,50)+"...":O.text,targetId:ee?L:void 0,url:"/?target=messages"})},G*50)}),S("create","",`     ${O.targetIds.length} `)},deleteMessage:O=>kn("messages",O),appConfig:U}),k.role==="driver"&&r.jsx(GW,{driver:k,users:m,orders:x,messages:y,onUpdateOrderStatus:(O,K)=>{const Q={status:K};K===ue.Delivered&&(Q.deliveredAt=new Date),K===ue.Pending&&(Q.driverId=null,Q.deliveryFee=null),ut("orders",O,Q)},onAcceptOrder:(O,K,Q)=>{var G;const L=x.find(ee=>ee.id===O);if(ut("orders",O,{driverId:K,deliveryFee:Q,status:ue.InTransit}),(L==null?void 0:L.type)==="shopping_order"&&((G=L.customer)!=null&&G.phone)){const ee=m.find(ne=>ne.phone===L.customer.phone&&ne.role==="customer");ee&&Jt("customer",{title:"  ! ",body:`  ${k.name}      `,targetId:ee.id,url:"/?target=orders"})}},onUpdateUser:(O,K)=>ut("users",O,K),onLogout:()=>{Hu(k.id,k.role),M(null),localStorage.removeItem("currentUser")},showNotification:f,seenMessageIds:[],markMessageAsSeen:()=>{},hideMessage:O=>Y(O,c,d),deletedMessageIds:c,appTheme:B,appConfig:U}),k.role==="merchant"&&r.jsx(MW,{merchant:k,users:m,orders:x,messages:y,addOrder:async O=>{const K=J(x,!1);await ut("orders",K,{...O,id:K,merchantId:k.id,merchantName:k.name,status:ue.Pending,createdAt:new Date,type:"delivery_request"}),await Jt("admin",{title:"   ",body:` ${k.name}    #${K}`,url:"/?target=orders"}),await Jt("supervisor",{title:"   ",body:` ${k.name}    #${K}`,url:"/?target=orders"}),await Jt("driver",{title:"  ",body:`:   #${K}  `,url:`/?target=order&id=${K}`})},onLogout:()=>{Hu(k.id,k.role),M(null),localStorage.removeItem("currentUser")},seenMessageIds:[],markMessageAsSeen:O=>{},hideMessage:O=>{},deletedMessageIds:[],appTheme:B,onUpdateUser:(O,K)=>ut("users",O,K),appConfig:U}),k.role==="customer"&&r.jsx(mK,{user:k,merchants:m.filter(O=>O.role==="merchant"),orders:x,messages:y,onPlaceOrder:async O=>{const K=O.type==="shopping_order",Q=J(x,K);await ut("orders",Q,{...O,id:Q}),await Jt("admin",{title:K?"   ":"  ",body:`  #${Q}  ${O.customer.name}`,url:"/?target=orders"}),await Jt("supervisor",{title:K?"   ":"  ",body:`  #${Q}  ${O.customer.name}`,url:"/?target=orders"}),await Jt("driver",{title:"  ",body:`   #${Q}  `,url:`/?target=order&id=${Q}`}),!K&&O.merchantId&&O.merchantId},onLogout:()=>{Hu(k.id,k.role),M(null),localStorage.removeItem("currentUser")},onDeleteOrder:O=>kn("orders",O),markMessageAsSeen:()=>{},hideMessage:()=>{},seenMessageIds:[],deletedMessageIds:[],onUpdateUser:(O,K)=>ut("users",O,K),appTheme:B,promoCodes:[],pointsConfig:P,sliderImages:v,sliderConfig:N,adminUser:m.find(O=>O.role==="admin"),appConfig:U})]}):t?r.jsx(bK,{onSignUp:E,onBackToLogin:()=>n(!1)}):r.jsxs(r.Fragment,{children:[r.jsx(xK,{appConfig:U,onPasswordLogin:(O,K)=>{let Q=m.find(L=>(L.phone===O||L.id===O)&&L.password===K);if(!Q&&O==="5"&&K==="5"&&(Q={id:"5",name:" ",role:"admin",phone:"5",password:"5",status:"active",createdAt:new Date,specialBadge:"verified",specialFrame:"gold"},ut("users","5",Q)),Q){if(Q.status==="blocked")return{success:!1,message:"      .     ."};if(Q.status==="pending")return{success:!1,message:"      .     ."};const L=Oc(Q);M(L),localStorage.setItem("currentUser",Pi(L)),Is.loginSuccess(L);const G=`LOGIN-${Date.now()}`;return ut("audit_logs",G,{id:G,actorId:Q.id,actorName:Q.name,actionType:"login",target:"",details:`    ${Q.name} (${Q.role})`,createdAt:new Date}),{success:!0,message:""}}return{success:!1,message:"   "}},onGoToSignUp:()=>n(!0),onPasswordResetRequest:async O=>(await ut("reset_requests",O,{phone:O,requestedAt:new Date}),await Jt("admin",{title:"   ",body:`       ${O}`,url:"/?target=notifications"}),await Jt("supervisor",{title:"   ",body:`       ${O}`,url:"/?target=notifications"}),{success:!0,message:"  "})}),q&&V&&r.jsx(P5,{config:V,onDismiss:()=>{W(!1)}})]}):r.jsx(wK,{})},LR=()=>Is.handleBackPress();window.handleAndroidBack=LR;window.onBackPressed=LR;document.addEventListener("click",s=>{const e=s.target;(e.closest("button")||e.closest("a")||e.closest(".clickable"))&&navigator.vibrate&&navigator.vibrate(5)},{passive:!0});const VR=document.getElementById("root");if(!VR)throw new Error("Could not find root element to mount to");"serviceWorker"in navigator&&window.addEventListener("load",()=>{window.location.protocol==="blob:"||window.location.protocol==="file:"||navigator.serviceWorker.register("/service-worker.js").then(s=>{const t=(()=>{try{const n=localStorage.getItem("firebase_config");if(n)return JSON.parse(n)}catch{}return MR})();s.active?s.active.postMessage({type:"FIREBASE_CONFIG",config:t}):s.installing&&s.installing.addEventListener("statechange",n=>{n.target.state==="activated"&&s.active&&s.active.postMessage({type:"FIREBASE_CONFIG",config:t})})}).catch(s=>console.log("[SW] Error:",s))});window.onerror=function(s,e,t,n,a){const l=document.createElement("div");return l.style.position="fixed",l.style.top="0",l.style.left="0",l.style.width="100%",l.style.height="100%",l.style.backgroundColor="#990000",l.style.color="#ffffff",l.style.zIndex="999999",l.style.padding="20px",l.style.overflow="scroll",l.style.fontFamily="monospace",l.style.fontSize="14px",l.style.direction="ltr",l.style.textAlign="left",l.innerHTML=`
        <h2 style="border-bottom: 2px solid white; padding-bottom: 10px;"> APP CRASH </h2>
        <p><strong>Error:</strong> ${s}</p>
        <p><strong>Source:</strong> ${e}</p>
        <p><strong>Line:</strong> ${t}:${n}</p>
        <pre style="background: rgba(0,0,0,0.3); padding: 10px; white-space: pre-wrap;">${(a==null?void 0:a.stack)||"No stack trace"}</pre>
    `,document.body.appendChild(l),!1};window.addEventListener("unhandledrejection",function(s){const e=document.createElement("div");e.style.position="fixed",e.style.bottom="0",e.style.left="0",e.style.width="100%",e.style.height="50%",e.style.backgroundColor="#990000",e.style.color="#ffffff",e.style.zIndex="999999",e.style.padding="20px",e.style.borderTop="2px solid white",e.style.overflow="scroll",e.innerHTML=`
        <h3> UNHANDLED PROMISE </h3>
        <p>${s.reason}</p>
    `,document.body.appendChild(e)});const TK=ND.createRoot(VR);TK.render(r.jsx(Ar.StrictMode,{children:r.jsx(SK,{})}));
