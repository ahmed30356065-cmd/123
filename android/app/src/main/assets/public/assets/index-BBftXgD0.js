(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function t(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(i){if(i.ep)return;i.ep=!0;const l=t(i);fetch(i.href,l)}})();function v3(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var kb={exports:{}},mh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t_;function w3(){if(t_)return mh;t_=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,i,l){var d=null;if(l!==void 0&&(d=""+l),i.key!==void 0&&(d=""+i.key),"key"in i){l={};for(var h in i)h!=="key"&&(l[h]=i[h])}else l=i;return i=l.ref,{$$typeof:s,type:r,key:d,ref:i!==void 0?i:null,props:l}}return mh.Fragment=e,mh.jsx=t,mh.jsxs=t,mh}var s_;function j3(){return s_||(s_=1,kb.exports=w3()),kb.exports}var n=j3(),Cb={exports:{}},ct={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n_;function N3(){if(n_)return ct;n_=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),d=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),v=Symbol.iterator;function N(R){return R===null||typeof R!="object"?null:(R=v&&R[v]||R["@@iterator"],typeof R=="function"?R:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,T={};function L(R,V,X){this.props=R,this.context=V,this.refs=T,this.updater=X||E}L.prototype.isReactComponent={},L.prototype.setState=function(R,V){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,V,"setState")},L.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function $(){}$.prototype=L.prototype;function B(R,V,X){this.props=R,this.context=V,this.refs=T,this.updater=X||E}var Q=B.prototype=new $;Q.constructor=B,I(Q,L.prototype),Q.isPureReactComponent=!0;var Z=Array.isArray;function Y(){}var C={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function U(R,V,X){var H=X.ref;return{$$typeof:s,type:R,key:V,ref:H!==void 0?H:null,props:X}}function O(R,V){return U(R.type,V,R.props)}function D(R){return typeof R=="object"&&R!==null&&R.$$typeof===s}function F(R){var V={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(X){return V[X]})}var S=/\/+/g;function ae(R,V){return typeof R=="object"&&R!==null&&R.key!=null?F(""+R.key):V.toString(36)}function K(R){switch(R.status){case"fulfilled":return R.value;case"rejected":throw R.reason;default:switch(typeof R.status=="string"?R.then(Y,Y):(R.status="pending",R.then(function(V){R.status==="pending"&&(R.status="fulfilled",R.value=V)},function(V){R.status==="pending"&&(R.status="rejected",R.reason=V)})),R.status){case"fulfilled":return R.value;case"rejected":throw R.reason}}throw R}function k(R,V,X,H,se){var J=typeof R;(J==="undefined"||J==="boolean")&&(R=null);var oe=!1;if(R===null)oe=!0;else switch(J){case"bigint":case"string":case"number":oe=!0;break;case"object":switch(R.$$typeof){case s:case e:oe=!0;break;case b:return oe=R._init,k(oe(R._payload),V,X,H,se)}}if(oe)return se=se(R),oe=H===""?"."+ae(R,0):H,Z(se)?(X="",oe!=null&&(X=oe.replace(S,"$&/")+"/"),k(se,V,X,"",function(Pe){return Pe})):se!=null&&(D(se)&&(se=O(se,X+(se.key==null||R&&R.key===se.key?"":(""+se.key).replace(S,"$&/")+"/")+oe)),V.push(se)),1;oe=0;var je=H===""?".":H+":";if(Z(R))for(var ye=0;ye<R.length;ye++)H=R[ye],J=je+ae(H,ye),oe+=k(H,V,X,J,se);else if(ye=N(R),typeof ye=="function")for(R=ye.call(R),ye=0;!(H=R.next()).done;)H=H.value,J=je+ae(H,ye++),oe+=k(H,V,X,J,se);else if(J==="object"){if(typeof R.then=="function")return k(K(R),V,X,H,se);throw V=String(R),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return oe}function q(R,V,X){if(R==null)return R;var H=[],se=0;return k(R,H,"","",function(J){return V.call(X,J,se++)}),H}function W(R){if(R._status===-1){var V=R._result;V=V(),V.then(function(X){(R._status===0||R._status===-1)&&(R._status=1,R._result=X)},function(X){(R._status===0||R._status===-1)&&(R._status=2,R._result=X)}),R._status===-1&&(R._status=0,R._result=V)}if(R._status===1)return R._result.default;throw R._result}var ne=typeof reportError=="function"?reportError:function(R){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof R=="object"&&R!==null&&typeof R.message=="string"?String(R.message):String(R),error:R});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",R);return}console.error(R)},M={map:q,forEach:function(R,V,X){q(R,function(){V.apply(this,arguments)},X)},count:function(R){var V=0;return q(R,function(){V++}),V},toArray:function(R){return q(R,function(V){return V})||[]},only:function(R){if(!D(R))throw Error("React.Children.only expected to receive a single React element child.");return R}};return ct.Activity=y,ct.Children=M,ct.Component=L,ct.Fragment=t,ct.Profiler=i,ct.PureComponent=B,ct.StrictMode=r,ct.Suspense=f,ct.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,ct.__COMPILER_RUNTIME={__proto__:null,c:function(R){return C.H.useMemoCache(R)}},ct.cache=function(R){return function(){return R.apply(null,arguments)}},ct.cacheSignal=function(){return null},ct.cloneElement=function(R,V,X){if(R==null)throw Error("The argument must be a React element, but you passed "+R+".");var H=I({},R.props),se=R.key;if(V!=null)for(J in V.key!==void 0&&(se=""+V.key),V)!P.call(V,J)||J==="key"||J==="__self"||J==="__source"||J==="ref"&&V.ref===void 0||(H[J]=V[J]);var J=arguments.length-2;if(J===1)H.children=X;else if(1<J){for(var oe=Array(J),je=0;je<J;je++)oe[je]=arguments[je+2];H.children=oe}return U(R.type,se,H)},ct.createContext=function(R){return R={$$typeof:d,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null},R.Provider=R,R.Consumer={$$typeof:l,_context:R},R},ct.createElement=function(R,V,X){var H,se={},J=null;if(V!=null)for(H in V.key!==void 0&&(J=""+V.key),V)P.call(V,H)&&H!=="key"&&H!=="__self"&&H!=="__source"&&(se[H]=V[H]);var oe=arguments.length-2;if(oe===1)se.children=X;else if(1<oe){for(var je=Array(oe),ye=0;ye<oe;ye++)je[ye]=arguments[ye+2];se.children=je}if(R&&R.defaultProps)for(H in oe=R.defaultProps,oe)se[H]===void 0&&(se[H]=oe[H]);return U(R,J,se)},ct.createRef=function(){return{current:null}},ct.forwardRef=function(R){return{$$typeof:h,render:R}},ct.isValidElement=D,ct.lazy=function(R){return{$$typeof:b,_payload:{_status:-1,_result:R},_init:W}},ct.memo=function(R,V){return{$$typeof:m,type:R,compare:V===void 0?null:V}},ct.startTransition=function(R){var V=C.T,X={};C.T=X;try{var H=R(),se=C.S;se!==null&&se(X,H),typeof H=="object"&&H!==null&&typeof H.then=="function"&&H.then(Y,ne)}catch(J){ne(J)}finally{V!==null&&X.types!==null&&(V.types=X.types),C.T=V}},ct.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},ct.use=function(R){return C.H.use(R)},ct.useActionState=function(R,V,X){return C.H.useActionState(R,V,X)},ct.useCallback=function(R,V){return C.H.useCallback(R,V)},ct.useContext=function(R){return C.H.useContext(R)},ct.useDebugValue=function(){},ct.useDeferredValue=function(R,V){return C.H.useDeferredValue(R,V)},ct.useEffect=function(R,V){return C.H.useEffect(R,V)},ct.useEffectEvent=function(R){return C.H.useEffectEvent(R)},ct.useId=function(){return C.H.useId()},ct.useImperativeHandle=function(R,V,X){return C.H.useImperativeHandle(R,V,X)},ct.useInsertionEffect=function(R,V){return C.H.useInsertionEffect(R,V)},ct.useLayoutEffect=function(R,V){return C.H.useLayoutEffect(R,V)},ct.useMemo=function(R,V){return C.H.useMemo(R,V)},ct.useOptimistic=function(R,V){return C.H.useOptimistic(R,V)},ct.useReducer=function(R,V,X){return C.H.useReducer(R,V,X)},ct.useRef=function(R){return C.H.useRef(R)},ct.useState=function(R){return C.H.useState(R)},ct.useSyncExternalStore=function(R,V,X){return C.H.useSyncExternalStore(R,V,X)},ct.useTransition=function(){return C.H.useTransition()},ct.version="19.2.3",ct}var r_;function yv(){return r_||(r_=1,Cb.exports=N3()),Cb.exports}var w=yv();const Is=v3(w);var Rb={exports:{}},gh={},Db={exports:{}},Ob={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a_;function _3(){return a_||(a_=1,(function(s){function e(k,q){var W=k.length;k.push(q);e:for(;0<W;){var ne=W-1>>>1,M=k[ne];if(0<i(M,q))k[ne]=q,k[W]=M,W=ne;else break e}}function t(k){return k.length===0?null:k[0]}function r(k){if(k.length===0)return null;var q=k[0],W=k.pop();if(W!==q){k[0]=W;e:for(var ne=0,M=k.length,R=M>>>1;ne<R;){var V=2*(ne+1)-1,X=k[V],H=V+1,se=k[H];if(0>i(X,W))H<M&&0>i(se,X)?(k[ne]=se,k[H]=W,ne=H):(k[ne]=X,k[V]=W,ne=V);else if(H<M&&0>i(se,W))k[ne]=se,k[H]=W,ne=H;else break e}}return q}function i(k,q){var W=k.sortIndex-q.sortIndex;return W!==0?W:k.id-q.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;s.unstable_now=function(){return l.now()}}else{var d=Date,h=d.now();s.unstable_now=function(){return d.now()-h}}var f=[],m=[],b=1,y=null,v=3,N=!1,E=!1,I=!1,T=!1,L=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;function Q(k){for(var q=t(m);q!==null;){if(q.callback===null)r(m);else if(q.startTime<=k)r(m),q.sortIndex=q.expirationTime,e(f,q);else break;q=t(m)}}function Z(k){if(I=!1,Q(k),!E)if(t(f)!==null)E=!0,Y||(Y=!0,F());else{var q=t(m);q!==null&&K(Z,q.startTime-k)}}var Y=!1,C=-1,P=5,U=-1;function O(){return T?!0:!(s.unstable_now()-U<P)}function D(){if(T=!1,Y){var k=s.unstable_now();U=k;var q=!0;try{e:{E=!1,I&&(I=!1,$(C),C=-1),N=!0;var W=v;try{t:{for(Q(k),y=t(f);y!==null&&!(y.expirationTime>k&&O());){var ne=y.callback;if(typeof ne=="function"){y.callback=null,v=y.priorityLevel;var M=ne(y.expirationTime<=k);if(k=s.unstable_now(),typeof M=="function"){y.callback=M,Q(k),q=!0;break t}y===t(f)&&r(f),Q(k)}else r(f);y=t(f)}if(y!==null)q=!0;else{var R=t(m);R!==null&&K(Z,R.startTime-k),q=!1}}break e}finally{y=null,v=W,N=!1}q=void 0}}finally{q?F():Y=!1}}}var F;if(typeof B=="function")F=function(){B(D)};else if(typeof MessageChannel<"u"){var S=new MessageChannel,ae=S.port2;S.port1.onmessage=D,F=function(){ae.postMessage(null)}}else F=function(){L(D,0)};function K(k,q){C=L(function(){k(s.unstable_now())},q)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(k){k.callback=null},s.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<k?Math.floor(1e3/k):5},s.unstable_getCurrentPriorityLevel=function(){return v},s.unstable_next=function(k){switch(v){case 1:case 2:case 3:var q=3;break;default:q=v}var W=v;v=q;try{return k()}finally{v=W}},s.unstable_requestPaint=function(){T=!0},s.unstable_runWithPriority=function(k,q){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var W=v;v=k;try{return q()}finally{v=W}},s.unstable_scheduleCallback=function(k,q,W){var ne=s.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?ne+W:ne):W=ne,k){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=W+M,k={id:b++,callback:q,priorityLevel:k,startTime:W,expirationTime:M,sortIndex:-1},W>ne?(k.sortIndex=W,e(m,k),t(f)===null&&k===t(m)&&(I?($(C),C=-1):I=!0,K(Z,W-ne))):(k.sortIndex=M,e(f,k),E||N||(E=!0,Y||(Y=!0,F()))),k},s.unstable_shouldYield=O,s.unstable_wrapCallback=function(k){var q=v;return function(){var W=v;v=q;try{return k.apply(this,arguments)}finally{v=W}}}})(Ob)),Ob}var i_;function T3(){return i_||(i_=1,Db.exports=_3()),Db.exports}var Pb={exports:{}},vn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o_;function S3(){if(o_)return vn;o_=1;var s=yv();function e(f){var m="https://react.dev/errors/"+f;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)m+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+f+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function l(f,m,b){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:y==null?null:""+y,children:f,containerInfo:m,implementation:b}}var d=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(f,m){if(f==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return vn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,vn.createPortal=function(f,m){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(f,m,null,b)},vn.flushSync=function(f){var m=d.T,b=r.p;try{if(d.T=null,r.p=2,f)return f()}finally{d.T=m,r.p=b,r.d.f()}},vn.preconnect=function(f,m){typeof f=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,r.d.C(f,m))},vn.prefetchDNS=function(f){typeof f=="string"&&r.d.D(f)},vn.preinit=function(f,m){if(typeof f=="string"&&m&&typeof m.as=="string"){var b=m.as,y=h(b,m.crossOrigin),v=typeof m.integrity=="string"?m.integrity:void 0,N=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;b==="style"?r.d.S(f,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:y,integrity:v,fetchPriority:N}):b==="script"&&r.d.X(f,{crossOrigin:y,integrity:v,fetchPriority:N,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},vn.preinitModule=function(f,m){if(typeof f=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var b=h(m.as,m.crossOrigin);r.d.M(f,{crossOrigin:b,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&r.d.M(f)},vn.preload=function(f,m){if(typeof f=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var b=m.as,y=h(b,m.crossOrigin);r.d.L(f,b,{crossOrigin:y,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},vn.preloadModule=function(f,m){if(typeof f=="string")if(m){var b=h(m.as,m.crossOrigin);r.d.m(f,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:b,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else r.d.m(f)},vn.requestFormReset=function(f){r.d.r(f)},vn.unstable_batchedUpdates=function(f,m){return f(m)},vn.useFormState=function(f,m,b){return d.H.useFormState(f,m,b)},vn.useFormStatus=function(){return d.H.useHostTransitionStatus()},vn.version="19.2.3",vn}var l_;function aS(){if(l_)return Pb.exports;l_=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Pb.exports=S3(),Pb.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c_;function E3(){if(c_)return gh;c_=1;var s=T3(),e=yv(),t=aS();function r(a){var o="https://react.dev/errors/"+a;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+a+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function l(a){var o=a,c=a;if(a.alternate)for(;o.return;)o=o.return;else{a=o;do o=a,(o.flags&4098)!==0&&(c=o.return),a=o.return;while(a)}return o.tag===3?c:null}function d(a){if(a.tag===13){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function h(a){if(a.tag===31){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function f(a){if(l(a)!==a)throw Error(r(188))}function m(a){var o=a.alternate;if(!o){if(o=l(a),o===null)throw Error(r(188));return o!==a?null:a}for(var c=a,u=o;;){var p=c.return;if(p===null)break;var x=p.alternate;if(x===null){if(u=p.return,u!==null){c=u;continue}break}if(p.child===x.child){for(x=p.child;x;){if(x===c)return f(p),a;if(x===u)return f(p),o;x=x.sibling}throw Error(r(188))}if(c.return!==u.return)c=p,u=x;else{for(var _=!1,z=p.child;z;){if(z===c){_=!0,c=p,u=x;break}if(z===u){_=!0,u=p,c=x;break}z=z.sibling}if(!_){for(z=x.child;z;){if(z===c){_=!0,c=x,u=p;break}if(z===u){_=!0,u=x,c=p;break}z=z.sibling}if(!_)throw Error(r(189))}}if(c.alternate!==u)throw Error(r(190))}if(c.tag!==3)throw Error(r(188));return c.stateNode.current===c?a:o}function b(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a;for(a=a.child;a!==null;){if(o=b(a),o!==null)return o;a=a.sibling}return null}var y=Object.assign,v=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),$=Symbol.for("react.consumer"),B=Symbol.for("react.context"),Q=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function F(a){return a===null||typeof a!="object"?null:(a=D&&a[D]||a["@@iterator"],typeof a=="function"?a:null)}var S=Symbol.for("react.client.reference");function ae(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===S?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case I:return"Fragment";case L:return"Profiler";case T:return"StrictMode";case Z:return"Suspense";case Y:return"SuspenseList";case U:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case E:return"Portal";case B:return a.displayName||"Context";case $:return(a._context.displayName||"Context")+".Consumer";case Q:var o=a.render;return a=a.displayName,a||(a=o.displayName||o.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case C:return o=a.displayName||null,o!==null?o:ae(a.type)||"Memo";case P:o=a._payload,a=a._init;try{return ae(a(o))}catch{}}return null}var K=Array.isArray,k=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W={pending:!1,data:null,method:null,action:null},ne=[],M=-1;function R(a){return{current:a}}function V(a){0>M||(a.current=ne[M],ne[M]=null,M--)}function X(a,o){M++,ne[M]=a.current,a.current=o}var H=R(null),se=R(null),J=R(null),oe=R(null);function je(a,o){switch(X(J,o),X(se,a),X(H,null),o.nodeType){case 9:case 11:a=(a=o.documentElement)&&(a=a.namespaceURI)?_N(a):0;break;default:if(a=o.tagName,o=o.namespaceURI)o=_N(o),a=TN(o,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}V(H),X(H,a)}function ye(){V(H),V(se),V(J)}function Pe(a){a.memoizedState!==null&&X(oe,a);var o=H.current,c=TN(o,a.type);o!==c&&(X(se,a),X(H,c))}function Fe(a){se.current===a&&(V(H),V(se)),oe.current===a&&(V(oe),dh._currentValue=W)}var Re,lt;function We(a){if(Re===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);Re=o&&o[1]||"",lt=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Re+a+lt}var it=!1;function ke(a,o){if(!a||it)return"";it=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(o){var Ee=function(){throw Error()};if(Object.defineProperty(Ee.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ee,[])}catch(ve){var me=ve}Reflect.construct(a,[],Ee)}else{try{Ee.call()}catch(ve){me=ve}a.call(Ee.prototype)}}else{try{throw Error()}catch(ve){me=ve}(Ee=a())&&typeof Ee.catch=="function"&&Ee.catch(function(){})}}catch(ve){if(ve&&me&&typeof ve.stack=="string")return[ve.stack,me.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=u.DetermineComponentFrameRoot(),_=x[0],z=x[1];if(_&&z){var te=_.split(`
`),he=z.split(`
`);for(p=u=0;u<te.length&&!te[u].includes("DetermineComponentFrameRoot");)u++;for(;p<he.length&&!he[p].includes("DetermineComponentFrameRoot");)p++;if(u===te.length||p===he.length)for(u=te.length-1,p=he.length-1;1<=u&&0<=p&&te[u]!==he[p];)p--;for(;1<=u&&0<=p;u--,p--)if(te[u]!==he[p]){if(u!==1||p!==1)do if(u--,p--,0>p||te[u]!==he[p]){var Ne=`
`+te[u].replace(" at new "," at ");return a.displayName&&Ne.includes("<anonymous>")&&(Ne=Ne.replace("<anonymous>",a.displayName)),Ne}while(1<=u&&0<=p);break}}}finally{it=!1,Error.prepareStackTrace=c}return(c=a?a.displayName||a.name:"")?We(c):""}function et(a,o){switch(a.tag){case 26:case 27:case 5:return We(a.type);case 16:return We("Lazy");case 13:return a.child!==o&&o!==null?We("Suspense Fallback"):We("Suspense");case 19:return We("SuspenseList");case 0:case 15:return ke(a.type,!1);case 11:return ke(a.type.render,!1);case 1:return ke(a.type,!0);case 31:return We("Activity");default:return""}}function ge(a){try{var o="",c=null;do o+=et(a,c),c=a,a=a.return;while(a);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var ee=Object.prototype.hasOwnProperty,fe=s.unstable_scheduleCallback,_e=s.unstable_cancelCallback,Me=s.unstable_shouldYield,st=s.unstable_requestPaint,tt=s.unstable_now,Ie=s.unstable_getCurrentPriorityLevel,$e=s.unstable_ImmediatePriority,bt=s.unstable_UserBlockingPriority,Lt=s.unstable_NormalPriority,At=s.unstable_LowPriority,os=s.unstable_IdlePriority,nn=s.log,Te=s.unstable_setDisableYieldValue,we=null,De=null;function pe(a){if(typeof nn=="function"&&Te(a),De&&typeof De.setStrictMode=="function")try{De.setStrictMode(we,a)}catch{}}var Le=Math.clz32?Math.clz32:pt,qe=Math.log,Ze=Math.LN2;function pt(a){return a>>>=0,a===0?32:31-(qe(a)/Ze|0)|0}var mt=256,Ns=262144,Dt=4194304;function Cs(a){var o=a&42;if(o!==0)return o;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Un(a,o,c){var u=a.pendingLanes;if(u===0)return 0;var p=0,x=a.suspendedLanes,_=a.pingedLanes;a=a.warmLanes;var z=u&134217727;return z!==0?(u=z&~x,u!==0?p=Cs(u):(_&=z,_!==0?p=Cs(_):c||(c=z&~a,c!==0&&(p=Cs(c))))):(z=u&~x,z!==0?p=Cs(z):_!==0?p=Cs(_):c||(c=u&~a,c!==0&&(p=Cs(c)))),p===0?0:o!==0&&o!==p&&(o&x)===0&&(x=p&-p,c=o&-o,x>=c||x===32&&(c&4194048)!==0)?o:p}function Fr(a,o){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&o)===0}function Op(a,o){switch(a){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xf(){var a=Dt;return Dt<<=1,(Dt&62914560)===0&&(Dt=4194304),a}function ia(a){for(var o=[],c=0;31>c;c++)o.push(a);return o}function Ko(a,o){a.pendingLanes|=o,o!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Pp(a,o,c,u,p,x){var _=a.pendingLanes;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=c,a.entangledLanes&=c,a.errorRecoveryDisabledLanes&=c,a.shellSuspendCounter=0;var z=a.entanglements,te=a.expirationTimes,he=a.hiddenUpdates;for(c=_&~c;0<c;){var Ne=31-Le(c),Ee=1<<Ne;z[Ne]=0,te[Ne]=-1;var me=he[Ne];if(me!==null)for(he[Ne]=null,Ne=0;Ne<me.length;Ne++){var ve=me[Ne];ve!==null&&(ve.lane&=-536870913)}c&=~Ee}u!==0&&Qo(a,u,0),x!==0&&p===0&&a.tag!==0&&(a.suspendedLanes|=x&~(_&~o))}function Qo(a,o,c){a.pendingLanes|=o,a.suspendedLanes&=~o;var u=31-Le(o);a.entangledLanes|=o,a.entanglements[u]=a.entanglements[u]|1073741824|c&261930}function gu(a,o){var c=a.entangledLanes|=o;for(a=a.entanglements;c;){var u=31-Le(c),p=1<<u;p&o|a[u]&o&&(a[u]|=o),c&=~p}}function pu(a,o){var c=o&-o;return c=(c&42)!==0?1:Yo(c),(c&(a.suspendedLanes|o))!==0?0:c}function Yo(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Wa(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Jf(){var a=q.p;return a!==0?a:(a=window.event,a===void 0?32:KN(a.type))}function Br(a,o){var c=q.p;try{return q.p=a,o()}finally{q.p=c}}var zr=Math.random().toString(36).slice(2),Rs="__reactFiber$"+zr,Qs="__reactProps$"+zr,oa="__reactContainer$"+zr,gc="__reactEvents$"+zr,Mp="__reactListeners$"+zr,Zf="__reactHandles$"+zr,em="__reactResources$"+zr,la="__reactMarker$"+zr;function pc(a){delete a[Rs],delete a[Qs],delete a[gc],delete a[Mp],delete a[Zf]}function ca(a){var o=a[Rs];if(o)return o;for(var c=a.parentNode;c;){if(o=c[oa]||c[Rs]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(a=RN(a);a!==null;){if(c=a[Rs])return c;a=RN(a)}return o}a=c,c=a.parentNode}return null}function br(a){if(a=a[Rs]||a[oa]){var o=a.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return a}return null}function er(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a.stateNode;throw Error(r(33))}function da(a){var o=a[em];return o||(o=a[em]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Ds(a){a[la]=!0}var xu=new Set,bu={};function ua(a,o){ha(a,o),ha(a+"Capture",o)}function ha(a,o){for(bu[a]=o,a=0;a<o.length;a++)xu.add(o[a])}var yu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),vu={},wu={};function tm(a){return ee.call(wu,a)?!0:ee.call(vu,a)?!1:yu.test(a)?wu[a]=!0:(vu[a]=!0,!1)}function xc(a,o,c){if(tm(o))if(c===null)a.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":a.removeAttribute(o);return;case"boolean":var u=o.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){a.removeAttribute(o);return}}a.setAttribute(o,""+c)}}function tr(a,o,c){if(c===null)a.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(o);return}a.setAttribute(o,""+c)}}function Os(a,o,c,u){if(u===null)a.removeAttribute(c);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttributeNS(o,c,""+u)}}function Ys(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Pi(a){var o=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function ju(a,o,c){var u=Object.getOwnPropertyDescriptor(a.constructor.prototype,o);if(!a.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var p=u.get,x=u.set;return Object.defineProperty(a,o,{configurable:!0,get:function(){return p.call(this)},set:function(_){c=""+_,x.call(this,_)}}),Object.defineProperty(a,o,{enumerable:u.enumerable}),{getValue:function(){return c},setValue:function(_){c=""+_},stopTracking:function(){a._valueTracker=null,delete a[o]}}}}function Bt(a){if(!a._valueTracker){var o=Pi(a)?"checked":"value";a._valueTracker=ju(a,o,""+a[o])}}function Xo(a){if(!a)return!1;var o=a._valueTracker;if(!o)return!0;var c=o.getValue(),u="";return a&&(u=Pi(a)?a.checked?"true":"false":a.value),a=u,a!==c?(o.setValue(a),!0):!1}function fa(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Jo=/[\n"\\]/g;function Fn(a){return a.replace(Jo,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function bc(a,o,c,u,p,x,_,z){a.name="",_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?a.type=_:a.removeAttribute("type"),o!=null?_==="number"?(o===0&&a.value===""||a.value!=o)&&(a.value=""+Ys(o)):a.value!==""+Ys(o)&&(a.value=""+Ys(o)):_!=="submit"&&_!=="reset"||a.removeAttribute("value"),o!=null?Nu(a,_,Ys(o)):c!=null?Nu(a,_,Ys(c)):u!=null&&a.removeAttribute("value"),p==null&&x!=null&&(a.defaultChecked=!!x),p!=null&&(a.checked=p&&typeof p!="function"&&typeof p!="symbol"),z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?a.name=""+Ys(z):a.removeAttribute("name")}function sm(a,o,c,u,p,x,_,z){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(a.type=x),o!=null||c!=null){if(!(x!=="submit"&&x!=="reset"||o!=null)){Bt(a);return}c=c!=null?""+Ys(c):"",o=o!=null?""+Ys(o):c,z||o===a.value||(a.value=o),a.defaultValue=o}u=u??p,u=typeof u!="function"&&typeof u!="symbol"&&!!u,a.checked=z?a.checked:!!u,a.defaultChecked=!!u,_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(a.name=_),Bt(a)}function Nu(a,o,c){o==="number"&&fa(a.ownerDocument)===a||a.defaultValue===""+c||(a.defaultValue=""+c)}function Mi(a,o,c,u){if(a=a.options,o){o={};for(var p=0;p<c.length;p++)o["$"+c[p]]=!0;for(c=0;c<a.length;c++)p=o.hasOwnProperty("$"+a[c].value),a[c].selected!==p&&(a[c].selected=p),p&&u&&(a[c].defaultSelected=!0)}else{for(c=""+Ys(c),o=null,p=0;p<a.length;p++){if(a[p].value===c){a[p].selected=!0,u&&(a[p].defaultSelected=!0);return}o!==null||a[p].disabled||(o=a[p])}o!==null&&(o.selected=!0)}}function nm(a,o,c){if(o!=null&&(o=""+Ys(o),o!==a.value&&(a.value=o),c==null)){a.defaultValue!==o&&(a.defaultValue=o);return}a.defaultValue=c!=null?""+Ys(c):""}function Li(a,o,c,u){if(o==null){if(u!=null){if(c!=null)throw Error(r(92));if(K(u)){if(1<u.length)throw Error(r(93));u=u[0]}c=u}c==null&&(c=""),o=c}c=Ys(o),a.defaultValue=c,u=a.textContent,u===c&&u!==""&&u!==null&&(a.value=u),Bt(a)}function Bn(a,o){if(o){var c=a.firstChild;if(c&&c===a.lastChild&&c.nodeType===3){c.nodeValue=o;return}}a.textContent=o}var rm=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function _u(a,o,c){var u=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?u?a.setProperty(o,""):o==="float"?a.cssFloat="":a[o]="":u?a.setProperty(o,c):typeof c!="number"||c===0||rm.has(o)?o==="float"?a.cssFloat=c:a[o]=(""+c).trim():a[o]=c+"px"}function Tu(a,o,c){if(o!=null&&typeof o!="object")throw Error(r(62));if(a=a.style,c!=null){for(var u in c)!c.hasOwnProperty(u)||o!=null&&o.hasOwnProperty(u)||(u.indexOf("--")===0?a.setProperty(u,""):u==="float"?a.cssFloat="":a[u]="");for(var p in o)u=o[p],o.hasOwnProperty(p)&&c[p]!==u&&_u(a,p,u)}else for(var x in o)o.hasOwnProperty(x)&&_u(a,x,o[x])}function yc(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var am=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Vi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function vc(a){return Vi.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function $r(){}var Su=null;function yr(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Ui=null,ma=null;function Zo(a){var o=br(a);if(o&&(a=o.stateNode)){var c=a[Qs]||null;e:switch(a=o.stateNode,o.type){case"input":if(bc(a,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=a;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Fn(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var u=c[o];if(u!==a&&u.form===a.form){var p=u[Qs]||null;if(!p)throw Error(r(90));bc(u,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(o=0;o<c.length;o++)u=c[o],u.form===a.form&&Xo(u)}break e;case"textarea":nm(a,c.value,c.defaultValue);break e;case"select":o=c.value,o!=null&&Mi(a,!!c.multiple,o,!1)}}}var wc=!1;function Fi(a,o,c){if(wc)return a(o,c);wc=!0;try{var u=a(o);return u}finally{if(wc=!1,(Ui!==null||ma!==null)&&(Jm(),Ui&&(o=Ui,a=ma,ma=Ui=null,Zo(o),a)))for(o=0;o<a.length;o++)Zo(a[o])}}function qr(a,o){var c=a.stateNode;if(c===null)return null;var u=c[Qs]||null;if(u===null)return null;c=u[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(a=a.type,u=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!u;break e;default:a=!1}if(a)return null;if(c&&typeof c!="function")throw Error(r(231,o,typeof c));return c}var vr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),el=!1;if(vr)try{var Kt={};Object.defineProperty(Kt,"passive",{get:function(){el=!0}}),window.addEventListener("test",Kt,Kt),window.removeEventListener("test",Kt,Kt)}catch{el=!1}var ga=null,Eu=null,tl=null;function Iu(){if(tl)return tl;var a,o=Eu,c=o.length,u,p="value"in ga?ga.value:ga.textContent,x=p.length;for(a=0;a<c&&o[a]===p[a];a++);var _=c-a;for(u=1;u<=_&&o[c-u]===p[x-u];u++);return tl=p.slice(a,1<u?1-u:void 0)}function sl(a){var o=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&o===13&&(a=13)):a=o,a===10&&(a=13),32<=a||a===13?a:0}function Ka(){return!0}function Hr(){return!1}function rn(a){function o(c,u,p,x,_){this._reactName=c,this._targetInst=p,this.type=u,this.nativeEvent=x,this.target=_,this.currentTarget=null;for(var z in a)a.hasOwnProperty(z)&&(c=a[z],this[z]=c?c(x):x[z]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Ka:Hr,this.isPropagationStopped=Hr,this}return y(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Ka)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Ka)},persist:function(){},isPersistent:Ka}),o}var Qa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pa=rn(Qa),Bi=y({},Qa,{view:0,detail:0}),Au=rn(Bi),zi,jc,xa,Nc=y({},Bi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$i,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==xa&&(xa&&a.type==="mousemove"?(zi=a.screenX-xa.screenX,jc=a.screenY-xa.screenY):jc=zi=0,xa=a),zi)},movementY:function(a){return"movementY"in a?a.movementY:jc}}),ku=rn(Nc),nl=y({},Nc,{dataTransfer:0}),im=rn(nl),om=y({},Bi,{relatedTarget:0}),rl=rn(om),Cu=y({},Qa,{animationName:0,elapsedTime:0,pseudoElement:0}),lm=rn(Cu),_c=y({},Qa,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),cm=rn(_c),dm=y({},Qa,{data:0}),ba=rn(dm),um={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mm(a){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(a):(a=fm[a])?!!o[a]:!1}function $i(){return mm}var In=y({},Bi,{key:function(a){if(a.key){var o=um[a.key]||a.key;if(o!=="Unidentified")return o}return a.type==="keypress"?(a=sl(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?hm[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$i,charCode:function(a){return a.type==="keypress"?sl(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?sl(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),gm=rn(In),pm=y({},Nc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ya=rn(pm),g=y({},Bi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$i}),j=rn(g),A=y({},Qa,{propertyName:0,elapsedTime:0,pseudoElement:0}),G=rn(A),de=y({},Nc,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),be=rn(de),Ve=y({},Qa,{newState:0,oldState:0}),ut=rn(Ve),_s=[9,13,27,32],Ot=vr&&"CompositionEvent"in window,ls=null;vr&&"documentMode"in document&&(ls=document.documentMode);var wr=vr&&"TextEvent"in window&&!ls,ya=vr&&(!Ot||ls&&8<ls&&11>=ls),Gr=" ",Wr=!1;function al(a,o){switch(a){case"keyup":return _s.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tc(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Sc=!1;function qk(a,o){switch(a){case"compositionend":return Tc(o);case"keypress":return o.which!==32?null:(Wr=!0,Gr);case"textInput":return a=o.data,a===Gr&&Wr?null:a;default:return null}}function Hk(a,o){if(Sc)return a==="compositionend"||!Ot&&al(a,o)?(a=Iu(),tl=Eu=ga=null,Sc=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return ya&&o.locale!=="ko"?null:o.data;default:return null}}var Gk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function P1(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o==="input"?!!Gk[a.type]:o==="textarea"}function M1(a,o,c,u){Ui?ma?ma.push(u):ma=[u]:Ui=u,o=ag(o,"onChange"),0<o.length&&(c=new pa("onChange","change",null,c,u),a.push({event:c,listeners:o}))}var Ru=null,Du=null;function Wk(a){bN(a,0)}function xm(a){var o=er(a);if(Xo(o))return a}function L1(a,o){if(a==="change")return o}var V1=!1;if(vr){var Lp;if(vr){var Vp="oninput"in document;if(!Vp){var U1=document.createElement("div");U1.setAttribute("oninput","return;"),Vp=typeof U1.oninput=="function"}Lp=Vp}else Lp=!1;V1=Lp&&(!document.documentMode||9<document.documentMode)}function F1(){Ru&&(Ru.detachEvent("onpropertychange",B1),Du=Ru=null)}function B1(a){if(a.propertyName==="value"&&xm(Du)){var o=[];M1(o,Du,a,yr(a)),Fi(Wk,o)}}function Kk(a,o,c){a==="focusin"?(F1(),Ru=o,Du=c,Ru.attachEvent("onpropertychange",B1)):a==="focusout"&&F1()}function Qk(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return xm(Du)}function Yk(a,o){if(a==="click")return xm(o)}function Xk(a,o){if(a==="input"||a==="change")return xm(o)}function Jk(a,o){return a===o&&(a!==0||1/a===1/o)||a!==a&&o!==o}var sr=typeof Object.is=="function"?Object.is:Jk;function Ou(a,o){if(sr(a,o))return!0;if(typeof a!="object"||a===null||typeof o!="object"||o===null)return!1;var c=Object.keys(a),u=Object.keys(o);if(c.length!==u.length)return!1;for(u=0;u<c.length;u++){var p=c[u];if(!ee.call(o,p)||!sr(a[p],o[p]))return!1}return!0}function z1(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function $1(a,o){var c=z1(a);a=0;for(var u;c;){if(c.nodeType===3){if(u=a+c.textContent.length,a<=o&&u>=o)return{node:c,offset:o-a};a=u}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=z1(c)}}function q1(a,o){return a&&o?a===o?!0:a&&a.nodeType===3?!1:o&&o.nodeType===3?q1(a,o.parentNode):"contains"in a?a.contains(o):a.compareDocumentPosition?!!(a.compareDocumentPosition(o)&16):!1:!1}function H1(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var o=fa(a.document);o instanceof a.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)a=o.contentWindow;else break;o=fa(a.document)}return o}function Up(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o&&(o==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||o==="textarea"||a.contentEditable==="true")}var Zk=vr&&"documentMode"in document&&11>=document.documentMode,Ec=null,Fp=null,Pu=null,Bp=!1;function G1(a,o,c){var u=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Bp||Ec==null||Ec!==fa(u)||(u=Ec,"selectionStart"in u&&Up(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Pu&&Ou(Pu,u)||(Pu=u,u=ag(Fp,"onSelect"),0<u.length&&(o=new pa("onSelect","select",null,o,c),a.push({event:o,listeners:u}),o.target=Ec)))}function il(a,o){var c={};return c[a.toLowerCase()]=o.toLowerCase(),c["Webkit"+a]="webkit"+o,c["Moz"+a]="moz"+o,c}var Ic={animationend:il("Animation","AnimationEnd"),animationiteration:il("Animation","AnimationIteration"),animationstart:il("Animation","AnimationStart"),transitionrun:il("Transition","TransitionRun"),transitionstart:il("Transition","TransitionStart"),transitioncancel:il("Transition","TransitionCancel"),transitionend:il("Transition","TransitionEnd")},zp={},W1={};vr&&(W1=document.createElement("div").style,"AnimationEvent"in window||(delete Ic.animationend.animation,delete Ic.animationiteration.animation,delete Ic.animationstart.animation),"TransitionEvent"in window||delete Ic.transitionend.transition);function ol(a){if(zp[a])return zp[a];if(!Ic[a])return a;var o=Ic[a],c;for(c in o)if(o.hasOwnProperty(c)&&c in W1)return zp[a]=o[c];return a}var K1=ol("animationend"),Q1=ol("animationiteration"),Y1=ol("animationstart"),eC=ol("transitionrun"),tC=ol("transitionstart"),sC=ol("transitioncancel"),X1=ol("transitionend"),J1=new Map,$p="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");$p.push("scrollEnd");function Kr(a,o){J1.set(a,o),ua(o,[a])}var bm=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},jr=[],Ac=0,qp=0;function ym(){for(var a=Ac,o=qp=Ac=0;o<a;){var c=jr[o];jr[o++]=null;var u=jr[o];jr[o++]=null;var p=jr[o];jr[o++]=null;var x=jr[o];if(jr[o++]=null,u!==null&&p!==null){var _=u.pending;_===null?p.next=p:(p.next=_.next,_.next=p),u.pending=p}x!==0&&Z1(c,p,x)}}function vm(a,o,c,u){jr[Ac++]=a,jr[Ac++]=o,jr[Ac++]=c,jr[Ac++]=u,qp|=u,a.lanes|=u,a=a.alternate,a!==null&&(a.lanes|=u)}function Hp(a,o,c,u){return vm(a,o,c,u),wm(a)}function ll(a,o){return vm(a,null,null,o),wm(a)}function Z1(a,o,c){a.lanes|=c;var u=a.alternate;u!==null&&(u.lanes|=c);for(var p=!1,x=a.return;x!==null;)x.childLanes|=c,u=x.alternate,u!==null&&(u.childLanes|=c),x.tag===22&&(a=x.stateNode,a===null||a._visibility&1||(p=!0)),a=x,x=x.return;return a.tag===3?(x=a.stateNode,p&&o!==null&&(p=31-Le(c),a=x.hiddenUpdates,u=a[p],u===null?a[p]=[o]:u.push(o),o.lane=c|536870912),x):null}function wm(a){if(50<nh)throw nh=0,eb=null,Error(r(185));for(var o=a.return;o!==null;)a=o,o=a.return;return a.tag===3?a.stateNode:null}var kc={};function nC(a,o,c,u){this.tag=a,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nr(a,o,c,u){return new nC(a,o,c,u)}function Gp(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Xa(a,o){var c=a.alternate;return c===null?(c=nr(a.tag,o,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=o,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=a.flags&65011712,c.childLanes=a.childLanes,c.lanes=a.lanes,c.child=a.child,c.memoizedProps=a.memoizedProps,c.memoizedState=a.memoizedState,c.updateQueue=a.updateQueue,o=a.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=a.sibling,c.index=a.index,c.ref=a.ref,c.refCleanup=a.refCleanup,c}function e2(a,o){a.flags&=65011714;var c=a.alternate;return c===null?(a.childLanes=0,a.lanes=o,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,o=c.dependencies,a.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),a}function jm(a,o,c,u,p,x){var _=0;if(u=a,typeof a=="function")Gp(a)&&(_=1);else if(typeof a=="string")_=l3(a,c,H.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case U:return a=nr(31,c,o,p),a.elementType=U,a.lanes=x,a;case I:return cl(c.children,p,x,o);case T:_=8,p|=24;break;case L:return a=nr(12,c,o,p|2),a.elementType=L,a.lanes=x,a;case Z:return a=nr(13,c,o,p),a.elementType=Z,a.lanes=x,a;case Y:return a=nr(19,c,o,p),a.elementType=Y,a.lanes=x,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case B:_=10;break e;case $:_=9;break e;case Q:_=11;break e;case C:_=14;break e;case P:_=16,u=null;break e}_=29,c=Error(r(130,a===null?"null":typeof a,"")),u=null}return o=nr(_,c,o,p),o.elementType=a,o.type=u,o.lanes=x,o}function cl(a,o,c,u){return a=nr(7,a,u,o),a.lanes=c,a}function Wp(a,o,c){return a=nr(6,a,null,o),a.lanes=c,a}function t2(a){var o=nr(18,null,null,0);return o.stateNode=a,o}function Kp(a,o,c){return o=nr(4,a.children!==null?a.children:[],a.key,o),o.lanes=c,o.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},o}var s2=new WeakMap;function Nr(a,o){if(typeof a=="object"&&a!==null){var c=s2.get(a);return c!==void 0?c:(o={value:a,source:o,stack:ge(o)},s2.set(a,o),o)}return{value:a,source:o,stack:ge(o)}}var Cc=[],Rc=0,Nm=null,Mu=0,_r=[],Tr=0,qi=null,va=1,wa="";function Ja(a,o){Cc[Rc++]=Mu,Cc[Rc++]=Nm,Nm=a,Mu=o}function n2(a,o,c){_r[Tr++]=va,_r[Tr++]=wa,_r[Tr++]=qi,qi=a;var u=va;a=wa;var p=32-Le(u)-1;u&=~(1<<p),c+=1;var x=32-Le(o)+p;if(30<x){var _=p-p%5;x=(u&(1<<_)-1).toString(32),u>>=_,p-=_,va=1<<32-Le(o)+p|c<<p|u,wa=x+a}else va=1<<x|c<<p|u,wa=a}function Qp(a){a.return!==null&&(Ja(a,1),n2(a,1,0))}function Yp(a){for(;a===Nm;)Nm=Cc[--Rc],Cc[Rc]=null,Mu=Cc[--Rc],Cc[Rc]=null;for(;a===qi;)qi=_r[--Tr],_r[Tr]=null,wa=_r[--Tr],_r[Tr]=null,va=_r[--Tr],_r[Tr]=null}function r2(a,o){_r[Tr++]=va,_r[Tr++]=wa,_r[Tr++]=qi,va=o.id,wa=o.overflow,qi=a}var an=null,ss=null,Et=!1,Hi=null,Sr=!1,Xp=Error(r(519));function Gi(a){var o=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Lu(Nr(o,a)),Xp}function a2(a){var o=a.stateNode,c=a.type,u=a.memoizedProps;switch(o[Rs]=a,o[Qs]=u,c){case"dialog":vt("cancel",o),vt("close",o);break;case"iframe":case"object":case"embed":vt("load",o);break;case"video":case"audio":for(c=0;c<ah.length;c++)vt(ah[c],o);break;case"source":vt("error",o);break;case"img":case"image":case"link":vt("error",o),vt("load",o);break;case"details":vt("toggle",o);break;case"input":vt("invalid",o),sm(o,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":vt("invalid",o);break;case"textarea":vt("invalid",o),Li(o,u.value,u.defaultValue,u.children)}c=u.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||u.suppressHydrationWarning===!0||jN(o.textContent,c)?(u.popover!=null&&(vt("beforetoggle",o),vt("toggle",o)),u.onScroll!=null&&vt("scroll",o),u.onScrollEnd!=null&&vt("scrollend",o),u.onClick!=null&&(o.onclick=$r),o=!0):o=!1,o||Gi(a,!0)}function i2(a){for(an=a.return;an;)switch(an.tag){case 5:case 31:case 13:Sr=!1;return;case 27:case 3:Sr=!0;return;default:an=an.return}}function Dc(a){if(a!==an)return!1;if(!Et)return i2(a),Et=!0,!1;var o=a.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=a.type,c=!(c!=="form"&&c!=="button")||gb(a.type,a.memoizedProps)),c=!c),c&&ss&&Gi(a),i2(a),o===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));ss=CN(a)}else if(o===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));ss=CN(a)}else o===27?(o=ss,io(a.type)?(a=vb,vb=null,ss=a):ss=o):ss=an?Ir(a.stateNode.nextSibling):null;return!0}function dl(){ss=an=null,Et=!1}function Jp(){var a=Hi;return a!==null&&(Hn===null?Hn=a:Hn.push.apply(Hn,a),Hi=null),a}function Lu(a){Hi===null?Hi=[a]:Hi.push(a)}var Zp=R(null),ul=null,Za=null;function Wi(a,o,c){X(Zp,o._currentValue),o._currentValue=c}function ei(a){a._currentValue=Zp.current,V(Zp)}function ex(a,o,c){for(;a!==null;){var u=a.alternate;if((a.childLanes&o)!==o?(a.childLanes|=o,u!==null&&(u.childLanes|=o)):u!==null&&(u.childLanes&o)!==o&&(u.childLanes|=o),a===c)break;a=a.return}}function tx(a,o,c,u){var p=a.child;for(p!==null&&(p.return=a);p!==null;){var x=p.dependencies;if(x!==null){var _=p.child;x=x.firstContext;e:for(;x!==null;){var z=x;x=p;for(var te=0;te<o.length;te++)if(z.context===o[te]){x.lanes|=c,z=x.alternate,z!==null&&(z.lanes|=c),ex(x.return,c,a),u||(_=null);break e}x=z.next}}else if(p.tag===18){if(_=p.return,_===null)throw Error(r(341));_.lanes|=c,x=_.alternate,x!==null&&(x.lanes|=c),ex(_,c,a),_=null}else _=p.child;if(_!==null)_.return=p;else for(_=p;_!==null;){if(_===a){_=null;break}if(p=_.sibling,p!==null){p.return=_.return,_=p;break}_=_.return}p=_}}function Oc(a,o,c,u){a=null;for(var p=o,x=!1;p!==null;){if(!x){if((p.flags&524288)!==0)x=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var _=p.alternate;if(_===null)throw Error(r(387));if(_=_.memoizedProps,_!==null){var z=p.type;sr(p.pendingProps.value,_.value)||(a!==null?a.push(z):a=[z])}}else if(p===oe.current){if(_=p.alternate,_===null)throw Error(r(387));_.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(a!==null?a.push(dh):a=[dh])}p=p.return}a!==null&&tx(o,a,c,u),o.flags|=262144}function _m(a){for(a=a.firstContext;a!==null;){if(!sr(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function hl(a){ul=a,Za=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function on(a){return o2(ul,a)}function Tm(a,o){return ul===null&&hl(a),o2(a,o)}function o2(a,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},Za===null){if(a===null)throw Error(r(308));Za=o,a.dependencies={lanes:0,firstContext:o},a.flags|=524288}else Za=Za.next=o;return c}var rC=typeof AbortController<"u"?AbortController:function(){var a=[],o=this.signal={aborted:!1,addEventListener:function(c,u){a.push(u)}};this.abort=function(){o.aborted=!0,a.forEach(function(c){return c()})}},aC=s.unstable_scheduleCallback,iC=s.unstable_NormalPriority,Ps={$$typeof:B,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function sx(){return{controller:new rC,data:new Map,refCount:0}}function Vu(a){a.refCount--,a.refCount===0&&aC(iC,function(){a.controller.abort()})}var Uu=null,nx=0,Pc=0,Mc=null;function oC(a,o){if(Uu===null){var c=Uu=[];nx=0,Pc=ib(),Mc={status:"pending",value:void 0,then:function(u){c.push(u)}}}return nx++,o.then(l2,l2),o}function l2(){if(--nx===0&&Uu!==null){Mc!==null&&(Mc.status="fulfilled");var a=Uu;Uu=null,Pc=0,Mc=null;for(var o=0;o<a.length;o++)(0,a[o])()}}function lC(a,o){var c=[],u={status:"pending",value:null,reason:null,then:function(p){c.push(p)}};return a.then(function(){u.status="fulfilled",u.value=o;for(var p=0;p<c.length;p++)(0,c[p])(o)},function(p){for(u.status="rejected",u.reason=p,p=0;p<c.length;p++)(0,c[p])(void 0)}),u}var c2=k.S;k.S=function(a,o){Gj=tt(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&oC(a,o),c2!==null&&c2(a,o)};var fl=R(null);function rx(){var a=fl.current;return a!==null?a:Jt.pooledCache}function Sm(a,o){o===null?X(fl,fl.current):X(fl,o.pool)}function d2(){var a=rx();return a===null?null:{parent:Ps._currentValue,pool:a}}var Lc=Error(r(460)),ax=Error(r(474)),Em=Error(r(542)),Im={then:function(){}};function u2(a){return a=a.status,a==="fulfilled"||a==="rejected"}function h2(a,o,c){switch(c=a[c],c===void 0?a.push(o):c!==o&&(o.then($r,$r),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,m2(a),a;default:if(typeof o.status=="string")o.then($r,$r);else{if(a=Jt,a!==null&&100<a.shellSuspendCounter)throw Error(r(482));a=o,a.status="pending",a.then(function(u){if(o.status==="pending"){var p=o;p.status="fulfilled",p.value=u}},function(u){if(o.status==="pending"){var p=o;p.status="rejected",p.reason=u}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,m2(a),a}throw gl=o,Lc}}function ml(a){try{var o=a._init;return o(a._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(gl=c,Lc):c}}var gl=null;function f2(){if(gl===null)throw Error(r(459));var a=gl;return gl=null,a}function m2(a){if(a===Lc||a===Em)throw Error(r(483))}var Vc=null,Fu=0;function Am(a){var o=Fu;return Fu+=1,Vc===null&&(Vc=[]),h2(Vc,a,o)}function Bu(a,o){o=o.props.ref,a.ref=o!==void 0?o:null}function km(a,o){throw o.$$typeof===v?Error(r(525)):(a=Object.prototype.toString.call(o),Error(r(31,a==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":a)))}function g2(a){function o(ie,re){if(a){var ue=ie.deletions;ue===null?(ie.deletions=[re],ie.flags|=16):ue.push(re)}}function c(ie,re){if(!a)return null;for(;re!==null;)o(ie,re),re=re.sibling;return null}function u(ie){for(var re=new Map;ie!==null;)ie.key!==null?re.set(ie.key,ie):re.set(ie.index,ie),ie=ie.sibling;return re}function p(ie,re){return ie=Xa(ie,re),ie.index=0,ie.sibling=null,ie}function x(ie,re,ue){return ie.index=ue,a?(ue=ie.alternate,ue!==null?(ue=ue.index,ue<re?(ie.flags|=67108866,re):ue):(ie.flags|=67108866,re)):(ie.flags|=1048576,re)}function _(ie){return a&&ie.alternate===null&&(ie.flags|=67108866),ie}function z(ie,re,ue,Se){return re===null||re.tag!==6?(re=Wp(ue,ie.mode,Se),re.return=ie,re):(re=p(re,ue),re.return=ie,re)}function te(ie,re,ue,Se){var Je=ue.type;return Je===I?Ne(ie,re,ue.props.children,Se,ue.key):re!==null&&(re.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===P&&ml(Je)===re.type)?(re=p(re,ue.props),Bu(re,ue),re.return=ie,re):(re=jm(ue.type,ue.key,ue.props,null,ie.mode,Se),Bu(re,ue),re.return=ie,re)}function he(ie,re,ue,Se){return re===null||re.tag!==4||re.stateNode.containerInfo!==ue.containerInfo||re.stateNode.implementation!==ue.implementation?(re=Kp(ue,ie.mode,Se),re.return=ie,re):(re=p(re,ue.children||[]),re.return=ie,re)}function Ne(ie,re,ue,Se,Je){return re===null||re.tag!==7?(re=cl(ue,ie.mode,Se,Je),re.return=ie,re):(re=p(re,ue),re.return=ie,re)}function Ee(ie,re,ue){if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return re=Wp(""+re,ie.mode,ue),re.return=ie,re;if(typeof re=="object"&&re!==null){switch(re.$$typeof){case N:return ue=jm(re.type,re.key,re.props,null,ie.mode,ue),Bu(ue,re),ue.return=ie,ue;case E:return re=Kp(re,ie.mode,ue),re.return=ie,re;case P:return re=ml(re),Ee(ie,re,ue)}if(K(re)||F(re))return re=cl(re,ie.mode,ue,null),re.return=ie,re;if(typeof re.then=="function")return Ee(ie,Am(re),ue);if(re.$$typeof===B)return Ee(ie,Tm(ie,re),ue);km(ie,re)}return null}function me(ie,re,ue,Se){var Je=re!==null?re.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return Je!==null?null:z(ie,re,""+ue,Se);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case N:return ue.key===Je?te(ie,re,ue,Se):null;case E:return ue.key===Je?he(ie,re,ue,Se):null;case P:return ue=ml(ue),me(ie,re,ue,Se)}if(K(ue)||F(ue))return Je!==null?null:Ne(ie,re,ue,Se,null);if(typeof ue.then=="function")return me(ie,re,Am(ue),Se);if(ue.$$typeof===B)return me(ie,re,Tm(ie,ue),Se);km(ie,ue)}return null}function ve(ie,re,ue,Se,Je){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return ie=ie.get(ue)||null,z(re,ie,""+Se,Je);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case N:return ie=ie.get(Se.key===null?ue:Se.key)||null,te(re,ie,Se,Je);case E:return ie=ie.get(Se.key===null?ue:Se.key)||null,he(re,ie,Se,Je);case P:return Se=ml(Se),ve(ie,re,ue,Se,Je)}if(K(Se)||F(Se))return ie=ie.get(ue)||null,Ne(re,ie,Se,Je,null);if(typeof Se.then=="function")return ve(ie,re,ue,Am(Se),Je);if(Se.$$typeof===B)return ve(ie,re,ue,Tm(re,Se),Je);km(re,Se)}return null}function He(ie,re,ue,Se){for(var Je=null,kt=null,Qe=re,gt=re=0,Tt=null;Qe!==null&&gt<ue.length;gt++){Qe.index>gt?(Tt=Qe,Qe=null):Tt=Qe.sibling;var Ct=me(ie,Qe,ue[gt],Se);if(Ct===null){Qe===null&&(Qe=Tt);break}a&&Qe&&Ct.alternate===null&&o(ie,Qe),re=x(Ct,re,gt),kt===null?Je=Ct:kt.sibling=Ct,kt=Ct,Qe=Tt}if(gt===ue.length)return c(ie,Qe),Et&&Ja(ie,gt),Je;if(Qe===null){for(;gt<ue.length;gt++)Qe=Ee(ie,ue[gt],Se),Qe!==null&&(re=x(Qe,re,gt),kt===null?Je=Qe:kt.sibling=Qe,kt=Qe);return Et&&Ja(ie,gt),Je}for(Qe=u(Qe);gt<ue.length;gt++)Tt=ve(Qe,ie,gt,ue[gt],Se),Tt!==null&&(a&&Tt.alternate!==null&&Qe.delete(Tt.key===null?gt:Tt.key),re=x(Tt,re,gt),kt===null?Je=Tt:kt.sibling=Tt,kt=Tt);return a&&Qe.forEach(function(ho){return o(ie,ho)}),Et&&Ja(ie,gt),Je}function nt(ie,re,ue,Se){if(ue==null)throw Error(r(151));for(var Je=null,kt=null,Qe=re,gt=re=0,Tt=null,Ct=ue.next();Qe!==null&&!Ct.done;gt++,Ct=ue.next()){Qe.index>gt?(Tt=Qe,Qe=null):Tt=Qe.sibling;var ho=me(ie,Qe,Ct.value,Se);if(ho===null){Qe===null&&(Qe=Tt);break}a&&Qe&&ho.alternate===null&&o(ie,Qe),re=x(ho,re,gt),kt===null?Je=ho:kt.sibling=ho,kt=ho,Qe=Tt}if(Ct.done)return c(ie,Qe),Et&&Ja(ie,gt),Je;if(Qe===null){for(;!Ct.done;gt++,Ct=ue.next())Ct=Ee(ie,Ct.value,Se),Ct!==null&&(re=x(Ct,re,gt),kt===null?Je=Ct:kt.sibling=Ct,kt=Ct);return Et&&Ja(ie,gt),Je}for(Qe=u(Qe);!Ct.done;gt++,Ct=ue.next())Ct=ve(Qe,ie,gt,Ct.value,Se),Ct!==null&&(a&&Ct.alternate!==null&&Qe.delete(Ct.key===null?gt:Ct.key),re=x(Ct,re,gt),kt===null?Je=Ct:kt.sibling=Ct,kt=Ct);return a&&Qe.forEach(function(y3){return o(ie,y3)}),Et&&Ja(ie,gt),Je}function Xt(ie,re,ue,Se){if(typeof ue=="object"&&ue!==null&&ue.type===I&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case N:e:{for(var Je=ue.key;re!==null;){if(re.key===Je){if(Je=ue.type,Je===I){if(re.tag===7){c(ie,re.sibling),Se=p(re,ue.props.children),Se.return=ie,ie=Se;break e}}else if(re.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===P&&ml(Je)===re.type){c(ie,re.sibling),Se=p(re,ue.props),Bu(Se,ue),Se.return=ie,ie=Se;break e}c(ie,re);break}else o(ie,re);re=re.sibling}ue.type===I?(Se=cl(ue.props.children,ie.mode,Se,ue.key),Se.return=ie,ie=Se):(Se=jm(ue.type,ue.key,ue.props,null,ie.mode,Se),Bu(Se,ue),Se.return=ie,ie=Se)}return _(ie);case E:e:{for(Je=ue.key;re!==null;){if(re.key===Je)if(re.tag===4&&re.stateNode.containerInfo===ue.containerInfo&&re.stateNode.implementation===ue.implementation){c(ie,re.sibling),Se=p(re,ue.children||[]),Se.return=ie,ie=Se;break e}else{c(ie,re);break}else o(ie,re);re=re.sibling}Se=Kp(ue,ie.mode,Se),Se.return=ie,ie=Se}return _(ie);case P:return ue=ml(ue),Xt(ie,re,ue,Se)}if(K(ue))return He(ie,re,ue,Se);if(F(ue)){if(Je=F(ue),typeof Je!="function")throw Error(r(150));return ue=Je.call(ue),nt(ie,re,ue,Se)}if(typeof ue.then=="function")return Xt(ie,re,Am(ue),Se);if(ue.$$typeof===B)return Xt(ie,re,Tm(ie,ue),Se);km(ie,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint"?(ue=""+ue,re!==null&&re.tag===6?(c(ie,re.sibling),Se=p(re,ue),Se.return=ie,ie=Se):(c(ie,re),Se=Wp(ue,ie.mode,Se),Se.return=ie,ie=Se),_(ie)):c(ie,re)}return function(ie,re,ue,Se){try{Fu=0;var Je=Xt(ie,re,ue,Se);return Vc=null,Je}catch(Qe){if(Qe===Lc||Qe===Em)throw Qe;var kt=nr(29,Qe,null,ie.mode);return kt.lanes=Se,kt.return=ie,kt}finally{}}}var pl=g2(!0),p2=g2(!1),Ki=!1;function ix(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ox(a,o){a=a.updateQueue,o.updateQueue===a&&(o.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Qi(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Yi(a,o,c){var u=a.updateQueue;if(u===null)return null;if(u=u.shared,(Pt&2)!==0){var p=u.pending;return p===null?o.next=o:(o.next=p.next,p.next=o),u.pending=o,o=wm(a),Z1(a,null,c),o}return vm(a,u,o,c),wm(a)}function zu(a,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var u=o.lanes;u&=a.pendingLanes,c|=u,o.lanes=c,gu(a,c)}}function lx(a,o){var c=a.updateQueue,u=a.alternate;if(u!==null&&(u=u.updateQueue,c===u)){var p=null,x=null;if(c=c.firstBaseUpdate,c!==null){do{var _={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};x===null?p=x=_:x=x.next=_,c=c.next}while(c!==null);x===null?p=x=o:x=x.next=o}else p=x=o;c={baseState:u.baseState,firstBaseUpdate:p,lastBaseUpdate:x,shared:u.shared,callbacks:u.callbacks},a.updateQueue=c;return}a=c.lastBaseUpdate,a===null?c.firstBaseUpdate=o:a.next=o,c.lastBaseUpdate=o}var cx=!1;function $u(){if(cx){var a=Mc;if(a!==null)throw a}}function qu(a,o,c,u){cx=!1;var p=a.updateQueue;Ki=!1;var x=p.firstBaseUpdate,_=p.lastBaseUpdate,z=p.shared.pending;if(z!==null){p.shared.pending=null;var te=z,he=te.next;te.next=null,_===null?x=he:_.next=he,_=te;var Ne=a.alternate;Ne!==null&&(Ne=Ne.updateQueue,z=Ne.lastBaseUpdate,z!==_&&(z===null?Ne.firstBaseUpdate=he:z.next=he,Ne.lastBaseUpdate=te))}if(x!==null){var Ee=p.baseState;_=0,Ne=he=te=null,z=x;do{var me=z.lane&-536870913,ve=me!==z.lane;if(ve?(_t&me)===me:(u&me)===me){me!==0&&me===Pc&&(cx=!0),Ne!==null&&(Ne=Ne.next={lane:0,tag:z.tag,payload:z.payload,callback:null,next:null});e:{var He=a,nt=z;me=o;var Xt=c;switch(nt.tag){case 1:if(He=nt.payload,typeof He=="function"){Ee=He.call(Xt,Ee,me);break e}Ee=He;break e;case 3:He.flags=He.flags&-65537|128;case 0:if(He=nt.payload,me=typeof He=="function"?He.call(Xt,Ee,me):He,me==null)break e;Ee=y({},Ee,me);break e;case 2:Ki=!0}}me=z.callback,me!==null&&(a.flags|=64,ve&&(a.flags|=8192),ve=p.callbacks,ve===null?p.callbacks=[me]:ve.push(me))}else ve={lane:me,tag:z.tag,payload:z.payload,callback:z.callback,next:null},Ne===null?(he=Ne=ve,te=Ee):Ne=Ne.next=ve,_|=me;if(z=z.next,z===null){if(z=p.shared.pending,z===null)break;ve=z,z=ve.next,ve.next=null,p.lastBaseUpdate=ve,p.shared.pending=null}}while(!0);Ne===null&&(te=Ee),p.baseState=te,p.firstBaseUpdate=he,p.lastBaseUpdate=Ne,x===null&&(p.shared.lanes=0),to|=_,a.lanes=_,a.memoizedState=Ee}}function x2(a,o){if(typeof a!="function")throw Error(r(191,a));a.call(o)}function b2(a,o){var c=a.callbacks;if(c!==null)for(a.callbacks=null,a=0;a<c.length;a++)x2(c[a],o)}var Uc=R(null),Cm=R(0);function y2(a,o){a=ci,X(Cm,a),X(Uc,o),ci=a|o.baseLanes}function dx(){X(Cm,ci),X(Uc,Uc.current)}function ux(){ci=Cm.current,V(Uc),V(Cm)}var rr=R(null),Er=null;function Xi(a){var o=a.alternate;X(Ts,Ts.current&1),X(rr,a),Er===null&&(o===null||Uc.current!==null||o.memoizedState!==null)&&(Er=a)}function hx(a){X(Ts,Ts.current),X(rr,a),Er===null&&(Er=a)}function v2(a){a.tag===22?(X(Ts,Ts.current),X(rr,a),Er===null&&(Er=a)):Ji()}function Ji(){X(Ts,Ts.current),X(rr,rr.current)}function ar(a){V(rr),Er===a&&(Er=null),V(Ts)}var Ts=R(0);function Rm(a){for(var o=a;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||bb(c)||yb(c)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var ti=0,ht=null,Qt=null,Ms=null,Dm=!1,Fc=!1,xl=!1,Om=0,Hu=0,Bc=null,cC=0;function xs(){throw Error(r(321))}function fx(a,o){if(o===null)return!1;for(var c=0;c<o.length&&c<a.length;c++)if(!sr(a[c],o[c]))return!1;return!0}function mx(a,o,c,u,p,x){return ti=x,ht=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,k.H=a===null||a.memoizedState===null?nj:Ax,xl=!1,x=c(u,p),xl=!1,Fc&&(x=j2(o,c,u,p)),w2(a),x}function w2(a){k.H=Ku;var o=Qt!==null&&Qt.next!==null;if(ti=0,Ms=Qt=ht=null,Dm=!1,Hu=0,Bc=null,o)throw Error(r(300));a===null||Ls||(a=a.dependencies,a!==null&&_m(a)&&(Ls=!0))}function j2(a,o,c,u){ht=a;var p=0;do{if(Fc&&(Bc=null),Hu=0,Fc=!1,25<=p)throw Error(r(301));if(p+=1,Ms=Qt=null,a.updateQueue!=null){var x=a.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}k.H=rj,x=o(c,u)}while(Fc);return x}function dC(){var a=k.H,o=a.useState()[0];return o=typeof o.then=="function"?Gu(o):o,a=a.useState()[0],(Qt!==null?Qt.memoizedState:null)!==a&&(ht.flags|=1024),o}function gx(){var a=Om!==0;return Om=0,a}function px(a,o,c){o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~c}function xx(a){if(Dm){for(a=a.memoizedState;a!==null;){var o=a.queue;o!==null&&(o.pending=null),a=a.next}Dm=!1}ti=0,Ms=Qt=ht=null,Fc=!1,Hu=Om=0,Bc=null}function An(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ms===null?ht.memoizedState=Ms=a:Ms=Ms.next=a,Ms}function Ss(){if(Qt===null){var a=ht.alternate;a=a!==null?a.memoizedState:null}else a=Qt.next;var o=Ms===null?ht.memoizedState:Ms.next;if(o!==null)Ms=o,Qt=a;else{if(a===null)throw ht.alternate===null?Error(r(467)):Error(r(310));Qt=a,a={memoizedState:Qt.memoizedState,baseState:Qt.baseState,baseQueue:Qt.baseQueue,queue:Qt.queue,next:null},Ms===null?ht.memoizedState=Ms=a:Ms=Ms.next=a}return Ms}function Pm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Gu(a){var o=Hu;return Hu+=1,Bc===null&&(Bc=[]),a=h2(Bc,a,o),o=ht,(Ms===null?o.memoizedState:Ms.next)===null&&(o=o.alternate,k.H=o===null||o.memoizedState===null?nj:Ax),a}function Mm(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Gu(a);if(a.$$typeof===B)return on(a)}throw Error(r(438,String(a)))}function bx(a){var o=null,c=ht.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var u=ht.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(o={data:u.data.map(function(p){return p.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=Pm(),ht.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(a),u=0;u<a;u++)c[u]=O;return o.index++,c}function si(a,o){return typeof o=="function"?o(a):o}function Lm(a){var o=Ss();return yx(o,Qt,a)}function yx(a,o,c){var u=a.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=c;var p=a.baseQueue,x=u.pending;if(x!==null){if(p!==null){var _=p.next;p.next=x.next,x.next=_}o.baseQueue=p=x,u.pending=null}if(x=a.baseState,p===null)a.memoizedState=x;else{o=p.next;var z=_=null,te=null,he=o,Ne=!1;do{var Ee=he.lane&-536870913;if(Ee!==he.lane?(_t&Ee)===Ee:(ti&Ee)===Ee){var me=he.revertLane;if(me===0)te!==null&&(te=te.next={lane:0,revertLane:0,gesture:null,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null}),Ee===Pc&&(Ne=!0);else if((ti&me)===me){he=he.next,me===Pc&&(Ne=!0);continue}else Ee={lane:0,revertLane:he.revertLane,gesture:null,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},te===null?(z=te=Ee,_=x):te=te.next=Ee,ht.lanes|=me,to|=me;Ee=he.action,xl&&c(x,Ee),x=he.hasEagerState?he.eagerState:c(x,Ee)}else me={lane:Ee,revertLane:he.revertLane,gesture:he.gesture,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},te===null?(z=te=me,_=x):te=te.next=me,ht.lanes|=Ee,to|=Ee;he=he.next}while(he!==null&&he!==o);if(te===null?_=x:te.next=z,!sr(x,a.memoizedState)&&(Ls=!0,Ne&&(c=Mc,c!==null)))throw c;a.memoizedState=x,a.baseState=_,a.baseQueue=te,u.lastRenderedState=x}return p===null&&(u.lanes=0),[a.memoizedState,u.dispatch]}function vx(a){var o=Ss(),c=o.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=a;var u=c.dispatch,p=c.pending,x=o.memoizedState;if(p!==null){c.pending=null;var _=p=p.next;do x=a(x,_.action),_=_.next;while(_!==p);sr(x,o.memoizedState)||(Ls=!0),o.memoizedState=x,o.baseQueue===null&&(o.baseState=x),c.lastRenderedState=x}return[x,u]}function N2(a,o,c){var u=ht,p=Ss(),x=Et;if(x){if(c===void 0)throw Error(r(407));c=c()}else c=o();var _=!sr((Qt||p).memoizedState,c);if(_&&(p.memoizedState=c,Ls=!0),p=p.queue,Nx(S2.bind(null,u,p,a),[a]),p.getSnapshot!==o||_||Ms!==null&&Ms.memoizedState.tag&1){if(u.flags|=2048,zc(9,{destroy:void 0},T2.bind(null,u,p,c,o),null),Jt===null)throw Error(r(349));x||(ti&127)!==0||_2(u,o,c)}return c}function _2(a,o,c){a.flags|=16384,a={getSnapshot:o,value:c},o=ht.updateQueue,o===null?(o=Pm(),ht.updateQueue=o,o.stores=[a]):(c=o.stores,c===null?o.stores=[a]:c.push(a))}function T2(a,o,c,u){o.value=c,o.getSnapshot=u,E2(o)&&I2(a)}function S2(a,o,c){return c(function(){E2(o)&&I2(a)})}function E2(a){var o=a.getSnapshot;a=a.value;try{var c=o();return!sr(a,c)}catch{return!0}}function I2(a){var o=ll(a,2);o!==null&&Gn(o,a,2)}function wx(a){var o=An();if(typeof a=="function"){var c=a;if(a=c(),xl){pe(!0);try{c()}finally{pe(!1)}}}return o.memoizedState=o.baseState=a,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:si,lastRenderedState:a},o}function A2(a,o,c,u){return a.baseState=c,yx(a,Qt,typeof u=="function"?u:si)}function uC(a,o,c,u,p){if(Fm(a))throw Error(r(485));if(a=o.action,a!==null){var x={payload:p,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(_){x.listeners.push(_)}};k.T!==null?c(!0):x.isTransition=!1,u(x),c=o.pending,c===null?(x.next=o.pending=x,k2(o,x)):(x.next=c.next,o.pending=c.next=x)}}function k2(a,o){var c=o.action,u=o.payload,p=a.state;if(o.isTransition){var x=k.T,_={};k.T=_;try{var z=c(p,u),te=k.S;te!==null&&te(_,z),C2(a,o,z)}catch(he){jx(a,o,he)}finally{x!==null&&_.types!==null&&(x.types=_.types),k.T=x}}else try{x=c(p,u),C2(a,o,x)}catch(he){jx(a,o,he)}}function C2(a,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(u){R2(a,o,u)},function(u){return jx(a,o,u)}):R2(a,o,c)}function R2(a,o,c){o.status="fulfilled",o.value=c,D2(o),a.state=c,o=a.pending,o!==null&&(c=o.next,c===o?a.pending=null:(c=c.next,o.next=c,k2(a,c)))}function jx(a,o,c){var u=a.pending;if(a.pending=null,u!==null){u=u.next;do o.status="rejected",o.reason=c,D2(o),o=o.next;while(o!==u)}a.action=null}function D2(a){a=a.listeners;for(var o=0;o<a.length;o++)(0,a[o])()}function O2(a,o){return o}function P2(a,o){if(Et){var c=Jt.formState;if(c!==null){e:{var u=ht;if(Et){if(ss){t:{for(var p=ss,x=Sr;p.nodeType!==8;){if(!x){p=null;break t}if(p=Ir(p.nextSibling),p===null){p=null;break t}}x=p.data,p=x==="F!"||x==="F"?p:null}if(p){ss=Ir(p.nextSibling),u=p.data==="F!";break e}}Gi(u)}u=!1}u&&(o=c[0])}}return c=An(),c.memoizedState=c.baseState=o,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:O2,lastRenderedState:o},c.queue=u,c=ej.bind(null,ht,u),u.dispatch=c,u=wx(!1),x=Ix.bind(null,ht,!1,u.queue),u=An(),p={state:o,dispatch:null,action:a,pending:null},u.queue=p,c=uC.bind(null,ht,p,x,c),p.dispatch=c,u.memoizedState=a,[o,c,!1]}function M2(a){var o=Ss();return L2(o,Qt,a)}function L2(a,o,c){if(o=yx(a,o,O2)[0],a=Lm(si)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var u=Gu(o)}catch(_){throw _===Lc?Em:_}else u=o;o=Ss();var p=o.queue,x=p.dispatch;return c!==o.memoizedState&&(ht.flags|=2048,zc(9,{destroy:void 0},hC.bind(null,p,c),null)),[u,x,a]}function hC(a,o){a.action=o}function V2(a){var o=Ss(),c=Qt;if(c!==null)return L2(o,c,a);Ss(),o=o.memoizedState,c=Ss();var u=c.queue.dispatch;return c.memoizedState=a,[o,u,!1]}function zc(a,o,c,u){return a={tag:a,create:c,deps:u,inst:o,next:null},o=ht.updateQueue,o===null&&(o=Pm(),ht.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=a.next=a:(u=c.next,c.next=a,a.next=u,o.lastEffect=a),a}function U2(){return Ss().memoizedState}function Vm(a,o,c,u){var p=An();ht.flags|=a,p.memoizedState=zc(1|o,{destroy:void 0},c,u===void 0?null:u)}function Um(a,o,c,u){var p=Ss();u=u===void 0?null:u;var x=p.memoizedState.inst;Qt!==null&&u!==null&&fx(u,Qt.memoizedState.deps)?p.memoizedState=zc(o,x,c,u):(ht.flags|=a,p.memoizedState=zc(1|o,x,c,u))}function F2(a,o){Vm(8390656,8,a,o)}function Nx(a,o){Um(2048,8,a,o)}function fC(a){ht.flags|=4;var o=ht.updateQueue;if(o===null)o=Pm(),ht.updateQueue=o,o.events=[a];else{var c=o.events;c===null?o.events=[a]:c.push(a)}}function B2(a){var o=Ss().memoizedState;return fC({ref:o,nextImpl:a}),function(){if((Pt&2)!==0)throw Error(r(440));return o.impl.apply(void 0,arguments)}}function z2(a,o){return Um(4,2,a,o)}function $2(a,o){return Um(4,4,a,o)}function q2(a,o){if(typeof o=="function"){a=a();var c=o(a);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return a=a(),o.current=a,function(){o.current=null}}function H2(a,o,c){c=c!=null?c.concat([a]):null,Um(4,4,q2.bind(null,o,a),c)}function _x(){}function G2(a,o){var c=Ss();o=o===void 0?null:o;var u=c.memoizedState;return o!==null&&fx(o,u[1])?u[0]:(c.memoizedState=[a,o],a)}function W2(a,o){var c=Ss();o=o===void 0?null:o;var u=c.memoizedState;if(o!==null&&fx(o,u[1]))return u[0];if(u=a(),xl){pe(!0);try{a()}finally{pe(!1)}}return c.memoizedState=[u,o],u}function Tx(a,o,c){return c===void 0||(ti&1073741824)!==0&&(_t&261930)===0?a.memoizedState=o:(a.memoizedState=c,a=Kj(),ht.lanes|=a,to|=a,c)}function K2(a,o,c,u){return sr(c,o)?c:Uc.current!==null?(a=Tx(a,c,u),sr(a,o)||(Ls=!0),a):(ti&42)===0||(ti&1073741824)!==0&&(_t&261930)===0?(Ls=!0,a.memoizedState=c):(a=Kj(),ht.lanes|=a,to|=a,o)}function Q2(a,o,c,u,p){var x=q.p;q.p=x!==0&&8>x?x:8;var _=k.T,z={};k.T=z,Ix(a,!1,o,c);try{var te=p(),he=k.S;if(he!==null&&he(z,te),te!==null&&typeof te=="object"&&typeof te.then=="function"){var Ne=lC(te,u);Wu(a,o,Ne,lr(a))}else Wu(a,o,u,lr(a))}catch(Ee){Wu(a,o,{then:function(){},status:"rejected",reason:Ee},lr())}finally{q.p=x,_!==null&&z.types!==null&&(_.types=z.types),k.T=_}}function mC(){}function Sx(a,o,c,u){if(a.tag!==5)throw Error(r(476));var p=Y2(a).queue;Q2(a,p,o,W,c===null?mC:function(){return X2(a),c(u)})}function Y2(a){var o=a.memoizedState;if(o!==null)return o;o={memoizedState:W,baseState:W,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:si,lastRenderedState:W},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:si,lastRenderedState:c},next:null},a.memoizedState=o,a=a.alternate,a!==null&&(a.memoizedState=o),o}function X2(a){var o=Y2(a);o.next===null&&(o=a.alternate.memoizedState),Wu(a,o.next.queue,{},lr())}function Ex(){return on(dh)}function J2(){return Ss().memoizedState}function Z2(){return Ss().memoizedState}function gC(a){for(var o=a.return;o!==null;){switch(o.tag){case 24:case 3:var c=lr();a=Qi(c);var u=Yi(o,a,c);u!==null&&(Gn(u,o,c),zu(u,o,c)),o={cache:sx()},a.payload=o;return}o=o.return}}function pC(a,o,c){var u=lr();c={lane:u,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Fm(a)?tj(o,c):(c=Hp(a,o,c,u),c!==null&&(Gn(c,a,u),sj(c,o,u)))}function ej(a,o,c){var u=lr();Wu(a,o,c,u)}function Wu(a,o,c,u){var p={lane:u,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Fm(a))tj(o,p);else{var x=a.alternate;if(a.lanes===0&&(x===null||x.lanes===0)&&(x=o.lastRenderedReducer,x!==null))try{var _=o.lastRenderedState,z=x(_,c);if(p.hasEagerState=!0,p.eagerState=z,sr(z,_))return vm(a,o,p,0),Jt===null&&ym(),!1}catch{}finally{}if(c=Hp(a,o,p,u),c!==null)return Gn(c,a,u),sj(c,o,u),!0}return!1}function Ix(a,o,c,u){if(u={lane:2,revertLane:ib(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Fm(a)){if(o)throw Error(r(479))}else o=Hp(a,c,u,2),o!==null&&Gn(o,a,2)}function Fm(a){var o=a.alternate;return a===ht||o!==null&&o===ht}function tj(a,o){Fc=Dm=!0;var c=a.pending;c===null?o.next=o:(o.next=c.next,c.next=o),a.pending=o}function sj(a,o,c){if((c&4194048)!==0){var u=o.lanes;u&=a.pendingLanes,c|=u,o.lanes=c,gu(a,c)}}var Ku={readContext:on,use:Mm,useCallback:xs,useContext:xs,useEffect:xs,useImperativeHandle:xs,useLayoutEffect:xs,useInsertionEffect:xs,useMemo:xs,useReducer:xs,useRef:xs,useState:xs,useDebugValue:xs,useDeferredValue:xs,useTransition:xs,useSyncExternalStore:xs,useId:xs,useHostTransitionStatus:xs,useFormState:xs,useActionState:xs,useOptimistic:xs,useMemoCache:xs,useCacheRefresh:xs};Ku.useEffectEvent=xs;var nj={readContext:on,use:Mm,useCallback:function(a,o){return An().memoizedState=[a,o===void 0?null:o],a},useContext:on,useEffect:F2,useImperativeHandle:function(a,o,c){c=c!=null?c.concat([a]):null,Vm(4194308,4,q2.bind(null,o,a),c)},useLayoutEffect:function(a,o){return Vm(4194308,4,a,o)},useInsertionEffect:function(a,o){Vm(4,2,a,o)},useMemo:function(a,o){var c=An();o=o===void 0?null:o;var u=a();if(xl){pe(!0);try{a()}finally{pe(!1)}}return c.memoizedState=[u,o],u},useReducer:function(a,o,c){var u=An();if(c!==void 0){var p=c(o);if(xl){pe(!0);try{c(o)}finally{pe(!1)}}}else p=o;return u.memoizedState=u.baseState=p,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:p},u.queue=a,a=a.dispatch=pC.bind(null,ht,a),[u.memoizedState,a]},useRef:function(a){var o=An();return a={current:a},o.memoizedState=a},useState:function(a){a=wx(a);var o=a.queue,c=ej.bind(null,ht,o);return o.dispatch=c,[a.memoizedState,c]},useDebugValue:_x,useDeferredValue:function(a,o){var c=An();return Tx(c,a,o)},useTransition:function(){var a=wx(!1);return a=Q2.bind(null,ht,a.queue,!0,!1),An().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,o,c){var u=ht,p=An();if(Et){if(c===void 0)throw Error(r(407));c=c()}else{if(c=o(),Jt===null)throw Error(r(349));(_t&127)!==0||_2(u,o,c)}p.memoizedState=c;var x={value:c,getSnapshot:o};return p.queue=x,F2(S2.bind(null,u,x,a),[a]),u.flags|=2048,zc(9,{destroy:void 0},T2.bind(null,u,x,c,o),null),c},useId:function(){var a=An(),o=Jt.identifierPrefix;if(Et){var c=wa,u=va;c=(u&~(1<<32-Le(u)-1)).toString(32)+c,o="_"+o+"R_"+c,c=Om++,0<c&&(o+="H"+c.toString(32)),o+="_"}else c=cC++,o="_"+o+"r_"+c.toString(32)+"_";return a.memoizedState=o},useHostTransitionStatus:Ex,useFormState:P2,useActionState:P2,useOptimistic:function(a){var o=An();o.memoizedState=o.baseState=a;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=Ix.bind(null,ht,!0,c),c.dispatch=o,[a,o]},useMemoCache:bx,useCacheRefresh:function(){return An().memoizedState=gC.bind(null,ht)},useEffectEvent:function(a){var o=An(),c={impl:a};return o.memoizedState=c,function(){if((Pt&2)!==0)throw Error(r(440));return c.impl.apply(void 0,arguments)}}},Ax={readContext:on,use:Mm,useCallback:G2,useContext:on,useEffect:Nx,useImperativeHandle:H2,useInsertionEffect:z2,useLayoutEffect:$2,useMemo:W2,useReducer:Lm,useRef:U2,useState:function(){return Lm(si)},useDebugValue:_x,useDeferredValue:function(a,o){var c=Ss();return K2(c,Qt.memoizedState,a,o)},useTransition:function(){var a=Lm(si)[0],o=Ss().memoizedState;return[typeof a=="boolean"?a:Gu(a),o]},useSyncExternalStore:N2,useId:J2,useHostTransitionStatus:Ex,useFormState:M2,useActionState:M2,useOptimistic:function(a,o){var c=Ss();return A2(c,Qt,a,o)},useMemoCache:bx,useCacheRefresh:Z2};Ax.useEffectEvent=B2;var rj={readContext:on,use:Mm,useCallback:G2,useContext:on,useEffect:Nx,useImperativeHandle:H2,useInsertionEffect:z2,useLayoutEffect:$2,useMemo:W2,useReducer:vx,useRef:U2,useState:function(){return vx(si)},useDebugValue:_x,useDeferredValue:function(a,o){var c=Ss();return Qt===null?Tx(c,a,o):K2(c,Qt.memoizedState,a,o)},useTransition:function(){var a=vx(si)[0],o=Ss().memoizedState;return[typeof a=="boolean"?a:Gu(a),o]},useSyncExternalStore:N2,useId:J2,useHostTransitionStatus:Ex,useFormState:V2,useActionState:V2,useOptimistic:function(a,o){var c=Ss();return Qt!==null?A2(c,Qt,a,o):(c.baseState=a,[a,c.queue.dispatch])},useMemoCache:bx,useCacheRefresh:Z2};rj.useEffectEvent=B2;function kx(a,o,c,u){o=a.memoizedState,c=c(u,o),c=c==null?o:y({},o,c),a.memoizedState=c,a.lanes===0&&(a.updateQueue.baseState=c)}var Cx={enqueueSetState:function(a,o,c){a=a._reactInternals;var u=lr(),p=Qi(u);p.payload=o,c!=null&&(p.callback=c),o=Yi(a,p,u),o!==null&&(Gn(o,a,u),zu(o,a,u))},enqueueReplaceState:function(a,o,c){a=a._reactInternals;var u=lr(),p=Qi(u);p.tag=1,p.payload=o,c!=null&&(p.callback=c),o=Yi(a,p,u),o!==null&&(Gn(o,a,u),zu(o,a,u))},enqueueForceUpdate:function(a,o){a=a._reactInternals;var c=lr(),u=Qi(c);u.tag=2,o!=null&&(u.callback=o),o=Yi(a,u,c),o!==null&&(Gn(o,a,c),zu(o,a,c))}};function aj(a,o,c,u,p,x,_){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(u,x,_):o.prototype&&o.prototype.isPureReactComponent?!Ou(c,u)||!Ou(p,x):!0}function ij(a,o,c,u){a=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,u),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,u),o.state!==a&&Cx.enqueueReplaceState(o,o.state,null)}function bl(a,o){var c=o;if("ref"in o){c={};for(var u in o)u!=="ref"&&(c[u]=o[u])}if(a=a.defaultProps){c===o&&(c=y({},c));for(var p in a)c[p]===void 0&&(c[p]=a[p])}return c}function oj(a){bm(a)}function lj(a){console.error(a)}function cj(a){bm(a)}function Bm(a,o){try{var c=a.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(u){setTimeout(function(){throw u})}}function dj(a,o,c){try{var u=a.onCaughtError;u(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Rx(a,o,c){return c=Qi(c),c.tag=3,c.payload={element:null},c.callback=function(){Bm(a,o)},c}function uj(a){return a=Qi(a),a.tag=3,a}function hj(a,o,c,u){var p=c.type.getDerivedStateFromError;if(typeof p=="function"){var x=u.value;a.payload=function(){return p(x)},a.callback=function(){dj(o,c,u)}}var _=c.stateNode;_!==null&&typeof _.componentDidCatch=="function"&&(a.callback=function(){dj(o,c,u),typeof p!="function"&&(so===null?so=new Set([this]):so.add(this));var z=u.stack;this.componentDidCatch(u.value,{componentStack:z!==null?z:""})})}function xC(a,o,c,u,p){if(c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(o=c.alternate,o!==null&&Oc(o,c,p,!0),c=rr.current,c!==null){switch(c.tag){case 31:case 13:return Er===null?Zm():c.alternate===null&&bs===0&&(bs=3),c.flags&=-257,c.flags|=65536,c.lanes=p,u===Im?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([u]):o.add(u),nb(a,u,p)),!1;case 22:return c.flags|=65536,u===Im?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([u])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([u]):c.add(u)),nb(a,u,p)),!1}throw Error(r(435,c.tag))}return nb(a,u,p),Zm(),!1}if(Et)return o=rr.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=p,u!==Xp&&(a=Error(r(422),{cause:u}),Lu(Nr(a,c)))):(u!==Xp&&(o=Error(r(423),{cause:u}),Lu(Nr(o,c))),a=a.current.alternate,a.flags|=65536,p&=-p,a.lanes|=p,u=Nr(u,c),p=Rx(a.stateNode,u,p),lx(a,p),bs!==4&&(bs=2)),!1;var x=Error(r(520),{cause:u});if(x=Nr(x,c),sh===null?sh=[x]:sh.push(x),bs!==4&&(bs=2),o===null)return!0;u=Nr(u,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,a=p&-p,c.lanes|=a,a=Rx(c.stateNode,u,a),lx(c,a),!1;case 1:if(o=c.type,x=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(so===null||!so.has(x))))return c.flags|=65536,p&=-p,c.lanes|=p,p=uj(p),hj(p,a,c,u),lx(c,p),!1}c=c.return}while(c!==null);return!1}var Dx=Error(r(461)),Ls=!1;function ln(a,o,c,u){o.child=a===null?p2(o,null,c,u):pl(o,a.child,c,u)}function fj(a,o,c,u,p){c=c.render;var x=o.ref;if("ref"in u){var _={};for(var z in u)z!=="ref"&&(_[z]=u[z])}else _=u;return hl(o),u=mx(a,o,c,_,x,p),z=gx(),a!==null&&!Ls?(px(a,o,p),ni(a,o,p)):(Et&&z&&Qp(o),o.flags|=1,ln(a,o,u,p),o.child)}function mj(a,o,c,u,p){if(a===null){var x=c.type;return typeof x=="function"&&!Gp(x)&&x.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=x,gj(a,o,x,u,p)):(a=jm(c.type,null,u,o,o.mode,p),a.ref=o.ref,a.return=o,o.child=a)}if(x=a.child,!Bx(a,p)){var _=x.memoizedProps;if(c=c.compare,c=c!==null?c:Ou,c(_,u)&&a.ref===o.ref)return ni(a,o,p)}return o.flags|=1,a=Xa(x,u),a.ref=o.ref,a.return=o,o.child=a}function gj(a,o,c,u,p){if(a!==null){var x=a.memoizedProps;if(Ou(x,u)&&a.ref===o.ref)if(Ls=!1,o.pendingProps=u=x,Bx(a,p))(a.flags&131072)!==0&&(Ls=!0);else return o.lanes=a.lanes,ni(a,o,p)}return Ox(a,o,c,u,p)}function pj(a,o,c,u){var p=u.children,x=a!==null?a.memoizedState:null;if(a===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((o.flags&128)!==0){if(x=x!==null?x.baseLanes|c:c,a!==null){for(u=o.child=a.child,p=0;u!==null;)p=p|u.lanes|u.childLanes,u=u.sibling;u=p&~x}else u=0,o.child=null;return xj(a,o,x,c,u)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},a!==null&&Sm(o,x!==null?x.cachePool:null),x!==null?y2(o,x):dx(),v2(o);else return u=o.lanes=536870912,xj(a,o,x!==null?x.baseLanes|c:c,c,u)}else x!==null?(Sm(o,x.cachePool),y2(o,x),Ji(),o.memoizedState=null):(a!==null&&Sm(o,null),dx(),Ji());return ln(a,o,p,c),o.child}function Qu(a,o){return a!==null&&a.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function xj(a,o,c,u,p){var x=rx();return x=x===null?null:{parent:Ps._currentValue,pool:x},o.memoizedState={baseLanes:c,cachePool:x},a!==null&&Sm(o,null),dx(),v2(o),a!==null&&Oc(a,o,u,!0),o.childLanes=p,null}function zm(a,o){return o=qm({mode:o.mode,children:o.children},a.mode),o.ref=a.ref,a.child=o,o.return=a,o}function bj(a,o,c){return pl(o,a.child,null,c),a=zm(o,o.pendingProps),a.flags|=2,ar(o),o.memoizedState=null,a}function bC(a,o,c){var u=o.pendingProps,p=(o.flags&128)!==0;if(o.flags&=-129,a===null){if(Et){if(u.mode==="hidden")return a=zm(o,u),o.lanes=536870912,Qu(null,a);if(hx(o),(a=ss)?(a=kN(a,Sr),a=a!==null&&a.data==="&"?a:null,a!==null&&(o.memoizedState={dehydrated:a,treeContext:qi!==null?{id:va,overflow:wa}:null,retryLane:536870912,hydrationErrors:null},c=t2(a),c.return=o,o.child=c,an=o,ss=null)):a=null,a===null)throw Gi(o);return o.lanes=536870912,null}return zm(o,u)}var x=a.memoizedState;if(x!==null){var _=x.dehydrated;if(hx(o),p)if(o.flags&256)o.flags&=-257,o=bj(a,o,c);else if(o.memoizedState!==null)o.child=a.child,o.flags|=128,o=null;else throw Error(r(558));else if(Ls||Oc(a,o,c,!1),p=(c&a.childLanes)!==0,Ls||p){if(u=Jt,u!==null&&(_=pu(u,c),_!==0&&_!==x.retryLane))throw x.retryLane=_,ll(a,_),Gn(u,a,_),Dx;Zm(),o=bj(a,o,c)}else a=x.treeContext,ss=Ir(_.nextSibling),an=o,Et=!0,Hi=null,Sr=!1,a!==null&&r2(o,a),o=zm(o,u),o.flags|=4096;return o}return a=Xa(a.child,{mode:u.mode,children:u.children}),a.ref=o.ref,o.child=a,a.return=o,a}function $m(a,o){var c=o.ref;if(c===null)a!==null&&a.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(r(284));(a===null||a.ref!==c)&&(o.flags|=4194816)}}function Ox(a,o,c,u,p){return hl(o),c=mx(a,o,c,u,void 0,p),u=gx(),a!==null&&!Ls?(px(a,o,p),ni(a,o,p)):(Et&&u&&Qp(o),o.flags|=1,ln(a,o,c,p),o.child)}function yj(a,o,c,u,p,x){return hl(o),o.updateQueue=null,c=j2(o,u,c,p),w2(a),u=gx(),a!==null&&!Ls?(px(a,o,x),ni(a,o,x)):(Et&&u&&Qp(o),o.flags|=1,ln(a,o,c,x),o.child)}function vj(a,o,c,u,p){if(hl(o),o.stateNode===null){var x=kc,_=c.contextType;typeof _=="object"&&_!==null&&(x=on(_)),x=new c(u,x),o.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Cx,o.stateNode=x,x._reactInternals=o,x=o.stateNode,x.props=u,x.state=o.memoizedState,x.refs={},ix(o),_=c.contextType,x.context=typeof _=="object"&&_!==null?on(_):kc,x.state=o.memoizedState,_=c.getDerivedStateFromProps,typeof _=="function"&&(kx(o,c,_,u),x.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(_=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),_!==x.state&&Cx.enqueueReplaceState(x,x.state,null),qu(o,u,x,p),$u(),x.state=o.memoizedState),typeof x.componentDidMount=="function"&&(o.flags|=4194308),u=!0}else if(a===null){x=o.stateNode;var z=o.memoizedProps,te=bl(c,z);x.props=te;var he=x.context,Ne=c.contextType;_=kc,typeof Ne=="object"&&Ne!==null&&(_=on(Ne));var Ee=c.getDerivedStateFromProps;Ne=typeof Ee=="function"||typeof x.getSnapshotBeforeUpdate=="function",z=o.pendingProps!==z,Ne||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(z||he!==_)&&ij(o,x,u,_),Ki=!1;var me=o.memoizedState;x.state=me,qu(o,u,x,p),$u(),he=o.memoizedState,z||me!==he||Ki?(typeof Ee=="function"&&(kx(o,c,Ee,u),he=o.memoizedState),(te=Ki||aj(o,c,te,u,me,he,_))?(Ne||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(o.flags|=4194308)):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=u,o.memoizedState=he),x.props=u,x.state=he,x.context=_,u=te):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),u=!1)}else{x=o.stateNode,ox(a,o),_=o.memoizedProps,Ne=bl(c,_),x.props=Ne,Ee=o.pendingProps,me=x.context,he=c.contextType,te=kc,typeof he=="object"&&he!==null&&(te=on(he)),z=c.getDerivedStateFromProps,(he=typeof z=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(_!==Ee||me!==te)&&ij(o,x,u,te),Ki=!1,me=o.memoizedState,x.state=me,qu(o,u,x,p),$u();var ve=o.memoizedState;_!==Ee||me!==ve||Ki||a!==null&&a.dependencies!==null&&_m(a.dependencies)?(typeof z=="function"&&(kx(o,c,z,u),ve=o.memoizedState),(Ne=Ki||aj(o,c,Ne,u,me,ve,te)||a!==null&&a.dependencies!==null&&_m(a.dependencies))?(he||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(u,ve,te),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(u,ve,te)),typeof x.componentDidUpdate=="function"&&(o.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof x.componentDidUpdate!="function"||_===a.memoizedProps&&me===a.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||_===a.memoizedProps&&me===a.memoizedState||(o.flags|=1024),o.memoizedProps=u,o.memoizedState=ve),x.props=u,x.state=ve,x.context=te,u=Ne):(typeof x.componentDidUpdate!="function"||_===a.memoizedProps&&me===a.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||_===a.memoizedProps&&me===a.memoizedState||(o.flags|=1024),u=!1)}return x=u,$m(a,o),u=(o.flags&128)!==0,x||u?(x=o.stateNode,c=u&&typeof c.getDerivedStateFromError!="function"?null:x.render(),o.flags|=1,a!==null&&u?(o.child=pl(o,a.child,null,p),o.child=pl(o,null,c,p)):ln(a,o,c,p),o.memoizedState=x.state,a=o.child):a=ni(a,o,p),a}function wj(a,o,c,u){return dl(),o.flags|=256,ln(a,o,c,u),o.child}var Px={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Mx(a){return{baseLanes:a,cachePool:d2()}}function Lx(a,o,c){return a=a!==null?a.childLanes&~c:0,o&&(a|=or),a}function jj(a,o,c){var u=o.pendingProps,p=!1,x=(o.flags&128)!==0,_;if((_=x)||(_=a!==null&&a.memoizedState===null?!1:(Ts.current&2)!==0),_&&(p=!0,o.flags&=-129),_=(o.flags&32)!==0,o.flags&=-33,a===null){if(Et){if(p?Xi(o):Ji(),(a=ss)?(a=kN(a,Sr),a=a!==null&&a.data!=="&"?a:null,a!==null&&(o.memoizedState={dehydrated:a,treeContext:qi!==null?{id:va,overflow:wa}:null,retryLane:536870912,hydrationErrors:null},c=t2(a),c.return=o,o.child=c,an=o,ss=null)):a=null,a===null)throw Gi(o);return yb(a)?o.lanes=32:o.lanes=536870912,null}var z=u.children;return u=u.fallback,p?(Ji(),p=o.mode,z=qm({mode:"hidden",children:z},p),u=cl(u,p,c,null),z.return=o,u.return=o,z.sibling=u,o.child=z,u=o.child,u.memoizedState=Mx(c),u.childLanes=Lx(a,_,c),o.memoizedState=Px,Qu(null,u)):(Xi(o),Vx(o,z))}var te=a.memoizedState;if(te!==null&&(z=te.dehydrated,z!==null)){if(x)o.flags&256?(Xi(o),o.flags&=-257,o=Ux(a,o,c)):o.memoizedState!==null?(Ji(),o.child=a.child,o.flags|=128,o=null):(Ji(),z=u.fallback,p=o.mode,u=qm({mode:"visible",children:u.children},p),z=cl(z,p,c,null),z.flags|=2,u.return=o,z.return=o,u.sibling=z,o.child=u,pl(o,a.child,null,c),u=o.child,u.memoizedState=Mx(c),u.childLanes=Lx(a,_,c),o.memoizedState=Px,o=Qu(null,u));else if(Xi(o),yb(z)){if(_=z.nextSibling&&z.nextSibling.dataset,_)var he=_.dgst;_=he,u=Error(r(419)),u.stack="",u.digest=_,Lu({value:u,source:null,stack:null}),o=Ux(a,o,c)}else if(Ls||Oc(a,o,c,!1),_=(c&a.childLanes)!==0,Ls||_){if(_=Jt,_!==null&&(u=pu(_,c),u!==0&&u!==te.retryLane))throw te.retryLane=u,ll(a,u),Gn(_,a,u),Dx;bb(z)||Zm(),o=Ux(a,o,c)}else bb(z)?(o.flags|=192,o.child=a.child,o=null):(a=te.treeContext,ss=Ir(z.nextSibling),an=o,Et=!0,Hi=null,Sr=!1,a!==null&&r2(o,a),o=Vx(o,u.children),o.flags|=4096);return o}return p?(Ji(),z=u.fallback,p=o.mode,te=a.child,he=te.sibling,u=Xa(te,{mode:"hidden",children:u.children}),u.subtreeFlags=te.subtreeFlags&65011712,he!==null?z=Xa(he,z):(z=cl(z,p,c,null),z.flags|=2),z.return=o,u.return=o,u.sibling=z,o.child=u,Qu(null,u),u=o.child,z=a.child.memoizedState,z===null?z=Mx(c):(p=z.cachePool,p!==null?(te=Ps._currentValue,p=p.parent!==te?{parent:te,pool:te}:p):p=d2(),z={baseLanes:z.baseLanes|c,cachePool:p}),u.memoizedState=z,u.childLanes=Lx(a,_,c),o.memoizedState=Px,Qu(a.child,u)):(Xi(o),c=a.child,a=c.sibling,c=Xa(c,{mode:"visible",children:u.children}),c.return=o,c.sibling=null,a!==null&&(_=o.deletions,_===null?(o.deletions=[a],o.flags|=16):_.push(a)),o.child=c,o.memoizedState=null,c)}function Vx(a,o){return o=qm({mode:"visible",children:o},a.mode),o.return=a,a.child=o}function qm(a,o){return a=nr(22,a,null,o),a.lanes=0,a}function Ux(a,o,c){return pl(o,a.child,null,c),a=Vx(o,o.pendingProps.children),a.flags|=2,o.memoizedState=null,a}function Nj(a,o,c){a.lanes|=o;var u=a.alternate;u!==null&&(u.lanes|=o),ex(a.return,o,c)}function Fx(a,o,c,u,p,x){var _=a.memoizedState;_===null?a.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:u,tail:c,tailMode:p,treeForkCount:x}:(_.isBackwards=o,_.rendering=null,_.renderingStartTime=0,_.last=u,_.tail=c,_.tailMode=p,_.treeForkCount=x)}function _j(a,o,c){var u=o.pendingProps,p=u.revealOrder,x=u.tail;u=u.children;var _=Ts.current,z=(_&2)!==0;if(z?(_=_&1|2,o.flags|=128):_&=1,X(Ts,_),ln(a,o,u,c),u=Et?Mu:0,!z&&a!==null&&(a.flags&128)!==0)e:for(a=o.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Nj(a,c,o);else if(a.tag===19)Nj(a,c,o);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break e;for(;a.sibling===null;){if(a.return===null||a.return===o)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(p){case"forwards":for(c=o.child,p=null;c!==null;)a=c.alternate,a!==null&&Rm(a)===null&&(p=c),c=c.sibling;c=p,c===null?(p=o.child,o.child=null):(p=c.sibling,c.sibling=null),Fx(o,!1,p,c,x,u);break;case"backwards":case"unstable_legacy-backwards":for(c=null,p=o.child,o.child=null;p!==null;){if(a=p.alternate,a!==null&&Rm(a)===null){o.child=p;break}a=p.sibling,p.sibling=c,c=p,p=a}Fx(o,!0,c,null,x,u);break;case"together":Fx(o,!1,null,null,void 0,u);break;default:o.memoizedState=null}return o.child}function ni(a,o,c){if(a!==null&&(o.dependencies=a.dependencies),to|=o.lanes,(c&o.childLanes)===0)if(a!==null){if(Oc(a,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(a!==null&&o.child!==a.child)throw Error(r(153));if(o.child!==null){for(a=o.child,c=Xa(a,a.pendingProps),o.child=c,c.return=o;a.sibling!==null;)a=a.sibling,c=c.sibling=Xa(a,a.pendingProps),c.return=o;c.sibling=null}return o.child}function Bx(a,o){return(a.lanes&o)!==0?!0:(a=a.dependencies,!!(a!==null&&_m(a)))}function yC(a,o,c){switch(o.tag){case 3:je(o,o.stateNode.containerInfo),Wi(o,Ps,a.memoizedState.cache),dl();break;case 27:case 5:Pe(o);break;case 4:je(o,o.stateNode.containerInfo);break;case 10:Wi(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,hx(o),null;break;case 13:var u=o.memoizedState;if(u!==null)return u.dehydrated!==null?(Xi(o),o.flags|=128,null):(c&o.child.childLanes)!==0?jj(a,o,c):(Xi(o),a=ni(a,o,c),a!==null?a.sibling:null);Xi(o);break;case 19:var p=(a.flags&128)!==0;if(u=(c&o.childLanes)!==0,u||(Oc(a,o,c,!1),u=(c&o.childLanes)!==0),p){if(u)return _j(a,o,c);o.flags|=128}if(p=o.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),X(Ts,Ts.current),u)break;return null;case 22:return o.lanes=0,pj(a,o,c,o.pendingProps);case 24:Wi(o,Ps,a.memoizedState.cache)}return ni(a,o,c)}function Tj(a,o,c){if(a!==null)if(a.memoizedProps!==o.pendingProps)Ls=!0;else{if(!Bx(a,c)&&(o.flags&128)===0)return Ls=!1,yC(a,o,c);Ls=(a.flags&131072)!==0}else Ls=!1,Et&&(o.flags&1048576)!==0&&n2(o,Mu,o.index);switch(o.lanes=0,o.tag){case 16:e:{var u=o.pendingProps;if(a=ml(o.elementType),o.type=a,typeof a=="function")Gp(a)?(u=bl(a,u),o.tag=1,o=vj(null,o,a,u,c)):(o.tag=0,o=Ox(null,o,a,u,c));else{if(a!=null){var p=a.$$typeof;if(p===Q){o.tag=11,o=fj(null,o,a,u,c);break e}else if(p===C){o.tag=14,o=mj(null,o,a,u,c);break e}}throw o=ae(a)||a,Error(r(306,o,""))}}return o;case 0:return Ox(a,o,o.type,o.pendingProps,c);case 1:return u=o.type,p=bl(u,o.pendingProps),vj(a,o,u,p,c);case 3:e:{if(je(o,o.stateNode.containerInfo),a===null)throw Error(r(387));u=o.pendingProps;var x=o.memoizedState;p=x.element,ox(a,o),qu(o,u,null,c);var _=o.memoizedState;if(u=_.cache,Wi(o,Ps,u),u!==x.cache&&tx(o,[Ps],c,!0),$u(),u=_.element,x.isDehydrated)if(x={element:u,isDehydrated:!1,cache:_.cache},o.updateQueue.baseState=x,o.memoizedState=x,o.flags&256){o=wj(a,o,u,c);break e}else if(u!==p){p=Nr(Error(r(424)),o),Lu(p),o=wj(a,o,u,c);break e}else{switch(a=o.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(ss=Ir(a.firstChild),an=o,Et=!0,Hi=null,Sr=!0,c=p2(o,null,u,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(dl(),u===p){o=ni(a,o,c);break e}ln(a,o,u,c)}o=o.child}return o;case 26:return $m(a,o),a===null?(c=MN(o.type,null,o.pendingProps,null))?o.memoizedState=c:Et||(c=o.type,a=o.pendingProps,u=ig(J.current).createElement(c),u[Rs]=o,u[Qs]=a,cn(u,c,a),Ds(u),o.stateNode=u):o.memoizedState=MN(o.type,a.memoizedProps,o.pendingProps,a.memoizedState),null;case 27:return Pe(o),a===null&&Et&&(u=o.stateNode=DN(o.type,o.pendingProps,J.current),an=o,Sr=!0,p=ss,io(o.type)?(vb=p,ss=Ir(u.firstChild)):ss=p),ln(a,o,o.pendingProps.children,c),$m(a,o),a===null&&(o.flags|=4194304),o.child;case 5:return a===null&&Et&&((p=u=ss)&&(u=QC(u,o.type,o.pendingProps,Sr),u!==null?(o.stateNode=u,an=o,ss=Ir(u.firstChild),Sr=!1,p=!0):p=!1),p||Gi(o)),Pe(o),p=o.type,x=o.pendingProps,_=a!==null?a.memoizedProps:null,u=x.children,gb(p,x)?u=null:_!==null&&gb(p,_)&&(o.flags|=32),o.memoizedState!==null&&(p=mx(a,o,dC,null,null,c),dh._currentValue=p),$m(a,o),ln(a,o,u,c),o.child;case 6:return a===null&&Et&&((a=c=ss)&&(c=YC(c,o.pendingProps,Sr),c!==null?(o.stateNode=c,an=o,ss=null,a=!0):a=!1),a||Gi(o)),null;case 13:return jj(a,o,c);case 4:return je(o,o.stateNode.containerInfo),u=o.pendingProps,a===null?o.child=pl(o,null,u,c):ln(a,o,u,c),o.child;case 11:return fj(a,o,o.type,o.pendingProps,c);case 7:return ln(a,o,o.pendingProps,c),o.child;case 8:return ln(a,o,o.pendingProps.children,c),o.child;case 12:return ln(a,o,o.pendingProps.children,c),o.child;case 10:return u=o.pendingProps,Wi(o,o.type,u.value),ln(a,o,u.children,c),o.child;case 9:return p=o.type._context,u=o.pendingProps.children,hl(o),p=on(p),u=u(p),o.flags|=1,ln(a,o,u,c),o.child;case 14:return mj(a,o,o.type,o.pendingProps,c);case 15:return gj(a,o,o.type,o.pendingProps,c);case 19:return _j(a,o,c);case 31:return bC(a,o,c);case 22:return pj(a,o,c,o.pendingProps);case 24:return hl(o),u=on(Ps),a===null?(p=rx(),p===null&&(p=Jt,x=sx(),p.pooledCache=x,x.refCount++,x!==null&&(p.pooledCacheLanes|=c),p=x),o.memoizedState={parent:u,cache:p},ix(o),Wi(o,Ps,p)):((a.lanes&c)!==0&&(ox(a,o),qu(o,null,null,c),$u()),p=a.memoizedState,x=o.memoizedState,p.parent!==u?(p={parent:u,cache:u},o.memoizedState=p,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=p),Wi(o,Ps,u)):(u=x.cache,Wi(o,Ps,u),u!==p.cache&&tx(o,[Ps],c,!0))),ln(a,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(r(156,o.tag))}function ri(a){a.flags|=4}function zx(a,o,c,u,p){if((o=(a.mode&32)!==0)&&(o=!1),o){if(a.flags|=16777216,(p&335544128)===p)if(a.stateNode.complete)a.flags|=8192;else if(Jj())a.flags|=8192;else throw gl=Im,ax}else a.flags&=-16777217}function Sj(a,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!BN(o))if(Jj())a.flags|=8192;else throw gl=Im,ax}function Hm(a,o){o!==null&&(a.flags|=4),a.flags&16384&&(o=a.tag!==22?Xf():536870912,a.lanes|=o,Gc|=o)}function Yu(a,o){if(!Et)switch(a.tailMode){case"hidden":o=a.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a.tail=null:c.sibling=null;break;case"collapsed":c=a.tail;for(var u=null;c!==null;)c.alternate!==null&&(u=c),c=c.sibling;u===null?o||a.tail===null?a.tail=null:a.tail.sibling=null:u.sibling=null}}function ns(a){var o=a.alternate!==null&&a.alternate.child===a.child,c=0,u=0;if(o)for(var p=a.child;p!==null;)c|=p.lanes|p.childLanes,u|=p.subtreeFlags&65011712,u|=p.flags&65011712,p.return=a,p=p.sibling;else for(p=a.child;p!==null;)c|=p.lanes|p.childLanes,u|=p.subtreeFlags,u|=p.flags,p.return=a,p=p.sibling;return a.subtreeFlags|=u,a.childLanes=c,o}function vC(a,o,c){var u=o.pendingProps;switch(Yp(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ns(o),null;case 1:return ns(o),null;case 3:return c=o.stateNode,u=null,a!==null&&(u=a.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),ei(Ps),ye(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(a===null||a.child===null)&&(Dc(o)?ri(o):a===null||a.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Jp())),ns(o),null;case 26:var p=o.type,x=o.memoizedState;return a===null?(ri(o),x!==null?(ns(o),Sj(o,x)):(ns(o),zx(o,p,null,u,c))):x?x!==a.memoizedState?(ri(o),ns(o),Sj(o,x)):(ns(o),o.flags&=-16777217):(a=a.memoizedProps,a!==u&&ri(o),ns(o),zx(o,p,a,u,c)),null;case 27:if(Fe(o),c=J.current,p=o.type,a!==null&&o.stateNode!=null)a.memoizedProps!==u&&ri(o);else{if(!u){if(o.stateNode===null)throw Error(r(166));return ns(o),null}a=H.current,Dc(o)?a2(o):(a=DN(p,u,c),o.stateNode=a,ri(o))}return ns(o),null;case 5:if(Fe(o),p=o.type,a!==null&&o.stateNode!=null)a.memoizedProps!==u&&ri(o);else{if(!u){if(o.stateNode===null)throw Error(r(166));return ns(o),null}if(x=H.current,Dc(o))a2(o);else{var _=ig(J.current);switch(x){case 1:x=_.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:x=_.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":x=_.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":x=_.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":x=_.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof u.is=="string"?_.createElement("select",{is:u.is}):_.createElement("select"),u.multiple?x.multiple=!0:u.size&&(x.size=u.size);break;default:x=typeof u.is=="string"?_.createElement(p,{is:u.is}):_.createElement(p)}}x[Rs]=o,x[Qs]=u;e:for(_=o.child;_!==null;){if(_.tag===5||_.tag===6)x.appendChild(_.stateNode);else if(_.tag!==4&&_.tag!==27&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===o)break e;for(;_.sibling===null;){if(_.return===null||_.return===o)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}o.stateNode=x;e:switch(cn(x,p,u),p){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&ri(o)}}return ns(o),zx(o,o.type,a===null?null:a.memoizedProps,o.pendingProps,c),null;case 6:if(a&&o.stateNode!=null)a.memoizedProps!==u&&ri(o);else{if(typeof u!="string"&&o.stateNode===null)throw Error(r(166));if(a=J.current,Dc(o)){if(a=o.stateNode,c=o.memoizedProps,u=null,p=an,p!==null)switch(p.tag){case 27:case 5:u=p.memoizedProps}a[Rs]=o,a=!!(a.nodeValue===c||u!==null&&u.suppressHydrationWarning===!0||jN(a.nodeValue,c)),a||Gi(o,!0)}else a=ig(a).createTextNode(u),a[Rs]=o,o.stateNode=a}return ns(o),null;case 31:if(c=o.memoizedState,a===null||a.memoizedState!==null){if(u=Dc(o),c!==null){if(a===null){if(!u)throw Error(r(318));if(a=o.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(557));a[Rs]=o}else dl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;ns(o),a=!1}else c=Jp(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=c),a=!0;if(!a)return o.flags&256?(ar(o),o):(ar(o),null);if((o.flags&128)!==0)throw Error(r(558))}return ns(o),null;case 13:if(u=o.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(p=Dc(o),u!==null&&u.dehydrated!==null){if(a===null){if(!p)throw Error(r(318));if(p=o.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));p[Rs]=o}else dl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;ns(o),p=!1}else p=Jp(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=p),p=!0;if(!p)return o.flags&256?(ar(o),o):(ar(o),null)}return ar(o),(o.flags&128)!==0?(o.lanes=c,o):(c=u!==null,a=a!==null&&a.memoizedState!==null,c&&(u=o.child,p=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(p=u.alternate.memoizedState.cachePool.pool),x=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(x=u.memoizedState.cachePool.pool),x!==p&&(u.flags|=2048)),c!==a&&c&&(o.child.flags|=8192),Hm(o,o.updateQueue),ns(o),null);case 4:return ye(),a===null&&db(o.stateNode.containerInfo),ns(o),null;case 10:return ei(o.type),ns(o),null;case 19:if(V(Ts),u=o.memoizedState,u===null)return ns(o),null;if(p=(o.flags&128)!==0,x=u.rendering,x===null)if(p)Yu(u,!1);else{if(bs!==0||a!==null&&(a.flags&128)!==0)for(a=o.child;a!==null;){if(x=Rm(a),x!==null){for(o.flags|=128,Yu(u,!1),a=x.updateQueue,o.updateQueue=a,Hm(o,a),o.subtreeFlags=0,a=c,c=o.child;c!==null;)e2(c,a),c=c.sibling;return X(Ts,Ts.current&1|2),Et&&Ja(o,u.treeForkCount),o.child}a=a.sibling}u.tail!==null&&tt()>Ym&&(o.flags|=128,p=!0,Yu(u,!1),o.lanes=4194304)}else{if(!p)if(a=Rm(x),a!==null){if(o.flags|=128,p=!0,a=a.updateQueue,o.updateQueue=a,Hm(o,a),Yu(u,!0),u.tail===null&&u.tailMode==="hidden"&&!x.alternate&&!Et)return ns(o),null}else 2*tt()-u.renderingStartTime>Ym&&c!==536870912&&(o.flags|=128,p=!0,Yu(u,!1),o.lanes=4194304);u.isBackwards?(x.sibling=o.child,o.child=x):(a=u.last,a!==null?a.sibling=x:o.child=x,u.last=x)}return u.tail!==null?(a=u.tail,u.rendering=a,u.tail=a.sibling,u.renderingStartTime=tt(),a.sibling=null,c=Ts.current,X(Ts,p?c&1|2:c&1),Et&&Ja(o,u.treeForkCount),a):(ns(o),null);case 22:case 23:return ar(o),ux(),u=o.memoizedState!==null,a!==null?a.memoizedState!==null!==u&&(o.flags|=8192):u&&(o.flags|=8192),u?(c&536870912)!==0&&(o.flags&128)===0&&(ns(o),o.subtreeFlags&6&&(o.flags|=8192)):ns(o),c=o.updateQueue,c!==null&&Hm(o,c.retryQueue),c=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),u=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(u=o.memoizedState.cachePool.pool),u!==c&&(o.flags|=2048),a!==null&&V(fl),null;case 24:return c=null,a!==null&&(c=a.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),ei(Ps),ns(o),null;case 25:return null;case 30:return null}throw Error(r(156,o.tag))}function wC(a,o){switch(Yp(o),o.tag){case 1:return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 3:return ei(Ps),ye(),a=o.flags,(a&65536)!==0&&(a&128)===0?(o.flags=a&-65537|128,o):null;case 26:case 27:case 5:return Fe(o),null;case 31:if(o.memoizedState!==null){if(ar(o),o.alternate===null)throw Error(r(340));dl()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 13:if(ar(o),a=o.memoizedState,a!==null&&a.dehydrated!==null){if(o.alternate===null)throw Error(r(340));dl()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 19:return V(Ts),null;case 4:return ye(),null;case 10:return ei(o.type),null;case 22:case 23:return ar(o),ux(),a!==null&&V(fl),a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 24:return ei(Ps),null;case 25:return null;default:return null}}function Ej(a,o){switch(Yp(o),o.tag){case 3:ei(Ps),ye();break;case 26:case 27:case 5:Fe(o);break;case 4:ye();break;case 31:o.memoizedState!==null&&ar(o);break;case 13:ar(o);break;case 19:V(Ts);break;case 10:ei(o.type);break;case 22:case 23:ar(o),ux(),a!==null&&V(fl);break;case 24:ei(Ps)}}function Xu(a,o){try{var c=o.updateQueue,u=c!==null?c.lastEffect:null;if(u!==null){var p=u.next;c=p;do{if((c.tag&a)===a){u=void 0;var x=c.create,_=c.inst;u=x(),_.destroy=u}c=c.next}while(c!==p)}}catch(z){$t(o,o.return,z)}}function Zi(a,o,c){try{var u=o.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var x=p.next;u=x;do{if((u.tag&a)===a){var _=u.inst,z=_.destroy;if(z!==void 0){_.destroy=void 0,p=o;var te=c,he=z;try{he()}catch(Ne){$t(p,te,Ne)}}}u=u.next}while(u!==x)}}catch(Ne){$t(o,o.return,Ne)}}function Ij(a){var o=a.updateQueue;if(o!==null){var c=a.stateNode;try{b2(o,c)}catch(u){$t(a,a.return,u)}}}function Aj(a,o,c){c.props=bl(a.type,a.memoizedProps),c.state=a.memoizedState;try{c.componentWillUnmount()}catch(u){$t(a,o,u)}}function Ju(a,o){try{var c=a.ref;if(c!==null){switch(a.tag){case 26:case 27:case 5:var u=a.stateNode;break;case 30:u=a.stateNode;break;default:u=a.stateNode}typeof c=="function"?a.refCleanup=c(u):c.current=u}}catch(p){$t(a,o,p)}}function ja(a,o){var c=a.ref,u=a.refCleanup;if(c!==null)if(typeof u=="function")try{u()}catch(p){$t(a,o,p)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(p){$t(a,o,p)}else c.current=null}function kj(a){var o=a.type,c=a.memoizedProps,u=a.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&u.focus();break e;case"img":c.src?u.src=c.src:c.srcSet&&(u.srcset=c.srcSet)}}catch(p){$t(a,a.return,p)}}function $x(a,o,c){try{var u=a.stateNode;$C(u,a.type,c,o),u[Qs]=o}catch(p){$t(a,a.return,p)}}function Cj(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&io(a.type)||a.tag===4}function qx(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||Cj(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&io(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Hx(a,o,c){var u=a.tag;if(u===5||u===6)a=a.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(a,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(a),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=$r));else if(u!==4&&(u===27&&io(a.type)&&(c=a.stateNode,o=null),a=a.child,a!==null))for(Hx(a,o,c),a=a.sibling;a!==null;)Hx(a,o,c),a=a.sibling}function Gm(a,o,c){var u=a.tag;if(u===5||u===6)a=a.stateNode,o?c.insertBefore(a,o):c.appendChild(a);else if(u!==4&&(u===27&&io(a.type)&&(c=a.stateNode),a=a.child,a!==null))for(Gm(a,o,c),a=a.sibling;a!==null;)Gm(a,o,c),a=a.sibling}function Rj(a){var o=a.stateNode,c=a.memoizedProps;try{for(var u=a.type,p=o.attributes;p.length;)o.removeAttributeNode(p[0]);cn(o,u,c),o[Rs]=a,o[Qs]=c}catch(x){$t(a,a.return,x)}}var ai=!1,Vs=!1,Gx=!1,Dj=typeof WeakSet=="function"?WeakSet:Set,Xs=null;function jC(a,o){if(a=a.containerInfo,fb=fg,a=H1(a),Up(a)){if("selectionStart"in a)var c={start:a.selectionStart,end:a.selectionEnd};else e:{c=(c=a.ownerDocument)&&c.defaultView||window;var u=c.getSelection&&c.getSelection();if(u&&u.rangeCount!==0){c=u.anchorNode;var p=u.anchorOffset,x=u.focusNode;u=u.focusOffset;try{c.nodeType,x.nodeType}catch{c=null;break e}var _=0,z=-1,te=-1,he=0,Ne=0,Ee=a,me=null;t:for(;;){for(var ve;Ee!==c||p!==0&&Ee.nodeType!==3||(z=_+p),Ee!==x||u!==0&&Ee.nodeType!==3||(te=_+u),Ee.nodeType===3&&(_+=Ee.nodeValue.length),(ve=Ee.firstChild)!==null;)me=Ee,Ee=ve;for(;;){if(Ee===a)break t;if(me===c&&++he===p&&(z=_),me===x&&++Ne===u&&(te=_),(ve=Ee.nextSibling)!==null)break;Ee=me,me=Ee.parentNode}Ee=ve}c=z===-1||te===-1?null:{start:z,end:te}}else c=null}c=c||{start:0,end:0}}else c=null;for(mb={focusedElem:a,selectionRange:c},fg=!1,Xs=o;Xs!==null;)if(o=Xs,a=o.child,(o.subtreeFlags&1028)!==0&&a!==null)a.return=o,Xs=a;else for(;Xs!==null;){switch(o=Xs,x=o.alternate,a=o.flags,o.tag){case 0:if((a&4)!==0&&(a=o.updateQueue,a=a!==null?a.events:null,a!==null))for(c=0;c<a.length;c++)p=a[c],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&x!==null){a=void 0,c=o,p=x.memoizedProps,x=x.memoizedState,u=c.stateNode;try{var He=bl(c.type,p);a=u.getSnapshotBeforeUpdate(He,x),u.__reactInternalSnapshotBeforeUpdate=a}catch(nt){$t(c,c.return,nt)}}break;case 3:if((a&1024)!==0){if(a=o.stateNode.containerInfo,c=a.nodeType,c===9)xb(a);else if(c===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":xb(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(r(163))}if(a=o.sibling,a!==null){a.return=o.return,Xs=a;break}Xs=o.return}}function Oj(a,o,c){var u=c.flags;switch(c.tag){case 0:case 11:case 15:oi(a,c),u&4&&Xu(5,c);break;case 1:if(oi(a,c),u&4)if(a=c.stateNode,o===null)try{a.componentDidMount()}catch(_){$t(c,c.return,_)}else{var p=bl(c.type,o.memoizedProps);o=o.memoizedState;try{a.componentDidUpdate(p,o,a.__reactInternalSnapshotBeforeUpdate)}catch(_){$t(c,c.return,_)}}u&64&&Ij(c),u&512&&Ju(c,c.return);break;case 3:if(oi(a,c),u&64&&(a=c.updateQueue,a!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{b2(a,o)}catch(_){$t(c,c.return,_)}}break;case 27:o===null&&u&4&&Rj(c);case 26:case 5:oi(a,c),o===null&&u&4&&kj(c),u&512&&Ju(c,c.return);break;case 12:oi(a,c);break;case 31:oi(a,c),u&4&&Lj(a,c);break;case 13:oi(a,c),u&4&&Vj(a,c),u&64&&(a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(c=CC.bind(null,c),XC(a,c))));break;case 22:if(u=c.memoizedState!==null||ai,!u){o=o!==null&&o.memoizedState!==null||Vs,p=ai;var x=Vs;ai=u,(Vs=o)&&!x?li(a,c,(c.subtreeFlags&8772)!==0):oi(a,c),ai=p,Vs=x}break;case 30:break;default:oi(a,c)}}function Pj(a){var o=a.alternate;o!==null&&(a.alternate=null,Pj(o)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(o=a.stateNode,o!==null&&pc(o)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var cs=null,zn=!1;function ii(a,o,c){for(c=c.child;c!==null;)Mj(a,o,c),c=c.sibling}function Mj(a,o,c){if(De&&typeof De.onCommitFiberUnmount=="function")try{De.onCommitFiberUnmount(we,c)}catch{}switch(c.tag){case 26:Vs||ja(c,o),ii(a,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Vs||ja(c,o);var u=cs,p=zn;io(c.type)&&(cs=c.stateNode,zn=!1),ii(a,o,c),oh(c.stateNode),cs=u,zn=p;break;case 5:Vs||ja(c,o);case 6:if(u=cs,p=zn,cs=null,ii(a,o,c),cs=u,zn=p,cs!==null)if(zn)try{(cs.nodeType===9?cs.body:cs.nodeName==="HTML"?cs.ownerDocument.body:cs).removeChild(c.stateNode)}catch(x){$t(c,o,x)}else try{cs.removeChild(c.stateNode)}catch(x){$t(c,o,x)}break;case 18:cs!==null&&(zn?(a=cs,IN(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,c.stateNode),ed(a)):IN(cs,c.stateNode));break;case 4:u=cs,p=zn,cs=c.stateNode.containerInfo,zn=!0,ii(a,o,c),cs=u,zn=p;break;case 0:case 11:case 14:case 15:Zi(2,c,o),Vs||Zi(4,c,o),ii(a,o,c);break;case 1:Vs||(ja(c,o),u=c.stateNode,typeof u.componentWillUnmount=="function"&&Aj(c,o,u)),ii(a,o,c);break;case 21:ii(a,o,c);break;case 22:Vs=(u=Vs)||c.memoizedState!==null,ii(a,o,c),Vs=u;break;default:ii(a,o,c)}}function Lj(a,o){if(o.memoizedState===null&&(a=o.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{ed(a)}catch(c){$t(o,o.return,c)}}}function Vj(a,o){if(o.memoizedState===null&&(a=o.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{ed(a)}catch(c){$t(o,o.return,c)}}function NC(a){switch(a.tag){case 31:case 13:case 19:var o=a.stateNode;return o===null&&(o=a.stateNode=new Dj),o;case 22:return a=a.stateNode,o=a._retryCache,o===null&&(o=a._retryCache=new Dj),o;default:throw Error(r(435,a.tag))}}function Wm(a,o){var c=NC(a);o.forEach(function(u){if(!c.has(u)){c.add(u);var p=RC.bind(null,a,u);u.then(p,p)}})}function $n(a,o){var c=o.deletions;if(c!==null)for(var u=0;u<c.length;u++){var p=c[u],x=a,_=o,z=_;e:for(;z!==null;){switch(z.tag){case 27:if(io(z.type)){cs=z.stateNode,zn=!1;break e}break;case 5:cs=z.stateNode,zn=!1;break e;case 3:case 4:cs=z.stateNode.containerInfo,zn=!0;break e}z=z.return}if(cs===null)throw Error(r(160));Mj(x,_,p),cs=null,zn=!1,x=p.alternate,x!==null&&(x.return=null),p.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)Uj(o,a),o=o.sibling}var Qr=null;function Uj(a,o){var c=a.alternate,u=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:$n(o,a),qn(a),u&4&&(Zi(3,a,a.return),Xu(3,a),Zi(5,a,a.return));break;case 1:$n(o,a),qn(a),u&512&&(Vs||c===null||ja(c,c.return)),u&64&&ai&&(a=a.updateQueue,a!==null&&(u=a.callbacks,u!==null&&(c=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=c===null?u:c.concat(u))));break;case 26:var p=Qr;if($n(o,a),qn(a),u&512&&(Vs||c===null||ja(c,c.return)),u&4){var x=c!==null?c.memoizedState:null;if(u=a.memoizedState,c===null)if(u===null)if(a.stateNode===null){e:{u=a.type,c=a.memoizedProps,p=p.ownerDocument||p;t:switch(u){case"title":x=p.getElementsByTagName("title")[0],(!x||x[la]||x[Rs]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=p.createElement(u),p.head.insertBefore(x,p.querySelector("head > title"))),cn(x,u,c),x[Rs]=a,Ds(x),u=x;break e;case"link":var _=UN("link","href",p).get(u+(c.href||""));if(_){for(var z=0;z<_.length;z++)if(x=_[z],x.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&x.getAttribute("rel")===(c.rel==null?null:c.rel)&&x.getAttribute("title")===(c.title==null?null:c.title)&&x.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){_.splice(z,1);break t}}x=p.createElement(u),cn(x,u,c),p.head.appendChild(x);break;case"meta":if(_=UN("meta","content",p).get(u+(c.content||""))){for(z=0;z<_.length;z++)if(x=_[z],x.getAttribute("content")===(c.content==null?null:""+c.content)&&x.getAttribute("name")===(c.name==null?null:c.name)&&x.getAttribute("property")===(c.property==null?null:c.property)&&x.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&x.getAttribute("charset")===(c.charSet==null?null:c.charSet)){_.splice(z,1);break t}}x=p.createElement(u),cn(x,u,c),p.head.appendChild(x);break;default:throw Error(r(468,u))}x[Rs]=a,Ds(x),u=x}a.stateNode=u}else FN(p,a.type,a.stateNode);else a.stateNode=VN(p,u,a.memoizedProps);else x!==u?(x===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):x.count--,u===null?FN(p,a.type,a.stateNode):VN(p,u,a.memoizedProps)):u===null&&a.stateNode!==null&&$x(a,a.memoizedProps,c.memoizedProps)}break;case 27:$n(o,a),qn(a),u&512&&(Vs||c===null||ja(c,c.return)),c!==null&&u&4&&$x(a,a.memoizedProps,c.memoizedProps);break;case 5:if($n(o,a),qn(a),u&512&&(Vs||c===null||ja(c,c.return)),a.flags&32){p=a.stateNode;try{Bn(p,"")}catch(He){$t(a,a.return,He)}}u&4&&a.stateNode!=null&&(p=a.memoizedProps,$x(a,p,c!==null?c.memoizedProps:p)),u&1024&&(Gx=!0);break;case 6:if($n(o,a),qn(a),u&4){if(a.stateNode===null)throw Error(r(162));u=a.memoizedProps,c=a.stateNode;try{c.nodeValue=u}catch(He){$t(a,a.return,He)}}break;case 3:if(cg=null,p=Qr,Qr=og(o.containerInfo),$n(o,a),Qr=p,qn(a),u&4&&c!==null&&c.memoizedState.isDehydrated)try{ed(o.containerInfo)}catch(He){$t(a,a.return,He)}Gx&&(Gx=!1,Fj(a));break;case 4:u=Qr,Qr=og(a.stateNode.containerInfo),$n(o,a),qn(a),Qr=u;break;case 12:$n(o,a),qn(a);break;case 31:$n(o,a),qn(a),u&4&&(u=a.updateQueue,u!==null&&(a.updateQueue=null,Wm(a,u)));break;case 13:$n(o,a),qn(a),a.child.flags&8192&&a.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Qm=tt()),u&4&&(u=a.updateQueue,u!==null&&(a.updateQueue=null,Wm(a,u)));break;case 22:p=a.memoizedState!==null;var te=c!==null&&c.memoizedState!==null,he=ai,Ne=Vs;if(ai=he||p,Vs=Ne||te,$n(o,a),Vs=Ne,ai=he,qn(a),u&8192)e:for(o=a.stateNode,o._visibility=p?o._visibility&-2:o._visibility|1,p&&(c===null||te||ai||Vs||yl(a)),c=null,o=a;;){if(o.tag===5||o.tag===26){if(c===null){te=c=o;try{if(x=te.stateNode,p)_=x.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none";else{z=te.stateNode;var Ee=te.memoizedProps.style,me=Ee!=null&&Ee.hasOwnProperty("display")?Ee.display:null;z.style.display=me==null||typeof me=="boolean"?"":(""+me).trim()}}catch(He){$t(te,te.return,He)}}}else if(o.tag===6){if(c===null){te=o;try{te.stateNode.nodeValue=p?"":te.memoizedProps}catch(He){$t(te,te.return,He)}}}else if(o.tag===18){if(c===null){te=o;try{var ve=te.stateNode;p?AN(ve,!0):AN(te.stateNode,!1)}catch(He){$t(te,te.return,He)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===a)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}u&4&&(u=a.updateQueue,u!==null&&(c=u.retryQueue,c!==null&&(u.retryQueue=null,Wm(a,c))));break;case 19:$n(o,a),qn(a),u&4&&(u=a.updateQueue,u!==null&&(a.updateQueue=null,Wm(a,u)));break;case 30:break;case 21:break;default:$n(o,a),qn(a)}}function qn(a){var o=a.flags;if(o&2){try{for(var c,u=a.return;u!==null;){if(Cj(u)){c=u;break}u=u.return}if(c==null)throw Error(r(160));switch(c.tag){case 27:var p=c.stateNode,x=qx(a);Gm(a,x,p);break;case 5:var _=c.stateNode;c.flags&32&&(Bn(_,""),c.flags&=-33);var z=qx(a);Gm(a,z,_);break;case 3:case 4:var te=c.stateNode.containerInfo,he=qx(a);Hx(a,he,te);break;default:throw Error(r(161))}}catch(Ne){$t(a,a.return,Ne)}a.flags&=-3}o&4096&&(a.flags&=-4097)}function Fj(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var o=a;Fj(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),a=a.sibling}}function oi(a,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Oj(a,o.alternate,o),o=o.sibling}function yl(a){for(a=a.child;a!==null;){var o=a;switch(o.tag){case 0:case 11:case 14:case 15:Zi(4,o,o.return),yl(o);break;case 1:ja(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&Aj(o,o.return,c),yl(o);break;case 27:oh(o.stateNode);case 26:case 5:ja(o,o.return),yl(o);break;case 22:o.memoizedState===null&&yl(o);break;case 30:yl(o);break;default:yl(o)}a=a.sibling}}function li(a,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var u=o.alternate,p=a,x=o,_=x.flags;switch(x.tag){case 0:case 11:case 15:li(p,x,c),Xu(4,x);break;case 1:if(li(p,x,c),u=x,p=u.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(he){$t(u,u.return,he)}if(u=x,p=u.updateQueue,p!==null){var z=u.stateNode;try{var te=p.shared.hiddenCallbacks;if(te!==null)for(p.shared.hiddenCallbacks=null,p=0;p<te.length;p++)x2(te[p],z)}catch(he){$t(u,u.return,he)}}c&&_&64&&Ij(x),Ju(x,x.return);break;case 27:Rj(x);case 26:case 5:li(p,x,c),c&&u===null&&_&4&&kj(x),Ju(x,x.return);break;case 12:li(p,x,c);break;case 31:li(p,x,c),c&&_&4&&Lj(p,x);break;case 13:li(p,x,c),c&&_&4&&Vj(p,x);break;case 22:x.memoizedState===null&&li(p,x,c),Ju(x,x.return);break;case 30:break;default:li(p,x,c)}o=o.sibling}}function Wx(a,o){var c=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),a=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(a=o.memoizedState.cachePool.pool),a!==c&&(a!=null&&a.refCount++,c!=null&&Vu(c))}function Kx(a,o){a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&Vu(a))}function Yr(a,o,c,u){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Bj(a,o,c,u),o=o.sibling}function Bj(a,o,c,u){var p=o.flags;switch(o.tag){case 0:case 11:case 15:Yr(a,o,c,u),p&2048&&Xu(9,o);break;case 1:Yr(a,o,c,u);break;case 3:Yr(a,o,c,u),p&2048&&(a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&Vu(a)));break;case 12:if(p&2048){Yr(a,o,c,u),a=o.stateNode;try{var x=o.memoizedProps,_=x.id,z=x.onPostCommit;typeof z=="function"&&z(_,o.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(te){$t(o,o.return,te)}}else Yr(a,o,c,u);break;case 31:Yr(a,o,c,u);break;case 13:Yr(a,o,c,u);break;case 23:break;case 22:x=o.stateNode,_=o.alternate,o.memoizedState!==null?x._visibility&2?Yr(a,o,c,u):Zu(a,o):x._visibility&2?Yr(a,o,c,u):(x._visibility|=2,$c(a,o,c,u,(o.subtreeFlags&10256)!==0||!1)),p&2048&&Wx(_,o);break;case 24:Yr(a,o,c,u),p&2048&&Kx(o.alternate,o);break;default:Yr(a,o,c,u)}}function $c(a,o,c,u,p){for(p=p&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var x=a,_=o,z=c,te=u,he=_.flags;switch(_.tag){case 0:case 11:case 15:$c(x,_,z,te,p),Xu(8,_);break;case 23:break;case 22:var Ne=_.stateNode;_.memoizedState!==null?Ne._visibility&2?$c(x,_,z,te,p):Zu(x,_):(Ne._visibility|=2,$c(x,_,z,te,p)),p&&he&2048&&Wx(_.alternate,_);break;case 24:$c(x,_,z,te,p),p&&he&2048&&Kx(_.alternate,_);break;default:$c(x,_,z,te,p)}o=o.sibling}}function Zu(a,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=a,u=o,p=u.flags;switch(u.tag){case 22:Zu(c,u),p&2048&&Wx(u.alternate,u);break;case 24:Zu(c,u),p&2048&&Kx(u.alternate,u);break;default:Zu(c,u)}o=o.sibling}}var eh=8192;function qc(a,o,c){if(a.subtreeFlags&eh)for(a=a.child;a!==null;)zj(a,o,c),a=a.sibling}function zj(a,o,c){switch(a.tag){case 26:qc(a,o,c),a.flags&eh&&a.memoizedState!==null&&c3(c,Qr,a.memoizedState,a.memoizedProps);break;case 5:qc(a,o,c);break;case 3:case 4:var u=Qr;Qr=og(a.stateNode.containerInfo),qc(a,o,c),Qr=u;break;case 22:a.memoizedState===null&&(u=a.alternate,u!==null&&u.memoizedState!==null?(u=eh,eh=16777216,qc(a,o,c),eh=u):qc(a,o,c));break;default:qc(a,o,c)}}function $j(a){var o=a.alternate;if(o!==null&&(a=o.child,a!==null)){o.child=null;do o=a.sibling,a.sibling=null,a=o;while(a!==null)}}function th(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var u=o[c];Xs=u,Hj(u,a)}$j(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)qj(a),a=a.sibling}function qj(a){switch(a.tag){case 0:case 11:case 15:th(a),a.flags&2048&&Zi(9,a,a.return);break;case 3:th(a);break;case 12:th(a);break;case 22:var o=a.stateNode;a.memoizedState!==null&&o._visibility&2&&(a.return===null||a.return.tag!==13)?(o._visibility&=-3,Km(a)):th(a);break;default:th(a)}}function Km(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var u=o[c];Xs=u,Hj(u,a)}$j(a)}for(a=a.child;a!==null;){switch(o=a,o.tag){case 0:case 11:case 15:Zi(8,o,o.return),Km(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,Km(o));break;default:Km(o)}a=a.sibling}}function Hj(a,o){for(;Xs!==null;){var c=Xs;switch(c.tag){case 0:case 11:case 15:Zi(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var u=c.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Vu(c.memoizedState.cache)}if(u=c.child,u!==null)u.return=c,Xs=u;else e:for(c=a;Xs!==null;){u=Xs;var p=u.sibling,x=u.return;if(Pj(u),u===c){Xs=null;break e}if(p!==null){p.return=x,Xs=p;break e}Xs=x}}}var _C={getCacheForType:function(a){var o=on(Ps),c=o.data.get(a);return c===void 0&&(c=a(),o.data.set(a,c)),c},cacheSignal:function(){return on(Ps).controller.signal}},TC=typeof WeakMap=="function"?WeakMap:Map,Pt=0,Jt=null,yt=null,_t=0,zt=0,ir=null,eo=!1,Hc=!1,Qx=!1,ci=0,bs=0,to=0,vl=0,Yx=0,or=0,Gc=0,sh=null,Hn=null,Xx=!1,Qm=0,Gj=0,Ym=1/0,Xm=null,so=null,qs=0,no=null,Wc=null,di=0,Jx=0,Zx=null,Wj=null,nh=0,eb=null;function lr(){return(Pt&2)!==0&&_t!==0?_t&-_t:k.T!==null?ib():Jf()}function Kj(){if(or===0)if((_t&536870912)===0||Et){var a=Ns;Ns<<=1,(Ns&3932160)===0&&(Ns=262144),or=a}else or=536870912;return a=rr.current,a!==null&&(a.flags|=32),or}function Gn(a,o,c){(a===Jt&&(zt===2||zt===9)||a.cancelPendingCommit!==null)&&(Kc(a,0),ro(a,_t,or,!1)),Ko(a,c),((Pt&2)===0||a!==Jt)&&(a===Jt&&((Pt&2)===0&&(vl|=c),bs===4&&ro(a,_t,or,!1)),Na(a))}function Qj(a,o,c){if((Pt&6)!==0)throw Error(r(327));var u=!c&&(o&127)===0&&(o&a.expiredLanes)===0||Fr(a,o),p=u?IC(a,o):sb(a,o,!0),x=u;do{if(p===0){Hc&&!u&&ro(a,o,0,!1);break}else{if(c=a.current.alternate,x&&!SC(c)){p=sb(a,o,!1),x=!1;continue}if(p===2){if(x=o,a.errorRecoveryDisabledLanes&x)var _=0;else _=a.pendingLanes&-536870913,_=_!==0?_:_&536870912?536870912:0;if(_!==0){o=_;e:{var z=a;p=sh;var te=z.current.memoizedState.isDehydrated;if(te&&(Kc(z,_).flags|=256),_=sb(z,_,!1),_!==2){if(Qx&&!te){z.errorRecoveryDisabledLanes|=x,vl|=x,p=4;break e}x=Hn,Hn=p,x!==null&&(Hn===null?Hn=x:Hn.push.apply(Hn,x))}p=_}if(x=!1,p!==2)continue}}if(p===1){Kc(a,0),ro(a,o,0,!0);break}e:{switch(u=a,x=p,x){case 0:case 1:throw Error(r(345));case 4:if((o&4194048)!==o)break;case 6:ro(u,o,or,!eo);break e;case 2:Hn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((o&62914560)===o&&(p=Qm+300-tt(),10<p)){if(ro(u,o,or,!eo),Un(u,0,!0)!==0)break e;di=o,u.timeoutHandle=SN(Yj.bind(null,u,c,Hn,Xm,Xx,o,or,vl,Gc,eo,x,"Throttled",-0,0),p);break e}Yj(u,c,Hn,Xm,Xx,o,or,vl,Gc,eo,x,null,-0,0)}}break}while(!0);Na(a)}function Yj(a,o,c,u,p,x,_,z,te,he,Ne,Ee,me,ve){if(a.timeoutHandle=-1,Ee=o.subtreeFlags,Ee&8192||(Ee&16785408)===16785408){Ee={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:$r},zj(o,x,Ee);var He=(x&62914560)===x?Qm-tt():(x&4194048)===x?Gj-tt():0;if(He=d3(Ee,He),He!==null){di=x,a.cancelPendingCommit=He(rN.bind(null,a,o,x,c,u,p,_,z,te,Ne,Ee,null,me,ve)),ro(a,x,_,!he);return}}rN(a,o,x,c,u,p,_,z,te)}function SC(a){for(var o=a;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var u=0;u<c.length;u++){var p=c[u],x=p.getSnapshot;p=p.value;try{if(!sr(x(),p))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ro(a,o,c,u){o&=~Yx,o&=~vl,a.suspendedLanes|=o,a.pingedLanes&=~o,u&&(a.warmLanes|=o),u=a.expirationTimes;for(var p=o;0<p;){var x=31-Le(p),_=1<<x;u[x]=-1,p&=~_}c!==0&&Qo(a,c,o)}function Jm(){return(Pt&6)===0?(rh(0),!1):!0}function tb(){if(yt!==null){if(zt===0)var a=yt.return;else a=yt,Za=ul=null,xx(a),Vc=null,Fu=0,a=yt;for(;a!==null;)Ej(a.alternate,a),a=a.return;yt=null}}function Kc(a,o){var c=a.timeoutHandle;c!==-1&&(a.timeoutHandle=-1,GC(c)),c=a.cancelPendingCommit,c!==null&&(a.cancelPendingCommit=null,c()),di=0,tb(),Jt=a,yt=c=Xa(a.current,null),_t=o,zt=0,ir=null,eo=!1,Hc=Fr(a,o),Qx=!1,Gc=or=Yx=vl=to=bs=0,Hn=sh=null,Xx=!1,(o&8)!==0&&(o|=o&32);var u=a.entangledLanes;if(u!==0)for(a=a.entanglements,u&=o;0<u;){var p=31-Le(u),x=1<<p;o|=a[p],u&=~x}return ci=o,ym(),c}function Xj(a,o){ht=null,k.H=Ku,o===Lc||o===Em?(o=f2(),zt=3):o===ax?(o=f2(),zt=4):zt=o===Dx?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,ir=o,yt===null&&(bs=1,Bm(a,Nr(o,a.current)))}function Jj(){var a=rr.current;return a===null?!0:(_t&4194048)===_t?Er===null:(_t&62914560)===_t||(_t&536870912)!==0?a===Er:!1}function Zj(){var a=k.H;return k.H=Ku,a===null?Ku:a}function eN(){var a=k.A;return k.A=_C,a}function Zm(){bs=4,eo||(_t&4194048)!==_t&&rr.current!==null||(Hc=!0),(to&134217727)===0&&(vl&134217727)===0||Jt===null||ro(Jt,_t,or,!1)}function sb(a,o,c){var u=Pt;Pt|=2;var p=Zj(),x=eN();(Jt!==a||_t!==o)&&(Xm=null,Kc(a,o)),o=!1;var _=bs;e:do try{if(zt!==0&&yt!==null){var z=yt,te=ir;switch(zt){case 8:tb(),_=6;break e;case 3:case 2:case 9:case 6:rr.current===null&&(o=!0);var he=zt;if(zt=0,ir=null,Qc(a,z,te,he),c&&Hc){_=0;break e}break;default:he=zt,zt=0,ir=null,Qc(a,z,te,he)}}EC(),_=bs;break}catch(Ne){Xj(a,Ne)}while(!0);return o&&a.shellSuspendCounter++,Za=ul=null,Pt=u,k.H=p,k.A=x,yt===null&&(Jt=null,_t=0,ym()),_}function EC(){for(;yt!==null;)tN(yt)}function IC(a,o){var c=Pt;Pt|=2;var u=Zj(),p=eN();Jt!==a||_t!==o?(Xm=null,Ym=tt()+500,Kc(a,o)):Hc=Fr(a,o);e:do try{if(zt!==0&&yt!==null){o=yt;var x=ir;t:switch(zt){case 1:zt=0,ir=null,Qc(a,o,x,1);break;case 2:case 9:if(u2(x)){zt=0,ir=null,sN(o);break}o=function(){zt!==2&&zt!==9||Jt!==a||(zt=7),Na(a)},x.then(o,o);break e;case 3:zt=7;break e;case 4:zt=5;break e;case 7:u2(x)?(zt=0,ir=null,sN(o)):(zt=0,ir=null,Qc(a,o,x,7));break;case 5:var _=null;switch(yt.tag){case 26:_=yt.memoizedState;case 5:case 27:var z=yt;if(_?BN(_):z.stateNode.complete){zt=0,ir=null;var te=z.sibling;if(te!==null)yt=te;else{var he=z.return;he!==null?(yt=he,eg(he)):yt=null}break t}}zt=0,ir=null,Qc(a,o,x,5);break;case 6:zt=0,ir=null,Qc(a,o,x,6);break;case 8:tb(),bs=6;break e;default:throw Error(r(462))}}AC();break}catch(Ne){Xj(a,Ne)}while(!0);return Za=ul=null,k.H=u,k.A=p,Pt=c,yt!==null?0:(Jt=null,_t=0,ym(),bs)}function AC(){for(;yt!==null&&!Me();)tN(yt)}function tN(a){var o=Tj(a.alternate,a,ci);a.memoizedProps=a.pendingProps,o===null?eg(a):yt=o}function sN(a){var o=a,c=o.alternate;switch(o.tag){case 15:case 0:o=yj(c,o,o.pendingProps,o.type,void 0,_t);break;case 11:o=yj(c,o,o.pendingProps,o.type.render,o.ref,_t);break;case 5:xx(o);default:Ej(c,o),o=yt=e2(o,ci),o=Tj(c,o,ci)}a.memoizedProps=a.pendingProps,o===null?eg(a):yt=o}function Qc(a,o,c,u){Za=ul=null,xx(o),Vc=null,Fu=0;var p=o.return;try{if(xC(a,p,o,c,_t)){bs=1,Bm(a,Nr(c,a.current)),yt=null;return}}catch(x){if(p!==null)throw yt=p,x;bs=1,Bm(a,Nr(c,a.current)),yt=null;return}o.flags&32768?(Et||u===1?a=!0:Hc||(_t&536870912)!==0?a=!1:(eo=a=!0,(u===2||u===9||u===3||u===6)&&(u=rr.current,u!==null&&u.tag===13&&(u.flags|=16384))),nN(o,a)):eg(o)}function eg(a){var o=a;do{if((o.flags&32768)!==0){nN(o,eo);return}a=o.return;var c=vC(o.alternate,o,ci);if(c!==null){yt=c;return}if(o=o.sibling,o!==null){yt=o;return}yt=o=a}while(o!==null);bs===0&&(bs=5)}function nN(a,o){do{var c=wC(a.alternate,a);if(c!==null){c.flags&=32767,yt=c;return}if(c=a.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(a=a.sibling,a!==null)){yt=a;return}yt=a=c}while(a!==null);bs=6,yt=null}function rN(a,o,c,u,p,x,_,z,te){a.cancelPendingCommit=null;do tg();while(qs!==0);if((Pt&6)!==0)throw Error(r(327));if(o!==null){if(o===a.current)throw Error(r(177));if(x=o.lanes|o.childLanes,x|=qp,Pp(a,c,x,_,z,te),a===Jt&&(yt=Jt=null,_t=0),Wc=o,no=a,di=c,Jx=x,Zx=p,Wj=u,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,DC(Lt,function(){return cN(),null})):(a.callbackNode=null,a.callbackPriority=0),u=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||u){u=k.T,k.T=null,p=q.p,q.p=2,_=Pt,Pt|=4;try{jC(a,o,c)}finally{Pt=_,q.p=p,k.T=u}}qs=1,aN(),iN(),oN()}}function aN(){if(qs===1){qs=0;var a=no,o=Wc,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=k.T,k.T=null;var u=q.p;q.p=2;var p=Pt;Pt|=4;try{Uj(o,a);var x=mb,_=H1(a.containerInfo),z=x.focusedElem,te=x.selectionRange;if(_!==z&&z&&z.ownerDocument&&q1(z.ownerDocument.documentElement,z)){if(te!==null&&Up(z)){var he=te.start,Ne=te.end;if(Ne===void 0&&(Ne=he),"selectionStart"in z)z.selectionStart=he,z.selectionEnd=Math.min(Ne,z.value.length);else{var Ee=z.ownerDocument||document,me=Ee&&Ee.defaultView||window;if(me.getSelection){var ve=me.getSelection(),He=z.textContent.length,nt=Math.min(te.start,He),Xt=te.end===void 0?nt:Math.min(te.end,He);!ve.extend&&nt>Xt&&(_=Xt,Xt=nt,nt=_);var ie=$1(z,nt),re=$1(z,Xt);if(ie&&re&&(ve.rangeCount!==1||ve.anchorNode!==ie.node||ve.anchorOffset!==ie.offset||ve.focusNode!==re.node||ve.focusOffset!==re.offset)){var ue=Ee.createRange();ue.setStart(ie.node,ie.offset),ve.removeAllRanges(),nt>Xt?(ve.addRange(ue),ve.extend(re.node,re.offset)):(ue.setEnd(re.node,re.offset),ve.addRange(ue))}}}}for(Ee=[],ve=z;ve=ve.parentNode;)ve.nodeType===1&&Ee.push({element:ve,left:ve.scrollLeft,top:ve.scrollTop});for(typeof z.focus=="function"&&z.focus(),z=0;z<Ee.length;z++){var Se=Ee[z];Se.element.scrollLeft=Se.left,Se.element.scrollTop=Se.top}}fg=!!fb,mb=fb=null}finally{Pt=p,q.p=u,k.T=c}}a.current=o,qs=2}}function iN(){if(qs===2){qs=0;var a=no,o=Wc,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=k.T,k.T=null;var u=q.p;q.p=2;var p=Pt;Pt|=4;try{Oj(a,o.alternate,o)}finally{Pt=p,q.p=u,k.T=c}}qs=3}}function oN(){if(qs===4||qs===3){qs=0,st();var a=no,o=Wc,c=di,u=Wj;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?qs=5:(qs=0,Wc=no=null,lN(a,a.pendingLanes));var p=a.pendingLanes;if(p===0&&(so=null),Wa(c),o=o.stateNode,De&&typeof De.onCommitFiberRoot=="function")try{De.onCommitFiberRoot(we,o,void 0,(o.current.flags&128)===128)}catch{}if(u!==null){o=k.T,p=q.p,q.p=2,k.T=null;try{for(var x=a.onRecoverableError,_=0;_<u.length;_++){var z=u[_];x(z.value,{componentStack:z.stack})}}finally{k.T=o,q.p=p}}(di&3)!==0&&tg(),Na(a),p=a.pendingLanes,(c&261930)!==0&&(p&42)!==0?a===eb?nh++:(nh=0,eb=a):nh=0,rh(0)}}function lN(a,o){(a.pooledCacheLanes&=o)===0&&(o=a.pooledCache,o!=null&&(a.pooledCache=null,Vu(o)))}function tg(){return aN(),iN(),oN(),cN()}function cN(){if(qs!==5)return!1;var a=no,o=Jx;Jx=0;var c=Wa(di),u=k.T,p=q.p;try{q.p=32>c?32:c,k.T=null,c=Zx,Zx=null;var x=no,_=di;if(qs=0,Wc=no=null,di=0,(Pt&6)!==0)throw Error(r(331));var z=Pt;if(Pt|=4,qj(x.current),Bj(x,x.current,_,c),Pt=z,rh(0,!1),De&&typeof De.onPostCommitFiberRoot=="function")try{De.onPostCommitFiberRoot(we,x)}catch{}return!0}finally{q.p=p,k.T=u,lN(a,o)}}function dN(a,o,c){o=Nr(c,o),o=Rx(a.stateNode,o,2),a=Yi(a,o,2),a!==null&&(Ko(a,2),Na(a))}function $t(a,o,c){if(a.tag===3)dN(a,a,c);else for(;o!==null;){if(o.tag===3){dN(o,a,c);break}else if(o.tag===1){var u=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(so===null||!so.has(u))){a=Nr(c,a),c=uj(2),u=Yi(o,c,2),u!==null&&(hj(c,u,o,a),Ko(u,2),Na(u));break}}o=o.return}}function nb(a,o,c){var u=a.pingCache;if(u===null){u=a.pingCache=new TC;var p=new Set;u.set(o,p)}else p=u.get(o),p===void 0&&(p=new Set,u.set(o,p));p.has(c)||(Qx=!0,p.add(c),a=kC.bind(null,a,o,c),o.then(a,a))}function kC(a,o,c){var u=a.pingCache;u!==null&&u.delete(o),a.pingedLanes|=a.suspendedLanes&c,a.warmLanes&=~c,Jt===a&&(_t&c)===c&&(bs===4||bs===3&&(_t&62914560)===_t&&300>tt()-Qm?(Pt&2)===0&&Kc(a,0):Yx|=c,Gc===_t&&(Gc=0)),Na(a)}function uN(a,o){o===0&&(o=Xf()),a=ll(a,o),a!==null&&(Ko(a,o),Na(a))}function CC(a){var o=a.memoizedState,c=0;o!==null&&(c=o.retryLane),uN(a,c)}function RC(a,o){var c=0;switch(a.tag){case 31:case 13:var u=a.stateNode,p=a.memoizedState;p!==null&&(c=p.retryLane);break;case 19:u=a.stateNode;break;case 22:u=a.stateNode._retryCache;break;default:throw Error(r(314))}u!==null&&u.delete(o),uN(a,c)}function DC(a,o){return fe(a,o)}var sg=null,Yc=null,rb=!1,ng=!1,ab=!1,ao=0;function Na(a){a!==Yc&&a.next===null&&(Yc===null?sg=Yc=a:Yc=Yc.next=a),ng=!0,rb||(rb=!0,PC())}function rh(a,o){if(!ab&&ng){ab=!0;do for(var c=!1,u=sg;u!==null;){if(a!==0){var p=u.pendingLanes;if(p===0)var x=0;else{var _=u.suspendedLanes,z=u.pingedLanes;x=(1<<31-Le(42|a)+1)-1,x&=p&~(_&~z),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(c=!0,gN(u,x))}else x=_t,x=Un(u,u===Jt?x:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(x&3)===0||Fr(u,x)||(c=!0,gN(u,x));u=u.next}while(c);ab=!1}}function OC(){hN()}function hN(){ng=rb=!1;var a=0;ao!==0&&HC()&&(a=ao);for(var o=tt(),c=null,u=sg;u!==null;){var p=u.next,x=fN(u,o);x===0?(u.next=null,c===null?sg=p:c.next=p,p===null&&(Yc=c)):(c=u,(a!==0||(x&3)!==0)&&(ng=!0)),u=p}qs!==0&&qs!==5||rh(a),ao!==0&&(ao=0)}function fN(a,o){for(var c=a.suspendedLanes,u=a.pingedLanes,p=a.expirationTimes,x=a.pendingLanes&-62914561;0<x;){var _=31-Le(x),z=1<<_,te=p[_];te===-1?((z&c)===0||(z&u)!==0)&&(p[_]=Op(z,o)):te<=o&&(a.expiredLanes|=z),x&=~z}if(o=Jt,c=_t,c=Un(a,a===o?c:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),u=a.callbackNode,c===0||a===o&&(zt===2||zt===9)||a.cancelPendingCommit!==null)return u!==null&&u!==null&&_e(u),a.callbackNode=null,a.callbackPriority=0;if((c&3)===0||Fr(a,c)){if(o=c&-c,o===a.callbackPriority)return o;switch(u!==null&&_e(u),Wa(c)){case 2:case 8:c=bt;break;case 32:c=Lt;break;case 268435456:c=os;break;default:c=Lt}return u=mN.bind(null,a),c=fe(c,u),a.callbackPriority=o,a.callbackNode=c,o}return u!==null&&u!==null&&_e(u),a.callbackPriority=2,a.callbackNode=null,2}function mN(a,o){if(qs!==0&&qs!==5)return a.callbackNode=null,a.callbackPriority=0,null;var c=a.callbackNode;if(tg()&&a.callbackNode!==c)return null;var u=_t;return u=Un(a,a===Jt?u:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),u===0?null:(Qj(a,u,o),fN(a,tt()),a.callbackNode!=null&&a.callbackNode===c?mN.bind(null,a):null)}function gN(a,o){if(tg())return null;Qj(a,o,!0)}function PC(){WC(function(){(Pt&6)!==0?fe($e,OC):hN()})}function ib(){if(ao===0){var a=Pc;a===0&&(a=mt,mt<<=1,(mt&261888)===0&&(mt=256)),ao=a}return ao}function pN(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:vc(""+a)}function xN(a,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,a.id&&c.setAttribute("form",a.id),o.parentNode.insertBefore(c,o),a=new FormData(a),c.parentNode.removeChild(c),a}function MC(a,o,c,u,p){if(o==="submit"&&c&&c.stateNode===p){var x=pN((p[Qs]||null).action),_=u.submitter;_&&(o=(o=_[Qs]||null)?pN(o.formAction):_.getAttribute("formAction"),o!==null&&(x=o,_=null));var z=new pa("action","action",null,u,p);a.push({event:z,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(ao!==0){var te=_?xN(p,_):new FormData(p);Sx(c,{pending:!0,data:te,method:p.method,action:x},null,te)}}else typeof x=="function"&&(z.preventDefault(),te=_?xN(p,_):new FormData(p),Sx(c,{pending:!0,data:te,method:p.method,action:x},x,te))},currentTarget:p}]})}}for(var ob=0;ob<$p.length;ob++){var lb=$p[ob],LC=lb.toLowerCase(),VC=lb[0].toUpperCase()+lb.slice(1);Kr(LC,"on"+VC)}Kr(K1,"onAnimationEnd"),Kr(Q1,"onAnimationIteration"),Kr(Y1,"onAnimationStart"),Kr("dblclick","onDoubleClick"),Kr("focusin","onFocus"),Kr("focusout","onBlur"),Kr(eC,"onTransitionRun"),Kr(tC,"onTransitionStart"),Kr(sC,"onTransitionCancel"),Kr(X1,"onTransitionEnd"),ha("onMouseEnter",["mouseout","mouseover"]),ha("onMouseLeave",["mouseout","mouseover"]),ha("onPointerEnter",["pointerout","pointerover"]),ha("onPointerLeave",["pointerout","pointerover"]),ua("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ua("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ua("onBeforeInput",["compositionend","keypress","textInput","paste"]),ua("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ua("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ua("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ah="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),UC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ah));function bN(a,o){o=(o&4)!==0;for(var c=0;c<a.length;c++){var u=a[c],p=u.event;u=u.listeners;e:{var x=void 0;if(o)for(var _=u.length-1;0<=_;_--){var z=u[_],te=z.instance,he=z.currentTarget;if(z=z.listener,te!==x&&p.isPropagationStopped())break e;x=z,p.currentTarget=he;try{x(p)}catch(Ne){bm(Ne)}p.currentTarget=null,x=te}else for(_=0;_<u.length;_++){if(z=u[_],te=z.instance,he=z.currentTarget,z=z.listener,te!==x&&p.isPropagationStopped())break e;x=z,p.currentTarget=he;try{x(p)}catch(Ne){bm(Ne)}p.currentTarget=null,x=te}}}}function vt(a,o){var c=o[gc];c===void 0&&(c=o[gc]=new Set);var u=a+"__bubble";c.has(u)||(yN(o,a,2,!1),c.add(u))}function cb(a,o,c){var u=0;o&&(u|=4),yN(c,a,u,o)}var rg="_reactListening"+Math.random().toString(36).slice(2);function db(a){if(!a[rg]){a[rg]=!0,xu.forEach(function(c){c!=="selectionchange"&&(UC.has(c)||cb(c,!1,a),cb(c,!0,a))});var o=a.nodeType===9?a:a.ownerDocument;o===null||o[rg]||(o[rg]=!0,cb("selectionchange",!1,o))}}function yN(a,o,c,u){switch(KN(o)){case 2:var p=f3;break;case 8:p=m3;break;default:p=Tb}c=p.bind(null,o,c,a),p=void 0,!el||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(p=!0),u?p!==void 0?a.addEventListener(o,c,{capture:!0,passive:p}):a.addEventListener(o,c,!0):p!==void 0?a.addEventListener(o,c,{passive:p}):a.addEventListener(o,c,!1)}function ub(a,o,c,u,p){var x=u;if((o&1)===0&&(o&2)===0&&u!==null)e:for(;;){if(u===null)return;var _=u.tag;if(_===3||_===4){var z=u.stateNode.containerInfo;if(z===p)break;if(_===4)for(_=u.return;_!==null;){var te=_.tag;if((te===3||te===4)&&_.stateNode.containerInfo===p)return;_=_.return}for(;z!==null;){if(_=ca(z),_===null)return;if(te=_.tag,te===5||te===6||te===26||te===27){u=x=_;continue e}z=z.parentNode}}u=u.return}Fi(function(){var he=x,Ne=yr(c),Ee=[];e:{var me=J1.get(a);if(me!==void 0){var ve=pa,He=a;switch(a){case"keypress":if(sl(c)===0)break e;case"keydown":case"keyup":ve=gm;break;case"focusin":He="focus",ve=rl;break;case"focusout":He="blur",ve=rl;break;case"beforeblur":case"afterblur":ve=rl;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=ku;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=im;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=j;break;case K1:case Q1:case Y1:ve=lm;break;case X1:ve=G;break;case"scroll":case"scrollend":ve=Au;break;case"wheel":ve=be;break;case"copy":case"cut":case"paste":ve=cm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=Ya;break;case"toggle":case"beforetoggle":ve=ut}var nt=(o&4)!==0,Xt=!nt&&(a==="scroll"||a==="scrollend"),ie=nt?me!==null?me+"Capture":null:me;nt=[];for(var re=he,ue;re!==null;){var Se=re;if(ue=Se.stateNode,Se=Se.tag,Se!==5&&Se!==26&&Se!==27||ue===null||ie===null||(Se=qr(re,ie),Se!=null&&nt.push(ih(re,Se,ue))),Xt)break;re=re.return}0<nt.length&&(me=new ve(me,He,null,c,Ne),Ee.push({event:me,listeners:nt}))}}if((o&7)===0){e:{if(me=a==="mouseover"||a==="pointerover",ve=a==="mouseout"||a==="pointerout",me&&c!==Su&&(He=c.relatedTarget||c.fromElement)&&(ca(He)||He[oa]))break e;if((ve||me)&&(me=Ne.window===Ne?Ne:(me=Ne.ownerDocument)?me.defaultView||me.parentWindow:window,ve?(He=c.relatedTarget||c.toElement,ve=he,He=He?ca(He):null,He!==null&&(Xt=l(He),nt=He.tag,He!==Xt||nt!==5&&nt!==27&&nt!==6)&&(He=null)):(ve=null,He=he),ve!==He)){if(nt=ku,Se="onMouseLeave",ie="onMouseEnter",re="mouse",(a==="pointerout"||a==="pointerover")&&(nt=Ya,Se="onPointerLeave",ie="onPointerEnter",re="pointer"),Xt=ve==null?me:er(ve),ue=He==null?me:er(He),me=new nt(Se,re+"leave",ve,c,Ne),me.target=Xt,me.relatedTarget=ue,Se=null,ca(Ne)===he&&(nt=new nt(ie,re+"enter",He,c,Ne),nt.target=ue,nt.relatedTarget=Xt,Se=nt),Xt=Se,ve&&He)t:{for(nt=FC,ie=ve,re=He,ue=0,Se=ie;Se;Se=nt(Se))ue++;Se=0;for(var Je=re;Je;Je=nt(Je))Se++;for(;0<ue-Se;)ie=nt(ie),ue--;for(;0<Se-ue;)re=nt(re),Se--;for(;ue--;){if(ie===re||re!==null&&ie===re.alternate){nt=ie;break t}ie=nt(ie),re=nt(re)}nt=null}else nt=null;ve!==null&&vN(Ee,me,ve,nt,!1),He!==null&&Xt!==null&&vN(Ee,Xt,He,nt,!0)}}e:{if(me=he?er(he):window,ve=me.nodeName&&me.nodeName.toLowerCase(),ve==="select"||ve==="input"&&me.type==="file")var kt=L1;else if(P1(me))if(V1)kt=Xk;else{kt=Qk;var Qe=Kk}else ve=me.nodeName,!ve||ve.toLowerCase()!=="input"||me.type!=="checkbox"&&me.type!=="radio"?he&&yc(he.elementType)&&(kt=L1):kt=Yk;if(kt&&(kt=kt(a,he))){M1(Ee,kt,c,Ne);break e}Qe&&Qe(a,me,he),a==="focusout"&&he&&me.type==="number"&&he.memoizedProps.value!=null&&Nu(me,"number",me.value)}switch(Qe=he?er(he):window,a){case"focusin":(P1(Qe)||Qe.contentEditable==="true")&&(Ec=Qe,Fp=he,Pu=null);break;case"focusout":Pu=Fp=Ec=null;break;case"mousedown":Bp=!0;break;case"contextmenu":case"mouseup":case"dragend":Bp=!1,G1(Ee,c,Ne);break;case"selectionchange":if(Zk)break;case"keydown":case"keyup":G1(Ee,c,Ne)}var gt;if(Ot)e:{switch(a){case"compositionstart":var Tt="onCompositionStart";break e;case"compositionend":Tt="onCompositionEnd";break e;case"compositionupdate":Tt="onCompositionUpdate";break e}Tt=void 0}else Sc?al(a,c)&&(Tt="onCompositionEnd"):a==="keydown"&&c.keyCode===229&&(Tt="onCompositionStart");Tt&&(ya&&c.locale!=="ko"&&(Sc||Tt!=="onCompositionStart"?Tt==="onCompositionEnd"&&Sc&&(gt=Iu()):(ga=Ne,Eu="value"in ga?ga.value:ga.textContent,Sc=!0)),Qe=ag(he,Tt),0<Qe.length&&(Tt=new ba(Tt,a,null,c,Ne),Ee.push({event:Tt,listeners:Qe}),gt?Tt.data=gt:(gt=Tc(c),gt!==null&&(Tt.data=gt)))),(gt=wr?qk(a,c):Hk(a,c))&&(Tt=ag(he,"onBeforeInput"),0<Tt.length&&(Qe=new ba("onBeforeInput","beforeinput",null,c,Ne),Ee.push({event:Qe,listeners:Tt}),Qe.data=gt)),MC(Ee,a,he,c,Ne)}bN(Ee,o)})}function ih(a,o,c){return{instance:a,listener:o,currentTarget:c}}function ag(a,o){for(var c=o+"Capture",u=[];a!==null;){var p=a,x=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||x===null||(p=qr(a,c),p!=null&&u.unshift(ih(a,p,x)),p=qr(a,o),p!=null&&u.push(ih(a,p,x))),a.tag===3)return u;a=a.return}return[]}function FC(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function vN(a,o,c,u,p){for(var x=o._reactName,_=[];c!==null&&c!==u;){var z=c,te=z.alternate,he=z.stateNode;if(z=z.tag,te!==null&&te===u)break;z!==5&&z!==26&&z!==27||he===null||(te=he,p?(he=qr(c,x),he!=null&&_.unshift(ih(c,he,te))):p||(he=qr(c,x),he!=null&&_.push(ih(c,he,te)))),c=c.return}_.length!==0&&a.push({event:o,listeners:_})}var BC=/\r\n?/g,zC=/\u0000|\uFFFD/g;function wN(a){return(typeof a=="string"?a:""+a).replace(BC,`
`).replace(zC,"")}function jN(a,o){return o=wN(o),wN(a)===o}function Yt(a,o,c,u,p,x){switch(c){case"children":typeof u=="string"?o==="body"||o==="textarea"&&u===""||Bn(a,u):(typeof u=="number"||typeof u=="bigint")&&o!=="body"&&Bn(a,""+u);break;case"className":tr(a,"class",u);break;case"tabIndex":tr(a,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":tr(a,c,u);break;case"style":Tu(a,u,x);break;case"data":if(o!=="object"){tr(a,"data",u);break}case"src":case"href":if(u===""&&(o!=="a"||c!=="href")){a.removeAttribute(c);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){a.removeAttribute(c);break}u=vc(""+u),a.setAttribute(c,u);break;case"action":case"formAction":if(typeof u=="function"){a.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(c==="formAction"?(o!=="input"&&Yt(a,o,"name",p.name,p,null),Yt(a,o,"formEncType",p.formEncType,p,null),Yt(a,o,"formMethod",p.formMethod,p,null),Yt(a,o,"formTarget",p.formTarget,p,null)):(Yt(a,o,"encType",p.encType,p,null),Yt(a,o,"method",p.method,p,null),Yt(a,o,"target",p.target,p,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){a.removeAttribute(c);break}u=vc(""+u),a.setAttribute(c,u);break;case"onClick":u!=null&&(a.onclick=$r);break;case"onScroll":u!=null&&vt("scroll",a);break;case"onScrollEnd":u!=null&&vt("scrollend",a);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(r(61));if(c=u.__html,c!=null){if(p.children!=null)throw Error(r(60));a.innerHTML=c}}break;case"multiple":a.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":a.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){a.removeAttribute("xlink:href");break}c=vc(""+u),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?a.setAttribute(c,""+u):a.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?a.setAttribute(c,""):a.removeAttribute(c);break;case"capture":case"download":u===!0?a.setAttribute(c,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?a.setAttribute(c,u):a.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?a.setAttribute(c,u):a.removeAttribute(c);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?a.removeAttribute(c):a.setAttribute(c,u);break;case"popover":vt("beforetoggle",a),vt("toggle",a),xc(a,"popover",u);break;case"xlinkActuate":Os(a,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Os(a,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Os(a,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Os(a,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Os(a,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Os(a,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Os(a,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Os(a,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Os(a,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":xc(a,"is",u);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=am.get(c)||c,xc(a,c,u))}}function hb(a,o,c,u,p,x){switch(c){case"style":Tu(a,u,x);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(r(61));if(c=u.__html,c!=null){if(p.children!=null)throw Error(r(60));a.innerHTML=c}}break;case"children":typeof u=="string"?Bn(a,u):(typeof u=="number"||typeof u=="bigint")&&Bn(a,""+u);break;case"onScroll":u!=null&&vt("scroll",a);break;case"onScrollEnd":u!=null&&vt("scrollend",a);break;case"onClick":u!=null&&(a.onclick=$r);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!bu.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(p=c.endsWith("Capture"),o=c.slice(2,p?c.length-7:void 0),x=a[Qs]||null,x=x!=null?x[c]:null,typeof x=="function"&&a.removeEventListener(o,x,p),typeof u=="function")){typeof x!="function"&&x!==null&&(c in a?a[c]=null:a.hasAttribute(c)&&a.removeAttribute(c)),a.addEventListener(o,u,p);break e}c in a?a[c]=u:u===!0?a.setAttribute(c,""):xc(a,c,u)}}}function cn(a,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":vt("error",a),vt("load",a);var u=!1,p=!1,x;for(x in c)if(c.hasOwnProperty(x)){var _=c[x];if(_!=null)switch(x){case"src":u=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Yt(a,o,x,_,c,null)}}p&&Yt(a,o,"srcSet",c.srcSet,c,null),u&&Yt(a,o,"src",c.src,c,null);return;case"input":vt("invalid",a);var z=x=_=p=null,te=null,he=null;for(u in c)if(c.hasOwnProperty(u)){var Ne=c[u];if(Ne!=null)switch(u){case"name":p=Ne;break;case"type":_=Ne;break;case"checked":te=Ne;break;case"defaultChecked":he=Ne;break;case"value":x=Ne;break;case"defaultValue":z=Ne;break;case"children":case"dangerouslySetInnerHTML":if(Ne!=null)throw Error(r(137,o));break;default:Yt(a,o,u,Ne,c,null)}}sm(a,x,z,te,he,_,p,!1);return;case"select":vt("invalid",a),u=_=x=null;for(p in c)if(c.hasOwnProperty(p)&&(z=c[p],z!=null))switch(p){case"value":x=z;break;case"defaultValue":_=z;break;case"multiple":u=z;default:Yt(a,o,p,z,c,null)}o=x,c=_,a.multiple=!!u,o!=null?Mi(a,!!u,o,!1):c!=null&&Mi(a,!!u,c,!0);return;case"textarea":vt("invalid",a),x=p=u=null;for(_ in c)if(c.hasOwnProperty(_)&&(z=c[_],z!=null))switch(_){case"value":u=z;break;case"defaultValue":p=z;break;case"children":x=z;break;case"dangerouslySetInnerHTML":if(z!=null)throw Error(r(91));break;default:Yt(a,o,_,z,c,null)}Li(a,u,p,x);return;case"option":for(te in c)if(c.hasOwnProperty(te)&&(u=c[te],u!=null))switch(te){case"selected":a.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Yt(a,o,te,u,c,null)}return;case"dialog":vt("beforetoggle",a),vt("toggle",a),vt("cancel",a),vt("close",a);break;case"iframe":case"object":vt("load",a);break;case"video":case"audio":for(u=0;u<ah.length;u++)vt(ah[u],a);break;case"image":vt("error",a),vt("load",a);break;case"details":vt("toggle",a);break;case"embed":case"source":case"link":vt("error",a),vt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(he in c)if(c.hasOwnProperty(he)&&(u=c[he],u!=null))switch(he){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Yt(a,o,he,u,c,null)}return;default:if(yc(o)){for(Ne in c)c.hasOwnProperty(Ne)&&(u=c[Ne],u!==void 0&&hb(a,o,Ne,u,c,void 0));return}}for(z in c)c.hasOwnProperty(z)&&(u=c[z],u!=null&&Yt(a,o,z,u,c,null))}function $C(a,o,c,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,x=null,_=null,z=null,te=null,he=null,Ne=null;for(ve in c){var Ee=c[ve];if(c.hasOwnProperty(ve)&&Ee!=null)switch(ve){case"checked":break;case"value":break;case"defaultValue":te=Ee;default:u.hasOwnProperty(ve)||Yt(a,o,ve,null,u,Ee)}}for(var me in u){var ve=u[me];if(Ee=c[me],u.hasOwnProperty(me)&&(ve!=null||Ee!=null))switch(me){case"type":x=ve;break;case"name":p=ve;break;case"checked":he=ve;break;case"defaultChecked":Ne=ve;break;case"value":_=ve;break;case"defaultValue":z=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(r(137,o));break;default:ve!==Ee&&Yt(a,o,me,ve,u,Ee)}}bc(a,_,z,te,he,Ne,x,p);return;case"select":ve=_=z=me=null;for(x in c)if(te=c[x],c.hasOwnProperty(x)&&te!=null)switch(x){case"value":break;case"multiple":ve=te;default:u.hasOwnProperty(x)||Yt(a,o,x,null,u,te)}for(p in u)if(x=u[p],te=c[p],u.hasOwnProperty(p)&&(x!=null||te!=null))switch(p){case"value":me=x;break;case"defaultValue":z=x;break;case"multiple":_=x;default:x!==te&&Yt(a,o,p,x,u,te)}o=z,c=_,u=ve,me!=null?Mi(a,!!c,me,!1):!!u!=!!c&&(o!=null?Mi(a,!!c,o,!0):Mi(a,!!c,c?[]:"",!1));return;case"textarea":ve=me=null;for(z in c)if(p=c[z],c.hasOwnProperty(z)&&p!=null&&!u.hasOwnProperty(z))switch(z){case"value":break;case"children":break;default:Yt(a,o,z,null,u,p)}for(_ in u)if(p=u[_],x=c[_],u.hasOwnProperty(_)&&(p!=null||x!=null))switch(_){case"value":me=p;break;case"defaultValue":ve=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(r(91));break;default:p!==x&&Yt(a,o,_,p,u,x)}nm(a,me,ve);return;case"option":for(var He in c)if(me=c[He],c.hasOwnProperty(He)&&me!=null&&!u.hasOwnProperty(He))switch(He){case"selected":a.selected=!1;break;default:Yt(a,o,He,null,u,me)}for(te in u)if(me=u[te],ve=c[te],u.hasOwnProperty(te)&&me!==ve&&(me!=null||ve!=null))switch(te){case"selected":a.selected=me&&typeof me!="function"&&typeof me!="symbol";break;default:Yt(a,o,te,me,u,ve)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var nt in c)me=c[nt],c.hasOwnProperty(nt)&&me!=null&&!u.hasOwnProperty(nt)&&Yt(a,o,nt,null,u,me);for(he in u)if(me=u[he],ve=c[he],u.hasOwnProperty(he)&&me!==ve&&(me!=null||ve!=null))switch(he){case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(r(137,o));break;default:Yt(a,o,he,me,u,ve)}return;default:if(yc(o)){for(var Xt in c)me=c[Xt],c.hasOwnProperty(Xt)&&me!==void 0&&!u.hasOwnProperty(Xt)&&hb(a,o,Xt,void 0,u,me);for(Ne in u)me=u[Ne],ve=c[Ne],!u.hasOwnProperty(Ne)||me===ve||me===void 0&&ve===void 0||hb(a,o,Ne,me,u,ve);return}}for(var ie in c)me=c[ie],c.hasOwnProperty(ie)&&me!=null&&!u.hasOwnProperty(ie)&&Yt(a,o,ie,null,u,me);for(Ee in u)me=u[Ee],ve=c[Ee],!u.hasOwnProperty(Ee)||me===ve||me==null&&ve==null||Yt(a,o,Ee,me,u,ve)}function NN(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function qC(){if(typeof performance.getEntriesByType=="function"){for(var a=0,o=0,c=performance.getEntriesByType("resource"),u=0;u<c.length;u++){var p=c[u],x=p.transferSize,_=p.initiatorType,z=p.duration;if(x&&z&&NN(_)){for(_=0,z=p.responseEnd,u+=1;u<c.length;u++){var te=c[u],he=te.startTime;if(he>z)break;var Ne=te.transferSize,Ee=te.initiatorType;Ne&&NN(Ee)&&(te=te.responseEnd,_+=Ne*(te<z?1:(z-he)/(te-he)))}if(--u,o+=8*(x+_)/(p.duration/1e3),a++,10<a)break}}if(0<a)return o/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var fb=null,mb=null;function ig(a){return a.nodeType===9?a:a.ownerDocument}function _N(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function TN(a,o){if(a===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&o==="foreignObject"?0:a}function gb(a,o){return a==="textarea"||a==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var pb=null;function HC(){var a=window.event;return a&&a.type==="popstate"?a===pb?!1:(pb=a,!0):(pb=null,!1)}var SN=typeof setTimeout=="function"?setTimeout:void 0,GC=typeof clearTimeout=="function"?clearTimeout:void 0,EN=typeof Promise=="function"?Promise:void 0,WC=typeof queueMicrotask=="function"?queueMicrotask:typeof EN<"u"?function(a){return EN.resolve(null).then(a).catch(KC)}:SN;function KC(a){setTimeout(function(){throw a})}function io(a){return a==="head"}function IN(a,o){var c=o,u=0;do{var p=c.nextSibling;if(a.removeChild(c),p&&p.nodeType===8)if(c=p.data,c==="/$"||c==="/&"){if(u===0){a.removeChild(p),ed(o);return}u--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")u++;else if(c==="html")oh(a.ownerDocument.documentElement);else if(c==="head"){c=a.ownerDocument.head,oh(c);for(var x=c.firstChild;x;){var _=x.nextSibling,z=x.nodeName;x[la]||z==="SCRIPT"||z==="STYLE"||z==="LINK"&&x.rel.toLowerCase()==="stylesheet"||c.removeChild(x),x=_}}else c==="body"&&oh(a.ownerDocument.body);c=p}while(c);ed(o)}function AN(a,o){var c=a;a=0;do{var u=c.nextSibling;if(c.nodeType===1?o?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(o?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),u&&u.nodeType===8)if(c=u.data,c==="/$"){if(a===0)break;a--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||a++;c=u}while(c)}function xb(a){var o=a.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":xb(c),pc(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}a.removeChild(c)}}function QC(a,o,c,u){for(;a.nodeType===1;){var p=c;if(a.nodeName.toLowerCase()!==o.toLowerCase()){if(!u&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(u){if(!a[la])switch(o){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(x=a.getAttribute("rel"),x==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(x!==p.rel||a.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||a.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||a.getAttribute("title")!==(p.title==null?null:p.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(x=a.getAttribute("src"),(x!==(p.src==null?null:p.src)||a.getAttribute("type")!==(p.type==null?null:p.type)||a.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&x&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(o==="input"&&a.type==="hidden"){var x=p.name==null?null:""+p.name;if(p.type==="hidden"&&a.getAttribute("name")===x)return a}else return a;if(a=Ir(a.nextSibling),a===null)break}return null}function YC(a,o,c){if(o==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=Ir(a.nextSibling),a===null))return null;return a}function kN(a,o){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!o||(a=Ir(a.nextSibling),a===null))return null;return a}function bb(a){return a.data==="$?"||a.data==="$~"}function yb(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function XC(a,o){var c=a.ownerDocument;if(a.data==="$~")a._reactRetry=o;else if(a.data!=="$?"||c.readyState!=="loading")o();else{var u=function(){o(),c.removeEventListener("DOMContentLoaded",u)};c.addEventListener("DOMContentLoaded",u),a._reactRetry=u}}function Ir(a){for(;a!=null;a=a.nextSibling){var o=a.nodeType;if(o===1||o===3)break;if(o===8){if(o=a.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return a}var vb=null;function CN(a){a=a.nextSibling;for(var o=0;a;){if(a.nodeType===8){var c=a.data;if(c==="/$"||c==="/&"){if(o===0)return Ir(a.nextSibling);o--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||o++}a=a.nextSibling}return null}function RN(a){a=a.previousSibling;for(var o=0;a;){if(a.nodeType===8){var c=a.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(o===0)return a;o--}else c!=="/$"&&c!=="/&"||o++}a=a.previousSibling}return null}function DN(a,o,c){switch(o=ig(c),a){case"html":if(a=o.documentElement,!a)throw Error(r(452));return a;case"head":if(a=o.head,!a)throw Error(r(453));return a;case"body":if(a=o.body,!a)throw Error(r(454));return a;default:throw Error(r(451))}}function oh(a){for(var o=a.attributes;o.length;)a.removeAttributeNode(o[0]);pc(a)}var Ar=new Map,ON=new Set;function og(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var ui=q.d;q.d={f:JC,r:ZC,D:e3,C:t3,L:s3,m:n3,X:a3,S:r3,M:i3};function JC(){var a=ui.f(),o=Jm();return a||o}function ZC(a){var o=br(a);o!==null&&o.tag===5&&o.type==="form"?X2(o):ui.r(a)}var Xc=typeof document>"u"?null:document;function PN(a,o,c){var u=Xc;if(u&&typeof o=="string"&&o){var p=Fn(o);p='link[rel="'+a+'"][href="'+p+'"]',typeof c=="string"&&(p+='[crossorigin="'+c+'"]'),ON.has(p)||(ON.add(p),a={rel:a,crossOrigin:c,href:o},u.querySelector(p)===null&&(o=u.createElement("link"),cn(o,"link",a),Ds(o),u.head.appendChild(o)))}}function e3(a){ui.D(a),PN("dns-prefetch",a,null)}function t3(a,o){ui.C(a,o),PN("preconnect",a,o)}function s3(a,o,c){ui.L(a,o,c);var u=Xc;if(u&&a&&o){var p='link[rel="preload"][as="'+Fn(o)+'"]';o==="image"&&c&&c.imageSrcSet?(p+='[imagesrcset="'+Fn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(p+='[imagesizes="'+Fn(c.imageSizes)+'"]')):p+='[href="'+Fn(a)+'"]';var x=p;switch(o){case"style":x=Jc(a);break;case"script":x=Zc(a)}Ar.has(x)||(a=y({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:a,as:o},c),Ar.set(x,a),u.querySelector(p)!==null||o==="style"&&u.querySelector(lh(x))||o==="script"&&u.querySelector(ch(x))||(o=u.createElement("link"),cn(o,"link",a),Ds(o),u.head.appendChild(o)))}}function n3(a,o){ui.m(a,o);var c=Xc;if(c&&a){var u=o&&typeof o.as=="string"?o.as:"script",p='link[rel="modulepreload"][as="'+Fn(u)+'"][href="'+Fn(a)+'"]',x=p;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Zc(a)}if(!Ar.has(x)&&(a=y({rel:"modulepreload",href:a},o),Ar.set(x,a),c.querySelector(p)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(ch(x)))return}u=c.createElement("link"),cn(u,"link",a),Ds(u),c.head.appendChild(u)}}}function r3(a,o,c){ui.S(a,o,c);var u=Xc;if(u&&a){var p=da(u).hoistableStyles,x=Jc(a);o=o||"default";var _=p.get(x);if(!_){var z={loading:0,preload:null};if(_=u.querySelector(lh(x)))z.loading=5;else{a=y({rel:"stylesheet",href:a,"data-precedence":o},c),(c=Ar.get(x))&&wb(a,c);var te=_=u.createElement("link");Ds(te),cn(te,"link",a),te._p=new Promise(function(he,Ne){te.onload=he,te.onerror=Ne}),te.addEventListener("load",function(){z.loading|=1}),te.addEventListener("error",function(){z.loading|=2}),z.loading|=4,lg(_,o,u)}_={type:"stylesheet",instance:_,count:1,state:z},p.set(x,_)}}}function a3(a,o){ui.X(a,o);var c=Xc;if(c&&a){var u=da(c).hoistableScripts,p=Zc(a),x=u.get(p);x||(x=c.querySelector(ch(p)),x||(a=y({src:a,async:!0},o),(o=Ar.get(p))&&jb(a,o),x=c.createElement("script"),Ds(x),cn(x,"link",a),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},u.set(p,x))}}function i3(a,o){ui.M(a,o);var c=Xc;if(c&&a){var u=da(c).hoistableScripts,p=Zc(a),x=u.get(p);x||(x=c.querySelector(ch(p)),x||(a=y({src:a,async:!0,type:"module"},o),(o=Ar.get(p))&&jb(a,o),x=c.createElement("script"),Ds(x),cn(x,"link",a),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},u.set(p,x))}}function MN(a,o,c,u){var p=(p=J.current)?og(p):null;if(!p)throw Error(r(446));switch(a){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=Jc(c.href),c=da(p).hoistableStyles,u=c.get(o),u||(u={type:"style",instance:null,count:0,state:null},c.set(o,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){a=Jc(c.href);var x=da(p).hoistableStyles,_=x.get(a);if(_||(p=p.ownerDocument||p,_={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(a,_),(x=p.querySelector(lh(a)))&&!x._p&&(_.instance=x,_.state.loading=5),Ar.has(a)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Ar.set(a,c),x||o3(p,a,c,_.state))),o&&u===null)throw Error(r(528,""));return _}if(o&&u!==null)throw Error(r(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Zc(c),c=da(p).hoistableScripts,u=c.get(o),u||(u={type:"script",instance:null,count:0,state:null},c.set(o,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,a))}}function Jc(a){return'href="'+Fn(a)+'"'}function lh(a){return'link[rel="stylesheet"]['+a+"]"}function LN(a){return y({},a,{"data-precedence":a.precedence,precedence:null})}function o3(a,o,c,u){a.querySelector('link[rel="preload"][as="style"]['+o+"]")?u.loading=1:(o=a.createElement("link"),u.preload=o,o.addEventListener("load",function(){return u.loading|=1}),o.addEventListener("error",function(){return u.loading|=2}),cn(o,"link",c),Ds(o),a.head.appendChild(o))}function Zc(a){return'[src="'+Fn(a)+'"]'}function ch(a){return"script[async]"+a}function VN(a,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var u=a.querySelector('style[data-href~="'+Fn(c.href)+'"]');if(u)return o.instance=u,Ds(u),u;var p=y({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return u=(a.ownerDocument||a).createElement("style"),Ds(u),cn(u,"style",p),lg(u,c.precedence,a),o.instance=u;case"stylesheet":p=Jc(c.href);var x=a.querySelector(lh(p));if(x)return o.state.loading|=4,o.instance=x,Ds(x),x;u=LN(c),(p=Ar.get(p))&&wb(u,p),x=(a.ownerDocument||a).createElement("link"),Ds(x);var _=x;return _._p=new Promise(function(z,te){_.onload=z,_.onerror=te}),cn(x,"link",u),o.state.loading|=4,lg(x,c.precedence,a),o.instance=x;case"script":return x=Zc(c.src),(p=a.querySelector(ch(x)))?(o.instance=p,Ds(p),p):(u=c,(p=Ar.get(x))&&(u=y({},c),jb(u,p)),a=a.ownerDocument||a,p=a.createElement("script"),Ds(p),cn(p,"link",u),a.head.appendChild(p),o.instance=p);case"void":return null;default:throw Error(r(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(u=o.instance,o.state.loading|=4,lg(u,c.precedence,a));return o.instance}function lg(a,o,c){for(var u=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=u.length?u[u.length-1]:null,x=p,_=0;_<u.length;_++){var z=u[_];if(z.dataset.precedence===o)x=z;else if(x!==p)break}x?x.parentNode.insertBefore(a,x.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(a,o.firstChild))}function wb(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.title==null&&(a.title=o.title)}function jb(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.integrity==null&&(a.integrity=o.integrity)}var cg=null;function UN(a,o,c){if(cg===null){var u=new Map,p=cg=new Map;p.set(c,u)}else p=cg,u=p.get(c),u||(u=new Map,p.set(c,u));if(u.has(a))return u;for(u.set(a,null),c=c.getElementsByTagName(a),p=0;p<c.length;p++){var x=c[p];if(!(x[la]||x[Rs]||a==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var _=x.getAttribute(o)||"";_=a+_;var z=u.get(_);z?z.push(x):u.set(_,[x])}}return u}function FN(a,o,c){a=a.ownerDocument||a,a.head.insertBefore(c,o==="title"?a.querySelector("head > title"):null)}function l3(a,o,c){if(c===1||o.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return a=o.disabled,typeof o.precedence=="string"&&a==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function BN(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function c3(a,o,c,u){if(c.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var p=Jc(u.href),x=o.querySelector(lh(p));if(x){o=x._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(a.count++,a=dg.bind(a),o.then(a,a)),c.state.loading|=4,c.instance=x,Ds(x);return}x=o.ownerDocument||o,u=LN(u),(p=Ar.get(p))&&wb(u,p),x=x.createElement("link"),Ds(x);var _=x;_._p=new Promise(function(z,te){_.onload=z,_.onerror=te}),cn(x,"link",u),c.instance=x}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(a.count++,c=dg.bind(a),o.addEventListener("load",c),o.addEventListener("error",c))}}var Nb=0;function d3(a,o){return a.stylesheets&&a.count===0&&hg(a,a.stylesheets),0<a.count||0<a.imgCount?function(c){var u=setTimeout(function(){if(a.stylesheets&&hg(a,a.stylesheets),a.unsuspend){var x=a.unsuspend;a.unsuspend=null,x()}},6e4+o);0<a.imgBytes&&Nb===0&&(Nb=62500*qC());var p=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&hg(a,a.stylesheets),a.unsuspend)){var x=a.unsuspend;a.unsuspend=null,x()}},(a.imgBytes>Nb?50:800)+o);return a.unsuspend=c,function(){a.unsuspend=null,clearTimeout(u),clearTimeout(p)}}:null}function dg(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)hg(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var ug=null;function hg(a,o){a.stylesheets=null,a.unsuspend!==null&&(a.count++,ug=new Map,o.forEach(u3,a),ug=null,dg.call(a))}function u3(a,o){if(!(o.state.loading&4)){var c=ug.get(a);if(c)var u=c.get(null);else{c=new Map,ug.set(a,c);for(var p=a.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<p.length;x++){var _=p[x];(_.nodeName==="LINK"||_.getAttribute("media")!=="not all")&&(c.set(_.dataset.precedence,_),u=_)}u&&c.set(null,u)}p=o.instance,_=p.getAttribute("data-precedence"),x=c.get(_)||u,x===u&&c.set(null,p),c.set(_,p),this.count++,u=dg.bind(this),p.addEventListener("load",u),p.addEventListener("error",u),x?x.parentNode.insertBefore(p,x.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(p,a.firstChild)),o.state.loading|=4}}var dh={$$typeof:B,Provider:null,Consumer:null,_currentValue:W,_currentValue2:W,_threadCount:0};function h3(a,o,c,u,p,x,_,z,te){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ia(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ia(0),this.hiddenUpdates=ia(null),this.identifierPrefix=u,this.onUncaughtError=p,this.onCaughtError=x,this.onRecoverableError=_,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=te,this.incompleteTransitions=new Map}function zN(a,o,c,u,p,x,_,z,te,he,Ne,Ee){return a=new h3(a,o,c,_,te,he,Ne,Ee,z),o=1,x===!0&&(o|=24),x=nr(3,null,null,o),a.current=x,x.stateNode=a,o=sx(),o.refCount++,a.pooledCache=o,o.refCount++,x.memoizedState={element:u,isDehydrated:c,cache:o},ix(x),a}function $N(a){return a?(a=kc,a):kc}function qN(a,o,c,u,p,x){p=$N(p),u.context===null?u.context=p:u.pendingContext=p,u=Qi(o),u.payload={element:c},x=x===void 0?null:x,x!==null&&(u.callback=x),c=Yi(a,u,o),c!==null&&(Gn(c,a,o),zu(c,a,o))}function HN(a,o){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var c=a.retryLane;a.retryLane=c!==0&&c<o?c:o}}function _b(a,o){HN(a,o),(a=a.alternate)&&HN(a,o)}function GN(a){if(a.tag===13||a.tag===31){var o=ll(a,67108864);o!==null&&Gn(o,a,67108864),_b(a,67108864)}}function WN(a){if(a.tag===13||a.tag===31){var o=lr();o=Yo(o);var c=ll(a,o);c!==null&&Gn(c,a,o),_b(a,o)}}var fg=!0;function f3(a,o,c,u){var p=k.T;k.T=null;var x=q.p;try{q.p=2,Tb(a,o,c,u)}finally{q.p=x,k.T=p}}function m3(a,o,c,u){var p=k.T;k.T=null;var x=q.p;try{q.p=8,Tb(a,o,c,u)}finally{q.p=x,k.T=p}}function Tb(a,o,c,u){if(fg){var p=Sb(u);if(p===null)ub(a,o,u,mg,c),QN(a,u);else if(p3(p,a,o,c,u))u.stopPropagation();else if(QN(a,u),o&4&&-1<g3.indexOf(a)){for(;p!==null;){var x=br(p);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var _=Cs(x.pendingLanes);if(_!==0){var z=x;for(z.pendingLanes|=2,z.entangledLanes|=2;_;){var te=1<<31-Le(_);z.entanglements[1]|=te,_&=~te}Na(x),(Pt&6)===0&&(Ym=tt()+500,rh(0))}}break;case 31:case 13:z=ll(x,2),z!==null&&Gn(z,x,2),Jm(),_b(x,2)}if(x=Sb(u),x===null&&ub(a,o,u,mg,c),x===p)break;p=x}p!==null&&u.stopPropagation()}else ub(a,o,u,null,c)}}function Sb(a){return a=yr(a),Eb(a)}var mg=null;function Eb(a){if(mg=null,a=ca(a),a!==null){var o=l(a);if(o===null)a=null;else{var c=o.tag;if(c===13){if(a=d(o),a!==null)return a;a=null}else if(c===31){if(a=h(o),a!==null)return a;a=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;a=null}else o!==a&&(a=null)}}return mg=a,null}function KN(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ie()){case $e:return 2;case bt:return 8;case Lt:case At:return 32;case os:return 268435456;default:return 32}default:return 32}}var Ib=!1,oo=null,lo=null,co=null,uh=new Map,hh=new Map,uo=[],g3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function QN(a,o){switch(a){case"focusin":case"focusout":oo=null;break;case"dragenter":case"dragleave":lo=null;break;case"mouseover":case"mouseout":co=null;break;case"pointerover":case"pointerout":uh.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":hh.delete(o.pointerId)}}function fh(a,o,c,u,p,x){return a===null||a.nativeEvent!==x?(a={blockedOn:o,domEventName:c,eventSystemFlags:u,nativeEvent:x,targetContainers:[p]},o!==null&&(o=br(o),o!==null&&GN(o)),a):(a.eventSystemFlags|=u,o=a.targetContainers,p!==null&&o.indexOf(p)===-1&&o.push(p),a)}function p3(a,o,c,u,p){switch(o){case"focusin":return oo=fh(oo,a,o,c,u,p),!0;case"dragenter":return lo=fh(lo,a,o,c,u,p),!0;case"mouseover":return co=fh(co,a,o,c,u,p),!0;case"pointerover":var x=p.pointerId;return uh.set(x,fh(uh.get(x)||null,a,o,c,u,p)),!0;case"gotpointercapture":return x=p.pointerId,hh.set(x,fh(hh.get(x)||null,a,o,c,u,p)),!0}return!1}function YN(a){var o=ca(a.target);if(o!==null){var c=l(o);if(c!==null){if(o=c.tag,o===13){if(o=d(c),o!==null){a.blockedOn=o,Br(a.priority,function(){WN(c)});return}}else if(o===31){if(o=h(c),o!==null){a.blockedOn=o,Br(a.priority,function(){WN(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}a.blockedOn=null}function gg(a){if(a.blockedOn!==null)return!1;for(var o=a.targetContainers;0<o.length;){var c=Sb(a.nativeEvent);if(c===null){c=a.nativeEvent;var u=new c.constructor(c.type,c);Su=u,c.target.dispatchEvent(u),Su=null}else return o=br(c),o!==null&&GN(o),a.blockedOn=c,!1;o.shift()}return!0}function XN(a,o,c){gg(a)&&c.delete(o)}function x3(){Ib=!1,oo!==null&&gg(oo)&&(oo=null),lo!==null&&gg(lo)&&(lo=null),co!==null&&gg(co)&&(co=null),uh.forEach(XN),hh.forEach(XN)}function pg(a,o){a.blockedOn===o&&(a.blockedOn=null,Ib||(Ib=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,x3)))}var xg=null;function JN(a){xg!==a&&(xg=a,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){xg===a&&(xg=null);for(var o=0;o<a.length;o+=3){var c=a[o],u=a[o+1],p=a[o+2];if(typeof u!="function"){if(Eb(u||c)===null)continue;break}var x=br(c);x!==null&&(a.splice(o,3),o-=3,Sx(x,{pending:!0,data:p,method:c.method,action:u},u,p))}}))}function ed(a){function o(te){return pg(te,a)}oo!==null&&pg(oo,a),lo!==null&&pg(lo,a),co!==null&&pg(co,a),uh.forEach(o),hh.forEach(o);for(var c=0;c<uo.length;c++){var u=uo[c];u.blockedOn===a&&(u.blockedOn=null)}for(;0<uo.length&&(c=uo[0],c.blockedOn===null);)YN(c),c.blockedOn===null&&uo.shift();if(c=(a.ownerDocument||a).$$reactFormReplay,c!=null)for(u=0;u<c.length;u+=3){var p=c[u],x=c[u+1],_=p[Qs]||null;if(typeof x=="function")_||JN(c);else if(_){var z=null;if(x&&x.hasAttribute("formAction")){if(p=x,_=x[Qs]||null)z=_.formAction;else if(Eb(p)!==null)continue}else z=_.action;typeof z=="function"?c[u+1]=z:(c.splice(u,3),u-=3),JN(c)}}}function ZN(){function a(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(_){return p=_})},focusReset:"manual",scroll:"manual"})}function o(){p!==null&&(p(),p=null),u||setTimeout(c,20)}function c(){if(!u&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,p=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(c,100),function(){u=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),p!==null&&(p(),p=null)}}}function Ab(a){this._internalRoot=a}bg.prototype.render=Ab.prototype.render=function(a){var o=this._internalRoot;if(o===null)throw Error(r(409));var c=o.current,u=lr();qN(c,u,a,o,null,null)},bg.prototype.unmount=Ab.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var o=a.containerInfo;qN(a.current,2,null,a,null,null),Jm(),o[oa]=null}};function bg(a){this._internalRoot=a}bg.prototype.unstable_scheduleHydration=function(a){if(a){var o=Jf();a={blockedOn:null,target:a,priority:o};for(var c=0;c<uo.length&&o!==0&&o<uo[c].priority;c++);uo.splice(c,0,a),c===0&&YN(a)}};var e_=e.version;if(e_!=="19.2.3")throw Error(r(527,e_,"19.2.3"));q.findDOMNode=function(a){var o=a._reactInternals;if(o===void 0)throw typeof a.render=="function"?Error(r(188)):(a=Object.keys(a).join(","),Error(r(268,a)));return a=m(o),a=a!==null?b(a):null,a=a===null?null:a.stateNode,a};var b3={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:k,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yg.isDisabled&&yg.supportsFiber)try{we=yg.inject(b3),De=yg}catch{}}return gh.createRoot=function(a,o){if(!i(a))throw Error(r(299));var c=!1,u="",p=oj,x=lj,_=cj;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(u=o.identifierPrefix),o.onUncaughtError!==void 0&&(p=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(_=o.onRecoverableError)),o=zN(a,1,!1,null,null,c,u,null,p,x,_,ZN),a[oa]=o.current,db(a),new Ab(o)},gh.hydrateRoot=function(a,o,c){if(!i(a))throw Error(r(299));var u=!1,p="",x=oj,_=lj,z=cj,te=null;return c!=null&&(c.unstable_strictMode===!0&&(u=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(_=c.onCaughtError),c.onRecoverableError!==void 0&&(z=c.onRecoverableError),c.formState!==void 0&&(te=c.formState)),o=zN(a,1,!0,o,c??null,u,p,te,x,_,z,ZN),o.context=$N(null),c=o.current,u=lr(),u=Yo(u),p=Qi(u),p.callback=null,Yi(c,p,u),c=u,o.current.lanes=c,Ko(o,c),Na(o),a[oa]=o.current,db(a),new bg(o)},gh.version="19.2.3",gh}var d_;function I3(){if(d_)return Rb.exports;d_=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Rb.exports=E3(),Rb.exports}var A3=I3(),ce=(s=>(s.WaitingMerchant=" ",s.Preparing=" ",s.Ready=" ",s.Pending=" ",s.InTransit=" ",s.Delivered=" ",s.Cancelled=" /",s))(ce||{});const k3=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("circle",{cx:"12",cy:"12",r:"10"}),n.jsx("path",{d:"m4.9 4.9 14.2 14.2"})]}),C3=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2"}),n.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),R3=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"}),n.jsx("circle",{cx:"7",cy:"17",r:"2"}),n.jsx("path",{d:"M9 17h6"}),n.jsx("circle",{cx:"17",cy:"17",r:"2"})]}),Ih=s=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:n.jsx("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"})}),Tn=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),n.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),rt=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),n.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Zd=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),n.jsx("circle",{cx:"9",cy:"7",r:"4"}),n.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),n.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),Xe=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),n.jsx("path",{d:"m9 11 3 3L22 4"})]}),xt=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("circle",{cx:"12",cy:"12",r:"10"}),n.jsx("path",{d:"M12 6v6l4 2"})]}),dt=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),n.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),vv=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3v1a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h14"}),n.jsx("path",{d:"M3 5v14"})]}),U0=s=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:n.jsx("path",{d:"m6 9 6 6 6-6"})}),jt=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M3 6h18"}),n.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),n.jsx("path",{d:"M10 11v6"}),n.jsx("path",{d:"M14 11v6"})]}),Sf=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}),n.jsx("path",{d:"m10 17 5-5-5-5"}),n.jsx("path",{d:"M15 12H3"})]}),wv=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),n.jsx("path",{d:"M9 22V12h6v10"})]}),eu=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),n.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]}),Ut=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11"}),n.jsx("path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2"}),n.jsx("circle",{cx:"7.5",cy:"18.5",r:"2.5"}),n.jsx("circle",{cx:"17.5",cy:"18.5",r:"2.5"})]}),F0=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}),n.jsx("path",{d:"m3.29 7 8.71 5 8.71-5"}),n.jsx("path",{d:"m12 22 8.71-5"}),n.jsx("path",{d:"M12 12v10"})]}),kr=s=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:n.jsx("path",{d:"m9 18 6-6-6-6"})}),zs=s=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:n.jsx("path",{d:"m15 18-6-6 6-6"})}),$s=s=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:n.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})}),Vl=s=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...s,children:n.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"})}),Jn=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"}),n.jsx("path",{d:"m15 5 4 4"})]}),Mr=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),n.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),n.jsx("path",{d:"M12 11h4"}),n.jsx("path",{d:"M12 16h4"}),n.jsx("path",{d:"M8 11h.01"}),n.jsx("path",{d:"M8 16h.01"})]}),D3=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),n.jsx("circle",{cx:"9",cy:"7",r:"4"}),n.jsx("line",{x1:"19",x2:"19",y1:"8",y2:"14"}),n.jsx("line",{x1:"22",x2:"16",y1:"11",y2:"11"})]}),iS=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("circle",{cx:"6",cy:"19",r:"3"}),n.jsx("path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"}),n.jsx("circle",{cx:"18",cy:"5",r:"3"})]}),O3=s=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:n.jsx("path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"})}),Dr=s=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:n.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),Ln=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("circle",{cx:"11",cy:"11",r:"8"}),n.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),bd=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M5 3v4"}),n.jsx("path",{d:"M19 17v4"}),n.jsx("path",{d:"M3 5h4"}),n.jsx("path",{d:"M17 19h4"}),n.jsx("path",{d:"M9 21a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2"}),n.jsx("path",{d:"M15 3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2"})]}),pn=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"}),n.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),Io=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7"}),n.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),n.jsx("path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4"}),n.jsx("path",{d:"M2 7h20"}),n.jsx("path",{d:"M12 7v5"})]}),Sy=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1Z"}),n.jsx("path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"}),n.jsx("path",{d:"M12 17.5v-11"})]}),u_=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),n.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),n.jsx("path",{d:"M12 11v6"}),n.jsx("path",{d:"M9 14h6"})]}),ef=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}),n.jsx("path",{d:"M21 3v5h-5"}),n.jsx("path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}),n.jsx("path",{d:"M3 21v-5h5"})]}),hn=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),n.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),P3=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M17.5 19c0-3.037-2.463-5.5-5.5-5.5S6.5 15.963 6.5 19"}),n.jsx("path",{d:"M20 16.95a6 6 0 0 0-5.34-9.98"}),n.jsx("path",{d:"M4 16.95A6 6 0 0 1 9.34 6.97"}),n.jsx("path",{d:"M12 3v1"})]}),gr=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),n.jsx("polyline",{points:"17 8 12 3 7 8"}),n.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),Ef=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),n.jsx("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),n.jsx("line",{x1:"6",y1:"20",x2:"6",y2:"14"})]}),Ba=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),n.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),n.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),n.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),Ao=s=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:n.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),M3=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("line",{x1:"2",y1:"2",x2:"22",y2:"22"}),n.jsx("path",{d:"M8.5 16.429a5 5 0 0 1 7 0"}),n.jsx("path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69"}),n.jsx("path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523"}),n.jsx("path",{d:"M2 8.82a15 15 0 0 1 4.17-2.692"}),n.jsx("path",{d:"M22 8.82a15 15 0 0 0-11.288-3.136"}),n.jsx("path",{d:"M12 20h.01"})]}),jv=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),n.jsx("path",{d:"M12 9v4"}),n.jsx("path",{d:"M12 17h.01"})]}),xn=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("circle",{cx:"8",cy:"21",r:"1"}),n.jsx("circle",{cx:"19",cy:"21",r:"1"}),n.jsx("path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"})]}),Lr=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"}),n.jsx("path",{d:"M7 2v20"}),n.jsx("path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"})]}),fr=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),n.jsx("circle",{cx:"9",cy:"9",r:"2"}),n.jsx("path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"})]}),Gs=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M5 12h14"}),n.jsx("path",{d:"M12 5v14"})]}),oS=s=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:n.jsx("path",{d:"M5 12h14"})}),bn=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("rect",{width:"7",height:"7",x:"3",y:"3",rx:"1"}),n.jsx("rect",{width:"7",height:"7",x:"14",y:"3",rx:"1"}),n.jsx("rect",{width:"7",height:"7",x:"14",y:"14",rx:"1"}),n.jsx("rect",{width:"7",height:"7",x:"3",y:"14",rx:"1"})]}),Jr=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),n.jsx("circle",{cx:"12",cy:"13",r:"4"})]}),na=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"}),n.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),wi=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24"}),n.jsx("path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"}),n.jsx("path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"}),n.jsx("line",{x1:"2",x2:"22",y1:"2",y2:"22"})]}),L3=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2"}),n.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]}),Ey=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("rect",{width:"20",height:"16",x:"2",y:"4",rx:"2"}),n.jsx("path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"})]}),a0=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),n.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),V3=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("polyline",{points:"9 11 12 14 22 4"}),n.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})]}),U3=s=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:n.jsx("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"})}),Xn=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7"}),n.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),n.jsx("path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4"})]}),pr=s=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:n.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})}),Nv=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("circle",{cx:"13.5",cy:"6.5",r:".5"}),n.jsx("circle",{cx:"17.5",cy:"10.5",r:".5"}),n.jsx("circle",{cx:"8.5",cy:"7.5",r:".5"}),n.jsx("circle",{cx:"6.5",cy:"12.5",r:".5"}),n.jsx("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"})]}),F3=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2"}),n.jsx("path",{d:"M12 18h.01"})]}),Ft=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"}),n.jsx("path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"}),n.jsx("path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"}),n.jsx("path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"})]}),tf=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"}),n.jsx("path",{d:"M13 5v2"}),n.jsx("path",{d:"M13 17v2"}),n.jsx("path",{d:"M13 11v2"})]}),Or=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}),n.jsx("path",{d:"m9 12 2 2 4-4"})]}),B0=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("circle",{cx:"8",cy:"8",r:"6"}),n.jsx("path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18"}),n.jsx("path",{d:"M7 6h1v4"}),n.jsx("path",{d:"m16.71 13.88.7 .71-2.82 2.82"})]}),lS=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),n.jsx("polyline",{points:"17 6 23 6 23 12"})]}),B3=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("polyline",{points:"23 18 13.5 8.5 8.5 13.5 1 6"}),n.jsx("polyline",{points:"17 18 23 18 23 12"})]}),Vr=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3"}),n.jsx("path",{d:"M14 19a6 6 0 0 0-9.33-5"})]}),cS=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),n.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),_v=s=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:n.jsx("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"})}),ra=s=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:n.jsx("path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14"})}),Si=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),n.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),z3=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),n.jsx("polyline",{points:"7 10 12 15 17 10"}),n.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),yd=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("polyline",{points:"9 17 4 12 9 7"}),n.jsx("path",{d:"M20 18v-2a4 4 0 0 0-4-4H4"})]}),h_=s=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:n.jsx("path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"})}),$3=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("circle",{cx:"12",cy:"12",r:"10"}),n.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),n.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),q3=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),n.jsx("polyline",{points:"12 5 19 12 12 19"})]}),H3=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2"}),n.jsx("rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2"}),n.jsx("line",{x1:"6",x2:"6.01",y1:"6",y2:"6"}),n.jsx("line",{x1:"6",x2:"6.01",y1:"18",y2:"18"})]}),G3=s=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:n.jsx("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})}),W3=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),n.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),n.jsx("polyline",{points:"7 3 7 8 15 8"})]}),Mb=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),n.jsx("path",{d:"M12 9v4"}),n.jsx("path",{d:"M12 17h.01"})]}),$l=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("line",{x1:"6",x2:"10",y1:"12",y2:"12"}),n.jsx("line",{x1:"8",x2:"8",y1:"10",y2:"14"}),n.jsx("line",{x1:"15",x2:"15.01",y1:"13",y2:"13"}),n.jsx("line",{x1:"18",x2:"18.01",y1:"11",y2:"11"}),n.jsx("rect",{width:"20",height:"12",x:"2",y:"6",rx:"2"})]}),K3=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),n.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),Q3=s=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),n.jsx("polyline",{points:"15 3 21 3 21 9"}),n.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]}),dS=({status:s})=>{const t=(()=>{switch(s){case ce.WaitingMerchant:return{style:"bg-purple-500/10 text-purple-400 border-purple-500/20 shadow-[0_0_10px_rgba(168,85,247,0.15)]",icon:n.jsx(xt,{className:"w-3.5 h-3.5"})};case ce.Preparing:return{style:"bg-orange-500/10 text-orange-400 border-orange-500/20 shadow-[0_0_10px_rgba(249,115,22,0.15)]",icon:n.jsx(Lr,{className:"w-3.5 h-3.5"})};case ce.Pending:return{style:"bg-yellow-500/10 text-yellow-400 border-yellow-500/20 shadow-[0_0_10px_rgba(234,179,8,0.15)]",icon:n.jsx(xn,{className:"w-3.5 h-3.5"})};case ce.InTransit:return{style:"bg-blue-500/10 text-blue-400 border-blue-500/20 shadow-[0_0_10px_rgba(59,130,246,0.15)]",icon:n.jsx(Ut,{className:"w-3.5 h-3.5"})};case ce.Delivered:return{style:"bg-teal-500/10 text-teal-400 border-teal-500/20 shadow-[0_0_10px_rgba(45,212,191,0.15)]",icon:n.jsx(Xe,{className:"w-3.5 h-3.5"})};case ce.Cancelled:return{style:"bg-red-500/10 text-red-400 border-red-500/20 shadow-[0_0_10px_rgba(239,68,68,0.15)]",icon:n.jsx(rt,{className:"w-3.5 h-3.5"})};default:return{style:"bg-gray-500/10 text-gray-400 border-gray-500/20",icon:n.jsx(xt,{className:"w-3.5 h-3.5"})}}})();return n.jsxs("span",{className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg border text-[10px] font-bold tracking-wide transition-all duration-300 backdrop-blur-sm ${t.style}`,children:[t.icon,s]})},Y3=({order:s,className:e="",showHash:t=!0})=>{const r=t?`#${s.id}`:s.id;return s.isArchived&&s.archiveMonth?n.jsxs("span",{className:e,children:[r,n.jsxs("span",{className:"text-[0.7em] opacity-70 ml-1",children:["(",s.archiveMonth,")"]})]}):n.jsx("span",{className:e,children:r})},X3=Is.memo(({order:s,users:e,onEdit:t,onDelete:r,onOpenStatusModal:i})=>{var N,E,I,T,L,$;const l=w.useMemo(()=>e.find(B=>B.id===s.driverId),[e,s.driverId]),d=w.useMemo(()=>e.find(B=>B.id===s.merchantId),[e,s.merchantId]),h=w.useMemo(()=>e.find(B=>{var Q;return B.phone===((Q=s.customer)==null?void 0:Q.phone)}),[e,(N=s.customer)==null?void 0:N.phone]),f=s.type==="shopping_order",m=B=>{try{if(!B)return null;let Q;return typeof B.toDate=="function"?Q=B.toDate():B.seconds?Q=new Date(B.seconds*1e3):Q=new Date(B),isNaN(Q.getTime())?null:Q}catch{return null}},b=w.useMemo(()=>{const B=m(s.createdAt);if(!B)return{date:"---",time:"---",day:"---"};const Q=B.toLocaleDateString("ar-EG-u-nu-latn",{weekday:"long"}),Z=B.toLocaleDateString("ar-EG-u-nu-latn",{day:"numeric",month:"numeric",year:"numeric"}),Y=B.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric",hour12:!0});return{day:Q,date:Z,time:Y}},[s.createdAt]),y=w.useMemo(()=>{if(s.status!==ce.Delivered||!s.deliveredAt)return null;const B=m(s.deliveredAt);return B?B.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric",hour12:!0}):null},[s.status,s.deliveredAt]),v=()=>{if(f)return"border-orange-500";switch(s.status){case ce.Delivered:return"border-teal-500";case ce.InTransit:return"border-blue-500";case ce.Cancelled:return"border-red-500";case ce.Pending:return"border-yellow-500";default:return"border-gray-500"}};return n.jsxs("div",{className:`relative bg-gray-800 rounded-xl shadow-lg border-r-4 ${v()} overflow-hidden admin-order-card transform-gpu will-change-transform`,children:[n.jsxs("div",{className:"p-4 border-b border-gray-700/50 flex justify-between items-start bg-gray-900/30",children:[n.jsxs("div",{className:"flex flex-col gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Y3,{order:s,className:"font-mono text-xl font-black text-red-500 tracking-tighter",showHash:!1}),f&&n.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 rounded text-[10px] font-bold bg-orange-500/20 text-orange-400 border border-orange-500/20",children:[n.jsx(Ft,{className:"w-3 h-3"})," "]})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-700/60 px-2 py-1 rounded border border-white/5 shadow-inner",children:[n.jsx(Ba,{className:"w-3.5 h-3.5 text-blue-400"}),n.jsxs("span",{className:"text-[11px] font-black text-white",children:[b.day," ",b.date]})]}),n.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-700/60 px-2 py-1 rounded border border-white/5 shadow-inner",children:[n.jsx(xt,{className:"w-3.5 h-3.5 text-yellow-400"}),n.jsx("span",{className:"text-[11px] font-black text-white font-mono",children:b.time})]}),y&&n.jsxs("div",{className:"flex items-center gap-1.5 bg-teal-500/10 px-2 py-1 rounded border border-teal-500/20 shadow-inner animate-fadeIn",children:[n.jsx(Xe,{className:"w-3.5 h-3.5 text-teal-400"}),n.jsxs("span",{className:"text-[11px] font-black text-teal-400 font-mono",children:[": ",y]})]})]})]}),n.jsx("div",{className:"flex flex-col items-end gap-1",children:n.jsx(dS,{status:s.status})})]}),n.jsxs("div",{className:"p-4 space-y-4",children:[n.jsxs("div",{className:"flex flex-col bg-gray-900/20 rounded-xl p-3 border border-white/5",children:[n.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[n.jsx("div",{className:"mt-1 p-1.5 rounded-full bg-blue-500/10 text-blue-400 flex-shrink-0",children:n.jsx(dt,{className:"w-4 h-4"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("p",{className:"text-[10px] text-gray-500 mb-0.5 flex items-center gap-1",children:[n.jsx(pn,{className:"w-3 h-3"}),"  "]}),n.jsx("p",{className:"text-white font-bold text-sm leading-snug break-words",children:((E=s.customer)==null?void 0:E.address)||"  "})]})]}),n.jsx("div",{className:"flex justify-end pt-2 border-t border-gray-700/30",children:n.jsxs("div",{className:"flex items-center gap-2",dir:"ltr",children:[((I=s.customer)==null?void 0:I.phone)&&n.jsx("a",{href:`https://wa.me/2${s.customer.phone}`,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 flex-shrink-0 bg-green-500/10 text-green-400 rounded-lg hover:bg-green-500/20 transition-all border border-green-500/10 clickable",title:"",children:n.jsx(Vl,{className:"w-3.5 h-3.5"})}),((T=s.customer)==null?void 0:T.phone)&&n.jsx("a",{href:`tel:${s.customer.phone}`,className:"p-1.5 flex-shrink-0 bg-blue-500/10 text-blue-400 rounded-lg hover:bg-blue-500/20 transition-all border border-blue-500/10 clickable",title:"",children:n.jsx($s,{className:"w-3.5 h-3.5"})}),n.jsx("span",{className:"text-xs text-gray-300 font-mono bg-black/20 px-2 py-1 rounded border border-gray-700 selectable font-bold tracking-wide",children:((L=s.customer)==null?void 0:L.phone)||""})]})})]}),n.jsxs("div",{className:"flex flex-col bg-orange-900/10 p-3 rounded-xl border border-orange-500/10",children:[n.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[n.jsx("div",{className:"mt-1 p-1.5 rounded-full bg-orange-500/10 text-orange-400 flex-shrink-0 overflow-hidden w-8 h-8 flex items-center justify-center border border-orange-500/20",children:s.merchantId==="delinow"?h!=null&&h.storeImage?n.jsx("img",{src:h.storeImage,alt:"Customer",className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-4 h-4"}):n.jsx(Xn,{className:"w-4 h-4"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-[10px] text-orange-400 font-bold mb-0.5",children:s.merchantId==="delinow"?" ":" ()"}),n.jsx("p",{className:"text-white font-black text-sm truncate",children:s.merchantId==="delinow"?(h==null?void 0:h.name)||(($=s.customer)==null?void 0:$.name)||"  ":(d==null?void 0:d.name)||s.merchantName||"   "})]})]}),n.jsx("div",{className:"mt-2 text-sm text-gray-300 border-t border-orange-500/10 pt-2 space-y-1",children:s.merchantId==="delinow"?n.jsxs("div",{className:"bg-gray-900/40 p-2 rounded-lg border border-gray-700/30",children:[n.jsx("p",{className:"text-[10px] text-gray-500 font-bold mb-1",children:"  :"}),n.jsx("p",{className:"text-white leading-relaxed whitespace-pre-wrap text-xs",children:s.notes||"  "})]}):n.jsxs("div",{className:"space-y-1.5",children:[s.notes&&n.jsxs("div",{className:"bg-gray-900/40 p-2 rounded-lg border border-gray-700/30 mb-2",children:[n.jsx("p",{className:"text-[10px] text-orange-400 font-bold mb-1",children:" :"}),n.jsx("p",{className:"text-white leading-relaxed whitespace-pre-wrap text-xs",children:s.notes})]}),s.items&&s.items.length>0?n.jsxs(n.Fragment,{children:[s.items.map((B,Q)=>n.jsxs("div",{className:"flex justify-between items-center text-xs bg-gray-900/40 p-1.5 rounded border border-gray-700/30",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"font-bold text-orange-400 font-mono",children:["x",B.quantity]}),n.jsx("span",{className:"text-white",children:B.name}),B.selectedSize&&n.jsxs("span",{className:"text-[9px] text-gray-500",children:["(",B.selectedSize.name,")"]})]}),n.jsxs("span",{className:"text-gray-400 font-mono font-bold",children:[(B.price*B.quantity).toLocaleString()," ."]})]},Q)),n.jsxs("div",{className:"flex justify-between items-center pt-1 mt-1 border-t border-gray-700/30 font-bold text-xs",children:[n.jsx("span",{className:"text-gray-400",children:":"}),n.jsxs("span",{className:"text-white",children:[s.items.reduce((B,Q)=>B+Q.price*Q.quantity,0).toLocaleString()," ."]})]})]}):null]})}),s.merchantId!=="delinow"&&((d==null?void 0:d.phone)||s.merchantId)&&n.jsx("div",{className:"flex justify-end pt-2 border-t border-orange-500/10 mt-1",children:n.jsxs("div",{className:"flex items-center gap-2",dir:"ltr",children:[(d==null?void 0:d.phone)&&n.jsx("a",{href:`https://wa.me/2${d.phone}`,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 flex-shrink-0 bg-green-500/10 text-green-400 rounded-lg hover:bg-green-500/20 transition-all border border-green-500/10 clickable",title:"",children:n.jsx(Vl,{className:"w-3.5 h-3.5"})}),(d==null?void 0:d.phone)&&n.jsx("a",{href:`tel:${d.phone}`,className:"p-1.5 flex-shrink-0 bg-blue-500/10 text-blue-400 rounded-lg hover:bg-blue-500/20 transition-all border border-blue-500/10 clickable",title:"",children:n.jsx($s,{className:"w-3.5 h-3.5"})}),n.jsx("span",{className:"text-xs text-gray-300 font-mono bg-black/20 px-2 py-1 rounded border border-gray-700 selectable font-bold tracking-wide",children:(d==null?void 0:d.phone)||s.merchantId})]})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-5 bg-gray-900/40 p-2 rounded-lg border border-gray-700/30",children:[n.jsx("div",{className:"flex flex-col justify-center pl-2",children:l?n.jsxs("div",{className:"flex flex-col gap-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-7 h-7 rounded-full bg-gray-700 border border-gray-600 flex items-center justify-center overflow-hidden flex-shrink-0",children:l.storeImage?n.jsx("img",{src:l.storeImage,alt:l.name,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-3.5 h-3.5 text-gray-400"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-[9px] text-gray-500 mb-0.5",children:""}),n.jsx("p",{className:"text-white text-xs font-bold truncate leading-tight",children:l.name})]})]}),l.phone&&n.jsxs("div",{className:"flex items-center gap-1.5 pt-1.5 mt-1 border-t border-gray-700/30 w-fit",dir:"ltr",children:[n.jsx("a",{href:`https://wa.me/2${l.phone}`,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 flex-shrink-0 bg-green-500/10 text-green-400 rounded-lg hover:bg-green-500/20 transition-all border border-green-500/10 clickable",title:"",children:n.jsx(Vl,{className:"w-3.5 h-3.5"})}),n.jsx("a",{href:`tel:${l.phone}`,className:"p-1.5 flex-shrink-0 bg-blue-500/10 text-blue-400 rounded-lg hover:bg-blue-500/20 transition-all border border-blue-500/10 clickable",title:"",children:n.jsx($s,{className:"w-3.5 h-3.5"})}),n.jsx("span",{className:"text-[10px] text-gray-300 font-mono bg-black/20 px-2 py-1 rounded border border-gray-700 selectable font-bold tracking-wide",children:l.phone})]})]}):n.jsxs("div",{className:"flex items-center gap-2 h-full",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 border border-gray-700 flex items-center justify-center flex-shrink-0",children:n.jsx(Ut,{className:"w-4 h-4 text-gray-500"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-[9px] text-gray-500 mb-0.5",children:""}),n.jsx("p",{className:"text-white text-xs font-bold truncate",children:" "})]})]})}),n.jsxs("div",{className:"flex items-center gap-2 border-r border-gray-700 pr-6 pl-1",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-amber-500/10 border border-amber-500/20 flex items-center justify-center flex-shrink-0",children:n.jsx(eu,{className:"w-4 h-4 text-amber-500"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-[9px] text-gray-500",children:" "}),n.jsx("p",{className:"text-amber-400 text-xs font-bold",children:s.deliveryFee?`${s.deliveryFee.toLocaleString("en-US")} .`:"-"})]})]})]})]}),n.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-900/80 border-t border-gray-700/50",children:[i?n.jsxs("button",{onClick:B=>{B.stopPropagation(),i(s)},className:"text-[10px] font-bold bg-gray-700 hover:bg-gray-600 text-white border border-gray-600 rounded-lg px-3 py-1.5 flex items-center transition-all clickable",children:[n.jsx(Jn,{className:"w-3.5 h-3.5 ml-1 text-gray-300"}),n.jsx("span",{children:" "})]}):n.jsx("div",{}),n.jsxs("div",{className:"flex items-center gap-1",children:[t&&n.jsx("button",{onClick:B=>{B.stopPropagation(),t(s)},className:"p-2 text-blue-400 hover:text-white hover:bg-blue-600 rounded-lg transition-colors border border-blue-500/20 bg-blue-500/10 clickable",children:n.jsx(Jn,{className:"w-4 h-4"})}),r&&n.jsx("button",{onClick:B=>{B.stopPropagation(),B.preventDefault(),r(s)},className:"p-2 text-red-400 hover:bg-red-600 hover:text-white rounded-lg transition-colors border border-red-500/20 bg-red-500/10 clickable",children:n.jsx(jt,{className:"w-4 h-4"})})]})]})]})}),J3=({order:s,merchants:e,drivers:t,onClose:r,onSave:i,currentUserRole:l})=>{const[d,h]=w.useState(s.customer||{phone:"",address:""}),[f,m]=w.useState(s.notes||""),[b,y]=w.useState(s.merchantId),[v,N]=w.useState(s.driverId||""),[E,I]=w.useState(s.deliveryFee!==void 0&&s.deliveryFee!==null?s.deliveryFee:""),[T,L]=w.useState(s.items||[]),[$,B]=w.useState(s.totalPrice||0),[Q,Z]=w.useState(""),Y=s.type==="shopping_order"&&T.length>0?"products":"details",[C,P]=w.useState(Y),U="w-full px-4 py-3 border border-gray-600 bg-[#111] text-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors text-sm";w.useEffect(()=>{if(T.length>0){const K=T.reduce((k,q)=>k+q.price*q.quantity,0);B(K)}else B(0)},[T]);const O=w.useMemo(()=>{const K=E===""?0:parseFloat(String(E)),k=isNaN(K)?0:K;return $+k},[$,E]),D=(K,k)=>{const q=parseFloat(k);if(isNaN(q))return;const W=[...T];W[K]={...W[K],price:q},L(W)},F=()=>{if(!d.phone||!d.address||!b){Z("    ."),(!d.phone||!d.address||!b)&&P("details");return}if(!/^\d{11}$/.test(d.phone)){Z("      11 ."),P("details");return}const K=E!==""?parseFloat(String(E)):null;if(l!=="admin"&&s.status===ce.Pending&&v&&(K==null||K<=0)){Z("     (  ).      ."),P("delivery");return}const k=e.find(ne=>ne.id===b),q=k?k.name:s.merchantName||"Unknown";Z("");const W={customer:d,notes:f,merchantId:b,merchantName:q,driverId:v||null,deliveryFee:K};s.type==="shopping_order"&&(W.items=T,W.totalPrice=$),i(W)},S=K=>{h({...d,[K.target.name]:K.target.value})},ae=(K,k,q,W=!0)=>{if(!W)return null;const ne=C===K;return n.jsxs("button",{onClick:()=>P(K),className:`flex-1 py-3 px-2 text-center text-xs font-bold transition-all border-b-2 flex items-center justify-center gap-2 ${ne?"border-blue-500 text-blue-400 bg-[#1f2937]":"border-transparent text-gray-500 hover:text-gray-300 hover:bg-[#1f2937]/50"}`,children:[q,k]})};return n.jsxs("div",{className:"fixed inset-0 z-[200] bg-[#111827] flex flex-col",children:[n.jsxs("div",{className:"flex-none bg-[#1f2937] border-b border-gray-700 flex items-center justify-between px-4 pt-8 pb-4 min-h-[90px] shadow-xl z-20",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{onClick:r,className:"bg-gray-800 p-2 rounded-full text-gray-400 hover:text-white transition-colors border border-gray-700",children:n.jsx(zs,{className:"w-5 h-5 rotate-180"})}),n.jsxs("div",{children:[n.jsxs("h3",{className:"text-base font-bold text-white flex items-center gap-2",children:[n.jsx(Jn,{className:"w-4 h-4 text-blue-400"})," "]}),n.jsxs("p",{className:"font-mono text-[10px] text-blue-300 opacity-80 tracking-wider",children:["#",s.id.slice(0,8)]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"hidden md:block text-right",children:[n.jsx("p",{className:"text-[10px] text-gray-400",children:""}),n.jsxs("p",{className:"text-sm font-bold text-green-400 font-mono",children:[O.toLocaleString()," ."]})]}),n.jsxs("button",{onClick:F,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-xl transition-all shadow-lg active:scale-95 text-sm flex items-center gap-2",children:[n.jsx(Xe,{className:"w-4 h-4"}),""]})]})]}),n.jsxs("div",{className:"flex-none bg-[#111] border-b border-gray-800 flex sticky top-0 z-10",children:[ae("details","",n.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"})),ae("products","",n.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500"}),s.type==="shopping_order"),ae("delivery","",n.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}))]}),n.jsx("div",{className:"flex-1 overflow-y-auto bg-[#111827] relative",children:n.jsxs("div",{className:"p-4 pb-12 space-y-4",children:[Q&&n.jsx("div",{className:"bg-red-900/20 p-3 rounded-xl border border-red-500/50 text-center animate-bounce mb-4",children:n.jsx("p",{className:"text-red-400 text-xs font-bold",children:Q})}),C==="details"&&n.jsx("div",{className:"space-y-4 animate-fadeIn",children:n.jsxs("div",{className:"bg-[#1f2937] p-4 rounded-2xl border border-gray-700",children:[n.jsx("h4",{className:"text-xs font-bold text-gray-400 mb-4 uppercase tracking-wider",children:"  "}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500 mb-1.5 font-bold",children:""}),n.jsxs("select",{value:b,onChange:K=>y(K.target.value),className:U,required:!0,children:[n.jsx("option",{value:"",disabled:!0,children:"--   --"}),e.map(K=>n.jsx("option",{value:K.id,children:K.name},K.id))]})]}),n.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500 mb-1.5 font-bold",children:" "}),n.jsx("input",{type:"tel",name:"phone",value:d.phone,onChange:S,className:`${U} font-mono text-center text-lg tracking-widest`,required:!0,dir:"ltr"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500 mb-1.5 font-bold",children:" "}),n.jsx("input",{type:"text",name:"address",value:d.address,onChange:S,className:U,required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-500 mb-1.5 font-bold",children:" "}),n.jsx("textarea",{value:f,onChange:K=>m(K.target.value),rows:3,className:`${U} resize-none`})]})]})]})}),C==="products"&&n.jsxs("div",{className:"space-y-3 animate-fadeIn",children:[n.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/20 p-3 rounded-xl flex justify-between items-center mb-2",children:[n.jsx("span",{className:"text-yellow-500 text-xs font-bold",children:"    "}),n.jsxs("span",{className:"text-white font-mono text-sm font-bold bg-yellow-500/20 px-2 py-1 rounded",children:[$.toLocaleString()," ."]})]}),T.map((K,k)=>n.jsxs("div",{className:"flex items-center gap-3 bg-[#1f2937] p-3 rounded-xl border border-gray-700 shadow-sm",children:[n.jsx("div",{className:"w-14 h-14 bg-[#111] rounded-lg overflow-hidden flex-shrink-0 border border-gray-600",children:K.image?n.jsx("img",{src:K.image,alt:K.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:n.jsx(fr,{className:"w-5 h-5"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-white text-sm font-bold truncate",children:K.name}),n.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[": ",n.jsx("span",{className:"text-blue-300 font-mono font-bold",children:K.quantity})]})]}),n.jsxs("div",{className:"w-24",children:[n.jsx("label",{className:"text-[9px] text-gray-500 block mb-1 text-center",children:""}),n.jsx("input",{type:"number",value:K.price,onChange:q=>D(k,q.target.value),className:"w-full bg-[#111] border border-gray-600 text-white text-sm rounded-lg py-2 text-center focus:border-yellow-500 focus:outline-none font-bold"})]})]},k))]}),C==="delivery"&&n.jsxs("div",{className:"space-y-4 animate-fadeIn",children:[n.jsxs("div",{className:"bg-[#1f2937] p-4 rounded-xl border border-gray-700",children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-2 font-bold uppercase",children:"  (EGP)"}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"tel",inputMode:"numeric",lang:"en",value:E,onChange:K=>{const k=K.target.value.replace(/[^0-9.]/g,"");I(k)},placeholder:"0",dir:"ltr",className:"w-full bg-[#111] border border-gray-600 text-white text-xl font-bold py-3 px-4 pl-12 rounded-xl focus:border-blue-500 focus:outline-none font-mono",style:{fontFamily:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'}}),n.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-bold text-xs",children:"EGP"})]})]}),n.jsxs("div",{className:"bg-[#1f2937] p-4 rounded-xl border border-gray-700 flex-1 flex flex-col",children:[n.jsxs("h4",{className:"text-xs font-bold text-gray-400 mb-3 uppercase tracking-wider flex justify-between items-center",children:[n.jsx("span",{children:" "}),n.jsxs("span",{className:"text-[10px] bg-gray-700 px-2 py-0.5 rounded-full text-white",children:[t.length," "]})]}),n.jsxs("div",{className:"space-y-2 max-h-[400px] overflow-y-auto custom-scrollbar",children:[n.jsxs("button",{onClick:()=>N(""),className:`w-full flex justify-between items-center text-right p-3 rounded-xl transition-all border ${v===""?"bg-red-500/10 border-red-500/50":"bg-[#111] border-gray-800 hover:border-gray-600"}`,children:[n.jsx("span",{className:`text-sm font-bold ${v===""?"text-red-400":"text-gray-400"}`,children:"  ()"}),v===""&&n.jsx(Xe,{className:"w-5 h-5 text-red-500"})]}),t.map(K=>n.jsxs("button",{onClick:()=>N(K.id),className:`w-full flex justify-between items-center text-right p-3 rounded-xl transition-all border ${v===K.id?"bg-blue-600 border-blue-500 shadow-lg scale-[1.01]":"bg-[#111] border-gray-800 hover:border-gray-500"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs ${v===K.id?"bg-white text-blue-600":"bg-gray-800 text-gray-400"}`,children:K.name.charAt(0)}),n.jsxs("div",{children:[n.jsx("span",{className:`font-bold text-sm block ${v===K.id?"text-white":"text-gray-200"}`,children:K.name}),n.jsx("span",{className:`text-[10px] font-mono ${v===K.id?"text-blue-100":"text-gray-500"}`,children:K.phone})]})]}),v===K.id&&n.jsx(Xe,{className:"w-5 h-5 text-white"})]},K.id))]})]})]})]})})]})};var z0=aS();const i0=s=>{try{const e=new Set;return JSON.stringify(s,(t,r)=>{if(typeof r=="object"&&r!==null){if(e.has(r))return"[Circular]";e.add(r)}return r})}catch{return"{}"}},wl=[],ys={isAndroid:()=>typeof window>"u"?!1:!!window.Android||navigator.userAgent.includes("GOO_NATIVE_APP"),subscribeBackHandler:s=>{const e=wl.indexOf(s);return e>-1&&wl.splice(e,1),wl.push(s),()=>{const t=wl.indexOf(s);t>-1&&wl.splice(t,1)}},handleBackPress:()=>{for(let s=wl.length-1;s>=0;s--){const e=wl[s];if(e&&typeof e=="function"&&e())return console.log(`[NativeBridge] Back press handled by listener at index ${s}`),!0}return console.log("[NativeBridge] Back press NOT handled by any listener. Default Android behavior."),!1},showNotification:(s,e)=>{var t;if(ys.isAndroid())try{(t=window.Android)==null||t.showAndroidNotification(s,e)}catch{}},playSound:()=>{var s,e;ys.isAndroid()&&((e=(s=window.Android)==null?void 0:s.playNotificationSound)==null||e.call(s))},reportContext:s=>{var e,t;ys.isAndroid()&&((t=(e=window.Android)==null?void 0:e.onContextChange)==null||t.call(e,s))},loginSuccess:s=>{var e,t;ys.isAndroid()&&(console.log("[NativeBridge] Reporting Login Success to Android"),(t=(e=window.Android)==null?void 0:e.onLoginSuccess)==null||t.call(e,i0(s)))},hideSplashScreen:()=>{console.log("NativeBridge: Requesting Splash Hide"),typeof window<"u"&&window.AndroidSplash&&(console.log("[NativeBridge] Hiding Native Splash Screen"),window.AndroidSplash.hideSplash())}};typeof window<"u"&&(window.handleAndroidBack=ys.handleBackPress,window.onBackPressed=ys.handleBackPress);const If=(s,e)=>{var t,r,i,l,d,h,f,m,b,y,v,N,E,I;if(ys.isAndroid()){console.log(`[NativeBridge] Configuring Role: ${s}, ID: ${e}`),(r=(t=window.Android)==null?void 0:t.setAppRole)==null||r.call(t,s);let T=s;if(s==="customer"&&(T="user"),["admin","drivers","merchants","users","driver","merchant","user","supervisor","supervisors","admin_v2","drivers_v2","merchants_v2","users_v2","supervisors_v2","all_users_v2"].forEach(Q=>{var Z;if((Z=window.Android)!=null&&Z.unsubscribeFromTopic)try{window.Android.unsubscribeFromTopic(Q)}catch{}}),T==="merchant"&&e){const Q=`driver_${e}`;(l=(i=window.Android)==null?void 0:i.unsubscribeFromTopic)==null||l.call(i,Q)}if(T==="driver"&&e){const Q=`merchant_${e}`;(h=(d=window.Android)==null?void 0:d.unsubscribeFromTopic)==null||h.call(d,Q)}const $=[];let B="";if(T==="admin"?B="admin_v2":B=T+"s_v2",B&&((m=(f=window.Android)==null?void 0:f.subscribeToTopic)==null||m.call(f,B),$.push(B)),e){const Q=`${T}_${e}_v2`;(y=(b=window.Android)==null?void 0:b.subscribeToTopic)==null||y.call(b,Q),(N=(v=window.Android)==null?void 0:v.setActiveNotificationChannel)==null||N.call(v,Q),$.push(Q)}(I=(E=window.Android)==null?void 0:E.subscribeToTopic)==null||I.call(E,"all_users_v2"),$.push("all_users_v2"),console.log(`[NativeBridge] Active Notification Channels: ${$.join(", ")}`)}},ud=(s,e)=>{var t,r;ys.isAndroid()&&(console.log(`[NativeBridge] Logging out from Android Native layer. ID: ${s}, Role: ${e}`),(r=(t=window.Android)==null?void 0:t.onLogout)==null||r.call(t,s,e))},Wt=(s,e=[])=>{const t=w.useRef(s);w.useEffect(()=>{t.current=s},[s]),w.useEffect(()=>{const r=()=>t.current(),i=ys.subscribeBackHandler(r);return()=>{i()}},e)},fs=({title:s,message:e,onClose:t,onConfirm:r,confirmButtonText:i="",cancelButtonText:l="",confirmVariant:d="primary"})=>{const[h,f]=w.useState(!1);w.useEffect(()=>{requestAnimationFrame(()=>f(!0))},[]),Wt(()=>(m(),!0));const m=()=>{f(!1),setTimeout(t,200)},b=()=>{f(!1),setTimeout(r,200)},y=()=>{switch(d){case"danger":return n.jsx(jt,{className:"w-8 h-8 text-red-500 animate-bounce"});case"success":return n.jsx(Xe,{className:"w-8 h-8 text-green-500 animate-pulse"});default:return n.jsx(jv,{className:"w-8 h-8 text-blue-500 animate-pulse"})}},v=()=>{switch(d){case"danger":return"bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 shadow-red-900/30";case"success":return"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-500 hover:to-green-600 shadow-green-900/30";default:return"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 shadow-blue-900/30"}};return z0.createPortal(n.jsx("div",{className:`fixed inset-0 z-[100] flex items-center justify-center p-4 transition-all duration-300 ease-out ${h?"backdrop-blur-[2px] bg-black/5":"opacity-0 pointer-events-none"}`,onClick:m,style:{touchAction:"none"},children:n.jsxs("div",{className:`
            w-full max-w-sm bg-[#1e293b] rounded-2xl border border-gray-700/50 shadow-2xl 
            transform transition-all duration-300 ease-[cubic-bezier(0.34,1.56,0.64,1)] relative overflow-hidden
            ${h?"scale-100 translate-y-0 opacity-100":"scale-90 translate-y-10 opacity-0"}
        `,onClick:N=>N.stopPropagation(),children:[n.jsx("div",{className:`absolute top-0 left-0 w-full h-1 bg-gradient-to-r ${d==="danger"?"from-red-500 via-orange-500 to-red-500":d==="success"?"from-green-500 via-emerald-500 to-green-500":"from-blue-500 via-cyan-500 to-blue-500"}`}),n.jsxs("div",{className:"p-6 text-center",children:[n.jsx("div",{className:"flex justify-center mb-4",children:n.jsx("div",{className:"p-4 rounded-full bg-[#0f172a] border border-gray-700 shadow-inner",children:y()})}),n.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:s}),n.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-6",children:e}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{type:"button",onClick:b,className:`flex-1 py-3 px-4 rounded-xl text-white font-bold text-sm shadow-lg transform transition-transform active:scale-95 ${v()}`,children:i}),n.jsx("button",{type:"button",onClick:m,className:"flex-1 py-3 px-4 rounded-xl bg-gray-700/50 hover:bg-gray-700 text-gray-300 font-bold text-sm border border-gray-600/50 transition-colors active:scale-95",children:l})]})]})]})}),document.body)},vg=Is.memo(({label:s,count:e,icon:t,isActive:r,onClick:i,colorClasses:l,disabled:d})=>n.jsxs("button",{onClick:d?void 0:i,className:`p-3 rounded-xl flex flex-col items-center justify-center text-center w-full transition-all duration-200 border-2 min-h-[90px] ${d?"opacity-40 cursor-not-allowed bg-gray-800 border-transparent grayscale":r?"border-red-500 bg-gray-700/50 shadow-lg scale-105 z-10":"border-transparent bg-gray-800 hover:bg-gray-700/70"}`,children:[n.jsx("div",{className:`p-2 rounded-full mb-1 ${l.split(" ")[0]}`,children:Is.cloneElement(t,{className:`w-5 h-5 ${l.split(" ")[1]}`})}),n.jsx("p",{className:"text-gray-400 text-[10px] font-bold mb-1 line-clamp-1",children:s}),e!==void 0&&n.jsx("p",{className:"text-white text-lg font-black leading-none",children:e})]})),$g=Is.memo(({orders:s,users:e,deleteOrder:t,editOrder:r,onNavigateToAdd:i,permissions:l,onOpenStatusModal:d,onBulkAssign:h,onBulkStatusUpdate:f,onBulkDelete:m,appName:b,currentUser:y,viewMode:v="default"})=>{const[N,E]=w.useState(null),[I,T]=w.useState(null),[L,$]=w.useState(""),[B,Q]=w.useState(1),[Z,Y]=w.useState("all"),[C,P]=w.useState("all");Is.useEffect(()=>{P(v==="shopping"?"merchant":v==="special"?"special":"all")},[v]);const[U,O]=w.useState(!1),[D,F]=w.useState(!1),[S,ae]=w.useState(!1),[K,k]=w.useState(null),[q,W]=w.useState(!1),[ne,M]=w.useState(""),[R,V]=w.useState(null),[X,H]=w.useState(null),[se,J]=w.useState(""),[oe,je]=w.useState(""),ye=!l||l.includes("manage_orders"),Pe=!l||l.includes("delete_orders");Wt(()=>q?(W(!1),!0):R?(V(null),!0):K?(k(null),!0):U?(O(!1),!0):D?(F(!1),!0):S?(ae(!1),!0):N?(E(null),!0):I?(T(null),!0):v==="default"&&C!=="all"?(P("all"),Y("all"),!0):Z!=="all"?(Y("all"),!0):B>1?(Q(B-1),!0):!1,[N,I,U,D,R,q,S,K,B,C,v,Z]);const Fe=w.useMemo(()=>{const Ie=s.filter($e=>C==="merchant"?$e.type==="shopping_order"&&$e.merchantId!=="delinow":C==="special"?$e.merchantId==="delinow":!0);return{all:Ie.length,[ce.Pending]:Ie.filter($e=>$e.status===ce.Pending).length,[ce.Ready]:Ie.filter($e=>$e.status===ce.Ready).length,[ce.InTransit]:Ie.filter($e=>$e.status===ce.InTransit).length,[ce.Delivered]:Ie.filter($e=>$e.status===ce.Delivered).length,[ce.Cancelled]:Ie.filter($e=>$e.status===ce.Cancelled).length,totalMerchantOrders:s.filter($e=>$e.type==="shopping_order"&&$e.merchantId!=="delinow").length,totalSpecialRequests:s.filter($e=>$e.merchantId==="delinow").length,pendingUnassigned:Ie.filter($e=>$e.status===ce.Pending&&!$e.driverId).length}},[s,C]),Re=w.useMemo(()=>[{value:"all",label:"",icon:n.jsx(Ut,{}),colorClasses:"bg-blue-500/20 text-blue-400"},{value:ce.Pending,label:" ",icon:n.jsx(xt,{}),colorClasses:"bg-yellow-500/20 text-yellow-400"},...v==="shopping"?[{value:ce.Ready,label:" ",icon:n.jsx(Xe,{}),colorClasses:"bg-teal-500/20 text-teal-400"}]:[],{value:ce.InTransit,label:" ",icon:n.jsx(iS,{}),colorClasses:"bg-sky-500/20 text-sky-400"},{value:ce.Delivered,label:" ",icon:n.jsx(Xe,{}),colorClasses:"bg-green-500/20 text-green-400"},{value:ce.Cancelled,label:"",icon:n.jsx(rt,{}),colorClasses:"bg-red-500/20 text-red-400"}],[v]),lt=()=>{if(!se||!oe)return;const Ie=parseFloat(oe);if((y==null?void 0:y.role)!=="admin"&&Ie<=0){H("       ( 0)"),setTimeout(()=>H(null),3e3);return}h==null||h(se,Ie),O(!1),J(""),je("")},We=Ie=>{switch(Ie){case ce.Pending:return{title:"   ",message:"         (   ).   "};case ce.Ready:return{title:"  ",message:"      .   "};case ce.InTransit:return{title:"   ",message:":      !     "};case ce.Delivered:return{title:"  ",message:"      .   "};case ce.Cancelled:return{title:"  ",message:"       ."};case"all":return{title:"   ",message:" :       !      .",variant:"danger"};default:return{title:"",message:""}}},it=Ie=>{switch(Ie){case ce.Pending:return{title:'    " "',message:'     (  )   " "   .   ',variant:"primary"};case ce.Ready:return{title:'   " "',message:'      " ".   ',variant:"primary"};case ce.Delivered:return{title:"  ",message:'     ( )   " "   .   ',variant:"success"};default:return{title:" ",message:"",variant:"primary"}}},ke=R?We(R):null,et=K?it(K):null,ge=50;Is.useEffect(()=>{Q(1)},[Z,C,L]),Is.useEffect(()=>{const Ie=document.querySelector("main");Ie?Ie.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},[B]);const ee=w.useMemo(()=>{let Ie=[...s];if(C==="merchant"?Ie=Ie.filter($e=>$e.type==="shopping_order"&&$e.merchantId!=="delinow"):C==="special"&&(Ie=Ie.filter($e=>$e.merchantId==="delinow")),Z!=="all"&&(Ie=Ie.filter($e=>$e.status===Z)),L){const $e=L.toLowerCase();Ie=Ie.filter(bt=>{var Lt,At;return bt.id&&bt.id.toString().includes($e)||((Lt=bt.customer)==null?void 0:Lt.phone)&&bt.customer.phone.includes($e)||((At=bt.customer)==null?void 0:At.address)&&bt.customer.address.toLowerCase().includes($e)||bt.notes&&bt.notes.toLowerCase().includes($e)})}return Ie.sort(($e,bt)=>{const Lt=parseInt($e.id.replace(/\D/g,"")||"0"),At=parseInt(bt.id.replace(/\D/g,"")||"0");if(Lt!==At)return At-Lt;const os=$e.createdAt?new Date($e.createdAt).getTime():0;return(bt.createdAt?new Date(bt.createdAt).getTime():0)-os}),Ie},[s,C,Z,L]),fe=w.useMemo(()=>e.filter(Ie=>Ie.role==="merchant"),[e]),_e=w.useMemo(()=>e.filter(Ie=>Ie.role==="driver"),[e]),Me=w.useMemo(()=>{if(!ne)return _e;const Ie=ne.toLowerCase();return _e.filter($e=>$e.name.toLowerCase().includes(Ie)||$e.phone&&$e.phone.includes(Ie))},[_e,ne]),st=w.useMemo(()=>_e.find(Ie=>Ie.id===se),[_e,se]),tt=w.useMemo(()=>{const Ie=B*ge,$e=Ie-ge;return ee.slice($e,Ie)},[ee,B,ge]);return n.jsxs("div",{className:"space-y-6 pb-32",children:[n.jsxs("div",{className:"grid grid-cols-4 lg:grid-cols-8 gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[Re.map(Ie=>n.jsx(vg,{label:Ie.label,count:Fe[Ie.value],icon:Ie.icon,isActive:Z===Ie.value,onClick:()=>{Y(Ie.value)},colorClasses:Ie.colorClasses},Ie.value)),ye&&n.jsxs(n.Fragment,{children:[n.jsx(vg,{label:`  (${Fe.pendingUnassigned})`,icon:n.jsx(Gs,{}),isActive:U,onClick:()=>{Fe.pendingUnassigned===0?(H("      "),setTimeout(()=>H(null),3e3)):O(!0)},colorClasses:"bg-indigo-500/20 text-indigo-400 border-indigo-500/30"}),n.jsx(vg,{label:"  ",icon:n.jsx(ef,{}),isActive:S,onClick:()=>ae(!0),colorClasses:"bg-emerald-500/20 text-emerald-400 border-emerald-500/30"})]}),Pe&&n.jsx(vg,{label:" ",icon:n.jsx(jt,{}),isActive:D,onClick:()=>F(!0),colorClasses:"bg-red-500/20 text-red-400 border-red-500/30"})]}),X&&n.jsx("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-lg shadow-xl border border-gray-700 z-50 animate-fadeIn",children:X}),n.jsxs("div",{className:"bg-gray-800 p-4 rounded-xl shadow-sm flex flex-col md:flex-row gap-4 items-center border border-gray-700",children:[n.jsxs("div",{className:"relative flex-1 w-full",children:[n.jsx(Ln,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 w-5 h-5"}),n.jsx("input",{type:"text",placeholder:"     ...",value:L,onChange:Ie=>$(Ie.target.value),className:"w-full px-4 py-2 pr-10 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-1 focus:ring-red-500 outline-none"})]}),ye&&i&&n.jsxs("button",{onClick:i,className:"w-full md:w-auto flex justify-center items-center bg-red-600 text-white font-black px-6 py-2.5 rounded-lg shadow-lg hover:bg-red-700 transition-all active:scale-95",children:[n.jsx(Gs,{className:"w-5 h-5 ml-2"}),n.jsx("span",{children:" "})]})]}),C!=="all"&&n.jsxs("div",{className:"flex items-center gap-2 px-2",children:[n.jsx("span",{className:`w-2 h-6 rounded-full ${C==="merchant"?"bg-orange-500":"bg-purple-500"}`}),n.jsx("h3",{className:"text-xl font-bold text-white",children:C==="merchant"?"  ":"  "})]}),n.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:tt.length>0?tt.map(Ie=>n.jsx(X3,{order:Ie,users:e,onEdit:ye?E:void 0,onDelete:Pe?T:void 0,onOpenStatusModal:d},Ie.id)):n.jsxs("div",{className:"col-span-full py-20 text-center flex flex-col items-center justify-center bg-gray-800/30 rounded-3xl border border-dashed border-gray-700",children:[n.jsx(Ut,{className:"w-16 h-16 text-gray-700 mb-4 opacity-20"}),n.jsx("p",{className:"text-gray-500 font-bold",children:"   "})]})}),ee.length>ge&&n.jsxs("div",{className:"flex justify-center items-center gap-4 mt-8 pt-4 border-t border-gray-700",children:[n.jsx("button",{onClick:()=>Q(Ie=>Math.max(1,Ie-1)),disabled:B===1,className:"px-4 py-2 bg-gray-800 text-white rounded-lg disabled:opacity-50 hover:bg-gray-700 transition",children:""}),n.jsxs("span",{className:"text-gray-400 font-mono",children:[" ",B,"  ",Math.ceil(ee.length/ge)]}),n.jsx("button",{onClick:()=>Q(Ie=>Math.min(Math.ceil(ee.length/ge),Ie+1)),disabled:B===Math.ceil(ee.length/ge),className:"px-4 py-2 bg-gray-800 text-white rounded-lg disabled:opacity-50 hover:bg-gray-700 transition",children:""})]}),N&&n.jsx(J3,{order:N,merchants:fe,drivers:_e,onClose:()=>E(null),onSave:Ie=>{const $e=N;let bt=$e.status;Ie.driverId&&Ie.deliveryFee!==null&&Ie.deliveryFee!==void 0?$e.status===ce.Pending&&(bt=ce.InTransit):Ie.driverId||$e.status===ce.InTransit&&(bt=ce.Pending);const Lt={...Ie};bt!==$e.status&&(Lt.status=bt),r(N.id,Lt),E(null)},currentUserRole:y==null?void 0:y.role}),I&&n.jsx(fs,{title:" ",message:`       ${I.id} `,onClose:()=>T(null),onConfirm:()=>{t(I.id),T(null)},confirmButtonText:" ",confirmVariant:"danger"}),U&&n.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>O(!1),children:n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-2xl border border-gray-700 shadow-2xl p-6 animate-pop-in",onClick:Ie=>Ie.stopPropagation(),children:[n.jsxs("div",{className:"flex justify-between items-center mb-6",children:[n.jsxs("h3",{className:"text-xl font-black text-white flex items-center gap-2",children:[n.jsx(Ut,{className:"w-6 h-6 text-indigo-400"}),"  "]}),n.jsx("button",{onClick:()=>O(!1),className:"text-gray-500 hover:text-white",children:n.jsx(rt,{className:"w-6 h-6"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("p",{className:"text-sm text-gray-400",children:["  ",n.jsx("span",{className:"text-yellow-500 font-bold",children:Fe.pendingUnassigned}),"  ( )  ."]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-2",children:" "}),n.jsxs("button",{onClick:()=>W(!0),className:"w-full bg-[#0f172a] border border-gray-700 rounded-xl p-4 flex justify-between items-center text-white hover:border-gray-500 transition-colors",children:[st?n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border border-gray-600",children:st.storeImage?n.jsx("img",{src:st.storeImage,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-4 h-4 text-gray-400"})}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-bold text-sm",children:st.name}),n.jsx("p",{className:"text-xs text-gray-500 font-mono",children:st.phone})]})]}):n.jsx("span",{className:"text-gray-400 text-sm",children:" ..."}),n.jsx(U0,{className:"w-5 h-5 text-gray-500"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-2",children:"  "}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"number",placeholder:"0",value:oe,onChange:Ie=>je(Ie.target.value),className:"w-full bg-[#0f172a] border border-gray-700 rounded-xl py-3 pl-10 pr-4 text-white font-bold outline-none focus:border-indigo-500"}),n.jsx("span",{className:"absolute left-3 top-3.5 text-gray-500 text-xs font-bold",children:"."})]})]}),n.jsx("button",{onClick:lt,disabled:!se||!oe,className:"w-full bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-700 disabled:text-gray-500 text-white font-bold py-3.5 rounded-xl shadow-lg transition-all active:scale-95 mt-2",children:" "})]})]})}),q&&n.jsx("div",{className:"fixed inset-0 z-[110] bg-black/90 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>W(!1),children:n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-gray-700 shadow-2xl overflow-hidden flex flex-col max-h-[60vh]",onClick:Ie=>Ie.stopPropagation(),children:[n.jsx("div",{className:"p-4 border-b border-gray-700",children:n.jsxs("div",{className:"relative",children:[n.jsx(Ln,{className:"absolute right-3 top-3 w-4 h-4 text-gray-500"}),n.jsx("input",{type:"text",placeholder:"  ...",value:ne,onChange:Ie=>M(Ie.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-2.5 pr-9 pl-3 text-white text-sm outline-none focus:border-blue-500",autoFocus:!0})]})}),n.jsx("div",{className:"flex-1 overflow-y-auto p-2 custom-scrollbar",children:Me.length>0?Me.map(Ie=>n.jsxs("button",{onClick:()=>{J(Ie.id),W(!1)},className:`w-full flex items-center gap-3 p-3 rounded-xl transition-colors ${se===Ie.id?"bg-blue-900/20 border border-blue-500/30":"hover:bg-gray-800 border border-transparent"}`,children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden flex-shrink-0",children:Ie.storeImage?n.jsx("img",{src:Ie.storeImage,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-5 h-5 text-gray-400"})}),n.jsxs("div",{className:"text-right flex-1",children:[n.jsx("p",{className:`font-bold text-sm ${se===Ie.id?"text-blue-400":"text-white"}`,children:Ie.name}),n.jsx("p",{className:"text-xs text-gray-500 font-mono",children:Ie.phone})]}),se===Ie.id&&n.jsx(Xe,{className:"w-5 h-5 text-blue-500"})]},Ie.id)):n.jsx("p",{className:"text-center text-gray-500 py-4 text-xs",children:"  "})})]})}),S&&n.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>ae(!1),children:n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-gray-700 shadow-2xl p-6 animate-pop-in text-center",onClick:Ie=>Ie.stopPropagation(),children:[n.jsx("div",{className:"w-16 h-16 bg-emerald-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-emerald-500/20",children:n.jsx(ef,{className:"w-8 h-8 text-emerald-500"})}),n.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),n.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"       ."}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("button",{onClick:()=>{ae(!1),k(ce.Pending)},className:"w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-xl py-3 text-sm font-bold text-yellow-400 transition-colors flex items-center justify-center gap-2",children:[n.jsx(xt,{className:"w-4 h-4"}),"  "]}),n.jsxs("button",{onClick:()=>{ae(!1),k(ce.Delivered)},className:"w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-xl py-3 text-sm font-bold text-green-400 transition-colors flex items-center justify-center gap-2",children:[n.jsx(Xe,{className:"w-4 h-4"}),'  " "']})]}),n.jsx("button",{onClick:()=>ae(!1),className:"mt-4 text-gray-500 text-xs hover:text-white transition-colors",children:""})]})}),D&&n.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>F(!1),children:n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-gray-700 shadow-2xl p-6 animate-pop-in text-center",onClick:Ie=>Ie.stopPropagation(),children:[n.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-red-500/20",children:n.jsx(jt,{className:"w-8 h-8 text-red-500"})}),n.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),n.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"       ."}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("button",{onClick:()=>{F(!1),V(ce.Pending)},className:"w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-xl py-3 text-sm font-bold text-yellow-400 transition-colors",children:["    (",Fe[ce.Pending],")"]}),n.jsxs("button",{onClick:()=>{F(!1),V(ce.Cancelled)},className:"w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-xl py-3 text-sm font-bold text-red-400 transition-colors",children:["    (",Fe[ce.Cancelled],")"]}),n.jsxs("button",{onClick:()=>{F(!1),V(ce.Delivered)},className:"w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-xl py-3 text-sm font-bold text-green-400 transition-colors",children:["    (",Fe[ce.Delivered],")"]}),n.jsx("div",{className:"h-px bg-gray-700 my-2"}),n.jsx("button",{onClick:()=>{F(!1),V("all")},className:"w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 rounded-xl shadow-lg transition-colors",children:"   "})]})]})}),K&&et&&n.jsx(fs,{title:et.title,message:et.message,onClose:()=>k(null),onConfirm:()=>{f==null||f(K),k(null)},confirmButtonText:" ",confirmVariant:et.variant}),R&&ke&&n.jsx(fs,{title:ke.title,message:ke.message,onClose:()=>V(null),onConfirm:()=>{m==null||m(R),V(null)},confirmButtonText:"  ",confirmVariant:ke.variant||"danger"})]})}),Z3=[{id:"restaurant",label:""},{id:"market",label:" "},{id:"pharmacy",label:""},{id:"bakery",label:"/"},{id:"electronics",label:""},{id:"fashion",label:""},{id:"logistics",label:" "},{id:"other",label:""}],eR=({onClose:s,onSave:e,initialRole:t,appName:r,currentUserRole:i,currentUserPermissions:l})=>{const[d,h]=w.useState(""),[f,m]=w.useState(""),[b,y]=w.useState(""),[v,N]=w.useState(""),[E,I]=w.useState(""),[T,L]=w.useState(t),[$,B]=w.useState(25),[Q,Z]=w.useState("percentage"),[Y,C]=w.useState("always_open"),[P,U]=w.useState(!0),[O,D]=w.useState(1),[F,S]=w.useState("restaurant"),[ae,K]=w.useState(!1),[k,q]=w.useState(!0),[W,ne]=w.useState([]),[M,R]=w.useState(""),[V,X]=w.useState(!1),[H,se]=w.useState(null),[J,oe]=w.useState(!1),je=w.useRef(null),ye=r||"GOO NOW";Wt(()=>(s(),!0),[s]);const Pe="w-full px-4 py-3 bg-[#252525] border border-[#333] text-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors",Fe=[{id:"view_orders",label:" "},{id:"manage_orders",label:" "},{id:"view_reports",label:" "},{id:"view_users",label:" "},{id:"manage_users",label:" "},{id:"view_wallet",label:" "},{id:"manage_supervisors",label:" "}],Re=ke=>{ne(et=>et.includes(ke)?et.filter(ge=>ge!==ke):[...et,ke])},lt=ke=>{var ge;const et=(ge=ke.target.files)==null?void 0:ge[0];if(et){oe(!0);const ee=new FileReader;ee.onloadend=()=>{const fe=new Image;fe.src=ee.result,fe.onload=()=>{const _e=document.createElement("canvas"),Me=1024,st=Me/fe.width;_e.width=Me,_e.height=fe.height*st;const tt=_e.getContext("2d");tt&&(tt.imageSmoothingEnabled=!0,tt.imageSmoothingQuality="high",tt.drawImage(fe,0,0,_e.width,_e.height),setTimeout(()=>{se(_e.toDataURL("image/jpeg",.9)),oe(!1)},800))}},ee.readAsDataURL(et)}},We=async()=>{if(!d||!f||!v||!T){R("    .");return}if(!/^\d{11}$/.test(f)){R("      11 .");return}if(v.length<6){R("     6     .");return}if(v!==E){R("   .");return}R("");const ke={name:d,phone:f,password:v,role:T,storeImage:H||void 0,address:T!=="driver"&&b?b:void 0};T==="driver"&&(ke.commissionRate=$,ke.commissionType=Q,ke.dailyLogMode=Y,ke.maxConcurrentOrders=P?void 0:O),T==="merchant"&&(ke.storeCategory=F,ke.canShowDeliveryTime=ae,ke.canManageMenu=k),T==="supervisor"&&(ke.permissions=W),X(!0);try{await e(ke),s()}catch{X(!1)}},it=w.useMemo(()=>{const ke=[{id:"driver",label:""},{id:"merchant",label:""},{id:"customer",label:""},{id:"supervisor",label:""},{id:"admin",label:""}];if(i==="supervisor"){const et=l==null?void 0:l.includes("manage_supervisors");return ke.filter(ge=>ge.id!=="admin"&&(et||ge.id!=="supervisor"))}return ke},[i,l]);return n.jsxs("div",{className:"fixed inset-0 bg-[#111] z-[60] overflow-y-auto animate-fadeIn flex flex-col",children:[n.jsxs("div",{className:"flex-none bg-[#1a1a1a] border-b border-[#333] px-4 pt-safe h-16 box-content flex items-center justify-between sticky top-0 z-20 shadow-lg",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{onClick:s,className:"bg-[#252525] p-2 rounded-full text-gray-400 hover:text-white transition-colors",children:n.jsx(zs,{className:"w-6 h-6 rotate-180"})}),n.jsx("h2",{className:"text-xl font-bold text-white",children:"  "})]}),n.jsx("button",{onClick:We,disabled:V,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-lg transition-colors shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:V?" ...":""})]}),n.jsxs("div",{className:"flex-1 max-w-4xl mx-auto w-full p-4 sm:p-8 space-y-8 pb-20",children:[n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsxs("div",{onClick:()=>{var ke;return!J&&((ke=je.current)==null?void 0:ke.click())},className:"relative cursor-pointer border-2 border-dashed border-gray-600 hover:border-red-500 transition-colors bg-[#252525] w-32 h-32 rounded-full flex items-center justify-center overflow-hidden group shadow-xl",children:[J&&n.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 z-50 backdrop-blur-sm",children:n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full opacity-75 animate-ping absolute top-0 left-0"}),n.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center relative z-10 shadow-lg shadow-blue-500/50",children:n.jsx(gr,{className:"w-6 h-6 text-white animate-bounce"})}),n.jsx("div",{className:"w-20 h-20 border-4 border-blue-400/30 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"})]})}),H?n.jsx("img",{src:H,alt:"Profile",className:"w-full h-full object-cover"}):n.jsxs("div",{className:"flex flex-col items-center text-gray-400",children:[n.jsx(Jr,{className:"w-10 h-10 mb-1"}),n.jsx("span",{className:"text-xs",children:""})]}),n.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsx(gr,{className:"w-8 h-8 text-white"})})]}),n.jsx("p",{className:"text-gray-500 text-xs mt-2",children:"     "}),n.jsx("input",{ref:je,type:"file",accept:"image/*",className:"hidden",onChange:lt})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm h-fit",children:[n.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[n.jsx("span",{className:"w-1 h-5 bg-red-500 rounded-full"})," "]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" (Role)"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:it.map(ke=>n.jsx("button",{type:"button",onClick:()=>L(ke.id),className:`px-4 py-2 text-sm font-bold rounded-xl border transition-all ${T===ke.id?"bg-red-600 border-red-600 text-white shadow-lg shadow-red-900/20":"bg-transparent border-gray-600 text-gray-400 hover:border-gray-400"}`,children:ke.label},ke.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),n.jsx("input",{type:"text",value:d,onChange:ke=>h(ke.target.value),className:Pe,placeholder:T==="merchant"?" ":":  "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),n.jsx("input",{type:"tel",value:f,onChange:ke=>m(ke.target.value),className:`${Pe} text-right placeholder:text-right`,placeholder:"01xxxxxxxxx",dir:"rtl"})]}),T!=="driver"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:""}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"text",value:b,onChange:ke=>y(ke.target.value),className:`${Pe} pl-10`,placeholder:" "}),n.jsx(pn,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500"})]})]}),T==="merchant"&&n.jsxs("div",{className:"space-y-4 pt-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),n.jsxs("div",{className:"relative",children:[n.jsx("select",{value:F,onChange:ke=>S(ke.target.value),className:`${Pe} appearance-none`,children:Z3.map(ke=>n.jsx("option",{value:ke.id,children:ke.label},ke.id))}),n.jsx(bn,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500 pointer-events-none"})]})]}),n.jsxs("div",{className:"bg-[#252525] p-3 rounded-xl border border-[#333] space-y-3",children:[n.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:k,onChange:ke=>q(ke.target.checked),className:"w-5 h-5 rounded bg-gray-700 border-gray-600 text-red-600 focus:ring-red-500"}),n.jsxs("span",{className:"flex items-center gap-2 text-sm text-gray-200",children:[n.jsx(Lr,{className:"w-4 h-4 text-orange-400"}),"  "]})]}),n.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:ae,onChange:ke=>K(ke.target.checked),className:"w-5 h-5 rounded bg-gray-700 border-gray-600 text-red-600 focus:ring-red-500"}),n.jsxs("span",{className:"flex items-center gap-2 text-sm text-gray-200",children:[n.jsx(xt,{className:"w-4 h-4 text-blue-400"}),"    "]})]})]})]})]}),n.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm h-fit",children:[n.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[n.jsx("span",{className:"w-1 h-5 bg-blue-500 rounded-full"})," "]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),n.jsx("input",{type:"password",value:v,onChange:ke=>N(ke.target.value),className:Pe,placeholder:"******"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"  "}),n.jsx("input",{type:"password",value:E,onChange:ke=>I(ke.target.value),className:Pe,placeholder:"******"})]})]}),T==="driver"&&n.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-6 shadow-sm md:col-span-2",children:[n.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[n.jsx(hn,{className:"w-5 h-5 text-orange-500"})," "]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),n.jsx("div",{className:"flex bg-[#252525] p-1 rounded-xl border border-[#333]",children:[{value:"12_hour",label:" 12 "},{value:"always_open",label:" "}].map(ke=>n.jsx("button",{type:"button",onClick:()=>C(ke.value),className:`flex-1 py-2.5 text-sm font-bold rounded-lg transition-all ${Y===ke.value?"bg-orange-500 text-white shadow-md":"text-gray-400 hover:text-white"}`,children:ke.label},ke.value))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"    ( )"}),n.jsxs("div",{className:"bg-[#252525] p-4 rounded-xl border border-[#333]",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("span",{className:"text-sm text-white font-medium",children:"  "}),n.jsx("button",{onClick:()=>U(!P),className:`w-12 h-6 rounded-full p-1 transition-colors duration-300 ${P?"bg-green-600":"bg-gray-600"}`,children:n.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-300 ${P?"translate-x-0":"-translate-x-6"}`})})]}),n.jsxs("div",{className:`overflow-hidden transition-all duration-300 ${P?"max-h-0 opacity-50":"max-h-20 opacity-100"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"range",min:"1",max:"10",value:O,onChange:ke=>D(parseInt(ke.target.value)),className:"flex-1 accent-orange-500 h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer",disabled:P}),n.jsx("div",{className:"bg-black/30 px-3 py-1 rounded-lg border border-[#444] min-w-[3rem] text-center font-bold text-white",children:O})]}),n.jsx("p",{className:"text-[10px] text-gray-500 mt-2",children:"        ."})]})]})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:["  ",ye]}),n.jsxs("div",{className:"bg-[#252525] p-4 rounded-xl border border-[#333] space-y-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-400 mb-2",children:" "}),n.jsx("div",{className:"flex gap-2",children:[0,25,50].map(ke=>n.jsxs("button",{type:"button",onClick:()=>{Z("percentage"),B(ke)},className:`px-4 py-2 text-sm font-bold rounded-lg border transition-all ${Q==="percentage"&&$===ke?"bg-orange-500 border-orange-500 text-white":"bg-transparent border-gray-600 text-gray-400"}`,children:[ke,"%"]},`perc-${ke}`))})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"  (.)"}),n.jsx("div",{className:"flex gap-2",children:[5,10,15,20].map(ke=>n.jsx("button",{type:"button",onClick:()=>{Z("fixed"),B(ke)},className:`px-4 py-2 text-sm font-bold rounded-lg border transition-all ${Q==="fixed"&&$===ke?"bg-orange-500 border-orange-500 text-white":"bg-transparent border-gray-600 text-gray-400"}`,children:ke},`fixed-${ke}`))})]})]})]})]})]}),T==="supervisor"&&n.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm md:col-span-2",children:[n.jsx("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2",children:" "}),n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:Fe.map(ke=>n.jsxs("label",{className:"flex items-center space-x-3 space-x-reverse p-4 bg-[#252525] rounded-xl cursor-pointer hover:bg-[#303030] transition-colors border border-transparent hover:border-gray-600",children:[n.jsx("input",{type:"checkbox",checked:W.includes(ke.id),onChange:()=>Re(ke.id),className:"h-5 w-5 rounded bg-gray-700 border-gray-600 text-red-600 focus:ring-red-500 accent-red-600"}),n.jsx("span",{className:"text-sm font-bold text-gray-200",children:ke.label})]},ke.id))})]})]}),M&&n.jsx("div",{className:"bg-red-900/20 border border-red-500/50 text-red-400 p-4 rounded-xl text-center font-bold",children:M})]})]})},tR=s=>{switch(s){case"active":return"";case"pending":return" ";case"inactive":return" ";case"blocked":return"";default:return s}},sR=s=>{switch(s){case"active":return"green";case"pending":return"yellow";case"inactive":return"gray";case"blocked":return"red";default:return"gray"}},nR=s=>{switch(s){case"driver":return{label:"",bg:"bg-orange-500/10",text:"text-orange-400",border:"border-orange-500/20"};case"merchant":return{label:"",bg:"bg-purple-500/10",text:"text-purple-400",border:"border-purple-500/20"};case"admin":return{label:"",bg:"bg-red-500/10",text:"text-red-400",border:"border-red-500/20"};case"supervisor":return{label:"",bg:"bg-yellow-500/10",text:"text-yellow-400",border:"border-yellow-500/20"};case"customer":return{label:"",bg:"bg-blue-500/10",text:"text-blue-400",border:"border-blue-500/20"};default:return{label:"",bg:"bg-gray-500/10",text:"text-gray-400",border:"border-gray-500/20"}}},rR=s=>{if(s!=null&&s.startsWith("data:")||s!=null&&s.startsWith("http"))return"p-0";switch(s){case"gold":return"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[2px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[2px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-0"}},aR=s=>{if(!s||s==="none")return null;if(s!=null&&s.startsWith("data:")||s!=null&&s.startsWith("http"))return n.jsx("div",{className:"w-6 h-6 min-w-[1.5rem] rounded bg-white/5 border border-white/10 flex items-center justify-center p-0.5 ml-1",children:n.jsx("img",{src:s,className:"w-full h-full object-contain",alt:"badge"})});switch(s){case"verified":return n.jsx(Si,{className:"w-3 h-3 text-blue-400"});case"vip":return n.jsx(ra,{className:"w-3 h-3 text-yellow-400"});case"star":return n.jsx(pr,{className:"w-3 h-3 text-purple-400"});case"popular":return n.jsx(Ft,{className:"w-3 h-3 text-red-400"});case"shield":case"tier-1":case"tier-2":case"tier-3":case"tier-4":case"tier-5":return n.jsx(Or,{className:"w-3 h-3 text-orange-400"});case"admin-badge":return n.jsx(hn,{className:"w-3 h-3 text-red-500"});case"mod-badge":return n.jsx(Or,{className:"w-3 h-3 text-green-500"});case"driver-badge":return n.jsx(Ut,{className:"w-3 h-3 text-orange-500"});case"merchant-badge":return n.jsx(Xn,{className:"w-3 h-3 text-purple-500"});case"support-badge":return n.jsx(Vr,{className:"w-3 h-3 text-blue-500"});case"flash":return n.jsx(Ao,{className:"w-3 h-3 text-yellow-400"});case"love":return n.jsx(Ih,{className:"w-3 h-3 text-pink-400"});case"cool":return n.jsx(pr,{className:"w-3 h-3 text-cyan-400"});case"fire-b":return n.jsx(Ft,{className:"w-3 h-3 text-red-500"});case"check":return n.jsx(Xe,{className:"w-3 h-3 text-green-500"});case"money":return n.jsx(eu,{className:"w-3 h-3 text-emerald-400"});case"let-a":return n.jsx("span",{className:"text-[10px] font-bold font-mono text-white",children:"A"});case"let-b":return n.jsx("span",{className:"text-[10px] font-bold font-mono text-white",children:"B"});case"let-s":return n.jsx("span",{className:"text-[10px] font-bold font-mono text-yellow-400",children:"S"});case"let-x":return n.jsx("span",{className:"text-[10px] font-bold font-mono text-red-400",children:"X"});case"pro":return n.jsx("span",{className:"text-[8px] font-black text-white bg-black px-1 rounded border border-white/50",children:"PRO"});case"max":return n.jsx("span",{className:"text-[8px] font-black text-white bg-red-600 px-1 rounded",children:"MAX"});case"top":return n.jsx(Ft,{className:"w-3 h-3 text-blue-500"});default:return null}},Lb=s=>(s==null?void 0:s.startsWith("data:"))||(s==null?void 0:s.startsWith("http")),iR=({user:s,onEdit:e,onDelete:t,onApprove:r,onBlock:i,onUnblock:l,isPrimaryAdmin:d})=>{const{dateStr:h,timeStr:f,dayStr:m}=(()=>{try{const E=new Date(s.createdAt);if(isNaN(E.getTime()))return{dateStr:"--",timeStr:"--",dayStr:""};const I=E.toLocaleDateString("ar-EG-u-nu-latn",{weekday:"long"}),T=E.toLocaleDateString("ar-EG-u-nu-latn",{year:"numeric",month:"short",day:"numeric"}),L=E.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric"});return{dateStr:T,timeStr:L,dayStr:I}}catch{return{dateStr:"--",timeStr:"--",dayStr:""}}})(),b=sR(s.status),y=nR(s.role),v=rR(s.specialFrame),N=s.status==="blocked";return n.jsxs("div",{className:`group relative rounded-2xl border shadow-lg transition-all duration-300 overflow-hidden flex flex-col h-full ${N?"bg-red-950/20 border-red-500/30":"bg-gray-800 border-gray-700/50 hover:border-gray-600 hover:shadow-xl"}`,children:[n.jsx("div",{className:`absolute top-0 right-0 w-1.5 h-full bg-${b}-500 opacity-80`}),n.jsxs("div",{className:"p-5 flex-1",children:[n.jsxs("div",{className:"flex justify-between items-start mb-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:`relative w-14 h-14 flex items-center justify-center rounded-full ${Lb(s.specialFrame)?"":v} ${N?"grayscale":""}`,children:[Lb(s.specialFrame)&&n.jsx("img",{src:s.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.6] pointer-events-none",alt:"frame"}),n.jsx("div",{className:`${Lb(s.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border border-gray-800 relative z-0`,children:s.storeImage?n.jsx("img",{src:s.storeImage,alt:s.name,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-7 h-7 text-gray-400"})})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("h3",{className:"font-bold text-white text-lg leading-tight truncate max-w-[120px]",title:s.name,children:s.name}),aR(s.specialBadge)]}),n.jsx("div",{className:`inline-flex items-center px-2 py-0.5 mt-1 rounded text-[10px] font-bold border ${y.bg} ${y.text} ${y.border}`,children:y.label})]})]}),n.jsx("div",{className:`px-2.5 py-1 rounded-lg text-[10px] font-bold bg-${b}-500/10 text-${b}-400 border border-${b}-500/20`,children:tR(s.status)})]}),n.jsxs("div",{className:`rounded-xl p-3 space-y-2.5 border ${N?"bg-red-900/10 border-red-500/20":"bg-[#1a1a1a]/60 border-gray-700/30"}`,children:[n.jsxs("div",{className:"flex items-center text-gray-300 text-xs font-medium",children:[n.jsx($s,{className:"w-3.5 h-3.5 text-gray-500 ml-2"}),n.jsx("span",{className:"font-mono dir-ltr selectable",children:s.phone||" "})]}),s.address&&n.jsxs("div",{className:"flex items-start text-gray-400 text-[11px] leading-snug",children:[n.jsx(pn,{className:"w-3.5 h-3.5 text-gray-600 ml-2 mt-0.5 flex-shrink-0"}),n.jsx("span",{className:"truncate",children:s.address})]}),n.jsx("div",{className:"pt-2 mt-2 border-t border-gray-700/50 flex flex-col gap-1.5",children:n.jsx("div",{className:"flex items-center justify-between text-[10px] text-gray-400",children:n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx(Ba,{className:"w-3 h-3 text-gray-500"}),n.jsxs("span",{children:[m," ",h]})]})})})]})]}),n.jsxs("div",{className:`px-4 py-3 border-t flex justify-between items-center ${N?"bg-red-900/30 border-red-500/30":"bg-[#151515] border-gray-700/50"}`,children:[n.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[s.status==="pending"&&r&&n.jsxs("button",{onClick:()=>r(s.id),className:"flex-1 flex items-center justify-center text-xs bg-green-600 hover:bg-green-500 text-white font-bold px-3 py-2 rounded-lg shadow-lg shadow-green-900/20 transition-all active:scale-95 clickable",children:[n.jsx(Xe,{className:"w-3.5 h-3.5 ml-1.5"}),""]}),N?l&&!d&&n.jsxs("button",{onClick:()=>l(s),className:"flex-1 flex items-center justify-center text-xs bg-green-500/10 hover:bg-green-500/20 text-green-400 border border-green-500/20 font-bold px-3 py-2 rounded-lg transition-all active:scale-95 clickable",title:" ",children:[n.jsx(C3,{className:"w-3.5 h-3.5 ml-1.5"})," "]}):i&&!d&&n.jsx("button",{onClick:()=>i(s),className:"p-2 text-gray-400 hover:text-white hover:bg-red-600 rounded-lg transition-colors border border-gray-600 hover:border-red-500 clickable",title:" ",children:n.jsx(k3,{className:"w-4 h-4"})}),e&&n.jsx("button",{onClick:()=>e(s),className:"p-2 text-blue-400 hover:text-white hover:bg-blue-600 rounded-lg transition-colors border border-blue-500/20 bg-blue-500/10 clickable",title:"",children:n.jsx(Jn,{className:"w-4 h-4"})})]}),t&&!d&&n.jsx("button",{onClick:()=>t(s),className:"p-2 text-red-400 hover:text-white hover:bg-red-600 rounded-lg transition-colors border border-blue-500/20 bg-red-500/10 mr-2 clickable",title:"",children:n.jsx(jt,{className:"w-4 h-4"})})]})]})},uS=({users:s,updateUser:e,onDeleteUser:t,onAdminAddUser:r,setEditingUser:i,onViewUser:l,permissions:d,appName:h,currentUser:f})=>{const[m,b]=w.useState(null),[y,v]=w.useState(null),[N,E]=w.useState(null),[I,T]=w.useState(!1),[L,$]=w.useState("drivers"),[B,Q]=w.useState(""),Z=!d||d.includes("manage_users"),Y=(f==null?void 0:f.role)==="supervisor",{drivers:C,merchants:P,customers:U,supervisors:O,admins:D,blocked:F}=w.useMemo(()=>{const H=s.filter(Re=>Re.status!=="blocked"),se=s.filter(Re=>Re.status==="blocked"),J=!Y||d&&d.includes("manage_supervisors"),oe=H.filter(Re=>Re.role==="driver"),je=H.filter(Re=>Re.role==="merchant"),ye=H.filter(Re=>Re.role==="customer"),Pe=H.filter(Re=>Re.role==="supervisor"&&J),Fe=H.filter(Re=>Re.role==="admin");return{drivers:oe,merchants:je,customers:ye,supervisors:Pe,admins:Fe,blocked:se}},[s,Y,d]),S=w.useMemo(()=>{const H=!Y||d&&d.includes("manage_supervisors"),se=[{id:"drivers",label:"",data:C,color:"text-orange-400"},{id:"merchants",label:"",data:P,color:"text-purple-400"},{id:"customers",label:"",data:U,color:"text-blue-400"}];return H&&se.push({id:"supervisors",label:"",data:O,color:"text-yellow-400"}),Y||se.push({id:"admins",label:"",data:D,color:"text-red-400"}),se.push({id:"blocked",label:"",data:F,color:"text-red-500"}),se},[C,P,U,O,D,F,Y,d]),ae=S.find(H=>H.id===L)||S[0],K=w.useMemo(()=>{const H=ae.data;return B?H.filter(se=>se.name.toLowerCase().includes(B.toLowerCase())||se.phone&&se.phone.includes(B)||se.id.includes(B)):H},[ae,B]),k=ae.label,q=H=>Z?!f||f.role==="admin"?!0:f.role==="supervisor"?!(H.id===f.id||H.role==="admin"||H.role==="supervisor"):!1:!1;Wt(()=>I?(T(!1),!0):m?(b(null),!0):y?(v(null),!0):N?(E(null),!0):!1,[I,m,y,N]);const W=H=>{try{window.history.pushState({view:"users",modal:H},"",window.location.pathname)}catch{}},ne=()=>{var H;(H=window.history.state)!=null&&H.modal?window.history.back():(T(!1),b(null),v(null),E(null))};w.useEffect(()=>{const H=se=>{var J;(J=se.state)!=null&&J.modal||(T(!1),b(null),v(null),E(null))};return window.addEventListener("popstate",H),()=>window.removeEventListener("popstate",H)},[]);const M=()=>{m&&t(m.id),ne()},R=()=>{y&&e(y.id,{status:"blocked"}),ne()},V=()=>{N&&e(N.id,{status:"active"}),ne()},X=async H=>{const se=await r(H);ne(),se&&l&&setTimeout(()=>{l(se)},100)};return n.jsxs("div",{className:"space-y-6 pb-32 animate-fadeIn relative",children:[n.jsxs("div",{className:"pb-2 -mx-4 px-4 sm:-mx-6 sm:px-6 lg:-mx-8 lg:px-8 transition-all",children:[n.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-gray-800/60 backdrop-blur-md p-4 rounded-2xl border border-gray-700/50 shadow-lg mb-4 mt-1",children:[n.jsxs("div",{className:"relative w-full md:w-auto md:flex-1 max-w-md",children:[n.jsx(Ln,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 w-5 h-5"}),n.jsx("input",{type:"text",placeholder:`  ${k}...`,value:B,onChange:H=>Q(H.target.value),className:"w-full bg-gray-900/80 text-white text-sm rounded-xl py-2.5 pr-10 pl-4 border border-gray-700 focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all placeholder-gray-500"})]}),Z&&L!=="blocked"&&n.jsxs("button",{onClick:()=>{W("addUser"),T(!0)},className:"w-full md:w-auto flex items-center justify-center gap-2 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white px-6 py-2.5 rounded-xl shadow-lg shadow-red-900/30 transition-all active:scale-95 group",children:[n.jsx("div",{className:"bg-white/20 p-1 rounded-full group-hover:rotate-90 transition-transform duration-300",children:n.jsx(D3,{className:"w-4 h-4"})}),n.jsx("span",{className:"font-bold text-sm",children:" "})]})]}),n.jsx("div",{className:"relative",children:n.jsx("div",{className:"flex overflow-x-auto pb-2 scrollbar-hide gap-2 sm:gap-3 bg-gray-900/95",children:S.map(H=>{const se=L===H.id,J=H.id==="blocked";return n.jsxs("button",{onClick:()=>$(H.id),className:`
                        relative flex-shrink-0 flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-bold transition-all duration-300 border
                        ${se?J?"bg-red-900/40 text-red-200 border-red-500 shadow-md transform scale-105 z-10":"bg-gray-800 text-white border-gray-600 shadow-md transform scale-105 z-10":"bg-gray-800/40 text-gray-400 border-transparent hover:bg-gray-800/80 hover:text-gray-200"}
                      `,children:[n.jsx("span",{className:`w-2 h-2 rounded-full ${se?"bg-red-500 animate-pulse":"bg-gray-600"}`}),H.label,n.jsx("span",{className:`mr-1 px-1.5 py-0.5 rounded-md text-[10px] ${se?"bg-white/10 text-white":"bg-black/20 text-gray-500"}`,children:H.data.length}),se&&n.jsx("div",{className:"absolute bottom-0 left-3 right-3 h-0.5 bg-red-500 rounded-full shadow-[0_0_10px_rgba(239,68,68,0.5)]"})]},H.id)})})})]}),K.length>0?n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 animate-slide-up mt-2",children:K.map((H,se)=>{const J=q(H);return n.jsx("div",{style:{animationDelay:`${se*50}ms`},className:"animate-fade-slide-up",children:n.jsx(iR,{user:H,onEdit:J?i:void 0,onDelete:J?oe=>{W("deleteUser"),b(oe)}:void 0,onApprove:J?oe=>e(oe,{status:"active"}):void 0,onBlock:J?oe=>{W("blockUser"),v(oe)}:void 0,onUnblock:J?oe=>{W("unblockUser"),E(oe)}:void 0,isPrimaryAdmin:H.id==="5"})},H.id)})}):n.jsxs("div",{className:"flex flex-col items-center justify-center py-24 bg-gray-800/30 rounded-3xl border border-dashed border-gray-700/50 mt-4",children:[n.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4 shadow-inner",children:n.jsx(Zd,{className:"w-10 h-10 text-gray-600 opacity-50"})}),n.jsx("h3",{className:"text-xl font-bold text-gray-300",children:"  "}),n.jsx("p",{className:"text-gray-500 text-sm mt-1",children:B?`     "${B}"`:` ${k}  .`}),Z&&!B&&L!=="blocked"&&n.jsxs("button",{onClick:()=>{W("addUser"),T(!0)},className:"mt-6 text-red-400 hover:text-red-300 text-sm font-bold underline underline-offset-4",children:[" ",k.slice(0,-1)," "]})]}),m&&n.jsx(fs,{title:"  ",message:`     ${oR(m.role)}: ${m.name}.   `,onConfirm:M,onClose:ne,confirmButtonText:" ",cancelButtonText:"",confirmVariant:"danger"}),y&&n.jsx(fs,{title:" ",message:`      ${y.name}       .`,onConfirm:R,onClose:ne,confirmButtonText:" ",cancelButtonText:"",confirmVariant:"danger"}),N&&n.jsx(fs,{title:" ",message:`        ${N.name}      .`,onConfirm:V,onClose:ne,confirmButtonText:" ",cancelButtonText:"",confirmVariant:"success"}),I&&n.jsx(eR,{onClose:ne,onSave:X,initialRole:L==="customers"?"customer":L==="admins"?"admin":L.slice(0,-1),appName:h,currentUserRole:f==null?void 0:f.role,currentUserPermissions:d})]})},oR=s=>{switch(s){case"driver":return"";case"merchant":return"";case"admin":return"";case"supervisor":return"";case"customer":return"";default:return""}},lR=[{id:"restaurant",label:""},{id:"market",label:" "},{id:"pharmacy",label:""},{id:"bakery",label:"/"},{id:"electronics",label:""},{id:"fashion",label:""},{id:"logistics",label:" "},{id:"other",label:""}],cR=[{title:" ",icon:n.jsx(Ut,{className:"w-5 h-5 text-blue-400"}),permissions:[{id:"view_orders",label:" ",desc:"   "},{id:"manage_orders",label:" ",desc:"   "},{id:"delete_orders",label:" ",desc:"    "}]},{title:" ",icon:n.jsx(Zd,{className:"w-5 h-5 text-purple-400"}),permissions:[{id:"view_users",label:" ",desc:"   "},{id:"manage_users",label:" ",desc:"   "},{id:"manage_stores",label:" ",desc:"   "},{id:"manage_supervisors",label:" ",desc:"   "}]},{title:" ",icon:n.jsx(Ef,{className:"w-5 h-5 text-green-400"}),permissions:[{id:"view_reports",label:" ",desc:"  "},{id:"view_wallet",label:" ",desc:"   "},{id:"view_logs",label:" ",desc:"  "}]},{title:" ",icon:n.jsx(tf,{className:"w-5 h-5 text-yellow-400"}),permissions:[{id:"manage_promo",label:" ",desc:"  "},{id:"manage_slider",label:" ",desc:"   "},{id:"send_messages",label:" ",desc:"  "},{id:"manage_decorations",label:"  ",desc:"    "}]},{title:" ",icon:n.jsx(Vr,{className:"w-5 h-5 text-indigo-400"}),permissions:[{id:"manage_support",label:"  ",desc:"    "},{id:"delete_support_messages",label:" ",desc:"   "}]}],Tv=({user:s,onClose:e,onSave:t,isLastAdmin:r,isPrimaryAdmin:i,appName:l,currentUser:d})=>{var nn,Te;const h=(d==null?void 0:d.role)==="admin",[f,m]=w.useState(s.name),[b,y]=w.useState(s.phone||""),[v,N]=w.useState(s.address||""),[E,I]=w.useState(s.status),[T,L]=w.useState(s.role),[$,B]=w.useState(h&&s.password||""),[Q,Z]=w.useState(""),[Y,C]=w.useState(!1),[P,U]=w.useState(s.commissionRate||0),[O,D]=w.useState(s.commissionType||"percentage"),[F,S]=w.useState(s.incentivesActive||!1),[ae,K]=w.useState(s.dailyLogMode||"12_hour"),[k,q]=w.useState(s.maxConcurrentOrders===void 0||s.maxConcurrentOrders===null),[W,ne]=w.useState(s.maxConcurrentOrders||1),[M,R]=w.useState(s.permissions||[]),[V,X]=w.useState(((nn=s.workingHours)==null?void 0:nn.start)||"09:00"),[H,se]=w.useState(((Te=s.workingHours)==null?void 0:Te.end)||"23:00"),[J,oe]=w.useState(s.hasFreeDelivery||!1),[je,ye]=w.useState(s.responseTime||""),[Pe,Fe]=w.useState(s.storeCategory||"restaurant"),[Re,lt]=w.useState(s.canShowDeliveryTime||!1),[We,it]=w.useState(s.canManageMenu!==!1),[ke,et]=w.useState(""),[ge,ee]=w.useState(s.storeImage||null),[fe,_e]=w.useState(!1),Me=w.useRef(null),st=l||"GOO NOW";Wt(()=>(e(),!0),[e]);const tt="w-full px-4 py-3 bg-[#252525] border border-[#333] text-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors",Ie=w.useMemo(()=>{var De;const we=[{id:"customer",label:""},{id:"driver",label:""},{id:"merchant",label:""},{id:"supervisor",label:""},{id:"admin",label:""}];if((d==null?void 0:d.role)==="supervisor"){const pe=(De=d.permissions)==null?void 0:De.includes("manage_supervisors");return we.filter(Le=>Le.id!=="admin"&&(pe||Le.id!=="supervisor"))}return we},[d==null?void 0:d.role,d==null?void 0:d.permissions]),$e=we=>{R(De=>De.includes(we)?De.filter(pe=>pe!==we):[...De,we])},bt=we=>{var pe;const De=(pe=we.target.files)==null?void 0:pe[0];if(De){_e(!0);const Le=new FileReader;Le.onloadend=()=>{const qe=new Image;qe.src=Le.result,qe.onload=()=>{const Ze=document.createElement("canvas"),pt=1024,mt=pt/qe.width;Ze.width=pt,Ze.height=qe.height*mt;const Ns=Ze.getContext("2d");Ns&&(Ns.imageSmoothingEnabled=!0,Ns.imageSmoothingQuality="high",Ns.drawImage(qe,0,0,Ze.width,Ze.height),setTimeout(()=>{ee(Ze.toDataURL("image/jpeg",.9)),_e(!1)},800))}},Le.readAsDataURL(De)}},Lt=()=>{if(!f){et("      .");return}if(String(s.id)==="5"||s.role==="admin"){if(!b||b.trim().length<1){et("   .");return}if($!==void 0&&$!==""&&$.length<1){et("      .");return}}else{if(b&&!/^\d{11}$/.test(b)){et("      11 .");return}if($&&$.length<6){et("     6     .");return}}if($&&$!==Q&&!h&&($!==(s.password||"")||!h)&&$!==Q){et("   .");return}et("");const De={name:f,phone:b,status:E,role:T,storeImage:ge||void 0,address:T!=="driver"&&v?v:void 0};$&&(De.password=$),T==="driver"&&(De.commissionRate=P,De.commissionType=O,De.incentivesActive=F,De.dailyLogMode=ae,De.maxConcurrentOrders=k?null:W),T==="merchant"&&(De.workingHours={start:V,end:H},De.hasFreeDelivery=J,De.responseTime=je,De.storeCategory=Pe,De.canShowDeliveryTime=Re,De.canManageMenu=We),T==="supervisor"&&(De.permissions=M),T==="driver"&&k&&(De.maxConcurrentOrders=null),t(s.id,De),e()},At=String(s.id)==="5"||s.role==="admin",os=(d==null?void 0:d.role)==="supervisor"&&(d==null?void 0:d.id)===s.id;return n.jsxs("div",{className:"fixed inset-0 bg-[#111] z-[60] overflow-y-auto animate-fadeIn flex flex-col",children:[n.jsxs("div",{className:"flex-none bg-[#1a1a1a] border-b border-[#333] px-4 pt-safe h-16 box-content flex items-center justify-between sticky top-0 z-20 shadow-lg",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{onClick:e,className:"bg-[#252525] p-2 rounded-full text-gray-400 hover:text-white transition-colors",children:n.jsx(zs,{className:"w-6 h-6 rotate-180"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-white",children:" "}),n.jsx("p",{className:"text-xs text-gray-500 font-mono",children:s.id})]})]}),n.jsx("button",{onClick:Lt,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-lg transition-colors shadow-md",children:" "})]}),n.jsxs("div",{className:"flex-1 max-w-4xl mx-auto w-full p-4 sm:p-8 space-y-8 pb-20",children:[n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("div",{onClick:()=>{var we;return!fe&&((we=Me.current)==null?void 0:we.click())},className:"relative cursor-pointer rounded-full flex items-center justify-center overflow-hidden group shadow-xl transition-all duration-300 w-36 h-36 border-2 border-gray-700",children:n.jsxs("div",{className:"w-full h-full rounded-full overflow-hidden bg-[#252525] relative border-2 border-[#111]",children:[fe&&n.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 z-50 backdrop-blur-sm",children:n.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})}),ge?n.jsx("img",{src:ge,alt:"Profile",className:"w-full h-full object-cover"}):n.jsx("div",{className:"flex flex-col items-center justify-center h-full w-full text-gray-400",children:n.jsx(Jr,{className:"w-10 h-10 mb-1"})}),n.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsx(gr,{className:"w-8 h-8 text-white"})})]})}),n.jsx("input",{ref:Me,type:"file",accept:"image/*",className:"absolute opacity-0 w-0 h-0 pointer-events-none",onChange:bt})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm h-fit",children:[n.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[n.jsx("span",{className:"w-1 h-5 bg-red-500 rounded-full"})," "]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),n.jsx("input",{type:"text",value:f,onChange:we=>m(we.target.value),className:tt})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:At?"  ()":" "}),n.jsx("input",{type:At?"text":"tel",value:b,onChange:we=>y(we.target.value),className:`${tt} ${At?"":"text-right placeholder:text-right"}`,dir:"rtl",placeholder:At?"     (: 5)":"01xxxxxxxxx"})]}),!os&&T!=="driver"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:""}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"text",value:v,onChange:we=>N(we.target.value),className:`${tt} pl-10`,placeholder:" "}),n.jsx(pn,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500"})]})]}),!os&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" (Role)"}),n.jsx("div",{className:`flex flex-wrap gap-2 ${r||i?"opacity-50 cursor-not-allowed":""}`,children:Ie.map(we=>n.jsx("button",{type:"button",onClick:()=>L(we.id),disabled:r||i,className:`px-4 py-2 text-sm font-bold rounded-xl border transition-all ${T===we.id?"bg-red-600 border-red-600 text-white shadow-lg":"bg-transparent border-gray-600 text-gray-400 hover:border-gray-400"}`,children:we.label},we.id))})]}),!os&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),n.jsx("div",{className:`flex bg-[#252525] p-1 rounded-xl border border-[#333] ${i?"opacity-50 pointer-events-none":""}`,children:[{value:"active",label:""},{value:"pending",label:" "},{value:"inactive",label:" "}].map(we=>n.jsx("button",{type:"button",onClick:()=>I(we.value),disabled:i,className:`flex-1 py-2 text-xs font-bold rounded-lg transition-colors ${E===we.value?"bg-white text-black shadow-sm":"text-gray-400 hover:text-white"}`,children:we.label},we.value))})]})]}),n.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm h-fit",children:[n.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[n.jsx("span",{className:"w-1 h-5 bg-blue-500 rounded-full"}),"  "]}),n.jsxs("div",{className:"relative",children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:h?"  ":"   "}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:Y?"text":"password",value:$,onChange:we=>B(we.target.value),className:`${tt} pr-10`,placeholder:h?At?"    ":"******":"   "}),n.jsx("button",{type:"button",onClick:()=>C(!Y),className:"absolute inset-y-0 left-0 px-3 flex items-center text-gray-400 hover:text-white",children:Y?n.jsx(wi,{className:"w-5 h-5"}):n.jsx(na,{className:"w-5 h-5"})})]}),At&&h&&n.jsx("p",{className:"text-[10px] text-green-400 mt-2 font-bold",children:" :        ."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"  "}),n.jsx("input",{type:"password",value:Q,onChange:we=>Z(we.target.value),className:tt,placeholder:h?"******":"    "})]})]}),T==="merchant"&&n.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm md:col-span-2",children:[n.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[n.jsx("span",{className:"w-1 h-5 bg-purple-500 rounded-full"})," "]}),n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"text-xs text-gray-500 mb-1 block text-center",children:" "}),n.jsx("input",{type:"time",value:V,onChange:we=>X(we.target.value),className:"w-full bg-[#252525] border border-[#333] rounded-xl p-3 text-white text-center font-mono text-lg focus:border-purple-500 outline-none"})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"text-xs text-gray-500 mb-1 block text-center",children:" "}),n.jsx("input",{type:"time",value:H,onChange:we=>se(we.target.value),className:"w-full bg-[#252525] border border-[#333] rounded-xl p-3 text-white text-center font-mono text-lg focus:border-purple-500 outline-none"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),n.jsxs("div",{className:"relative",children:[n.jsx("select",{value:Pe,onChange:we=>Fe(we.target.value),className:`${tt} appearance-none`,children:lR.map(we=>n.jsx("option",{value:we.id,children:we.label},we.id))}),n.jsx(bn,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500 pointer-events-none"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"  ()"}),n.jsx("input",{type:"text",value:je,onChange:we=>ye(we.target.value),className:tt,placeholder:": 15 "})]})]}),n.jsxs("div",{className:"space-y-2 mt-4 pt-2 border-t border-[#333]",children:[n.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#252525] rounded-xl border border-[#333]",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ut,{className:"w-4 h-4 text-green-500"}),n.jsx("label",{htmlFor:"freeDelivery",className:"text-sm font-bold text-white",children:"  "})]}),n.jsx("input",{id:"freeDelivery",type:"checkbox",checked:J,onChange:we=>oe(we.target.checked),className:"h-5 w-5 text-green-600 bg-gray-700 border-gray-600 rounded focus:ring-green-500"})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#252525] rounded-xl border border-[#333]",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Lr,{className:"w-4 h-4 text-orange-400"}),n.jsx("label",{className:"text-sm font-bold text-white",children:"  "})]}),n.jsx("input",{type:"checkbox",checked:We,onChange:we=>it(we.target.checked),className:"h-5 w-5 text-orange-600 bg-gray-700 border-gray-600 rounded focus:ring-orange-500"})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#252525] rounded-xl border border-[#333]",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(xt,{className:"w-4 h-4 text-blue-400"}),n.jsx("label",{className:"text-sm font-bold text-white",children:"   ( )"})]}),n.jsx("input",{type:"checkbox",checked:Re,onChange:we=>lt(we.target.checked),className:"h-5 w-5 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500"})]})]})]}),T==="driver"&&n.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-6 shadow-sm md:col-span-2",children:[n.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[n.jsx("span",{className:"w-1 h-5 bg-orange-500 rounded-full"}),"  "]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),n.jsx("div",{className:"flex bg-[#252525] p-1 rounded-xl border border-[#333]",children:[{value:"12_hour",label:""},{value:"always_open",label:""}].map(we=>n.jsx("button",{type:"button",onClick:()=>K(we.value),className:`flex-1 py-2.5 text-sm font-bold rounded-lg transition-all ${ae===we.value?"bg-orange-500 text-white shadow-md":"text-gray-400 hover:text-white"}`,children:we.label},we.value))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"  "}),n.jsxs("div",{className:"bg-[#252525] p-4 rounded-xl border border-[#333] flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-white font-medium",children:k?" ":W}),n.jsx("button",{onClick:()=>q(!k),className:`w-12 h-6 rounded-full p-1 transition-colors duration-300 ${k?"bg-green-600":"bg-gray-600"}`,children:n.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-300 ${k?"translate-x-0":"-translate-x-6"}`})})]}),!k&&n.jsx("input",{type:"range",min:"1",max:"10",value:W,onChange:we=>ne(parseInt(we.target.value)),className:"w-full mt-2 accent-orange-500 h-2 bg-gray-700 rounded-lg appearance-none"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:["  ",st]}),n.jsxs("div",{className:"bg-[#252525] p-4 rounded-xl border border-[#333] space-y-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-400 mb-2",children:" "}),n.jsx("div",{className:"flex gap-2",children:[0,25,50].map(we=>n.jsxs("button",{type:"button",onClick:()=>{D("percentage"),U(we)},className:`px-4 py-2 text-sm font-bold rounded-lg border transition-all ${O==="percentage"&&P===we?"bg-orange-500 border-orange-500 text-white":"bg-transparent border-gray-600 text-gray-400"}`,children:[we,"%"]},`perc-${we}`))})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"  (.)"}),n.jsx("div",{className:"flex gap-2",children:[5,10,15,20].map(we=>n.jsx("button",{type:"button",onClick:()=>{D("fixed"),U(we)},className:`px-4 py-2 text-sm font-bold rounded-lg border transition-all ${O==="fixed"&&P===we?"bg-orange-500 border-orange-500 text-white":"bg-transparent border-gray-600 text-gray-400"}`,children:we},`fixed-${we}`))})]})]})]})]})]}),T==="supervisor"&&!os&&n.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm md:col-span-2",children:[n.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-4 flex items-center gap-2",children:[n.jsx(Or,{className:"w-5 h-5 text-yellow-500"})," "]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:cR.map((we,De)=>n.jsxs("div",{className:"bg-[#222] p-4 rounded-xl border border-[#333]",children:[n.jsxs("h4",{className:"text-sm font-bold text-gray-300 mb-3 flex items-center gap-2",children:[we.icon,we.title]}),n.jsx("div",{className:"space-y-2",children:we.permissions.map(pe=>n.jsxs("label",{className:"flex items-start gap-3 p-2 hover:bg-[#2a2a2a] rounded-lg transition-colors cursor-pointer group",children:[n.jsxs("div",{className:"relative flex items-center mt-0.5",children:[n.jsx("input",{type:"checkbox",checked:M.includes(pe.id),onChange:()=>$e(pe.id),className:"peer h-5 w-5 cursor-pointer appearance-none rounded-md border-2 border-gray-600 bg-gray-800 transition-all checked:border-yellow-500 checked:bg-yellow-500"}),n.jsx(Xe,{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-3.5 h-3.5 text-black opacity-0 peer-checked:opacity-100 pointer-events-none"})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm font-bold text-gray-200 group-hover:text-white transition-colors",children:pe.label}),pe.desc&&n.jsx("p",{className:"text-[10px] text-gray-500",children:pe.desc})]})]},pe.id))})]},De))})]})]}),ke&&n.jsx("p",{className:"text-red-400 font-bold text-center bg-red-900/20 p-3 rounded-xl border border-red-500/30",children:ke})]})]})},dR=s=>{switch(s){case"merchant":return"";case"driver":return" ";case"customer":return"";case"admin":return" ";case"supervisor":return"";default:return s}},uR=s=>{switch(s){case"restaurant":return"";case"market":return" ";case"pharmacy":return"";case"other":return"";default:return s||" "}},_a=({label:s,value:e,icon:t,fullWidth:r,highlight:i})=>n.jsxs("div",{className:`bg-[#252525] p-4 rounded-xl border ${i?"border-red-500/30 bg-red-900/10":"border-[#333]"} flex flex-col justify-center ${r?"col-span-2":""} shadow-sm`,children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[t&&Is.cloneElement(t,{className:`w-4 h-4 ${i?"text-red-400":"text-gray-500"}`}),n.jsx("span",{className:`text-xs font-bold ${i?"text-red-300":"text-gray-400"}`,children:s})]}),n.jsx("p",{className:"font-bold text-white text-base break-words tracking-wide",children:e})]}),Sv=({user:s,onClose:e,onApprove:t,onDelete:r})=>{const i=()=>{t(s.id,{status:"active"})},l=()=>{window.confirm("       ")&&r(s.id)},d=(()=>{try{const f=new Date(s.createdAt);return isNaN(f.getTime())?" ":f.toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return" "}})(),h=()=>{switch(s.role){case"driver":return"from-orange-900/80 to-gray-900";case"merchant":return"from-purple-900/80 to-gray-900";case"admin":return"from-red-900/80 to-gray-900";default:return"from-blue-900/80 to-gray-900"}};return n.jsx("div",{className:"fixed inset-0 bg-black/95 backdrop-blur-md flex justify-center items-end sm:items-center z-50 p-0 sm:p-4 animate-fadeIn",onClick:e,children:n.jsxs("div",{className:"bg-[#1a1a1a] w-full sm:max-w-lg h-[95vh] sm:h-auto sm:max-h-[90vh] rounded-t-3xl sm:rounded-3xl border-t sm:border border-[#333] shadow-2xl flex flex-col relative overflow-hidden",onClick:f=>f.stopPropagation(),children:[n.jsxs("div",{className:`h-40 bg-gradient-to-br ${h()} relative`,children:[n.jsx("div",{className:"absolute inset-0 opacity-20 bg-[radial-gradient(#ffffff_1px,transparent_1px)] [background-size:16px_16px]"}),n.jsx("button",{onClick:e,className:"absolute top-4 left-4 bg-black/40 hover:bg-black/60 text-white p-2 rounded-full backdrop-blur-md transition-colors z-20 border border-white/10",children:n.jsx(rt,{className:"w-6 h-6"})}),n.jsx("div",{className:"absolute top-4 right-4 z-20",children:n.jsx("span",{className:`px-3 py-1.5 rounded-full text-xs font-bold border backdrop-blur-md shadow-lg ${s.status==="active"?"bg-green-500/20 text-green-400 border-green-500/30":s.status==="pending"?"bg-yellow-500/20 text-yellow-400 border-yellow-500/30":"bg-red-500/20 text-red-400 border-red-500/30"}`,children:s.status==="active"?"  ":s.status==="pending"?"  ":" "})})]}),n.jsxs("div",{className:"px-6 relative -mt-16 flex flex-col items-center z-10",children:[n.jsxs("div",{className:"w-32 h-32 rounded-3xl bg-[#252525] p-1 shadow-2xl relative group",children:[n.jsx("div",{className:"w-full h-full rounded-2xl overflow-hidden border-4 border-[#1a1a1a] relative bg-gray-800 flex items-center justify-center",children:s.storeImage?n.jsx("img",{src:s.storeImage,alt:s.name,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-12 h-12 text-gray-500"})}),n.jsxs("div",{className:"absolute -bottom-2 -right-2 bg-gray-800 text-[10px] px-2 py-1 rounded-lg font-bold text-white border border-[#444] shadow-md flex items-center gap-1",children:[n.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"}),"ID: ",s.id]})]}),n.jsx("h2",{className:"text-3xl font-black text-white mt-4 text-center tracking-tight",children:s.name}),n.jsxs("div",{className:"flex items-center gap-2 mt-2 bg-[#252525] px-4 py-1.5 rounded-full border border-[#333]",children:[n.jsx("span",{className:"text-gray-400 text-sm font-medium",children:dR(s.role)}),s.role==="driver"&&n.jsx("span",{className:"text-gray-600",children:""}),s.role==="driver"&&n.jsx("span",{className:"text-orange-400 text-xs font-bold",children:"Driver App"})]})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8 scrollbar-hide",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[n.jsx(dt,{className:"w-4 h-4 text-red-500"})," "]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx(_a,{label:" ",value:s.phone||" ",icon:n.jsx($s,{}),fullWidth:!0,highlight:!0}),n.jsx(_a,{label:" ",value:d,icon:n.jsx(Ba,{}),fullWidth:!0}),s.email&&n.jsx(_a,{label:" ",value:s.email,icon:n.jsx(Ey,{}),fullWidth:!0}),s.addresses&&s.addresses.length>0&&n.jsx(_a,{label:" ",value:s.addresses[0],icon:n.jsx(pn,{}),fullWidth:!0})]})]}),s.role==="merchant"&&n.jsxs("div",{children:[n.jsx("div",{className:"h-px bg-[#333] mb-6"}),n.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[n.jsx(bn,{className:"w-4 h-4 text-purple-500"})," "]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx(_a,{label:" ",value:uR(s.storeCategory)}),s.workingHours?n.jsx(_a,{label:" ",value:`${s.workingHours.start} - ${s.workingHours.end}`,icon:n.jsx(xt,{})}):n.jsx(_a,{label:" ",value:" ",icon:n.jsx(xt,{})})]})]}),s.role==="driver"&&n.jsxs("div",{children:[n.jsx("div",{className:"h-px bg-[#333] mb-6"}),n.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[n.jsx(hn,{className:"w-4 h-4 text-orange-500"}),"  "]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx(_a,{label:" ",value:s.commissionType==="fixed"?" ":" "}),n.jsx(_a,{label:"",value:s.commissionType==="fixed"?`${s.commissionRate} .`:`${s.commissionRate}%`,highlight:!0}),n.jsx(_a,{label:" ",value:s.dailyLogMode==="always_open"?" ":" (12 )",fullWidth:!0})]})]})]}),n.jsx("div",{className:"p-5 bg-[#1a1a1a] border-t border-[#333] flex gap-4 pb-8 sm:pb-5",children:s.status==="pending"?n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:i,className:"flex-[2] bg-green-600 hover:bg-green-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-green-900/20 active:scale-95 transition-all flex items-center justify-center gap-2",children:[n.jsx(Xe,{className:"w-5 h-5"})," "]}),n.jsxs("button",{onClick:l,className:"flex-1 bg-red-900/20 hover:bg-red-900/30 text-red-500 border border-red-500/20 font-bold py-4 rounded-xl active:scale-95 transition-all flex items-center justify-center gap-2",children:[n.jsx(jt,{className:"w-5 h-5"}),""]})]}):n.jsxs("div",{className:"w-full flex gap-3",children:[n.jsx("button",{onClick:e,className:"flex-1 bg-gray-800 hover:bg-gray-700 text-gray-200 font-bold py-4 rounded-xl transition-colors border border-gray-700",children:""}),n.jsx("button",{onClick:l,className:"w-16 bg-red-900/10 hover:bg-red-900/20 text-red-500 border border-red-500/10 font-bold py-4 rounded-xl active:scale-95 transition-all flex items-center justify-center",title:" ",children:n.jsx(jt,{className:"w-5 h-5"})})]})})]})})},hS=({merchant:s,onUpdateMerchant:e})=>{const[t,r]=w.useState(s.products||[]),[i,l]=w.useState(!1),[d,h]=w.useState({}),[f,m]=w.useState([]),[b,y]=w.useState(""),[v,N]=w.useState(""),[E,I]=w.useState(""),[T,L]=w.useState(!1),[$,B]=w.useState(null),[Q,Z]=w.useState(null),Y=w.useRef(null);Wt(()=>Q?(Z(null),!0):$?(B(null),!0):i?(l(!1),!0):!1,[$,i,Q]);const C=w.useMemo(()=>{const k=new Set(t.map(q=>q.category||""));return["",...Array.from(k)]},[t]),P=w.useMemo(()=>E===""?t:t.filter(k=>(k.category||"")===E),[t,E]),U=k=>new Promise((q,W)=>{const ne=new FileReader;ne.readAsDataURL(k),ne.onload=M=>{var V;const R=new Image;R.src=(V=M.target)==null?void 0:V.result,R.onload=()=>{const X=document.createElement("canvas"),H=1200,se=1200;let J=R.width,oe=R.height;J>oe?J>H&&(oe*=H/J,J=H):oe>se&&(J*=se/oe,oe=se),X.width=J,X.height=oe;const je=X.getContext("2d");je?(je.imageSmoothingEnabled=!0,je.imageSmoothingQuality="high",je.drawImage(R,0,0,J,oe),q(X.toDataURL("image/jpeg",.9))):W(new Error("Canvas context failed"))},R.onerror=X=>W(X)},ne.onerror=M=>W(M)}),O=async k=>{var W;const q=(W=k.target.files)==null?void 0:W[0];if(q){L(!0);try{const ne=await U(q);setTimeout(()=>{h(M=>({...M,image:ne})),L(!1)},800)}catch{L(!1),alert("  .")}}},D=()=>{b&&v&&(m([...f,{name:b,price:parseFloat(v)}]),y(""),N(""))},F=k=>{m(f.filter((q,W)=>W!==k))},S=()=>{var ne;if(!d.name||!d.price&&f.length===0)return;let k=[...t];const q=((ne=d.category)==null?void 0:ne.trim())||"",W={id:d.id||`PROD-${Date.now()}`,name:d.name,description:d.description||"",price:Number(d.price)||0,image:d.image,available:d.available??!0,category:q,sizes:f.length>0?f:void 0};d.id?k=k.map(M=>M.id===d.id?W:M):k.push(W),r(k),e(s.id,{products:k}),l(!1),h({}),m([]),I(q)},ae=()=>{if(!Q)return;const k=t.filter(q=>q.id!==Q);r(k),e(s.id,{products:k}),Z(null)},K=k=>{h(k||{available:!0,category:E!==""?E:""}),m((k==null?void 0:k.sizes)||[]),l(!0)};return n.jsxs("div",{className:"space-y-4 pb-20",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4 px-1",children:[n.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[n.jsx(bn,{className:"w-6 h-6 text-red-500"})," "]}),n.jsxs("button",{onClick:()=>K(),className:"flex items-center bg-red-600 text-white px-4 py-2 rounded-xl text-sm font-bold shadow-lg hover:bg-red-700 transition-colors",children:[n.jsx(Gs,{className:"w-4 h-4 ml-1"})," "]})]}),!i&&n.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide mb-4 px-1",children:C.map(k=>n.jsx("button",{onClick:()=>I(k),className:`px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap transition-colors border ${E===k?"bg-red-600 text-white border-red-600 shadow-md":"bg-gray-800 text-gray-400 border-gray-700 hover:bg-gray-700"}`,children:k},k))}),i&&n.jsxs("div",{className:"bg-gray-800 p-5 rounded-xl border border-gray-700 space-y-4 mb-6 shadow-2xl animate-fadeIn",children:[n.jsxs("div",{className:"flex justify-between items-center border-b border-gray-700 pb-3",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-200",children:d.id?" ":" "}),n.jsx("button",{onClick:()=>l(!1),children:n.jsx(rt,{className:"w-5 h-5 text-gray-400 hover:text-white"})})]}),n.jsx("div",{className:"flex justify-center mb-4",children:n.jsxs("div",{onClick:()=>{var k;return!T&&((k=Y.current)==null?void 0:k.click())},className:`w-full h-40 bg-gray-900 rounded-xl flex items-center justify-center cursor-pointer border-2 border-dashed border-gray-600 hover:border-red-500 overflow-hidden relative group transition-colors ${T?"opacity-50 cursor-wait":""}`,children:[T&&n.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 z-50 backdrop-blur-sm",children:n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full opacity-75 animate-ping absolute top-0 left-0"}),n.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center relative z-10 shadow-lg shadow-blue-500/50",children:n.jsx(gr,{className:"w-6 h-6 text-white animate-bounce"})}),n.jsx("div",{className:"w-20 h-20 border-4 border-blue-400/30 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"})]})}),d.image?n.jsx("img",{src:d.image,alt:"Preview",className:"w-full h-full object-cover"}):n.jsxs("div",{className:"flex flex-col items-center text-gray-500",children:[n.jsx(fr,{className:"w-10 h-10 mb-2"}),n.jsx("span",{className:"text-xs",children:"  "})]}),n.jsx("input",{ref:Y,type:"file",className:"hidden",accept:"image/*",onChange:O})]})}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:" "}),n.jsx("input",{type:"text",value:d.name||"",onChange:k=>h({...d,name:k.target.value}),className:"w-full bg-gray-700 text-white p-3 rounded-lg border border-gray-600 focus:border-red-500 outline-none"})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs("div",{className:"w-1/2",children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"  (.)"}),n.jsx("input",{type:"number",value:d.price||"",onChange:k=>h({...d,price:Number(k.target.value)}),className:"w-full bg-gray-700 text-white p-3 rounded-lg border border-gray-600 focus:border-red-500 outline-none font-bold",placeholder:"0"})]}),n.jsxs("div",{className:"w-1/2",children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:""}),n.jsx("input",{type:"text",list:"category-suggestions",value:d.category||"",onChange:k=>h({...d,category:k.target.value}),className:"w-full bg-gray-700 text-white p-3 rounded-lg border border-gray-600 focus:border-red-500 outline-none",placeholder:": "}),n.jsx("datalist",{id:"category-suggestions",children:C.filter(k=>k!=="").map(k=>n.jsx("option",{value:k},k))})]})]}),n.jsxs("div",{className:"bg-[#1a1a1a] p-3 rounded-lg border border-gray-700",children:[n.jsx("label",{className:"block text-xs font-bold text-gray-300 mb-2",children:"  ()"}),n.jsx("div",{className:"space-y-2 mb-3",children:f.map((k,q)=>n.jsxs("div",{className:"flex items-center gap-2 bg-gray-800 p-2 rounded-md border border-gray-600",children:[n.jsx("span",{className:"flex-1 text-sm text-white",children:k.name}),n.jsxs("span",{className:"text-sm font-bold text-green-400",children:[k.price.toLocaleString("en-US")," ."]}),n.jsx("button",{onClick:()=>F(q),className:"text-red-400 hover:bg-red-500/10 p-1 rounded",children:n.jsx(jt,{className:"w-4 h-4"})})]},q))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",placeholder:" (: )",value:b,onChange:k=>y(k.target.value),className:"flex-[2] bg-gray-700 text-white text-xs p-2 rounded border border-gray-600 focus:border-blue-500 outline-none"}),n.jsx("input",{type:"number",placeholder:"",value:v,onChange:k=>N(k.target.value),className:"flex-1 bg-gray-700 text-white text-xs p-2 rounded border border-gray-600 focus:border-blue-500 outline-none"}),n.jsx("button",{onClick:D,className:"bg-blue-600 text-white p-2 rounded hover:bg-blue-500",children:n.jsx(Gs,{className:"w-4 h-4"})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:""}),n.jsx("textarea",{value:d.description||"",onChange:k=>h({...d,description:k.target.value}),className:"w-full bg-gray-700 text-white p-3 rounded-lg border border-gray-600 focus:border-red-500 outline-none resize-none",rows:3})]}),n.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[n.jsx("input",{type:"checkbox",id:"available",checked:d.available!==!1,onChange:k=>h({...d,available:k.target.checked}),className:"w-5 h-5 rounded bg-gray-700 border-gray-600 text-red-600 focus:ring-red-500"}),n.jsx("label",{htmlFor:"available",className:"text-sm text-gray-300",children:"  "})]}),n.jsxs("div",{className:"flex justify-end gap-3 mt-4 pt-4 border-t border-gray-700",children:[n.jsx("button",{onClick:()=>l(!1),className:"px-6 py-2.5 rounded-lg border border-gray-600 text-gray-300 hover:bg-gray-700 transition-colors font-bold",children:""}),n.jsx("button",{onClick:S,disabled:T,className:"px-8 py-2.5 bg-red-600 text-white rounded-lg hover:bg-red-700 shadow-lg transition-colors font-bold disabled:bg-gray-600 disabled:cursor-not-allowed",children:T?" ...":" "})]})]}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 animate-fadeIn",children:P.map(k=>n.jsxs("div",{className:"group bg-gray-800 rounded-2xl overflow-hidden border border-gray-700 shadow-sm hover:shadow-xl hover:border-gray-500 transition-all duration-300 flex flex-col",children:[n.jsxs("div",{className:"relative aspect-square w-full bg-gray-900 overflow-hidden cursor-pointer",onClick:()=>k.image&&B(k.image),children:[k.image?n.jsx("img",{src:k.image,alt:k.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:n.jsx(fr,{className:"w-10 h-10 opacity-30"})}),!k.available&&n.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center backdrop-blur-[1px]",children:n.jsx("span",{className:"text-[10px] bg-red-600 text-white px-3 py-1 rounded-full font-bold shadow-md",children:" "})})]}),n.jsxs("div",{className:"p-3 flex-1 flex flex-col",children:[n.jsx("h4",{className:"font-bold text-white text-sm mb-1 line-clamp-1",title:k.name,children:k.name}),n.jsx("p",{className:"text-[10px] text-gray-400 line-clamp-2 leading-relaxed mb-2 flex-1",children:k.description}),n.jsxs("div",{className:"flex justify-between items-center mt-auto",children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsxs("span",{className:"text-red-400 font-black text-sm",children:[k.price.toLocaleString("en-US")," ",n.jsx("span",{className:"text-[9px]",children:"."})]}),k.sizes&&k.sizes.length>0&&n.jsxs("span",{className:"text-[9px] text-green-400",children:["+ ",k.sizes.length," "]})]}),n.jsx("span",{className:"text-[9px] font-mono bg-gray-700 text-gray-300 px-1.5 py-0.5 rounded border border-gray-600 truncate max-w-[60px]",children:k.category||""})]})]}),n.jsxs("div",{className:"grid grid-cols-2 divide-x divide-x-reverse divide-gray-700 border-t border-gray-700 bg-gray-800/80 backdrop-blur-sm",children:[n.jsx("button",{onClick:()=>K(k),className:"py-2.5 flex items-center justify-center text-blue-400 hover:bg-blue-500/10 transition-colors",children:n.jsx(Jn,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>Z(k.id),className:"py-2.5 flex items-center justify-center text-red-400 hover:bg-red-500/10 transition-colors",children:n.jsx(jt,{className:"w-4 h-4"})})]})]},k.id))}),P.length===0&&!i&&n.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500 bg-gray-800/30 rounded-3xl border border-dashed border-gray-700 mx-1",children:[n.jsx(bn,{className:"w-16 h-16 mb-4 opacity-20"}),n.jsx("p",{className:"text-lg font-bold text-gray-400",children:" "})]}),$&&n.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex items-center justify-center p-4 animate-fadeIn",onClick:()=>B(null),children:[n.jsx("button",{onClick:()=>B(null),className:"absolute top-4 right-4 p-2 bg-gray-800/50 rounded-full text-white hover:bg-gray-700 transition-colors z-20",children:n.jsx(rt,{className:"w-6 h-6"})}),n.jsx("img",{src:$,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl animate-pop-in",onClick:k=>k.stopPropagation()})]}),Q&&n.jsx(fs,{title:" ",message:"         ",onClose:()=>Z(null),onConfirm:ae,confirmButtonText:"",confirmVariant:"danger"})]})},fS=({users:s,orders:e,updateUser:t})=>{var E;const[r,i]=w.useState(""),[l,d]=w.useState(null),[h,f]=w.useState(null),[m,b]=w.useState(null);Wt(()=>m?(b(null),!0):l?(d(null),!0):h?(f(null),!0):!1,[m,l,h]);const y=s.filter(I=>I.role==="merchant"),v=y.filter(I=>I.name.toLowerCase().includes(r.toLowerCase())||I.phone&&I.phone.includes(r)),N=I=>{t(I.id,{hasFreeDelivery:!I.hasFreeDelivery})};return n.jsxs("div",{className:"space-y-6 pb-32 animate-fadeIn relative",children:[n.jsxs("div",{className:"bg-gray-800 p-4 rounded-2xl shadow-lg border border-gray-700/50 flex flex-col md:flex-row gap-4 items-center",children:[n.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[n.jsx("div",{className:"p-3 bg-purple-500/20 rounded-xl text-purple-400",children:n.jsx(Xn,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-white",children:" "}),n.jsxs("p",{className:"text-xs text-gray-400",children:[y.length,"  "]})]})]}),n.jsxs("div",{className:"relative flex-1 w-full",children:[n.jsx(Ln,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 w-5 h-5"}),n.jsx("input",{type:"text",placeholder:"  ...",value:r,onChange:I=>i(I.target.value),className:"w-full bg-gray-900 text-white rounded-xl py-3 pr-12 pl-4 border border-gray-600 focus:border-purple-500 focus:ring-1 focus:ring-purple-500 outline-none transition-all placeholder-gray-500"})]})]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v.length>0?v.map((I,T)=>{const L=e.filter($=>$.merchantId===I.id&&$.status===ce.Delivered).length;return n.jsxs("div",{className:"bg-[#1e293b] rounded-2xl overflow-hidden border border-gray-700 shadow-md group hover:border-gray-500 transition-all flex flex-col",children:[n.jsxs("div",{className:"h-24 bg-gray-800 relative overflow-hidden",children:[I.storeImage?n.jsx("img",{src:I.storeImage,className:"w-full h-full object-cover opacity-60 group-hover:opacity-80 transition-opacity",alt:I.name}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Xn,{className:"w-12 h-12 text-gray-600 opacity-50"})}),n.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#1e293b] to-transparent"}),n.jsxs("div",{className:"absolute bottom-3 right-4",children:[n.jsx("h3",{className:"text-lg font-bold text-white shadow-sm",children:I.name}),n.jsx("p",{className:"text-xs text-gray-400 font-mono",children:I.phone})]}),n.jsxs("div",{className:"absolute top-2 left-2 flex gap-2",children:[n.jsx("button",{onClick:()=>f(I),className:"bg-black/40 hover:bg-black/60 p-2 rounded-full text-white backdrop-blur-sm transition-colors border border-white/5",title:"",children:n.jsx(na,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>d(I),className:"bg-black/40 hover:bg-black/60 p-2 rounded-full text-white backdrop-blur-sm transition-colors border border-white/5",title:"",children:n.jsx(Jn,{className:"w-4 h-4"})})]})]}),n.jsxs("div",{className:"p-4 space-y-4 flex-1 flex flex-col",children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"flex-1 bg-gray-900/50 p-2 rounded-lg text-center border border-gray-700",children:[n.jsx("p",{className:"text-[10px] text-gray-500 mb-1",children:" "}),n.jsx("p",{className:"font-bold text-white text-lg",children:L})]}),n.jsxs("div",{className:"flex-1 bg-gray-900/50 p-2 rounded-lg text-center border border-gray-700",children:[n.jsx("p",{className:"text-[10px] text-gray-500 mb-1",children:" "}),n.jsx("p",{className:"font-bold text-blue-400 text-sm mt-1",children:I.responseTime||"--"})]})]}),n.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-700/50",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`p-1.5 rounded-lg ${I.hasFreeDelivery?"bg-green-500/20 text-green-400":"bg-gray-700 text-gray-500"}`,children:n.jsx(Ut,{className:"w-4 h-4"})}),n.jsx("span",{className:"text-sm font-medium text-gray-300",children:" "})]}),n.jsx("button",{onClick:()=>N(I),className:`w-10 h-5 rounded-full relative transition-colors duration-300 ${I.hasFreeDelivery?"bg-green-500":"bg-gray-600"}`,children:n.jsx("div",{className:`w-3 h-3 bg-white rounded-full absolute top-1 transition-all duration-300 ${I.hasFreeDelivery?"left-1":"left-6"}`})})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"p-1.5 rounded-lg bg-blue-500/20 text-blue-400",children:n.jsx(xt,{className:"w-4 h-4"})}),n.jsx("span",{className:"text-sm font-medium text-gray-300",children:" "})]}),n.jsx("span",{className:"text-xs text-gray-400 bg-gray-800 px-2 py-1 rounded",children:I.responseTime||" "})]})]}),n.jsx("div",{className:"pt-3 mt-auto",children:n.jsxs("button",{onClick:()=>b(I),className:"w-full bg-purple-600/10 hover:bg-purple-600/20 text-purple-400 font-bold py-2.5 rounded-xl border border-purple-500/20 transition-all flex items-center justify-center gap-2 active:scale-95",children:[n.jsx(Lr,{className:"w-4 h-4"}),n.jsx("span",{children:"   ()"})]})})]})]},I.id)}):n.jsxs("div",{className:"col-span-full py-12 text-center text-gray-500",children:[n.jsx(Xn,{className:"w-16 h-16 mx-auto mb-4 opacity-20"}),n.jsx("p",{children:"    ."})]})}),l&&n.jsx(Tv,{user:l,onClose:()=>d(null),onSave:(I,T)=>{t(I,T),d(null)},isLastAdmin:!1}),h&&n.jsx(Sv,{user:h,onClose:()=>f(null),onApprove:()=>{},onDelete:()=>{}}),m&&n.jsx("div",{className:"fixed inset-0 z-[100] bg-black/90 backdrop-blur-sm flex justify-center items-end sm:items-center animate-fadeIn p-0 sm:p-4",onClick:()=>b(null),children:n.jsxs("div",{className:"bg-[#1a1a1a] w-full max-w-4xl h-[95vh] sm:h-[85vh] rounded-t-3xl sm:rounded-3xl border border-gray-700 shadow-2xl flex flex-col relative overflow-hidden",onClick:I=>I.stopPropagation(),children:[n.jsxs("div",{className:"flex-none p-4 border-b border-gray-700 bg-gray-900 flex justify-between items-center",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg text-purple-400",children:n.jsx(Lr,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsxs("h3",{className:"text-lg font-bold text-white",children:["  ",m.name]}),n.jsxs("p",{className:"text-xs text-gray-400",children:[" : ",((E=m.products)==null?void 0:E.length)||0]})]})]}),n.jsx("button",{onClick:()=>b(null),className:"text-gray-400 hover:text-white p-2 rounded-full hover:bg-gray-800 transition-colors",children:n.jsx(rt,{className:"w-6 h-6"})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar bg-[#111]",children:n.jsx(hS,{merchant:m,onUpdateMerchant:(I,T)=>t(I,T)})})]})})]})},mS=({users:s,updateUser:e,onDeleteUser:t,passwordResetRequests:r,resolvePasswordResetRequest:i,setEditingUser:l,pendingOrders:d=[],onNavigateToOrders:h,unreadChats:f=[],onNavigateToSupport:m})=>{const[b,y]=w.useState(null),[v,N]=w.useState(null),E=s.filter(Y=>Y.status==="pending"&&Y.role!=="admin"),I=w.useMemo(()=>s.filter(Y=>Y.role==="merchant"&&Y.hasFreeDelivery),[s]);w.useEffect(()=>{const Y=C=>{var P;(P=C.state)!=null&&P.modal||(y(null),N(null))};return window.addEventListener("popstate",Y),()=>window.removeEventListener("popstate",Y)},[]);const T=()=>{try{window.history.pushState({view:"notifications",modal:"userDetails"},"",window.location.pathname)}catch{}},L=()=>{var Y;(Y=window.history.state)!=null&&Y.modal?window.history.back():(y(null),N(null))},$=Y=>{switch(Y){case"merchant":return"";case"driver":return"";default:return Y}},B=Y=>{const C=s.find(P=>P.phone===Y);C&&(l(C),i(Y))},Q=()=>{v&&(t(v.id),L())};return E.length>0||r.length>0||d.length>0||f.length>0||I.length>0?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"space-y-8 max-w-5xl mx-auto px-2 animate-fadeIn pb-24",children:[n.jsxs("div",{className:"flex items-center gap-4 pb-4 border-b border-gray-700/50",children:[n.jsx("div",{className:"p-3.5 bg-gradient-to-br from-red-500 to-red-700 rounded-2xl shadow-lg shadow-red-900/20",children:n.jsx(Tn,{className:"w-7 h-7 text-white"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-black text-white tracking-wide",children:" "}),n.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"    "})]})]}),f.length>0&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h2",{className:"text-lg font-bold text-green-400 flex items-center gap-2",children:[n.jsx("span",{className:"w-2.5 h-2.5 bg-green-400 rounded-full animate-pulse shadow-[0_0_10px_rgba(74,222,128,0.5)]"}),n.jsx(Vr,{className:"w-5 h-5"}),"  (",f.length,")"]}),m&&n.jsxs("button",{onClick:m,className:"text-xs font-bold text-green-500 hover:text-green-400 bg-green-500/10 hover:bg-green-500/20 px-3 py-1.5 rounded-full transition-colors flex items-center gap-1",children:[" ",n.jsx(zs,{className:"w-3 h-3"})]})]}),n.jsx("div",{className:"grid gap-3",children:f.map(Y=>n.jsxs("div",{onClick:m,className:"relative bg-[#1a1a1a] rounded-2xl p-4 shadow-lg border-r-4 border-r-green-500 border-y border-l border-gray-700 hover:border-gray-500 transition-all cursor-pointer group overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 right-0 w-20 h-full bg-gradient-to-l from-green-500/10 to-transparent pointer-events-none"}),n.jsxs("div",{className:"flex items-start gap-4 relative z-10",children:[n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border-2 border-gray-600 group-hover:border-green-500 transition-colors",children:n.jsx(dt,{className:"w-6 h-6 text-gray-400"})}),n.jsx("div",{className:"absolute -bottom-1 -right-1 bg-green-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full border border-[#1a1a1a]",children:Y.unreadCount})]}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsx("h3",{className:"font-bold text-white text-base truncate",children:Y.userName}),n.jsx("span",{className:"text-[10px] text-gray-500 font-mono bg-black/30 px-2 py-0.5 rounded",children:new Date(Y.lastUpdated).toLocaleTimeString("ar-EG",{hour:"2-digit",minute:"2-digit"})})]}),n.jsx("div",{className:"mt-2 bg-[#252525] p-2 rounded-lg rounded-tr-none border border-gray-700 inline-block max-w-full",children:n.jsxs("p",{className:"text-gray-300 text-sm line-clamp-1 flex items-center gap-2",children:[n.jsx(_v,{className:"w-3 h-3 text-green-400 flex-shrink-0"}),Y.lastMessage||"    "]})})]})]}),n.jsx("div",{className:"absolute bottom-3 left-3 opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsx("button",{className:"bg-green-600 text-white p-1.5 rounded-full shadow-lg",children:n.jsx(zs,{className:"w-4 h-4"})})})]},Y.id))})]}),I.length>0&&n.jsxs("div",{className:"space-y-4 animate-fade-slide-up",children:[n.jsxs("h2",{className:"text-lg font-bold text-purple-400 flex items-center gap-2",children:[n.jsx("span",{className:"w-2.5 h-2.5 bg-purple-400 rounded-full animate-pulse shadow-[0_0_10px_rgba(192,132,252,0.5)]"}),n.jsx(Ut,{className:"w-5 h-5"}),"    (",I.length,")"]}),n.jsx("div",{className:"grid gap-3",children:I.map(Y=>n.jsxs("div",{className:"relative bg-gradient-to-r from-[#2c1a36] to-[#1a1a1a] rounded-2xl p-0.5 shadow-lg group",children:[n.jsx("div",{className:"absolute top-0 right-0 w-1.5 h-full bg-purple-500 rounded-r-full"}),n.jsxs("div",{className:"bg-[#1a1a1a] rounded-[14px] p-4 flex flex-col sm:flex-row items-center justify-between gap-4 h-full",children:[n.jsxs("div",{className:"flex items-center gap-4 w-full",children:[n.jsx("div",{className:"w-14 h-14 rounded-xl bg-purple-500/10 flex items-center justify-center border border-purple-500/20 text-purple-400 shadow-inner",children:Y.storeImage?n.jsx("img",{src:Y.storeImage,className:"w-full h-full object-cover rounded-xl",alt:"Store"}):n.jsx(Xn,{className:"w-7 h-7"})}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h3",{className:"font-bold text-white text-lg",children:Y.name}),n.jsx("span",{className:"bg-purple-600 text-white text-[9px] px-2 py-0.5 rounded font-bold",children:" "})]}),n.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["   ",n.jsx("span",{className:"text-white font-bold",children:" "})," ."]})]})]}),n.jsxs("div",{className:"flex gap-2 w-full sm:w-auto mt-2 sm:mt-0",children:[n.jsx("button",{onClick:()=>{T(),y(Y)},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-xs font-bold transition-colors border border-gray-600",children:" "}),n.jsx("button",{onClick:()=>e(Y.id,{hasFreeDelivery:!1}),className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-400 rounded-lg text-xs font-bold transition-colors border border-red-500/10",children:" "})]})]})]},Y.id))})]}),d.length>0&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h2",{className:"text-lg font-bold text-yellow-400 flex items-center gap-2",children:[n.jsx("span",{className:"w-2.5 h-2.5 bg-yellow-400 rounded-full animate-pulse shadow-[0_0_10px_rgba(250,204,21,0.5)]"}),n.jsx(Ut,{className:"w-5 h-5"}),"   (",d.length,")"]}),h&&n.jsxs("button",{onClick:h,className:"text-xs font-bold text-yellow-500 hover:text-yellow-400 bg-yellow-500/10 hover:bg-yellow-500/20 px-3 py-1.5 rounded-full transition-colors flex items-center gap-1",children:[" ",n.jsx(zs,{className:"w-3 h-3"})]})]}),n.jsx("div",{className:"grid gap-3",children:d.map(Y=>{const C=Y.type==="shopping_order",P=(()=>{try{const S=new Date(Y.createdAt);return isNaN(S.getTime())?"":S.toLocaleString("ar-EG",{hour:"numeric",minute:"numeric"})}catch{return""}})(),U=C?"bg-[#2a1b2e]":"bg-[#1a1a1a]",O=C?"border-purple-500/30":"border-yellow-500/20",D=C?"bg-purple-500/20":"bg-yellow-500/10",F=C?"shadow-purple-900/10":"shadow-yellow-900/10";return n.jsxs("div",{className:`group relative p-0.5 rounded-2xl shadow-lg hover:${F} transition-all duration-300 ${C?"bg-gradient-to-br from-purple-900/40 to-[#252525]":"bg-gradient-to-br from-[#1e1e1e] to-[#252525]"}`,children:[n.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${C?"from-purple-500/20":"from-yellow-500/20"} to-transparent opacity-0 group-hover:opacity-100 transition-opacity rounded-2xl pointer-events-none`}),n.jsxs("div",{className:`relative ${U} rounded-[14px] p-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 h-full border ${O}`,children:[n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center text-2xl shadow-inner border border-white/5 flex-shrink-0 ${D}`,children:C?n.jsx(bd,{className:"w-6 h-6 text-purple-400 animate-pulse"}):""}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("span",{className:`font-bold text-lg ${C?"text-purple-300":"text-white"}`,children:C?"  ":Y.merchantName}),n.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded font-mono tracking-wider border ${C?"bg-purple-500/10 text-purple-200 border-purple-500/20":"bg-yellow-500/10 text-yellow-200 border-yellow-500/20"}`,children:Y.id})]}),n.jsxs("p",{className:"text-gray-400 text-sm mt-1 flex items-center gap-1.5 leading-tight",children:[n.jsx(pn,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),Y.customer.address]}),C&&n.jsx("p",{className:"text-[10px] text-purple-400 mt-1 bg-purple-900/20 px-2 py-0.5 rounded inline-block",children:"    "})]})]}),n.jsxs("div",{className:"flex flex-row sm:flex-col items-center sm:items-end justify-between w-full sm:w-auto gap-3",children:[n.jsxs("div",{className:"text-xs font-bold text-gray-400 bg-black/40 px-3 py-1.5 rounded-lg flex items-center gap-1.5 border border-white/5",children:[n.jsx(xt,{className:"w-3.5 h-3.5"})," ",P]}),h&&n.jsx("button",{onClick:h,className:`${C?"bg-purple-600 hover:bg-purple-500 shadow-purple-500/20":"bg-yellow-500 hover:bg-yellow-400 shadow-yellow-500/20"} text-white text-xs font-bold px-5 py-2 rounded-lg shadow-lg transition-all active:scale-95 whitespace-nowrap`,children:" "})]})]})]},Y.id)})})]}),E.length>0&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("h2",{className:"text-lg font-bold text-blue-400 flex items-center gap-2",children:[n.jsx("span",{className:"w-2.5 h-2.5 bg-blue-400 rounded-full animate-pulse shadow-[0_0_10px_rgba(96,165,250,0.5)]"}),n.jsx(dt,{className:"w-5 h-5"}),"   (",E.length,")"]}),n.jsx("div",{className:"grid gap-3",children:E.map(Y=>n.jsxs("div",{className:"relative overflow-hidden bg-[#1a1a1a] rounded-2xl border border-blue-500/20 p-0.5 group shadow-lg",children:[n.jsx("div",{className:"absolute top-0 right-0 w-1.5 h-full bg-blue-500 z-10"}),n.jsx("div",{className:"absolute inset-0 bg-blue-500/5 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"}),n.jsxs("div",{className:"bg-[#1e1e1e] rounded-xl p-4 flex flex-col sm:flex-row items-center justify-between gap-4 relative z-0",children:[n.jsxs("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:[n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"w-14 h-14 rounded-full bg-gray-800 flex items-center justify-center overflow-hidden border-2 border-blue-500/30 shadow-md",children:n.jsx(dt,{className:"w-6 h-6 text-blue-400"})}),n.jsx("div",{className:"absolute -bottom-1 -right-1 bg-blue-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-md shadow-sm border border-[#1e1e1e]",children:$(Y.role)})]}),n.jsxs("div",{className:"text-right flex-1",children:[n.jsx("h3",{className:"font-bold text-white text-lg",children:Y.name}),n.jsx("p",{className:"text-gray-400 font-mono text-sm tracking-wide bg-black/20 inline-block px-2 rounded mt-1",children:Y.phone})]})]}),n.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[n.jsx("button",{onClick:()=>{T(),y(Y)},className:"flex-1 sm:flex-none px-4 py-2.5 bg-gray-700 hover:bg-gray-600 text-white rounded-xl text-sm font-bold transition-colors border border-gray-600",children:""}),n.jsxs("button",{onClick:()=>e(Y.id,{status:"active"}),className:"flex-1 sm:flex-none px-5 py-2.5 bg-green-600 hover:bg-green-500 text-white rounded-xl text-sm font-bold shadow-lg shadow-green-900/20 transition-all active:scale-95 flex items-center justify-center gap-1.5",children:[n.jsx(Xe,{className:"w-4 h-4"})," "]}),n.jsx("button",{onClick:()=>{T(),N(Y)},className:"px-3.5 py-2.5 bg-red-500/10 hover:bg-red-500/20 text-red-500 rounded-xl transition-colors border border-red-500/10",children:n.jsx(jt,{className:"w-5 h-5"})})]})]})]},Y.id))})]}),r.length>0&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("h2",{className:"text-lg font-bold text-red-400 flex items-center gap-2",children:[n.jsx("span",{className:"w-2.5 h-2.5 bg-red-400 rounded-full animate-pulse shadow-[0_0_10px_rgba(248,113,113,0.5)]"}),n.jsx(Jn,{className:"w-5 h-5"}),"    "]}),n.jsx("div",{className:"grid gap-3",children:r.map(Y=>{const C=s.find(P=>P.phone===Y.phone);return C?n.jsxs("div",{className:"bg-gradient-to-r from-red-900/20 to-[#1a1a1a] border border-red-500/30 p-4 rounded-2xl flex justify-between items-center shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"p-3 bg-red-500/10 rounded-full text-red-400 border border-red-500/20",children:n.jsx(Jn,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-bold text-white text-lg",children:C.name}),n.jsx("p",{className:"text-xs text-red-300 font-mono mt-0.5",children:C.phone})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>B(Y.phone),className:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg text-xs font-bold shadow-md shadow-red-900/20 transition-all active:scale-95",children:""}),n.jsx("button",{onClick:()=>i(Y.phone),className:"p-2 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-lg transition-colors border border-gray-700",children:n.jsx(jt,{className:"w-5 h-5"})})]})]},Y.phone):null})})]})]}),b&&n.jsx(Sv,{user:b,onClose:L,onApprove:(Y,C)=>{e(Y,C),L()},onDelete:Y=>{N(b)}}),v&&n.jsx(fs,{title:"   ",message:`       "${v.name}"    .`,onClose:()=>N(null),onConfirm:Q,confirmButtonText:"  ",confirmVariant:"danger",cancelButtonText:""})]}):n.jsxs("div",{className:"flex flex-col items-center justify-center text-center h-[calc(100vh-15rem)]",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-800/50 rounded-full flex items-center justify-center mb-6 shadow-inner animate-pulse ring-1 ring-white/10",children:n.jsx(Tn,{className:"w-12 h-12 text-gray-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-300",children:"  !"}),n.jsx("p",{className:"text-gray-500 mt-2",children:"     ."})]})},wg=({label:s,value:e,subValue:t,icon:r,colorClass:i})=>n.jsxs("div",{className:"bg-[#1e293b]/80 backdrop-blur-md rounded-2xl p-4 border border-gray-700/50 shadow-xl flex flex-col justify-between h-full relative overflow-hidden group",children:[n.jsx("div",{className:`absolute top-0 right-0 w-full h-1 ${i.replace("text-","bg-")}/50`}),n.jsxs("div",{className:"flex justify-between items-start mb-2",children:[n.jsx("span",{className:"text-xs text-gray-400 font-medium",children:s}),n.jsx("div",{className:`p-2 rounded-xl bg-gray-800/50 ${i}`,children:r})]}),n.jsxs("div",{children:[n.jsx("span",{className:`text-xl font-black ${i} tracking-tight`,children:e}),t&&n.jsx("span",{className:"text-[10px] text-gray-500 block mt-1",children:t})]})]}),hR=({driver:s,payments:e,orders:t,onBack:r,onDeletePayment:i,currentUser:l})=>{const d=E=>{const I=E.reconciledOrderIds.map(Q=>t.find(Z=>Z.id===Q)).filter(Q=>!!Q&&Q.status!==ce.Cancelled),T=I.length,L=I.reduce((Q,Z)=>Q+(Z.deliveryFee||0),0);let $=0;s.commissionType==="fixed"?$=T*(s.commissionRate||0):$=L*((s.commissionRate||0)/100),$>L&&($=L);const B=L-$;return{...E,verifiedCount:T,companyShare:$,driverShare:B,verifiedTotalCollected:L,verifiedAmount:E.amount,isValid:T>0}},h=w.useMemo(()=>e.filter(E=>E.driverId===s.id).map(d).filter(E=>E.isValid).sort((E,I)=>new Date(I.createdAt).getTime()-new Date(E.createdAt).getTime()),[e,s.id,t]),f=w.useMemo(()=>h.reduce((E,I)=>({totalCollected:E.totalCollected+I.verifiedTotalCollected,totalDriverShare:E.totalDriverShare+I.driverShare,totalCompanyShare:E.totalCompanyShare+I.companyShare,totalPaid:E.totalPaid+I.amount}),{totalCollected:0,totalDriverShare:0,totalCompanyShare:0,totalPaid:0}),[h]),[m,b]=Is.useState(!1),y=E=>{let I;return typeof E=="string"||typeof E=="number"?I=new Date(E):E!=null&&E.seconds?I=new Date(E.seconds*1e3):I=new Date(E),I.getHours()<6&&I.setDate(I.getDate()-1),I},[v,N]=Is.useState(null);return n.jsxs("div",{className:"fixed inset-0 bg-[#0f172a] z-50 animate-fadeIn flex flex-col font-sans",children:[n.jsx("div",{className:`
                fixed top-0 left-0 right-0 z-30 pt-safe transition-all duration-300
                bg-[#0f172a]/90 backdrop-blur-xl border-b border-gray-800
                ${m?"pb-3 shadow-lg":"pb-6"}
            `,children:n.jsx("div",{className:"max-w-5xl mx-auto px-4 w-full pt-4",children:n.jsxs("div",{className:"flex items-center justify-between gap-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("button",{onClick:r,className:"bg-gray-800 hover:bg-gray-700 text-gray-200 p-2.5 rounded-full border border-gray-700 transition-all active:scale-95",children:n.jsx(q3,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-white leading-tight",children:" "}),n.jsx("p",{className:"text-xs text-blue-400 font-bold mt-0.5",children:s.name})]})]}),n.jsxs("div",{className:"text-left",children:[n.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-wider font-bold",children:" "}),n.jsx("p",{className:"text-lg font-black text-white leading-none",children:h.length})]})]})})}),n.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar-hide",onScroll:E=>b(E.currentTarget.scrollTop>20),children:n.jsxs("div",{className:"max-w-5xl mx-auto px-4 pb-24 pt-[6.5rem]",children:[" ",n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6 animate-slide-up",style:{animationDelay:"0.1s"},children:[n.jsx(wg,{label:" ",value:`${f.totalCollected.toLocaleString("en-US")} .`,icon:n.jsx(eu,{className:"w-5 h-5"}),colorClass:"text-blue-400"}),n.jsx(wg,{label:" ",value:`${f.totalDriverShare.toLocaleString("en-US")} .`,subValue:"  ",icon:n.jsx(Ut,{className:"w-5 h-5"}),colorClass:"text-green-400"}),n.jsx(wg,{label:" ",value:`${f.totalCompanyShare.toLocaleString("en-US")} .`,subValue:" ",icon:n.jsx(Sy,{className:"w-5 h-5"}),colorClass:"text-red-400"}),n.jsx(wg,{label:" ",value:`${f.totalPaid.toLocaleString("en-US")} .`,subValue:"  ",icon:n.jsx(Xe,{className:"w-5 h-5"}),colorClass:"text-emerald-400"})]}),n.jsxs("div",{className:"space-y-4 animate-slide-up",style:{animationDelay:"0.2s"},children:[n.jsx("h3",{className:"text-sm font-bold text-gray-400 px-1 border-r-4 border-blue-500 mr-1",children:"  "}),h.length>0?h.map((E,I)=>{const T=y(E.createdAt);return n.jsxs("div",{className:"bg-[#1e293b] rounded-2xl p-0 border border-gray-700 hover:border-blue-500/30 transition-all duration-300 shadow-lg overflow-hidden group",children:[n.jsx("div",{className:"h-1 w-full bg-gradient-to-r from-green-500 via-blue-500 to-green-500 opacity-60"}),n.jsxs("div",{className:"p-4 md:p-5 flex flex-col md:flex-row gap-4 md:items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[n.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-900/20 flex items-center justify-center border border-blue-500/20 text-blue-400 shrink-0",children:n.jsx(Ba,{className:"w-6 h-6"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between md:justify-start gap-2 mb-1",children:[n.jsx("span",{className:"text-white font-bold text-lg",children:T.toLocaleDateString("ar-EG-u-nu-latn",{weekday:"long",day:"numeric",month:"short"})}),n.jsx("span",{className:"bg-gray-800 text-gray-400 text-[10px] px-2 py-0.5 rounded-full border border-gray-700 font-mono",children:new Date(E.createdAt).toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric"})})]}),n.jsxs("p",{className:"text-xs text-gray-500 font-mono tracking-wider",children:["ID: #",E.id.slice(-8).toUpperCase()]})]})]}),n.jsx("div",{className:"bg-black/20 rounded-xl border border-white/5 w-full md:w-auto",children:n.jsxs("div",{className:"grid grid-cols-3 md:flex md:items-center divide-x divide-x-reverse divide-gray-700/50 md:divide-x-0 md:gap-6 p-3",children:[n.jsxs("div",{className:"flex flex-col items-center md:items-start px-2 md:px-0",children:[n.jsx("span",{className:"text-[10px] text-gray-500 mb-0.5",children:""}),n.jsx("span",{className:"text-sm font-bold text-white",children:E.verifiedCount})]}),n.jsxs("div",{className:"flex flex-col items-center md:items-start px-2 md:px-0 md:border-r md:border-gray-700 md:pr-6",children:[n.jsx("span",{className:"text-[10px] text-green-500/70 mb-0.5",children:""}),n.jsx("span",{className:"text-sm font-bold text-green-400",children:Math.round(E.driverShare)})]}),n.jsxs("div",{className:"flex flex-col items-center md:items-start px-2 md:px-0 md:border-r md:border-gray-700 md:pr-6",children:[n.jsx("span",{className:"text-[10px] text-red-500/70 mb-0.5",children:""}),n.jsx("span",{className:"text-sm font-bold text-red-400",children:Math.round(E.companyShare)})]})]})}),n.jsxs("div",{className:"flex items-center justify-between gap-4 w-full md:w-auto pt-3 md:pt-0 border-t md:border-t-0 border-gray-800/50",children:[n.jsx("span",{className:"md:hidden text-xs text-gray-500",children:" "}),n.jsxs("div",{className:"flex items-center gap-4 flex-1 md:flex-none justify-end",children:[n.jsxs("span",{className:"text-xl font-black text-white",children:[E.amount.toLocaleString("en-US")," ",n.jsx("span",{className:"text-xs font-medium text-gray-500",children:"."})]}),(l==null?void 0:l.role)==="admin"&&n.jsx("button",{onClick:()=>N(E.id),className:"p-2 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-600 hover:text-white transition-all border border-red-500/20",title:" ",children:n.jsx(rt,{className:"w-5 h-5"})})]})]})]})]},E.id)}):n.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-[#1e293b]/50 rounded-3xl border border-dashed border-gray-700",children:[n.jsx(Sy,{className:"w-16 h-16 text-gray-600 mb-4 opacity-50"}),n.jsx("h3",{className:"text-lg font-bold text-gray-300",children:"   "}),n.jsx("p",{className:"text-sm text-gray-500",children:"       ."})]})]})]})}),v&&n.jsx("div",{className:"fixed inset-0 z-[60] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>N(null),children:n.jsx("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-red-500/30 shadow-2xl p-6 transform scale-100 animate-pop-in",onClick:E=>E.stopPropagation(),children:n.jsxs("div",{className:"flex flex-col items-center text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mb-4 ring-1 ring-red-500/30",children:n.jsx(rt,{className:"w-8 h-8 text-red-500"})}),n.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),n.jsxs("p",{className:"text-sm text-gray-400 mb-6 leading-relaxed",children:["        ",n.jsx("br",{}),n.jsx("span",{className:"text-red-400 font-bold",children:":"}),"          ."]}),n.jsxs("div",{className:"flex gap-3 w-full",children:[n.jsx("button",{className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white font-bold py-3.5 rounded-xl transition-all",onClick:()=>N(null),children:""}),n.jsx("button",{className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-3.5 rounded-xl shadow-lg shadow-red-900/20 transition-all",onClick:()=>{i&&v&&i(v),N(null)},children:" "})]})]})})})]})},Vb=({label:s,value:e,currency:t=".",colorClass:r="text-white"})=>n.jsxs("div",{className:"flex justify-between items-baseline bg-gray-700/50 p-3 rounded-lg border border-gray-600/50",children:[n.jsx("span",{className:"text-sm font-medium text-gray-400",children:s}),n.jsxs("span",{className:`text-lg font-bold ${r}`,children:[e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})," ",t]})]}),fR=({status:s,mode:e,onChange:t})=>{if(e==="always_open")return n.jsxs("div",{className:"flex items-center gap-2 bg-blue-500/10 border border-blue-500/20 px-3 py-2 rounded-lg w-full justify-center",children:[n.jsx(xt,{className:"w-4 h-4 text-blue-400"}),n.jsx("span",{className:"text-xs font-bold text-blue-300",children:"  "})]});const r=s==="active";return n.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-xs text-gray-400 font-medium",children:" "}),n.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded ${r?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:r?" ":""})]}),n.jsx("button",{onClick:t,className:`
                    relative group w-full py-2 px-1 rounded-lg flex items-center justify-center gap-2 transition-all duration-300 border
                    ${r?"bg-green-600 hover:bg-green-700 border-green-500 text-white shadow-lg shadow-green-900/20":"bg-[#1a1a1a] hover:bg-[#222] border-gray-600 text-gray-400 hover:text-white"}
                `,children:r?n.jsxs(n.Fragment,{children:[n.jsx(Xe,{className:"w-4 h-4"}),n.jsx("span",{className:"text-xs font-bold",children:" "})]}):n.jsxs(n.Fragment,{children:[n.jsx(rt,{className:"w-4 h-4"}),n.jsx("span",{className:"text-xs font-bold",children:"  -  "})]})})]})},gS=({orders:s,users:e,payments:t,updateUser:r,handleDriverPayment:i,onDeletePayment:l,currentUser:d})=>{const[h,f]=w.useState(null),[m,b]=w.useState(null),[y,v]=w.useState(!1),[N,E]=w.useState(!1),I=e.filter(B=>B.role==="driver"),T=B=>{try{window.history.pushState({view:"wallet",modal:B},"",window.location.pathname)}catch{}},L=()=>{var B;f(null),b(null),(B=window.history.state)!=null&&B.modal&&window.history.back()};if(w.useEffect(()=>{const B=Q=>{var Z;(Z=Q.state)!=null&&Z.modal||(f(null),b(null))};return window.addEventListener("popstate",B),()=>window.removeEventListener("popstate",B)},[]),I.length===0)return n.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 h-[calc(100vh-15rem)]",children:[n.jsx(vv,{className:"w-16 h-16 text-gray-600 mb-4"}),n.jsx("h3",{className:"text-xl font-semibold",children:"   "}),n.jsx("p",{className:"text-gray-400",children:"    ."})]});const $=()=>{var B;if(m){const Q=m.driver.id;b(null),((B=window.history.state)==null?void 0:B.modal)==="pay"&&window.history.back(),i(Q),v(!0),setTimeout(()=>v(!1),2e3)}};return Wt(()=>N?(E(!1),f(null),!0):m?(L(),!0):y?(v(!1),!0):!1,[N,m,y]),n.jsxs(n.Fragment,{children:[N&&h&&n.jsx("div",{className:"fixed inset-0 z-[100] bg-gray-900",children:n.jsx(hR,{driver:h,payments:t,orders:s,onBack:()=>{E(!1),f(null)},onDeletePayment:l,currentUser:d})}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 pb-32",children:I.map(B=>{const Q=s.filter(ae=>ae.driverId===B.id&&ae.status===ce.Delivered&&ae.status!==ce.Cancelled&&!ae.reconciled&&!ae.isArchived),Z=Q.reduce((ae,K)=>ae+(K.deliveryFee||0),0),Y=B.commissionRate||0;let C=0;B.commissionType==="fixed"?C=Q.length*Y:C=Z*(Y/100);const P=Z-C,U=B.commissionType==="fixed"?`${Y} ./`:`${Y}%`,O=()=>{const ae=B.dailyLogStatus==="active"?"closed":"active",K={dailyLogStatus:ae};ae==="active"&&(K.dailyLogStartedAt=new Date),r(B.id,K)},F=B.dailyLogStatus==="active"||B.dailyLogMode==="always_open"?"border-l-4 border-l-green-500":"border-l-4 border-l-red-500",S=s.some(ae=>String(ae.driverId)===String(B.id)&&ae.status!==ce.Delivered&&ae.status!==ce.Cancelled&&!ae.isArchived);return n.jsxs("div",{className:`bg-gray-800 rounded-xl shadow-lg flex flex-col overflow-hidden transition-all duration-300 ${F}`,children:[n.jsx("div",{className:"p-5 pb-0 flex justify-between items-start",children:n.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[n.jsx("div",{className:"w-12 h-12 bg-gray-700 rounded-full flex items-center justify-center overflow-hidden border border-gray-600",children:B.storeImage?n.jsx("img",{src:B.storeImage,className:"w-full h-full object-cover",alt:"Avatar"}):n.jsx(dt,{className:"w-6 h-6 text-gray-300"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-lg text-white",children:B.name}),n.jsxs("p",{className:"text-xs text-blue-300 font-mono tracking-widest font-bold",children:["#",B.id.slice(-6)]})]})]})}),n.jsxs("div",{className:"p-5 space-y-4",children:[n.jsx("div",{className:"bg-black/20 p-3 rounded-xl border border-white/5",children:n.jsx(fR,{status:B.dailyLogStatus||"closed",mode:B.dailyLogMode||"12_hour",onChange:O})}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between items-center mb-1",children:[n.jsx("h4",{className:"text-xs font-bold text-gray-400",children:"  ( )"}),n.jsxs("span",{className:"text-[10px] bg-gray-700 px-2 py-0.5 rounded text-gray-300",children:[Q.length," "]})]}),n.jsx(Vb,{label:" ",value:Z,colorClass:"text-blue-400"}),n.jsx(Vb,{label:`  (${U})`,value:C,colorClass:"text-red-400"}),n.jsx(Vb,{label:" ",value:P,colorClass:"text-green-400"})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 border-t border-gray-700",children:[n.jsxs("button",{onClick:()=>{f(B),E(!0)},className:"flex items-center text-xs font-bold text-gray-400 hover:text-white transition-colors",children:[n.jsx(Sy,{className:"w-4 h-4 ml-1.5"})," "]}),S?n.jsxs("div",{className:"flex items-center text-xs bg-red-900/40 text-red-400 font-bold px-4 py-2.5 rounded-lg border border-red-900/50 cursor-not-allowed w-auto text-center",title:"      ",children:[n.jsx(xt,{className:"w-4 h-4 ml-2 animate-pulse"}),"  "]}):n.jsx("button",{onClick:()=>{T("pay"),b({driver:B,amount:C})},disabled:Q.length===0,className:"flex items-center text-xs bg-green-600 text-white hover:bg-green-700 font-bold px-4 py-2.5 rounded-lg transition-colors disabled:bg-gray-700 disabled:text-gray-500 disabled:cursor-not-allowed shadow-md",children:" "})]})]},B.id)})}),m&&n.jsx(fs,{title:"  ",message:`    ${m.amount.toLocaleString("en-US",{minimumFractionDigits:2})} .   ${m.driver.name}       .`,onClose:L,onConfirm:$,confirmButtonText:" ",confirmVariant:"success"}),y&&n.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-6 bg-black/60 backdrop-blur-[2px] animate-fadeIn",style:{touchAction:"none"},onClick:()=>v(!1),children:n.jsxs("div",{className:"w-full max-w-xs bg-[#1e293b] rounded-2xl border border-gray-700 shadow-2xl p-6 text-center transform scale-100 animate-pop-in relative overflow-hidden",onClick:B=>B.stopPropagation(),children:[n.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-green-500 via-emerald-500 to-green-500"}),n.jsx("div",{className:"flex justify-center mb-4",children:n.jsx("div",{className:"p-3 rounded-full bg-[#0f172a] border border-gray-700 shadow-inner",children:n.jsx(Xe,{className:"w-10 h-10 text-green-500 animate-pulse"})})}),n.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),n.jsx("p",{className:"text-gray-400 text-sm",children:"     ."})]})})]})},pS=({users:s,onSendMessage:e,messages:t=[],deleteMessage:r})=>{const[i,l]=w.useState("driver"),[d,h]=w.useState([]),[f,m]=w.useState(""),[b,y]=w.useState(""),[v,N]=w.useState(null),[E,I]=w.useState(null),[T,L]=w.useState(""),[$,B]=w.useState(null),Q=k=>{try{window.history.pushState({view:"messages",modal:k},"",window.location.pathname)}catch{}},Z=()=>{var k;(k=window.history.state)!=null&&k.modal?window.history.back():B(null)};w.useEffect(()=>{const k=q=>{var W;(W=q.state)!=null&&W.modal||B(null)};return window.addEventListener("popstate",k),()=>window.removeEventListener("popstate",k)},[]);const Y=w.useMemo(()=>s.filter(k=>k.role===i),[s,i]),C=w.useMemo(()=>f?Y.filter(k=>k.name.toLowerCase().includes(f.toLowerCase())||k.phone&&k.phone.includes(f)):Y,[Y,f]);w.useEffect(()=>{h([]),m("")},[i]);const P=()=>{d.length===C.length&&C.length>0?h([]):h(C.map(k=>k.id))},U=k=>{h(q=>q.includes(k)?q.filter(W=>W!==k):[...q,k])},O=w.useMemo(()=>[...t].sort((k,q)=>new Date(q.createdAt).getTime()-new Date(k.createdAt).getTime()),[t]),D=k=>{var W;const q=(W=k.target.files)==null?void 0:W[0];if(q){const ne=new FileReader;ne.onloadend=()=>{N(ne.result),I(URL.createObjectURL(q))},ne.readAsDataURL(q)}else N(null),I(null)},F=()=>{if(d.length===0){L("     .");return}if(!b.trim()){L("   .");return}e({text:b,image:v||void 0,targetRole:i,targetIds:d}),y(""),N(null),I(null),h([]),L("")},S=()=>{$&&r&&r($),Z()},ae=k=>{if(k.targetId==="all"||k.targetId==="multiple")return k.targetRole==="driver"?"  ":k.targetRole==="merchant"?"  ":"  ";const q=s.find(W=>W.id===k.targetId);return q?` ${q.name}`:"  "},K=({checked:k})=>k?n.jsx("div",{className:"bg-red-600 text-white rounded p-0.5",children:n.jsx(V3,{className:"w-5 h-5"})}):n.jsx("div",{className:"text-gray-500",children:n.jsx(U3,{className:"w-5 h-5"})});return n.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 pb-32",children:[n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[n.jsx("div",{className:"lg:col-span-1 space-y-6",children:n.jsxs("div",{className:"bg-gray-800 rounded-2xl shadow-xl border border-gray-700 overflow-hidden sticky top-6",children:[n.jsxs("div",{className:"p-5 border-b border-gray-700 bg-gray-900/50 flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-red-600 rounded-lg shadow-lg shadow-red-900/20",children:n.jsx(Dr,{className:"w-5 h-5 text-white"})}),n.jsx("h2",{className:"text-lg font-bold text-white",children:" "})]}),n.jsxs("div",{className:"p-5 space-y-5",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:" "}),n.jsx("div",{className:"grid grid-cols-3 gap-2 bg-gray-900 p-1.5 rounded-xl border border-gray-700",children:[{id:"driver",label:""},{id:"merchant",label:""},{id:"customer",label:""}].map(k=>n.jsx("button",{onClick:()=>l(k.id),className:`py-2 text-xs font-bold rounded-lg transition-all duration-200 ${i===k.id?"bg-gray-700 text-white shadow-md":"text-gray-500 hover:text-gray-300 hover:bg-gray-800"}`,children:k.label},k.id))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:["  (",d.length,")"]}),n.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-xl overflow-hidden",children:[n.jsxs("div",{className:"p-2 border-b border-gray-700 flex items-center gap-2",children:[n.jsxs("button",{onClick:P,className:"p-2 hover:bg-gray-800 rounded-lg transition-colors flex items-center gap-2 text-xs font-bold text-gray-300",children:[n.jsx(K,{checked:d.length>0&&d.length===C.length}),""]}),n.jsx("div",{className:"h-6 w-px bg-gray-700 mx-1"}),n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(Ln,{className:"absolute right-2 top-2 w-4 h-4 text-gray-500"}),n.jsx("input",{type:"text",placeholder:"...",value:f,onChange:k=>m(k.target.value),className:"w-full bg-transparent border-none text-white text-xs py-2 pr-8 pl-2 focus:ring-0 placeholder-gray-600"})]})]}),n.jsx("div",{className:"max-h-48 overflow-y-auto p-1 custom-scrollbar",children:C.length>0?C.map(k=>n.jsx("div",{onClick:()=>U(k.id),className:`flex items-center justify-between p-2 rounded-lg cursor-pointer transition-colors ${d.includes(k.id)?"bg-red-900/20":"hover:bg-gray-800"}`,children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(K,{checked:d.includes(k.id)}),n.jsxs("div",{children:[n.jsx("p",{className:`text-xs font-bold ${d.includes(k.id)?"text-red-200":"text-gray-300"}`,children:k.name}),n.jsx("p",{className:"text-[10px] text-gray-500 font-mono",children:k.phone})]})]})},k.id)):n.jsx("p",{className:"text-center text-gray-500 py-4 text-xs",children:"  "})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:" "}),n.jsx("textarea",{rows:4,value:b,onChange:k=>y(k.target.value),className:"w-full px-4 py-3 bg-gray-900 border border-gray-700 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none text-white placeholder:text-gray-600 text-sm resize-none transition-all",placeholder:"  ..."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:"  ()"}),n.jsxs("label",{className:"flex items-center justify-center w-full px-4 py-3 bg-gray-900 border border-dashed border-gray-600 rounded-xl cursor-pointer hover:border-red-500 hover:bg-gray-900/80 transition-all group",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(gr,{className:"w-5 h-5 text-gray-500 group-hover:text-red-500 transition-colors"}),n.jsx("span",{className:"text-xs text-gray-500 group-hover:text-gray-300",children:"  "})]}),n.jsx("input",{type:"file",accept:"image/*",onChange:D,className:"hidden"})]})]}),E&&n.jsxs("div",{className:"relative rounded-xl overflow-hidden border border-gray-700 group",children:[n.jsx("img",{src:E,alt:"Preview",className:"w-full h-40 object-cover"}),n.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:n.jsx("button",{onClick:()=>{N(null),I(null)},className:"bg-red-600 text-white p-2 rounded-full shadow-lg hover:scale-110 transition-transform",children:n.jsx(rt,{className:"w-4 h-4"})})})]}),T&&n.jsx("p",{className:"text-red-400 text-xs font-bold text-center bg-red-900/10 p-2 rounded-lg border border-red-500/20",children:T}),n.jsxs("button",{onClick:F,className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-bold py-3.5 rounded-xl transition-all shadow-lg shadow-red-900/20 active:scale-95 flex items-center justify-center gap-2",children:[n.jsxs("span",{children:[" (",d.length,")"]}),n.jsx(Dr,{className:"w-4 h-4"})]})]})]})}),n.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[n.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2 pb-2 border-b border-gray-700",children:[n.jsx(xt,{className:"w-6 h-6 text-gray-500"}),"  ",n.jsx("span",{className:"text-xs bg-gray-800 text-gray-400 px-2 py-0.5 rounded-full border border-gray-700",children:O.length})]}),n.jsx("div",{className:"space-y-4",children:O.length===0?n.jsxs("div",{className:"text-center py-16 bg-gray-800/30 rounded-2xl border border-dashed border-gray-700",children:[n.jsx(Dr,{className:"w-16 h-16 mx-auto mb-4 text-gray-600 opacity-50"}),n.jsx("p",{className:"text-gray-500 font-medium",children:"   ."})]}):O.map(k=>{var q,W;return n.jsxs("div",{className:"bg-gray-800 p-5 rounded-2xl border border-gray-700 shadow-sm hover:border-gray-600 transition-all group relative overflow-hidden",children:[n.jsxs("div",{className:"flex justify-between items-start mb-3 relative z-10",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`p-2.5 rounded-full ${k.targetRole==="driver"?"bg-blue-900/20 text-blue-400":k.targetRole==="merchant"?"bg-purple-900/20 text-purple-400":"bg-green-900/20 text-green-400"}`,children:n.jsx(dt,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsxs("p",{className:"text-sm font-bold text-white flex items-center gap-2",children:[ae(k),n.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded border ${k.targetRole==="driver"?"bg-blue-500/10 border-blue-500/20 text-blue-300":k.targetRole==="merchant"?"bg-purple-500/10 border-purple-500/20 text-purple-300":"bg-green-500/10 border-green-500/20 text-green-300"}`,children:k.targetRole==="driver"?"":k.targetRole==="merchant"?"":""})]}),n.jsxs("p",{className:"text-xs text-gray-500 flex items-center mt-0.5",children:[n.jsx(xt,{className:"w-3 h-3 ml-1"}),new Date(k.createdAt).toLocaleString("ar-EG-u-nu-latn")]})]})]}),r&&n.jsx("button",{onClick:()=>{Q("deleteMessage"),B(k.id)},className:"text-gray-500 hover:text-red-400 p-2 hover:bg-red-500/10 rounded-lg transition-colors opacity-0 group-hover:opacity-100",title:" ",children:n.jsx(jt,{className:"w-4 h-4"})})]}),n.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-4 border border-gray-700/50 relative z-10",children:[k.image&&n.jsx("div",{className:"mb-3",children:n.jsx("img",{src:k.image,alt:"",className:"h-32 w-auto rounded-lg border border-gray-700 object-cover hover:scale-105 transition-transform cursor-pointer"})}),n.jsx("p",{className:"text-sm text-gray-200 leading-relaxed whitespace-pre-wrap font-medium",children:k.text})]}),n.jsx("div",{className:"mt-3 flex justify-end relative z-10",children:n.jsxs("span",{className:`text-xs font-bold flex items-center gap-1 bg-black/20 px-2 py-1 rounded-md border border-white/5 ${(q=k.readBy)!=null&&q.length?"text-green-400":"text-gray-500"}`,children:[n.jsx(Xe,{className:"w-3.5 h-3.5"}),(W=k.readBy)!=null&&W.length?`   ${k.readBy.length}`:"   "]})})]},k.id)})})]})]}),$&&n.jsx(fs,{title:" ",message:"        ",onClose:Z,onConfirm:S,confirmButtonText:" ",confirmVariant:"danger"})]})},mR=()=>{};var f_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xS=function(s){const e=[];let t=0;for(let r=0;r<s.length;r++){let i=s.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<s.length&&(s.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(s.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},gR=function(s){const e=[];let t=0,r=0;for(;t<s.length;){const i=s[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const l=s[t++];e[r++]=String.fromCharCode((i&31)<<6|l&63)}else if(i>239&&i<365){const l=s[t++],d=s[t++],h=s[t++],f=((i&7)<<18|(l&63)<<12|(d&63)<<6|h&63)-65536;e[r++]=String.fromCharCode(55296+(f>>10)),e[r++]=String.fromCharCode(56320+(f&1023))}else{const l=s[t++],d=s[t++];e[r++]=String.fromCharCode((i&15)<<12|(l&63)<<6|d&63)}}return e.join("")},bS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<s.length;i+=3){const l=s[i],d=i+1<s.length,h=d?s[i+1]:0,f=i+2<s.length,m=f?s[i+2]:0,b=l>>2,y=(l&3)<<4|h>>4;let v=(h&15)<<2|m>>6,N=m&63;f||(N=64,d||(v=64)),r.push(t[b],t[y],t[v],t[N])}return r.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(xS(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):gR(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<s.length;){const l=t[s.charAt(i++)],h=i<s.length?t[s.charAt(i)]:0;++i;const m=i<s.length?t[s.charAt(i)]:64;++i;const y=i<s.length?t[s.charAt(i)]:64;if(++i,l==null||h==null||m==null||y==null)throw new pR;const v=l<<2|h>>4;if(r.push(v),m!==64){const N=h<<4&240|m>>2;if(r.push(N),y!==64){const E=m<<6&192|y;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class pR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const xR=function(s){const e=xS(s);return bS.encodeByteArray(e,!0)},o0=function(s){return xR(s).replace(/\./g,"")},Ev=function(s){try{return bS.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function l0(s,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:s===void 0&&(s={});break;case Array:s=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!bR(t)||(s[t]=l0(s[t],e[t]));return s}function bR(s){return s!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yR=()=>Iv().__FIREBASE_DEFAULTS__,vR=()=>{if(typeof process>"u"||typeof f_>"u")return;const s=f_.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},wR=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&Ev(s[1]);return e&&JSON.parse(e)},Av=()=>{try{return mR()||yR()||vR()||wR()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},kv=()=>{var s;return(s=Av())==null?void 0:s.config},jR=s=>{var e;return(e=Av())==null?void 0:e[`_${s}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fo(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Cv(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yS(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=s.iat||0,l=s.sub||s.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...s};return[o0(JSON.stringify(t)),o0(JSON.stringify(d)),""].join(".")}const Vh={};function _R(){const s={prod:[],emulator:[]};for(const e of Object.keys(Vh))Vh[e]?s.emulator.push(e):s.prod.push(e);return s}function TR(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let m_=!1;function Rv(s,e){if(typeof window>"u"||typeof document>"u"||!Fo(window.location.host)||Vh[s]===e||Vh[s]||m_)return;Vh[s]=e;function t(v){return`__firebase__banner__${v}`}const r="__firebase__banner",l=_R().prod.length>0;function d(){const v=document.getElementById(r);v&&v.remove()}function h(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function f(v,N){v.setAttribute("width","24"),v.setAttribute("id",N),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function m(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{m_=!0,d()},v}function b(v,N){v.setAttribute("id",N),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function y(){const v=TR(r),N=t("text"),E=document.getElementById(N)||document.createElement("span"),I=t("learnmore"),T=document.getElementById(I)||document.createElement("a"),L=t("preprendIcon"),$=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const B=v.element;h(B),b(T,I);const Q=m();f($,L),B.append($,E,T,Q),document.body.appendChild(B)}l?(E.innerText="Preview backend disconnected.",$.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):($.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",N)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ms(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function SR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ms())}function $0(){var e;const s=(e=Av())==null?void 0:e.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ER(){return typeof window<"u"||vS()}function vS(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function IR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function wS(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function Dv(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function jS(){const s=ms();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function NS(){return!$0()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _S(){return!$0()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function ql(){try{return typeof indexedDB=="object"}catch{return!1}}function AR(){return new Promise((s,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),s(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var l;e(((l=i.error)==null?void 0:l.message)||"")}}catch(t){e(t)}})}function kR(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CR="FirebaseError";class fn extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=CR,Object.setPrototypeOf(this,fn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ga.prototype.create)}}class Ga{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,l=this.errors[e],d=l?RR(l,r):"Error",h=`${this.serviceName}: ${d} (${i}).`;return new fn(i,h,r)}}function RR(s,e){return s.replace(DR,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const DR=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g_(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function OR(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function ko(s,e){if(s===e)return!0;const t=Object.keys(s),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const l=s[i],d=e[i];if(p_(l)&&p_(d)){if(!ko(l,d))return!1}else if(l!==d)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function p_(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(s){const e=[];for(const[t,r]of Object.entries(s))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function xd(s){const e={};return s.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,l]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(l)}}),e}function Ah(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function TS(s,e){const t=new PR(s,e);return t.subscribe.bind(t)}class PR{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");MR(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Ub),i.error===void 0&&(i.error=Ub),i.complete===void 0&&(i.complete=Ub);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function MR(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function Ub(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ge(s){return s&&s._delegate?s._delegate:s}class sn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _l="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LR{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new NR;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(UR(e))try{this.getOrInitializeService({instanceIdentifier:_l})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:i});r.resolve(l)}catch{}}}}clearInstance(e=_l){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=_l){return this.instances.has(e)}getOptions(e=_l){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[l,d]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(l);r===h&&d.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const l=this.instances.get(r);return l&&e(l,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:VR(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=_l){return this.component?this.component.multipleInstances?e:_l:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function VR(s){return s===_l?void 0:s}function UR(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new LR(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ov=[];var wt;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(wt||(wt={}));const ES={debug:wt.DEBUG,verbose:wt.VERBOSE,info:wt.INFO,warn:wt.WARN,error:wt.ERROR,silent:wt.SILENT},FR=wt.INFO,BR={[wt.DEBUG]:"log",[wt.VERBOSE]:"log",[wt.INFO]:"info",[wt.WARN]:"warn",[wt.ERROR]:"error"},zR=(s,e,...t)=>{if(e<s.logLevel)return;const r=new Date().toISOString(),i=BR[e];if(i)console[i](`[${r}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class q0{constructor(e){this.name=e,this._logLevel=FR,this._logHandler=zR,this._userLogHandler=null,Ov.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in wt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ES[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,wt.DEBUG,...e),this._logHandler(this,wt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,wt.VERBOSE,...e),this._logHandler(this,wt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,wt.INFO,...e),this._logHandler(this,wt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,wt.WARN,...e),this._logHandler(this,wt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,wt.ERROR,...e),this._logHandler(this,wt.ERROR,...e)}}function $R(s){Ov.forEach(e=>{e.setLogLevel(s)})}function qR(s,e){for(const t of Ov){let r=null;e&&e.level&&(r=ES[e.level]),s===null?t.userLogHandler=null:t.userLogHandler=(i,l,...d)=>{const h=d.map(f=>{if(f==null)return null;if(typeof f=="string")return f;if(typeof f=="number"||typeof f=="boolean")return f.toString();if(f instanceof Error)return f.message;try{return JSON.stringify(f)}catch{return null}}).filter(f=>f).join(" ");l>=(r??i.logLevel)&&s({level:wt[l].toLowerCase(),message:h,args:d,type:i.name})}}}const HR=(s,e)=>e.some(t=>s instanceof t);let x_,b_;function GR(){return x_||(x_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function WR(){return b_||(b_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const IS=new WeakMap,Iy=new WeakMap,AS=new WeakMap,Fb=new WeakMap,Pv=new WeakMap;function KR(s){const e=new Promise((t,r)=>{const i=()=>{s.removeEventListener("success",l),s.removeEventListener("error",d)},l=()=>{t(bi(s.result)),i()},d=()=>{r(s.error),i()};s.addEventListener("success",l),s.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&IS.set(t,s)}).catch(()=>{}),Pv.set(e,s),e}function QR(s){if(Iy.has(s))return;const e=new Promise((t,r)=>{const i=()=>{s.removeEventListener("complete",l),s.removeEventListener("error",d),s.removeEventListener("abort",d)},l=()=>{t(),i()},d=()=>{r(s.error||new DOMException("AbortError","AbortError")),i()};s.addEventListener("complete",l),s.addEventListener("error",d),s.addEventListener("abort",d)});Iy.set(s,e)}let Ay={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return Iy.get(s);if(e==="objectStoreNames")return s.objectStoreNames||AS.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return bi(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function YR(s){Ay=s(Ay)}function XR(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=s.call(Bb(this),e,...t);return AS.set(r,e.sort?e.sort():[e]),bi(r)}:WR().includes(s)?function(...e){return s.apply(Bb(this),e),bi(IS.get(this))}:function(...e){return bi(s.apply(Bb(this),e))}}function JR(s){return typeof s=="function"?XR(s):(s instanceof IDBTransaction&&QR(s),HR(s,GR())?new Proxy(s,Ay):s)}function bi(s){if(s instanceof IDBRequest)return KR(s);if(Fb.has(s))return Fb.get(s);const e=JR(s);return e!==s&&(Fb.set(s,e),Pv.set(e,s)),e}const Bb=s=>Pv.get(s);function su(s,e,{blocked:t,upgrade:r,blocking:i,terminated:l}={}){const d=indexedDB.open(s,e),h=bi(d);return r&&d.addEventListener("upgradeneeded",f=>{r(bi(d.result),f.oldVersion,f.newVersion,bi(d.transaction),f)}),t&&d.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),h.then(f=>{l&&f.addEventListener("close",()=>l()),i&&f.addEventListener("versionchange",m=>i(m.oldVersion,m.newVersion,m))}).catch(()=>{}),h}function vd(s,{blocked:e}={}){const t=indexedDB.deleteDatabase(s);return e&&t.addEventListener("blocked",r=>e(r.oldVersion,r)),bi(t).then(()=>{})}const ZR=["get","getKey","getAll","getAllKeys","count"],eD=["put","add","delete","clear"],zb=new Map;function y_(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(zb.get(e))return zb.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=eD.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||ZR.includes(t)))return;const l=async function(d,...h){const f=this.transaction(d,i?"readwrite":"readonly");let m=f.store;return r&&(m=m.index(h.shift())),(await Promise.all([m[t](...h),i&&f.done]))[0]};return zb.set(e,l),l}YR(s=>({...s,get:(e,t,r)=>y_(e,t)||s.get(e,t,r),has:(e,t)=>!!y_(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(sD(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function sD(s){const e=s.getComponent();return(e==null?void 0:e.type)==="VERSION"}const c0="@firebase/app",ky="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ji=new q0("@firebase/app"),nD="@firebase/app-compat",rD="@firebase/analytics-compat",aD="@firebase/analytics",iD="@firebase/app-check-compat",oD="@firebase/app-check",lD="@firebase/auth",cD="@firebase/auth-compat",dD="@firebase/database",uD="@firebase/data-connect",hD="@firebase/database-compat",fD="@firebase/functions",mD="@firebase/functions-compat",gD="@firebase/installations",pD="@firebase/installations-compat",xD="@firebase/messaging",bD="@firebase/messaging-compat",yD="@firebase/performance",vD="@firebase/performance-compat",wD="@firebase/remote-config",jD="@firebase/remote-config-compat",ND="@firebase/storage",_D="@firebase/storage-compat",TD="@firebase/firestore",SD="@firebase/ai",ED="@firebase/firestore-compat",ID="firebase",AD="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Co="[DEFAULT]",kD={[c0]:"fire-core",[nD]:"fire-core-compat",[aD]:"fire-analytics",[rD]:"fire-analytics-compat",[oD]:"fire-app-check",[iD]:"fire-app-check-compat",[lD]:"fire-auth",[cD]:"fire-auth-compat",[dD]:"fire-rtdb",[uD]:"fire-data-connect",[hD]:"fire-rtdb-compat",[fD]:"fire-fn",[mD]:"fire-fn-compat",[gD]:"fire-iid",[pD]:"fire-iid-compat",[xD]:"fire-fcm",[bD]:"fire-fcm-compat",[yD]:"fire-perf",[vD]:"fire-perf-compat",[wD]:"fire-rc",[jD]:"fire-rc-compat",[ND]:"fire-gcs",[_D]:"fire-gcs-compat",[TD]:"fire-fst",[ED]:"fire-fst-compat",[SD]:"fire-vertex","fire-js":"fire-js",[ID]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ro=new Map,kd=new Map,Cd=new Map;function sf(s,e){try{s.container.addComponent(e)}catch(t){ji.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function kS(s,e){s.container.addOrOverwriteComponent(e)}function Zn(s){const e=s.name;if(Cd.has(e))return ji.debug(`There were multiple attempts to register component ${e}.`),!1;Cd.set(e,s);for(const t of Ro.values())sf(t,s);for(const t of kd.values())sf(t,s);return!0}function H0(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function CD(s,e,t=Co){H0(s,e).clearInstance(t)}function Mv(s){return s.options!==void 0}function CS(s){return Mv(s)?!1:"authIdToken"in s||"appCheckToken"in s||"releaseOnDeref"in s||"automaticDataCollectionEnabled"in s}function as(s){return s==null?!1:s.settings!==void 0}function RD(){Cd.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},mr=new Ga("app","Firebase",DD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let RS=class{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new sn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw mr.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v_(s,e){const t=Ev(s.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const i=JSON.parse(t).exp*1e3,l=new Date().getTime();i-l<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class OD extends RS{constructor(e,t,r,i){const l=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,d={name:r,automaticDataCollectionEnabled:l};if(e.apiKey!==void 0)super(e,d,i);else{const h=e;super(h.options,d,i)}this._serverConfig={automaticDataCollectionEnabled:l,...t},this._serverConfig.authIdToken&&v_(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&v_(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,mn(c0,ky,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Vv(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw mr.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ei=AD;function Lv(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const r={name:Co,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw mr.create("bad-app-name",{appName:String(i)});if(t||(t=kv()),!t)throw mr.create("no-options");const l=Ro.get(i);if(l){if(ko(t,l.options)&&ko(r,l.config))return l;throw mr.create("duplicate-app",{appName:i})}const d=new SS(i);for(const f of Cd.values())d.addComponent(f);const h=new RS(t,r,d);return Ro.set(i,h),h}function PD(s,e={}){if(ER()&&!vS())throw mr.create("invalid-server-app-environment");let t,r=e||{};if(s&&(Mv(s)?t=s.options:CS(s)?r=s:t=s),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),t||(t=kv()),!t)throw mr.create("no-options");const i={...r,...t};i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;const l=b=>[...b].reduce((y,v)=>Math.imul(31,y)+v.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw mr.create("finalization-registry-not-supported",{});const d=""+l(JSON.stringify(i)),h=kd.get(d);if(h)return h.incRefCount(r.releaseOnDeref),h;const f=new SS(d);for(const b of Cd.values())f.addComponent(b);const m=new OD(t,r,d,f);return kd.set(d,m),m}function MD(s=Co){const e=Ro.get(s);if(!e&&s===Co&&kv())return Lv();if(!e)throw mr.create("no-app",{appName:s});return e}function LD(){return Array.from(Ro.values())}async function Vv(s){let e=!1;const t=s.name;Ro.has(t)?(e=!0,Ro.delete(t)):kd.has(t)&&s.decRefCount()<=0&&(kd.delete(t),e=!0),e&&(await Promise.all(s.container.getProviders().map(r=>r.delete())),s.isDeleted=!0)}function mn(s,e,t){let r=kD[s]??s;t&&(r+=`-${t}`);const i=r.match(/\s|\//),l=e.match(/\s|\//);if(i||l){const d=[`Unable to register library "${r}" with version "${e}":`];i&&d.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&l&&d.push("and"),l&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ji.warn(d.join(" "));return}Zn(new sn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function DS(s,e){if(s!==null&&typeof s!="function")throw mr.create("invalid-log-argument");qR(s,e)}function OS(s){$R(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD="firebase-heartbeat-database",UD=1,nf="firebase-heartbeat-store";let $b=null;function PS(){return $b||($b=su(VD,UD,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(nf)}catch(t){console.warn(t)}}}}).catch(s=>{throw mr.create("idb-open",{originalErrorMessage:s.message})})),$b}async function FD(s){try{const t=(await PS()).transaction(nf),r=await t.objectStore(nf).get(MS(s));return await t.done,r}catch(e){if(e instanceof fn)ji.warn(e.message);else{const t=mr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ji.warn(t.message)}}}async function w_(s,e){try{const r=(await PS()).transaction(nf,"readwrite");await r.objectStore(nf).put(e,MS(s)),await r.done}catch(t){if(t instanceof fn)ji.warn(t.message);else{const r=mr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ji.warn(r.message)}}}function MS(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BD=1024,zD=30;class $D{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new HD(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=j_();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(d=>d.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:i}),this._heartbeatsCache.heartbeats.length>zD){const d=GD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ji.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=j_(),{heartbeatsToSend:r,unsentEntries:i}=qD(this._heartbeatsCache.heartbeats),l=o0(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return ji.warn(t),""}}}function j_(){return new Date().toISOString().substring(0,10)}function qD(s,e=BD){const t=[];let r=s.slice();for(const i of s){const l=t.find(d=>d.agent===i.agent);if(l){if(l.dates.push(i.date),N_(t)>e){l.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),N_(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class HD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ql()?AR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await FD(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return w_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return w_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function N_(s){return o0(JSON.stringify({version:2,heartbeats:s})).length}function GD(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let r=1;r<s.length;r++)s[r].date<t&&(t=s[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WD(s){Zn(new sn("platform-logger",e=>new tD(e),"PRIVATE")),Zn(new sn("heartbeat",e=>new $D(e),"PRIVATE")),mn(c0,ky,s),mn(c0,ky,"esm2020"),mn("fire-js","")}WD("");const KD=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:fn,SDK_VERSION:Ei,_DEFAULT_ENTRY_NAME:Co,_addComponent:sf,_addOrOverwriteComponent:kS,_apps:Ro,_clearComponents:RD,_components:Cd,_getProvider:H0,_isFirebaseApp:Mv,_isFirebaseServerApp:as,_isFirebaseServerAppSettings:CS,_registerComponent:Zn,_removeServiceInstance:CD,_serverApps:kd,deleteApp:Vv,getApp:MD,getApps:LD,initializeApp:Lv,initializeServerApp:PD,onLog:DS,registerVersion:mn,setLogLevel:OS},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(e,t){this._delegate=e,this.firebase=t,sf(e,new sn("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Vv(this._delegate)))}_getService(e,t=Co){var i;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((i=r.getComponent())==null?void 0:i.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=Co){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){sf(this._delegate,e)}_addOrOverwriteComponent(e){kS(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},__=new Ga("app-compat","Firebase",YD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XD(s){const e={},t={__esModule:!0,initializeApp:l,app:i,registerVersion:mn,setLogLevel:OS,onLog:DS,apps:null,SDK_VERSION:Ei,INTERNAL:{registerComponent:h,removeApp:r,useAsService:f,modularAPIs:KD}};t.default=t,Object.defineProperty(t,"apps",{get:d});function r(m){delete e[m]}function i(m){if(m=m||Co,!g_(e,m))throw __.create("no-app",{appName:m});return e[m]}i.App=s;function l(m,b={}){const y=Lv(m,b);if(g_(e,y.name))return e[y.name];const v=new s(y,t);return e[y.name]=v,v}function d(){return Object.keys(e).map(m=>e[m])}function h(m){const b=m.name,y=b.replace("-compat","");if(Zn(m)&&m.type==="PUBLIC"){const v=(N=i())=>{if(typeof N[y]!="function")throw __.create("invalid-app-argument",{appName:b});return N[y]()};m.serviceProps!==void 0&&l0(v,m.serviceProps),t[y]=v,s.prototype[y]=function(...N){return this._getService.bind(this,b).apply(this,m.multipleInstances?N:[])}}return m.type==="PUBLIC"?t[y]:null}function f(m,b){return b==="serverAuth"?null:b}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LS(){const s=XD(QD);s.INTERNAL={...s.INTERNAL,createFirebaseNamespace:LS,extendNamespace:e,createSubscribe:TS,ErrorFactory:Ga,deepExtend:l0};function e(t){l0(s,t)}return s}const JD=LS();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T_=new q0("@firebase/app-compat"),ZD="@firebase/app-compat",e6="0.5.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t6(s){mn(ZD,e6,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const s=Iv();if(s.firebase!==void 0){T_.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=s.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&T_.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const Mt=JD;t6();var s6="firebase",n6="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mt.registerVersion(s6,n6,"app-compat");var S_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _o,VS;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,P){function U(){}U.prototype=P.prototype,C.F=P.prototype,C.prototype=new U,C.prototype.constructor=C,C.D=function(O,D,F){for(var S=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)S[ae-2]=arguments[ae];return P.prototype[D].apply(O,S)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,P,U){U||(U=0);const O=Array(16);if(typeof P=="string")for(var D=0;D<16;++D)O[D]=P.charCodeAt(U++)|P.charCodeAt(U++)<<8|P.charCodeAt(U++)<<16|P.charCodeAt(U++)<<24;else for(D=0;D<16;++D)O[D]=P[U++]|P[U++]<<8|P[U++]<<16|P[U++]<<24;P=C.g[0],U=C.g[1],D=C.g[2];let F=C.g[3],S;S=P+(F^U&(D^F))+O[0]+3614090360&4294967295,P=U+(S<<7&4294967295|S>>>25),S=F+(D^P&(U^D))+O[1]+3905402710&4294967295,F=P+(S<<12&4294967295|S>>>20),S=D+(U^F&(P^U))+O[2]+606105819&4294967295,D=F+(S<<17&4294967295|S>>>15),S=U+(P^D&(F^P))+O[3]+3250441966&4294967295,U=D+(S<<22&4294967295|S>>>10),S=P+(F^U&(D^F))+O[4]+4118548399&4294967295,P=U+(S<<7&4294967295|S>>>25),S=F+(D^P&(U^D))+O[5]+1200080426&4294967295,F=P+(S<<12&4294967295|S>>>20),S=D+(U^F&(P^U))+O[6]+2821735955&4294967295,D=F+(S<<17&4294967295|S>>>15),S=U+(P^D&(F^P))+O[7]+4249261313&4294967295,U=D+(S<<22&4294967295|S>>>10),S=P+(F^U&(D^F))+O[8]+1770035416&4294967295,P=U+(S<<7&4294967295|S>>>25),S=F+(D^P&(U^D))+O[9]+2336552879&4294967295,F=P+(S<<12&4294967295|S>>>20),S=D+(U^F&(P^U))+O[10]+4294925233&4294967295,D=F+(S<<17&4294967295|S>>>15),S=U+(P^D&(F^P))+O[11]+2304563134&4294967295,U=D+(S<<22&4294967295|S>>>10),S=P+(F^U&(D^F))+O[12]+1804603682&4294967295,P=U+(S<<7&4294967295|S>>>25),S=F+(D^P&(U^D))+O[13]+4254626195&4294967295,F=P+(S<<12&4294967295|S>>>20),S=D+(U^F&(P^U))+O[14]+2792965006&4294967295,D=F+(S<<17&4294967295|S>>>15),S=U+(P^D&(F^P))+O[15]+1236535329&4294967295,U=D+(S<<22&4294967295|S>>>10),S=P+(D^F&(U^D))+O[1]+4129170786&4294967295,P=U+(S<<5&4294967295|S>>>27),S=F+(U^D&(P^U))+O[6]+3225465664&4294967295,F=P+(S<<9&4294967295|S>>>23),S=D+(P^U&(F^P))+O[11]+643717713&4294967295,D=F+(S<<14&4294967295|S>>>18),S=U+(F^P&(D^F))+O[0]+3921069994&4294967295,U=D+(S<<20&4294967295|S>>>12),S=P+(D^F&(U^D))+O[5]+3593408605&4294967295,P=U+(S<<5&4294967295|S>>>27),S=F+(U^D&(P^U))+O[10]+38016083&4294967295,F=P+(S<<9&4294967295|S>>>23),S=D+(P^U&(F^P))+O[15]+3634488961&4294967295,D=F+(S<<14&4294967295|S>>>18),S=U+(F^P&(D^F))+O[4]+3889429448&4294967295,U=D+(S<<20&4294967295|S>>>12),S=P+(D^F&(U^D))+O[9]+568446438&4294967295,P=U+(S<<5&4294967295|S>>>27),S=F+(U^D&(P^U))+O[14]+3275163606&4294967295,F=P+(S<<9&4294967295|S>>>23),S=D+(P^U&(F^P))+O[3]+4107603335&4294967295,D=F+(S<<14&4294967295|S>>>18),S=U+(F^P&(D^F))+O[8]+1163531501&4294967295,U=D+(S<<20&4294967295|S>>>12),S=P+(D^F&(U^D))+O[13]+2850285829&4294967295,P=U+(S<<5&4294967295|S>>>27),S=F+(U^D&(P^U))+O[2]+4243563512&4294967295,F=P+(S<<9&4294967295|S>>>23),S=D+(P^U&(F^P))+O[7]+1735328473&4294967295,D=F+(S<<14&4294967295|S>>>18),S=U+(F^P&(D^F))+O[12]+2368359562&4294967295,U=D+(S<<20&4294967295|S>>>12),S=P+(U^D^F)+O[5]+4294588738&4294967295,P=U+(S<<4&4294967295|S>>>28),S=F+(P^U^D)+O[8]+2272392833&4294967295,F=P+(S<<11&4294967295|S>>>21),S=D+(F^P^U)+O[11]+1839030562&4294967295,D=F+(S<<16&4294967295|S>>>16),S=U+(D^F^P)+O[14]+4259657740&4294967295,U=D+(S<<23&4294967295|S>>>9),S=P+(U^D^F)+O[1]+2763975236&4294967295,P=U+(S<<4&4294967295|S>>>28),S=F+(P^U^D)+O[4]+1272893353&4294967295,F=P+(S<<11&4294967295|S>>>21),S=D+(F^P^U)+O[7]+4139469664&4294967295,D=F+(S<<16&4294967295|S>>>16),S=U+(D^F^P)+O[10]+3200236656&4294967295,U=D+(S<<23&4294967295|S>>>9),S=P+(U^D^F)+O[13]+681279174&4294967295,P=U+(S<<4&4294967295|S>>>28),S=F+(P^U^D)+O[0]+3936430074&4294967295,F=P+(S<<11&4294967295|S>>>21),S=D+(F^P^U)+O[3]+3572445317&4294967295,D=F+(S<<16&4294967295|S>>>16),S=U+(D^F^P)+O[6]+76029189&4294967295,U=D+(S<<23&4294967295|S>>>9),S=P+(U^D^F)+O[9]+3654602809&4294967295,P=U+(S<<4&4294967295|S>>>28),S=F+(P^U^D)+O[12]+3873151461&4294967295,F=P+(S<<11&4294967295|S>>>21),S=D+(F^P^U)+O[15]+530742520&4294967295,D=F+(S<<16&4294967295|S>>>16),S=U+(D^F^P)+O[2]+3299628645&4294967295,U=D+(S<<23&4294967295|S>>>9),S=P+(D^(U|~F))+O[0]+4096336452&4294967295,P=U+(S<<6&4294967295|S>>>26),S=F+(U^(P|~D))+O[7]+1126891415&4294967295,F=P+(S<<10&4294967295|S>>>22),S=D+(P^(F|~U))+O[14]+2878612391&4294967295,D=F+(S<<15&4294967295|S>>>17),S=U+(F^(D|~P))+O[5]+4237533241&4294967295,U=D+(S<<21&4294967295|S>>>11),S=P+(D^(U|~F))+O[12]+1700485571&4294967295,P=U+(S<<6&4294967295|S>>>26),S=F+(U^(P|~D))+O[3]+2399980690&4294967295,F=P+(S<<10&4294967295|S>>>22),S=D+(P^(F|~U))+O[10]+4293915773&4294967295,D=F+(S<<15&4294967295|S>>>17),S=U+(F^(D|~P))+O[1]+2240044497&4294967295,U=D+(S<<21&4294967295|S>>>11),S=P+(D^(U|~F))+O[8]+1873313359&4294967295,P=U+(S<<6&4294967295|S>>>26),S=F+(U^(P|~D))+O[15]+4264355552&4294967295,F=P+(S<<10&4294967295|S>>>22),S=D+(P^(F|~U))+O[6]+2734768916&4294967295,D=F+(S<<15&4294967295|S>>>17),S=U+(F^(D|~P))+O[13]+1309151649&4294967295,U=D+(S<<21&4294967295|S>>>11),S=P+(D^(U|~F))+O[4]+4149444226&4294967295,P=U+(S<<6&4294967295|S>>>26),S=F+(U^(P|~D))+O[11]+3174756917&4294967295,F=P+(S<<10&4294967295|S>>>22),S=D+(P^(F|~U))+O[2]+718787259&4294967295,D=F+(S<<15&4294967295|S>>>17),S=U+(F^(D|~P))+O[9]+3951481745&4294967295,C.g[0]=C.g[0]+P&4294967295,C.g[1]=C.g[1]+(D+(S<<21&4294967295|S>>>11))&4294967295,C.g[2]=C.g[2]+D&4294967295,C.g[3]=C.g[3]+F&4294967295}r.prototype.v=function(C,P){P===void 0&&(P=C.length);const U=P-this.blockSize,O=this.C;let D=this.h,F=0;for(;F<P;){if(D==0)for(;F<=U;)i(this,C,F),F+=this.blockSize;if(typeof C=="string"){for(;F<P;)if(O[D++]=C.charCodeAt(F++),D==this.blockSize){i(this,O),D=0;break}}else for(;F<P;)if(O[D++]=C[F++],D==this.blockSize){i(this,O),D=0;break}}this.h=D,this.o+=P},r.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var P=1;P<C.length-8;++P)C[P]=0;P=this.o*8;for(var U=C.length-8;U<C.length;++U)C[U]=P&255,P/=256;for(this.v(C),C=Array(16),P=0,U=0;U<4;++U)for(let O=0;O<32;O+=8)C[P++]=this.g[U]>>>O&255;return C};function l(C,P){var U=h;return Object.prototype.hasOwnProperty.call(U,C)?U[C]:U[C]=P(C)}function d(C,P){this.h=P;const U=[];let O=!0;for(let D=C.length-1;D>=0;D--){const F=C[D]|0;O&&F==P||(U[D]=F,O=!1)}this.g=U}var h={};function f(C){return-128<=C&&C<128?l(C,function(P){return new d([P|0],P<0?-1:0)}):new d([C|0],C<0?-1:0)}function m(C){if(isNaN(C)||!isFinite(C))return y;if(C<0)return T(m(-C));const P=[];let U=1;for(let O=0;C>=U;O++)P[O]=C/U|0,U*=4294967296;return new d(P,0)}function b(C,P){if(C.length==0)throw Error("number format error: empty string");if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(C.charAt(0)=="-")return T(b(C.substring(1),P));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const U=m(Math.pow(P,8));let O=y;for(let F=0;F<C.length;F+=8){var D=Math.min(8,C.length-F);const S=parseInt(C.substring(F,F+D),P);D<8?(D=m(Math.pow(P,D)),O=O.j(D).add(m(S))):(O=O.j(U),O=O.add(m(S)))}return O}var y=f(0),v=f(1),N=f(16777216);s=d.prototype,s.m=function(){if(I(this))return-T(this).m();let C=0,P=1;for(let U=0;U<this.g.length;U++){const O=this.i(U);C+=(O>=0?O:4294967296+O)*P,P*=4294967296}return C},s.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(E(this))return"0";if(I(this))return"-"+T(this).toString(C);const P=m(Math.pow(C,6));var U=this;let O="";for(;;){const D=Q(U,P).g;U=L(U,D.j(P));let F=((U.g.length>0?U.g[0]:U.h)>>>0).toString(C);if(U=D,E(U))return F+O;for(;F.length<6;)F="0"+F;O=F+O}},s.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function E(C){if(C.h!=0)return!1;for(let P=0;P<C.g.length;P++)if(C.g[P]!=0)return!1;return!0}function I(C){return C.h==-1}s.l=function(C){return C=L(this,C),I(C)?-1:E(C)?0:1};function T(C){const P=C.g.length,U=[];for(let O=0;O<P;O++)U[O]=~C.g[O];return new d(U,~C.h).add(v)}s.abs=function(){return I(this)?T(this):this},s.add=function(C){const P=Math.max(this.g.length,C.g.length),U=[];let O=0;for(let D=0;D<=P;D++){let F=O+(this.i(D)&65535)+(C.i(D)&65535),S=(F>>>16)+(this.i(D)>>>16)+(C.i(D)>>>16);O=S>>>16,F&=65535,S&=65535,U[D]=S<<16|F}return new d(U,U[U.length-1]&-2147483648?-1:0)};function L(C,P){return C.add(T(P))}s.j=function(C){if(E(this)||E(C))return y;if(I(this))return I(C)?T(this).j(T(C)):T(T(this).j(C));if(I(C))return T(this.j(T(C)));if(this.l(N)<0&&C.l(N)<0)return m(this.m()*C.m());const P=this.g.length+C.g.length,U=[];for(var O=0;O<2*P;O++)U[O]=0;for(O=0;O<this.g.length;O++)for(let D=0;D<C.g.length;D++){const F=this.i(O)>>>16,S=this.i(O)&65535,ae=C.i(D)>>>16,K=C.i(D)&65535;U[2*O+2*D]+=S*K,$(U,2*O+2*D),U[2*O+2*D+1]+=F*K,$(U,2*O+2*D+1),U[2*O+2*D+1]+=S*ae,$(U,2*O+2*D+1),U[2*O+2*D+2]+=F*ae,$(U,2*O+2*D+2)}for(C=0;C<P;C++)U[C]=U[2*C+1]<<16|U[2*C];for(C=P;C<2*P;C++)U[C]=0;return new d(U,0)};function $(C,P){for(;(C[P]&65535)!=C[P];)C[P+1]+=C[P]>>>16,C[P]&=65535,P++}function B(C,P){this.g=C,this.h=P}function Q(C,P){if(E(P))throw Error("division by zero");if(E(C))return new B(y,y);if(I(C))return P=Q(T(C),P),new B(T(P.g),T(P.h));if(I(P))return P=Q(C,T(P)),new B(T(P.g),P.h);if(C.g.length>30){if(I(C)||I(P))throw Error("slowDivide_ only works with positive integers.");for(var U=v,O=P;O.l(C)<=0;)U=Z(U),O=Z(O);var D=Y(U,1),F=Y(O,1);for(O=Y(O,2),U=Y(U,2);!E(O);){var S=F.add(O);S.l(C)<=0&&(D=D.add(U),F=S),O=Y(O,1),U=Y(U,1)}return P=L(C,D.j(P)),new B(D,P)}for(D=y;C.l(P)>=0;){for(U=Math.max(1,Math.floor(C.m()/P.m())),O=Math.ceil(Math.log(U)/Math.LN2),O=O<=48?1:Math.pow(2,O-48),F=m(U),S=F.j(P);I(S)||S.l(C)>0;)U-=O,F=m(U),S=F.j(P);E(F)&&(F=v),D=D.add(F),C=L(C,S)}return new B(D,C)}s.B=function(C){return Q(this,C).h},s.and=function(C){const P=Math.max(this.g.length,C.g.length),U=[];for(let O=0;O<P;O++)U[O]=this.i(O)&C.i(O);return new d(U,this.h&C.h)},s.or=function(C){const P=Math.max(this.g.length,C.g.length),U=[];for(let O=0;O<P;O++)U[O]=this.i(O)|C.i(O);return new d(U,this.h|C.h)},s.xor=function(C){const P=Math.max(this.g.length,C.g.length),U=[];for(let O=0;O<P;O++)U[O]=this.i(O)^C.i(O);return new d(U,this.h^C.h)};function Z(C){const P=C.g.length+1,U=[];for(let O=0;O<P;O++)U[O]=C.i(O)<<1|C.i(O-1)>>>31;return new d(U,C.h)}function Y(C,P){const U=P>>5;P%=32;const O=C.g.length-U,D=[];for(let F=0;F<O;F++)D[F]=P>0?C.i(F+U)>>>P|C.i(F+U+1)<<32-P:C.i(F+U);return new d(D,C.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,VS=r,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=m,d.fromString=b,_o=d}).apply(typeof S_<"u"?S_:typeof self<"u"?self:typeof window<"u"?window:{});var jg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var US,kh,FS,qg,Cy,BS,zS,$S;(function(){var s,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof jg=="object"&&jg];for(var j=0;j<g.length;++j){var A=g[j];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var r=t(this);function i(g,j){if(j)e:{var A=r;g=g.split(".");for(var G=0;G<g.length-1;G++){var de=g[G];if(!(de in A))break e;A=A[de]}g=g[g.length-1],G=A[g],j=j(G),j!=G&&j!=null&&e(A,g,{configurable:!0,writable:!0,value:j})}}i("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(g){return g||function(j){var A=[],G;for(G in j)Object.prototype.hasOwnProperty.call(j,G)&&A.push([G,j[G]]);return A}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},d=this||self;function h(g){var j=typeof g;return j=="object"&&g!=null||j=="function"}function f(g,j,A){return g.call.apply(g.bind,arguments)}function m(g,j,A){return m=f,m.apply(null,arguments)}function b(g,j){var A=Array.prototype.slice.call(arguments,1);return function(){var G=A.slice();return G.push.apply(G,arguments),g.apply(this,G)}}function y(g,j){function A(){}A.prototype=j.prototype,g.Z=j.prototype,g.prototype=new A,g.prototype.constructor=g,g.Ob=function(G,de,be){for(var Ve=Array(arguments.length-2),ut=2;ut<arguments.length;ut++)Ve[ut-2]=arguments[ut];return j.prototype[de].apply(G,Ve)}}var v=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function N(g){const j=g.length;if(j>0){const A=Array(j);for(let G=0;G<j;G++)A[G]=g[G];return A}return[]}function E(g,j){for(let G=1;G<arguments.length;G++){const de=arguments[G];var A=typeof de;if(A=A!="object"?A:de?Array.isArray(de)?"array":A:"null",A=="array"||A=="object"&&typeof de.length=="number"){A=g.length||0;const be=de.length||0;g.length=A+be;for(let Ve=0;Ve<be;Ve++)g[A+Ve]=de[Ve]}else g.push(de)}}class I{constructor(j,A){this.i=j,this.j=A,this.h=0,this.g=null}get(){let j;return this.h>0?(this.h--,j=this.g,this.g=j.next,j.next=null):j=this.i(),j}}function T(g){d.setTimeout(()=>{throw g},0)}function L(){var g=C;let j=null;return g.g&&(j=g.g,g.g=g.g.next,g.g||(g.h=null),j.next=null),j}class ${constructor(){this.h=this.g=null}add(j,A){const G=B.get();G.set(j,A),this.h?this.h.next=G:this.g=G,this.h=G}}var B=new I(()=>new Q,g=>g.reset());class Q{constructor(){this.next=this.g=this.h=null}set(j,A){this.h=j,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let Z,Y=!1,C=new $,P=()=>{const g=Promise.resolve(void 0);Z=()=>{g.then(U)}};function U(){for(var g;g=L();){try{g.h.call(g.g)}catch(A){T(A)}var j=B;j.j(g),j.h<100&&(j.h++,g.next=j.g,j.g=g)}Y=!1}function O(){this.u=this.u,this.C=this.C}O.prototype.u=!1,O.prototype.dispose=function(){this.u||(this.u=!0,this.N())},O.prototype[Symbol.dispose]=function(){this.dispose()},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(g,j){this.type=g,this.g=this.target=j,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var F=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var g=!1,j=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const A=()=>{};d.addEventListener("test",A,j),d.removeEventListener("test",A,j)}catch{}return g})();function S(g){return/^[\s\xa0]*$/.test(g)}function ae(g,j){D.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,j)}y(ae,D),ae.prototype.init=function(g,j){const A=this.type=g.type,G=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=j,j=g.relatedTarget,j||(A=="mouseover"?j=g.fromElement:A=="mouseout"&&(j=g.toElement)),this.relatedTarget=j,G?(this.clientX=G.clientX!==void 0?G.clientX:G.pageX,this.clientY=G.clientY!==void 0?G.clientY:G.pageY,this.screenX=G.screenX||0,this.screenY=G.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&ae.Z.h.call(this)},ae.prototype.h=function(){ae.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var K="closure_listenable_"+(Math.random()*1e6|0),k=0;function q(g,j,A,G,de){this.listener=g,this.proxy=null,this.src=j,this.type=A,this.capture=!!G,this.ha=de,this.key=++k,this.da=this.fa=!1}function W(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function ne(g,j,A){for(const G in g)j.call(A,g[G],G,g)}function M(g,j){for(const A in g)j.call(void 0,g[A],A,g)}function R(g){const j={};for(const A in g)j[A]=g[A];return j}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function X(g,j){let A,G;for(let de=1;de<arguments.length;de++){G=arguments[de];for(A in G)g[A]=G[A];for(let be=0;be<V.length;be++)A=V[be],Object.prototype.hasOwnProperty.call(G,A)&&(g[A]=G[A])}}function H(g){this.src=g,this.g={},this.h=0}H.prototype.add=function(g,j,A,G,de){const be=g.toString();g=this.g[be],g||(g=this.g[be]=[],this.h++);const Ve=J(g,j,G,de);return Ve>-1?(j=g[Ve],A||(j.fa=!1)):(j=new q(j,this.src,be,!!G,de),j.fa=A,g.push(j)),j};function se(g,j){const A=j.type;if(A in g.g){var G=g.g[A],de=Array.prototype.indexOf.call(G,j,void 0),be;(be=de>=0)&&Array.prototype.splice.call(G,de,1),be&&(W(j),g.g[A].length==0&&(delete g.g[A],g.h--))}}function J(g,j,A,G){for(let de=0;de<g.length;++de){const be=g[de];if(!be.da&&be.listener==j&&be.capture==!!A&&be.ha==G)return de}return-1}var oe="closure_lm_"+(Math.random()*1e6|0),je={};function ye(g,j,A,G,de){if(Array.isArray(j)){for(let be=0;be<j.length;be++)ye(g,j[be],A,G,de);return null}return A=ge(A),g&&g[K]?g.J(j,A,h(G)?!!G.capture:!1,de):Pe(g,j,A,!1,G,de)}function Pe(g,j,A,G,de,be){if(!j)throw Error("Invalid event type");const Ve=h(de)?!!de.capture:!!de;let ut=ke(g);if(ut||(g[oe]=ut=new H(g)),A=ut.add(j,A,G,Ve,be),A.proxy)return A;if(G=Fe(),A.proxy=G,G.src=g,G.listener=A,g.addEventListener)F||(de=Ve),de===void 0&&(de=!1),g.addEventListener(j.toString(),G,de);else if(g.attachEvent)g.attachEvent(We(j.toString()),G);else if(g.addListener&&g.removeListener)g.addListener(G);else throw Error("addEventListener and attachEvent are unavailable.");return A}function Fe(){function g(A){return j.call(g.src,g.listener,A)}const j=it;return g}function Re(g,j,A,G,de){if(Array.isArray(j))for(var be=0;be<j.length;be++)Re(g,j[be],A,G,de);else G=h(G)?!!G.capture:!!G,A=ge(A),g&&g[K]?(g=g.i,be=String(j).toString(),be in g.g&&(j=g.g[be],A=J(j,A,G,de),A>-1&&(W(j[A]),Array.prototype.splice.call(j,A,1),j.length==0&&(delete g.g[be],g.h--)))):g&&(g=ke(g))&&(j=g.g[j.toString()],g=-1,j&&(g=J(j,A,G,de)),(A=g>-1?j[g]:null)&&lt(A))}function lt(g){if(typeof g!="number"&&g&&!g.da){var j=g.src;if(j&&j[K])se(j.i,g);else{var A=g.type,G=g.proxy;j.removeEventListener?j.removeEventListener(A,G,g.capture):j.detachEvent?j.detachEvent(We(A),G):j.addListener&&j.removeListener&&j.removeListener(G),(A=ke(j))?(se(A,g),A.h==0&&(A.src=null,j[oe]=null)):W(g)}}}function We(g){return g in je?je[g]:je[g]="on"+g}function it(g,j){if(g.da)g=!0;else{j=new ae(j,this);const A=g.listener,G=g.ha||g.src;g.fa&&lt(g),g=A.call(G,j)}return g}function ke(g){return g=g[oe],g instanceof H?g:null}var et="__closure_events_fn_"+(Math.random()*1e9>>>0);function ge(g){return typeof g=="function"?g:(g[et]||(g[et]=function(j){return g.handleEvent(j)}),g[et])}function ee(){O.call(this),this.i=new H(this),this.M=this,this.G=null}y(ee,O),ee.prototype[K]=!0,ee.prototype.removeEventListener=function(g,j,A,G){Re(this,g,j,A,G)};function fe(g,j){var A,G=g.G;if(G)for(A=[];G;G=G.G)A.push(G);if(g=g.M,G=j.type||j,typeof j=="string")j=new D(j,g);else if(j instanceof D)j.target=j.target||g;else{var de=j;j=new D(G,g),X(j,de)}de=!0;let be,Ve;if(A)for(Ve=A.length-1;Ve>=0;Ve--)be=j.g=A[Ve],de=_e(be,G,!0,j)&&de;if(be=j.g=g,de=_e(be,G,!0,j)&&de,de=_e(be,G,!1,j)&&de,A)for(Ve=0;Ve<A.length;Ve++)be=j.g=A[Ve],de=_e(be,G,!1,j)&&de}ee.prototype.N=function(){if(ee.Z.N.call(this),this.i){var g=this.i;for(const j in g.g){const A=g.g[j];for(let G=0;G<A.length;G++)W(A[G]);delete g.g[j],g.h--}}this.G=null},ee.prototype.J=function(g,j,A,G){return this.i.add(String(g),j,!1,A,G)},ee.prototype.K=function(g,j,A,G){return this.i.add(String(g),j,!0,A,G)};function _e(g,j,A,G){if(j=g.i.g[String(j)],!j)return!0;j=j.concat();let de=!0;for(let be=0;be<j.length;++be){const Ve=j[be];if(Ve&&!Ve.da&&Ve.capture==A){const ut=Ve.listener,_s=Ve.ha||Ve.src;Ve.fa&&se(g.i,Ve),de=ut.call(_s,G)!==!1&&de}}return de&&!G.defaultPrevented}function Me(g,j){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=m(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(j)>2147483647?-1:d.setTimeout(g,j||0)}function st(g){g.g=Me(()=>{g.g=null,g.i&&(g.i=!1,st(g))},g.l);const j=g.h;g.h=null,g.m.apply(null,j)}class tt extends O{constructor(j,A){super(),this.m=j,this.l=A,this.h=null,this.i=!1,this.g=null}j(j){this.h=arguments,this.g?this.i=!0:st(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ie(g){O.call(this),this.h=g,this.g={}}y(Ie,O);var $e=[];function bt(g){ne(g.g,function(j,A){this.g.hasOwnProperty(A)&&lt(j)},g),g.g={}}Ie.prototype.N=function(){Ie.Z.N.call(this),bt(this)},Ie.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Lt=d.JSON.stringify,At=d.JSON.parse,os=class{stringify(g){return d.JSON.stringify(g,void 0)}parse(g){return d.JSON.parse(g,void 0)}};function nn(){}function Te(){}var we={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function De(){D.call(this,"d")}y(De,D);function pe(){D.call(this,"c")}y(pe,D);var Le={},qe=null;function Ze(){return qe=qe||new ee}Le.Ia="serverreachability";function pt(g){D.call(this,Le.Ia,g)}y(pt,D);function mt(g){const j=Ze();fe(j,new pt(j))}Le.STAT_EVENT="statevent";function Ns(g,j){D.call(this,Le.STAT_EVENT,g),this.stat=j}y(Ns,D);function Dt(g){const j=Ze();fe(j,new Ns(j,g))}Le.Ja="timingevent";function Cs(g,j){D.call(this,Le.Ja,g),this.size=j}y(Cs,D);function Un(g,j){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){g()},j)}function Fr(){this.g=!0}Fr.prototype.ua=function(){this.g=!1};function Op(g,j,A,G,de,be){g.info(function(){if(g.g)if(be){var Ve="",ut=be.split("&");for(let Ot=0;Ot<ut.length;Ot++){var _s=ut[Ot].split("=");if(_s.length>1){const ls=_s[0];_s=_s[1];const wr=ls.split("_");Ve=wr.length>=2&&wr[1]=="type"?Ve+(ls+"="+_s+"&"):Ve+(ls+"=redacted&")}}}else Ve=null;else Ve=be;return"XMLHTTP REQ ("+G+") [attempt "+de+"]: "+j+`
`+A+`
`+Ve})}function Xf(g,j,A,G,de,be,Ve){g.info(function(){return"XMLHTTP RESP ("+G+") [ attempt "+de+"]: "+j+`
`+A+`
`+be+" "+Ve})}function ia(g,j,A,G){g.info(function(){return"XMLHTTP TEXT ("+j+"): "+Pp(g,A)+(G?" "+G:"")})}function Ko(g,j){g.info(function(){return"TIMEOUT: "+j})}Fr.prototype.info=function(){};function Pp(g,j){if(!g.g)return j;if(!j)return null;try{const be=JSON.parse(j);if(be){for(g=0;g<be.length;g++)if(Array.isArray(be[g])){var A=be[g];if(!(A.length<2)){var G=A[1];if(Array.isArray(G)&&!(G.length<1)){var de=G[0];if(de!="noop"&&de!="stop"&&de!="close")for(let Ve=1;Ve<G.length;Ve++)G[Ve]=""}}}}return Lt(be)}catch{return j}}var Qo={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},gu={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},pu;function Yo(){}y(Yo,nn),Yo.prototype.g=function(){return new XMLHttpRequest},pu=new Yo;function Wa(g){return encodeURIComponent(String(g))}function Jf(g){var j=1;g=g.split(":");const A=[];for(;j>0&&g.length;)A.push(g.shift()),j--;return g.length&&A.push(g.join(":")),A}function Br(g,j,A,G){this.j=g,this.i=j,this.l=A,this.S=G||1,this.V=new Ie(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new zr}function zr(){this.i=null,this.g="",this.h=!1}var Rs={},Qs={};function oa(g,j,A){g.M=1,g.A=Xo(Os(j)),g.u=A,g.R=!0,gc(g,null)}function gc(g,j){g.F=Date.now(),la(g),g.B=Os(g.A);var A=g.B,G=g.S;Array.isArray(G)||(G=[String(G)]),yc(A.i,"t",G),g.C=0,A=g.j.L,g.h=new zr,g.g=fm(g.j,A?j:null,!g.u),g.P>0&&(g.O=new tt(m(g.Y,g,g.g),g.P)),j=g.V,A=g.g,G=g.ba;var de="readystatechange";Array.isArray(de)||(de&&($e[0]=de.toString()),de=$e);for(let be=0;be<de.length;be++){const Ve=ye(A,de[be],G||j.handleEvent,!1,j.h||j);if(!Ve)break;j.g[Ve.key]=Ve}j=g.J?R(g.J):{},g.u?(g.v||(g.v="POST"),j["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,j)):(g.v="GET",g.g.ea(g.B,g.v,null,j)),mt(),Op(g.i,g.v,g.B,g.l,g.S,g.u)}Br.prototype.ba=function(g){g=g.target;const j=this.O;j&&Hr(g)==3?j.j():this.Y(g)},Br.prototype.Y=function(g){try{if(g==this.g)e:{const ut=Hr(this.g),_s=this.g.ya(),Ot=this.g.ca();if(!(ut<3)&&(ut!=3||this.g&&(this.h.h||this.g.la()||rn(this.g)))){this.K||ut!=4||_s==7||(_s==8||Ot<=0?mt(3):mt(2)),ca(this);var j=this.g.ca();this.X=j;var A=Mp(this);if(this.o=j==200,Xf(this.i,this.v,this.B,this.l,this.S,ut,j),this.o){if(this.U&&!this.L){t:{if(this.g){var G,de=this.g;if((G=de.g?de.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(G)){var be=G;break t}}be=null}if(g=be)ia(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,da(this,g);else{this.o=!1,this.m=3,Dt(12),er(this),br(this);break e}}if(this.R){g=!0;let ls;for(;!this.K&&this.C<A.length;)if(ls=em(this,A),ls==Qs){ut==4&&(this.m=4,Dt(14),g=!1),ia(this.i,this.l,null,"[Incomplete Response]");break}else if(ls==Rs){this.m=4,Dt(15),ia(this.i,this.l,A,"[Invalid Chunk]"),g=!1;break}else ia(this.i,this.l,ls,null),da(this,ls);if(Zf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ut!=4||A.length!=0||this.h.h||(this.m=1,Dt(16),g=!1),this.o=this.o&&g,!g)ia(this.i,this.l,A,"[Invalid Chunked Response]"),er(this),br(this);else if(A.length>0&&!this.W){this.W=!0;var Ve=this.j;Ve.g==this&&Ve.aa&&!Ve.P&&(Ve.j.info("Great, no buffering proxy detected. Bytes received: "+A.length),Cu(Ve),Ve.P=!0,Dt(11))}}else ia(this.i,this.l,A,null),da(this,A);ut==4&&er(this),this.o&&!this.K&&(ut==4?cm(this.j,this):(this.o=!1,la(this)))}else Qa(this.g),j==400&&A.indexOf("Unknown SID")>0?(this.m=3,Dt(12)):(this.m=0,Dt(13)),er(this),br(this)}}}catch{}finally{}};function Mp(g){if(!Zf(g))return g.g.la();const j=rn(g.g);if(j==="")return"";let A="";const G=j.length,de=Hr(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return er(g),br(g),"";g.h.i=new d.TextDecoder}for(let be=0;be<G;be++)g.h.h=!0,A+=g.h.i.decode(j[be],{stream:!(de&&be==G-1)});return j.length=0,g.h.g+=A,g.C=0,g.h.g}function Zf(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function em(g,j){var A=g.C,G=j.indexOf(`
`,A);return G==-1?Qs:(A=Number(j.substring(A,G)),isNaN(A)?Rs:(G+=1,G+A>j.length?Qs:(j=j.slice(G,G+A),g.C=G+A,j)))}Br.prototype.cancel=function(){this.K=!0,er(this)};function la(g){g.T=Date.now()+g.H,pc(g,g.H)}function pc(g,j){if(g.D!=null)throw Error("WatchDog timer not null");g.D=Un(m(g.aa,g),j)}function ca(g){g.D&&(d.clearTimeout(g.D),g.D=null)}Br.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(Ko(this.i,this.B),this.M!=2&&(mt(),Dt(17)),er(this),this.m=2,br(this)):pc(this,this.T-g)};function br(g){g.j.I==0||g.K||cm(g.j,g)}function er(g){ca(g);var j=g.O;j&&typeof j.dispose=="function"&&j.dispose(),g.O=null,bt(g.V),g.g&&(j=g.g,g.g=null,j.abort(),j.dispose())}function da(g,j){try{var A=g.j;if(A.I!=0&&(A.g==g||ha(A.h,g))){if(!g.L&&ha(A.h,g)&&A.I==3){try{var G=A.Ba.g.parse(j)}catch{G=null}if(Array.isArray(G)&&G.length==3){var de=G;if(de[0]==0){e:if(!A.v){if(A.g)if(A.g.F+3e3<g.F)_c(A),zi(A);else break e;rl(A),Dt(18)}}else A.xa=de[1],0<A.xa-A.K&&de[2]<37500&&A.F&&A.A==0&&!A.C&&(A.C=Un(m(A.Va,A),6e3));ua(A.h)<=1&&A.ta&&(A.ta=void 0)}else ba(A,11)}else if((g.L||A.g==g)&&_c(A),!S(j))for(de=A.Ba.g.parse(j),j=0;j<de.length;j++){let Ot=de[j];const ls=Ot[0];if(!(ls<=A.K))if(A.K=ls,Ot=Ot[1],A.I==2)if(Ot[0]=="c"){A.M=Ot[1],A.ba=Ot[2];const wr=Ot[3];wr!=null&&(A.ka=wr,A.j.info("VER="+A.ka));const ya=Ot[4];ya!=null&&(A.za=ya,A.j.info("SVER="+A.za));const Gr=Ot[5];Gr!=null&&typeof Gr=="number"&&Gr>0&&(G=1.5*Gr,A.O=G,A.j.info("backChannelRequestTimeoutMs_="+G)),G=A;const Wr=g.g;if(Wr){const al=Wr.g?Wr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(al){var be=G.h;be.g||al.indexOf("spdy")==-1&&al.indexOf("quic")==-1&&al.indexOf("h2")==-1||(be.j=be.l,be.g=new Set,be.h&&(yu(be,be.h),be.h=null))}if(G.G){const Tc=Wr.g?Wr.g.getResponseHeader("X-HTTP-Session-Id"):null;Tc&&(G.wa=Tc,Bt(G.J,G.G,Tc))}}A.I=3,A.l&&A.l.ra(),A.aa&&(A.T=Date.now()-g.F,A.j.info("Handshake RTT: "+A.T+"ms")),G=A;var Ve=g;if(G.na=hm(G,G.L?G.ba:null,G.W),Ve.L){vu(G.h,Ve);var ut=Ve,_s=G.O;_s&&(ut.H=_s),ut.D&&(ca(ut),la(ut)),G.g=Ve}else om(G);A.i.length>0&&xa(A)}else Ot[0]!="stop"&&Ot[0]!="close"||ba(A,7);else A.I==3&&(Ot[0]=="stop"||Ot[0]=="close"?Ot[0]=="stop"?ba(A,7):Au(A):Ot[0]!="noop"&&A.l&&A.l.qa(Ot),A.A=0)}}mt(4)}catch{}}var Ds=class{constructor(g,j){this.g=g,this.map=j}};function xu(g){this.l=g||10,d.PerformanceNavigationTiming?(g=d.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function bu(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function ua(g){return g.h?1:g.g?g.g.size:0}function ha(g,j){return g.h?g.h==j:g.g?g.g.has(j):!1}function yu(g,j){g.g?g.g.add(j):g.h=j}function vu(g,j){g.h&&g.h==j?g.h=null:g.g&&g.g.has(j)&&g.g.delete(j)}xu.prototype.cancel=function(){if(this.i=wu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function wu(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let j=g.i;for(const A of g.g.values())j=j.concat(A.G);return j}return N(g.i)}var tm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function xc(g,j){if(g){g=g.split("&");for(let A=0;A<g.length;A++){const G=g[A].indexOf("=");let de,be=null;G>=0?(de=g[A].substring(0,G),be=g[A].substring(G+1)):de=g[A],j(de,be?decodeURIComponent(be.replace(/\+/g," ")):"")}}}function tr(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let j;g instanceof tr?(this.l=g.l,Ys(this,g.j),this.o=g.o,this.g=g.g,Pi(this,g.u),this.h=g.h,ju(this,am(g.i)),this.m=g.m):g&&(j=String(g).match(tm))?(this.l=!1,Ys(this,j[1]||"",!0),this.o=fa(j[2]||""),this.g=fa(j[3]||"",!0),Pi(this,j[4]),this.h=fa(j[5]||"",!0),ju(this,j[6]||"",!0),this.m=fa(j[7]||"")):(this.l=!1,this.i=new Li(null,this.l))}tr.prototype.toString=function(){const g=[];var j=this.j;j&&g.push(Jo(j,bc,!0),":");var A=this.g;return(A||j=="file")&&(g.push("//"),(j=this.o)&&g.push(Jo(j,bc,!0),"@"),g.push(Wa(A).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.u,A!=null&&g.push(":",String(A))),(A=this.h)&&(this.g&&A.charAt(0)!="/"&&g.push("/"),g.push(Jo(A,A.charAt(0)=="/"?Nu:sm,!0))),(A=this.i.toString())&&g.push("?",A),(A=this.m)&&g.push("#",Jo(A,nm)),g.join("")},tr.prototype.resolve=function(g){const j=Os(this);let A=!!g.j;A?Ys(j,g.j):A=!!g.o,A?j.o=g.o:A=!!g.g,A?j.g=g.g:A=g.u!=null;var G=g.h;if(A)Pi(j,g.u);else if(A=!!g.h){if(G.charAt(0)!="/")if(this.g&&!this.h)G="/"+G;else{var de=j.h.lastIndexOf("/");de!=-1&&(G=j.h.slice(0,de+1)+G)}if(de=G,de==".."||de==".")G="";else if(de.indexOf("./")!=-1||de.indexOf("/.")!=-1){G=de.lastIndexOf("/",0)==0,de=de.split("/");const be=[];for(let Ve=0;Ve<de.length;){const ut=de[Ve++];ut=="."?G&&Ve==de.length&&be.push(""):ut==".."?((be.length>1||be.length==1&&be[0]!="")&&be.pop(),G&&Ve==de.length&&be.push("")):(be.push(ut),G=!0)}G=be.join("/")}else G=de}return A?j.h=G:A=g.i.toString()!=="",A?ju(j,am(g.i)):A=!!g.m,A&&(j.m=g.m),j};function Os(g){return new tr(g)}function Ys(g,j,A){g.j=A?fa(j,!0):j,g.j&&(g.j=g.j.replace(/:$/,""))}function Pi(g,j){if(j){if(j=Number(j),isNaN(j)||j<0)throw Error("Bad port number "+j);g.u=j}else g.u=null}function ju(g,j,A){j instanceof Li?(g.i=j,vc(g.i,g.l)):(A||(j=Jo(j,Mi)),g.i=new Li(j,g.l))}function Bt(g,j,A){g.i.set(j,A)}function Xo(g){return Bt(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function fa(g,j){return g?j?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function Jo(g,j,A){return typeof g=="string"?(g=encodeURI(g).replace(j,Fn),A&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Fn(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var bc=/[#\/\?@]/g,sm=/[#\?:]/g,Nu=/[#\?]/g,Mi=/[#\?@]/g,nm=/#/g;function Li(g,j){this.h=this.g=null,this.i=g||null,this.j=!!j}function Bn(g){g.g||(g.g=new Map,g.h=0,g.i&&xc(g.i,function(j,A){g.add(decodeURIComponent(j.replace(/\+/g," ")),A)}))}s=Li.prototype,s.add=function(g,j){Bn(this),this.i=null,g=Vi(this,g);let A=this.g.get(g);return A||this.g.set(g,A=[]),A.push(j),this.h+=1,this};function rm(g,j){Bn(g),j=Vi(g,j),g.g.has(j)&&(g.i=null,g.h-=g.g.get(j).length,g.g.delete(j))}function _u(g,j){return Bn(g),j=Vi(g,j),g.g.has(j)}s.forEach=function(g,j){Bn(this),this.g.forEach(function(A,G){A.forEach(function(de){g.call(j,de,G,this)},this)},this)};function Tu(g,j){Bn(g);let A=[];if(typeof j=="string")_u(g,j)&&(A=A.concat(g.g.get(Vi(g,j))));else for(g=Array.from(g.g.values()),j=0;j<g.length;j++)A=A.concat(g[j]);return A}s.set=function(g,j){return Bn(this),this.i=null,g=Vi(this,g),_u(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[j]),this.h+=1,this},s.get=function(g,j){return g?(g=Tu(this,g),g.length>0?String(g[0]):j):j};function yc(g,j,A){rm(g,j),A.length>0&&(g.i=null,g.g.set(Vi(g,j),N(A)),g.h+=A.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],j=Array.from(this.g.keys());for(let G=0;G<j.length;G++){var A=j[G];const de=Wa(A);A=Tu(this,A);for(let be=0;be<A.length;be++){let Ve=de;A[be]!==""&&(Ve+="="+Wa(A[be])),g.push(Ve)}}return this.i=g.join("&")};function am(g){const j=new Li;return j.i=g.i,g.g&&(j.g=new Map(g.g),j.h=g.h),j}function Vi(g,j){return j=String(j),g.j&&(j=j.toLowerCase()),j}function vc(g,j){j&&!g.j&&(Bn(g),g.i=null,g.g.forEach(function(A,G){const de=G.toLowerCase();G!=de&&(rm(this,G),yc(this,de,A))},g)),g.j=j}function $r(g,j){const A=new Fr;if(d.Image){const G=new Image;G.onload=b(yr,A,"TestLoadImage: loaded",!0,j,G),G.onerror=b(yr,A,"TestLoadImage: error",!1,j,G),G.onabort=b(yr,A,"TestLoadImage: abort",!1,j,G),G.ontimeout=b(yr,A,"TestLoadImage: timeout",!1,j,G),d.setTimeout(function(){G.ontimeout&&G.ontimeout()},1e4),G.src=g}else j(!1)}function Su(g,j){const A=new Fr,G=new AbortController,de=setTimeout(()=>{G.abort(),yr(A,"TestPingServer: timeout",!1,j)},1e4);fetch(g,{signal:G.signal}).then(be=>{clearTimeout(de),be.ok?yr(A,"TestPingServer: ok",!0,j):yr(A,"TestPingServer: server error",!1,j)}).catch(()=>{clearTimeout(de),yr(A,"TestPingServer: error",!1,j)})}function yr(g,j,A,G,de){try{de&&(de.onload=null,de.onerror=null,de.onabort=null,de.ontimeout=null),G(A)}catch{}}function Ui(){this.g=new os}function ma(g){this.i=g.Sb||null,this.h=g.ab||!1}y(ma,nn),ma.prototype.g=function(){return new Zo(this.i,this.h)};function Zo(g,j){ee.call(this),this.H=g,this.o=j,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}y(Zo,ee),s=Zo.prototype,s.open=function(g,j){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=j,this.readyState=1,qr(this)},s.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const j={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(j.body=g),(this.H||d).fetch(new Request(this.D,j)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Fi(this)),this.readyState=0},s.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,qr(this)),this.g&&(this.readyState=3,qr(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;wc(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function wc(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}s.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var j=g.value?g.value:new Uint8Array(0);(j=this.B.decode(j,{stream:!g.done}))&&(this.response=this.responseText+=j)}g.done?Fi(this):qr(this),this.readyState==3&&wc(this)}},s.Oa=function(g){this.g&&(this.response=this.responseText=g,Fi(this))},s.Na=function(g){this.g&&(this.response=g,Fi(this))},s.ga=function(){this.g&&Fi(this)};function Fi(g){g.readyState=4,g.l=null,g.j=null,g.B=null,qr(g)}s.setRequestHeader=function(g,j){this.A.append(g,j)},s.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],j=this.h.entries();for(var A=j.next();!A.done;)A=A.value,g.push(A[0]+": "+A[1]),A=j.next();return g.join(`\r
`)};function qr(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(Zo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function vr(g){let j="";return ne(g,function(A,G){j+=G,j+=":",j+=A,j+=`\r
`}),j}function el(g,j,A){e:{for(G in A){var G=!1;break e}G=!0}G||(A=vr(A),typeof g=="string"?A!=null&&Wa(A):Bt(g,j,A))}function Kt(g){ee.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}y(Kt,ee);var ga=/^https?$/i,Eu=["POST","PUT"];s=Kt.prototype,s.Fa=function(g){this.H=g},s.ea=function(g,j,A,G){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);j=j?j.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():pu.g(),this.g.onreadystatechange=v(m(this.Ca,this));try{this.B=!0,this.g.open(j,String(g),!0),this.B=!1}catch(be){tl(this,be);return}if(g=A||"",A=new Map(this.headers),G)if(Object.getPrototypeOf(G)===Object.prototype)for(var de in G)A.set(de,G[de]);else if(typeof G.keys=="function"&&typeof G.get=="function")for(const be of G.keys())A.set(be,G.get(be));else throw Error("Unknown input type for opt_headers: "+String(G));G=Array.from(A.keys()).find(be=>be.toLowerCase()=="content-type"),de=d.FormData&&g instanceof d.FormData,!(Array.prototype.indexOf.call(Eu,j,void 0)>=0)||G||de||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[be,Ve]of A)this.g.setRequestHeader(be,Ve);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(be){tl(this,be)}};function tl(g,j){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=j,g.o=5,Iu(g),Ka(g)}function Iu(g){g.A||(g.A=!0,fe(g,"complete"),fe(g,"error"))}s.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,fe(this,"complete"),fe(this,"abort"),Ka(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ka(this,!0)),Kt.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?sl(this):this.Xa())},s.Xa=function(){sl(this)};function sl(g){if(g.h&&typeof l<"u"){if(g.v&&Hr(g)==4)setTimeout(g.Ca.bind(g),0);else if(fe(g,"readystatechange"),Hr(g)==4){g.h=!1;try{const be=g.ca();e:switch(be){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var j=!0;break e;default:j=!1}var A;if(!(A=j)){var G;if(G=be===0){let Ve=String(g.D).match(tm)[1]||null;!Ve&&d.self&&d.self.location&&(Ve=d.self.location.protocol.slice(0,-1)),G=!ga.test(Ve?Ve.toLowerCase():"")}A=G}if(A)fe(g,"complete"),fe(g,"success");else{g.o=6;try{var de=Hr(g)>2?g.g.statusText:""}catch{de=""}g.l=de+" ["+g.ca()+"]",Iu(g)}}finally{Ka(g)}}}}function Ka(g,j){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const A=g.g;g.g=null,j||fe(g,"ready");try{A.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function Hr(g){return g.g?g.g.readyState:0}s.ca=function(){try{return Hr(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(g){if(this.g){var j=this.g.responseText;return g&&j.indexOf(g)==0&&(j=j.substring(g.length)),At(j)}};function rn(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function Qa(g){const j={};g=(g.g&&Hr(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let G=0;G<g.length;G++){if(S(g[G]))continue;var A=Jf(g[G]);const de=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const be=j[de]||[];j[de]=be,be.push(A)}M(j,function(G){return G.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function pa(g,j,A){return A&&A.internalChannelParams&&A.internalChannelParams[g]||j}function Bi(g){this.za=0,this.i=[],this.j=new Fr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=pa("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=pa("baseRetryDelayMs",5e3,g),this.Za=pa("retryDelaySeedMs",1e4,g),this.Ta=pa("forwardChannelMaxRetries",2,g),this.va=pa("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new xu(g&&g.concurrentRequestLimit),this.Ba=new Ui,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=Bi.prototype,s.ka=8,s.I=1,s.connect=function(g,j,A,G){Dt(0),this.W=g,this.H=j||{},A&&G!==void 0&&(this.H.OSID=A,this.H.OAID=G),this.F=this.X,this.J=hm(this,null,this.W),xa(this)};function Au(g){if(jc(g),g.I==3){var j=g.V++,A=Os(g.J);if(Bt(A,"SID",g.M),Bt(A,"RID",j),Bt(A,"TYPE","terminate"),nl(g,A),j=new Br(g,g.j,j),j.M=2,j.A=Xo(Os(A)),A=!1,d.navigator&&d.navigator.sendBeacon)try{A=d.navigator.sendBeacon(j.A.toString(),"")}catch{}!A&&d.Image&&(new Image().src=j.A,A=!0),A||(j.g=fm(j.j,null),j.g.ea(j.A)),j.F=Date.now(),la(j)}um(g)}function zi(g){g.g&&(Cu(g),g.g.cancel(),g.g=null)}function jc(g){zi(g),g.v&&(d.clearTimeout(g.v),g.v=null),_c(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&d.clearTimeout(g.m),g.m=null)}function xa(g){if(!bu(g.h)&&!g.m){g.m=!0;var j=g.Ea;Z||P(),Y||(Z(),Y=!0),C.add(j,g),g.D=0}}function Nc(g,j){return ua(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=j.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=Un(m(g.Ea,g,j),dm(g,g.D)),g.D++,!0)}s.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const de=new Br(this,this.j,g);let be=this.o;if(this.U&&(be?(be=R(be),X(be,this.U)):be=this.U),this.u!==null||this.R||(de.J=be,be=null),this.S)e:{for(var j=0,A=0;A<this.i.length;A++){t:{var G=this.i[A];if("__data__"in G.map&&(G=G.map.__data__,typeof G=="string")){G=G.length;break t}G=void 0}if(G===void 0)break;if(j+=G,j>4096){j=A;break e}if(j===4096||A===this.i.length-1){j=A+1;break e}}j=1e3}else j=1e3;j=im(this,de,j),A=Os(this.J),Bt(A,"RID",g),Bt(A,"CVER",22),this.G&&Bt(A,"X-HTTP-Session-Id",this.G),nl(this,A),be&&(this.R?j="headers="+Wa(vr(be))+"&"+j:this.u&&el(A,this.u,be)),yu(this.h,de),this.Ra&&Bt(A,"TYPE","init"),this.S?(Bt(A,"$req",j),Bt(A,"SID","null"),de.U=!0,oa(de,A,null)):oa(de,A,j),this.I=2}}else this.I==3&&(g?ku(this,g):this.i.length==0||bu(this.h)||ku(this))};function ku(g,j){var A;j?A=j.l:A=g.V++;const G=Os(g.J);Bt(G,"SID",g.M),Bt(G,"RID",A),Bt(G,"AID",g.K),nl(g,G),g.u&&g.o&&el(G,g.u,g.o),A=new Br(g,g.j,A,g.D+1),g.u===null&&(A.J=g.o),j&&(g.i=j.G.concat(g.i)),j=im(g,A,1e3),A.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),yu(g.h,A),oa(A,G,j)}function nl(g,j){g.H&&ne(g.H,function(A,G){Bt(j,G,A)}),g.l&&ne({},function(A,G){Bt(j,G,A)})}function im(g,j,A){A=Math.min(g.i.length,A);const G=g.l?m(g.l.Ka,g.l,g):null;e:{var de=g.i;let ut=-1;for(;;){const _s=["count="+A];ut==-1?A>0?(ut=de[0].g,_s.push("ofs="+ut)):ut=0:_s.push("ofs="+ut);let Ot=!0;for(let ls=0;ls<A;ls++){var be=de[ls].g;const wr=de[ls].map;if(be-=ut,be<0)ut=Math.max(0,de[ls].g-100),Ot=!1;else try{be="req"+be+"_"||"";try{var Ve=wr instanceof Map?wr:Object.entries(wr);for(const[ya,Gr]of Ve){let Wr=Gr;h(Gr)&&(Wr=Lt(Gr)),_s.push(be+ya+"="+encodeURIComponent(Wr))}}catch(ya){throw _s.push(be+"type="+encodeURIComponent("_badmap")),ya}}catch{G&&G(wr)}}if(Ot){Ve=_s.join("&");break e}}Ve=void 0}return g=g.i.splice(0,A),j.G=g,Ve}function om(g){if(!g.g&&!g.v){g.Y=1;var j=g.Da;Z||P(),Y||(Z(),Y=!0),C.add(j,g),g.A=0}}function rl(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=Un(m(g.Da,g),dm(g,g.A)),g.A++,!0)}s.Da=function(){if(this.v=null,lm(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=Un(m(this.Wa,this),g)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Dt(10),zi(this),lm(this))};function Cu(g){g.B!=null&&(d.clearTimeout(g.B),g.B=null)}function lm(g){g.g=new Br(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var j=Os(g.na);Bt(j,"RID","rpc"),Bt(j,"SID",g.M),Bt(j,"AID",g.K),Bt(j,"CI",g.F?"0":"1"),!g.F&&g.ia&&Bt(j,"TO",g.ia),Bt(j,"TYPE","xmlhttp"),nl(g,j),g.u&&g.o&&el(j,g.u,g.o),g.O&&(g.g.H=g.O);var A=g.g;g=g.ba,A.M=1,A.A=Xo(Os(j)),A.u=null,A.R=!0,gc(A,g)}s.Va=function(){this.C!=null&&(this.C=null,zi(this),rl(this),Dt(19))};function _c(g){g.C!=null&&(d.clearTimeout(g.C),g.C=null)}function cm(g,j){var A=null;if(g.g==j){_c(g),Cu(g),g.g=null;var G=2}else if(ha(g.h,j))A=j.G,vu(g.h,j),G=1;else return;if(g.I!=0){if(j.o)if(G==1){A=j.u?j.u.length:0,j=Date.now()-j.F;var de=g.D;G=Ze(),fe(G,new Cs(G,A)),xa(g)}else om(g);else if(de=j.m,de==3||de==0&&j.X>0||!(G==1&&Nc(g,j)||G==2&&rl(g)))switch(A&&A.length>0&&(j=g.h,j.i=j.i.concat(A)),de){case 1:ba(g,5);break;case 4:ba(g,10);break;case 3:ba(g,6);break;default:ba(g,2)}}}function dm(g,j){let A=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(A*=2),A*j}function ba(g,j){if(g.j.info("Error code "+j),j==2){var A=m(g.bb,g),G=g.Ua;const de=!G;G=new tr(G||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Ys(G,"https"),Xo(G),de?$r(G.toString(),A):Su(G.toString(),A)}else Dt(2);g.I=0,g.l&&g.l.pa(j),um(g),jc(g)}s.bb=function(g){g?(this.j.info("Successfully pinged google.com"),Dt(2)):(this.j.info("Failed to ping google.com"),Dt(1))};function um(g){if(g.I=0,g.ja=[],g.l){const j=wu(g.h);(j.length!=0||g.i.length!=0)&&(E(g.ja,j),E(g.ja,g.i),g.h.i.length=0,N(g.i),g.i.length=0),g.l.oa()}}function hm(g,j,A){var G=A instanceof tr?Os(A):new tr(A);if(G.g!="")j&&(G.g=j+"."+G.g),Pi(G,G.u);else{var de=d.location;G=de.protocol,j=j?j+"."+de.hostname:de.hostname,de=+de.port;const be=new tr(null);G&&Ys(be,G),j&&(be.g=j),de&&Pi(be,de),A&&(be.h=A),G=be}return A=g.G,j=g.wa,A&&j&&Bt(G,A,j),Bt(G,"VER",g.ka),nl(g,G),G}function fm(g,j,A){if(j&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return j=g.Aa&&!g.ma?new Kt(new ma({ab:A})):new Kt(g.ma),j.Fa(g.L),j}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function mm(){}s=mm.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function $i(){}$i.prototype.g=function(g,j){return new In(g,j)};function In(g,j){ee.call(this),this.g=new Bi(j),this.l=g,this.h=j&&j.messageUrlParams||null,g=j&&j.messageHeaders||null,j&&j.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=j&&j.initMessageHeaders||null,j&&j.messageContentType&&(g?g["X-WebChannel-Content-Type"]=j.messageContentType:g={"X-WebChannel-Content-Type":j.messageContentType}),j&&j.sa&&(g?g["X-WebChannel-Client-Profile"]=j.sa:g={"X-WebChannel-Client-Profile":j.sa}),this.g.U=g,(g=j&&j.Qb)&&!S(g)&&(this.g.u=g),this.A=j&&j.supportsCrossDomainXhr||!1,this.v=j&&j.sendRawJson||!1,(j=j&&j.httpSessionIdParam)&&!S(j)&&(this.g.G=j,g=this.h,g!==null&&j in g&&(g=this.h,j in g&&delete g[j])),this.j=new Ya(this)}y(In,ee),In.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},In.prototype.close=function(){Au(this.g)},In.prototype.o=function(g){var j=this.g;if(typeof g=="string"){var A={};A.__data__=g,g=A}else this.v&&(A={},A.__data__=Lt(g),g=A);j.i.push(new Ds(j.Ya++,g)),j.I==3&&xa(j)},In.prototype.N=function(){this.g.l=null,delete this.j,Au(this.g),delete this.g,In.Z.N.call(this)};function gm(g){De.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var j=g.__sm__;if(j){e:{for(const A in j){g=A;break e}g=void 0}(this.i=g)&&(g=this.i,j=j!==null&&g in j?j[g]:void 0),this.data=j}else this.data=g}y(gm,De);function pm(){pe.call(this),this.status=1}y(pm,pe);function Ya(g){this.g=g}y(Ya,mm),Ya.prototype.ra=function(){fe(this.g,"a")},Ya.prototype.qa=function(g){fe(this.g,new gm(g))},Ya.prototype.pa=function(g){fe(this.g,new pm)},Ya.prototype.oa=function(){fe(this.g,"b")},$i.prototype.createWebChannel=$i.prototype.g,In.prototype.send=In.prototype.o,In.prototype.open=In.prototype.m,In.prototype.close=In.prototype.close,$S=function(){return new $i},zS=function(){return Ze()},BS=Le,Cy={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Qo.NO_ERROR=0,Qo.TIMEOUT=8,Qo.HTTP_ERROR=6,qg=Qo,gu.COMPLETE="complete",FS=gu,Te.EventType=we,we.OPEN="a",we.CLOSE="b",we.ERROR="c",we.MESSAGE="d",ee.prototype.listen=ee.prototype.J,kh=Te,Kt.prototype.listenOnce=Kt.prototype.K,Kt.prototype.getLastError=Kt.prototype.Ha,Kt.prototype.getLastErrorCode=Kt.prototype.ya,Kt.prototype.getStatus=Kt.prototype.ca,Kt.prototype.getResponseJson=Kt.prototype.La,Kt.prototype.getResponseText=Kt.prototype.la,Kt.prototype.send=Kt.prototype.ea,Kt.prototype.setWithCredentials=Kt.prototype.Fa,US=Kt}).apply(typeof jg<"u"?jg:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let en=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};en.UNAUTHENTICATED=new en(null),en.GOOGLE_CREDENTIALS=new en("google-credentials-uid"),en.FIRST_PARTY=new en("first-party-uid"),en.MOCK_USER=new en("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nu="12.8.0";function r6(s){nu=s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Do=new q0("@firebase/firestore");function hd(){return Do.logLevel}function a6(s){Do.setLogLevel(s)}function Ce(s,...e){if(Do.logLevel<=wt.DEBUG){const t=e.map(Uv);Do.debug(`Firestore (${nu}): ${s}`,...t)}}function Es(s,...e){if(Do.logLevel<=wt.ERROR){const t=e.map(Uv);Do.error(`Firestore (${nu}): ${s}`,...t)}}function za(s,...e){if(Do.logLevel<=wt.WARN){const t=e.map(Uv);Do.warn(`Firestore (${nu}): ${s}`,...t)}}function Uv(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ze(s,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,qS(s,r,t)}function qS(s,e,t){let r=`FIRESTORE (${nu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Es(r),new Error(r)}function Ke(s,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,s||qS(e,i,r)}function i6(s,e){s||ze(57014,e)}function Be(s,e){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ae extends fn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class o6{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(en.UNAUTHENTICATED)))}shutdown(){}}class l6{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class c6{constructor(e){this.t=e,this.currentUser=en.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ke(this.o===void 0,42304);let r=this.i;const i=f=>this.i!==r?(r=this.i,t(f)):Promise.resolve();let l=new gn;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new gn,e.enqueueRetryable((()=>i(this.currentUser)))};const d=()=>{const f=l;e.enqueueRetryable((async()=>{await f.promise,await i(this.currentUser)}))},h=f=>{Ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((f=>h(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?h(f):(Ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new gn)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ke(typeof r.accessToken=="string",31837,{l:r}),new HS(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ke(e===null||typeof e=="string",2055,{h:e}),new en(e)}}class d6{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=en.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class u6{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new d6(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(en.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class E_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class h6{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,as(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ke(this.o===void 0,3512);const r=l=>{l.error!=null&&Ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const d=l.token!==this.m;return this.m=l.token,Ce("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>r(l)))};const i=l=>{Ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>i(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?i(l):Ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new E_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ke(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new E_(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f6(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<s;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=f6(40);for(let l=0;l<i.length;++l)r.length<20&&i[l]<t&&(r+=e.charAt(i[l]%62))}return r}}function ot(s,e){return s<e?-1:s>e?1:0}function Ry(s,e){const t=Math.min(s.length,e.length);for(let r=0;r<t;r++){const i=s.charAt(r),l=e.charAt(r);if(i!==l)return qb(i)===qb(l)?ot(i,l):qb(i)?1:-1}return ot(s.length,e.length)}const m6=55296,g6=57343;function qb(s){const e=s.charCodeAt(0);return e>=m6&&e<=g6}function Rd(s,e,t){return s.length===e.length&&s.every(((r,i)=>t(r,e[i])))}function GS(s){return s+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I_="__name__";class Sa{constructor(e,t,r){t===void 0?t=0:t>e.length&&ze(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&ze(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Sa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Sa?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const l=Sa.compareSegments(e.get(i),t.get(i));if(l!==0)return l}return ot(e.length,t.length)}static compareSegments(e,t){const r=Sa.isNumericId(e),i=Sa.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Sa.extractNumericId(e).compare(Sa.extractNumericId(t)):Ry(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return _o.fromString(e.substring(4,e.length-2))}}class Nt extends Sa{construct(e,t,r){return new Nt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ae(xe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Nt(t)}static emptyPath(){return new Nt([])}}const p6=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class us extends Sa{construct(e,t,r){return new us(e,t,r)}static isValidIdentifier(e){return p6.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),us.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===I_}static keyField(){return new us([I_])}static fromServerFormat(e){const t=[];let r="",i=0;const l=()=>{if(r.length===0)throw new Ae(xe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let d=!1;for(;i<e.length;){const h=e[i];if(h==="\\"){if(i+1===e.length)throw new Ae(xe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[i+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new Ae(xe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,i+=2}else h==="`"?(d=!d,i++):h!=="."||d?(r+=h,i++):(l(),i++)}if(l(),d)throw new Ae(xe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new us(t)}static emptyPath(){return new us([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e){this.path=e}static fromPath(e){return new Ue(Nt.fromString(e))}static fromName(e){return new Ue(Nt.fromString(e).popFirst(5))}static empty(){return new Ue(Nt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Nt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Nt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ue(new Nt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bv(s,e,t){if(!t)throw new Ae(xe.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function WS(s,e,t,r){if(e===!0&&r===!0)throw new Ae(xe.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function A_(s){if(!Ue.isDocumentKey(s))throw new Ae(xe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function k_(s){if(Ue.isDocumentKey(s))throw new Ae(xe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function KS(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function G0(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":ze(12329,{type:typeof s})}function Rt(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new Ae(xe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=G0(s);throw new Ae(xe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function QS(s,e){if(e<=0)throw new Ae(xe.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bs(s,e){const t={typeString:s};return e&&(t.value=e),t}function Af(s,e){if(!KS(s))throw new Ae(xe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,l="value"in e[r]?{value:e[r].value}:void 0;if(!(r in s)){t=`JSON missing required field: '${r}'`;break}const d=s[r];if(i&&typeof d!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(l!==void 0&&d!==l.value){t=`Expected '${r}' field to equal '${l.value}'`;break}}if(t)throw new Ae(xe.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C_=-62135596800,R_=1e6;class Vt{static now(){return Vt.fromMillis(Date.now())}static fromDate(e){return Vt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*R_);return new Vt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ae(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ae(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<C_)throw new Ae(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ae(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/R_}_compareTo(e){return this.seconds===e.seconds?ot(this.nanoseconds,e.nanoseconds):ot(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Af(e,Vt._jsonSchema))return new Vt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-C_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Vt._jsonSchemaVersion="firestore/timestamp/1.0",Vt._jsonSchema={type:Bs("string",Vt._jsonSchemaVersion),seconds:Bs("number"),nanoseconds:Bs("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{static fromTimestamp(e){return new Ye(e)}static min(){return new Ye(new Vt(0,0))}static max(){return new Ye(new Vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dd=-1;class d0{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Dy(s){return s.fields.find((e=>e.kind===2))}function Tl(s){return s.fields.filter((e=>e.kind!==2))}d0.UNKNOWN_ID=-1;class Hg{constructor(e,t){this.fieldPath=e,this.kind=t}}class rf{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new rf(0,xr.min())}}function YS(s,e){const t=s.toTimestamp().seconds,r=s.toTimestamp().nanoseconds+1,i=Ye.fromTimestamp(r===1e9?new Vt(t+1,0):new Vt(t,r));return new xr(i,Ue.empty(),e)}function XS(s){return new xr(s.readTime,s.key,Dd)}class xr{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new xr(Ye.min(),Ue.empty(),Dd)}static max(){return new xr(Ye.max(),Ue.empty(),Dd)}}function zv(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=Ue.comparator(s.documentKey,e.documentKey),t!==0?t:ot(s.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ZS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bo(s){if(s.code!==xe.FAILED_PRECONDITION||s.message!==JS)throw s;Ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ze(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new le(((r,i)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(r,i)},this.catchCallback=l=>{this.wrapFailure(t,l).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof le?t:le.resolve(t)}catch(t){return le.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):le.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):le.reject(t)}static resolve(e){return new le(((t,r)=>{t(e)}))}static reject(e){return new le(((t,r)=>{r(e)}))}static waitFor(e){return new le(((t,r)=>{let i=0,l=0,d=!1;e.forEach((h=>{++i,h.next((()=>{++l,d&&l===i&&t()}),(f=>r(f)))})),d=!0,l===i&&t()}))}static or(e){let t=le.resolve(!1);for(const r of e)t=t.next((i=>i?le.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,l)=>{r.push(t.call(this,i,l))})),this.waitFor(r)}static mapArray(e,t){return new le(((r,i)=>{const l=e.length,d=new Array(l);let h=0;for(let f=0;f<l;f++){const m=f;t(e[m]).next((b=>{d[m]=b,++h,h===l&&r(d)}),(b=>i(b)))}}))}static doWhile(e,t){return new le(((r,i)=>{const l=()=>{e()===!0?t().next((()=>{l()}),i):r()};l()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dr="SimpleDb";class W0{static open(e,t,r,i){try{return new W0(t,e.transaction(i,r))}catch(l){throw new Uh(t,l)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new gn,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Uh(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=$v(r.target.error);this.S.reject(new Uh(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ce(dr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new b6(t)}}class La{static delete(e){return Ce(dr,"Removing database:",e),Il(Iv().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!ql())return!1;if(La.F())return!0;const e=ms(),t=La.M(e),r=0<t&&t<10,i=eE(e),l=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||l)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,La.M(ms())===12.2&&Es("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Ce(dr,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=l=>{const d=l.target.result;t(d)},i.onblocked=()=>{r(new Uh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=l=>{const d=l.target.error;d.name==="VersionError"?r(new Ae(xe.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):d.name==="InvalidStateError"?r(new Ae(xe.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+d)):r(new Uh(e,d))},i.onupgradeneeded=l=>{Ce(dr,'Database "'+this.name+'" requires upgrade from version:',l.oldVersion);const d=l.target.result;this.N.k(d,i.transaction,l.oldVersion,this.version).next((()=>{Ce(dr,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const l=t==="readonly";let d=0;for(;;){++d;try{this.db=await this.L(e);const h=W0.open(this.db,e,l?"readonly":"readwrite",r),f=i(h).next((m=>(h.C(),m))).catch((m=>(h.abort(m),le.reject(m)))).toPromise();return f.catch((()=>{})),await h.D,f}catch(h){const f=h,m=f.name!=="FirebaseError"&&d<3;if(Ce(dr,"Transaction failed with error:",f.message,"Retrying:",m),this.close(),!m)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function eE(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class x6{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return Il(this.U.delete())}}class Uh extends Ae{constructor(e,t){super(xe.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function zo(s){return s.name==="IndexedDbTransactionError"}class b6{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Ce(dr,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Ce(dr,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Il(r)}add(e){return Ce(dr,"ADD",this.store.name,e,e),Il(this.store.add(e))}get(e){return Il(this.store.get(e)).next((t=>(t===void 0&&(t=null),Ce(dr,"GET",this.store.name,e,t),t)))}delete(e){return Ce(dr,"DELETE",this.store.name,e),Il(this.store.delete(e))}count(){return Ce(dr,"COUNT",this.store.name),Il(this.store.count())}H(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const l=i.getAll(r.range);return new le(((d,h)=>{l.onerror=f=>{h(f.target.error)},l.onsuccess=f=>{d(f.target.result)}}))}{const l=this.cursor(r),d=[];return this.J(l,((h,f)=>{d.push(f)})).next((()=>d))}}Z(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new le(((i,l)=>{r.onerror=d=>{l(d.target.error)},r.onsuccess=d=>{i(d.target.result)}}))}X(e,t){Ce(dr,"DELETE ALL",this.store.name);const r=this.options(e,t);r.Y=!1;const i=this.cursor(r);return this.J(i,((l,d,h)=>h.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.J(i,t)}te(e){const t=this.cursor({});return new le(((r,i)=>{t.onerror=l=>{const d=$v(l.target.error);i(d)},t.onsuccess=l=>{const d=l.target.result;d?e(d.primaryKey,d.value).next((h=>{h?d.continue():r()})):r()}}))}J(e,t){const r=[];return new le(((i,l)=>{e.onerror=d=>{l(d.target.error)},e.onsuccess=d=>{const h=d.target.result;if(!h)return void i();const f=new x6(h),m=t(h.primaryKey,h.value,f);if(m instanceof le){const b=m.catch((y=>(f.done(),le.reject(y))));r.push(b)}f.isDone?i():f.G===null?h.continue():h.continue(f.G)}})).next((()=>le.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Il(s){return new le(((e,t)=>{s.onsuccess=r=>{const i=r.target.result;e(i)},s.onerror=r=>{const i=$v(r.target.error);t(i)}}))}let D_=!1;function $v(s){const e=La.M(ms());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(s.message.indexOf(t)>=0){const r=new Ae("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return D_||(D_=!0,setTimeout((()=>{throw r}),0)),r}}return s}const Fh="IndexBackfiller";class y6{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Ce(Fh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Ce(Fh,`Documents written: ${t}`)}catch(t){zo(t)?Ce(Fh,"Ignoring IndexedDB error during index backfill: ",t):await Bo(t)}await this.re(6e4)}))}}class v6{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,l=!0;return le.doWhile((()=>l===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((d=>{if(d!==null&&!r.has(d))return Ce(Fh,`Processing collection: ${d}`),this.oe(e,d,i).next((h=>{i-=h,r.add(d)}));l=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((l=>{const d=l.changes;return this.localStore.indexManager.updateIndexEntries(e,d).next((()=>this._e(i,l))).next((h=>(Ce(Fh,`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h)))).next((()=>d.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,l)=>{const d=XS(l);zv(d,r)>0&&(r=d)})),new xr(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Kn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const To=-1;function kf(s){return s==null}function af(s){return s===0&&1/s==-1/0}function tE(s){return typeof s=="number"&&Number.isInteger(s)&&!af(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0="";function Sn(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=O_(e)),e=w6(s.get(t),e);return O_(e)}function w6(s,e){let t=e;const r=s.length;for(let i=0;i<r;i++){const l=s.charAt(i);switch(l){case"\0":t+="";break;case u0:t+="";break;default:t+=l}}return t}function O_(s){return s+u0+""}function Oa(s){const e=s.length;if(Ke(e>=2,64408,{path:s}),e===2)return Ke(s.charAt(0)===u0&&s.charAt(1)==="",56145,{path:s}),Nt.emptyPath();const t=e-2,r=[];let i="";for(let l=0;l<e;){const d=s.indexOf(u0,l);switch((d<0||d>t)&&ze(50515,{path:s}),s.charAt(d+1)){case"":const h=s.substring(l,d);let f;i.length===0?f=h:(i+=h,f=i,i=""),r.push(f);break;case"":i+=s.substring(l,d),i+="\0";break;case"":i+=s.substring(l,d+1);break;default:ze(61167,{path:s})}l=d+2}return new Nt(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sl="remoteDocuments",Cf="owner",td="owner",of="mutationQueues",j6="userId",Xr="mutations",P_="batchId",Dl="userMutationsIndex",M_=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gg(s,e){return[s,Sn(e)]}function sE(s,e,t){return[s,Sn(e),t]}const N6={},Od="documentMutations",h0="remoteDocumentsV14",_6=["prefixPath","collectionGroup","readTime","documentId"],Wg="documentKeyIndex",T6=["prefixPath","collectionGroup","documentId"],nE="collectionGroupIndex",S6=["collectionGroup","readTime","prefixPath","documentId"],lf="remoteDocumentGlobal",Oy="remoteDocumentGlobalKey",Pd="targets",rE="queryTargetsIndex",E6=["canonicalId","targetId"],Md="targetDocuments",I6=["targetId","path"],qv="documentTargetsIndex",A6=["path","targetId"],f0="targetGlobalKey",Ul="targetGlobal",cf="collectionParents",k6=["collectionId","parent"],Ld="clientMetadata",C6="clientId",K0="bundles",R6="bundleId",Q0="namedQueries",D6="name",Hv="indexConfiguration",O6="indexId",Py="collectionGroupIndex",P6="collectionGroup",Bh="indexState",M6=["indexId","uid"],aE="sequenceNumberIndex",L6=["uid","sequenceNumber"],zh="indexEntries",V6=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],iE="documentKeyIndex",U6=["indexId","uid","orderedDocumentKey"],Y0="documentOverlays",F6=["userId","collectionPath","documentId"],My="collectionPathOverlayIndex",B6=["userId","collectionPath","largestBatchId"],oE="collectionGroupOverlayIndex",z6=["userId","collectionGroup","largestBatchId"],Gv="globals",$6="name",lE=[of,Xr,Od,Sl,Pd,Cf,Ul,Md,Ld,lf,cf,K0,Q0],q6=[...lE,Y0],cE=[of,Xr,Od,h0,Pd,Cf,Ul,Md,Ld,lf,cf,K0,Q0,Y0],dE=cE,Wv=[...dE,Hv,Bh,zh],H6=Wv,uE=[...Wv,Gv],G6=uE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly extends ZS{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Ks(s,e){const t=Be(s);return La.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function $o(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function hE(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e,t){this.comparator=e,this.root=t||dn.EMPTY}insert(e,t){return new ts(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,dn.BLACK,null,null))}remove(e){return new ts(this.comparator,this.root.remove(e,this.comparator).copy(null,null,dn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ng(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ng(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ng(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ng(this.root,e,this.comparator,!0)}}class Ng{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?r(e.key,t):1,t&&i&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class dn{constructor(e,t,r,i,l){this.key=e,this.value=t,this.color=r??dn.RED,this.left=i??dn.EMPTY,this.right=l??dn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,l){return new dn(e??this.key,t??this.value,r??this.color,i??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const l=r(e,i.key);return i=l<0?i.copy(null,null,null,i.left.insert(e,t,r),null):l===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return dn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return dn.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,dn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,dn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ze(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ze(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ze(27949);return e+(this.isRed()?0:1)}}dn.EMPTY=null,dn.RED=!0,dn.BLACK=!1;dn.EMPTY=new class{constructor(){this.size=0}get key(){throw ze(57766)}get value(){throw ze(16141)}get color(){throw ze(16727)}get left(){throw ze(29726)}get right(){throw ze(36894)}copy(e,t,r,i,l){return this}insert(e,t,r){return new dn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.comparator=e,this.data=new ts(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new V_(this.data.getIterator())}getIteratorFrom(e){return new V_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Gt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,l=r.getNext().key;if(this.comparator(i,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Gt(this.comparator);return t.data=e,t}}class V_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function sd(s){return s.hasNext()?s.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e){this.fields=e,e.sort(us.comparator)}static empty(){return new Qn([])}unionWith(e){let t=new Gt(us.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Qn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Rd(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W6(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new fE("Invalid base64 string: "+l):l}})(e);return new vs(t)}static fromUint8Array(e){const t=(function(i){let l="";for(let d=0;d<i.length;++d)l+=String.fromCharCode(i[d]);return l})(e);return new vs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ot(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vs.EMPTY_BYTE_STRING=new vs("");const K6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ni(s){if(Ke(!!s,39018),typeof s=="string"){let e=0;const t=K6.exec(s);if(Ke(!!t,46558,{timestamp:s}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(s);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ds(s.seconds),nanos:ds(s.nanos)}}function ds(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function _i(s){return typeof s=="string"?vs.fromBase64String(s):vs.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mE="server_timestamp",gE="__type__",pE="__previous_value__",xE="__local_write_time__";function X0(s){var t,r;return((r=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[gE])==null?void 0:r.stringValue)===mE}function J0(s){const e=s.mapValue.fields[pE];return X0(e)?J0(e):e}function df(s){const e=Ni(s.mapValue.fields[xE].timestampValue);return new Vt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q6{constructor(e,t,r,i,l,d,h,f,m,b,y){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=l,this.forceLongPolling=d,this.autoDetectLongPolling=h,this.longPollingOptions=f,this.useFetchStreams=m,this.isUsingEmulator=b,this.apiKey=y}}const Vy="(default)";class Oo{constructor(e,t){this.projectId=e,this.database=t||Vy}static empty(){return new Oo("","")}get isDefaultDatabase(){return this.database===Vy}isEqual(e){return e instanceof Oo&&e.projectId===this.projectId&&e.database===this.database}}function Y6(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new Ae(xe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Oo(s.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kv="__type__",bE="__max__",vo={mapValue:{fields:{__type__:{stringValue:bE}}}},Qv="__vector__",Vd="value",Kg={nullValue:"NULL_VALUE"};function Po(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?X0(s)?4:yE(s)?9007199254740991:Z0(s)?10:11:ze(28295,{value:s})}function $a(s,e){if(s===e)return!0;const t=Po(s);if(t!==Po(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return df(s).isEqual(df(e));case 3:return(function(i,l){if(typeof i.timestampValue=="string"&&typeof l.timestampValue=="string"&&i.timestampValue.length===l.timestampValue.length)return i.timestampValue===l.timestampValue;const d=Ni(i.timestampValue),h=Ni(l.timestampValue);return d.seconds===h.seconds&&d.nanos===h.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(i,l){return _i(i.bytesValue).isEqual(_i(l.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(i,l){return ds(i.geoPointValue.latitude)===ds(l.geoPointValue.latitude)&&ds(i.geoPointValue.longitude)===ds(l.geoPointValue.longitude)})(s,e);case 2:return(function(i,l){if("integerValue"in i&&"integerValue"in l)return ds(i.integerValue)===ds(l.integerValue);if("doubleValue"in i&&"doubleValue"in l){const d=ds(i.doubleValue),h=ds(l.doubleValue);return d===h?af(d)===af(h):isNaN(d)&&isNaN(h)}return!1})(s,e);case 9:return Rd(s.arrayValue.values||[],e.arrayValue.values||[],$a);case 10:case 11:return(function(i,l){const d=i.mapValue.fields||{},h=l.mapValue.fields||{};if(L_(d)!==L_(h))return!1;for(const f in d)if(d.hasOwnProperty(f)&&(h[f]===void 0||!$a(d[f],h[f])))return!1;return!0})(s,e);default:return ze(52216,{left:s})}}function uf(s,e){return(s.values||[]).find((t=>$a(t,e)))!==void 0}function Mo(s,e){if(s===e)return 0;const t=Po(s),r=Po(e);if(t!==r)return ot(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ot(s.booleanValue,e.booleanValue);case 2:return(function(l,d){const h=ds(l.integerValue||l.doubleValue),f=ds(d.integerValue||d.doubleValue);return h<f?-1:h>f?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1})(s,e);case 3:return U_(s.timestampValue,e.timestampValue);case 4:return U_(df(s),df(e));case 5:return Ry(s.stringValue,e.stringValue);case 6:return(function(l,d){const h=_i(l),f=_i(d);return h.compareTo(f)})(s.bytesValue,e.bytesValue);case 7:return(function(l,d){const h=l.split("/"),f=d.split("/");for(let m=0;m<h.length&&m<f.length;m++){const b=ot(h[m],f[m]);if(b!==0)return b}return ot(h.length,f.length)})(s.referenceValue,e.referenceValue);case 8:return(function(l,d){const h=ot(ds(l.latitude),ds(d.latitude));return h!==0?h:ot(ds(l.longitude),ds(d.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return F_(s.arrayValue,e.arrayValue);case 10:return(function(l,d){var v,N,E,I;const h=l.fields||{},f=d.fields||{},m=(v=h[Vd])==null?void 0:v.arrayValue,b=(N=f[Vd])==null?void 0:N.arrayValue,y=ot(((E=m==null?void 0:m.values)==null?void 0:E.length)||0,((I=b==null?void 0:b.values)==null?void 0:I.length)||0);return y!==0?y:F_(m,b)})(s.mapValue,e.mapValue);case 11:return(function(l,d){if(l===vo.mapValue&&d===vo.mapValue)return 0;if(l===vo.mapValue)return 1;if(d===vo.mapValue)return-1;const h=l.fields||{},f=Object.keys(h),m=d.fields||{},b=Object.keys(m);f.sort(),b.sort();for(let y=0;y<f.length&&y<b.length;++y){const v=Ry(f[y],b[y]);if(v!==0)return v;const N=Mo(h[f[y]],m[b[y]]);if(N!==0)return N}return ot(f.length,b.length)})(s.mapValue,e.mapValue);default:throw ze(23264,{he:t})}}function U_(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return ot(s,e);const t=Ni(s),r=Ni(e),i=ot(t.seconds,r.seconds);return i!==0?i:ot(t.nanos,r.nanos)}function F_(s,e){const t=s.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const l=Mo(t[i],r[i]);if(l)return l}return ot(t.length,r.length)}function Ud(s){return Uy(s)}function Uy(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const r=Ni(t);return`time(${r.seconds},${r.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return _i(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return Ue.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let r="[",i=!0;for(const l of t.values||[])i?i=!1:r+=",",r+=Uy(l);return r+"]"})(s.arrayValue):"mapValue"in s?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",l=!0;for(const d of r)l?l=!1:i+=",",i+=`${d}:${Uy(t.fields[d])}`;return i+"}"})(s.mapValue):ze(61005,{value:s})}function Qg(s){switch(Po(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=J0(s);return e?16+Qg(e):16;case 5:return 2*s.stringValue.length;case 6:return _i(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,l)=>i+Qg(l)),0)})(s.arrayValue);case 10:case 11:return(function(r){let i=0;return $o(r.fields,((l,d)=>{i+=l.length+Qg(d)})),i})(s.mapValue);default:throw ze(13486,{value:s})}}function Hl(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function Fy(s){return!!s&&"integerValue"in s}function hf(s){return!!s&&"arrayValue"in s}function B_(s){return!!s&&"nullValue"in s}function z_(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Yg(s){return!!s&&"mapValue"in s}function Z0(s){var t,r;return((r=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[Kv])==null?void 0:r.stringValue)===Qv}function $h(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return $o(s.mapValue.fields,((t,r)=>e.mapValue.fields[t]=$h(r))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=$h(s.arrayValue.values[t]);return e}return{...s}}function yE(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===bE}const vE={mapValue:{fields:{[Kv]:{stringValue:Qv},[Vd]:{arrayValue:{}}}}};function X6(s){return"nullValue"in s?Kg:"booleanValue"in s?{booleanValue:!1}:"integerValue"in s||"doubleValue"in s?{doubleValue:NaN}:"timestampValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in s?{stringValue:""}:"bytesValue"in s?{bytesValue:""}:"referenceValue"in s?Hl(Oo.empty(),Ue.empty()):"geoPointValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in s?{arrayValue:{}}:"mapValue"in s?Z0(s)?vE:{mapValue:{}}:ze(35942,{value:s})}function J6(s){return"nullValue"in s?{booleanValue:!1}:"booleanValue"in s?{doubleValue:NaN}:"integerValue"in s||"doubleValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in s?{stringValue:""}:"stringValue"in s?{bytesValue:""}:"bytesValue"in s?Hl(Oo.empty(),Ue.empty()):"referenceValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in s?{arrayValue:{}}:"arrayValue"in s?vE:"mapValue"in s?Z0(s)?{mapValue:{}}:vo:ze(61959,{value:s})}function $_(s,e){const t=Mo(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?-1:!s.inclusive&&e.inclusive?1:0}function q_(s,e){const t=Mo(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?1:!s.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.value=e}static empty(){return new un({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Yg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=$h(t)}setAll(e){let t=us.emptyPath(),r={},i=[];e.forEach(((d,h)=>{if(!t.isImmediateParentOf(h)){const f=this.getFieldsMap(t);this.applyChanges(f,r,i),r={},i=[],t=h.popLast()}d?r[h.lastSegment()]=$h(d):i.push(h.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,r,i)}delete(e){const t=this.field(e.popLast());Yg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return $a(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Yg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){$o(t,((i,l)=>e[i]=l));for(const i of r)delete e[i]}clone(){return new un($h(this.value))}}function wE(s){const e=[];return $o(s.fields,((t,r)=>{const i=new us([t]);if(Yg(r)){const l=wE(r.mapValue).fields;if(l.length===0)e.push(i);else for(const d of l)e.push(i.child(d))}else e.push(i)})),new Qn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,t,r,i,l,d,h){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=l,this.data=d,this.documentState=h}static newInvalidDocument(e){return new rs(e,0,Ye.min(),Ye.min(),Ye.min(),un.empty(),0)}static newFoundDocument(e,t,r,i){return new rs(e,1,t,Ye.min(),r,i,0)}static newNoDocument(e,t){return new rs(e,2,t,Ye.min(),Ye.min(),un.empty(),0)}static newUnknownDocument(e,t){return new rs(e,3,t,Ye.min(),Ye.min(),un.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ye.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=un.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=un.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ye.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof rs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new rs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e,t){this.position=e,this.inclusive=t}}function H_(s,e,t){let r=0;for(let i=0;i<s.position.length;i++){const l=e[i],d=s.position[i];if(l.field.isKeyField()?r=Ue.comparator(Ue.fromName(d.referenceValue),t.key):r=Mo(d,t.data.field(l.field)),l.dir==="desc"&&(r*=-1),r!==0)break}return r}function G_(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!$a(s.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e,t="asc"){this.field=e,this.dir=t}}function Z6(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{}class St extends jE{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new eO(e,t,r):t==="array-contains"?new nO(e,r):t==="in"?new IE(e,r):t==="not-in"?new rO(e,r):t==="array-contains-any"?new aO(e,r):new St(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new tO(e,r):new sO(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Mo(t,this.value)):t!==null&&Po(this.value)===Po(t)&&this.matchesComparison(Mo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ze(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ht extends jE{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ht(e,t)}matches(e){return Fd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Fd(s){return s.op==="and"}function By(s){return s.op==="or"}function Yv(s){return NE(s)&&Fd(s)}function NE(s){for(const e of s.filters)if(e instanceof Ht)return!1;return!0}function zy(s){if(s instanceof St)return s.field.canonicalString()+s.op.toString()+Ud(s.value);if(Yv(s))return s.filters.map((e=>zy(e))).join(",");{const e=s.filters.map((t=>zy(t))).join(",");return`${s.op}(${e})`}}function _E(s,e){return s instanceof St?(function(r,i){return i instanceof St&&r.op===i.op&&r.field.isEqual(i.field)&&$a(r.value,i.value)})(s,e):s instanceof Ht?(function(r,i){return i instanceof Ht&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((l,d,h)=>l&&_E(d,i.filters[h])),!0):!1})(s,e):void ze(19439)}function TE(s,e){const t=s.filters.concat(e);return Ht.create(t,s.op)}function SE(s){return s instanceof St?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ud(t.value)}`})(s):s instanceof Ht?(function(t){return t.op.toString()+" {"+t.getFilters().map(SE).join(" ,")+"}"})(s):"Filter"}class eO extends St{constructor(e,t,r){super(e,t,r),this.key=Ue.fromName(r.referenceValue)}matches(e){const t=Ue.comparator(e.key,this.key);return this.matchesComparison(t)}}class tO extends St{constructor(e,t){super(e,"in",t),this.keys=EE("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class sO extends St{constructor(e,t){super(e,"not-in",t),this.keys=EE("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function EE(s,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((r=>Ue.fromName(r.referenceValue)))}class nO extends St{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return hf(t)&&uf(t.arrayValue,this.value)}}class IE extends St{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&uf(this.value.arrayValue,t)}}class rO extends St{constructor(e,t){super(e,"not-in",t)}matches(e){if(uf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!uf(this.value.arrayValue,t)}}class aO extends St{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!hf(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>uf(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(e,t=null,r=[],i=[],l=null,d=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=l,this.startAt=d,this.endAt=h,this.Te=null}}function $y(s,e=null,t=[],r=[],i=null,l=null,d=null){return new iO(s,e,t,r,i,l,d)}function Gl(s){const e=Be(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>zy(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(l){return l.field.canonicalString()+l.dir})(r))).join(","),kf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Ud(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Ud(r))).join(",")),e.Te=t}return e.Te}function Rf(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!Z6(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!_E(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!G_(s.startAt,e.startAt)&&G_(s.endAt,e.endAt)}function m0(s){return Ue.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function g0(s,e){return s.filters.filter((t=>t instanceof St&&t.field.isEqual(e)))}function W_(s,e,t){let r=Kg,i=!0;for(const l of g0(s,e)){let d=Kg,h=!0;switch(l.op){case"<":case"<=":d=X6(l.value);break;case"==":case"in":case">=":d=l.value;break;case">":d=l.value,h=!1;break;case"!=":case"not-in":d=Kg}$_({value:r,inclusive:i},{value:d,inclusive:h})<0&&(r=d,i=h)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const d=t.position[l];$_({value:r,inclusive:i},{value:d,inclusive:t.inclusive})<0&&(r=d,i=t.inclusive);break}}return{value:r,inclusive:i}}function K_(s,e,t){let r=vo,i=!0;for(const l of g0(s,e)){let d=vo,h=!0;switch(l.op){case">=":case">":d=J6(l.value),h=!1;break;case"==":case"in":case"<=":d=l.value;break;case"<":d=l.value,h=!1;break;case"!=":case"not-in":d=vo}q_({value:r,inclusive:i},{value:d,inclusive:h})>0&&(r=d,i=h)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const d=t.position[l];q_({value:r,inclusive:i},{value:d,inclusive:t.inclusive})>0&&(r=d,i=t.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e,t=null,r=[],i=[],l=null,d="F",h=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=l,this.limitType=d,this.startAt=h,this.endAt=f,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function AE(s,e,t,r,i,l,d,h){return new Ii(s,e,t,r,i,l,d,h)}function ru(s){return new Ii(s)}function Q_(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function oO(s){return Ue.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function Xv(s){return s.collectionGroup!==null}function wd(s){const e=Be(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let h=new Gt(us.comparator);return d.filters.forEach((f=>{f.getFlattenedFilters().forEach((m=>{m.isInequality()&&(h=h.add(m.field))}))})),h})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new ff(l,r))})),t.has(us.keyField().canonicalString())||e.Ie.push(new ff(us.keyField(),r))}return e.Ie}function Pn(s){const e=Be(s);return e.Ee||(e.Ee=lO(e,wd(s))),e.Ee}function lO(s,e){if(s.limitType==="F")return $y(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((i=>{const l=i.dir==="desc"?"asc":"desc";return new ff(i.field,l)}));const t=s.endAt?new Lo(s.endAt.position,s.endAt.inclusive):null,r=s.startAt?new Lo(s.startAt.position,s.startAt.inclusive):null;return $y(s.path,s.collectionGroup,e,s.filters,s.limit,t,r)}}function qy(s,e){const t=s.filters.concat([e]);return new Ii(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function cO(s,e){const t=s.explicitOrderBy.concat([e]);return new Ii(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function p0(s,e,t){return new Ii(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function dO(s,e){return new Ii(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,e,s.endAt)}function uO(s,e){return new Ii(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,e)}function Df(s,e){return Rf(Pn(s),Pn(e))&&s.limitType===e.limitType}function kE(s){return`${Gl(Pn(s))}|lt:${s.limitType}`}function fd(s){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>SE(i))).join(", ")}]`),kf(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>Ud(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>Ud(i))).join(",")),`Target(${r})`})(Pn(s))}; limitType=${s.limitType})`}function Of(s,e){return e.isFoundDocument()&&(function(r,i){const l=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(l):Ue.isDocumentKey(r.path)?r.path.isEqual(l):r.path.isImmediateParentOf(l)})(s,e)&&(function(r,i){for(const l of wd(r))if(!l.field.isKeyField()&&i.data.field(l.field)===null)return!1;return!0})(s,e)&&(function(r,i){for(const l of r.filters)if(!l.matches(i))return!1;return!0})(s,e)&&(function(r,i){return!(r.startAt&&!(function(d,h,f){const m=H_(d,h,f);return d.inclusive?m<=0:m<0})(r.startAt,wd(r),i)||r.endAt&&!(function(d,h,f){const m=H_(d,h,f);return d.inclusive?m>=0:m>0})(r.endAt,wd(r),i))})(s,e)}function CE(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function RE(s){return(e,t)=>{let r=!1;for(const i of wd(s)){const l=hO(i,e,t);if(l!==0)return l;r=r||i.field.isKeyField()}return 0}}function hO(s,e,t){const r=s.field.isKeyField()?Ue.comparator(e.key,t.key):(function(l,d,h){const f=d.data.field(l),m=h.data.field(l);return f!==null&&m!==null?Mo(f,m):ze(42886)})(s.field,e,t);switch(s.dir){case"asc":return r;case"desc":return-1*r;default:return ze(19790,{direction:s.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,l]of r)if(this.equalsFn(i,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return void(i[l]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){$o(this.inner,((t,r)=>{for(const[i,l]of r)e(i,l)}))}isEmpty(){return hE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fO=new ts(Ue.comparator);function Yn(){return fO}const DE=new ts(Ue.comparator);function Ch(...s){let e=DE;for(const t of s)e=e.insert(t.key,t);return e}function OE(s){let e=DE;return s.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Pa(){return qh()}function PE(){return qh()}function qh(){return new Ai((s=>s.toString()),((s,e)=>s.isEqual(e)))}const mO=new ts(Ue.comparator),gO=new Gt(Ue.comparator);function ft(...s){let e=gO;for(const t of s)e=e.add(t);return e}const pO=new Gt(ot);function Jv(){return pO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zv(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:af(e)?"-0":e}}function ME(s){return{integerValue:""+s}}function LE(s,e){return tE(e)?ME(e):Zv(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep{constructor(){this._=void 0}}function xO(s,e,t){return s instanceof Bd?(function(i,l){const d={fields:{[gE]:{stringValue:mE},[xE]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return l&&X0(l)&&(l=J0(l)),l&&(d.fields[pE]=l),{mapValue:d}})(t,e):s instanceof Wl?UE(s,e):s instanceof Kl?FE(s,e):(function(i,l){const d=VE(i,l),h=Y_(d)+Y_(i.Ae);return Fy(d)&&Fy(i.Ae)?ME(h):Zv(i.serializer,h)})(s,e)}function bO(s,e,t){return s instanceof Wl?UE(s,e):s instanceof Kl?FE(s,e):t}function VE(s,e){return s instanceof zd?(function(r){return Fy(r)||(function(l){return!!l&&"doubleValue"in l})(r)})(e)?e:{integerValue:0}:null}class Bd extends ep{}class Wl extends ep{constructor(e){super(),this.elements=e}}function UE(s,e){const t=BE(e);for(const r of s.elements)t.some((i=>$a(i,r)))||t.push(r);return{arrayValue:{values:t}}}class Kl extends ep{constructor(e){super(),this.elements=e}}function FE(s,e){let t=BE(e);for(const r of s.elements)t=t.filter((i=>!$a(i,r)));return{arrayValue:{values:t}}}class zd extends ep{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Y_(s){return ds(s.integerValue||s.doubleValue)}function BE(s){return hf(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf{constructor(e,t){this.field=e,this.transform=t}}function yO(s,e){return s.field.isEqual(e.field)&&(function(r,i){return r instanceof Wl&&i instanceof Wl||r instanceof Kl&&i instanceof Kl?Rd(r.elements,i.elements,$a):r instanceof zd&&i instanceof zd?$a(r.Ae,i.Ae):r instanceof Bd&&i instanceof Bd})(s.transform,e.transform)}class vO{constructor(e,t){this.version=e,this.transformResults=t}}class hs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new hs}static exists(e){return new hs(void 0,e)}static updateTime(e){return new hs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Xg(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class tp{}function zE(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new iu(s.key,hs.none()):new au(s.key,s.data,hs.none());{const t=s.data,r=un.empty();let i=new Gt(us.comparator);for(let l of e.fields)if(!i.has(l)){let d=t.field(l);d===null&&l.length>1&&(l=l.popLast(),d=t.field(l)),d===null?r.delete(l):r.set(l,d),i=i.add(l)}return new ki(s.key,r,new Qn(i.toArray()),hs.none())}}function wO(s,e,t){s instanceof au?(function(i,l,d){const h=i.value.clone(),f=J_(i.fieldTransforms,l,d.transformResults);h.setAll(f),l.convertToFoundDocument(d.version,h).setHasCommittedMutations()})(s,e,t):s instanceof ki?(function(i,l,d){if(!Xg(i.precondition,l))return void l.convertToUnknownDocument(d.version);const h=J_(i.fieldTransforms,l,d.transformResults),f=l.data;f.setAll($E(i)),f.setAll(h),l.convertToFoundDocument(d.version,f).setHasCommittedMutations()})(s,e,t):(function(i,l,d){l.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function Hh(s,e,t,r){return s instanceof au?(function(l,d,h,f){if(!Xg(l.precondition,d))return h;const m=l.value.clone(),b=Z_(l.fieldTransforms,f,d);return m.setAll(b),d.convertToFoundDocument(d.version,m).setHasLocalMutations(),null})(s,e,t,r):s instanceof ki?(function(l,d,h,f){if(!Xg(l.precondition,d))return h;const m=Z_(l.fieldTransforms,f,d),b=d.data;return b.setAll($E(l)),b.setAll(m),d.convertToFoundDocument(d.version,b).setHasLocalMutations(),h===null?null:h.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((y=>y.field)))})(s,e,t,r):(function(l,d,h){return Xg(l.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):h})(s,e,t)}function jO(s,e){let t=null;for(const r of s.fieldTransforms){const i=e.data.field(r.field),l=VE(r.transform,i||null);l!=null&&(t===null&&(t=un.empty()),t.set(r.field,l))}return t||null}function X_(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Rd(r,i,((l,d)=>yO(l,d)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class au extends tp{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ki extends tp{constructor(e,t,r,i,l=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function $E(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=s.data.field(t);e.set(t,r)}})),e}function J_(s,e,t){const r=new Map;Ke(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let i=0;i<t.length;i++){const l=s[i],d=l.transform,h=e.data.field(l.field);r.set(l.field,bO(d,h,t[i]))}return r}function Z_(s,e,t){const r=new Map;for(const i of s){const l=i.transform,d=t.data.field(i.field);r.set(i.field,xO(l,d,e))}return r}class iu extends tp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ew extends tp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const l=this.mutations[i];l.key.isEqual(e.key)&&wO(l,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Hh(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Hh(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=PE();return this.mutations.forEach((i=>{const l=e.get(i.key),d=l.overlayedDocument;let h=this.applyToLocalView(d,l.mutatedFields);h=t.has(i.key)?null:h;const f=zE(d,h);f!==null&&r.set(i.key,f),d.isValidDocument()||d.convertToNoDocument(Ye.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ft())}isEqual(e){return this.batchId===e.batchId&&Rd(this.mutations,e.mutations,((t,r)=>X_(t,r)))&&Rd(this.baseMutations,e.baseMutations,((t,r)=>X_(t,r)))}}class sw{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ke(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return mO})();const l=e.mutations;for(let d=0;d<l.length;d++)i=i.insert(l[d].key,r[d].version);return new sw(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NO{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Us,It;function qE(s){switch(s){case xe.OK:return ze(64938);case xe.CANCELLED:case xe.UNKNOWN:case xe.DEADLINE_EXCEEDED:case xe.RESOURCE_EXHAUSTED:case xe.INTERNAL:case xe.UNAVAILABLE:case xe.UNAUTHENTICATED:return!1;case xe.INVALID_ARGUMENT:case xe.NOT_FOUND:case xe.ALREADY_EXISTS:case xe.PERMISSION_DENIED:case xe.FAILED_PRECONDITION:case xe.ABORTED:case xe.OUT_OF_RANGE:case xe.UNIMPLEMENTED:case xe.DATA_LOSS:return!0;default:return ze(15467,{code:s})}}function HE(s){if(s===void 0)return Es("GRPC error has no .code"),xe.UNKNOWN;switch(s){case Us.OK:return xe.OK;case Us.CANCELLED:return xe.CANCELLED;case Us.UNKNOWN:return xe.UNKNOWN;case Us.DEADLINE_EXCEEDED:return xe.DEADLINE_EXCEEDED;case Us.RESOURCE_EXHAUSTED:return xe.RESOURCE_EXHAUSTED;case Us.INTERNAL:return xe.INTERNAL;case Us.UNAVAILABLE:return xe.UNAVAILABLE;case Us.UNAUTHENTICATED:return xe.UNAUTHENTICATED;case Us.INVALID_ARGUMENT:return xe.INVALID_ARGUMENT;case Us.NOT_FOUND:return xe.NOT_FOUND;case Us.ALREADY_EXISTS:return xe.ALREADY_EXISTS;case Us.PERMISSION_DENIED:return xe.PERMISSION_DENIED;case Us.FAILED_PRECONDITION:return xe.FAILED_PRECONDITION;case Us.ABORTED:return xe.ABORTED;case Us.OUT_OF_RANGE:return xe.OUT_OF_RANGE;case Us.UNIMPLEMENTED:return xe.UNIMPLEMENTED;case Us.DATA_LOSS:return xe.DATA_LOSS;default:return ze(39323,{code:s})}}(It=Us||(Us={}))[It.OK=0]="OK",It[It.CANCELLED=1]="CANCELLED",It[It.UNKNOWN=2]="UNKNOWN",It[It.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",It[It.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",It[It.NOT_FOUND=5]="NOT_FOUND",It[It.ALREADY_EXISTS=6]="ALREADY_EXISTS",It[It.PERMISSION_DENIED=7]="PERMISSION_DENIED",It[It.UNAUTHENTICATED=16]="UNAUTHENTICATED",It[It.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",It[It.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",It[It.ABORTED=10]="ABORTED",It[It.OUT_OF_RANGE=11]="OUT_OF_RANGE",It[It.UNIMPLEMENTED=12]="UNIMPLEMENTED",It[It.INTERNAL=13]="INTERNAL",It[It.UNAVAILABLE=14]="UNAVAILABLE",It[It.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GE(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _O=new _o([4294967295,4294967295],0);function e5(s){const e=GE().encode(s),t=new VS;return t.update(e),new Uint8Array(t.digest())}function t5(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new _o([t,r],0),new _o([i,l],0)]}class rw{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Rh(`Invalid padding: ${t}`);if(r<0)throw new Rh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Rh(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Rh(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=_o.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(_o.fromNumber(r)));return i.compare(_O)===1&&(i=new _o([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=e5(e),[r,i]=t5(t);for(let l=0;l<this.hashCount;l++){const d=this.ye(r,i,l);if(!this.we(d))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),d=new rw(l,i,t);return r.forEach((h=>d.insert(h))),d}insert(e){if(this.ge===0)return;const t=e5(e),[r,i]=t5(t);for(let l=0;l<this.hashCount;l++){const d=this.ye(r,i,l);this.be(d)}}be(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Rh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(e,t,r,i,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Lf.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Mf(Ye.min(),i,new ts(ot),Yn(),ft())}}class Lf{constructor(e,t,r,i,l){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Lf(r,t,ft(),ft(),ft())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.De=i}}class WE{constructor(e,t){this.targetId=e,this.Ce=t}}class KE{constructor(e,t,r=vs.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class s5{constructor(){this.ve=0,this.Fe=n5(),this.Me=vs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ft(),t=ft(),r=ft();return this.Fe.forEach(((i,l)=>{switch(l){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ze(38017,{changeType:l})}})),new Lf(this.Me,this.xe,e,t,r)}Ke(){this.Oe=!1,this.Fe=n5()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Ke(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class TO{constructor(e){this.Ge=e,this.ze=new Map,this.je=Yn(),this.He=_g(),this.Je=_g(),this.Ze=new ts(ot)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:ze(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const l=i.target;if(m0(l))if(r===0){const d=new Ue(l.path);this.et(t,d,rs.newNoDocument(d,Ye.min()))}else Ke(r===1,20013,{expectedCount:r});else{const d=this._t(t);if(d!==r){const h=this.ut(e),f=h?this.ct(h,e,d):1;if(f!==0){this.it(t);const m=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:l=0}=t;let d,h;try{d=_i(r).toUint8Array()}catch(f){if(f instanceof fE)return za("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{h=new rw(d,i,l)}catch(f){return za(f instanceof Rh?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return h.ge===0?null:h}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((l=>{const d=this.Ge.ht(),h=`projects/${d.projectId}/databases/${d.database}/documents/${l.path.canonicalString()}`;e.mightContain(h)||(this.et(t,l,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((l,d)=>{const h=this.ot(d);if(h){if(l.current&&m0(h.target)){const f=new Ue(h.target.path);this.It(f).has(d)||this.Et(d,f)||this.et(d,f,rs.newNoDocument(f,e))}l.Be&&(t.set(d,l.ke()),l.Ke())}}));let r=ft();this.Je.forEach(((l,d)=>{let h=!0;d.forEachWhile((f=>{const m=this.ot(f);return!m||m.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(r=r.add(l))})),this.je.forEach(((l,d)=>d.setReadTime(e)));const i=new Mf(e,t,this.Ze,this.je,r);return this.je=Yn(),this.He=_g(),this.Je=_g(),this.Ze=new ts(ot),i}Ye(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,r),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.qe(t,1):i.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new s5,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Gt(ot),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Gt(ot),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ce("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new s5),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function _g(){return new ts(Ue.comparator)}function n5(){return new ts(Ue.comparator)}const SO={asc:"ASCENDING",desc:"DESCENDING"},EO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},IO={and:"AND",or:"OR"};class AO{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Hy(s,e){return s.useProto3Json||kf(e)?e:{value:e}}function $d(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function QE(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function kO(s,e){return $d(s,e.toTimestamp())}function As(s){return Ke(!!s,49232),Ye.fromTimestamp((function(t){const r=Ni(t);return new Vt(r.seconds,r.nanos)})(s))}function aw(s,e){return Gy(s,e).canonicalString()}function Gy(s,e){const t=(function(i){return new Nt(["projects",i.projectId,"databases",i.database])})(s).child("documents");return e===void 0?t:t.child(e)}function YE(s){const e=Nt.fromString(s);return Ke(i4(e),10190,{key:e.toString()}),e}function mf(s,e){return aw(s.databaseId,e.path)}function Va(s,e){const t=YE(e);if(t.get(1)!==s.databaseId.projectId)throw new Ae(xe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new Ae(xe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new Ue(ZE(t))}function XE(s,e){return aw(s.databaseId,e)}function JE(s){const e=YE(s);return e.length===4?Nt.emptyPath():ZE(e)}function Wy(s){return new Nt(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function ZE(s){return Ke(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function r5(s,e,t){return{name:mf(s,e),fields:t.value.mapValue.fields}}function e4(s,e,t){const r=Va(s,e.name),i=As(e.updateTime),l=e.createTime?As(e.createTime):Ye.min(),d=new un({mapValue:{fields:e.fields}}),h=rs.newFoundDocument(r,i,l,d);return t&&h.setHasCommittedMutations(),t?h.setHasCommittedMutations():h}function CO(s,e){return"found"in e?(function(r,i){Ke(!!i.found,43571),i.found.name,i.found.updateTime;const l=Va(r,i.found.name),d=As(i.found.updateTime),h=i.found.createTime?As(i.found.createTime):Ye.min(),f=new un({mapValue:{fields:i.found.fields}});return rs.newFoundDocument(l,d,h,f)})(s,e):"missing"in e?(function(r,i){Ke(!!i.missing,3894),Ke(!!i.readTime,22933);const l=Va(r,i.missing),d=As(i.readTime);return rs.newNoDocument(l,d)})(s,e):ze(7234,{result:e})}function RO(s,e){let t;if("targetChange"in e){e.targetChange;const r=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:ze(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],l=(function(m,b){return m.useProto3Json?(Ke(b===void 0||typeof b=="string",58123),vs.fromBase64String(b||"")):(Ke(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),vs.fromUint8Array(b||new Uint8Array))})(s,e.targetChange.resumeToken),d=e.targetChange.cause,h=d&&(function(m){const b=m.code===void 0?xe.UNKNOWN:HE(m.code);return new Ae(b,m.message||"")})(d);t=new KE(r,i,l,h||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Va(s,r.document.name),l=As(r.document.updateTime),d=r.document.createTime?As(r.document.createTime):Ye.min(),h=new un({mapValue:{fields:r.document.fields}}),f=rs.newFoundDocument(i,l,d,h),m=r.targetIds||[],b=r.removedTargetIds||[];t=new Jg(m,b,f.key,f)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Va(s,r.document),l=r.readTime?As(r.readTime):Ye.min(),d=rs.newNoDocument(i,l),h=r.removedTargetIds||[];t=new Jg([],h,d.key,d)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Va(s,r.document),l=r.removedTargetIds||[];t=new Jg([],l,i,null)}else{if(!("filter"in e))return ze(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:l}=r,d=new NO(i,l),h=r.targetId;t=new WE(h,d)}}return t}function gf(s,e){let t;if(e instanceof au)t={update:r5(s,e.key,e.value)};else if(e instanceof iu)t={delete:mf(s,e.key)};else if(e instanceof ki)t={update:r5(s,e.key,e.data),updateMask:VO(e.fieldMask)};else{if(!(e instanceof ew))return ze(16599,{dt:e.type});t={verify:mf(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(l,d){const h=d.transform;if(h instanceof Bd)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Wl)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Kl)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof zd)return{fieldPath:d.field.canonicalString(),increment:h.Ae};throw ze(20930,{transform:d.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,l){return l.updateTime!==void 0?{updateTime:kO(i,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:ze(27497)})(s,e.precondition)),t}function Ky(s,e){const t=e.currentDocument?(function(l){return l.updateTime!==void 0?hs.updateTime(As(l.updateTime)):l.exists!==void 0?hs.exists(l.exists):hs.none()})(e.currentDocument):hs.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(d,h){let f=null;if("setToServerValue"in h)Ke(h.setToServerValue==="REQUEST_TIME",16630,{proto:h}),f=new Bd;else if("appendMissingElements"in h){const b=h.appendMissingElements.values||[];f=new Wl(b)}else if("removeAllFromArray"in h){const b=h.removeAllFromArray.values||[];f=new Kl(b)}else"increment"in h?f=new zd(d,h.increment):ze(16584,{proto:h});const m=us.fromServerFormat(h.fieldPath);return new Pf(m,f)})(s,i))):[];if(e.update){e.update.name;const i=Va(s,e.update.name),l=new un({mapValue:{fields:e.update.fields}});if(e.updateMask){const d=(function(f){const m=f.fieldPaths||[];return new Qn(m.map((b=>us.fromServerFormat(b))))})(e.updateMask);return new ki(i,l,d,t,r)}return new au(i,l,t,r)}if(e.delete){const i=Va(s,e.delete);return new iu(i,t)}if(e.verify){const i=Va(s,e.verify);return new ew(i,t)}return ze(1463,{proto:e})}function DO(s,e){return s&&s.length>0?(Ke(e!==void 0,14353),s.map((t=>(function(i,l){let d=i.updateTime?As(i.updateTime):As(l);return d.isEqual(Ye.min())&&(d=As(l)),new vO(d,i.transformResults||[])})(t,e)))):[]}function t4(s,e){return{documents:[XE(s,e.path)]}}function s4(s,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=XE(s,i);const l=(function(m){if(m.length!==0)return a4(Ht.create(m,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const d=(function(m){if(m.length!==0)return m.map((b=>(function(v){return{field:md(v.field),direction:PO(v.dir)}})(b)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const h=Hy(s,e.limit);return h!==null&&(t.structuredQuery.limit=h),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:t,parent:i}}function n4(s){let e=JE(s.parent);const t=s.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Ke(r===1,65062);const b=t.from[0];b.allDescendants?i=b.collectionId:e=e.child(b.collectionId)}let l=[];t.where&&(l=(function(y){const v=r4(y);return v instanceof Ht&&Yv(v)?v.getFilters():[v]})(t.where));let d=[];t.orderBy&&(d=(function(y){return y.map((v=>(function(E){return new ff(gd(E.field),(function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(E.direction))})(v)))})(t.orderBy));let h=null;t.limit&&(h=(function(y){let v;return v=typeof y=="object"?y.value:y,kf(v)?null:v})(t.limit));let f=null;t.startAt&&(f=(function(y){const v=!!y.before,N=y.values||[];return new Lo(N,v)})(t.startAt));let m=null;return t.endAt&&(m=(function(y){const v=!y.before,N=y.values||[];return new Lo(N,v)})(t.endAt)),AE(e,i,d,l,h,"F",f,m)}function OO(s,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ze(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function r4(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=gd(t.unaryFilter.field);return St.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=gd(t.unaryFilter.field);return St.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=gd(t.unaryFilter.field);return St.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=gd(t.unaryFilter.field);return St.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ze(61313);default:return ze(60726)}})(s):s.fieldFilter!==void 0?(function(t){return St.create(gd(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ze(58110);default:return ze(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return Ht.create(t.compositeFilter.filters.map((r=>r4(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ze(1026)}})(t.compositeFilter.op))})(s):ze(30097,{filter:s})}function PO(s){return SO[s]}function MO(s){return EO[s]}function LO(s){return IO[s]}function md(s){return{fieldPath:s.canonicalString()}}function gd(s){return us.fromServerFormat(s.fieldPath)}function a4(s){return s instanceof St?(function(t){if(t.op==="=="){if(z_(t.value))return{unaryFilter:{field:md(t.field),op:"IS_NAN"}};if(B_(t.value))return{unaryFilter:{field:md(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(z_(t.value))return{unaryFilter:{field:md(t.field),op:"IS_NOT_NAN"}};if(B_(t.value))return{unaryFilter:{field:md(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:md(t.field),op:MO(t.op),value:t.value}}})(s):s instanceof Ht?(function(t){const r=t.getFilters().map((i=>a4(i)));return r.length===1?r[0]:{compositeFilter:{op:LO(t.op),filters:r}}})(s):ze(54877,{filter:s})}function VO(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function i4(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function o4(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e,t,r,i,l=Ye.min(),d=Ye.min(),h=vs.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=h,this.expectedCount=f}withSequenceNumber(e){return new gi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new gi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new gi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new gi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l4{constructor(e){this.yt=e}}function UO(s,e){let t;if(e.document)t=e4(s.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Ue.fromSegments(e.noDocument.path),i=Yl(e.noDocument.readTime);t=rs.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ze(56709);{const r=Ue.fromSegments(e.unknownDocument.path),i=Yl(e.unknownDocument.version);t=rs.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const l=new Vt(i[0],i[1]);return Ye.fromTimestamp(l)})(e.readTime)),t}function a5(s,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:x0(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(l,d){return{name:mf(l,d.key),fields:d.data.value.mapValue.fields,updateTime:$d(l,d.version.toTimestamp()),createTime:$d(l,d.createTime.toTimestamp())}})(s.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ql(e.version)};else{if(!e.isUnknownDocument())return ze(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Ql(e.version)}}return r}function x0(s){const e=s.toTimestamp();return[e.seconds,e.nanoseconds]}function Ql(s){const e=s.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Yl(s){const e=new Vt(s.seconds,s.nanoseconds);return Ye.fromTimestamp(e)}function Al(s,e){const t=(e.baseMutations||[]).map((l=>Ky(s.yt,l)));for(let l=0;l<e.mutations.length-1;++l){const d=e.mutations[l];if(l+1<e.mutations.length&&e.mutations[l+1].transform!==void 0){const h=e.mutations[l+1];d.updateTransforms=h.transform.fieldTransforms,e.mutations.splice(l+1,1),++l}}const r=e.mutations.map((l=>Ky(s.yt,l))),i=Vt.fromMillis(e.localWriteTimeMs);return new tw(e.batchId,i,t,r)}function Dh(s){const e=Yl(s.readTime),t=s.lastLimboFreeSnapshotVersion!==void 0?Yl(s.lastLimboFreeSnapshotVersion):Ye.min();let r;return r=(function(l){return l.documents!==void 0})(s.query)?(function(l){const d=l.documents.length;return Ke(d===1,1966,{count:d}),Pn(ru(JE(l.documents[0])))})(s.query):(function(l){return Pn(n4(l))})(s.query),new gi(r,s.targetId,"TargetPurposeListen",s.lastListenSequenceNumber,e,t,vs.fromBase64String(s.resumeToken))}function c4(s,e){const t=Ql(e.snapshotVersion),r=Ql(e.lastLimboFreeSnapshotVersion);let i;i=m0(e.target)?t4(s.yt,e.target):s4(s.yt,e.target).ft;const l=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Gl(e.target),readTime:t,resumeToken:l,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function iw(s){const e=n4({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?p0(e,e.limit,"L"):e}function Hb(s,e){return new nw(e.largestBatchId,Ky(s.yt,e.overlayMutation))}function i5(s,e){const t=e.path.lastSegment();return[s,Sn(e.path.popLast()),t]}function o5(s,e,t,r){return{indexId:s,uid:e,sequenceNumber:t,readTime:Ql(r.readTime),documentKey:Sn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FO{getBundleMetadata(e,t){return l5(e).get(t).next((r=>{if(r)return(function(l){return{id:l.bundleId,createTime:Yl(l.createTime),version:l.version}})(r)}))}saveBundleMetadata(e,t){return l5(e).put((function(i){return{bundleId:i.id,createTime:Ql(As(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return c5(e).get(t).next((r=>{if(r)return(function(l){return{name:l.name,query:iw(l.bundledQuery),readTime:Yl(l.readTime)}})(r)}))}saveNamedQuery(e,t){return c5(e).put((function(i){return{name:i.name,readTime:Ql(As(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function l5(s){return Ks(s,K0)}function c5(s){return Ks(s,Q0)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new sp(e,r)}getOverlay(e,t){return ph(e).get(i5(this.userId,t)).next((r=>r?Hb(this.serializer,r):null))}getOverlays(e,t){const r=Pa();return le.forEach(t,(i=>this.getOverlay(e,i).next((l=>{l!==null&&r.set(i,l)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((l,d)=>{const h=new nw(t,d);i.push(this.bt(e,h))})),le.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((d=>i.add(Sn(d.getCollectionPath()))));const l=[];return i.forEach((d=>{const h=IDBKeyRange.bound([this.userId,d,r],[this.userId,d,r+1],!1,!0);l.push(ph(e).X(My,h))})),le.waitFor(l)}getOverlaysForCollection(e,t,r){const i=Pa(),l=Sn(t),d=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,Number.POSITIVE_INFINITY],!0);return ph(e).H(My,d).next((h=>{for(const f of h){const m=Hb(this.serializer,f);i.set(m.getKey(),m)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const l=Pa();let d;const h=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ph(e).ee({index:oE,range:h},((f,m,b)=>{const y=Hb(this.serializer,m);l.size()<i||y.largestBatchId===d?(l.set(y.getKey(),y),d=y.largestBatchId):b.done()})).next((()=>l))}bt(e,t){return ph(e).put((function(i,l,d){const[h,f,m]=i5(l,d.mutation.key);return{userId:l,collectionPath:f,documentId:m,collectionGroup:d.mutation.key.getCollectionGroup(),largestBatchId:d.largestBatchId,overlayMutation:gf(i.yt,d.mutation)}})(this.serializer,this.userId,t))}}function ph(s){return Ks(s,Y0)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BO{St(e){return Ks(e,Gv)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const r=t==null?void 0:t.value;return r?vs.fromUint8Array(r):vs.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(ds(e.integerValue));else if("doubleValue"in e){const r=ds(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),af(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Ni(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(_i(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?yE(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Z0(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):ze(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){var d,h;const r=e.fields||{};this.Ft(t,53);const i=Vd,l=((h=(d=r[i].arrayValue)==null?void 0:d.values)==null?void 0:h.length)||0;this.Ft(t,15),t.Mt(ds(l)),this.Ot(i,t),this.Ct(r[i],t)}qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),Ue.fromName(e).path.forEach((r=>{this.Ft(t,60),this.$t(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}kl.Wt=new kl;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nd=255;function zO(s){if(s===0)return 8;let e=0;return s>>4||(e+=4,s<<=4),s>>6||(e+=2,s<<=2),s>>7||(e+=1),e}function d5(s){const e=64-(function(r){let i=0;for(let l=0;l<8;++l){const d=zO(255&r[l]);if(i+=d,d!==8)break}return i})(s);return Math.ceil(e/8)}class $O{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ht(r.value),r=t.next();this.Jt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ht(r);else if(r<2048)this.Ht(960|r>>>6),this.Ht(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|r>>>12),this.Ht(128|63&r>>>6),this.Ht(128|63&r);else{const i=t.codePointAt(0);this.Ht(240|i>>>18),this.Ht(128|63&i>>>12),this.Ht(128|63&i>>>6),this.Ht(128|63&i)}}this.Jt()}Yt(e){const t=this.en(e),r=d5(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=d5(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(nd),this.sn(255)}_n(){this.an(nd),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(l){const d=new DataView(new ArrayBuffer(8));return d.setFloat64(0,l,!1),new Uint8Array(d.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===nd?(this.sn(nd),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===nd?(this.an(nd),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class qO{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class HO{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class xh{constructor(){this.cn=new $O,this.ascending=new qO(this.cn),this.descending=new HO(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(e,t,r,i){this.hn=e,this.Pn=t,this.Tn=r,this.In=i}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.In,0),t!==e?r.set([0],this.In.length):++r[r.length-1],new Cl(this.hn,this.Pn,this.Tn,r)}Rn(e,t,r){return{indexId:this.hn,uid:e,arrayValue:Zg(this.Tn),directionalValue:Zg(this.In),orderedDocumentKey:Zg(t),documentKey:r.path.toArray()}}An(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function fo(s,e){let t=s.hn-e.hn;return t!==0?t:(t=u5(s.Tn,e.Tn),t!==0?t:(t=u5(s.In,e.In),t!==0?t:Ue.comparator(s.Pn,e.Pn)))}function u5(s,e){for(let t=0;t<s.length&&t<e.length;++t){const r=s[t]-e[t];if(r!==0)return r}return s.length-e.length}function Zg(s){return _S()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(s):s}function h5(s){return typeof s!="string"?s:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(s)}class f5{constructor(e){this.Vn=new Gt(((t,r)=>us.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Vn=this.Vn.add(r):this.mn.push(r)}}get fn(){return this.Vn.size>1}gn(e){if(Ke(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=Dy(e);if(t!==void 0&&!this.pn(t))return!1;const r=Tl(e);let i=new Set,l=0,d=0;for(;l<r.length&&this.pn(r[l]);++l)i=i.add(r[l].fieldPath.canonicalString());if(l===r.length)return!0;if(this.Vn.size>0){const h=this.Vn.getIterator().getNext();if(!i.has(h.field.canonicalString())){const f=r[l];if(!this.yn(h,f)||!this.wn(this.dn[d++],f))return!1}++l}for(;l<r.length;++l){const h=r[l];if(d>=this.dn.length||!this.wn(this.dn[d++],h))return!1}return!0}bn(){if(this.fn)return null;let e=new Gt(us.comparator);const t=[];for(const r of this.mn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Hg(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Hg(r.field,0))}for(const r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Hg(r.field,r.dir==="asc"?0:1)));return new d0(d0.UNKNOWN_ID,this.collectionId,t,rf.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d4(s){var t,r;if(Ke(s instanceof St||s instanceof Ht,20012),s instanceof St){if(s instanceof IE){const i=((r=(t=s.value.arrayValue)==null?void 0:t.values)==null?void 0:r.map((l=>St.create(s.field,"==",l))))||[];return Ht.create(i,"or")}return s}const e=s.filters.map((i=>d4(i)));return Ht.create(e,s.op)}function GO(s){if(s.getFilters().length===0)return[];const e=Xy(d4(s));return Ke(u4(e),7391),Qy(e)||Yy(e)?[e]:e.getFilters()}function Qy(s){return s instanceof St}function Yy(s){return s instanceof Ht&&Yv(s)}function u4(s){return Qy(s)||Yy(s)||(function(t){if(t instanceof Ht&&By(t)){for(const r of t.getFilters())if(!Qy(r)&&!Yy(r))return!1;return!0}return!1})(s)}function Xy(s){if(Ke(s instanceof St||s instanceof Ht,34018),s instanceof St)return s;if(s.filters.length===1)return Xy(s.filters[0]);const e=s.filters.map((r=>Xy(r)));let t=Ht.create(e,s.op);return t=b0(t),u4(t)?t:(Ke(t instanceof Ht,64498),Ke(Fd(t),40251),Ke(t.filters.length>1,57927),t.filters.reduce(((r,i)=>ow(r,i))))}function ow(s,e){let t;return Ke(s instanceof St||s instanceof Ht,38388),Ke(e instanceof St||e instanceof Ht,25473),t=s instanceof St?e instanceof St?(function(i,l){return Ht.create([i,l],"and")})(s,e):m5(s,e):e instanceof St?m5(e,s):(function(i,l){if(Ke(i.filters.length>0&&l.filters.length>0,48005),Fd(i)&&Fd(l))return TE(i,l.getFilters());const d=By(i)?i:l,h=By(i)?l:i,f=d.filters.map((m=>ow(m,h)));return Ht.create(f,"or")})(s,e),b0(t)}function m5(s,e){if(Fd(e))return TE(e,s.getFilters());{const t=e.filters.map((r=>ow(s,r)));return Ht.create(t,"or")}}function b0(s){if(Ke(s instanceof St||s instanceof Ht,11850),s instanceof St)return s;const e=s.getFilters();if(e.length===1)return b0(e[0]);if(NE(s))return s;const t=e.map((i=>b0(i))),r=[];return t.forEach((i=>{i instanceof St?r.push(i):i instanceof Ht&&(i.op===s.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Ht.create(r,s.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WO{constructor(){this.Sn=new lw}addToCollectionParentIndex(e,t){return this.Sn.add(t),le.resolve()}getCollectionParents(e,t){return le.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return le.resolve()}deleteFieldIndex(e,t){return le.resolve()}deleteAllFieldIndexes(e){return le.resolve()}createTargetIndexes(e,t){return le.resolve()}getDocumentsMatchingTarget(e,t){return le.resolve(null)}getIndexType(e,t){return le.resolve(0)}getFieldIndexes(e,t){return le.resolve([])}getNextCollectionGroupToUpdate(e){return le.resolve(null)}getMinOffset(e,t){return le.resolve(xr.min())}getMinOffsetFromCollectionGroup(e,t){return le.resolve(xr.min())}updateCollectionGroup(e,t,r){return le.resolve()}updateIndexEntries(e,t){return le.resolve()}}class lw{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Gt(Nt.comparator),l=!i.has(r);return this.index[t]=i.add(r),l}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Gt(Nt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g5="IndexedDbIndexManager",Tg=new Uint8Array(0);class KO{constructor(e,t){this.databaseId=t,this.Dn=new lw,this.Cn=new Ai((r=>Gl(r)),((r,i)=>Rf(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const l={collectionId:r,parent:Sn(i)};return p5(e).put(l)}return le.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[GS(t),""],!1,!0);return p5(e).H(i).next((l=>{for(const d of l){if(d.collectionId!==t)break;r.push(Oa(d.parent))}return r}))}addFieldIndex(e,t){const r=bh(e),i=(function(h){return{indexId:h.indexId,collectionGroup:h.collectionGroup,fields:h.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete i.indexId;const l=r.add(i);if(t.indexState){const d=ad(e);return l.next((h=>{d.put(o5(h,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return l.next()}deleteFieldIndex(e,t){const r=bh(e),i=ad(e),l=rd(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>l.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=bh(e),r=rd(e),i=ad(e);return t.X().next((()=>r.X())).next((()=>i.X()))}createTargetIndexes(e,t){return le.forEach(this.vn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const l=new f5(r).bn();if(l!=null)return this.addFieldIndex(e,l)}}))))}getDocumentsMatchingTarget(e,t){const r=rd(e);let i=!0;const l=new Map;return le.forEach(this.vn(t),(d=>this.Fn(e,d).next((h=>{i&&(i=!!h),l.set(d,h)})))).next((()=>{if(i){let d=ft();const h=[];return le.forEach(l,((f,m)=>{Ce(g5,`Using index ${(function(B){return`id=${B.indexId}|cg=${B.collectionGroup}|f=${B.fields.map((Q=>`${Q.fieldPath}:${Q.kind}`)).join(",")}`})(f)} to execute ${Gl(t)}`);const b=(function(B,Q){const Z=Dy(Q);if(Z===void 0)return null;for(const Y of g0(B,Z.fieldPath))switch(Y.op){case"array-contains-any":return Y.value.arrayValue.values||[];case"array-contains":return[Y.value]}return null})(m,f),y=(function(B,Q){const Z=new Map;for(const Y of Tl(Q))for(const C of g0(B,Y.fieldPath))switch(C.op){case"==":case"in":Z.set(Y.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return Z.set(Y.fieldPath.canonicalString(),C.value),Array.from(Z.values())}return null})(m,f),v=(function(B,Q){const Z=[];let Y=!0;for(const C of Tl(Q)){const P=C.kind===0?W_(B,C.fieldPath,B.startAt):K_(B,C.fieldPath,B.startAt);Z.push(P.value),Y&&(Y=P.inclusive)}return new Lo(Z,Y)})(m,f),N=(function(B,Q){const Z=[];let Y=!0;for(const C of Tl(Q)){const P=C.kind===0?K_(B,C.fieldPath,B.endAt):W_(B,C.fieldPath,B.endAt);Z.push(P.value),Y&&(Y=P.inclusive)}return new Lo(Z,Y)})(m,f),E=this.Mn(f,m,v),I=this.Mn(f,m,N),T=this.xn(f,m,y),L=this.On(f.indexId,b,E,v.inclusive,I,N.inclusive,T);return le.forEach(L,($=>r.Z($,t.limit).next((B=>{B.forEach((Q=>{const Z=Ue.fromSegments(Q.documentKey);d.has(Z)||(d=d.add(Z),h.push(Z))}))}))))})).next((()=>h))}return le.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=GO(Ht.create(e.filters,"and")).map((r=>$y(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,r,i,l,d,h){const f=(t!=null?t.length:1)*Math.max(r.length,l.length),m=f/(t!=null?t.length:1),b=[];for(let y=0;y<f;++y){const v=t?this.Nn(t[y/m]):Tg,N=this.Bn(e,v,r[y%m],i),E=this.Ln(e,v,l[y%m],d),I=h.map((T=>this.Bn(e,v,T,!0)));b.push(...this.createRange(N,E,I))}return b}Bn(e,t,r,i){const l=new Cl(e,Ue.empty(),t,r);return i?l:l.En()}Ln(e,t,r,i){const l=new Cl(e,Ue.empty(),t,r);return i?l.En():l}Fn(e,t){const r=new f5(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((l=>{let d=null;for(const h of l)r.gn(h)&&(!d||h.fields.length>d.fields.length)&&(d=h);return d}))}getIndexType(e,t){let r=2;const i=this.vn(t);return le.forEach(i,(l=>this.Fn(e,l).next((d=>{d?r!==0&&d.fields.length<(function(f){let m=new Gt(us.comparator),b=!1;for(const y of f.filters)for(const v of y.getFlattenedFilters())v.field.isKeyField()||(v.op==="array-contains"||v.op==="array-contains-any"?b=!0:m=m.add(v.field));for(const y of f.orderBy)y.field.isKeyField()||(m=m.add(y.field));return m.size+(b?1:0)})(l)&&(r=1):r=0})))).next((()=>(function(d){return d.limit!==null})(t)&&i.length>1&&r===2?1:r))}kn(e,t){const r=new xh;for(const i of Tl(e)){const l=t.data.field(i.fieldPath);if(l==null)return null;const d=r.ln(i.kind);kl.Wt.Dt(l,d)}return r.un()}Nn(e){const t=new xh;return kl.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const r=new xh;return kl.Wt.Dt(Hl(this.databaseId,t),r.ln((function(l){const d=Tl(l);return d.length===0?0:d[d.length-1].kind})(e))),r.un()}xn(e,t,r){if(r===null)return[];let i=[];i.push(new xh);let l=0;for(const d of Tl(e)){const h=r[l++];for(const f of i)if(this.qn(t,d.fieldPath)&&hf(h))i=this.Un(i,d,h);else{const m=f.ln(d.kind);kl.Wt.Dt(h,m)}}return this.$n(i)}Mn(e,t,r){return this.xn(e,t,r.position)}$n(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Un(e,t,r){const i=[...e],l=[];for(const d of r.arrayValue.values||[])for(const h of i){const f=new xh;f.seed(h.un()),kl.Wt.Dt(d,f.ln(t.kind)),l.push(f)}return l}qn(e,t){return!!e.filters.find((r=>r instanceof St&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=bh(e),i=ad(e);return(t?r.H(Py,IDBKeyRange.bound(t,t)):r.H()).next((l=>{const d=[];return le.forEach(l,(h=>i.get([h.indexId,this.uid]).next((f=>{d.push((function(b,y){const v=y?new rf(y.sequenceNumber,new xr(Yl(y.readTime),new Ue(Oa(y.documentKey)),y.largestBatchId)):rf.empty(),N=b.fields.map((([E,I])=>new Hg(us.fromServerFormat(E),I)));return new d0(b.indexId,b.collectionGroup,N,v)})(h,f))})))).next((()=>d))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const l=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return l!==0?l:ot(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=bh(e),l=ad(e);return this.Wn(e).next((d=>i.H(Py,IDBKeyRange.bound(t,t)).next((h=>le.forEach(h,(f=>l.put(o5(f.indexId,this.uid,d,r))))))))}updateIndexEntries(e,t){const r=new Map;return le.forEach(t,((i,l)=>{const d=r.get(i.collectionGroup);return(d?le.resolve(d):this.getFieldIndexes(e,i.collectionGroup)).next((h=>(r.set(i.collectionGroup,h),le.forEach(h,(f=>this.Qn(e,i,f).next((m=>{const b=this.Gn(l,f);return m.isEqual(b)?le.resolve():this.zn(e,l,f,m,b)})))))))}))}jn(e,t,r,i){return rd(e).put(i.Rn(this.uid,this.Kn(r,t.key),t.key))}Hn(e,t,r,i){return rd(e).delete(i.An(this.uid,this.Kn(r,t.key),t.key))}Qn(e,t,r){const i=rd(e);let l=new Gt(fo);return i.ee({index:iE,range:IDBKeyRange.only([r.indexId,this.uid,Zg(this.Kn(r,t))])},((d,h)=>{l=l.add(new Cl(r.indexId,t,h5(h.arrayValue),h5(h.directionalValue)))})).next((()=>l))}Gn(e,t){let r=new Gt(fo);const i=this.kn(t,e);if(i==null)return r;const l=Dy(t);if(l!=null){const d=e.data.field(l.fieldPath);if(hf(d))for(const h of d.arrayValue.values||[])r=r.add(new Cl(t.indexId,e.key,this.Nn(h),i))}else r=r.add(new Cl(t.indexId,e.key,Tg,i));return r}zn(e,t,r,i,l){Ce(g5,"Updating index entries for document '%s'",t.key);const d=[];return(function(f,m,b,y,v){const N=f.getIterator(),E=m.getIterator();let I=sd(N),T=sd(E);for(;I||T;){let L=!1,$=!1;if(I&&T){const B=b(I,T);B<0?$=!0:B>0&&(L=!0)}else I!=null?$=!0:L=!0;L?(y(T),T=sd(E)):$?(v(I),I=sd(N)):(I=sd(N),T=sd(E))}})(i,l,fo,(h=>{d.push(this.jn(e,t,r,h))}),(h=>{d.push(this.Hn(e,t,r,h))})),le.waitFor(d)}Wn(e){let t=1;return ad(e).ee({index:aE,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,l)=>{l.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((d,h)=>fo(d,h))).filter(((d,h,f)=>!h||fo(d,f[h-1])!==0));const i=[];i.push(e);for(const d of r){const h=fo(d,e),f=fo(d,t);if(h===0)i[0]=e.En();else if(h>0&&f<0)i.push(d),i.push(d.En());else if(f>0)break}i.push(t);const l=[];for(let d=0;d<i.length;d+=2){if(this.Jn(i[d],i[d+1]))return[];const h=i[d].An(this.uid,Tg,Ue.empty()),f=i[d+1].An(this.uid,Tg,Ue.empty());l.push(IDBKeyRange.bound(h,f))}return l}Jn(e,t){return fo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(x5)}getMinOffset(e,t){return le.mapArray(this.vn(t),(r=>this.Fn(e,r).next((i=>i||ze(44426))))).next(x5)}}function p5(s){return Ks(s,cf)}function rd(s){return Ks(s,zh)}function bh(s){return Ks(s,Hv)}function ad(s){return Ks(s,Bh)}function x5(s){Ke(s.length!==0,28825);let e=s[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<s.length;r++){const i=s[r].indexState.offset;zv(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new xr(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b5={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},h4=41943040;class jn{static withCacheSize(e){return new jn(e,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f4(s,e,t){const r=s.store(Xr),i=s.store(Od),l=[],d=IDBKeyRange.only(t.batchId);let h=0;const f=r.ee({range:d},((b,y,v)=>(h++,v.delete())));l.push(f.next((()=>{Ke(h===1,47070,{batchId:t.batchId})})));const m=[];for(const b of t.mutations){const y=sE(e,b.key.path,t.batchId);l.push(i.delete(y)),m.push(b.key)}return le.waitFor(l).next((()=>m))}function y0(s){if(!s)return 0;let e;if(s.document)e=s.document;else if(s.unknownDocument)e=s.unknownDocument;else{if(!s.noDocument)throw ze(14731);e=s.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jn.DEFAULT_COLLECTION_PERCENTILE=10,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,jn.DEFAULT=new jn(h4,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),jn.DISABLED=new jn(-1,0,0);class np{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Zn={}}static wt(e,t,r,i){Ke(e.uid!=="",64387);const l=e.isAuthenticated()?e.uid:"";return new np(l,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return mo(e).ee({index:Dl,range:r},((i,l,d)=>{t=!1,d.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const l=pd(e),d=mo(e);return d.add({}).next((h=>{Ke(typeof h=="number",49019);const f=new tw(h,t,r,i),m=(function(N,E,I){const T=I.baseMutations.map(($=>gf(N.yt,$))),L=I.mutations.map(($=>gf(N.yt,$)));return{userId:E,batchId:I.batchId,localWriteTimeMs:I.localWriteTime.toMillis(),baseMutations:T,mutations:L}})(this.serializer,this.userId,f),b=[];let y=new Gt(((v,N)=>ot(v.canonicalString(),N.canonicalString())));for(const v of i){const N=sE(this.userId,v.key.path,h);y=y.add(v.key.path.popLast()),b.push(d.put(m)),b.push(l.put(N,N6))}return y.forEach((v=>{b.push(this.indexManager.addToCollectionParentIndex(e,v))})),e.addOnCommittedListener((()=>{this.Zn[h]=f.keys()})),le.waitFor(b).next((()=>f))}))}lookupMutationBatch(e,t){return mo(e).get(t).next((r=>r?(Ke(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Al(this.serializer,r)):null))}Xn(e,t){return this.Zn[t]?le.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Zn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let l=null;return mo(e).ee({index:Dl,range:i},((d,h,f)=>{h.userId===this.userId&&(Ke(h.batchId>=r,47524,{Yn:r}),l=Al(this.serializer,h)),f.done()})).next((()=>l))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=To;return mo(e).ee({index:Dl,range:t,reverse:!0},((i,l,d)=>{r=l.batchId,d.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,To],[this.userId,Number.POSITIVE_INFINITY]);return mo(e).H(Dl,t).next((r=>r.map((i=>Al(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Gg(this.userId,t.path),i=IDBKeyRange.lowerBound(r),l=[];return pd(e).ee({range:i},((d,h,f)=>{const[m,b,y]=d,v=Oa(b);if(m===this.userId&&t.path.isEqual(v))return mo(e).get(y).next((N=>{if(!N)throw ze(61480,{er:d,batchId:y});Ke(N.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:N.userId,batchId:y}),l.push(Al(this.serializer,N))}));f.done()})).next((()=>l))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Gt(ot);const i=[];return t.forEach((l=>{const d=Gg(this.userId,l.path),h=IDBKeyRange.lowerBound(d),f=pd(e).ee({range:h},((m,b,y)=>{const[v,N,E]=m,I=Oa(N);v===this.userId&&l.path.isEqual(I)?r=r.add(E):y.done()}));i.push(f)})),le.waitFor(i).next((()=>this.tr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,l=Gg(this.userId,r),d=IDBKeyRange.lowerBound(l);let h=new Gt(ot);return pd(e).ee({range:d},((f,m,b)=>{const[y,v,N]=f,E=Oa(v);y===this.userId&&r.isPrefixOf(E)?E.length===i&&(h=h.add(N)):b.done()})).next((()=>this.tr(e,h)))}tr(e,t){const r=[],i=[];return t.forEach((l=>{i.push(mo(e).get(l).next((d=>{if(d===null)throw ze(35274,{batchId:l});Ke(d.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:d.userId,batchId:l}),r.push(Al(this.serializer,d))})))})),le.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return f4(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),le.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return le.resolve();const r=IDBKeyRange.lowerBound((function(d){return[d]})(this.userId)),i=[];return pd(e).ee({range:r},((l,d,h)=>{if(l[0]===this.userId){const f=Oa(l[1]);i.push(f)}else h.done()})).next((()=>{Ke(i.length===0,56720,{rr:i.map((l=>l.canonicalString()))})}))}))}containsKey(e,t){return m4(e,this.userId,t)}ir(e){return g4(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:To,lastStreamToken:""}))}}function m4(s,e,t){const r=Gg(e,t.path),i=r[1],l=IDBKeyRange.lowerBound(r);let d=!1;return pd(s).ee({range:l,Y:!0},((h,f,m)=>{const[b,y,v]=h;b===e&&y===i&&(d=!0),m.done()})).next((()=>d))}function mo(s){return Ks(s,Xr)}function pd(s){return Ks(s,Od)}function g4(s){return Ks(s,of)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Xl(0)}static ar(){return new Xl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QO{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const r=new Xl(t.highestTargetId);return t.highestTargetId=r.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>Ye.fromTimestamp(new Vt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.ur(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.cr(e,i))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((r=>(r.targetCount+=1,this.hr(t,r),this.cr(e,r))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>id(e).delete(t.targetId))).next((()=>this.ur(e))).next((r=>(Ke(r.targetCount>0,8065),r.targetCount-=1,this.cr(e,r))))}removeTargets(e,t,r){let i=0;const l=[];return id(e).ee(((d,h)=>{const f=Dh(h);f.sequenceNumber<=t&&r.get(f.targetId)===null&&(i++,l.push(this.removeTargetData(e,f)))})).next((()=>le.waitFor(l))).next((()=>i))}forEachTarget(e,t){return id(e).ee(((r,i)=>{const l=Dh(i);t(l)}))}ur(e){return y5(e).get(f0).next((t=>(Ke(t!==null,2888),t)))}cr(e,t){return y5(e).put(f0,t)}lr(e,t){return id(e).put(c4(this.serializer,t))}hr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const r=Gl(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let l=null;return id(e).ee({range:i,index:rE},((d,h,f)=>{const m=Dh(h);Rf(t,m.target)&&(l=m,f.done())})).next((()=>l))}addMatchingKeys(e,t,r){const i=[],l=yo(e);return t.forEach((d=>{const h=Sn(d.path);i.push(l.put({targetId:r,path:h})),i.push(this.referenceDelegate.addReference(e,r,d))})),le.waitFor(i)}removeMatchingKeys(e,t,r){const i=yo(e);return le.forEach(t,(l=>{const d=Sn(l.path);return le.waitFor([i.delete([r,d]),this.referenceDelegate.removeReference(e,r,l)])}))}removeMatchingKeysForTargetId(e,t){const r=yo(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=yo(e);let l=ft();return i.ee({range:r,Y:!0},((d,h,f)=>{const m=Oa(d[1]),b=new Ue(m);l=l.add(b)})).next((()=>l))}containsKey(e,t){const r=Sn(t.path),i=IDBKeyRange.bound([r],[GS(r)],!1,!0);let l=0;return yo(e).ee({index:qv,Y:!0,range:i},(([d,h],f,m)=>{d!==0&&(l++,m.done())})).next((()=>l>0))}At(e,t){return id(e).get(t).next((r=>r?Dh(r):null))}}function id(s){return Ks(s,Pd)}function y5(s){return Ks(s,Ul)}function yo(s){return Ks(s,Md)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v5="LruGarbageCollector",YO=1048576;function w5([s,e],[t,r]){const i=ot(s,t);return i===0?ot(e,r):i}class XO{constructor(e){this.Pr=e,this.buffer=new Gt(w5),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();w5(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class p4{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Ce(v5,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){zo(t)?Ce(v5,"Ignoring IndexedDB error during garbage collection: ",t):await Bo(t)}await this.Ar(3e5)}))}}class JO{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return le.resolve(Kn.ce);const r=new XO(t);return this.Vr.forEachTarget(e,(i=>r.Er(i.sequenceNumber))).next((()=>this.Vr.mr(e,(i=>r.Er(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ce("LruGarbageCollector","Garbage collection skipped; disabled"),le.resolve(b5)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),b5):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let r,i,l,d,h,f,m;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((y=>(y>this.params.maximumSequenceNumbersToCollect?(Ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),i=this.params.maximumSequenceNumbersToCollect):i=y,d=Date.now(),this.nthSequenceNumber(e,i)))).next((y=>(r=y,h=Date.now(),this.removeTargets(e,r,t)))).next((y=>(l=y,f=Date.now(),this.removeOrphanedDocuments(e,r)))).next((y=>(m=Date.now(),hd()<=wt.DEBUG&&Ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-b}ms
	Determined least recently used ${i} in `+(h-d)+`ms
	Removed ${l} targets in `+(f-h)+`ms
	Removed ${y} documents in `+(m-f)+`ms
Total Duration: ${m-b}ms`),le.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:l,documentsRemoved:y}))))}}function x4(s,e){return new JO(s,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(e,t){this.db=e,this.garbageCollector=x4(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}pr(e){let t=0;return this.mr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((r,i)=>t(i)))}addReference(e,t,r){return Sg(e,r)}removeReference(e,t,r){return Sg(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Sg(e,t)}wr(e,t){return(function(i,l){let d=!1;return g4(i).te((h=>m4(i,h,l).next((f=>(f&&(d=!0),le.resolve(!f)))))).next((()=>d))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let l=0;return this.yr(e,((d,h)=>{if(h<=t){const f=this.wr(e,d).next((m=>{if(!m)return l++,r.getEntry(e,d).next((()=>(r.removeEntry(d,Ye.min()),yo(e).delete((function(y){return[0,Sn(y.path)]})(d)))))}));i.push(f)}})).next((()=>le.waitFor(i))).next((()=>r.apply(e))).next((()=>l))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Sg(e,t)}yr(e,t){const r=yo(e);let i,l=Kn.ce;return r.ee({index:qv},(([d,h],{path:f,sequenceNumber:m})=>{d===0?(l!==Kn.ce&&t(new Ue(Oa(i)),l),l=m,i=f):l=Kn.ce})).next((()=>{l!==Kn.ce&&t(new Ue(Oa(i)),l)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Sg(s,e){return yo(s).put((function(r,i){return{targetId:0,path:Sn(r.path),sequenceNumber:i}})(e,s.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{constructor(){this.changes=new Ai((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,rs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?le.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return jl(e).put(r)}removeEntry(e,t,r){return jl(e).delete((function(l,d){const h=l.path.toArray();return[h.slice(0,h.length-2),h[h.length-2],x0(d),h[h.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.br(e,r))))}getEntry(e,t){let r=rs.newInvalidDocument(t);return jl(e).ee({index:Wg,range:IDBKeyRange.only(yh(t))},((i,l)=>{r=this.Sr(t,l)})).next((()=>r))}Dr(e,t){let r={size:0,document:rs.newInvalidDocument(t)};return jl(e).ee({index:Wg,range:IDBKeyRange.only(yh(t))},((i,l)=>{r={document:this.Sr(t,l),size:y0(l)}})).next((()=>r))}getEntries(e,t){let r=Yn();return this.Cr(e,t,((i,l)=>{const d=this.Sr(i,l);r=r.insert(i,d)})).next((()=>r))}vr(e,t){let r=Yn(),i=new ts(Ue.comparator);return this.Cr(e,t,((l,d)=>{const h=this.Sr(l,d);r=r.insert(l,h),i=i.insert(l,y0(d))})).next((()=>({documents:r,Fr:i})))}Cr(e,t,r){if(t.isEmpty())return le.resolve();let i=new Gt(_5);t.forEach((f=>i=i.add(f)));const l=IDBKeyRange.bound(yh(i.first()),yh(i.last())),d=i.getIterator();let h=d.getNext();return jl(e).ee({index:Wg,range:l},((f,m,b)=>{const y=Ue.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;h&&_5(h,y)<0;)r(h,null),h=d.getNext();h&&h.isEqual(y)&&(r(h,m),h=d.hasNext()?d.getNext():null),h?b.j(yh(h)):b.done()})).next((()=>{for(;h;)r(h,null),h=d.hasNext()?d.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,l){const d=t.path,h=[d.popLast().toArray(),d.lastSegment(),x0(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],f=[d.popLast().toArray(),d.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return jl(e).H(IDBKeyRange.bound(h,f,!0)).next((m=>{l==null||l.incrementDocumentReadCount(m.length);let b=Yn();for(const y of m){const v=this.Sr(Ue.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);v.isFoundDocument()&&(Of(t,v)||i.has(v.key))&&(b=b.insert(v.key,v))}return b}))}getAllFromCollectionGroup(e,t,r,i){let l=Yn();const d=N5(t,r),h=N5(t,xr.max());return jl(e).ee({index:nE,range:IDBKeyRange.bound(d,h,!0)},((f,m,b)=>{const y=this.Sr(Ue.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);l=l.insert(y.key,y),l.size===i&&b.done()})).next((()=>l))}newChangeBuffer(e){return new tP(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return j5(e).get(Oy).next((t=>(Ke(!!t,20021),t)))}br(e,t){return j5(e).put(Oy,t)}Sr(e,t){if(t){const r=UO(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Ye.min())))return r}return rs.newInvalidDocument(e)}}function y4(s){return new eP(s)}class tP extends b4{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new Ai((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new Gt(((l,d)=>ot(l.canonicalString(),d.canonicalString())));return this.changes.forEach(((l,d)=>{const h=this.Or.get(l);if(t.push(this.Mr.removeEntry(e,l,h.readTime)),d.isValidDocument()){const f=a5(this.Mr.serializer,d);i=i.add(l.path.popLast());const m=y0(f);r+=m-h.size,t.push(this.Mr.addEntry(e,l,f))}else if(r-=h.size,this.trackRemovals){const f=a5(this.Mr.serializer,d.convertToNoDocument(Ye.min()));t.push(this.Mr.addEntry(e,l,f))}})),i.forEach((l=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,l))})),t.push(this.Mr.updateMetadata(e,r)),le.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((r=>(this.Or.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:r,Fr:i})=>(i.forEach(((l,d)=>{this.Or.set(l,{size:d,readTime:r.get(l).readTime})})),r)))}}function j5(s){return Ks(s,lf)}function jl(s){return Ks(s,h0)}function yh(s){const e=s.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function N5(s,e){const t=e.documentKey.path.toArray();return[s,x0(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function _5(s,e){const t=s.path.toArray(),r=e.path.toArray();let i=0;for(let l=0;l<t.length-2&&l<r.length-2;++l)if(i=ot(t[l],r[l]),i)return i;return i=ot(t.length,r.length),i||(i=ot(t[t.length-2],r[r.length-2]),i||ot(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v4{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Hh(r.mutation,i,Qn.empty(),Vt.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,ft()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=ft()){const i=Pa();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((l=>{let d=Ch();return l.forEach(((h,f)=>{d=d.insert(h,f.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const r=Pa();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,ft())))}populateOverlays(e,t,r){const i=[];return r.forEach((l=>{t.has(l)||i.push(l)})),this.documentOverlayCache.getOverlays(e,i).next((l=>{l.forEach(((d,h)=>{t.set(d,h)}))}))}computeViews(e,t,r,i){let l=Yn();const d=qh(),h=(function(){return qh()})();return t.forEach(((f,m)=>{const b=r.get(m.key);i.has(m.key)&&(b===void 0||b.mutation instanceof ki)?l=l.insert(m.key,m):b!==void 0?(d.set(m.key,b.mutation.getFieldMask()),Hh(b.mutation,m,b.mutation.getFieldMask(),Vt.now())):d.set(m.key,Qn.empty())})),this.recalculateAndSaveOverlays(e,l).next((f=>(f.forEach(((m,b)=>d.set(m,b))),t.forEach(((m,b)=>h.set(m,new sP(b,d.get(m)??null)))),h)))}recalculateAndSaveOverlays(e,t){const r=qh();let i=new ts(((d,h)=>d-h)),l=ft();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const h of d)h.keys().forEach((f=>{const m=t.get(f);if(m===null)return;let b=r.get(f)||Qn.empty();b=h.applyToLocalView(m,b),r.set(f,b);const y=(i.get(h.batchId)||ft()).add(f);i=i.insert(h.batchId,y)}))})).next((()=>{const d=[],h=i.getReverseIterator();for(;h.hasNext();){const f=h.getNext(),m=f.key,b=f.value,y=PE();b.forEach((v=>{if(!l.has(v)){const N=zE(t.get(v),r.get(v));N!==null&&y.set(v,N),l=l.add(v)}})),d.push(this.documentOverlayCache.saveOverlays(e,m,y))}return le.waitFor(d)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return oO(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Xv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((l=>{const d=i-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-l.size):le.resolve(Pa());let h=Dd,f=l;return d.next((m=>le.forEach(m,((b,y)=>(h<y.largestBatchId&&(h=y.largestBatchId),l.get(b)?le.resolve():this.remoteDocumentCache.getEntry(e,b).next((v=>{f=f.insert(b,v)}))))).next((()=>this.populateOverlays(e,m,l))).next((()=>this.computeViews(e,f,m,ft()))).next((b=>({batchId:h,changes:OE(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ue(t)).next((r=>{let i=Ch();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const l=t.collectionGroup;let d=Ch();return this.indexManager.getCollectionParents(e,l).next((h=>le.forEach(h,(f=>{const m=(function(y,v){return new Ii(v,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)})(t,f.child(l));return this.getDocumentsMatchingCollectionQuery(e,m,r,i).next((b=>{b.forEach(((y,v)=>{d=d.insert(y,v)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((d=>(l=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,l,i)))).next((d=>{l.forEach(((f,m)=>{const b=m.getKey();d.get(b)===null&&(d=d.insert(b,rs.newInvalidDocument(b)))}));let h=Ch();return d.forEach(((f,m)=>{const b=l.get(f);b!==void 0&&Hh(b.mutation,m,Qn.empty(),Vt.now()),Of(t,m)&&(h=h.insert(f,m))})),h}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return le.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:As(i.createTime)}})(t)),le.resolve()}getNamedQuery(e,t){return le.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(i){return{name:i.name,query:iw(i.bundledQuery),readTime:As(i.readTime)}})(t)),le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(){this.overlays=new ts(Ue.comparator),this.Lr=new Map}getOverlay(e,t){return le.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Pa();return le.forEach(t,(i=>this.getOverlay(e,i).next((l=>{l!==null&&r.set(i,l)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,l)=>{this.bt(e,t,l)})),le.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Lr.get(r);return i!==void 0&&(i.forEach((l=>this.overlays=this.overlays.remove(l))),this.Lr.delete(r)),le.resolve()}getOverlaysForCollection(e,t,r){const i=Pa(),l=t.length+1,d=new Ue(t.child("")),h=this.overlays.getIteratorFrom(d);for(;h.hasNext();){const f=h.getNext().value,m=f.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===l&&f.largestBatchId>r&&i.set(f.getKey(),f)}return le.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let l=new ts(((m,b)=>m-b));const d=this.overlays.getIterator();for(;d.hasNext();){const m=d.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>r){let b=l.get(m.largestBatchId);b===null&&(b=Pa(),l=l.insert(m.largestBatchId,b)),b.set(m.getKey(),m)}}const h=Pa(),f=l.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((m,b)=>h.set(m,b))),!(h.size()>=i)););return le.resolve(h)}bt(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const d=this.Lr.get(i.largestBatchId).delete(r.key);this.Lr.set(i.largestBatchId,d)}this.overlays=this.overlays.insert(r.key,new nw(t,r));let l=this.Lr.get(t);l===void 0&&(l=ft(),this.Lr.set(t,l)),this.Lr.set(t,l.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(){this.sessionToken=vs.EMPTY_BYTE_STRING}getSessionToken(e){return le.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(){this.kr=new Gt(Zs.Kr),this.qr=new Gt(Zs.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const r=new Zs(e,t);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Wr(new Zs(e,t))}Qr(e,t){e.forEach((r=>this.removeReference(r,t)))}Gr(e){const t=new Ue(new Nt([])),r=new Zs(t,e),i=new Zs(t,e+1),l=[];return this.qr.forEachInRange([r,i],(d=>{this.Wr(d),l.push(d.key)})),l}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Ue(new Nt([])),r=new Zs(t,e),i=new Zs(t,e+1);let l=ft();return this.qr.forEachInRange([r,i],(d=>{l=l.add(d.key)})),l}containsKey(e){const t=new Zs(e,0),r=this.kr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Zs{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Ue.comparator(e.key,t.key)||ot(e.Hr,t.Hr)}static Ur(e,t){return ot(e.Hr,t.Hr)||Ue.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Gt(Zs.Kr)}checkEmpty(e){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const l=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new tw(l,t,r,i);this.mutationQueue.push(d);for(const h of i)this.Jr=this.Jr.add(new Zs(h.key,l)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return le.resolve(d)}lookupMutationBatch(e,t){return le.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.Xr(r),l=i<0?0:i;return le.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?To:this.Yn-1)}getAllMutationBatches(e){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Zs(t,0),i=new Zs(t,Number.POSITIVE_INFINITY),l=[];return this.Jr.forEachInRange([r,i],(d=>{const h=this.Zr(d.Hr);l.push(h)})),le.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Gt(ot);return t.forEach((i=>{const l=new Zs(i,0),d=new Zs(i,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([l,d],(h=>{r=r.add(h.Hr)}))})),le.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let l=r;Ue.isDocumentKey(l)||(l=l.child(""));const d=new Zs(new Ue(l),0);let h=new Gt(ot);return this.Jr.forEachWhile((f=>{const m=f.key.path;return!!r.isPrefixOf(m)&&(m.length===i&&(h=h.add(f.Hr)),!0)}),d),le.resolve(this.Yr(h))}Yr(e){const t=[];return e.forEach((r=>{const i=this.Zr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Ke(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return le.forEach(t.mutations,(i=>{const l=new Zs(i.key,t.batchId);return r=r.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Jr=r}))}nr(e){}containsKey(e,t){const r=new Zs(t,0),i=this.Jr.firstAfterOrEqual(r);return le.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,le.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oP{constructor(e){this.ti=e,this.docs=(function(){return new ts(Ue.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),l=i?i.size:0,d=this.ti(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:d}),this.size+=d-l,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return le.resolve(r?r.document.mutableCopy():rs.newInvalidDocument(t))}getEntries(e,t){let r=Yn();return t.forEach((i=>{const l=this.docs.get(i);r=r.insert(i,l?l.document.mutableCopy():rs.newInvalidDocument(i))})),le.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let l=Yn();const d=t.path,h=new Ue(d.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(h);for(;f.hasNext();){const{key:m,value:{document:b}}=f.getNext();if(!d.isPrefixOf(m.path))break;m.path.length>d.length+1||zv(XS(b),r)<=0||(i.has(b.key)||Of(t,b))&&(l=l.insert(b.key,b.mutableCopy()))}return le.resolve(l)}getAllFromCollectionGroup(e,t,r,i){ze(9500)}ni(e,t){return le.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new lP(this)}getSize(e){return le.resolve(this.size)}}class lP extends b4{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Mr.addEntry(e,i)):this.Mr.removeEntry(r)})),le.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(e){this.persistence=e,this.ri=new Ai((t=>Gl(t)),Rf),this.lastRemoteSnapshotVersion=Ye.min(),this.highestTargetId=0,this.ii=0,this.si=new cw,this.targetCount=0,this.oi=Xl._r()}forEachTarget(e,t){return this.ri.forEach(((r,i)=>t(i))),le.resolve()}getLastRemoteSnapshotVersion(e){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return le.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ii&&(this.ii=t),le.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Xl(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,le.resolve()}updateTargetData(e,t){return this.lr(t),le.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,le.resolve()}removeTargets(e,t,r){let i=0;const l=[];return this.ri.forEach(((d,h)=>{h.sequenceNumber<=t&&r.get(h.targetId)===null&&(this.ri.delete(d),l.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)})),le.waitFor(l).next((()=>i))}getTargetCount(e){return le.resolve(this.targetCount)}getTargetData(e,t){const r=this.ri.get(t)||null;return le.resolve(r)}addMatchingKeys(e,t,r){return this.si.$r(t,r),le.resolve()}removeMatchingKeys(e,t,r){this.si.Qr(t,r);const i=this.persistence.referenceDelegate,l=[];return i&&t.forEach((d=>{l.push(i.markPotentiallyOrphaned(e,d))})),le.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),le.resolve()}getMatchingKeysForTargetId(e,t){const r=this.si.jr(t);return le.resolve(r)}containsKey(e,t){return le.resolve(this.si.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw{constructor(e,t){this._i={},this.overlays={},this.ai=new Kn(0),this.ui=!1,this.ui=!0,this.ci=new aP,this.referenceDelegate=e(this),this.li=new cP(this),this.indexManager=new WO,this.remoteDocumentCache=(function(i){return new oP(i)})((r=>this.referenceDelegate.hi(r))),this.serializer=new l4(t),this.Pi=new nP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new rP,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this._i[e.toKey()];return r||(r=new iP(t,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,r){Ce("MemoryPersistence","Starting transaction:",e);const i=new dP(this.ai.next());return this.referenceDelegate.Ti(),r(i).next((l=>this.referenceDelegate.Ii(i).next((()=>l)))).toPromise().then((l=>(i.raiseOnCommittedEvent(),l)))}Ei(e,t){return le.or(Object.values(this._i).map((r=>()=>r.containsKey(e,t))))}}class dP extends ZS{constructor(e){super(),this.currentSequenceNumber=e}}class rp{constructor(e){this.persistence=e,this.Ri=new cw,this.Ai=null}static Vi(e){return new rp(e)}get di(){if(this.Ai)return this.Ai;throw ze(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.di.delete(r.toString()),le.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.di.add(r.toString()),le.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),le.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((i=>this.di.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((l=>this.di.add(l.toString())))})).next((()=>r.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.di,(r=>{const i=Ue.fromPath(r);return this.mi(e,i).next((l=>{l||t.removeEntry(i,Ye.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return le.or([()=>le.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class v0{constructor(e,t){this.persistence=e,this.fi=new Ai((r=>Sn(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=x4(this,t)}static Vi(e,t){return new v0(e,t)}Ti(){}Ii(e){return le.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}pr(e){let t=0;return this.mr(e,(r=>{t++})).next((()=>t))}mr(e,t){return le.forEach(this.fi,((r,i)=>this.wr(e,r,i).next((l=>l?le.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),l=i.newChangeBuffer();return i.ni(e,(d=>this.wr(e,d,t).next((h=>{h||(r++,l.removeEntry(d,Ye.min()))})))).next((()=>l.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),le.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),le.resolve()}removeReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),le.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),le.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Qg(e.data.value)),t}wr(e,t,r){return le.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.fi.get(t);return le.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uP{constructor(e){this.serializer=e}k(e,t,r,i){const l=new W0("createOrUpgrade",t);r<1&&i>=1&&((function(f){f.createObjectStore(Cf)})(e),(function(f){f.createObjectStore(of,{keyPath:j6}),f.createObjectStore(Xr,{keyPath:P_,autoIncrement:!0}).createIndex(Dl,M_,{unique:!0}),f.createObjectStore(Od)})(e),T5(e),(function(f){f.createObjectStore(Sl)})(e));let d=le.resolve();return r<3&&i>=3&&(r!==0&&((function(f){f.deleteObjectStore(Md),f.deleteObjectStore(Pd),f.deleteObjectStore(Ul)})(e),T5(e)),d=d.next((()=>(function(f){const m=f.store(Ul),b={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ye.min().toTimestamp(),targetCount:0};return m.put(f0,b)})(l)))),r<4&&i>=4&&(r!==0&&(d=d.next((()=>(function(f,m){return m.store(Xr).H().next((y=>{f.deleteObjectStore(Xr),f.createObjectStore(Xr,{keyPath:P_,autoIncrement:!0}).createIndex(Dl,M_,{unique:!0});const v=m.store(Xr),N=y.map((E=>v.put(E)));return le.waitFor(N)}))})(e,l)))),d=d.next((()=>{(function(f){f.createObjectStore(Ld,{keyPath:C6})})(e)}))),r<5&&i>=5&&(d=d.next((()=>this.gi(l)))),r<6&&i>=6&&(d=d.next((()=>((function(f){f.createObjectStore(lf)})(e),this.pi(l))))),r<7&&i>=7&&(d=d.next((()=>this.yi(l)))),r<8&&i>=8&&(d=d.next((()=>this.wi(e,l)))),r<9&&i>=9&&(d=d.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(d=d.next((()=>this.bi(l)))),r<11&&i>=11&&(d=d.next((()=>{(function(f){f.createObjectStore(K0,{keyPath:R6})})(e),(function(f){f.createObjectStore(Q0,{keyPath:D6})})(e)}))),r<12&&i>=12&&(d=d.next((()=>{(function(f){const m=f.createObjectStore(Y0,{keyPath:F6});m.createIndex(My,B6,{unique:!1}),m.createIndex(oE,z6,{unique:!1})})(e)}))),r<13&&i>=13&&(d=d.next((()=>(function(f){const m=f.createObjectStore(h0,{keyPath:_6});m.createIndex(Wg,T6),m.createIndex(nE,S6)})(e))).next((()=>this.Si(e,l))).next((()=>e.deleteObjectStore(Sl)))),r<14&&i>=14&&(d=d.next((()=>this.Di(e,l)))),r<15&&i>=15&&(d=d.next((()=>(function(f){f.createObjectStore(Hv,{keyPath:O6,autoIncrement:!0}).createIndex(Py,P6,{unique:!1}),f.createObjectStore(Bh,{keyPath:M6}).createIndex(aE,L6,{unique:!1}),f.createObjectStore(zh,{keyPath:V6}).createIndex(iE,U6,{unique:!1})})(e)))),r<16&&i>=16&&(d=d.next((()=>{t.objectStore(Bh).clear()})).next((()=>{t.objectStore(zh).clear()}))),r<17&&i>=17&&(d=d.next((()=>{(function(f){f.createObjectStore(Gv,{keyPath:$6})})(e)}))),r<18&&i>=18&&_S()&&(d=d.next((()=>{t.objectStore(Bh).clear()})).next((()=>{t.objectStore(zh).clear()}))),d}pi(e){let t=0;return e.store(Sl).ee(((r,i)=>{t+=y0(i)})).next((()=>{const r={byteSize:t};return e.store(lf).put(Oy,r)}))}gi(e){const t=e.store(of),r=e.store(Xr);return t.H().next((i=>le.forEach(i,(l=>{const d=IDBKeyRange.bound([l.userId,To],[l.userId,l.lastAcknowledgedBatchId]);return r.H(Dl,d).next((h=>le.forEach(h,(f=>{Ke(f.userId===l.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const m=Al(this.serializer,f);return f4(e,l.userId,m).next((()=>{}))}))))}))))}yi(e){const t=e.store(Md),r=e.store(Sl);return e.store(Ul).get(f0).next((i=>{const l=[];return r.ee(((d,h)=>{const f=new Nt(d),m=(function(y){return[0,Sn(y)]})(f);l.push(t.get(m).next((b=>b?le.resolve():(y=>t.put({targetId:0,path:Sn(y),sequenceNumber:i.highestListenSequenceNumber}))(f))))})).next((()=>le.waitFor(l)))}))}wi(e,t){e.createObjectStore(cf,{keyPath:k6});const r=t.store(cf),i=new lw,l=d=>{if(i.add(d)){const h=d.lastSegment(),f=d.popLast();return r.put({collectionId:h,parent:Sn(f)})}};return t.store(Sl).ee({Y:!0},((d,h)=>{const f=new Nt(d);return l(f.popLast())})).next((()=>t.store(Od).ee({Y:!0},(([d,h,f],m)=>{const b=Oa(h);return l(b.popLast())}))))}bi(e){const t=e.store(Pd);return t.ee(((r,i)=>{const l=Dh(i),d=c4(this.serializer,l);return t.put(d)}))}Si(e,t){const r=t.store(Sl),i=[];return r.ee(((l,d)=>{const h=t.store(h0),f=(function(y){return y.document?new Ue(Nt.fromString(y.document.name).popFirst(5)):y.noDocument?Ue.fromSegments(y.noDocument.path):y.unknownDocument?Ue.fromSegments(y.unknownDocument.path):ze(36783)})(d).path.toArray(),m={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:d.readTime||[0,0],unknownDocument:d.unknownDocument,noDocument:d.noDocument,document:d.document,hasCommittedMutations:!!d.hasCommittedMutations};i.push(h.put(m))})).next((()=>le.waitFor(i)))}Di(e,t){const r=t.store(Xr),i=y4(this.serializer),l=new dw(rp.Vi,this.serializer.yt);return r.H().next((d=>{const h=new Map;return d.forEach((f=>{let m=h.get(f.userId)??ft();Al(this.serializer,f).keys().forEach((b=>m=m.add(b))),h.set(f.userId,m)})),le.forEach(h,((f,m)=>{const b=new en(m),y=sp.wt(this.serializer,b),v=l.getIndexManager(b),N=np.wt(b,this.serializer,v,l.referenceDelegate);return new v4(i,N,y,v).recalculateAndSaveOverlaysForDocumentKeys(new Ly(t,Kn.ce),f).next()}))}))}}function T5(s){s.createObjectStore(Md,{keyPath:I6}).createIndex(qv,A6,{unique:!0}),s.createObjectStore(Pd,{keyPath:"targetId"}).createIndex(rE,E6,{unique:!0}),s.createObjectStore(Ul)}const go="IndexedDbPersistence",Gb=18e5,Wb=5e3,Kb="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",w4="main";class uw{constructor(e,t,r,i,l,d,h,f,m,b,y=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Ci=l,this.window=d,this.document=h,this.Fi=m,this.Mi=b,this.xi=y,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=v=>Promise.resolve(),!uw.v())throw new Ae(xe.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new ZO(this,i),this.Ki=t+w4,this.serializer=new l4(f),this.qi=new La(this.Ki,this.xi,new uP(this.serializer)),this.ci=new BO,this.li=new QO(this.referenceDelegate,this.serializer),this.remoteDocumentCache=y4(this.serializer),this.Pi=new FO,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,b===!1&&Es(go,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ae(xe.FAILED_PRECONDITION,Kb);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new Kn(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Eg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(zo(e))return Ce(go,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ce(go,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return vh(e).get(td).next((t=>le.resolve(this.Xi(t))))}Yi(e){return Eg(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,Gb)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=Ks(t,Ld);return r.H().next((i=>{const l=this.ns(i,Gb),d=i.filter((h=>l.indexOf(h)===-1));return le.forEach(d,(h=>r.delete(h.clientId))).next((()=>d))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?le.resolve(!0):vh(e).get(td).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Wb)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new Ae(xe.FAILED_PRECONDITION,Kb);return!1}}return!(!this.networkEnabled||!this.inForeground)||Eg(e).H().next((r=>this.ns(r,Wb).find((i=>{if(this.clientId!==i.clientId){const l=!this.networkEnabled&&i.networkEnabled,d=!this.inForeground&&i.inForeground,h=this.networkEnabled===i.networkEnabled;if(l||d&&h)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Ce(go,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[Cf,Ld],(e=>{const t=new Ly(e,Kn.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((r=>this.ts(r.updateTimeMs,t)&&!this.ss(r.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>Eg(e).H().next((t=>this.ns(t,Gb).map((r=>r.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return np.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new KO(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return sp.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,r){Ce(go,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",l=(function(f){return f===18?G6:f===17?uE:f===16?H6:f===15?Wv:f===14?dE:f===13?cE:f===12?q6:f===11?lE:void ze(60245)})(this.xi);let d;return this.qi.runTransaction(e,i,l,(h=>(d=new Ly(h,this.ai?this.ai.next():Kn.ce),t==="readwrite-primary"?this.ji(d).next((f=>!!f||this.Hi(d))).next((f=>{if(!f)throw Es(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new Ae(xe.FAILED_PRECONDITION,JS);return r(d)})).next((f=>this.Zi(d).next((()=>f)))):this.Ps(d).next((()=>r(d)))))).then((h=>(d.raiseOnCommittedEvent(),h)))}Ps(e){return vh(e).get(td).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Wb)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ae(xe.FAILED_PRECONDITION,Kb)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return vh(e).put(td,t)}static v(){return La.v()}Ji(e){const t=vh(e);return t.get(td).next((r=>this.Xi(r)?(Ce(go,"Releasing primary lease."),t.delete(td)):le.resolve()))}ts(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Es(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Oi=()=>{this._s();const t=/(?:Version|Mobile)\/1[456]/;NS()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){var t;try{const r=((t=this.Ui)==null?void 0:t.getItem(this.rs(e)))!==null;return Ce(go,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Es(go,"Failed to get zombied client id.",r),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){Es("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function vh(s){return Ks(s,Cf)}function Eg(s){return Ks(s,Ld)}function hw(s,e){let t=s.projectId;return s.isDefaultDatabase||(t+="."+s.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Ts=r,this.Is=i}static Es(e,t){let r=ft(),i=ft();for(const l of t.docChanges)switch(l.type){case 0:r=r.add(l.doc.key);break;case 1:i=i.add(l.doc.key)}return new fw(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return NS()?8:eE(ms())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const l={result:null};return this.gs(e,t).next((d=>{l.result=d})).next((()=>{if(!l.result)return this.ps(e,t,i,r).next((d=>{l.result=d}))})).next((()=>{if(l.result)return;const d=new hP;return this.ys(e,t,d).next((h=>{if(l.result=h,this.As)return this.ws(e,t,d,h.size)}))})).next((()=>l.result))}ws(e,t,r,i){return r.documentReadCount<this.Vs?(hd()<=wt.DEBUG&&Ce("QueryEngine","SDK will not create cache indexes for query:",fd(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),le.resolve()):(hd()<=wt.DEBUG&&Ce("QueryEngine","Query:",fd(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(hd()<=wt.DEBUG&&Ce("QueryEngine","The SDK decides to create cache indexes for query:",fd(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Pn(t))):le.resolve())}gs(e,t){if(Q_(t))return le.resolve(null);let r=Pn(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=p0(t,null,"F"),r=Pn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((l=>{const d=ft(...l);return this.fs.getDocuments(e,d).next((h=>this.indexManager.getMinOffset(e,r).next((f=>{const m=this.bs(t,h);return this.Ss(t,m,d,f.readTime)?this.gs(e,p0(t,null,"F")):this.Ds(e,m,t,f)}))))})))))}ps(e,t,r,i){return Q_(t)||i.isEqual(Ye.min())?le.resolve(null):this.fs.getDocuments(e,r).next((l=>{const d=this.bs(t,l);return this.Ss(t,d,r,i)?le.resolve(null):(hd()<=wt.DEBUG&&Ce("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),fd(t)),this.Ds(e,d,t,YS(i,Dd)).next((h=>h)))}))}bs(e,t){let r=new Gt(RE(e));return t.forEach(((i,l)=>{Of(e,l)&&(r=r.add(l))})),r}Ss(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(i)>0)}ys(e,t,r){return hd()<=wt.DEBUG&&Ce("QueryEngine","Using full collection scan to execute query:",fd(t)),this.fs.getDocumentsMatchingQuery(e,t,xr.min(),r)}Ds(e,t,r,i){return this.fs.getDocumentsMatchingQuery(e,r,i).next((l=>(t.forEach((d=>{l=l.insert(d.key,d)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mw="LocalStore",fP=3e8;class mP{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.vs=new ts(ot),this.Fs=new Ai((l=>Gl(l)),Rf),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new v4(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function N4(s,e,t,r){return new mP(s,e,t,r)}async function _4(s,e){const t=Be(s);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((l=>(i=l,t.Os(e),t.mutationQueue.getAllMutationBatches(r)))).next((l=>{const d=[],h=[];let f=ft();for(const m of i){d.push(m.batchId);for(const b of m.mutations)f=f.add(b.key)}for(const m of l){h.push(m.batchId);for(const b of m.mutations)f=f.add(b.key)}return t.localDocuments.getDocuments(r,f).next((m=>({Ns:m,removedBatchIds:d,addedBatchIds:h})))}))}))}function gP(s,e){const t=Be(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),l=t.xs.newChangeBuffer({trackRemovals:!0});return(function(h,f,m,b){const y=m.batch,v=y.keys();let N=le.resolve();return v.forEach((E=>{N=N.next((()=>b.getEntry(f,E))).next((I=>{const T=m.docVersions.get(E);Ke(T!==null,48541),I.version.compareTo(T)<0&&(y.applyToRemoteDocument(I,m),I.isValidDocument()&&(I.setReadTime(m.commitVersion),b.addEntry(I)))}))})),N.next((()=>h.mutationQueue.removeMutationBatch(f,y)))})(t,r,e,l).next((()=>l.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(h){let f=ft();for(let m=0;m<h.mutationResults.length;++m)h.mutationResults[m].transformResults.length>0&&(f=f.add(h.batch.mutations[m].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function T4(s){const e=Be(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function pP(s,e){const t=Be(s),r=e.snapshotVersion;let i=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});i=t.vs;const h=[];e.targetChanges.forEach(((b,y)=>{const v=i.get(y);if(!v)return;h.push(t.li.removeMatchingKeys(l,b.removedDocuments,y).next((()=>t.li.addMatchingKeys(l,b.addedDocuments,y))));let N=v.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(y)!==null?N=N.withResumeToken(vs.EMPTY_BYTE_STRING,Ye.min()).withLastLimboFreeSnapshotVersion(Ye.min()):b.resumeToken.approximateByteSize()>0&&(N=N.withResumeToken(b.resumeToken,r)),i=i.insert(y,N),(function(I,T,L){return I.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=fP?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(v,N,b)&&h.push(t.li.updateTargetData(l,N))}));let f=Yn(),m=ft();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(l,b))})),h.push(S4(l,d,e.documentUpdates).next((b=>{f=b.Bs,m=b.Ls}))),!r.isEqual(Ye.min())){const b=t.li.getLastRemoteSnapshotVersion(l).next((y=>t.li.setTargetsMetadata(l,l.currentSequenceNumber,r)));h.push(b)}return le.waitFor(h).next((()=>d.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,f,m))).next((()=>f))})).then((l=>(t.vs=i,l)))}function S4(s,e,t){let r=ft(),i=ft();return t.forEach((l=>r=r.add(l))),e.getEntries(s,r).next((l=>{let d=Yn();return t.forEach(((h,f)=>{const m=l.get(h);f.isFoundDocument()!==m.isFoundDocument()&&(i=i.add(h)),f.isNoDocument()&&f.version.isEqual(Ye.min())?(e.removeEntry(h,f.readTime),d=d.insert(h,f)):!m.isValidDocument()||f.version.compareTo(m.version)>0||f.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(f),d=d.insert(h,f)):Ce(mw,"Ignoring outdated watch update for ",h,". Current version:",m.version," Watch version:",f.version)})),{Bs:d,Ls:i}}))}function xP(s,e){const t=Be(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=To),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function qd(s,e){const t=Be(s);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.li.getTargetData(r,e).next((l=>l?(i=l,le.resolve(i)):t.li.allocateTargetId(r).next((d=>(i=new gi(e,d,"TargetPurposeListen",r.currentSequenceNumber),t.li.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.vs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.vs=t.vs.insert(r.targetId,r),t.Fs.set(e,r.targetId)),r}))}async function Hd(s,e,t){const r=Be(s),i=r.vs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",l,(d=>r.persistence.referenceDelegate.removeTarget(d,i)))}catch(d){if(!zo(d))throw d;Ce(mw,`Failed to update sequence numbers for target ${e}: ${d}`)}r.vs=r.vs.remove(e),r.Fs.delete(i.target)}function w0(s,e,t){const r=Be(s);let i=Ye.min(),l=ft();return r.persistence.runTransaction("Execute query","readwrite",(d=>(function(f,m,b){const y=Be(f),v=y.Fs.get(b);return v!==void 0?le.resolve(y.vs.get(v)):y.li.getTargetData(m,b)})(r,d,Pn(e)).next((h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(d,h.targetId).next((f=>{l=f}))})).next((()=>r.Cs.getDocumentsMatchingQuery(d,e,t?i:Ye.min(),t?l:ft()))).next((h=>(A4(r,CE(e),h),{documents:h,ks:l})))))}function E4(s,e){const t=Be(s),r=Be(t.li),i=t.vs.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",(l=>r.At(l,e).next((d=>d?d.target:null))))}function I4(s,e){const t=Be(s),r=t.Ms.get(e)||Ye.min();return t.persistence.runTransaction("Get new document changes","readonly",(i=>t.xs.getAllFromCollectionGroup(i,e,YS(r,Dd),Number.MAX_SAFE_INTEGER))).then((i=>(A4(t,e,i),i)))}function A4(s,e,t){let r=s.Ms.get(e)||Ye.min();t.forEach(((i,l)=>{l.readTime.compareTo(r)>0&&(r=l.readTime)})),s.Ms.set(e,r)}async function bP(s,e,t,r){const i=Be(s);let l=ft(),d=Yn();for(const m of t){const b=e.Ks(m.metadata.name);m.document&&(l=l.add(b));const y=e.qs(m);y.setReadTime(e.Us(m.metadata.readTime)),d=d.insert(b,y)}const h=i.xs.newChangeBuffer({trackRemovals:!0}),f=await qd(i,(function(b){return Pn(ru(Nt.fromString(`__bundle__/docs/${b}`)))})(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(m=>S4(m,h,d).next((b=>(h.apply(m),b))).next((b=>i.li.removeMatchingKeysForTargetId(m,f.targetId).next((()=>i.li.addMatchingKeys(m,l,f.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(m,b.Bs,b.Ls))).next((()=>b.Bs))))))}async function yP(s,e,t=ft()){const r=await qd(s,Pn(iw(e.bundledQuery))),i=Be(s);return i.persistence.runTransaction("Save named query","readwrite",(l=>{const d=As(e.readTime);if(r.snapshotVersion.compareTo(d)>=0)return i.Pi.saveNamedQuery(l,e);const h=r.withResumeToken(vs.EMPTY_BYTE_STRING,d);return i.vs=i.vs.insert(h.targetId,h),i.li.updateTargetData(l,h).next((()=>i.li.removeMatchingKeysForTargetId(l,r.targetId))).next((()=>i.li.addMatchingKeys(l,t,r.targetId))).next((()=>i.Pi.saveNamedQuery(l,e)))}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k4="firestore_clients";function S5(s,e){return`${k4}_${s}_${e}`}const C4="firestore_mutations";function E5(s,e,t){let r=`${C4}_${s}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const R4="firestore_targets";function Qb(s,e){return`${R4}_${s}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ea="SharedClientState";class j0{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static $s(e,t,r){const i=JSON.parse(r);let l,d=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return d&&i.error&&(d=typeof i.error.message=="string"&&typeof i.error.code=="string",d&&(l=new Ae(i.error.code,i.error.message))),d?new j0(e,t,i.state,l):(Es(Ea,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Gh{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static $s(e,t){const r=JSON.parse(t);let i,l=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return l&&r.error&&(l=typeof r.error.message=="string"&&typeof r.error.code=="string",l&&(i=new Ae(r.error.code,r.error.message))),l?new Gh(e,r.state,i):(Es(Ea,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class N0{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const r=JSON.parse(t);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,l=Jv();for(let d=0;i&&d<r.activeTargetIds.length;++d)i=tE(r.activeTargetIds[d]),l=l.add(r.activeTargetIds[d]);return i?new N0(e,l):(Es(Ea,`Failed to parse client data for instance '${e}': ${t}`),null)}}class gw{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new gw(t.clientId,t.onlineState):(Es(Ea,`Failed to parse online state: ${e}`),null)}}class Jy{constructor(){this.activeTargetIds=Jv()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Yb{constructor(e,t,r,i,l){this.window=e,this.Ci=t,this.persistenceKey=r,this.zs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new ts(ot),this.started=!1,this.Zs=[];const d=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=l,this.Xs=S5(this.persistenceKey,this.zs),this.Ys=(function(f){return`firestore_sequence_number_${f}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new Jy),this.eo=new RegExp(`^${k4}_${d}_([^_]*)$`),this.no=new RegExp(`^${C4}_${d}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${R4}_${d}_(\\d+)$`),this.io=(function(f){return`firestore_online_state_${f}`})(this.persistenceKey),this.so=(function(f){return`firestore_bundle_loaded_v2_${f}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const r of e){if(r===this.zs)continue;const i=this.getItem(S5(this.persistenceKey,r));if(i){const l=N0.$s(r,i);l&&(this.Js=this.Js.insert(l.clientId,l))}}this.oo();const t=this.storage.getItem(this.io);if(t){const r=this._o(t);r&&this.ao(r)}for(const r of this.Zs)this.Hs(r);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,r){this.co(e,t,r),this.lo(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Qb(this.persistenceKey,e));if(i){const l=Gh.$s(e,i);l&&(r=l.state)}}return t&&this.ho.Qs(e),this.oo(),r}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Qb(this.persistenceKey,e))}updateQueryState(e,t,r){this.Po(e,t,r)}handleUserChange(e,t,r){t.forEach((i=>{this.lo(i)})),this.currentUser=e,r.forEach((i=>{this.addPendingMutation(i)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Ce(Ea,"READ",e,t),t}setItem(e,t){Ce(Ea,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Ce(Ea,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(Ce(Ea,"EVENT",t.key,t.newValue),t.key===this.Xs)return void Es("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const r=this.Eo(t.key);return this.Ro(r,null)}{const r=this.Ao(t.key,t.newValue);if(r)return this.Ro(r.clientId,r)}}else if(this.no.test(t.key)){if(t.newValue!==null){const r=this.Vo(t.key,t.newValue);if(r)return this.mo(r)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const r=this.fo(t.key,t.newValue);if(r)return this.po(r)}}else if(t.key===this.io){if(t.newValue!==null){const r=this._o(t.newValue);if(r)return this.ao(r)}}else if(t.key===this.Ys){const r=(function(l){let d=Kn.ce;if(l!=null)try{const h=JSON.parse(l);Ke(typeof h=="number",30636,{yo:l}),d=h}catch(h){Es(Ea,"Failed to read sequence number from WebStorage",h)}return d})(t.newValue);r!==Kn.ce&&this.sequenceNumberHandler(r)}else if(t.key===this.so){const r=this.wo(t.newValue);await Promise.all(r.map((i=>this.syncEngine.bo(i))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,r){const i=new j0(this.currentUser,e,t,r),l=E5(this.persistenceKey,this.currentUser,e);this.setItem(l,i.Ws())}lo(e){const t=E5(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,r){const i=Qb(this.persistenceKey,e),l=new Gh(e,t,r);this.setItem(i,l.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const r=this.Eo(e);return N0.$s(r,t)}Vo(e,t){const r=this.no.exec(e),i=Number(r[1]),l=r[2]!==void 0?r[2]:null;return j0.$s(new en(l),i,t)}fo(e,t){const r=this.ro.exec(e),i=Number(r[1]);return Gh.$s(i,t)}_o(e){return gw.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);Ce(Ea,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const r=t?this.Js.insert(e,t):this.Js.remove(e),i=this.uo(this.Js),l=this.uo(r),d=[],h=[];return l.forEach((f=>{i.has(f)||d.push(f)})),i.forEach((f=>{l.has(f)||h.push(f)})),this.syncEngine.Co(d,h).then((()=>{this.Js=r}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=Jv();return e.forEach(((r,i)=>{t=t.unionWith(i.activeTargetIds)})),t}}class D4{constructor(){this.vo=new Jy,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,r){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Jy,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I5="ConnectivityMonitor";class A5{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Ce(I5,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Ce(I5,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ig=null;function Zy(){return Ig===null?Ig=(function(){return 268435456+Math.round(2147483648*Math.random())})():Ig++,"0x"+Ig.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb="RestConnection",wP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class jP{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.$o=this.databaseId.database===Vy?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,l){const d=Zy(),h=this.Qo(e,t.toUriEncodedString());Ce(Xb,`Sending RPC '${e}' ${d}:`,h,r);const f={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(f,i,l);const{host:m}=new URL(h),b=Fo(m);return this.zo(e,h,f,r,b).then((y=>(Ce(Xb,`Received RPC '${e}' ${d}: `,y),y)),(y=>{throw za(Xb,`RPC '${e}' ${d} failed with error: `,y,"url: ",h,"request:",r),y}))}jo(e,t,r,i,l,d){return this.Wo(e,t,r,i,l)}Go(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+nu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,l)=>e[l]=i)),r&&r.headers.forEach(((i,l)=>e[l]=i))}Qo(e,t){const r=wP[e];let i=`${this.qo}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wn="WebChannelConnection",wh=(s,e,t)=>{s.listen(e,(r=>{try{t(r)}catch(i){setTimeout((()=>{throw i}),0)}}))};class jd extends jP{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!jd.c_){const e=zS();wh(e,BS.STAT_EVENT,(t=>{t.stat===Cy.PROXY?Ce(wn,"STAT_EVENT: detected buffering proxy"):t.stat===Cy.NOPROXY&&Ce(wn,"STAT_EVENT: detected no buffering proxy")})),jd.c_=!0}}zo(e,t,r,i,l){const d=Zy();return new Promise(((h,f)=>{const m=new US;m.setWithCredentials(!0),m.listenOnce(FS.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case qg.NO_ERROR:const y=m.getResponseJson();Ce(wn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(y)),h(y);break;case qg.TIMEOUT:Ce(wn,`RPC '${e}' ${d} timed out`),f(new Ae(xe.DEADLINE_EXCEEDED,"Request time out"));break;case qg.HTTP_ERROR:const v=m.getStatus();if(Ce(wn,`RPC '${e}' ${d} failed with status:`,v,"response text:",m.getResponseText()),v>0){let N=m.getResponseJson();Array.isArray(N)&&(N=N[0]);const E=N==null?void 0:N.error;if(E&&E.status&&E.message){const I=(function(L){const $=L.toLowerCase().replace(/_/g,"-");return Object.values(xe).indexOf($)>=0?$:xe.UNKNOWN})(E.status);f(new Ae(I,E.message))}else f(new Ae(xe.UNKNOWN,"Server responded with status "+m.getStatus()))}else f(new Ae(xe.UNAVAILABLE,"Connection failed."));break;default:ze(9055,{l_:e,streamId:d,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{Ce(wn,`RPC '${e}' ${d} completed.`)}}));const b=JSON.stringify(i);Ce(wn,`RPC '${e}' ${d} sending request:`,i),m.send(t,"POST",b,r,15)}))}T_(e,t,r){const i=Zy(),l=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(h.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(h.useFetchStreams=!0),this.Go(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const m=l.join("");Ce(wn,`Creating RPC '${e}' stream ${i}: ${m}`,h);const b=d.createWebChannel(m,h);this.I_(b);let y=!1,v=!1;const N=new NP({Ho:E=>{v?Ce(wn,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(y||(Ce(wn,`Opening RPC '${e}' stream ${i} transport.`),b.open(),y=!0),Ce(wn,`RPC '${e}' stream ${i} sending:`,E),b.send(E))},Jo:()=>b.close()});return wh(b,kh.EventType.OPEN,(()=>{v||(Ce(wn,`RPC '${e}' stream ${i} transport opened.`),N.i_())})),wh(b,kh.EventType.CLOSE,(()=>{v||(v=!0,Ce(wn,`RPC '${e}' stream ${i} transport closed`),N.o_(),this.E_(b))})),wh(b,kh.EventType.ERROR,(E=>{v||(v=!0,za(wn,`RPC '${e}' stream ${i} transport errored. Name:`,E.name,"Message:",E.message),N.o_(new Ae(xe.UNAVAILABLE,"The operation could not be completed")))})),wh(b,kh.EventType.MESSAGE,(E=>{var I;if(!v){const T=E.data[0];Ke(!!T,16349);const L=T,$=(L==null?void 0:L.error)||((I=L[0])==null?void 0:I.error);if($){Ce(wn,`RPC '${e}' stream ${i} received error:`,$);const B=$.status;let Q=(function(C){const P=Us[C];if(P!==void 0)return HE(P)})(B),Z=$.message;Q===void 0&&(Q=xe.INTERNAL,Z="Unknown error status: "+B+" with message "+$.message),v=!0,N.o_(new Ae(Q,Z)),b.close()}else Ce(wn,`RPC '${e}' stream ${i} received:`,T),N.__(T)}})),jd.u_(),setTimeout((()=>{N.s_()}),0),N}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,r){super.Go(e,t,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return $S()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _P(s){return new jd(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O4(){return typeof window<"u"?window:null}function e0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vf(s){return new AO(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jd.c_=!1;class pw{constructor(e,t,r=1e3,i=1.5,l=6e4){this.Ci=e,this.timerId=t,this.R_=r,this.A_=i,this.V_=l,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Ce("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k5="PersistentStream";class P4{constructor(e,t,r,i,l,d,h,f){this.Ci=e,this.b_=r,this.S_=i,this.connection=l,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=h,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new pw(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===xe.RESOURCE_EXHAUSTED?(Es(t.toString()),Es("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===xe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new Ae(xe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.Yo((()=>{r((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.H_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ce(k5,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Ce(k5,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class TP extends P4{constructor(e,t,r,i,l,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,d),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=RO(this.serializer,e),r=(function(l){if(!("targetChange"in l))return Ye.min();const d=l.targetChange;return d.targetIds&&d.targetIds.length?Ye.min():d.readTime?As(d.readTime):Ye.min()})(e);return this.listener.J_(t,r)}Z_(e){const t={};t.database=Wy(this.serializer),t.addTarget=(function(l,d){let h;const f=d.target;if(h=m0(f)?{documents:t4(l,f)}:{query:s4(l,f).ft},h.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){h.resumeToken=QE(l,d.resumeToken);const m=Hy(l,d.expectedCount);m!==null&&(h.expectedCount=m)}else if(d.snapshotVersion.compareTo(Ye.min())>0){h.readTime=$d(l,d.snapshotVersion.toTimestamp());const m=Hy(l,d.expectedCount);m!==null&&(h.expectedCount=m)}return h})(this.serializer,e);const r=OO(this.serializer,e);r&&(t.labels=r),this.K_(t)}X_(e){const t={};t.database=Wy(this.serializer),t.removeTarget=e,this.K_(t)}}class SP extends P4{constructor(e,t,r,i,l,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,d),this.serializer=l}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Ke(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ke(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ke(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=DO(e.writeResults,e.commitTime),r=As(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Wy(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>gf(this.serializer,r)))};this.K_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{}class IP extends EP{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Ae(xe.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Wo(e,Gy(t,r),i,l,d))).catch((l=>{throw l.name==="FirebaseError"?(l.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ae(xe.UNKNOWN,l.toString())}))}jo(e,t,r,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,h])=>this.connection.jo(e,Gy(t,r),i,d,h,l))).catch((d=>{throw d.name==="FirebaseError"?(d.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Ae(xe.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function AP(s,e,t,r){return new IP(s,e,t,r)}class kP{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Es(t),this.aa=!1):Ce("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jl="RemoteStore";class CP{constructor(e,t,r,i,l){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=l,this.Aa.Mo((d=>{r.enqueueAndForget((async()=>{qo(this)&&(Ce(Jl,"Restarting streams for network reachability change."),await(async function(f){const m=Be(f);m.Ea.add(4),await ou(m),m.Va.set("Unknown"),m.Ea.delete(4),await Uf(m)})(this))}))})),this.Va=new kP(r,i)}}async function Uf(s){if(qo(s))for(const e of s.Ra)await e(!0)}async function ou(s){for(const e of s.Ra)await e(!1)}function ap(s,e){const t=Be(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),yw(t)?bw(t):cu(t).O_()&&xw(t,e))}function Gd(s,e){const t=Be(s),r=cu(t);t.Ia.delete(e),r.O_()&&M4(t,e),t.Ia.size===0&&(r.O_()?r.L_():qo(t)&&t.Va.set("Unknown"))}function xw(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ye.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}cu(s).Z_(e)}function M4(s,e){s.da.$e(e),cu(s).X_(e)}function bw(s){s.da=new TO({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),cu(s).start(),s.Va.ua()}function yw(s){return qo(s)&&!cu(s).x_()&&s.Ia.size>0}function qo(s){return Be(s).Ea.size===0}function L4(s){s.da=void 0}async function RP(s){s.Va.set("Online")}async function DP(s){s.Ia.forEach(((e,t)=>{xw(s,e)}))}async function OP(s,e){L4(s),yw(s)?(s.Va.ha(e),bw(s)):s.Va.set("Unknown")}async function PP(s,e,t){if(s.Va.set("Online"),e instanceof KE&&e.state===2&&e.cause)try{await(async function(i,l){const d=l.cause;for(const h of l.targetIds)i.Ia.has(h)&&(await i.remoteSyncer.rejectListen(h,d),i.Ia.delete(h),i.da.removeTarget(h))})(s,e)}catch(r){Ce(Jl,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await _0(s,r)}else if(e instanceof Jg?s.da.Xe(e):e instanceof WE?s.da.st(e):s.da.tt(e),!t.isEqual(Ye.min()))try{const r=await T4(s.localStore);t.compareTo(r)>=0&&await(function(l,d){const h=l.da.Tt(d);return h.targetChanges.forEach(((f,m)=>{if(f.resumeToken.approximateByteSize()>0){const b=l.Ia.get(m);b&&l.Ia.set(m,b.withResumeToken(f.resumeToken,d))}})),h.targetMismatches.forEach(((f,m)=>{const b=l.Ia.get(f);if(!b)return;l.Ia.set(f,b.withResumeToken(vs.EMPTY_BYTE_STRING,b.snapshotVersion)),M4(l,f);const y=new gi(b.target,f,m,b.sequenceNumber);xw(l,y)})),l.remoteSyncer.applyRemoteEvent(h)})(s,t)}catch(r){Ce(Jl,"Failed to raise snapshot:",r),await _0(s,r)}}async function _0(s,e,t){if(!zo(e))throw e;s.Ea.add(1),await ou(s),s.Va.set("Offline"),t||(t=()=>T4(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{Ce(Jl,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await Uf(s)}))}function V4(s,e){return e().catch((t=>_0(s,t,e)))}async function lu(s){const e=Be(s),t=Vo(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:To;for(;MP(e);)try{const i=await xP(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,LP(e,i)}catch(i){await _0(e,i)}U4(e)&&F4(e)}function MP(s){return qo(s)&&s.Ta.length<10}function LP(s,e){s.Ta.push(e);const t=Vo(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function U4(s){return qo(s)&&!Vo(s).x_()&&s.Ta.length>0}function F4(s){Vo(s).start()}async function VP(s){Vo(s).ra()}async function UP(s){const e=Vo(s);for(const t of s.Ta)e.ea(t.mutations)}async function FP(s,e,t){const r=s.Ta.shift(),i=sw.from(r,e,t);await V4(s,(()=>s.remoteSyncer.applySuccessfulWrite(i))),await lu(s)}async function BP(s,e){e&&Vo(s).Y_&&await(async function(r,i){if((function(d){return qE(d)&&d!==xe.ABORTED})(i.code)){const l=r.Ta.shift();Vo(r).B_(),await V4(r,(()=>r.remoteSyncer.rejectFailedWrite(l.batchId,i))),await lu(r)}})(s,e),U4(s)&&F4(s)}async function C5(s,e){const t=Be(s);t.asyncQueue.verifyOperationInProgress(),Ce(Jl,"RemoteStore received new credentials");const r=qo(t);t.Ea.add(3),await ou(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Uf(t)}async function ev(s,e){const t=Be(s);e?(t.Ea.delete(2),await Uf(t)):e||(t.Ea.add(2),await ou(t),t.Va.set("Unknown"))}function cu(s){return s.ma||(s.ma=(function(t,r,i){const l=Be(t);return l.sa(),new TP(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,i)})(s.datastore,s.asyncQueue,{Zo:RP.bind(null,s),Yo:DP.bind(null,s),t_:OP.bind(null,s),J_:PP.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),yw(s)?bw(s):s.Va.set("Unknown")):(await s.ma.stop(),L4(s))}))),s.ma}function Vo(s){return s.fa||(s.fa=(function(t,r,i){const l=Be(t);return l.sa(),new SP(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,i)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:VP.bind(null,s),t_:BP.bind(null,s),ta:UP.bind(null,s),na:FP.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await lu(s)):(await s.fa.stop(),s.Ta.length>0&&(Ce(Jl,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(e,t,r,i,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=l,this.deferred=new gn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,l){const d=Date.now()+r,h=new vw(e,t,d,i,l);return h.start(r),h}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ae(xe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function du(s,e){if(Es("AsyncQueue",`${e}: ${s}`),zo(s))return new Ae(xe.UNAVAILABLE,`${e}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{static emptySet(e){return new Nd(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Ue.comparator(t.key,r.key):(t,r)=>Ue.comparator(t.key,r.key),this.keyedMap=Ch(),this.sortedSet=new ts(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Nd)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,l=r.getNext().key;if(!i.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Nd;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R5{constructor(){this.ga=new ts(Ue.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ze(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Wd{constructor(e,t,r,i,l,d,h,f,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=l,this.fromCache=d,this.syncStateChanged=h,this.excludesMetadataChanges=f,this.hasCachedResults=m}static fromInitialDocuments(e,t,r,i,l){const d=[];return t.forEach((h=>{d.push({type:0,doc:h})})),new Wd(e,t,Nd.emptySet(t),d,r,i,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Df(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class $P{constructor(){this.queries=D5(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=Be(t),l=i.queries;i.queries=D5(),l.forEach(((d,h)=>{for(const f of h.ba)f.onError(r)}))})(this,new Ae(xe.ABORTED,"Firestore shutting down"))}}function D5(){return new Ai((s=>kE(s)),Df)}async function ww(s,e){const t=Be(s);let r=3;const i=e.query;let l=t.queries.get(i);l?!l.Sa()&&e.Da()&&(r=2):(l=new zP,r=e.Da()?0:1);try{switch(r){case 0:l.wa=await t.onListen(i,!0);break;case 1:l.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(d){const h=du(d,`Initialization of query '${fd(e.query)}' failed`);return void e.onError(h)}t.queries.set(i,l),l.ba.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&Nw(t)}async function jw(s,e){const t=Be(s),r=e.query;let i=3;const l=t.queries.get(r);if(l){const d=l.ba.indexOf(e);d>=0&&(l.ba.splice(d,1),l.ba.length===0?i=e.Da()?0:1:!l.Sa()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function qP(s,e){const t=Be(s);let r=!1;for(const i of e){const l=i.query,d=t.queries.get(l);if(d){for(const h of d.ba)h.Fa(i)&&(r=!0);d.wa=i}}r&&Nw(t)}function HP(s,e,t){const r=Be(s),i=r.queries.get(e);if(i)for(const l of i.ba)l.onError(t);r.queries.delete(e)}function Nw(s){s.Ca.forEach((e=>{e.next()}))}var tv,O5;(O5=tv||(tv={})).Ma="default",O5.Cache="cache";class _w{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Wd(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Wd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==tv.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GP{constructor(e,t){this.qa=e,this.byteLength=t}Ua(){return"metadata"in this.qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P5{constructor(e){this.serializer=e}Ks(e){return Va(this.serializer,e)}qs(e){return e.metadata.exists?e4(this.serializer,e.document,!1):rs.newNoDocument(this.Ks(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return As(e)}}class WP{constructor(e,t){this.$a=e,this.serializer=t,this.Wa=[],this.Qa=[],this.collectionGroups=new Set,this.progress=B4(e)}get queries(){return this.Wa}get documents(){return this.Qa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Wa.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Qa.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;const r=Nt.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.qa.document&&(this.Qa[this.Qa.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,r=new P5(this.serializer);for(const i of e)if(i.metadata.queries){const l=r.Ks(i.metadata.name);for(const d of i.metadata.queries){const h=(t.get(d)||ft()).add(l);t.set(d,h)}}return t}async ja(e){const t=await bP(e,new P5(this.serializer),this.Qa,this.$a.id),r=this.za(this.documents);for(const i of this.Wa)await yP(e,i,r.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Ha:this.collectionGroups,Ja:t}}}function B4(s){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:s.totalDocuments,totalBytes:s.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(e){this.key=e}}class $4{constructor(e){this.key=e}}class q4{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=ft(),this.mutatedKeys=ft(),this.eu=RE(e),this.tu=new Nd(this.eu)}get nu(){return this.Za}ru(e,t){const r=t?t.iu:new R5,i=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,d=i,h=!1;const f=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,m=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((b,y)=>{const v=i.get(b),N=Of(this.query,y)?y:null,E=!!v&&this.mutatedKeys.has(v.key),I=!!N&&(N.hasLocalMutations||this.mutatedKeys.has(N.key)&&N.hasCommittedMutations);let T=!1;v&&N?v.data.isEqual(N.data)?E!==I&&(r.track({type:3,doc:N}),T=!0):this.su(v,N)||(r.track({type:2,doc:N}),T=!0,(f&&this.eu(N,f)>0||m&&this.eu(N,m)<0)&&(h=!0)):!v&&N?(r.track({type:0,doc:N}),T=!0):v&&!N&&(r.track({type:1,doc:v}),T=!0,(f||m)&&(h=!0)),T&&(N?(d=d.add(N),l=I?l.add(b):l.delete(b)):(d=d.delete(b),l=l.delete(b)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const b=this.query.limitType==="F"?d.last():d.first();d=d.delete(b.key),l=l.delete(b.key),r.track({type:1,doc:b})}return{tu:d,iu:r,Ss:h,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((b,y)=>(function(N,E){const I=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ze(20277,{Vt:T})}};return I(N)-I(E)})(b.type,y.type)||this.eu(b.doc,y.doc))),this.ou(r),i=i??!1;const h=t&&!i?this._u():[],f=this.Ya.size===0&&this.current&&!i?1:0,m=f!==this.Xa;return this.Xa=f,d.length!==0||m?{snapshot:new Wd(this.query,e.tu,l,d,e.mutatedKeys,f===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:h}:{au:h}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new R5,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=ft(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))}));const t=[];return e.forEach((r=>{this.Ya.has(r)||t.push(new $4(r))})),this.Ya.forEach((r=>{e.has(r)||t.push(new z4(r))})),t}cu(e){this.Za=e.ks,this.Ya=ft();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Wd.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Ho="SyncEngine";class KP{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class QP{constructor(e){this.key=e,this.hu=!1}}class YP{constructor(e,t,r,i,l,d){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=l,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Ai((h=>kE(h)),Df),this.Iu=new Map,this.Eu=new Set,this.Ru=new ts(Ue.comparator),this.Au=new Map,this.Vu=new cw,this.du={},this.mu=new Map,this.fu=Xl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function XP(s,e,t=!0){const r=ip(s);let i;const l=r.Tu.get(e);return l?(r.sharedClientState.addLocalQueryTarget(l.targetId),i=l.view.lu()):i=await H4(r,e,t,!0),i}async function JP(s,e){const t=ip(s);await H4(t,e,!0,!1)}async function H4(s,e,t,r){const i=await qd(s.localStore,Pn(e)),l=i.targetId,d=s.sharedClientState.addLocalQueryTarget(l,t);let h;return r&&(h=await Tw(s,e,l,d==="current",i.resumeToken)),s.isPrimaryClient&&t&&ap(s.remoteStore,i),h}async function Tw(s,e,t,r,i){s.pu=(y,v,N)=>(async function(I,T,L,$){let B=T.view.ru(L);B.Ss&&(B=await w0(I.localStore,T.query,!1).then((({documents:C})=>T.view.ru(C,B))));const Q=$&&$.targetChanges.get(T.targetId),Z=$&&$.targetMismatches.get(T.targetId)!=null,Y=T.view.applyChanges(B,I.isPrimaryClient,Q,Z);return sv(I,T.targetId,Y.au),Y.snapshot})(s,y,v,N);const l=await w0(s.localStore,e,!0),d=new q4(e,l.ks),h=d.ru(l.documents),f=Lf.createSynthesizedTargetChangeForCurrentChange(t,r&&s.onlineState!=="Offline",i),m=d.applyChanges(h,s.isPrimaryClient,f);sv(s,t,m.au);const b=new KP(e,t,d);return s.Tu.set(e,b),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),m.snapshot}async function ZP(s,e,t){const r=Be(s),i=r.Tu.get(e),l=r.Iu.get(i.targetId);if(l.length>1)return r.Iu.set(i.targetId,l.filter((d=>!Df(d,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Hd(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Gd(r.remoteStore,i.targetId),Kd(r,i.targetId)})).catch(Bo)):(Kd(r,i.targetId),await Hd(r.localStore,i.targetId,!0))}async function eM(s,e){const t=Be(s),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Gd(t.remoteStore,r.targetId))}async function tM(s,e,t){const r=Aw(s);try{const i=await(function(d,h){const f=Be(d),m=Vt.now(),b=h.reduce(((N,E)=>N.add(E.key)),ft());let y,v;return f.persistence.runTransaction("Locally write mutations","readwrite",(N=>{let E=Yn(),I=ft();return f.xs.getEntries(N,b).next((T=>{E=T,E.forEach(((L,$)=>{$.isValidDocument()||(I=I.add(L))}))})).next((()=>f.localDocuments.getOverlayedDocuments(N,E))).next((T=>{y=T;const L=[];for(const $ of h){const B=jO($,y.get($.key).overlayedDocument);B!=null&&L.push(new ki($.key,B,wE(B.value.mapValue),hs.exists(!0)))}return f.mutationQueue.addMutationBatch(N,m,L,h)})).next((T=>{v=T;const L=T.applyToLocalDocumentSet(y,I);return f.documentOverlayCache.saveOverlays(N,T.batchId,L)}))})).then((()=>({batchId:v.batchId,changes:OE(y)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(d,h,f){let m=d.du[d.currentUser.toKey()];m||(m=new ts(ot)),m=m.insert(h,f),d.du[d.currentUser.toKey()]=m})(r,i.batchId,t),await Ci(r,i.changes),await lu(r.remoteStore)}catch(i){const l=du(i,"Failed to persist write");t.reject(l)}}async function G4(s,e){const t=Be(s);try{const r=await pP(t.localStore,e);e.targetChanges.forEach(((i,l)=>{const d=t.Au.get(l);d&&(Ke(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?d.hu=!0:i.modifiedDocuments.size>0?Ke(d.hu,14607):i.removedDocuments.size>0&&(Ke(d.hu,42227),d.hu=!1))})),await Ci(t,r,e)}catch(r){await Bo(r)}}function M5(s,e,t){const r=Be(s);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((l,d)=>{const h=d.view.va(e);h.snapshot&&i.push(h.snapshot)})),(function(d,h){const f=Be(d);f.onlineState=h;let m=!1;f.queries.forEach(((b,y)=>{for(const v of y.ba)v.va(h)&&(m=!0)})),m&&Nw(f)})(r.eventManager,e),i.length&&r.Pu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function sM(s,e,t){const r=Be(s);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),l=i&&i.key;if(l){let d=new ts(Ue.comparator);d=d.insert(l,rs.newNoDocument(l,Ye.min()));const h=ft().add(l),f=new Mf(Ye.min(),new Map,new ts(ot),d,h);await G4(r,f),r.Ru=r.Ru.remove(l),r.Au.delete(e),Iw(r)}else await Hd(r.localStore,e,!1).then((()=>Kd(r,e,t))).catch(Bo)}async function nM(s,e){const t=Be(s),r=e.batch.batchId;try{const i=await gP(t.localStore,e);Ew(t,r,null),Sw(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Ci(t,i)}catch(i){await Bo(i)}}async function rM(s,e,t){const r=Be(s);try{const i=await(function(d,h){const f=Be(d);return f.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let b;return f.mutationQueue.lookupMutationBatch(m,h).next((y=>(Ke(y!==null,37113),b=y.keys(),f.mutationQueue.removeMutationBatch(m,y)))).next((()=>f.mutationQueue.performConsistencyCheck(m))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(m,b,h))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,b))).next((()=>f.localDocuments.getDocuments(m,b)))}))})(r.localStore,e);Ew(r,e,t),Sw(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Ci(r,i)}catch(i){await Bo(i)}}async function aM(s,e){const t=Be(s);qo(t.remoteStore)||Ce(Ho,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await(function(d){const h=Be(d);return h.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(f=>h.mutationQueue.getHighestUnacknowledgedBatchId(f)))})(t.localStore);if(r===To)return void e.resolve();const i=t.mu.get(r)||[];i.push(e),t.mu.set(r,i)}catch(r){const i=du(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function Sw(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function Ew(s,e,t){const r=Be(s);let i=r.du[r.currentUser.toKey()];if(i){const l=i.get(e);l&&(t?l.reject(t):l.resolve(),i=i.remove(e)),r.du[r.currentUser.toKey()]=i}}function Kd(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const r of s.Iu.get(e))s.Tu.delete(r),t&&s.Pu.yu(r,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((r=>{s.Vu.containsKey(r)||W4(s,r)}))}function W4(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(Gd(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),Iw(s))}function sv(s,e,t){for(const r of t)r instanceof z4?(s.Vu.addReference(r.key,e),iM(s,r)):r instanceof $4?(Ce(Ho,"Document no longer in limbo: "+r.key),s.Vu.removeReference(r.key,e),s.Vu.containsKey(r.key)||W4(s,r.key)):ze(19791,{wu:r})}function iM(s,e){const t=e.key,r=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(r)||(Ce(Ho,"New document in limbo: "+t),s.Eu.add(r),Iw(s))}function Iw(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new Ue(Nt.fromString(e)),r=s.fu.next();s.Au.set(r,new QP(t)),s.Ru=s.Ru.insert(t,r),ap(s.remoteStore,new gi(Pn(ru(t.path)),r,"TargetPurposeLimboResolution",Kn.ce))}}async function Ci(s,e,t){const r=Be(s),i=[],l=[],d=[];r.Tu.isEmpty()||(r.Tu.forEach(((h,f)=>{d.push(r.pu(f,e,t).then((m=>{var b;if((m||t)&&r.isPrimaryClient){const y=m?!m.fromCache:(b=t==null?void 0:t.targetChanges.get(f.targetId))==null?void 0:b.current;r.sharedClientState.updateQueryState(f.targetId,y?"current":"not-current")}if(m){i.push(m);const y=fw.Es(f.targetId,m);l.push(y)}})))})),await Promise.all(d),r.Pu.J_(i),await(async function(f,m){const b=Be(f);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(y=>le.forEach(m,(v=>le.forEach(v.Ts,(N=>b.persistence.referenceDelegate.addReference(y,v.targetId,N))).next((()=>le.forEach(v.Is,(N=>b.persistence.referenceDelegate.removeReference(y,v.targetId,N)))))))))}catch(y){if(!zo(y))throw y;Ce(mw,"Failed to update sequence numbers: "+y)}for(const y of m){const v=y.targetId;if(!y.fromCache){const N=b.vs.get(v),E=N.snapshotVersion,I=N.withLastLimboFreeSnapshotVersion(E);b.vs=b.vs.insert(v,I)}}})(r.localStore,l))}async function oM(s,e){const t=Be(s);if(!t.currentUser.isEqual(e)){Ce(Ho,"User change. New user:",e.toKey());const r=await _4(t.localStore,e);t.currentUser=e,(function(l,d){l.mu.forEach((h=>{h.forEach((f=>{f.reject(new Ae(xe.CANCELLED,d))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ci(t,r.Ns)}}function lM(s,e){const t=Be(s),r=t.Au.get(e);if(r&&r.hu)return ft().add(r.key);{let i=ft();const l=t.Iu.get(e);if(!l)return i;for(const d of l){const h=t.Tu.get(d);i=i.unionWith(h.view.nu)}return i}}async function cM(s,e){const t=Be(s),r=await w0(t.localStore,e.query,!0),i=e.view.cu(r);return t.isPrimaryClient&&sv(t,e.targetId,i.au),i}async function dM(s,e){const t=Be(s);return I4(t.localStore,e).then((r=>Ci(t,r)))}async function uM(s,e,t,r){const i=Be(s),l=await(function(h,f){const m=Be(h),b=Be(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",(y=>b.Xn(y,f).next((v=>v?m.localDocuments.getDocuments(y,v):le.resolve(null)))))})(i.localStore,e);l!==null?(t==="pending"?await lu(i.remoteStore):t==="acknowledged"||t==="rejected"?(Ew(i,e,r||null),Sw(i,e),(function(h,f){Be(Be(h).mutationQueue).nr(f)})(i.localStore,e)):ze(6720,"Unknown batchState",{bu:t}),await Ci(i,l)):Ce(Ho,"Cannot apply mutation batch with id: "+e)}async function hM(s,e){const t=Be(s);if(ip(t),Aw(t),e===!0&&t.gu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),i=await L5(t,r.toArray());t.gu=!0,await ev(t.remoteStore,!0);for(const l of i)ap(t.remoteStore,l)}else if(e===!1&&t.gu!==!1){const r=[];let i=Promise.resolve();t.Iu.forEach(((l,d)=>{t.sharedClientState.isLocalQueryTarget(d)?r.push(d):i=i.then((()=>(Kd(t,d),Hd(t.localStore,d,!0)))),Gd(t.remoteStore,d)})),await i,await L5(t,r),(function(d){const h=Be(d);h.Au.forEach(((f,m)=>{Gd(h.remoteStore,m)})),h.Vu.zr(),h.Au=new Map,h.Ru=new ts(Ue.comparator)})(t),t.gu=!1,await ev(t.remoteStore,!1)}}async function L5(s,e,t){const r=Be(s),i=[],l=[];for(const d of e){let h;const f=r.Iu.get(d);if(f&&f.length!==0){h=await qd(r.localStore,Pn(f[0]));for(const m of f){const b=r.Tu.get(m),y=await cM(r,b);y.snapshot&&l.push(y.snapshot)}}else{const m=await E4(r.localStore,d);h=await qd(r.localStore,m),await Tw(r,K4(m),d,!1,h.resumeToken)}i.push(h)}return r.Pu.J_(l),i}function K4(s){return AE(s.path,s.collectionGroup,s.orderBy,s.filters,s.limit,"F",s.startAt,s.endAt)}function fM(s){return(function(t){return Be(Be(t).persistence).hs()})(Be(s).localStore)}async function mM(s,e,t,r){const i=Be(s);if(i.gu)return void Ce(Ho,"Ignoring unexpected query state notification.");const l=i.Iu.get(e);if(l&&l.length>0)switch(t){case"current":case"not-current":{const d=await I4(i.localStore,CE(l[0])),h=Mf.createSynthesizedRemoteEventForCurrentChange(e,t==="current",vs.EMPTY_BYTE_STRING);await Ci(i,d,h);break}case"rejected":await Hd(i.localStore,e,!0),Kd(i,e,r);break;default:ze(64155,t)}}async function gM(s,e,t){const r=ip(s);if(r.gu){for(const i of e){if(r.Iu.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){Ce(Ho,"Adding an already active target "+i);continue}const l=await E4(r.localStore,i),d=await qd(r.localStore,l);await Tw(r,K4(l),d.targetId,!1,d.resumeToken),ap(r.remoteStore,d)}for(const i of t)r.Iu.has(i)&&await Hd(r.localStore,i,!1).then((()=>{Gd(r.remoteStore,i),Kd(r,i)})).catch(Bo)}}function ip(s){const e=Be(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=G4.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=sM.bind(null,e),e.Pu.J_=qP.bind(null,e.eventManager),e.Pu.yu=HP.bind(null,e.eventManager),e}function Aw(s){const e=Be(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=nM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rM.bind(null,e),e}function pM(s,e,t){const r=Be(s);(async function(l,d,h){try{const f=await d.getMetadata();if(await(function(N,E){const I=Be(N),T=As(E.createTime);return I.persistence.runTransaction("hasNewerBundle","readonly",(L=>I.Pi.getBundleMetadata(L,E.id))).then((L=>!!L&&L.createTime.compareTo(T)>=0))})(l.localStore,f))return await d.close(),h._completeWith((function(N){return{taskState:"Success",documentsLoaded:N.totalDocuments,bytesLoaded:N.totalBytes,totalDocuments:N.totalDocuments,totalBytes:N.totalBytes}})(f)),Promise.resolve(new Set);h._updateProgress(B4(f));const m=new WP(f,d.serializer);let b=await d.Su();for(;b;){const v=await m.Ga(b);v&&h._updateProgress(v),b=await d.Su()}const y=await m.ja(l.localStore);return await Ci(l,y.Ja,void 0),await(function(N,E){const I=Be(N);return I.persistence.runTransaction("Save bundle","readwrite",(T=>I.Pi.saveBundleMetadata(T,E)))})(l.localStore,f),h._completeWith(y.progress),Promise.resolve(y.Ha)}catch(f){return za(Ho,`Loading bundle failed with ${f}`),h._failWith(f),Promise.resolve(new Set)}})(r,e,t).then((i=>{r.sharedClientState.notifyBundleLoaded(i)}))}class pf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Vf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return N4(this.persistence,new j4,e.initialUser,this.serializer)}Cu(e){return new dw(rp.Vi,this.serializer)}Du(e){return new D4}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}pf.provider={build:()=>new pf};class xM extends pf{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ke(this.persistence.referenceDelegate instanceof v0,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new p4(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?jn.withCacheSize(this.cacheSizeBytes):jn.DEFAULT;return new dw((r=>v0.Vi(r,t)),this.serializer)}}class Q4 extends pf{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Aw(this.xu.syncEngine),await lu(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return N4(this.persistence,new j4,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new p4(r,e.asyncQueue,t)}Mu(e,t){const r=new v6(t,this.persistence);return new y6(e.asyncQueue,r)}Cu(e){const t=hw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?jn.withCacheSize(this.cacheSizeBytes):jn.DEFAULT;return new uw(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,O4(),e0(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new D4}}class bM extends Q4{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Yb&&(this.sharedClientState.syncEngine={So:uM.bind(null,t),Do:mM.bind(null,t),Co:gM.bind(null,t),hs:fM.bind(null,t),bo:dM.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async r=>{await hM(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Du(e){const t=O4();if(!Yb.v(t))throw new Ae(xe.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=hw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Yb(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class xf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>M5(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=oM.bind(null,this.syncEngine),await ev(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new $P})()}createDatastore(e){const t=Vf(e.databaseInfo.databaseId),r=_P(e.databaseInfo);return AP(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,l,d,h){return new CP(r,i,l,d,h)})(this.localStore,this.datastore,e.asyncQueue,(t=>M5(this.syncEngine,t,0)),(function(){return A5.v()?new A5:new vP})())}createSyncEngine(e,t){return(function(i,l,d,h,f,m,b){const y=new YP(i,l,d,h,f,m);return b&&(y.gu=!0),y})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(i){const l=Be(i);Ce(Jl,"RemoteStore shutting down."),l.Ea.add(5),await ou(l),l.Aa.shutdown(),l.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}xf.provider={build:()=>new xf};function V5(s,e=10240){let t=0;return{async read(){if(t<s.byteLength){const r={value:s.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Es("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yM{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new gn,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((r=>{r&&r.Ua()?this.metadata.resolve(r.qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.qa)}`))}),(r=>this.metadata.reject(r)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.Ku();if(e===null)return null;const t=this.Lu.decode(e),r=Number(t);isNaN(r)&&this.qu(`length string (${t}) is not valid number`);const i=await this.Uu(r);return new GP(JSON.parse(i),e.length+r)}$u(){return this.buffer.findIndex((e=>e===123))}async Ku(){for(;this.$u()<0&&!await this.Wu(););if(this.buffer.length===0)return null;const e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Uu(e){for(;this.buffer.length<e;)await this.Wu()&&this.qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Wu(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vM=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Ae(xe.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(i,l){const d=Be(i),h={documents:l.map((y=>mf(d.serializer,y)))},f=await d.jo("BatchGetDocuments",d.serializer.databaseId,Nt.emptyPath(),h,l.length),m=new Map;f.forEach((y=>{const v=CO(d.serializer,y);m.set(v.key.toString(),v)}));const b=[];return l.forEach((y=>{const v=m.get(y.toString());Ke(!!v,55234,{key:y}),b.push(v)})),b})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new iu(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{const i=Ue.fromPath(r);this.mutations.push(new ew(i,this.precondition(i)))})),await(async function(r,i){const l=Be(r),d={writes:i.map((h=>gf(l.serializer,h)))};await l.Wo("Commit",l.serializer.databaseId,Nt.emptyPath(),d)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ze(50498,{Gu:e.constructor.name});t=Ye.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Ae(xe.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ye.min())?hs.exists(!1):hs.updateTime(t):hs.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ye.min()))throw new Ae(xe.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return hs.updateTime(t)}return hs.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wM{constructor(e,t,r,i,l){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=l,this.zu=r.maxAttempts,this.M_=new pw(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_((async()=>{const e=new vM(this.datastore),t=this.Ju(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((i=>{this.Zu(i)}))))})).catch((r=>{this.Zu(r)}))}))}Ju(e){try{const t=this.updateFunction(e);return!kf(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Hu(),Promise.resolve())))):this.deferred.reject(e)}Xu(e){if((e==null?void 0:e.name)==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!qE(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uo="FirestoreClient";class jM{constructor(e,t,r,i,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this._databaseInfo=i,this.user=en.UNAUTHENTICATED,this.clientId=Fv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(r,(async d=>{Ce(Uo,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(r,(d=>(Ce(Uo,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new gn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=du(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Jb(s,e){s.asyncQueue.verifyOperationInProgress(),Ce(Uo,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let r=t.initialUser;s.setCredentialChangeListener((async i=>{r.isEqual(i)||(await _4(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function U5(s,e){s.asyncQueue.verifyOperationInProgress();const t=await kw(s);Ce(Uo,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((r=>C5(e.remoteStore,r))),s.setAppCheckTokenChangeListener(((r,i)=>C5(e.remoteStore,i))),s._onlineComponents=e}async function kw(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){Ce(Uo,"Using user provided OfflineComponentProvider");try{await Jb(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===xe.FAILED_PRECONDITION||i.code===xe.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;za("Error using user provided cache. Falling back to memory cache: "+t),await Jb(s,new pf)}}else Ce(Uo,"Using default OfflineComponentProvider"),await Jb(s,new xM(void 0));return s._offlineComponents}async function lp(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(Ce(Uo,"Using user provided OnlineComponentProvider"),await U5(s,s._uninitializedComponentsProvider._online)):(Ce(Uo,"Using default OnlineComponentProvider"),await U5(s,new xf))),s._onlineComponents}function Y4(s){return kw(s).then((e=>e.persistence))}function Cw(s){return kw(s).then((e=>e.localStore))}function X4(s){return lp(s).then((e=>e.remoteStore))}function Rw(s){return lp(s).then((e=>e.syncEngine))}function NM(s){return lp(s).then((e=>e.datastore))}async function Qd(s){const e=await lp(s),t=e.eventManager;return t.onListen=XP.bind(null,e.syncEngine),t.onUnlisten=ZP.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=JP.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=eM.bind(null,e.syncEngine),t}function _M(s){return s.asyncQueue.enqueue((async()=>{const e=await Y4(s),t=await X4(s);return e.setNetworkEnabled(!0),(function(i){const l=Be(i);return l.Ea.delete(0),Uf(l)})(t)}))}function TM(s){return s.asyncQueue.enqueue((async()=>{const e=await Y4(s),t=await X4(s);return e.setNetworkEnabled(!1),(async function(i){const l=Be(i);l.Ea.add(0),await ou(l),l.Va.set("Offline")})(t)}))}function SM(s,e,t,r){const i=new op(r),l=new _w(e,i,t);return s.asyncQueue.enqueueAndForget((async()=>ww(await Qd(s),l))),()=>{i.Nu(),s.asyncQueue.enqueueAndForget((async()=>jw(await Qd(s),l)))}}function EM(s,e){const t=new gn;return s.asyncQueue.enqueueAndForget((async()=>(async function(i,l,d){try{const h=await(function(m,b){const y=Be(m);return y.persistence.runTransaction("read document","readonly",(v=>y.localDocuments.getDocument(v,b)))})(i,l);h.isFoundDocument()?d.resolve(h):h.isNoDocument()?d.resolve(null):d.reject(new Ae(xe.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const f=du(h,`Failed to get document '${l} from cache`);d.reject(f)}})(await Cw(s),e,t))),t.promise}function J4(s,e,t={}){const r=new gn;return s.asyncQueue.enqueueAndForget((async()=>(function(l,d,h,f,m){const b=new op({next:v=>{b.Nu(),d.enqueueAndForget((()=>jw(l,y)));const N=v.docs.has(h);!N&&v.fromCache?m.reject(new Ae(xe.UNAVAILABLE,"Failed to get document because the client is offline.")):N&&v.fromCache&&f&&f.source==="server"?m.reject(new Ae(xe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(v)},error:v=>m.reject(v)}),y=new _w(ru(h.path),b,{includeMetadataChanges:!0,Ka:!0});return ww(l,y)})(await Qd(s),s.asyncQueue,e,t,r))),r.promise}function IM(s,e){const t=new gn;return s.asyncQueue.enqueueAndForget((async()=>(async function(i,l,d){try{const h=await w0(i,l,!0),f=new q4(l,h.ks),m=f.ru(h.documents),b=f.applyChanges(m,!1);d.resolve(b.snapshot)}catch(h){const f=du(h,`Failed to execute query '${l} against cache`);d.reject(f)}})(await Cw(s),e,t))),t.promise}function Z4(s,e,t={}){const r=new gn;return s.asyncQueue.enqueueAndForget((async()=>(function(l,d,h,f,m){const b=new op({next:v=>{b.Nu(),d.enqueueAndForget((()=>jw(l,y))),v.fromCache&&f.source==="server"?m.reject(new Ae(xe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(v)},error:v=>m.reject(v)}),y=new _w(h,b,{includeMetadataChanges:!0,Ka:!0});return ww(l,y)})(await Qd(s),s.asyncQueue,e,t,r))),r.promise}function AM(s,e){const t=new gn;return s.asyncQueue.enqueueAndForget((async()=>tM(await Rw(s),e,t))),t.promise}function kM(s,e){const t=new op(e);return s.asyncQueue.enqueueAndForget((async()=>(function(i,l){Be(i).Ca.add(l),l.next()})(await Qd(s),t))),()=>{t.Nu(),s.asyncQueue.enqueueAndForget((async()=>(function(i,l){Be(i).Ca.delete(l)})(await Qd(s),t)))}}function CM(s,e,t){const r=new gn;return s.asyncQueue.enqueueAndForget((async()=>{const i=await NM(s);new wM(s.asyncQueue,i,t,e,r).ju()})),r.promise}function RM(s,e,t,r){const i=(function(d,h){let f;return f=typeof d=="string"?GE().encode(d):d,(function(b,y){return new yM(b,y)})((function(b,y){if(b instanceof Uint8Array)return V5(b,y);if(b instanceof ArrayBuffer)return V5(new Uint8Array(b),y);if(b instanceof ReadableStream)return b.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(f),h)})(t,Vf(e));s.asyncQueue.enqueueAndForget((async()=>{pM(await Rw(s),i,r)}))}function DM(s,e){return s.asyncQueue.enqueue((async()=>(function(r,i){const l=Be(r);return l.persistence.runTransaction("Get named query","readonly",(d=>l.Pi.getNamedQuery(d,i)))})(await Cw(s),e)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eI(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OM="ComponentProvider",F5=new Map;function PM(s,e,t,r,i){return new Q6(s,e,t,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,eI(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI="firestore.googleapis.com",B5=!0;class z5{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ae(xe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=tI,this.ssl=B5}else this.host=e.host,this.ssl=e.ssl??B5;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=h4;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<YO)throw new Ae(xe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}WS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=eI(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Ae(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Ae(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Ae(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ff{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new z5({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ae(xe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ae(xe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new z5(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new o6;switch(r.type){case"firstParty":return new u6(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ae(xe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=F5.get(t);r&&(Ce(OM,"Removing Datastore"),F5.delete(t),r.terminate())})(this),Promise.resolve()}}function MM(s,e,t,r={}){var m;s=Rt(s,Ff);const i=Fo(e),l=s._getSettings(),d={...l,emulatorOptions:s._getEmulatorOptions()},h=`${e}:${t}`;i&&(Cv(`https://${h}`),Rv("Firestore",!0)),l.host!==tI&&l.host!==h&&za("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...l,host:h,ssl:i,emulatorOptions:r};if(!ko(f,d)&&(s._setSettings(f),r.mockUserToken)){let b,y;if(typeof r.mockUserToken=="string")b=r.mockUserToken,y=en.MOCK_USER;else{b=yS(r.mockUserToken,(m=s._app)==null?void 0:m.options.projectId);const v=r.mockUserToken.sub||r.mockUserToken.user_id;if(!v)throw new Ae(xe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new en(v)}s._authCredentials=new l6(new HS(b,y))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vn=class sI{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new sI(this.firestore,e,this._query)}},es=class Oh{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new So(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Oh(this.firestore,e,this._key)}toJSON(){return{type:Oh._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Af(t,Oh._jsonSchema))return new Oh(e,r||null,new Ue(Nt.fromString(t.referencePath)))}};es._jsonSchemaVersion="firestore/documentReference/1.0",es._jsonSchema={type:Bs("string",es._jsonSchemaVersion),referencePath:Bs("string")};let So=class nI extends Vn{constructor(e,t,r){super(e,t,ru(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new es(this.firestore,null,new Ue(e))}withConverter(e){return new nI(this.firestore,e,this._path)}};function rI(s,e,...t){if(s=Ge(s),Bv("collection","path",e),s instanceof Ff){const r=Nt.fromString(e,...t);return k_(r),new So(s,null,r)}{if(!(s instanceof es||s instanceof So))throw new Ae(xe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=s._path.child(Nt.fromString(e,...t));return k_(r),new So(s.firestore,null,r)}}function LM(s,e){if(s=Rt(s,Ff),Bv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Ae(xe.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Vn(s,null,(function(r){return new Ii(Nt.emptyPath(),r)})(e))}function T0(s,e,...t){if(s=Ge(s),arguments.length===1&&(e=Fv.newId()),Bv("doc","path",e),s instanceof Ff){const r=Nt.fromString(e,...t);return A_(r),new es(s,null,new Ue(r))}{if(!(s instanceof es||s instanceof So))throw new Ae(xe.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=s._path.child(Nt.fromString(e,...t));return A_(r),new es(s.firestore,s instanceof So?s.converter:null,new Ue(r))}}function aI(s,e){return s=Ge(s),e=Ge(e),(s instanceof es||s instanceof So)&&(e instanceof es||e instanceof So)&&s.firestore===e.firestore&&s.path===e.path&&s.converter===e.converter}function iI(s,e){return s=Ge(s),e=Ge(e),s instanceof Vn&&e instanceof Vn&&s.firestore===e.firestore&&Df(s._query,e._query)&&s.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $5="AsyncQueue";class q5{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new pw(this,"async_queue_retry"),this._c=()=>{const r=e0();r&&Ce($5,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=e0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=e0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new gn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!zo(e))throw e;Ce($5,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Es("INTERNAL UNHANDLED ERROR: ",H5(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=vw.createAndSchedule(this,e,t,r,(l=>this.hc(l)));return this.tc.push(i),i}uc(){this.nc&&ze(47125,{Pc:H5(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function H5(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VM{constructor(){this._progressObserver={},this._taskCompletionResolver=new gn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UM=-1;let ks=class extends Ff{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new q5,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new q5(e),this._firestoreClient=void 0,await e}}};function En(s){if(s._terminated)throw new Ae(xe.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||oI(s),s._firestoreClient}function oI(s){var r,i,l,d;const e=s._freezeSettings(),t=PM(s._databaseId,((r=s._app)==null?void 0:r.options.appId)||"",s._persistenceKey,(i=s._app)==null?void 0:i.options.apiKey,e);s._componentsProvider||(l=e.localCache)!=null&&l._offlineComponentProvider&&((d=e.localCache)!=null&&d._onlineComponentProvider)&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new jM(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(f){const m=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(m),_online:m}})(s._componentsProvider))}function FM(s,e){za("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=s._freezeSettings();return lI(s,xf.provider,{build:r=>new Q4(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function BM(s){za("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=s._freezeSettings();lI(s,xf.provider,{build:t=>new bM(t,e.cacheSizeBytes)})}function lI(s,e,t){if((s=Rt(s,ks))._firestoreClient||s._terminated)throw new Ae(xe.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(s._componentsProvider||s._getSettings().localCache)throw new Ae(xe.FAILED_PRECONDITION,"SDK cache is already specified.");s._componentsProvider={_online:e,_offline:t},oI(s)}function zM(s){if(s._initialized&&!s._terminated)throw new Ae(xe.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new gn;return s._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(r){if(!La.v())return Promise.resolve();const i=r+w4;await La.delete(i)})(hw(s._databaseId,s._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function $M(s){return(function(t){const r=new gn;return t.asyncQueue.enqueueAndForget((async()=>aM(await Rw(t),r))),r.promise})(En(s=Rt(s,ks)))}function qM(s){return _M(En(s=Rt(s,ks)))}function HM(s){return TM(En(s=Rt(s,ks)))}function GM(s,e){const t=En(s=Rt(s,ks)),r=new VM;return RM(t,s._databaseId,e,r),r}function WM(s,e){return DM(En(s=Rt(s,ks)),e).then((t=>t?new Vn(s,null,t.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Nn(vs.fromBase64String(e))}catch(t){throw new Ae(xe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Nn(vs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Nn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Af(e,Nn._jsonSchema))return Nn.fromBase64String(e.bytes)}}Nn._jsonSchemaVersion="firestore/bytes/1.0",Nn._jsonSchema={type:Bs("string",Nn._jsonSchemaVersion),bytes:Bs("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zl=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ae(xe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new us(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dc=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ae(xe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ae(xe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ot(this._lat,e._lat)||ot(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ea._jsonSchemaVersion}}static fromJSON(e){if(Af(e,ea._jsonSchema))return new ea(e.latitude,e.longitude)}}ea._jsonSchemaVersion="firestore/geoPoint/1.0",ea._jsonSchema={type:Bs("string",ea._jsonSchemaVersion),latitude:Bs("number"),longitude:Bs("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let l=0;l<r.length;++l)if(r[l]!==i[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ta._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Af(e,ta._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ta(e.vectorValues);throw new Ae(xe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ta._jsonSchemaVersion="firestore/vectorValue/1.0",ta._jsonSchema={type:Bs("string",ta._jsonSchemaVersion),vectorValues:Bs("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KM=/^__.*__$/;class QM{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ki(e,this.data,this.fieldMask,t,this.fieldTransforms):new au(e,this.data,t,this.fieldTransforms)}}class cI{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ki(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function dI(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ze(40011,{dataSource:s})}}class cp{constructor(e,t,r,i,l,d){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,l===void 0&&this.validatePath(),this.fieldTransforms=l||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new cp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var i;const t=(i=this.path)==null?void 0:i.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var i;const t=(i=this.path)==null?void 0:i.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return S0(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(dI(this.dataSource)&&KM.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class YM{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Vf(e)}createContext(e,t,r,i=!1){return new cp({dataSource:e,methodName:t,targetDoc:r,path:us.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function uc(s){const e=s._freezeSettings(),t=Vf(s._databaseId);return new YM(s._databaseId,!!e.ignoreUndefinedProperties,t)}function dp(s,e,t,r,i,l={}){const d=s.createContext(l.merge||l.mergeFields?2:0,e,t,i);Uw("Data must be an object, but it was:",d,r);const h=fI(r,d);let f,m;if(l.merge)f=new Qn(d.fieldMask),m=d.fieldTransforms;else if(l.mergeFields){const b=[];for(const y of l.mergeFields){const v=ec(e,y,t);if(!d.contains(v))throw new Ae(xe.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);pI(b,v)||b.push(v)}f=new Qn(b),m=d.fieldTransforms.filter((y=>f.covers(y.field)))}else f=null,m=d.fieldTransforms;return new QM(new un(h),f,m)}class Bf extends dc{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Bf}}function uI(s,e,t){return new cp({dataSource:3,targetDoc:e.settings.targetDoc,methodName:s._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Dw extends dc{_toFieldTransform(e){return new Pf(e.path,new Bd)}isEqual(e){return e instanceof Dw}}class Ow extends dc{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=uI(this,e,!0),r=this.Ac.map((l=>hc(l,t))),i=new Wl(r);return new Pf(e.path,i)}isEqual(e){return e instanceof Ow&&ko(this.Ac,e.Ac)}}class Pw extends dc{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=uI(this,e,!0),r=this.Ac.map((l=>hc(l,t))),i=new Kl(r);return new Pf(e.path,i)}isEqual(e){return e instanceof Pw&&ko(this.Ac,e.Ac)}}class Mw extends dc{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new zd(e.serializer,LE(e.serializer,this.Vc));return new Pf(e.path,t)}isEqual(e){return e instanceof Mw&&this.Vc===e.Vc}}function Lw(s,e,t,r){const i=s.createContext(1,e,t);Uw("Data must be an object, but it was:",i,r);const l=[],d=un.empty();$o(r,((f,m)=>{const b=gI(e,f,t);m=Ge(m);const y=i.childContextForFieldPath(b);if(m instanceof Bf)l.push(b);else{const v=hc(m,y);v!=null&&(l.push(b),d.set(b,v))}}));const h=new Qn(l);return new cI(d,h,i.fieldTransforms)}function Vw(s,e,t,r,i,l){const d=s.createContext(1,e,t),h=[ec(e,r,t)],f=[i];if(l.length%2!=0)throw new Ae(xe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<l.length;v+=2)h.push(ec(e,l[v])),f.push(l[v+1]);const m=[],b=un.empty();for(let v=h.length-1;v>=0;--v)if(!pI(m,h[v])){const N=h[v];let E=f[v];E=Ge(E);const I=d.childContextForFieldPath(N);if(E instanceof Bf)m.push(N);else{const T=hc(E,I);T!=null&&(m.push(N),b.set(N,T))}}const y=new Qn(m);return new cI(b,y,d.fieldTransforms)}function hI(s,e,t,r=!1){return hc(t,s.createContext(r?4:3,e))}function hc(s,e){if(mI(s=Ge(s)))return Uw("Unsupported field value:",e,s),fI(s,e);if(s instanceof dc)return(function(r,i){if(!dI(i.dataSource))throw i.createError(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.createError(`${r._methodName}() is not currently supported inside arrays`);const l=r._toFieldTransform(i);l&&i.fieldTransforms.push(l)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(r,i){const l=[];let d=0;for(const h of r){let f=hc(h,i.childContextForArray(d));f==null&&(f={nullValue:"NULL_VALUE"}),l.push(f),d++}return{arrayValue:{values:l}}})(s,e)}return(function(r,i){if((r=Ge(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return LE(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const l=Vt.fromDate(r);return{timestampValue:$d(i.serializer,l)}}if(r instanceof Vt){const l=new Vt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:$d(i.serializer,l)}}if(r instanceof ea)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Nn)return{bytesValue:QE(i.serializer,r._byteString)};if(r instanceof es){const l=i.databaseId,d=r.firestore._databaseId;if(!d.isEqual(l))throw i.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:aw(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ta)return(function(d,h){const f=d instanceof ta?d.toArray():d;return{mapValue:{fields:{[Kv]:{stringValue:Qv},[Vd]:{arrayValue:{values:f.map((b=>{if(typeof b!="number")throw h.createError("VectorValues must only contain numeric values.");return Zv(h.serializer,b)}))}}}}}})(r,i);if(o4(r))return r._toProto(i.serializer);throw i.createError(`Unsupported field value: ${G0(r)}`)})(s,e)}function fI(s,e){const t={};return hE(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):$o(s,((r,i)=>{const l=hc(i,e.childContextForField(r));l!=null&&(t[r]=l)})),{mapValue:{fields:t}}}function mI(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Vt||s instanceof ea||s instanceof Nn||s instanceof es||s instanceof dc||s instanceof ta||o4(s))}function Uw(s,e,t){if(!mI(t)||!KS(t)){const r=G0(t);throw r==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+r)}}function ec(s,e,t){if((e=Ge(e))instanceof Zl)return e._internalPath;if(typeof e=="string")return gI(s,e);throw S0("Field path arguments must be of type string or ",s,!1,void 0,t)}const XM=new RegExp("[~\\*/\\[\\]]");function gI(s,e,t){if(e.search(XM)>=0)throw S0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new Zl(...e.split("."))._internalPath}catch{throw S0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function S0(s,e,t,r,i){const l=r&&!r.isEmpty(),d=i!==void 0;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let f="";return(l||d)&&(f+=" (found",l&&(f+=` in field ${r}`),d&&(f+=` in document ${i}`),f+=")"),new Ae(xe.INVALID_ARGUMENT,h+s+f)}function pI(s,e){return s.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw{convertValue(e,t="none"){switch(Po(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ds(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(_i(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ze(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return $o(e,((i,l)=>{r[i]=this.convertValue(l,t)})),r}convertVectorValue(e){var r,i,l;const t=(l=(i=(r=e.fields)==null?void 0:r[Vd].arrayValue)==null?void 0:i.values)==null?void 0:l.map((d=>ds(d.doubleValue)));return new ta(t)}convertGeoPoint(e){return new ea(ds(e.latitude),ds(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=J0(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(df(e));default:return null}}convertTimestamp(e){const t=Ni(e);return new Vt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Nt.fromString(e);Ke(i4(r),9688,{name:e});const i=new Oo(r.get(1),r.get(3)),l=new Ue(r.popFirst(5));return i.isEqual(t)||Es(`Document ${l} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc extends Fw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new es(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JM(){return new Bf("deleteField")}function ZM(){return new Dw("serverTimestamp")}function eL(...s){return new Ow("arrayUnion",s)}function tL(...s){return new Pw("arrayRemove",s)}function sL(s){return new Mw("increment",s)}const G5="@firebase/firestore",W5="4.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nv(s){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const l of r)if(l in i&&typeof i[l]=="function")return!0;return!1})(s,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e,t,r,i,l){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new es(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new nL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const t=this._document.data.field(ec("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class nL extends bf{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xI(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new Ae(xe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Bw{}class zf extends Bw{}function po(s,e,...t){let r=[];e instanceof Bw&&r.push(e),r=r.concat(t),(function(l){const d=l.filter((f=>f instanceof zw)).length,h=l.filter((f=>f instanceof up)).length;if(d>1||d>0&&h>0)throw new Ae(xe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)s=i._apply(s);return s}class up extends zf{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new up(e,t,r)}_apply(e){const t=this._parse(e);return yI(e._query,t),new Vn(e.firestore,e.converter,qy(e._query,t))}_parse(e){const t=uc(e.firestore);return(function(l,d,h,f,m,b,y){let v;if(m.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new Ae(xe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){Q5(y,b);const E=[];for(const I of y)E.push(K5(f,l,I));v={arrayValue:{values:E}}}else v=K5(f,l,y)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||Q5(y,b),v=hI(h,d,y,b==="in"||b==="not-in");return St.create(m,b,v)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function rL(s,e,t){const r=e,i=ec("where",s);return up._create(i,r,t)}class zw extends Bw{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new zw(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Ht.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,l){let d=i;const h=l.getFlattenedFilters();for(const f of h)yI(d,f),d=qy(d,f)})(e._query,t),new Vn(e.firestore,e.converter,qy(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class $w extends zf{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new $w(e,t)}_apply(e){const t=(function(i,l,d){if(i.startAt!==null)throw new Ae(xe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Ae(xe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ff(l,d)})(e._query,this._field,this._direction);return new Vn(e.firestore,e.converter,cO(e._query,t))}}function aL(s,e="asc"){const t=e,r=ec("orderBy",s);return $w._create(r,t)}class hp extends zf{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new hp(e,t,r)}_apply(e){return new Vn(e.firestore,e.converter,p0(e._query,this._limit,this._limitType))}}function iL(s){return QS("limit",s),hp._create("limit",s,"F")}function oL(s){return QS("limitToLast",s),hp._create("limitToLast",s,"L")}class fp extends zf{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new fp(e,t,r)}_apply(e){const t=bI(e,this.type,this._docOrFields,this._inclusive);return new Vn(e.firestore,e.converter,dO(e._query,t))}}function lL(...s){return fp._create("startAt",s,!0)}function cL(...s){return fp._create("startAfter",s,!1)}class mp extends zf{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new mp(e,t,r)}_apply(e){const t=bI(e,this.type,this._docOrFields,this._inclusive);return new Vn(e.firestore,e.converter,uO(e._query,t))}}function dL(...s){return mp._create("endBefore",s,!1)}function uL(...s){return mp._create("endAt",s,!0)}function bI(s,e,t,r){if(t[0]=Ge(t[0]),t[0]instanceof bf)return(function(l,d,h,f,m){if(!f)throw new Ae(xe.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${h}().`);const b=[];for(const y of wd(l))if(y.field.isKeyField())b.push(Hl(d,f.key));else{const v=f.data.field(y.field);if(X0(v))throw new Ae(xe.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+y.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(v===null){const N=y.field.canonicalString();throw new Ae(xe.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${N}' (used as the orderBy) does not exist.`)}b.push(v)}return new Lo(b,m)})(s._query,s.firestore._databaseId,e,t[0]._document,r);{const i=uc(s.firestore);return(function(d,h,f,m,b,y){const v=d.explicitOrderBy;if(b.length>v.length)throw new Ae(xe.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const N=[];for(let E=0;E<b.length;E++){const I=b[E];if(v[E].field.isKeyField()){if(typeof I!="string")throw new Ae(xe.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof I}`);if(!Xv(d)&&I.indexOf("/")!==-1)throw new Ae(xe.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${I}' contains a slash.`);const T=d.path.child(Nt.fromString(I));if(!Ue.isDocumentKey(T))throw new Ae(xe.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${T}' is not because it contains an odd number of segments.`);const L=new Ue(T);N.push(Hl(h,L))}else{const T=hI(f,m,I);N.push(T)}}return new Lo(N,y)})(s._query,s.firestore._databaseId,i,e,t,r)}}function K5(s,e,t){if(typeof(t=Ge(t))=="string"){if(t==="")throw new Ae(xe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Xv(e)&&t.indexOf("/")!==-1)throw new Ae(xe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Nt.fromString(t));if(!Ue.isDocumentKey(r))throw new Ae(xe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Hl(s,new Ue(r))}if(t instanceof es)return Hl(s,t._key);throw new Ae(xe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${G0(t)}.`)}function Q5(s,e){if(!Array.isArray(s)||s.length===0)throw new Ae(xe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function yI(s,e){const t=(function(i,l){for(const d of i)for(const h of d.getFlattenedFilters())if(l.indexOf(h.op)>=0)return h.op;return null})(s.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ae(xe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ae(xe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function gp(s,e,t){let r;return r=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,r}class hL extends Fw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new es(this.firestore,null,t)}}class Ol{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Pr=class vI extends bf{constructor(e,t,r,i,l,d){super(e,t,r,i,d),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Wh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(ec("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ae(xe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=vI._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Pr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Pr._jsonSchema={type:Bs("string",Pr._jsonSchemaVersion),bundleSource:Bs("string","DocumentSnapshot"),bundleName:Bs("string"),bundle:Bs("string")};let Wh=class extends Pr{data(e={}){return super.data(e)}},sa=class wI{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Ol(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Wh(this._firestore,this._userDataWriter,r.key,r,new Ol(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ae(xe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,l){if(i._snapshot.oldDocs.isEmpty()){let d=0;return i._snapshot.docChanges.map((h=>{const f=new Wh(i._firestore,i._userDataWriter,h.doc.key,h.doc,new Ol(i._snapshot.mutatedKeys.has(h.doc.key),i._snapshot.fromCache),i.query.converter);return h.doc,{type:"added",doc:f,oldIndex:-1,newIndex:d++}}))}{let d=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((h=>l||h.type!==3)).map((h=>{const f=new Wh(i._firestore,i._userDataWriter,h.doc.key,h.doc,new Ol(i._snapshot.mutatedKeys.has(h.doc.key),i._snapshot.fromCache),i.query.converter);let m=-1,b=-1;return h.type!==0&&(m=d.indexOf(h.doc.key),d=d.delete(h.doc.key)),h.type!==1&&(d=d.add(h.doc),b=d.indexOf(h.doc.key)),{type:fL(h.type),doc:f,oldIndex:m,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ae(xe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=wI._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Fv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),r.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),i.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function fL(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ze(61501,{type:s})}}function jI(s,e){return s instanceof Pr&&e instanceof Pr?s._firestore===e._firestore&&s._key.isEqual(e._key)&&(s._document===null?e._document===null:s._document.isEqual(e._document))&&s._converter===e._converter:s instanceof sa&&e instanceof sa&&s._firestore===e._firestore&&iI(s.query,e.query)&&s.metadata.isEqual(e.metadata)&&s._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sa._jsonSchemaVersion="firestore/querySnapshot/1.0",sa._jsonSchema={type:Bs("string",sa._jsonSchemaVersion),bundleSource:Bs("string","QuerySnapshot"),bundleName:Bs("string"),bundle:Bs("string")};const mL={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gL=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=uc(e)}set(e,t,r){this._verifyNotCommitted();const i=wo(e,this._firestore),l=gp(i.converter,t,r),d=dp(this._dataReader,"WriteBatch.set",i._key,l,i.converter!==null,r);return this._mutations.push(d.toMutation(i._key,hs.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const l=wo(e,this._firestore);let d;return d=typeof(t=Ge(t))=="string"||t instanceof Zl?Vw(this._dataReader,"WriteBatch.update",l._key,t,r,i):Lw(this._dataReader,"WriteBatch.update",l._key,t),this._mutations.push(d.toMutation(l._key,hs.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=wo(e,this._firestore);return this._mutations=this._mutations.concat(new iu(t._key,hs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ae(xe.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function wo(s,e){if((s=Ge(s)).firestore!==e)throw new Ae(xe.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=uc(e)}get(e){const t=wo(e,this._firestore),r=new hL(this._firestore);return this._transaction.lookup([t._key]).then((i=>{if(!i||i.length!==1)return ze(24041);const l=i[0];if(l.isFoundDocument())return new bf(this._firestore,r,l.key,l,t.converter);if(l.isNoDocument())return new bf(this._firestore,r,t._key,null,t.converter);throw ze(18433,{doc:l})}))}set(e,t,r){const i=wo(e,this._firestore),l=gp(i.converter,t,r),d=dp(this._dataReader,"Transaction.set",i._key,l,i.converter!==null,r);return this._transaction.set(i._key,d),this}update(e,t,r,...i){const l=wo(e,this._firestore);let d;return d=typeof(t=Ge(t))=="string"||t instanceof Zl?Vw(this._dataReader,"Transaction.update",l._key,t,r,i):Lw(this._dataReader,"Transaction.update",l._key,t),this._transaction.update(l._key,d),this}delete(e){const t=wo(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xL=class extends pL{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=wo(e,this._firestore),r=new fc(this._firestore);return super.get(e).then((i=>new Pr(this._firestore,r,t._key,i._document,new Ol(!1,!1),t.converter)))}};function bL(s,e,t){s=Rt(s,ks);const r={...mL,...t};(function(d){if(d.maxAttempts<1)throw new Ae(xe.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r);const i=En(s);return CM(i,(l=>e(new xL(s,l))),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yL(s){s=Rt(s,es);const e=Rt(s.firestore,ks),t=En(e);return J4(t,s._key).then((r=>qw(e,s,r)))}function vL(s){s=Rt(s,es);const e=Rt(s.firestore,ks),t=En(e),r=new fc(e);return EM(t,s._key).then((i=>new Pr(e,r,s._key,i,new Ol(i!==null&&i.hasLocalMutations,!0),s.converter)))}function wL(s){s=Rt(s,es);const e=Rt(s.firestore,ks),t=En(e);return J4(t,s._key,{source:"server"}).then((r=>qw(e,s,r)))}function jL(s){s=Rt(s,Vn);const e=Rt(s.firestore,ks),t=En(e),r=new fc(e);return xI(s._query),Z4(t,s._query).then((i=>new sa(e,r,s,i)))}function NL(s){s=Rt(s,Vn);const e=Rt(s.firestore,ks),t=En(e),r=new fc(e);return IM(t,s._query).then((i=>new sa(e,r,s,i)))}function _L(s){s=Rt(s,Vn);const e=Rt(s.firestore,ks),t=En(e),r=new fc(e);return Z4(t,s._query,{source:"server"}).then((i=>new sa(e,r,s,i)))}function Y5(s,e,t){s=Rt(s,es);const r=Rt(s.firestore,ks),i=gp(s.converter,e,t),l=uc(r);return $f(r,[dp(l,"setDoc",s._key,i,s.converter!==null,t).toMutation(s._key,hs.none())])}function X5(s,e,t,...r){s=Rt(s,es);const i=Rt(s.firestore,ks),l=uc(i);let d;return d=typeof(e=Ge(e))=="string"||e instanceof Zl?Vw(l,"updateDoc",s._key,e,t,r):Lw(l,"updateDoc",s._key,e),$f(i,[d.toMutation(s._key,hs.exists(!0))])}function TL(s){return $f(Rt(s.firestore,ks),[new iu(s._key,hs.none())])}function SL(s,e){const t=Rt(s.firestore,ks),r=T0(s),i=gp(s.converter,e),l=uc(s.firestore);return $f(t,[dp(l,"addDoc",r._key,i,s.converter!==null,{}).toMutation(r._key,hs.exists(!1))]).then((()=>r))}function NI(s,...e){var m,b,y;s=Ge(s);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||nv(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(nv(e[r])){const v=e[r];e[r]=(m=v.next)==null?void 0:m.bind(v),e[r+1]=(b=v.error)==null?void 0:b.bind(v),e[r+2]=(y=v.complete)==null?void 0:y.bind(v)}let l,d,h;if(s instanceof es)d=Rt(s.firestore,ks),h=ru(s._key.path),l={next:v=>{e[r]&&e[r](qw(d,s,v))},error:e[r+1],complete:e[r+2]};else{const v=Rt(s,Vn);d=Rt(v.firestore,ks),h=v._query;const N=new fc(d);l={next:E=>{e[r]&&e[r](new sa(d,N,v,E))},error:e[r+1],complete:e[r+2]},xI(s._query)}const f=En(d);return SM(f,h,i,l)}function EL(s,e){s=Rt(s,ks);const t=En(s),r=nv(e)?e:{next:e};return kM(t,r)}function $f(s,e){const t=En(s);return AM(t,e)}function qw(s,e,t){const r=t.docs.get(e._key),i=new fc(s);return new Pr(s,i,e._key,r,new Ol(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){r6(Ei),Zn(new sn("firestore",((r,{instanceIdentifier:i,options:l})=>{const d=r.getProvider("app").getImmediate(),h=new ks(new c6(r.getProvider("auth-internal")),new h6(d,r.getProvider("app-check-internal")),Y6(d,i),d);return l={useFetchStreams:t,...l},h._setSettings(l),h}),"PUBLIC").setMultipleInstances(!0)),mn(G5,W5,e),mn(G5,W5,"esm2020")})();const IL="@firebase/firestore-compat",AL="0.4.4";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hw(s,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new Ae("invalid-argument",`Invalid options passed to function ${s}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J5(){if(typeof Uint8Array>"u")throw new Ae("unimplemented","Uint8Arrays are not available in this environment.")}function Z5(){if(!W6())throw new Ae("unimplemented","Blobs are unavailable in Firestore in this environment.")}let _I=class rv{constructor(e){this._delegate=e}static fromBase64String(e){return Z5(),new rv(Nn.fromBase64String(e))}static fromUint8Array(e){return J5(),new rv(Nn.fromUint8Array(e))}toBase64(){return Z5(),this._delegate.toBase64()}toUint8Array(){return J5(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function av(s){return kL(s,["next","error","complete"])}function kL(s,e){if(typeof s!="object"||s===null)return!1;const t=s;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CL{enableIndexedDbPersistence(e,t){return FM(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return BM(e._delegate)}clearIndexedDbPersistence(e){return zM(e._delegate)}}class TI{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Oo||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&za("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){MM(this._delegate,e,t,r)}enableNetwork(){return qM(this._delegate)}disableNetwork(){return HM(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,WS("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return $M(this._delegate)}onSnapshotsInSync(e){return EL(this._delegate,e)}get app(){if(!this._appCompat)throw new Ae("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Yd(this,rI(this._delegate,e))}catch(t){throw Dn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Cr(this,T0(this._delegate,e))}catch(t){throw Dn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Rn(this,LM(this._delegate,e))}catch(t){throw Dn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return bL(this._delegate,t=>e(new SI(this,t)))}batch(){return En(this._delegate),new EI(new gL(this._delegate,e=>$f(this._delegate,e)))}loadBundle(e){return GM(this._delegate,e)}namedQuery(e){return WM(this._delegate,e).then(t=>t?new Rn(this,t):null)}}class pp extends Fw{constructor(e){super(),this.firestore=e}convertBytes(e){return new _I(new Nn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Cr.forKey(t,this.firestore,null)}}function RL(s){a6(s)}class SI{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new pp(e)}get(e){const t=Pl(e);return this._delegate.get(t).then(r=>new yf(this._firestore,new Pr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=Pl(e);return r?(Hw("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const l=Pl(e);return arguments.length===2?this._delegate.update(l,t):this._delegate.update(l,t,r,...i),this}delete(e){const t=Pl(e);return this._delegate.delete(t),this}}class EI{constructor(e){this._delegate=e}set(e,t,r){const i=Pl(e);return r?(Hw("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const l=Pl(e);return arguments.length===2?this._delegate.update(l,t):this._delegate.update(l,t,r,...i),this}delete(e){const t=Pl(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class tc{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new Wh(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new vf(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=tc.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let l=i.get(t);return l||(l=new tc(e,new pp(e),t),i.set(t,l)),l}}tc.INSTANCES=new WeakMap;class Cr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new pp(e)}static forPath(e,t,r){if(e.length%2!==0)throw new Ae("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Cr(t,new es(t._delegate,r,new Ue(e)))}static forKey(e,t,r){return new Cr(t,new es(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Yd(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Yd(this.firestore,rI(this._delegate,e))}catch(t){throw Dn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ge(e),e instanceof es?aI(this._delegate,e):!1}set(e,t){t=Hw("DocumentReference.set",t);try{return t?Y5(this._delegate,e,t):Y5(this._delegate,e)}catch(r){throw Dn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?X5(this._delegate,e):X5(this._delegate,e,t,...r)}catch(i){throw Dn(i,"updateDoc()","DocumentReference.update()")}}delete(){return TL(this._delegate)}onSnapshot(...e){const t=II(e),r=AI(e,i=>new yf(this.firestore,new Pr(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return NI(this._delegate,t,r)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=vL(this._delegate):(e==null?void 0:e.source)==="server"?t=wL(this._delegate):t=yL(this._delegate),t.then(r=>new yf(this.firestore,new Pr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Cr(this.firestore,e?this._delegate.withConverter(tc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Dn(s,e,t){return s.message=s.message.replace(e,t),s}function II(s){for(const e of s)if(typeof e=="object"&&!av(e))return e;return{}}function AI(s,e){var r,i;let t;return av(s[0])?t=s[0]:av(s[1])?t=s[1]:typeof s[0]=="function"?t={next:s[0],error:s[1],complete:s[2]}:t={next:s[1],error:s[2],complete:s[3]},{next:l=>{t.next&&t.next(e(l))},error:(r=t.error)==null?void 0:r.bind(t),complete:(i=t.complete)==null?void 0:i.bind(t)}}class yf{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Cr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return jI(this._delegate,e._delegate)}}class vf extends yf{data(e){const t=this._delegate.data(e);return this._delegate._converter||i6(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class Rn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new pp(e)}where(e,t,r){try{return new Rn(this.firestore,po(this._delegate,rL(e,t,r)))}catch(i){throw Dn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Rn(this.firestore,po(this._delegate,aL(e,t)))}catch(r){throw Dn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Rn(this.firestore,po(this._delegate,iL(e)))}catch(t){throw Dn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Rn(this.firestore,po(this._delegate,oL(e)))}catch(t){throw Dn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Rn(this.firestore,po(this._delegate,lL(...e)))}catch(t){throw Dn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Rn(this.firestore,po(this._delegate,cL(...e)))}catch(t){throw Dn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Rn(this.firestore,po(this._delegate,dL(...e)))}catch(t){throw Dn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Rn(this.firestore,po(this._delegate,uL(...e)))}catch(t){throw Dn(t,"endAt()","Query.endAt()")}}isEqual(e){return iI(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=NL(this._delegate):(e==null?void 0:e.source)==="server"?t=_L(this._delegate):t=jL(this._delegate),t.then(r=>new iv(this.firestore,new sa(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=II(e),r=AI(e,i=>new iv(this.firestore,new sa(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return NI(this._delegate,t,r)}withConverter(e){return new Rn(this.firestore,e?this._delegate.withConverter(tc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class DL{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new vf(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class iv{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Rn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new vf(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new DL(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new vf(this._firestore,r))})}isEqual(e){return jI(this._delegate,e._delegate)}}class Yd extends Rn{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Cr(this.firestore,e):null}doc(e){try{return e===void 0?new Cr(this.firestore,T0(this._delegate)):new Cr(this.firestore,T0(this._delegate,e))}catch(t){throw Dn(t,"doc()","CollectionReference.doc()")}}add(e){return SL(this._delegate,e).then(t=>new Cr(this.firestore,t))}isEqual(e){return aI(this._delegate,e._delegate)}withConverter(e){return new Yd(this.firestore,e?this._delegate.withConverter(tc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Pl(s){return Rt(s,es)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gw{constructor(...e){this._delegate=new Zl(...e)}static documentId(){return new Gw(us.keyField().canonicalString())}isEqual(e){return e=Ge(e),e instanceof Zl?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{static serverTimestamp(){const e=ZM();return e._methodName="FieldValue.serverTimestamp",new Rl(e)}static delete(){const e=JM();return e._methodName="FieldValue.delete",new Rl(e)}static arrayUnion(...e){const t=eL(...e);return t._methodName="FieldValue.arrayUnion",new Rl(t)}static arrayRemove(...e){const t=tL(...e);return t._methodName="FieldValue.arrayRemove",new Rl(t)}static increment(e){const t=sL(e);return t._methodName="FieldValue.increment",new Rl(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OL={Firestore:TI,GeoPoint:ea,Timestamp:Vt,Blob:_I,Transaction:SI,WriteBatch:EI,DocumentReference:Cr,DocumentSnapshot:yf,Query:Rn,QueryDocumentSnapshot:vf,QuerySnapshot:iv,CollectionReference:Yd,FieldPath:Gw,FieldValue:Rl,setLogLevel:RL,CACHE_SIZE_UNLIMITED:UM};function PL(s,e){s.INTERNAL.registerComponent(new sn("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps({...OL}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ML(s){PL(s,(e,t)=>new TI(e,t,new CL)),s.registerVersion(IL,AL)}ML(Mt);const kI="@firebase/installations",Ww="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI=1e4,RI=`w:${Ww}`,DI="FIS_v2",LL="https://firebaseinstallations.googleapis.com/v1",VL=3600*1e3,UL="installations",FL="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BL={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},sc=new Ga(UL,FL,BL);function OI(s){return s instanceof fn&&s.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PI({projectId:s}){return`${LL}/projects/${s}/installations`}function MI(s){return{token:s.token,requestStatus:2,expiresIn:$L(s.expiresIn),creationTime:Date.now()}}async function LI(s,e){const r=(await e.json()).error;return sc.create("request-failed",{requestName:s,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function VI({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function zL(s,{refreshToken:e}){const t=VI(s);return t.append("Authorization",qL(e)),t}async function UI(s){const e=await s();return e.status>=500&&e.status<600?s():e}function $L(s){return Number(s.replace("s","000"))}function qL(s){return`${DI} ${s}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HL({appConfig:s,heartbeatServiceProvider:e},{fid:t}){const r=PI(s),i=VI(s),l=e.getImmediate({optional:!0});if(l){const m=await l.getHeartbeatsHeader();m&&i.append("x-firebase-client",m)}const d={fid:t,authVersion:DI,appId:s.appId,sdkVersion:RI},h={method:"POST",headers:i,body:JSON.stringify(d)},f=await UI(()=>fetch(r,h));if(f.ok){const m=await f.json();return{fid:m.fid||t,registrationStatus:2,refreshToken:m.refreshToken,authToken:MI(m.authToken)}}else throw await LI("Create Installation",f)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FI(s){return new Promise(e=>{setTimeout(e,s)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GL(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WL=/^[cdef][\w-]{21}$/,ov="";function KL(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const t=QL(s);return WL.test(t)?t:ov}catch{return ov}}function QL(s){return GL(s).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xp(s){return`${s.appName}!${s.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI=new Map;function zI(s,e){const t=xp(s);$I(t,e),YL(t,e)}function $I(s,e){const t=BI.get(s);if(t)for(const r of t)r(e)}function YL(s,e){const t=XL();t&&t.postMessage({key:s,fid:e}),JL()}let Ml=null;function XL(){return!Ml&&"BroadcastChannel"in self&&(Ml=new BroadcastChannel("[Firebase] FID Change"),Ml.onmessage=s=>{$I(s.data.key,s.data.fid)}),Ml}function JL(){BI.size===0&&Ml&&(Ml.close(),Ml=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZL="firebase-installations-database",e9=1,nc="firebase-installations-store";let Zb=null;function Kw(){return Zb||(Zb=su(ZL,e9,{upgrade:(s,e)=>{switch(e){case 0:s.createObjectStore(nc)}}})),Zb}async function E0(s,e){const t=xp(s),i=(await Kw()).transaction(nc,"readwrite"),l=i.objectStore(nc),d=await l.get(t);return await l.put(e,t),await i.done,(!d||d.fid!==e.fid)&&zI(s,e.fid),e}async function qI(s){const e=xp(s),r=(await Kw()).transaction(nc,"readwrite");await r.objectStore(nc).delete(e),await r.done}async function bp(s,e){const t=xp(s),i=(await Kw()).transaction(nc,"readwrite"),l=i.objectStore(nc),d=await l.get(t),h=e(d);return h===void 0?await l.delete(t):await l.put(h,t),await i.done,h&&(!d||d.fid!==h.fid)&&zI(s,h.fid),h}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qw(s){let e;const t=await bp(s.appConfig,r=>{const i=t9(r),l=s9(s,i);return e=l.registrationPromise,l.installationEntry});return t.fid===ov?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function t9(s){const e=s||{fid:KL(),registrationStatus:0};return HI(e)}function s9(s,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(sc.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=n9(s,t);return{installationEntry:t,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:r9(s)}:{installationEntry:e}}async function n9(s,e){try{const t=await HL(s,e);return E0(s.appConfig,t)}catch(t){throw OI(t)&&t.customData.serverCode===409?await qI(s.appConfig):await E0(s.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function r9(s){let e=await eT(s.appConfig);for(;e.registrationStatus===1;)await FI(100),e=await eT(s.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:r}=await Qw(s);return r||t}return e}function eT(s){return bp(s,e=>{if(!e)throw sc.create("installation-not-found");return HI(e)})}function HI(s){return a9(s)?{fid:s.fid,registrationStatus:0}:s}function a9(s){return s.registrationStatus===1&&s.registrationTime+CI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i9({appConfig:s,heartbeatServiceProvider:e},t){const r=o9(s,t),i=zL(s,t),l=e.getImmediate({optional:!0});if(l){const m=await l.getHeartbeatsHeader();m&&i.append("x-firebase-client",m)}const d={installation:{sdkVersion:RI,appId:s.appId}},h={method:"POST",headers:i,body:JSON.stringify(d)},f=await UI(()=>fetch(r,h));if(f.ok){const m=await f.json();return MI(m)}else throw await LI("Generate Auth Token",f)}function o9(s,{fid:e}){return`${PI(s)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yw(s,e=!1){let t;const r=await bp(s.appConfig,l=>{if(!GI(l))throw sc.create("not-registered");const d=l.authToken;if(!e&&d9(d))return l;if(d.requestStatus===1)return t=l9(s,e),l;{if(!navigator.onLine)throw sc.create("app-offline");const h=h9(l);return t=c9(s,h),h}});return t?await t:r.authToken}async function l9(s,e){let t=await tT(s.appConfig);for(;t.authToken.requestStatus===1;)await FI(100),t=await tT(s.appConfig);const r=t.authToken;return r.requestStatus===0?Yw(s,e):r}function tT(s){return bp(s,e=>{if(!GI(e))throw sc.create("not-registered");const t=e.authToken;return f9(t)?{...e,authToken:{requestStatus:0}}:e})}async function c9(s,e){try{const t=await i9(s,e),r={...e,authToken:t};return await E0(s.appConfig,r),t}catch(t){if(OI(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await qI(s.appConfig);else{const r={...e,authToken:{requestStatus:0}};await E0(s.appConfig,r)}throw t}}function GI(s){return s!==void 0&&s.registrationStatus===2}function d9(s){return s.requestStatus===2&&!u9(s)}function u9(s){const e=Date.now();return e<s.creationTime||s.creationTime+s.expiresIn<e+VL}function h9(s){const e={requestStatus:1,requestTime:Date.now()};return{...s,authToken:e}}function f9(s){return s.requestStatus===1&&s.requestTime+CI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m9(s){const e=s,{installationEntry:t,registrationPromise:r}=await Qw(e);return r?r.catch(console.error):Yw(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g9(s,e=!1){const t=s;return await p9(t),(await Yw(t,e)).token}async function p9(s){const{registrationPromise:e}=await Qw(s);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x9(s){if(!s||!s.options)throw ey("App Configuration");if(!s.name)throw ey("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!s.options[t])throw ey(t);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function ey(s){return sc.create("missing-app-config-values",{valueName:s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI="installations",b9="installations-internal",y9=s=>{const e=s.getProvider("app").getImmediate(),t=x9(e),r=H0(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},v9=s=>{const e=s.getProvider("app").getImmediate(),t=H0(e,WI).getImmediate();return{getId:()=>m9(t),getToken:i=>g9(t,i)}};function w9(){Zn(new sn(WI,y9,"PUBLIC")),Zn(new sn(b9,v9,"PRIVATE"))}w9();mn(kI,Ww);mn(kI,Ww,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j9="/firebase-messaging-sw.js",N9="/firebase-cloud-messaging-push-scope",KI="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",_9="https://fcmregistrations.googleapis.com/v1",QI="google.c.a.c_id",T9="google.c.a.c_l",S9="google.c.a.ts",E9="google.c.a.e",sT=1e4;var nT;(function(s){s[s.DATA_MESSAGE=1]="DATA_MESSAGE",s[s.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(nT||(nT={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var wf;(function(s){s.PUSH_RECEIVED="push-received",s.NOTIFICATION_CLICKED="notification-clicked"})(wf||(wf={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(s){const e=new Uint8Array(s);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function I9(s){const e="=".repeat((4-s.length%4)%4),t=(s+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),i=new Uint8Array(r.length);for(let l=0;l<r.length;++l)i[l]=r.charCodeAt(l);return i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ty="fcm_token_details_db",A9=5,rT="fcm_token_object_Store";async function k9(s){if("databases"in indexedDB&&!(await indexedDB.databases()).map(l=>l.name).includes(ty))return null;let e=null;return(await su(ty,A9,{upgrade:async(r,i,l,d)=>{if(i<2||!r.objectStoreNames.contains(rT))return;const h=d.objectStore(rT),f=await h.index("fcmSenderId").get(s);if(await h.clear(),!!f){if(i===2){const m=f;if(!m.auth||!m.p256dh||!m.endpoint)return;e={token:m.fcmToken,createTime:m.createTime??Date.now(),subscriptionOptions:{auth:m.auth,p256dh:m.p256dh,endpoint:m.endpoint,swScope:m.swScope,vapidKey:typeof m.vapidKey=="string"?m.vapidKey:hi(m.vapidKey)}}}else if(i===3){const m=f;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:hi(m.auth),p256dh:hi(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:hi(m.vapidKey)}}}else if(i===4){const m=f;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:hi(m.auth),p256dh:hi(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:hi(m.vapidKey)}}}}}})).close(),await vd(ty),await vd("fcm_vapid_details_db"),await vd("undefined"),C9(e)?e:null}function C9(s){if(!s||!s.subscriptionOptions)return!1;const{subscriptionOptions:e}=s;return typeof s.createTime=="number"&&s.createTime>0&&typeof s.token=="string"&&s.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R9="firebase-messaging-database",D9=1,rc="firebase-messaging-store";let sy=null;function Xw(){return sy||(sy=su(R9,D9,{upgrade:(s,e)=>{switch(e){case 0:s.createObjectStore(rc)}}})),sy}async function YI(s){const e=Zw(s),r=await(await Xw()).transaction(rc).objectStore(rc).get(e);if(r)return r;{const i=await k9(s.appConfig.senderId);if(i)return await Jw(s,i),i}}async function Jw(s,e){const t=Zw(s),i=(await Xw()).transaction(rc,"readwrite");return await i.objectStore(rc).put(e,t),await i.done,e}async function O9(s){const e=Zw(s),r=(await Xw()).transaction(rc,"readwrite");await r.objectStore(rc).delete(e),await r.done}function Zw({appConfig:s}){return s.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P9={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Mn=new Ga("messaging","Messaging",P9);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M9(s,e){const t=await t1(s),r=JI(e),i={method:"POST",headers:t,body:JSON.stringify(r)};let l;try{l=await(await fetch(e1(s.appConfig),i)).json()}catch(d){throw Mn.create("token-subscribe-failed",{errorInfo:d==null?void 0:d.toString()})}if(l.error){const d=l.error.message;throw Mn.create("token-subscribe-failed",{errorInfo:d})}if(!l.token)throw Mn.create("token-subscribe-no-token");return l.token}async function L9(s,e){const t=await t1(s),r=JI(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(r)};let l;try{l=await(await fetch(`${e1(s.appConfig)}/${e.token}`,i)).json()}catch(d){throw Mn.create("token-update-failed",{errorInfo:d==null?void 0:d.toString()})}if(l.error){const d=l.error.message;throw Mn.create("token-update-failed",{errorInfo:d})}if(!l.token)throw Mn.create("token-update-no-token");return l.token}async function XI(s,e){const r={method:"DELETE",headers:await t1(s)};try{const l=await(await fetch(`${e1(s.appConfig)}/${e}`,r)).json();if(l.error){const d=l.error.message;throw Mn.create("token-unsubscribe-failed",{errorInfo:d})}}catch(i){throw Mn.create("token-unsubscribe-failed",{errorInfo:i==null?void 0:i.toString()})}}function e1({projectId:s}){return`${_9}/projects/${s}/registrations`}async function t1({appConfig:s,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function JI({p256dh:s,auth:e,endpoint:t,vapidKey:r}){const i={web:{endpoint:t,auth:e,p256dh:s}};return r!==KI&&(i.web.applicationPubKey=r),i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V9=10080*60*1e3;async function U9(s){const e=await z9(s.swRegistration,s.vapidKey),t={vapidKey:s.vapidKey,swScope:s.swRegistration.scope,endpoint:e.endpoint,auth:hi(e.getKey("auth")),p256dh:hi(e.getKey("p256dh"))},r=await YI(s.firebaseDependencies);if(r){if($9(r.subscriptionOptions,t))return Date.now()>=r.createTime+V9?B9(s,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{await XI(s.firebaseDependencies,r.token)}catch(i){console.warn(i)}return aT(s.firebaseDependencies,t)}else return aT(s.firebaseDependencies,t)}async function F9(s){const e=await YI(s.firebaseDependencies);e&&(await XI(s.firebaseDependencies,e.token),await O9(s.firebaseDependencies));const t=await s.swRegistration.pushManager.getSubscription();return t?t.unsubscribe():!0}async function B9(s,e){try{const t=await L9(s.firebaseDependencies,e),r={...e,token:t,createTime:Date.now()};return await Jw(s.firebaseDependencies,r),t}catch(t){throw t}}async function aT(s,e){const r={token:await M9(s,e),createTime:Date.now(),subscriptionOptions:e};return await Jw(s,r),r.token}async function z9(s,e){const t=await s.pushManager.getSubscription();return t||s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:I9(e)})}function $9(s,e){const t=e.vapidKey===s.vapidKey,r=e.endpoint===s.endpoint,i=e.auth===s.auth,l=e.p256dh===s.p256dh;return t&&r&&i&&l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iT(s){const e={from:s.from,collapseKey:s.collapse_key,messageId:s.fcmMessageId};return q9(e,s),H9(e,s),G9(e,s),e}function q9(s,e){if(!e.notification)return;s.notification={};const t=e.notification.title;t&&(s.notification.title=t);const r=e.notification.body;r&&(s.notification.body=r);const i=e.notification.image;i&&(s.notification.image=i);const l=e.notification.icon;l&&(s.notification.icon=l)}function H9(s,e){e.data&&(s.data=e.data)}function G9(s,e){var i,l,d,h;if(!e.fcmOptions&&!((i=e.notification)!=null&&i.click_action))return;s.fcmOptions={};const t=((l=e.fcmOptions)==null?void 0:l.link)??((d=e.notification)==null?void 0:d.click_action);t&&(s.fcmOptions.link=t);const r=(h=e.fcmOptions)==null?void 0:h.analytics_label;r&&(s.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W9(s){return typeof s=="object"&&!!s&&QI in s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K9(s){if(!s||!s.options)throw ny("App Configuration Object");if(!s.name)throw ny("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=s;for(const r of e)if(!t[r])throw ny(r);return{appName:s.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function ny(s){return Mn.create("missing-app-config-values",{valueName:s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Q9=class{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=K9(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZI(s){try{s.swRegistration=await navigator.serviceWorker.register(j9,{scope:N9}),s.swRegistration.update().catch(()=>{}),await Y9(s.swRegistration)}catch(e){throw Mn.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function Y9(s){return new Promise((e,t)=>{const r=setTimeout(()=>t(new Error(`Service worker not registered after ${sT} ms`)),sT),i=s.installing||s.waiting;s.active?(clearTimeout(r),e()):i?i.onstatechange=l=>{var d;((d=l.target)==null?void 0:d.state)==="activated"&&(i.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),t(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X9(s,e){if(!e&&!s.swRegistration&&await ZI(s),!(!e&&s.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw Mn.create("invalid-sw-registration");s.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J9(s,e){e?s.vapidKey=e:s.vapidKey||(s.vapidKey=KI)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eA(s,e){if(!navigator)throw Mn.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw Mn.create("permission-blocked");return await J9(s,e==null?void 0:e.vapidKey),await X9(s,e==null?void 0:e.serviceWorkerRegistration),U9(s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z9(s,e,t){const r=eV(e);(await s.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:t[QI],message_name:t[T9],message_time:t[S9],message_device_time:Math.floor(Date.now()/1e3)})}function eV(s){switch(s){case wf.NOTIFICATION_CLICKED:return"notification_open";case wf.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tV(s,e){const t=e.data;if(!t.isFirebaseMessaging)return;s.onMessageHandler&&t.messageType===wf.PUSH_RECEIVED&&(typeof s.onMessageHandler=="function"?s.onMessageHandler(iT(t)):s.onMessageHandler.next(iT(t)));const r=t.data;W9(r)&&r[E9]==="1"&&await Z9(s,t.messageType,r)}const oT="@firebase/messaging",lT="0.12.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sV=s=>{const e=new Q9(s.getProvider("app").getImmediate(),s.getProvider("installations-internal").getImmediate(),s.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>tV(e,t)),e},nV=s=>{const e=s.getProvider("messaging").getImmediate();return{getToken:r=>eA(e,r)}};function rV(){Zn(new sn("messaging",sV,"PUBLIC")),Zn(new sn("messaging-internal",nV,"PRIVATE")),mn(oT,lT),mn(oT,lT,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aV(s){if(!navigator)throw Mn.create("only-available-in-window");return s.swRegistration||await ZI(s),F9(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iV(s,e){if(!navigator)throw Mn.create("only-available-in-window");return s.onMessageHandler=e,()=>{s.onMessageHandler=null}}async function oV(s,e){return s=Ge(s),eA(s,e)}function lV(s){return s=Ge(s),aV(s)}function cV(s,e){return s=Ge(s),iV(s,e)}rV();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tA="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",dV="https://fcmregistrations.googleapis.com/v1",sA="FCM_MSG",uV="google.c.a.c_id",hV=3,fV=1;var I0;(function(s){s[s.DATA_MESSAGE=1]="DATA_MESSAGE",s[s.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(I0||(I0={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var A0;(function(s){s.PUSH_RECEIVED="push-received",s.NOTIFICATION_CLICKED="notification-clicked"})(A0||(A0={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fi(s){const e=new Uint8Array(s);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function mV(s){const e="=".repeat((4-s.length%4)%4),t=(s+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),i=new Uint8Array(r.length);for(let l=0;l<r.length;++l)i[l]=r.charCodeAt(l);return i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ry="fcm_token_details_db",gV=5,cT="fcm_token_object_Store";async function pV(s){if("databases"in indexedDB&&!(await indexedDB.databases()).map(l=>l.name).includes(ry))return null;let e=null;return(await su(ry,gV,{upgrade:async(r,i,l,d)=>{if(i<2||!r.objectStoreNames.contains(cT))return;const h=d.objectStore(cT),f=await h.index("fcmSenderId").get(s);if(await h.clear(),!!f){if(i===2){const m=f;if(!m.auth||!m.p256dh||!m.endpoint)return;e={token:m.fcmToken,createTime:m.createTime??Date.now(),subscriptionOptions:{auth:m.auth,p256dh:m.p256dh,endpoint:m.endpoint,swScope:m.swScope,vapidKey:typeof m.vapidKey=="string"?m.vapidKey:fi(m.vapidKey)}}}else if(i===3){const m=f;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:fi(m.auth),p256dh:fi(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:fi(m.vapidKey)}}}else if(i===4){const m=f;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:fi(m.auth),p256dh:fi(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:fi(m.vapidKey)}}}}}})).close(),await vd(ry),await vd("fcm_vapid_details_db"),await vd("undefined"),xV(e)?e:null}function xV(s){if(!s||!s.subscriptionOptions)return!1;const{subscriptionOptions:e}=s;return typeof s.createTime=="number"&&s.createTime>0&&typeof s.token=="string"&&s.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bV="firebase-messaging-database",yV=1,ac="firebase-messaging-store";let ay=null;function s1(){return ay||(ay=su(bV,yV,{upgrade:(s,e)=>{switch(e){case 0:s.createObjectStore(ac)}}})),ay}async function n1(s){const e=a1(s),r=await(await s1()).transaction(ac).objectStore(ac).get(e);if(r)return r;{const i=await pV(s.appConfig.senderId);if(i)return await r1(s,i),i}}async function r1(s,e){const t=a1(s),i=(await s1()).transaction(ac,"readwrite");return await i.objectStore(ac).put(e,t),await i.done,e}async function vV(s){const e=a1(s),r=(await s1()).transaction(ac,"readwrite");await r.objectStore(ac).delete(e),await r.done}function a1({appConfig:s}){return s.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wV={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Ua=new Ga("messaging","Messaging",wV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jV(s,e){const t=await o1(s),r=rA(e),i={method:"POST",headers:t,body:JSON.stringify(r)};let l;try{l=await(await fetch(i1(s.appConfig),i)).json()}catch(d){throw Ua.create("token-subscribe-failed",{errorInfo:d==null?void 0:d.toString()})}if(l.error){const d=l.error.message;throw Ua.create("token-subscribe-failed",{errorInfo:d})}if(!l.token)throw Ua.create("token-subscribe-no-token");return l.token}async function NV(s,e){const t=await o1(s),r=rA(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(r)};let l;try{l=await(await fetch(`${i1(s.appConfig)}/${e.token}`,i)).json()}catch(d){throw Ua.create("token-update-failed",{errorInfo:d==null?void 0:d.toString()})}if(l.error){const d=l.error.message;throw Ua.create("token-update-failed",{errorInfo:d})}if(!l.token)throw Ua.create("token-update-no-token");return l.token}async function nA(s,e){const r={method:"DELETE",headers:await o1(s)};try{const l=await(await fetch(`${i1(s.appConfig)}/${e}`,r)).json();if(l.error){const d=l.error.message;throw Ua.create("token-unsubscribe-failed",{errorInfo:d})}}catch(i){throw Ua.create("token-unsubscribe-failed",{errorInfo:i==null?void 0:i.toString()})}}function i1({projectId:s}){return`${dV}/projects/${s}/registrations`}async function o1({appConfig:s,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function rA({p256dh:s,auth:e,endpoint:t,vapidKey:r}){const i={web:{endpoint:t,auth:e,p256dh:s}};return r!==tA&&(i.web.applicationPubKey=r),i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _V=10080*60*1e3;async function TV(s){const e=await EV(s.swRegistration,s.vapidKey),t={vapidKey:s.vapidKey,swScope:s.swRegistration.scope,endpoint:e.endpoint,auth:fi(e.getKey("auth")),p256dh:fi(e.getKey("p256dh"))},r=await n1(s.firebaseDependencies);if(r){if(IV(r.subscriptionOptions,t))return Date.now()>=r.createTime+_V?SV(s,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{await nA(s.firebaseDependencies,r.token)}catch(i){console.warn(i)}return uT(s.firebaseDependencies,t)}else return uT(s.firebaseDependencies,t)}async function dT(s){const e=await n1(s.firebaseDependencies);e&&(await nA(s.firebaseDependencies,e.token),await vV(s.firebaseDependencies));const t=await s.swRegistration.pushManager.getSubscription();return t?t.unsubscribe():!0}async function SV(s,e){try{const t=await NV(s.firebaseDependencies,e),r={...e,token:t,createTime:Date.now()};return await r1(s.firebaseDependencies,r),t}catch(t){throw t}}async function uT(s,e){const r={token:await jV(s,e),createTime:Date.now(),subscriptionOptions:e};return await r1(s,r),r.token}async function EV(s,e){const t=await s.pushManager.getSubscription();return t||s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:mV(e)})}function IV(s,e){const t=e.vapidKey===s.vapidKey,r=e.endpoint===s.endpoint,i=e.auth===s.auth,l=e.p256dh===s.p256dh;return t&&r&&i&&l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AV(s){const e={from:s.from,collapseKey:s.collapse_key,messageId:s.fcmMessageId};return kV(e,s),CV(e,s),RV(e,s),e}function kV(s,e){if(!e.notification)return;s.notification={};const t=e.notification.title;t&&(s.notification.title=t);const r=e.notification.body;r&&(s.notification.body=r);const i=e.notification.image;i&&(s.notification.image=i);const l=e.notification.icon;l&&(s.notification.icon=l)}function CV(s,e){e.data&&(s.data=e.data)}function RV(s,e){var i,l,d,h;if(!e.fcmOptions&&!((i=e.notification)!=null&&i.click_action))return;s.fcmOptions={};const t=((l=e.fcmOptions)==null?void 0:l.link)??((d=e.notification)==null?void 0:d.click_action);t&&(s.fcmOptions.link=t);const r=(h=e.fcmOptions)==null?void 0:h.analytics_label;r&&(s.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DV(s){return typeof s=="object"&&!!s&&uV in s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OV(s){return new Promise(e=>{setTimeout(e,s)})}async function PV(s,e){const t=MV(e,await s.firebaseDependencies.installations.getId());LV(s,t,e.productId)}function MV(s,e){var r,i;const t={};return s.from&&(t.project_number=s.from),s.fcmMessageId&&(t.message_id=s.fcmMessageId),t.instance_id=e,s.notification?t.message_type=I0.DISPLAY_NOTIFICATION.toString():t.message_type=I0.DATA_MESSAGE.toString(),t.sdk_platform=hV.toString(),t.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),s.collapse_key&&(t.collapse_key=s.collapse_key),t.event=fV.toString(),(r=s.fcmOptions)!=null&&r.analytics_label&&(t.analytics_label=(i=s.fcmOptions)==null?void 0:i.analytics_label),t}function LV(s,e,t){const r={};r.event_time_ms=Math.floor(Date.now()).toString(),r.source_extension_json_proto3=JSON.stringify({messaging_client_event:e}),t&&(r.compliance_data=VV(t)),s.logEvents.push(r)}function VV(s){return{privacy_context:{prequest:{origin_associated_product_id:s}}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UV(s,e){var i;const{newSubscription:t}=s;if(!t){await dT(e);return}const r=await n1(e.firebaseDependencies);await dT(e),e.vapidKey=((i=r==null?void 0:r.subscriptionOptions)==null?void 0:i.vapidKey)??tA,await TV(e)}async function FV(s,e){const t=$V(s);if(!t)return;e.deliveryMetricsExportedToBigQueryEnabled&&await PV(e,t);const r=await aA();if(HV(r))return GV(r,t);if(t.notification&&await WV(zV(t)),!!e&&e.onBackgroundMessageHandler){const i=AV(t);typeof e.onBackgroundMessageHandler=="function"?await e.onBackgroundMessageHandler(i):e.onBackgroundMessageHandler.next(i)}}async function BV(s){var d,h;const e=(h=(d=s.notification)==null?void 0:d.data)==null?void 0:h[sA];if(e){if(s.action)return}else return;s.stopImmediatePropagation(),s.notification.close();const t=KV(e);if(!t)return;const r=new URL(t,self.location.href),i=new URL(self.location.origin);if(r.host!==i.host)return;let l=await qV(r);if(l?l=await l.focus():(l=await self.clients.openWindow(t),await OV(3e3)),!!l)return e.messageType=A0.NOTIFICATION_CLICKED,e.isFirebaseMessaging=!0,l.postMessage(e)}function zV(s){const e={...s.notification};return e.data={[sA]:s},e}function $V({data:s}){if(!s)return null;try{return s.json()}catch{return null}}async function qV(s){const e=await aA();for(const t of e){const r=new URL(t.url,self.location.href);if(s.host===r.host)return t}return null}function HV(s){return s.some(e=>e.visibilityState==="visible"&&!e.url.startsWith("chrome-extension://"))}function GV(s,e){e.isFirebaseMessaging=!0,e.messageType=A0.PUSH_RECEIVED;for(const t of s)t.postMessage(e)}function aA(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function WV(s){const{actions:e}=s,{maxActions:t}=Notification;return e&&t&&e.length>t&&console.warn(`This browser only supports ${t} actions. The remaining actions will not be displayed.`),self.registration.showNotification(s.title??"",s)}function KV(s){var t,r;const e=((t=s.fcmOptions)==null?void 0:t.link)??((r=s.notification)==null?void 0:r.click_action);return e||(DV(s.data)?self.location.origin:null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QV(s){if(!s||!s.options)throw iy("App Configuration Object");if(!s.name)throw iy("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=s;for(const r of e)if(!t[r])throw iy(r);return{appName:s.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function iy(s){return Ua.create("missing-app-config-values",{valueName:s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YV{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=QV(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XV=s=>{const e=new YV(s.getProvider("app").getImmediate(),s.getProvider("installations-internal").getImmediate(),s.getProvider("analytics-internal"));return self.addEventListener("push",t=>{t.waitUntil(FV(t,e))}),self.addEventListener("pushsubscriptionchange",t=>{t.waitUntil(UV(t,e))}),self.addEventListener("notificationclick",t=>{t.waitUntil(BV(t))}),e};function JV(){Zn(new sn("messaging-sw",XV,"PUBLIC"))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZV(s,e){if(self.document!==void 0)throw Ua.create("only-available-in-sw");return s.onBackgroundMessageHandler=e,()=>{s.onBackgroundMessageHandler=null}}function e8(s,e){return s=Ge(s),ZV(s,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */JV();const t8="@firebase/messaging-compat",s8="0.2.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n8(){return self&&"ServiceWorkerGlobalScope"in self?a8():r8()}function r8(){return typeof window<"u"&&ql()&&kR()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function a8(){return ql()&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}class hT{constructor(e,t){this.app=e,this._delegate=t,this.app=e,this._delegate=t}async getToken(e){return oV(this._delegate,e)}async deleteToken(){return lV(this._delegate)}onMessage(e){return cV(this._delegate,e)}onBackgroundMessage(e){return e8(this._delegate,e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i8=s=>self&&"ServiceWorkerGlobalScope"in self?new hT(s.getProvider("app-compat").getImmediate(),s.getProvider("messaging-sw").getImmediate()):new hT(s.getProvider("app-compat").getImmediate(),s.getProvider("messaging").getImmediate()),o8={isSupported:n8};function l8(){Mt.INTERNAL.registerComponent(new sn("messaging-compat",i8,"PUBLIC").setServiceProps(o8))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */l8();Mt.registerVersion(t8,s8);const jh={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},od={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c8(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function iA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const d8=c8,u8=iA,oA=new Ga("auth","Firebase",iA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k0=new q0("@firebase/auth");function h8(s,...e){k0.logLevel<=wt.WARN&&k0.warn(`Auth (${Ei}): ${s}`,...e)}function t0(s,...e){k0.logLevel<=wt.ERROR&&k0.error(`Auth (${Ei}): ${s}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yn(s,...e){throw c1(s,...e)}function Ws(s,...e){return c1(s,...e)}function l1(s,e,t){const r={...u8(),[e]:t};return new Ga("auth","Firebase",r).create(e,{appName:s.name})}function tn(s){return l1(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function uu(s,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&yn(s,"argument-error"),l1(s,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function c1(s,...e){if(typeof s!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=s.name),s._errorFactory.create(t,...r)}return oA.create(s,...e)}function Oe(s,e,...t){if(!s)throw c1(e,...t)}function Ma(s){const e="INTERNAL ASSERTION FAILED: "+s;throw t0(e),new Error(e)}function aa(s,e){s||Ma(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jf(){var s;return typeof self<"u"&&((s=self.location)==null?void 0:s.href)||""}function d1(){return fT()==="http:"||fT()==="https:"}function fT(){var s;return typeof self<"u"&&((s=self.location)==null?void 0:s.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f8(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(d1()||wS()||"connection"in navigator)?navigator.onLine:!0}function m8(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf{constructor(e,t){this.shortDelay=e,this.longDelay=t,aa(t>e,"Short delay should be less than long delay!"),this.isMobile=SR()||Dv()}get(){return f8()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u1(s,e){aa(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ma("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ma("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ma("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g8={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p8=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],x8=new qf(3e4,6e4);function ws(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function js(s,e,t,r,i={}){return cA(s,i,async()=>{let l={},d={};r&&(e==="GET"?d=r:l={body:JSON.stringify(r)});const h=tu({key:s.config.apiKey,...d}).slice(1),f=await s._getAdditionalHeaders();f["Content-Type"]="application/json",s.languageCode&&(f["X-Firebase-Locale"]=s.languageCode);const m={method:e,headers:f,...l};return IR()||(m.referrerPolicy="no-referrer"),s.emulatorConfig&&Fo(s.emulatorConfig.host)&&(m.credentials="include"),lA.fetch()(await dA(s,s.config.apiHost,t,h),m)})}async function cA(s,e,t){s._canInitEmulator=!1;const r={...g8,...e};try{const i=new y8(s),l=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const d=await l.json();if("needConfirmation"in d)throw Ph(s,"account-exists-with-different-credential",d);if(l.ok&&!("errorMessage"in d))return d;{const h=l.ok?d.errorMessage:d.error.message,[f,m]=h.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ph(s,"credential-already-in-use",d);if(f==="EMAIL_EXISTS")throw Ph(s,"email-already-in-use",d);if(f==="USER_DISABLED")throw Ph(s,"user-disabled",d);const b=r[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw l1(s,b,m);yn(s,b)}}catch(i){if(i instanceof fn)throw i;yn(s,"network-request-failed",{message:String(i)})}}async function Ri(s,e,t,r,i={}){const l=await js(s,e,t,r,i);return"mfaPendingCredential"in l&&yn(s,"multi-factor-auth-required",{_serverResponse:l}),l}async function dA(s,e,t,r){const i=`${e}${t}?${r}`,l=s,d=l.config.emulator?u1(s.config,i):`${s.config.apiScheme}://${i}`;return p8.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(d).toString():d}function b8(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class y8{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ws(this.auth,"network-request-failed")),x8.get())})}}function Ph(s,e,t){const r={appName:s.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=Ws(s,e,r);return i.customData._tokenResponse=t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mT(s){return s!==void 0&&s.getResponse!==void 0}function gT(s){return s!==void 0&&s.enterprise!==void 0}class uA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return b8(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v8(s){return(await js(s,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function hA(s,e){return js(s,"GET","/v2/recaptchaConfig",ws(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w8(s,e){return js(s,"POST","/v1/accounts:delete",e)}async function j8(s,e){return js(s,"POST","/v1/accounts:update",e)}async function C0(s,e){return js(s,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kh(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function N8(s,e=!1){const t=Ge(s),r=await t.getIdToken(e),i=yp(r);Oe(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const l=typeof i.firebase=="object"?i.firebase:void 0,d=l==null?void 0:l.sign_in_provider;return{claims:i,token:r,authTime:Kh(oy(i.auth_time)),issuedAtTime:Kh(oy(i.iat)),expirationTime:Kh(oy(i.exp)),signInProvider:d||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function oy(s){return Number(s)*1e3}function yp(s){const[e,t,r]=s.split(".");if(e===void 0||t===void 0||r===void 0)return t0("JWT malformed, contained fewer than 3 sections"),null;try{const i=Ev(t);return i?JSON.parse(i):(t0("Failed to decode base64 JWT payload"),null)}catch(i){return t0("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function pT(s){const e=yp(s);return Oe(e,"internal-error"),Oe(typeof e.exp<"u","internal-error"),Oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ti(s,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof fn&&_8(r)&&s.auth.currentUser===s&&await s.auth.signOut(),r}}function _8({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T8{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Kh(this.lastLoginAt),this.creationTime=Kh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nf(s){var y;const e=s.auth,t=await s.getIdToken(),r=await Ti(s,C0(e,{idToken:t}));Oe(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];s._notifyReloadListener(i);const l=(y=i.providerUserInfo)!=null&&y.length?fA(i.providerUserInfo):[],d=E8(s.providerData,l),h=s.isAnonymous,f=!(s.email&&i.passwordHash)&&!(d!=null&&d.length),m=h?f:!1,b={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:d,metadata:new lv(i.createdAt,i.lastLoginAt),isAnonymous:m};Object.assign(s,b)}async function S8(s){const e=Ge(s);await Nf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function E8(s,e){return[...s.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function fA(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I8(s,e){const t=await cA(s,{},async()=>{const r=tu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:l}=s.config,d=await dA(s,i,"/v1/token",`key=${l}`),h=await s._getAdditionalHeaders();h["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:h,body:r};return s.emulatorConfig&&Fo(s.emulatorConfig.host)&&(f.credentials="include"),lA.fetch()(d,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function A8(s,e){return js(s,"POST","/v2/accounts:revokeToken",ws(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Oe(e.idToken,"internal-error"),Oe(typeof e.idToken<"u","internal-error"),Oe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):pT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Oe(e.length!==0,"internal-error");const t=pT(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:l}=await I8(e,t);this.updateTokensAndExpiration(r,i,Number(l))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:l}=t,d=new _d;return r&&(Oe(typeof r=="string","internal-error",{appName:e}),d.refreshToken=r),i&&(Oe(typeof i=="string","internal-error",{appName:e}),d.accessToken=i),l&&(Oe(typeof l=="number","internal-error",{appName:e}),d.expirationTime=l),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new _d,this.toJSON())}_performRefresh(){return Ma("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xo(s,e){Oe(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class Zr{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new T8(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new lv(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Ti(this,this.stsTokenManager.getToken(this.auth,e));return Oe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return N8(this,e)}reload(){return S8(this)}_assign(e){this!==e&&(Oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Zr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Nf(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(as(this.auth.app))return Promise.reject(tn(this.auth));const e=await this.getIdToken();return await Ti(this,w8(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,l=t.phoneNumber??void 0,d=t.photoURL??void 0,h=t.tenantId??void 0,f=t._redirectEventId??void 0,m=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:y,emailVerified:v,isAnonymous:N,providerData:E,stsTokenManager:I}=t;Oe(y&&I,e,"internal-error");const T=_d.fromJSON(this.name,I);Oe(typeof y=="string",e,"internal-error"),xo(r,e.name),xo(i,e.name),Oe(typeof v=="boolean",e,"internal-error"),Oe(typeof N=="boolean",e,"internal-error"),xo(l,e.name),xo(d,e.name),xo(h,e.name),xo(f,e.name),xo(m,e.name),xo(b,e.name);const L=new Zr({uid:y,auth:e,email:i,emailVerified:v,displayName:r,isAnonymous:N,photoURL:d,phoneNumber:l,tenantId:h,stsTokenManager:T,createdAt:m,lastLoginAt:b});return E&&Array.isArray(E)&&(L.providerData=E.map($=>({...$}))),f&&(L._redirectEventId=f),L}static async _fromIdTokenResponse(e,t,r=!1){const i=new _d;i.updateFromServerResponse(t);const l=new Zr({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Nf(l),l}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Oe(i.localId!==void 0,"internal-error");const l=i.providerUserInfo!==void 0?fA(i.providerUserInfo):[],d=!(i.email&&i.passwordHash)&&!(l!=null&&l.length),h=new _d;h.updateFromIdToken(r);const f=new Zr({uid:i.localId,auth:e,stsTokenManager:h,isAnonymous:d}),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new lv(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(l!=null&&l.length)};return Object.assign(f,m),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xT=new Map;function hr(s){aa(s instanceof Function,"Expected a class definition");let e=xT.get(s);return e?(aa(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,xT.set(s,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}mA.type="NONE";const Xd=mA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fl(s,e,t){return`firebase:${s}:${e}:${t}`}class Td{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:l}=this.auth;this.fullUserKey=Fl(this.userKey,i.apiKey,l),this.fullPersistenceKey=Fl("persistence",i.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await C0(this.auth,{idToken:e}).catch(()=>{});return t?Zr._fromGetAccountInfoResponse(this.auth,t,e):null}return Zr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Td(hr(Xd),e,r);const i=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let l=i[0]||hr(Xd);const d=Fl(r,e.config.apiKey,e.name);let h=null;for(const m of t)try{const b=await m._get(d);if(b){let y;if(typeof b=="string"){const v=await C0(e,{idToken:b}).catch(()=>{});if(!v)break;y=await Zr._fromGetAccountInfoResponse(e,v,b)}else y=Zr._fromJSON(e,b);m!==l&&(h=y),l=m;break}}catch{}const f=i.filter(m=>m._shouldAllowMigration);return!l._shouldAllowMigration||!f.length?new Td(l,e,r):(l=f[0],h&&await l._set(d,h.toJSON()),await Promise.all(t.map(async m=>{if(m!==l)try{await m._remove(d)}catch{}})),new Td(l,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bT(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(bA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(gA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(yA(e))return"Blackberry";if(vA(e))return"Webos";if(pA(e))return"Safari";if((e.includes("chrome/")||xA(e))&&!e.includes("edge/"))return"Chrome";if(Hf(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=s.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function gA(s=ms()){return/firefox\//i.test(s)}function pA(s=ms()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function xA(s=ms()){return/crios\//i.test(s)}function bA(s=ms()){return/iemobile/i.test(s)}function Hf(s=ms()){return/android/i.test(s)}function yA(s=ms()){return/blackberry/i.test(s)}function vA(s=ms()){return/webos/i.test(s)}function Gf(s=ms()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function k8(s=ms()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(s)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(s)}function C8(s=ms()){var e;return Gf(s)&&!!((e=window.navigator)!=null&&e.standalone)}function R8(){return jS()&&document.documentMode===10}function wA(s=ms()){return Gf(s)||Hf(s)||vA(s)||yA(s)||/windows phone/i.test(s)||bA(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jA(s,e=[]){let t;switch(s){case"Browser":t=bT(ms());break;case"Worker":t=`${bT(ms())}-${s}`;break;default:t=s}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ei}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D8{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=l=>new Promise((d,h)=>{try{const f=e(l);d(f)}catch(f){h(f)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O8(s,e={}){return js(s,"GET","/v2/passwordPolicy",ws(s,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P8=6;class M8{constructor(e){var r;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??P8,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L8{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new yT(this),this.idTokenSubscription=new yT(this),this.beforeStateQueue=new D8(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=oA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=hr(t)),this._initializationPromise=this.queue(async()=>{var r,i,l;if(!this._deleted&&(this.persistenceManager=await Td.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await C0(this,{idToken:e}),r=await Zr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(as(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(h,h))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(l=this.redirectUser)==null?void 0:l._redirectEventId,h=r==null?void 0:r._redirectEventId,f=await this.tryRedirectSignIn(e);(!d||d===h)&&(f!=null&&f.user)&&(r=f.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(d){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Nf(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=m8()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(as(this.app))return Promise.reject(tn(this));const t=e?Ge(e):null;return t&&Oe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return as(this.app)?Promise.reject(tn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return as(this.app)?Promise.reject(tn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(hr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await O8(this),t=new M8(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ga("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await A8(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&hr(e)||this._popupRedirectResolver;Oe(t,this,"argument-error"),this.redirectPersistenceManager=await Td.create(this,[hr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let d=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(Oe(h,this,"internal-error"),h.then(()=>{d||l(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,r,i);return()=>{d=!0,f()}}else{const f=e.addObserver(t);return()=>{d=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=jA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(as(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&h8(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function gs(s){return Ge(s)}class yT{constructor(e){this.auth=e,this.observer=null,this.addObserver=TS(t=>this.observer=t)}get next(){return Oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function V8(s){Wf=s}function h1(s){return Wf.loadJS(s)}function U8(){return Wf.recaptchaV2Script}function F8(){return Wf.recaptchaEnterpriseScript}function B8(){return Wf.gapiScript}function NA(s){return`__${s}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z8=500,$8=6e4,Ag=1e12;class q8{constructor(e){this.auth=e,this.counter=Ag,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new W8(e,this.auth.name,t||{})),this.counter++,r}reset(e){var r;const t=e||Ag;(r=this._widgets.get(t))==null||r.delete(),this._widgets.delete(t)}getResponse(e){var r;const t=e||Ag;return((r=this._widgets.get(t))==null?void 0:r.getResponse())||""}async execute(e){var r;const t=e||Ag;return(r=this._widgets.get(t))==null||r.execute(),""}}class H8{constructor(){this.enterprise=new G8}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class G8{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class W8{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;Oe(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=K8(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},$8)},z8))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function K8(s){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<s;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const Q8="recaptcha-enterprise",Qh="NO_RECAPTCHA";class _A{constructor(e){this.type=Q8,this.auth=gs(e)}async verify(e="verify",t=!1){async function r(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(d,h)=>{hA(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const m=new uA(f);return l.tenantId==null?l._agentRecaptchaConfig=m:l._tenantRecaptchaConfigs[l.tenantId]=m,d(m.siteKey)}}).catch(f=>{h(f)})})}function i(l,d,h){const f=window.grecaptcha;gT(f)?f.enterprise.ready(()=>{f.enterprise.execute(l,{action:e}).then(m=>{d(m)}).catch(()=>{d(Qh)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new H8().execute("siteKey",{action:"verify"}):new Promise((l,d)=>{r(this.auth).then(h=>{if(!t&&gT(window.grecaptcha))i(h,l,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let f=F8();f.length!==0&&(f+=h),h1(f).then(()=>{i(h,l,d)}).catch(m=>{d(m)})}}).catch(h=>{d(h)})})}}async function Nh(s,e,t,r=!1,i=!1){const l=new _A(s);let d;if(i)d=Qh;else try{d=await l.verify(t)}catch{d=await l.verify(t,!0)}const h={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in h){const f=h.phoneEnrollmentInfo.phoneNumber,m=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:m,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){const f=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return r?Object.assign(h,{captchaResp:d}):Object.assign(h,{captchaResponse:d}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function Eo(s,e,t,r,i){var l,d;if(i==="EMAIL_PASSWORD_PROVIDER")if((l=s._getRecaptchaConfig())!=null&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const h=await Nh(s,e,t,t==="getOobCode");return r(s,h)}else return r(s,e).catch(async h=>{if(h.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await Nh(s,e,t,t==="getOobCode");return r(s,f)}else return Promise.reject(h)});else if(i==="PHONE_PROVIDER")if((d=s._getRecaptchaConfig())!=null&&d.isProviderEnabled("PHONE_PROVIDER")){const h=await Nh(s,e,t);return r(s,h).catch(async f=>{var m;if(((m=s._getRecaptchaConfig())==null?void 0:m.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(f.code==="auth/missing-recaptcha-token"||f.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const b=await Nh(s,e,t,!1,!0);return r(s,b)}return Promise.reject(f)})}else{const h=await Nh(s,e,t,!1,!0);return r(s,h)}else return Promise.reject(i+" provider is not supported.")}async function Y8(s){const e=gs(s),t=await hA(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new uA(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new _A(e).verify()}function X8(s,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(hr);e!=null&&e.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function J8(s,e,t){const r=gs(s);Oe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(t!=null&&t.disableWarnings),l=TA(e),{host:d,port:h}=Z8(e),f=h===null?"":`:${h}`,m={url:`${l}//${d}${f}/`},b=Object.freeze({host:d,port:h,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Oe(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Oe(ko(m,r.config.emulator)&&ko(b,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=m,r.emulatorConfig=b,r.settings.appVerificationDisabledForTesting=!0,Fo(d)?(Cv(`${l}//${d}${f}`),Rv("Auth",!0)):i||e7()}function TA(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function Z8(s){const e=TA(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const l=i[1];return{host:l,port:vT(r.substr(l.length+1))}}else{const[l,d]=r.split(":");return{host:l,port:vT(d)}}}function vT(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function e7(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ma("not implemented")}_getIdTokenResponse(e){return Ma("not implemented")}_linkToIdToken(e,t){return Ma("not implemented")}_getReauthenticationResolver(e){return Ma("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SA(s,e){return js(s,"POST","/v1/accounts:resetPassword",ws(s,e))}async function t7(s,e){return js(s,"POST","/v1/accounts:update",e)}async function s7(s,e){return js(s,"POST","/v1/accounts:signUp",e)}async function n7(s,e){return js(s,"POST","/v1/accounts:update",ws(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r7(s,e){return Ri(s,"POST","/v1/accounts:signInWithPassword",ws(s,e))}async function vp(s,e){return js(s,"POST","/v1/accounts:sendOobCode",ws(s,e))}async function a7(s,e){return vp(s,e)}async function i7(s,e){return vp(s,e)}async function o7(s,e){return vp(s,e)}async function l7(s,e){return vp(s,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c7(s,e){return Ri(s,"POST","/v1/accounts:signInWithEmailLink",ws(s,e))}async function d7(s,e){return Ri(s,"POST","/v1/accounts:signInWithEmailLink",ws(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f extends hu{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new _f(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new _f(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Eo(e,t,"signInWithPassword",r7,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return c7(e,{email:this._email,oobCode:this._password});default:yn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Eo(e,r,"signUpPassword",s7,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return d7(e,{idToken:t,email:this._email,oobCode:this._password});default:yn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yi(s,e){return Ri(s,"POST","/v1/accounts:signInWithIdp",ws(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u7="http://localhost";class qa extends hu{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new qa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):yn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...l}=t;if(!r||!i)return null;const d=new qa(r,i);return d.idToken=l.idToken||void 0,d.accessToken=l.accessToken||void 0,d.secret=l.secret,d.nonce=l.nonce,d.pendingToken=l.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return yi(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,yi(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,yi(e,t)}buildRequest(){const e={requestUri:u7,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=tu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wT(s,e){return js(s,"POST","/v1/accounts:sendVerificationCode",ws(s,e))}async function h7(s,e){return Ri(s,"POST","/v1/accounts:signInWithPhoneNumber",ws(s,e))}async function f7(s,e){const t=await Ri(s,"POST","/v1/accounts:signInWithPhoneNumber",ws(s,e));if(t.temporaryProof)throw Ph(s,"account-exists-with-different-credential",t);return t}const m7={USER_NOT_FOUND:"user-not-found"};async function g7(s,e){const t={...e,operation:"REAUTH"};return Ri(s,"POST","/v1/accounts:signInWithPhoneNumber",ws(s,t),m7)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl extends hu{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Bl({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Bl({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return h7(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return f7(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return g7(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:l}=e;return!r&&!t&&!i&&!l?null:new Bl({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p7(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function x7(s){const e=xd(Ah(s)).link,t=e?xd(Ah(e)).deep_link_id:null,r=xd(Ah(s)).deep_link_id;return(r?xd(Ah(r)).link:null)||r||t||e||s}class wp{constructor(e){const t=xd(Ah(e)),r=t.apiKey??null,i=t.oobCode??null,l=p7(t.mode??null);Oe(r&&i&&l,"argument-error"),this.apiKey=r,this.operation=l,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=x7(e);try{return new wp(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(){this.providerId=Go.PROVIDER_ID}static credential(e,t){return _f._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=wp.parseLink(t);return Oe(r,"argument-error"),_f._fromEmailAndCode(e,r.code,r.tenantId)}}Go.PROVIDER_ID="password";Go.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Go.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu extends Di{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Sd extends fu{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return Oe("providerId"in t&&"signInMethod"in t,"argument-error"),qa._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return Oe(e.idToken||e.accessToken,"argument-error"),qa._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return Sd.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Sd.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:l,nonce:d,providerId:h}=e;if(!r&&!i&&!t&&!l||!h)return null;try{return new Sd(h)._credential({idToken:t,accessToken:r,nonce:d,pendingToken:l})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa extends fu{constructor(){super("facebook.com")}static credential(e){return qa._fromParams({providerId:Aa.PROVIDER_ID,signInMethod:Aa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Aa.credentialFromTaggedObject(e)}static credentialFromError(e){return Aa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Aa.credential(e.oauthAccessToken)}catch{return null}}}Aa.FACEBOOK_SIGN_IN_METHOD="facebook.com";Aa.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka extends fu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return qa._fromParams({providerId:ka.PROVIDER_ID,signInMethod:ka.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ka.credentialFromTaggedObject(e)}static credentialFromError(e){return ka.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return ka.credential(t,r)}catch{return null}}}ka.GOOGLE_SIGN_IN_METHOD="google.com";ka.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca extends fu{constructor(){super("github.com")}static credential(e){return qa._fromParams({providerId:Ca.PROVIDER_ID,signInMethod:Ca.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ca.credentialFromTaggedObject(e)}static credentialFromError(e){return Ca.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ca.credential(e.oauthAccessToken)}catch{return null}}}Ca.GITHUB_SIGN_IN_METHOD="github.com";Ca.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b7="http://localhost";class Jd extends hu{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return yi(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,yi(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,yi(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:l}=t;return!r||!i||!l||r!==i?null:new Jd(r,l)}static _create(e,t){return new Jd(e,t)}buildRequest(){return{requestUri:b7,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y7="saml.";class R0 extends Di{constructor(e){Oe(e.startsWith(y7),"argument-error"),super(e)}static credentialFromResult(e){return R0.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return R0.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Jd.fromJSON(e);return Oe(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Jd._create(r,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra extends fu{constructor(){super("twitter.com")}static credential(e,t){return qa._fromParams({providerId:Ra.PROVIDER_ID,signInMethod:Ra.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ra.credentialFromTaggedObject(e)}static credentialFromError(e){return Ra.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Ra.credential(t,r)}catch{return null}}}Ra.TWITTER_SIGN_IN_METHOD="twitter.com";Ra.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EA(s,e){return Ri(s,"POST","/v1/accounts:signUp",ws(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const l=await Zr._fromIdTokenResponse(e,r,i),d=jT(r);return new Ur({user:l,providerId:d,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=jT(r);return new Ur({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function jT(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v7(s){var i;if(as(s.app))return Promise.reject(tn(s));const e=gs(s);if(await e._initializationPromise,(i=e.currentUser)!=null&&i.isAnonymous)return new Ur({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await EA(e,{returnSecureToken:!0}),r=await Ur._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0 extends fn{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,D0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new D0(e,t,r,i)}}function IA(s,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?D0._fromErrorAndOperation(s,l,e,r):l})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AA(s){return new Set(s.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w7(s,e){const t=Ge(s);await jp(!0,t,e);const{providerUserInfo:r}=await j8(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),i=AA(r||[]);return t.providerData=t.providerData.filter(l=>i.has(l.providerId)),i.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function f1(s,e,t=!1){const r=await Ti(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Ur._forOperation(s,"link",r)}async function jp(s,e,t){await Nf(e);const r=AA(e.providerData),i=s===!1?"provider-already-linked":"no-such-provider";Oe(r.has(t)===s,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kA(s,e,t=!1){const{auth:r}=s;if(as(r.app))return Promise.reject(tn(r));const i="reauthenticate";try{const l=await Ti(s,IA(r,i,e,s),t);Oe(l.idToken,r,"internal-error");const d=yp(l.idToken);Oe(d,r,"internal-error");const{sub:h}=d;return Oe(s.uid===h,r,"user-mismatch"),Ur._forOperation(s,i,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&yn(r,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CA(s,e,t=!1){if(as(s.app))return Promise.reject(tn(s));const r="signIn",i=await IA(s,r,e),l=await Ur._fromIdTokenResponse(s,r,i);return t||await s._updateCurrentUser(l.user),l}async function Np(s,e){return CA(gs(s),e)}async function RA(s,e){const t=Ge(s);return await jp(!1,t,e.providerId),f1(t,e)}async function DA(s,e){return kA(Ge(s),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j7(s,e){return Ri(s,"POST","/v1/accounts:signInWithCustomToken",ws(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N7(s,e){if(as(s.app))return Promise.reject(tn(s));const t=gs(s),r=await j7(t,{token:e,returnSecureToken:!0}),i=await Ur._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?m1._fromServerResponse(e,t):"totpInfo"in t?g1._fromServerResponse(e,t):yn(e,"internal-error")}}class m1 extends Kf{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new m1(t)}}class g1 extends Kf{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new g1(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _p(s,e,t){var r;Oe(((r=t.url)==null?void 0:r.length)>0,s,"invalid-continue-uri"),Oe(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,s,"invalid-dynamic-link-domain"),Oe(typeof t.linkDomain>"u"||t.linkDomain.length>0,s,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(Oe(t.iOS.bundleId.length>0,s,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(Oe(t.android.packageName.length>0,s,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p1(s){const e=gs(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function _7(s,e,t){const r=gs(s),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&_p(r,i,t),await Eo(r,i,"getOobCode",i7,"EMAIL_PASSWORD_PROVIDER")}async function T7(s,e,t){await SA(Ge(s),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&p1(s),r})}async function S7(s,e){await n7(Ge(s),{oobCode:e})}async function OA(s,e){const t=Ge(s),r=await SA(t,{oobCode:e}),i=r.requestType;switch(Oe(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Oe(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Oe(r.mfaInfo,t,"internal-error");default:Oe(r.email,t,"internal-error")}let l=null;return r.mfaInfo&&(l=Kf._fromServerResponse(gs(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:l},operation:i}}async function E7(s,e){const{data:t}=await OA(Ge(s),e);return t.email}async function I7(s,e,t){if(as(s.app))return Promise.reject(tn(s));const r=gs(s),d=await Eo(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",EA,"EMAIL_PASSWORD_PROVIDER").catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&p1(s),f}),h=await Ur._fromIdTokenResponse(r,"signIn",d);return await r._updateCurrentUser(h.user),h}function A7(s,e,t){return as(s.app)?Promise.reject(tn(s)):Np(Ge(s),Go.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&p1(s),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k7(s,e,t){const r=gs(s),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function l(d,h){Oe(h.handleCodeInApp,r,"argument-error"),h&&_p(r,d,h)}l(i,t),await Eo(r,i,"getOobCode",o7,"EMAIL_PASSWORD_PROVIDER")}function C7(s,e){const t=wp.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function R7(s,e,t){if(as(s.app))return Promise.reject(tn(s));const r=Ge(s),i=Go.credentialWithLink(e,t||jf());return Oe(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Np(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D7(s,e){return js(s,"POST","/v1/accounts:createAuthUri",ws(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O7(s,e){const t=d1()?jf():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=await D7(Ge(s),r);return i||[]}async function P7(s,e){const t=Ge(s),i={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()};e&&_p(t.auth,i,e);const{email:l}=await a7(t.auth,i);l!==s.email&&await s.reload()}async function M7(s,e,t){const r=Ge(s),l={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await s.getIdToken(),newEmail:e};t&&_p(r.auth,l,t);const{email:d}=await l7(r.auth,l);d!==s.email&&await s.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L7(s,e){return js(s,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V7(s,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Ge(s),l={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},d=await Ti(r,L7(r.auth,l));r.displayName=d.displayName||null,r.photoURL=d.photoUrl||null;const h=r.providerData.find(({providerId:f})=>f==="password");h&&(h.displayName=r.displayName,h.photoURL=r.photoURL),await r._updateTokensIfNecessary(d)}function U7(s,e){const t=Ge(s);return as(t.auth.app)?Promise.reject(tn(t.auth)):PA(t,e,null)}function F7(s,e){return PA(Ge(s),null,e)}async function PA(s,e,t){const{auth:r}=s,l={idToken:await s.getIdToken(),returnSecureToken:!0};e&&(l.email=e),t&&(l.password=t);const d=await Ti(s,t7(r,l));await s._updateTokensIfNecessary(d,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B7(s){var i,l;if(!s)return null;const{providerId:e}=s,t=s.rawUserInfo?JSON.parse(s.rawUserInfo):{},r=s.isNewUser||s.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&(s!=null&&s.idToken)){const d=(l=(i=yp(s.idToken))==null?void 0:i.firebase)==null?void 0:l.sign_in_provider;if(d){const h=d!=="anonymous"&&d!=="custom"?d:null;return new Ed(r,h)}}if(!e)return null;switch(e){case"facebook.com":return new z7(r,t);case"github.com":return new $7(r,t);case"google.com":return new q7(r,t);case"twitter.com":return new H7(r,t,s.screenName||null);case"custom":case"anonymous":return new Ed(r,null);default:return new Ed(r,e,t)}}class Ed{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class MA extends Ed{constructor(e,t,r,i){super(e,t,r),this.username=i}}class z7 extends Ed{constructor(e,t){super(e,"facebook.com",t)}}class $7 extends MA{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class q7 extends Ed{constructor(e,t){super(e,"google.com",t)}}class H7 extends MA{constructor(e,t,r){super(e,"twitter.com",t,r)}}function G7(s){const{user:e,_tokenResponse:t}=s;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:B7(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new Ll("enroll",e,t)}static _fromMfaPendingCredential(e){return new Ll("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if((t=e.multiFactorSession)!=null&&t.pendingCredential)return Ll._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if((r=e.multiFactorSession)!=null&&r.idToken)return Ll._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=gs(e),i=t.customData._serverResponse,l=(i.mfaInfo||[]).map(h=>Kf._fromServerResponse(r,h));Oe(i.mfaPendingCredential,r,"internal-error");const d=Ll._fromMfaPendingCredential(i.mfaPendingCredential);return new x1(d,l,async h=>{const f=await h._process(r,d);delete i.mfaInfo,delete i.mfaPendingCredential;const m={...i,idToken:f.idToken,refreshToken:f.refreshToken};switch(t.operationType){case"signIn":const b=await Ur._fromIdTokenResponse(r,t.operationType,m);return await r._updateCurrentUser(b.user),b;case"reauthenticate":return Oe(t.user,r,"internal-error"),Ur._forOperation(t.user,t.operationType,m);default:yn(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function W7(s,e){var i;const t=Ge(s),r=e;return Oe(e.customData.operationType,t,"argument-error"),Oe((i=r.customData._serverResponse)==null?void 0:i.mfaPendingCredential,t,"argument-error"),x1._fromError(t,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(s,e){return js(s,"POST","/v2/accounts/mfaEnrollment:start",ws(s,e))}function K7(s,e){return js(s,"POST","/v2/accounts/mfaEnrollment:finalize",ws(s,e))}function Q7(s,e){return js(s,"POST","/v2/accounts/mfaEnrollment:withdraw",ws(s,e))}class b1{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Kf._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new b1(e)}async getSession(){return Ll._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,i=await this.getSession(),l=await Ti(this.user,r._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(l),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await Ti(this.user,Q7(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:l})=>l!==t),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const ly=new WeakMap;function Y7(s){const e=Ge(s);return ly.has(e)||ly.set(e,b1._fromUser(e)),ly.get(e)}const O0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LA{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(O0,"1"),this.storage.removeItem(O0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X7=1e3,J7=10;class VA extends LA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=wA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,h,f)=>{this.notifyListeners(d,f)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const d=this.storage.getItem(r);!t&&this.localCache[r]===d||this.notifyListeners(r,d)},l=this.storage.getItem(r);R8()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,J7):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},X7)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}VA.type="LOCAL";const y1=VA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA extends LA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}UA.type="SESSION";const ic=UA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z7(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Tp(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:l}=t.data,d=this.handlersMap[i];if(!(d!=null&&d.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const h=Array.from(d).map(async m=>m(t.origin,l)),f=await Z7(h);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Tp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qf(s="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return s+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eU{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let l,d;return new Promise((h,f)=>{const m=Qf("",20);i.port1.start();const b=setTimeout(()=>{f(new Error("unsupported_event"))},r);d={messageChannel:i,onMessage(y){const v=y;if(v.data.eventId===m)switch(v.data.status){case"ack":clearTimeout(b),l=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),h(v.data.response);break;default:clearTimeout(b),clearTimeout(l),f(new Error("invalid_response"));break}}},this.handlers.add(d),i.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[i.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fs(){return window}function tU(s){Fs().location.href=s}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v1(){return typeof Fs().WorkerGlobalScope<"u"&&typeof Fs().importScripts=="function"}async function sU(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function nU(){var s;return((s=navigator==null?void 0:navigator.serviceWorker)==null?void 0:s.controller)||null}function rU(){return v1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FA="firebaseLocalStorageDb",aU=1,P0="firebaseLocalStorage",BA="fbase_key";class Yf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Sp(s,e){return s.transaction([P0],e?"readwrite":"readonly").objectStore(P0)}function iU(){const s=indexedDB.deleteDatabase(FA);return new Yf(s).toPromise()}function cv(){const s=indexedDB.open(FA,aU);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const r=s.result;try{r.createObjectStore(P0,{keyPath:BA})}catch(i){t(i)}}),s.addEventListener("success",async()=>{const r=s.result;r.objectStoreNames.contains(P0)?e(r):(r.close(),await iU(),e(await cv()))})})}async function _T(s,e,t){const r=Sp(s,!0).put({[BA]:e,value:t});return new Yf(r).toPromise()}async function oU(s,e){const t=Sp(s,!1).get(e),r=await new Yf(t).toPromise();return r===void 0?null:r.value}function TT(s,e){const t=Sp(s,!0).delete(e);return new Yf(t).toPromise()}const lU=800,cU=3;class zA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await cv(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>cU)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return v1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Tp._getInstance(rU()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await sU(),!this.activeServiceWorker)return;this.sender=new eU(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||nU()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await cv();return await _T(e,O0,"1"),await TT(e,O0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>_T(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>oU(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>TT(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const l=Sp(i,!1).getAll();return new Yf(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:l}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(l)&&(this.notifyListeners(i,l),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),lU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}zA.type="LOCAL";const Tf=zA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ST(s,e){return js(s,"POST","/v2/accounts/mfaSignIn:start",ws(s,e))}function dU(s,e){return js(s,"POST","/v2/accounts/mfaSignIn:finalize",ws(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cy=NA("rcb"),uU=new qf(3e4,6e4);class hU{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!((e=Fs().grecaptcha)!=null&&e.render)}load(e,t=""){return Oe(fU(t),e,"argument-error"),this.shouldResolveImmediately(t)&&mT(Fs().grecaptcha)?Promise.resolve(Fs().grecaptcha):new Promise((r,i)=>{const l=Fs().setTimeout(()=>{i(Ws(e,"network-request-failed"))},uU.get());Fs()[cy]=()=>{Fs().clearTimeout(l),delete Fs()[cy];const h=Fs().grecaptcha;if(!h||!mT(h)){i(Ws(e,"internal-error"));return}const f=h.render;h.render=(m,b)=>{const y=f(m,b);return this.counter++,y},this.hostLanguage=t,r(h)};const d=`${U8()}?${tu({onload:cy,render:"explicit",hl:t})}`;h1(d).catch(()=>{clearTimeout(l),i(Ws(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!((t=Fs().grecaptcha)!=null&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function fU(s){return s.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(s)}class mU{async load(e){return new q8(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh="recaptcha",gU={theme:"light",type:"image"};let pU=class{constructor(e,t,r={...gU}){this.parameters=r,this.type=Yh,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=gs(e),this.isInvisible=this.parameters.size==="invisible",Oe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof t=="string"?document.getElementById(t):t;Oe(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new mU:new hU,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{const l=d=>{d&&(this.tokenChangeListeners.delete(l),i(d))};this.tokenChangeListeners.add(l),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){Oe(!this.parameters.sitekey,this.auth,"argument-error"),Oe(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Oe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=Fs()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){Oe(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){Oe(d1()&&!v1(),this.auth,"internal-error"),await xU(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await v8(this.auth);Oe(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return Oe(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function xU(){let s=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}s=()=>e(),window.addEventListener("load",s)}).catch(e=>{throw s&&window.removeEventListener("load",s),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Bl._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function bU(s,e,t){if(as(s.app))return Promise.reject(tn(s));const r=gs(s),i=await Ep(r,e,Ge(t));return new w1(i,l=>Np(r,l))}async function yU(s,e,t){const r=Ge(s);await jp(!1,r,"phone");const i=await Ep(r.auth,e,Ge(t));return new w1(i,l=>RA(r,l))}async function vU(s,e,t){const r=Ge(s);if(as(r.auth.app))return Promise.reject(tn(r.auth));const i=await Ep(r.auth,e,Ge(t));return new w1(i,l=>DA(r,l))}async function Ep(s,e,t){var r;if(!s._getRecaptchaConfig())try{await Y8(s)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const l=i.session;if("phoneNumber"in i){Oe(l.type==="enroll",s,"internal-error");const d={idToken:l.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await Eo(s,d,"mfaSmsEnrollment",async(b,y)=>{if(y.phoneEnrollmentInfo.captchaResponse===Qh){Oe((t==null?void 0:t.type)===Yh,b,"argument-error");const v=await dy(b,y,t);return NT(b,v)}return NT(b,y)},"PHONE_PROVIDER").catch(b=>Promise.reject(b))).phoneSessionInfo.sessionInfo}else{Oe(l.type==="signin",s,"internal-error");const d=((r=i.multiFactorHint)==null?void 0:r.uid)||i.multiFactorUid;Oe(d,s,"missing-multi-factor-info");const h={mfaPendingCredential:l.credential,mfaEnrollmentId:d,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await Eo(s,h,"mfaSmsSignIn",async(y,v)=>{if(v.phoneSignInInfo.captchaResponse===Qh){Oe((t==null?void 0:t.type)===Yh,y,"argument-error");const N=await dy(y,v,t);return ST(y,N)}return ST(y,v)},"PHONE_PROVIDER").catch(y=>Promise.reject(y))).phoneResponseInfo.sessionInfo}}else{const l={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await Eo(s,l,"sendVerificationCode",async(m,b)=>{if(b.captchaResponse===Qh){Oe((t==null?void 0:t.type)===Yh,m,"argument-error");const y=await dy(m,b,t);return wT(m,y)}return wT(m,b)},"PHONE_PROVIDER").catch(m=>Promise.reject(m))).sessionInfo}}finally{t==null||t._reset()}}async function wU(s,e){const t=Ge(s);if(as(t.auth.app))return Promise.reject(tn(t.auth));await f1(t,e)}async function dy(s,e,t){Oe(t.type===Yh,s,"argument-error");const r=await t.verify();Oe(typeof r=="string",s,"argument-error");const i={...e};if("phoneEnrollmentInfo"in i){const l=i.phoneEnrollmentInfo.phoneNumber,d=i.phoneEnrollmentInfo.captchaResponse,h=i.phoneEnrollmentInfo.clientType,f=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:r,captchaResponse:d,clientType:h,recaptchaVersion:f}}),i}else if("phoneSignInInfo"in i){const l=i.phoneSignInInfo.captchaResponse,d=i.phoneSignInInfo.clientType,h=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:l,clientType:d,recaptchaVersion:h}}),i}else return Object.assign(i,{recaptchaToken:r}),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oc=class s0{constructor(e){this.providerId=s0.PROVIDER_ID,this.auth=gs(e)}verifyPhoneNumber(e,t){return Ep(this.auth,e,Ge(t))}static credential(e,t){return Bl._fromVerification(e,t)}static credentialFromResult(e){const t=e;return s0.credentialFromTaggedObject(t)}static credentialFromError(e){return s0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?Bl._fromTokenResponse(t,r):null}};oc.PROVIDER_ID="phone";oc.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mc(s,e){return e?hr(e):(Oe(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1 extends hu{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return yi(e,this._buildIdpRequest())}_linkToIdToken(e,t){return yi(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return yi(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function jU(s){return CA(s.auth,new j1(s),s.bypassAuthState)}function NU(s){const{auth:e,user:t}=s;return Oe(t,e,"internal-error"),kA(t,new j1(s),s.bypassAuthState)}async function _U(s){const{auth:e,user:t}=s;return Oe(t,e,"internal-error"),f1(t,new j1(s),s.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(e,t,r,i,l=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:l,error:d,type:h}=e;if(d){this.reject(d);return}const f={auth:this.auth,requestUri:t,sessionId:r,tenantId:l||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(f))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return jU;case"linkViaPopup":case"linkViaRedirect":return _U;case"reauthViaPopup":case"reauthViaRedirect":return NU;default:yn(this.auth,"internal-error")}}resolve(e){aa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){aa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TU=new qf(2e3,1e4);async function SU(s,e,t){if(as(s.app))return Promise.reject(Ws(s,"operation-not-supported-in-this-environment"));const r=gs(s);uu(s,e,Di);const i=mc(r,t);return new pi(r,"signInViaPopup",e,i).executeNotNull()}async function EU(s,e,t){const r=Ge(s);if(as(r.auth.app))return Promise.reject(Ws(r.auth,"operation-not-supported-in-this-environment"));uu(r.auth,e,Di);const i=mc(r.auth,t);return new pi(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function IU(s,e,t){const r=Ge(s);uu(r.auth,e,Di);const i=mc(r.auth,t);return new pi(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class pi extends $A{constructor(e,t,r,i,l){super(e,t,i,l),this.provider=r,this.authWindow=null,this.pollId=null,pi.currentPopupAction&&pi.currentPopupAction.cancel(),pi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Oe(e,this.auth,"internal-error"),e}async onExecution(){aa(this.filter.length===1,"Popup operations only handle one event");const e=Qf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ws(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Ws(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,pi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if((r=(t=this.authWindow)==null?void 0:t.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ws(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,TU.get())};e()}}pi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AU="pendingRedirect",Xh=new Map;class kU extends $A{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Xh.get(this.auth._key());if(!e){try{const r=await CU(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Xh.set(this.auth._key(),e)}return this.bypassAuthState||Xh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function CU(s,e){const t=HA(e),r=qA(s);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}async function N1(s,e){return qA(s)._set(HA(e),"true")}function RU(){Xh.clear()}function _1(s,e){Xh.set(s._key(),e)}function qA(s){return hr(s._redirectPersistence)}function HA(s){return Fl(AU,s.config.apiKey,s.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DU(s,e,t){return OU(s,e,t)}async function OU(s,e,t){if(as(s.app))return Promise.reject(tn(s));const r=gs(s);uu(s,e,Di),await r._initializationPromise;const i=mc(r,t);return await N1(i,r),i._openRedirect(r,e,"signInViaRedirect")}function PU(s,e,t){return MU(s,e,t)}async function MU(s,e,t){const r=Ge(s);if(uu(r.auth,e,Di),as(r.auth.app))return Promise.reject(tn(r.auth));await r.auth._initializationPromise;const i=mc(r.auth,t);await N1(i,r.auth);const l=await GA(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",l)}function LU(s,e,t){return VU(s,e,t)}async function VU(s,e,t){const r=Ge(s);uu(r.auth,e,Di),await r.auth._initializationPromise;const i=mc(r.auth,t);await jp(!1,r,e.providerId),await N1(i,r.auth);const l=await GA(r);return i._openRedirect(r.auth,e,"linkViaRedirect",l)}async function UU(s,e){return await gs(s)._initializationPromise,Ip(s,e,!1)}async function Ip(s,e,t=!1){if(as(s.app))return Promise.reject(tn(s));const r=gs(s),i=mc(r,e),d=await new kU(r,i,t).execute();return d&&!t&&(delete d.user._redirectEventId,await r._persistUserIfCurrent(d.user),await r._setRedirectUser(null,e)),d}async function GA(s){const e=Qf(`${s.uid}:::`);return s._redirectEventId=e,await s.auth._setRedirectUser(s),await s.auth._persistUserIfCurrent(s),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FU=600*1e3;class WA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!BU(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!KA(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";t.onError(Ws(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=FU&&this.cachedEventUids.clear(),this.cachedEventUids.has(ET(e))}saveEventToCache(e){this.cachedEventUids.add(ET(e)),this.lastProcessedEventTime=Date.now()}}function ET(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function KA({type:s,error:e}){return s==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function BU(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return KA(s);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QA(s,e={}){return js(s,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zU=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$U=/^https?/;async function qU(s){if(s.config.emulator)return;const{authorizedDomains:e}=await QA(s);for(const t of e)try{if(HU(t))return}catch{}yn(s,"unauthorized-domain")}function HU(s){const e=jf(),{protocol:t,hostname:r}=new URL(e);if(s.startsWith("chrome-extension://")){const d=new URL(s);return d.hostname===""&&r===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===r}if(!$U.test(t))return!1;if(zU.test(s))return r===s;const i=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GU=new qf(3e4,6e4);function IT(){const s=Fs().___jsl;if(s!=null&&s.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function WU(s){return new Promise((e,t)=>{var i,l,d;function r(){IT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{IT(),t(Ws(s,"network-request-failed"))},timeout:GU.get()})}if((l=(i=Fs().gapi)==null?void 0:i.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((d=Fs().gapi)!=null&&d.load)r();else{const h=NA("iframefcb");return Fs()[h]=()=>{gapi.load?r():t(Ws(s,"network-request-failed"))},h1(`${B8()}?onload=${h}`).catch(f=>t(f))}}).catch(e=>{throw n0=null,e})}let n0=null;function KU(s){return n0=n0||WU(s),n0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QU=new qf(5e3,15e3),YU="__/auth/iframe",XU="emulator/auth/iframe",JU={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ZU=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function eF(s){const e=s.config;Oe(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?u1(e,XU):`https://${s.config.authDomain}/${YU}`,r={apiKey:e.apiKey,appName:s.name,v:Ei},i=ZU.get(s.config.apiHost);i&&(r.eid=i);const l=s._getFrameworks();return l.length&&(r.fw=l.join(",")),`${t}?${tu(r).slice(1)}`}async function tF(s){const e=await KU(s),t=Fs().gapi;return Oe(t,s,"internal-error"),e.open({where:document.body,url:eF(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:JU,dontclear:!0},r=>new Promise(async(i,l)=>{await r.restyle({setHideOnLeave:!1});const d=Ws(s,"network-request-failed"),h=Fs().setTimeout(()=>{l(d)},QU.get());function f(){Fs().clearTimeout(h),i(r)}r.ping(f).then(f,()=>{l(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},nF=500,rF=600,aF="_blank",iF="http://localhost";class AT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function oF(s,e,t,r=nF,i=rF){const l=Math.max((window.screen.availHeight-i)/2,0).toString(),d=Math.max((window.screen.availWidth-r)/2,0).toString();let h="";const f={...sF,width:r.toString(),height:i.toString(),top:l,left:d},m=ms().toLowerCase();t&&(h=xA(m)?aF:t),gA(m)&&(e=e||iF,f.scrollbars="yes");const b=Object.entries(f).reduce((v,[N,E])=>`${v}${N}=${E},`,"");if(C8(m)&&h!=="_self")return lF(e||"",h),new AT(null);const y=window.open(e||"",h,b);Oe(y,s,"popup-blocked");try{y.focus()}catch{}return new AT(y)}function lF(s,e){const t=document.createElement("a");t.href=s,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cF="__/auth/handler",dF="emulator/auth/handler",uF=encodeURIComponent("fac");async function dv(s,e,t,r,i,l){Oe(s.config.authDomain,s,"auth-domain-config-required"),Oe(s.config.apiKey,s,"invalid-api-key");const d={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:r,v:Ei,eventId:i};if(e instanceof Di){e.setDefaultLanguage(s.languageCode),d.providerId=e.providerId||"",OR(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,y]of Object.entries(l||{}))d[b]=y}if(e instanceof fu){const b=e.getScopes().filter(y=>y!=="");b.length>0&&(d.scopes=b.join(","))}s.tenantId&&(d.tid=s.tenantId);const h=d;for(const b of Object.keys(h))h[b]===void 0&&delete h[b];const f=await s._getAppCheckToken(),m=f?`#${uF}=${encodeURIComponent(f)}`:"";return`${hF(s)}?${tu(h).slice(1)}${m}`}function hF({config:s}){return s.emulator?u1(s,dF):`https://${s.authDomain}/${cF}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy="webStorageSupport";class fF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ic,this._completeRedirectFn=Ip,this._overrideRedirectResult=_1}async _openPopup(e,t,r,i){var d;aa((d=this.eventManagers[e._key()])==null?void 0:d.manager,"_initialize() not called before _openPopup()");const l=await dv(e,t,r,jf(),i);return oF(e,l,Qf())}async _openRedirect(e,t,r,i){await this._originValidation(e);const l=await dv(e,t,r,jf(),i);return tU(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:l}=this.eventManagers[t];return i?Promise.resolve(i):(aa(l,"If manager is not set, promise should be"),l)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await tF(e),r=new WA(e);return t.register("authEvent",i=>(Oe(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(uy,{type:uy},i=>{var d;const l=(d=i==null?void 0:i[0])==null?void 0:d[uy];l!==void 0&&t(!!l),yn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=qU(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return wA()||pA()||Gf()}}const mF=fF;class gF{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Ma("unexpected MultiFactorSessionType")}}}class T1 extends gF{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new T1(e)}_finalizeEnroll(e,t,r){return K7(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return dU(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class YA{constructor(){}static assertion(e){return T1._fromCredential(e)}}YA.FACTOR_ID="phone";var kT="@firebase/auth",CT="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xF(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function bF(s){Zn(new sn("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:d,authDomain:h}=r.options;Oe(d&&!d.includes(":"),"invalid-api-key",{appName:r.name});const f={apiKey:d,authDomain:h,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jA(s)},m=new L8(r,i,l,f);return X8(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Zn(new sn("auth-internal",e=>{const t=gs(e.getProvider("auth").getImmediate());return(r=>new pF(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),mn(kT,CT,xF(s)),mn(kT,CT,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yF=300;jR("authIdTokenMaxAge");function vF(){var s;return((s=document.getElementsByTagName("head"))==null?void 0:s[0])??document}V8({loadJS(s){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",s),r.onload=e,r.onerror=i=>{const l=Ws("internal-error");l.customData=i,t(l)},r.type="text/javascript",r.charset="UTF-8",vF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});bF("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lc(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wF=2e3;async function jF(s,e,t){const{BuildInfo:r}=lc();aa(e.sessionId,"AuthEvent did not contain a session ID");const i=await EF(e.sessionId),l={};return Gf()?l.ibi=r.packageName:Hf()?l.apn=r.packageName:yn(s,"operation-not-supported-in-this-environment"),r.displayName&&(l.appDisplayName=r.displayName),l.sessionId=i,dv(s,t,e.type,void 0,e.eventId??void 0,l)}async function NF(s){const{BuildInfo:e}=lc(),t={};Gf()?t.iosBundleId=e.packageName:Hf()?t.androidPackageName=e.packageName:yn(s,"operation-not-supported-in-this-environment"),await QA(s,t)}function _F(s){const{cordova:e}=lc();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(s):i=e.InAppBrowser.open(s,k8()?"_blank":"_system","location=yes"),t(i)})})}async function TF(s,e,t){const{cordova:r}=lc();let i=()=>{};try{await new Promise((l,d)=>{let h=null;function f(){var v;l();const y=(v=r.plugins.browsertab)==null?void 0:v.close;typeof y=="function"&&y(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function m(){h||(h=window.setTimeout(()=>{d(Ws(s,"redirect-cancelled-by-user"))},wF))}function b(){(document==null?void 0:document.visibilityState)==="visible"&&m()}e.addPassiveListener(f),document.addEventListener("resume",m,!1),Hf()&&document.addEventListener("visibilitychange",b,!1),i=()=>{e.removePassiveListener(f),document.removeEventListener("resume",m,!1),document.removeEventListener("visibilitychange",b,!1),h&&window.clearTimeout(h)}})}finally{i()}}function SF(s){var t,r,i,l,d,h,f,m,b,y;const e=lc();Oe(typeof((t=e==null?void 0:e.universalLinks)==null?void 0:t.subscribe)=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),Oe(typeof((r=e==null?void 0:e.BuildInfo)==null?void 0:r.packageName)<"u",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),Oe(typeof((d=(l=(i=e==null?void 0:e.cordova)==null?void 0:i.plugins)==null?void 0:l.browsertab)==null?void 0:d.openUrl)=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Oe(typeof((m=(f=(h=e==null?void 0:e.cordova)==null?void 0:h.plugins)==null?void 0:f.browsertab)==null?void 0:m.isAvailable)=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Oe(typeof((y=(b=e==null?void 0:e.cordova)==null?void 0:b.InAppBrowser)==null?void 0:y.open)=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function EF(s){const e=IF(s),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}function IF(s){if(aa(/[0-9a-zA-Z]+/.test(s),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(s);const e=new ArrayBuffer(s.length),t=new Uint8Array(e);for(let r=0;r<s.length;r++)t[r]=s.charCodeAt(r);return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AF=20;class kF extends WA{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function CF(s,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:OF(),postBody:null,tenantId:s.tenantId,error:Ws(s,"no-auth-event")}}function RF(s,e){return uv()._set(hv(s),e)}async function RT(s){const e=await uv()._get(hv(s));return e&&await uv()._remove(hv(s)),e}function DF(s,e){var r,i;const t=MF(e);if(t.includes("/__/auth/callback")){const l=r0(t),d=l.firebaseError?PF(decodeURIComponent(l.firebaseError)):null,h=(i=(r=d==null?void 0:d.code)==null?void 0:r.split("auth/"))==null?void 0:i[1],f=h?Ws(h):null;return f?{type:s.type,eventId:s.eventId,tenantId:s.tenantId,error:f,urlResponse:null,sessionId:null,postBody:null}:{type:s.type,eventId:s.eventId,tenantId:s.tenantId,sessionId:s.sessionId,urlResponse:t,postBody:null}}return null}function OF(){const s=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<AF;t++){const r=Math.floor(Math.random()*e.length);s.push(e.charAt(r))}return s.join("")}function uv(){return hr(y1)}function hv(s){return Fl("authEvent",s.config.apiKey,s.name)}function PF(s){try{return JSON.parse(s)}catch{return null}}function MF(s){const e=r0(s),t=e.link?decodeURIComponent(e.link):void 0,r=r0(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return r0(i).link||i||r||t||s}function r0(s){if(!(s!=null&&s.includes("?")))return{};const[e,...t]=s.split("?");return xd(t.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LF=500;class VF{constructor(){this._redirectPersistence=ic,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Ip,this._overrideRedirectResult=_1}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new kF(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){yn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,i){SF(e);const l=await this._initialize(e);await l.initialized(),l.resetRedirect(),RU(),await this._originValidation(e);const d=CF(e,r,i);await RF(e,d);const h=await jF(e,d,t),f=await _F(h);return TF(e,l,f)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=NF(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:i,BuildInfo:l}=lc(),d=setTimeout(async()=>{await RT(e),t.onEvent(DT())},LF),h=async b=>{clearTimeout(d);const y=await RT(e);let v=null;y&&(b!=null&&b.url)&&(v=DF(y,b.url)),t.onEvent(v||DT())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,h);const f=i,m=`${l.packageName.toLowerCase()}://`;lc().handleOpenURL=async b=>{if(b.toLowerCase().startsWith(m)&&h({url:b}),typeof f=="function")try{f(b)}catch(y){console.error(y)}}}}const UF=VF;function DT(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Ws("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FF(s,e){gs(s)._logFramework(e)}var BF="@firebase/auth-compat",zF="0.6.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $F=1e3;function Jh(){var s;return((s=self==null?void 0:self.location)==null?void 0:s.protocol)||null}function qF(){return Jh()==="http:"||Jh()==="https:"}function XA(s=ms()){return!!((Jh()==="file:"||Jh()==="ionic:"||Jh()==="capacitor:")&&s.toLowerCase().match(/iphone|ipad|ipod|android/))}function HF(){return Dv()||$0()}function GF(){return jS()&&(document==null?void 0:document.documentMode)===11}function WF(s=ms()){return/Edge\/\d+/.test(s)}function KF(s=ms()){return GF()||WF(s)}function JA(){try{const s=self.localStorage,e=Qf();if(s)return s.setItem(e,"1"),s.removeItem(e),KF()?ql():!0}catch{return S1()&&ql()}return!1}function S1(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function hy(){return(qF()||wS()||XA())&&!HF()&&JA()&&!S1()}function ZA(){return XA()&&typeof document<"u"}async function QF(){return ZA()?new Promise(s=>{const e=setTimeout(()=>{s(!1)},$F);document.addEventListener("deviceready",()=>{clearTimeout(e),s(!0)})}):!1}function YF(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ur={LOCAL:"local",NONE:"none",SESSION:"session"},_h=Oe,ek="persistence";function XF(s,e){if(_h(Object.values(ur).includes(e),s,"invalid-persistence-type"),Dv()){_h(e!==ur.SESSION,s,"unsupported-persistence-type");return}if($0()){_h(e===ur.NONE,s,"unsupported-persistence-type");return}if(S1()){_h(e===ur.NONE||e===ur.LOCAL&&ql(),s,"unsupported-persistence-type");return}_h(e===ur.NONE||JA(),s,"unsupported-persistence-type")}async function fv(s){await s._initializationPromise;const e=tk(),t=Fl(ek,s.config.apiKey,s.name);e&&e.setItem(t,s._getPersistenceType())}function JF(s,e){const t=tk();if(!t)return[];const r=Fl(ek,s,e);switch(t.getItem(r)){case ur.NONE:return[Xd];case ur.LOCAL:return[Tf,ic];case ur.SESSION:return[ic];default:return[]}}function tk(){var s;try{return((s=YF())==null?void 0:s.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZF=Oe;class jo{constructor(){this.browserResolver=hr(mF),this.cordovaResolver=hr(UF),this.underlyingResolver=null,this._redirectPersistence=ic,this._completeRedirectFn=Ip,this._overrideRedirectResult=_1}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)}async _openRedirect(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return ZA()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return ZF(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await QF();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sk(s){return s.unwrap()}function eB(s){return s.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tB(s){return nk(s)}function sB(s,e){var r;const t=(r=e.customData)==null?void 0:r._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new nB(s,W7(s,e))}else if(t){const i=nk(e),l=e;i&&(l.credential=i,l.tenantId=t.tenantId||void 0,l.email=t.email||void 0,l.phoneNumber=t.phoneNumber||void 0)}}function nk(s){const{_tokenResponse:e}=s instanceof fn?s.customData:s;if(!e)return null;if(!(s instanceof fn)&&"temporaryProof"in e&&"phoneNumber"in e)return oc.credentialFromResult(s);const t=e.providerId;if(!t||t===jh.PASSWORD)return null;let r;switch(t){case jh.GOOGLE:r=ka;break;case jh.FACEBOOK:r=Aa;break;case jh.GITHUB:r=Ca;break;case jh.TWITTER:r=Ra;break;default:const{oauthIdToken:i,oauthAccessToken:l,oauthTokenSecret:d,pendingToken:h,nonce:f}=e;return!l&&!d&&!i&&!h?null:h?t.startsWith("saml.")?Jd._create(t,h):qa._fromParams({providerId:t,signInMethod:t,pendingToken:h,idToken:i,accessToken:l}):new Sd(t).credential({idToken:i,accessToken:l,rawNonce:f})}return s instanceof fn?r.credentialFromError(s):r.credentialFromResult(s)}function Wn(s,e){return e.catch(t=>{throw t instanceof fn&&sB(s,t),t}).then(t=>{const r=t.operationType,i=t.user;return{operationType:r,credential:tB(t),additionalUserInfo:G7(t),user:xi.getOrCreate(i)}})}async function mv(s,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>Wn(s,t.confirm(r))}}class nB{constructor(e,t){this.resolver=t,this.auth=eB(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Wn(sk(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e){this._delegate=e,this.multiFactor=Y7(e)}static getOrCreate(e){return xi.USER_MAP.has(e)||xi.USER_MAP.set(e,new xi(e)),xi.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Wn(this.auth,RA(this._delegate,e))}async linkWithPhoneNumber(e,t){return mv(this.auth,yU(this._delegate,e,t))}async linkWithPopup(e){return Wn(this.auth,IU(this._delegate,e,jo))}async linkWithRedirect(e){return await fv(gs(this.auth)),LU(this._delegate,e,jo)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Wn(this.auth,DA(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return mv(this.auth,vU(this._delegate,e,t))}reauthenticateWithPopup(e){return Wn(this.auth,EU(this._delegate,e,jo))}async reauthenticateWithRedirect(e){return await fv(gs(this.auth)),PU(this._delegate,e,jo)}sendEmailVerification(e){return P7(this._delegate,e)}async unlink(e){return await w7(this._delegate,e),this}updateEmail(e){return U7(this._delegate,e)}updatePassword(e){return F7(this._delegate,e)}updatePhoneNumber(e){return wU(this._delegate,e)}updateProfile(e){return V7(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return M7(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}xi.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Th=Oe;class gv{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Th(r,"invalid-api-key",{appName:e.name}),Th(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?jo:void 0;this._delegate=t.initialize({options:{persistence:rB(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(d8),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?xi.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){J8(this._delegate,e,t)}applyActionCode(e){return S7(this._delegate,e)}checkActionCode(e){return OA(this._delegate,e)}confirmPasswordReset(e,t){return T7(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Wn(this._delegate,I7(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return O7(this._delegate,e)}isSignInWithEmailLink(e){return C7(this._delegate,e)}async getRedirectResult(){Th(hy(),this._delegate,"operation-not-supported-in-this-environment");const e=await UU(this._delegate,jo);return e?Wn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){FF(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:i,error:l,complete:d}=OT(e,t,r);return this._delegate.onAuthStateChanged(i,l,d)}onIdTokenChanged(e,t,r){const{next:i,error:l,complete:d}=OT(e,t,r);return this._delegate.onIdTokenChanged(i,l,d)}sendSignInLinkToEmail(e,t){return k7(this._delegate,e,t)}sendPasswordResetEmail(e,t){return _7(this._delegate,e,t||void 0)}async setPersistence(e){XF(this._delegate,e);let t;switch(e){case ur.SESSION:t=ic;break;case ur.LOCAL:t=await hr(Tf)._isAvailable()?Tf:y1;break;case ur.NONE:t=Xd;break;default:return yn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Wn(this._delegate,v7(this._delegate))}signInWithCredential(e){return Wn(this._delegate,Np(this._delegate,e))}signInWithCustomToken(e){return Wn(this._delegate,N7(this._delegate,e))}signInWithEmailAndPassword(e,t){return Wn(this._delegate,A7(this._delegate,e,t))}signInWithEmailLink(e,t){return Wn(this._delegate,R7(this._delegate,e,t))}signInWithPhoneNumber(e,t){return mv(this._delegate,bU(this._delegate,e,t))}async signInWithPopup(e){return Th(hy(),this._delegate,"operation-not-supported-in-this-environment"),Wn(this._delegate,SU(this._delegate,e,jo))}async signInWithRedirect(e){return Th(hy(),this._delegate,"operation-not-supported-in-this-environment"),await fv(this._delegate),DU(this._delegate,e,jo)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return E7(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}gv.Persistence=ur;function OT(s,e,t){let r=s;typeof s!="function"&&({next:r,error:e,complete:t}=s);const i=r;return{next:d=>i(d&&xi.getOrCreate(d)),error:e,complete:t}}function rB(s,e){const t=JF(s,e);if(typeof self<"u"&&!t.includes(Tf)&&t.push(Tf),typeof window<"u")for(const r of[y1,ic])t.includes(r)||t.push(r);return t.includes(Xd)||t.push(Xd),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{static credential(e,t){return oc.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new oc(sk(Mt.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}E1.PHONE_SIGN_IN_METHOD=oc.PHONE_SIGN_IN_METHOD;E1.PROVIDER_ID=oc.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aB=Oe;class iB{constructor(e,t,r=Mt.app()){var i;aB((i=r.options)==null?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new pU(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oB="auth-compat";function lB(s){s.INTERNAL.registerComponent(new sn(oB,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new gv(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:od.EMAIL_SIGNIN,PASSWORD_RESET:od.PASSWORD_RESET,RECOVER_EMAIL:od.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:od.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:od.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:od.VERIFY_EMAIL}},EmailAuthProvider:Go,FacebookAuthProvider:Aa,GithubAuthProvider:Ca,GoogleAuthProvider:ka,OAuthProvider:Sd,SAMLAuthProvider:R0,PhoneAuthProvider:E1,PhoneMultiFactorGenerator:YA,RecaptchaVerifier:iB,TwitterAuthProvider:Ra,Auth:gv,AuthCredential:hu,Error:fn}).setInstantiationMode("LAZY").setMultipleInstances(!1)),s.registerVersion(BF,zF)}lB(Mt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rk="firebasestorage.googleapis.com",ak="storageBucket",cB=120*1e3,dB=600*1e3,uB=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps extends fn{constructor(e,t,r=0){super(fy(e),`Firebase Storage: ${t} (${fy(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ps.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return fy(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var is;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(is||(is={}));function fy(s){return"storage/"+s}function I1(){const s="An unknown error occurred, please check the error payload for server response.";return new ps(is.UNKNOWN,s)}function hB(s){return new ps(is.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function fB(s){return new ps(is.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function mB(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ps(is.UNAUTHENTICATED,s)}function gB(){return new ps(is.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function pB(s){return new ps(is.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function ik(){return new ps(is.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function ok(){return new ps(is.CANCELED,"User canceled the upload/download.")}function xB(s){return new ps(is.INVALID_URL,"Invalid URL '"+s+"'.")}function bB(s){return new ps(is.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function yB(){return new ps(is.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+ak+"' property when initializing the app?")}function lk(){return new ps(is.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function vB(){return new ps(is.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function wB(){return new ps(is.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function jB(s){return new ps(is.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Id(s){return new ps(is.INVALID_ARGUMENT,s)}function ck(){return new ps(is.APP_DELETED,"The Firebase app was deleted.")}function dk(s){return new ps(is.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Zh(s,e){return new ps(is.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function Sh(s){throw new ps(is.INTERNAL_ERROR,"Internal error: "+s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=_n.makeFromUrl(e,t)}catch{return new _n(e,"")}if(r.path==="")return r;throw bB(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function l(Q){Q.path.charAt(Q.path.length-1)==="/"&&(Q.path_=Q.path_.slice(0,-1))}const d="(/(.*))?$",h=new RegExp("^gs://"+i+d,"i"),f={bucket:1,path:3};function m(Q){Q.path_=decodeURIComponent(Q.path)}const b="v[A-Za-z0-9_]+",y=t.replace(/[.]/g,"\\."),v="(/([^?#]*).*)?$",N=new RegExp(`^https?://${y}/${b}/b/${i}/o${v}`,"i"),E={bucket:1,path:3},I=t===rk?"(?:storage.googleapis.com|storage.cloud.google.com)":t,T="([^?#]*)",L=new RegExp(`^https?://${I}/${i}/${T}`,"i"),B=[{regex:h,indices:f,postModify:l},{regex:N,indices:E,postModify:m},{regex:L,indices:{bucket:1,path:2},postModify:m}];for(let Q=0;Q<B.length;Q++){const Z=B[Q],Y=Z.regex.exec(e);if(Y){const C=Y[Z.indices.bucket];let P=Y[Z.indices.path];P||(P=""),r=new _n(C,P),Z.postModify(r);break}}if(r==null)throw xB(e);return r}}class NB{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _B(s,e,t){let r=1,i=null,l=null,d=!1,h=0;function f(){return h===2}let m=!1;function b(...T){m||(m=!0,e.apply(null,T))}function y(T){i=setTimeout(()=>{i=null,s(N,f())},T)}function v(){l&&clearTimeout(l)}function N(T,...L){if(m){v();return}if(T){v(),b.call(null,T,...L);return}if(f()||d){v(),b.call(null,T,...L);return}r<64&&(r*=2);let B;h===1?(h=2,B=0):B=(r+Math.random())*1e3,y(B)}let E=!1;function I(T){E||(E=!0,v(),!m&&(i!==null?(T||(h=2),clearTimeout(i),y(0)):T||(h=1)))}return y(0),l=setTimeout(()=>{d=!0,I(!0)},t),I}function TB(s){s(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SB(s){return s!==void 0}function EB(s){return typeof s=="function"}function IB(s){return typeof s=="object"&&!Array.isArray(s)}function Ap(s){return typeof s=="string"||s instanceof String}function PT(s){return A1()&&s instanceof Blob}function A1(){return typeof Blob<"u"}function pv(s,e,t,r){if(r<e)throw Id(`Invalid value for '${s}'. Expected ${e} or greater.`);if(r>t)throw Id(`Invalid value for '${s}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wo(s,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${s}`}function uk(s){const e=encodeURIComponent;let t="?";for(const r in s)if(s.hasOwnProperty(r)){const i=e(r)+"="+e(s[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var zl;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(zl||(zl={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hk(s,e){const t=s>=500&&s<600,i=[408,429].indexOf(s)!==-1,l=e.indexOf(s)!==-1;return t||i||l}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AB{constructor(e,t,r,i,l,d,h,f,m,b,y,v=!0,N=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=l,this.additionalRetryCodes_=d,this.callback_=h,this.errorCallback_=f,this.timeout_=m,this.progressCallback_=b,this.connectionFactory_=y,this.retry=v,this.isUsingEmulator=N,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((E,I)=>{this.resolve_=E,this.reject_=I,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new kg(!1,null,!0));return}const l=this.connectionFactory_();this.pendingConnection_=l;const d=h=>{const f=h.loaded,m=h.lengthComputable?h.total:-1;this.progressCallback_!==null&&this.progressCallback_(f,m)};this.progressCallback_!==null&&l.addUploadProgressListener(d),l.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&l.removeUploadProgressListener(d),this.pendingConnection_=null;const h=l.getErrorCode()===zl.NO_ERROR,f=l.getStatus();if(!h||hk(f,this.additionalRetryCodes_)&&this.retry){const b=l.getErrorCode()===zl.ABORT;r(!1,new kg(!1,null,b));return}const m=this.successCodes_.indexOf(f)!==-1;r(!0,new kg(m,l))})},t=(r,i)=>{const l=this.resolve_,d=this.reject_,h=i.connection;if(i.wasSuccessCode)try{const f=this.callback_(h,h.getResponse());SB(f)?l(f):l()}catch(f){d(f)}else if(h!==null){const f=I1();f.serverResponse=h.getErrorText(),this.errorCallback_?d(this.errorCallback_(h,f)):d(f)}else if(i.canceled){const f=this.appDelete_?ck():ok();d(f)}else{const f=ik();d(f)}};this.canceled_?t(!1,new kg(!1,null,!0)):this.backoffId_=_B(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&TB(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class kg{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function kB(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function CB(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function RB(s,e){e&&(s["X-Firebase-GMPID"]=e)}function DB(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function OB(s,e,t,r,i,l,d=!0,h=!1){const f=uk(s.urlParams),m=s.url+f,b=Object.assign({},s.headers);return RB(b,e),kB(b,t),CB(b,l),DB(b,r),new AB(m,s.method,b,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,i,d,h)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PB(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function MB(...s){const e=PB();if(e!==void 0){const t=new e;for(let r=0;r<s.length;r++)t.append(s[r]);return t.getBlob()}else{if(A1())return new Blob(s);throw new ps(is.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function LB(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VB(s){if(typeof atob>"u")throw jB("base-64");return atob(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class my{constructor(e,t){this.data=e,this.contentType=t||null}}function fk(s,e){switch(s){case Rr.RAW:return new my(mk(e));case Rr.BASE64:case Rr.BASE64URL:return new my(gk(s,e));case Rr.DATA_URL:return new my(FB(e),BB(e))}throw I1()}function mk(s){const e=[];for(let t=0;t<s.length;t++){let r=s.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const l=r,d=s.charCodeAt(++t);r=65536|(l&1023)<<10|d&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function UB(s){let e;try{e=decodeURIComponent(s)}catch{throw Zh(Rr.DATA_URL,"Malformed data URL.")}return mk(e)}function gk(s,e){switch(s){case Rr.BASE64:{const i=e.indexOf("-")!==-1,l=e.indexOf("_")!==-1;if(i||l)throw Zh(s,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Rr.BASE64URL:{const i=e.indexOf("+")!==-1,l=e.indexOf("/")!==-1;if(i||l)throw Zh(s,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=VB(e)}catch(i){throw i.message.includes("polyfill")?i:Zh(s,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class pk{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Zh(Rr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;r!=null&&(this.base64=zB(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function FB(s){const e=new pk(s);return e.base64?gk(Rr.BASE64,e.rest):UB(e.rest)}function BB(s){return new pk(s).contentType}function zB(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e,t){let r=0,i="";PT(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(PT(this.data_)){const r=this.data_,i=LB(r,e,t);return i===null?null:new mi(i)}else{const r=new Uint8Array(this.data_.buffer,e,t-e);return new mi(r,!0)}}static getBlob(...e){if(A1()){const t=e.map(r=>r instanceof mi?r.data_:r);return new mi(MB.apply(null,t))}else{const t=e.map(d=>Ap(d)?fk(Rr.RAW,d).data:d.data_);let r=0;t.forEach(d=>{r+=d.byteLength});const i=new Uint8Array(r);let l=0;return t.forEach(d=>{for(let h=0;h<d.length;h++)i[l++]=d[h]}),new mi(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k1(s){let e;try{e=JSON.parse(s)}catch{return null}return IB(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $B(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function qB(s,e){const t=e.split("/").filter(r=>r.length>0).join("/");return s.length===0?t:s+"/"+t}function xk(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HB(s,e){return e}class kn{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||HB}}let Cg=null;function GB(s){return!Ap(s)||s.length<2?s:xk(s)}function kp(){if(Cg)return Cg;const s=[];s.push(new kn("bucket")),s.push(new kn("generation")),s.push(new kn("metageneration")),s.push(new kn("name","fullPath",!0));function e(l,d){return GB(d)}const t=new kn("name");t.xform=e,s.push(t);function r(l,d){return d!==void 0?Number(d):d}const i=new kn("size");return i.xform=r,s.push(i),s.push(new kn("timeCreated")),s.push(new kn("updated")),s.push(new kn("md5Hash",null,!0)),s.push(new kn("cacheControl",null,!0)),s.push(new kn("contentDisposition",null,!0)),s.push(new kn("contentEncoding",null,!0)),s.push(new kn("contentLanguage",null,!0)),s.push(new kn("contentType",null,!0)),s.push(new kn("metadata","customMetadata",!0)),Cg=s,Cg}function WB(s,e){function t(){const r=s.bucket,i=s.fullPath,l=new _n(r,i);return e._makeStorageReference(l)}Object.defineProperty(s,"ref",{get:t})}function KB(s,e,t){const r={};r.type="file";const i=t.length;for(let l=0;l<i;l++){const d=t[l];r[d.local]=d.xform(r,e[d.server])}return WB(r,s),r}function bk(s,e,t){const r=k1(e);return r===null?null:KB(s,r,t)}function QB(s,e,t,r){const i=k1(e);if(i===null||!Ap(i.downloadTokens))return null;const l=i.downloadTokens;if(l.length===0)return null;const d=encodeURIComponent;return l.split(",").map(m=>{const b=s.bucket,y=s.fullPath,v="/b/"+d(b)+"/o/"+d(y),N=Wo(v,t,r),E=uk({alt:"media",token:m});return N+E})[0]}function C1(s,e){const t={},r=e.length;for(let i=0;i<r;i++){const l=e[i];l.writable&&(t[l.server]=s[l.local])}return JSON.stringify(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MT="prefixes",LT="items";function YB(s,e,t){const r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[MT])for(const i of t[MT]){const l=i.replace(/\/$/,""),d=s._makeStorageReference(new _n(e,l));r.prefixes.push(d)}if(t[LT])for(const i of t[LT]){const l=s._makeStorageReference(new _n(e,i.name));r.items.push(l)}return r}function XB(s,e,t){const r=k1(t);return r===null?null:YB(s,e,r)}class Oi{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fa(s){if(!s)throw I1()}function Cp(s,e){function t(r,i){const l=bk(s,i,e);return Fa(l!==null),l}return t}function JB(s,e){function t(r,i){const l=XB(s,e,i);return Fa(l!==null),l}return t}function ZB(s,e){function t(r,i){const l=bk(s,i,e);return Fa(l!==null),QB(l,i,s.host,s._protocol)}return t}function mu(s){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=gB():i=mB():t.getStatus()===402?i=fB(s.bucket):t.getStatus()===403?i=pB(s.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function Rp(s){const e=mu(s);function t(r,i){let l=e(r,i);return r.getStatus()===404&&(l=hB(s.path)),l.serverResponse=i.serverResponse,l}return t}function yk(s,e,t){const r=e.fullServerUrl(),i=Wo(r,s.host,s._protocol),l="GET",d=s.maxOperationRetryTime,h=new Oi(i,l,Cp(s,t),d);return h.errorHandler=Rp(e),h}function ez(s,e,t,r,i){const l={};e.isRoot?l.prefix="":l.prefix=e.path+"/",t.length>0&&(l.delimiter=t),r&&(l.pageToken=r),i&&(l.maxResults=i);const d=e.bucketOnlyServerUrl(),h=Wo(d,s.host,s._protocol),f="GET",m=s.maxOperationRetryTime,b=new Oi(h,f,JB(s,e.bucket),m);return b.urlParams=l,b.errorHandler=mu(e),b}function tz(s,e,t){const r=e.fullServerUrl(),i=Wo(r,s.host,s._protocol),l="GET",d=s.maxOperationRetryTime,h=new Oi(i,l,ZB(s,t),d);return h.errorHandler=Rp(e),h}function sz(s,e,t,r){const i=e.fullServerUrl(),l=Wo(i,s.host,s._protocol),d="PATCH",h=C1(t,r),f={"Content-Type":"application/json; charset=utf-8"},m=s.maxOperationRetryTime,b=new Oi(l,d,Cp(s,r),m);return b.headers=f,b.body=h,b.errorHandler=Rp(e),b}function nz(s,e){const t=e.fullServerUrl(),r=Wo(t,s.host,s._protocol),i="DELETE",l=s.maxOperationRetryTime;function d(f,m){}const h=new Oi(r,i,d,l);return h.successCodes=[200,204],h.errorHandler=Rp(e),h}function rz(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function vk(s,e,t){const r=Object.assign({},t);return r.fullPath=s.path,r.size=e.size(),r.contentType||(r.contentType=rz(null,e)),r}function az(s,e,t,r,i){const l=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function h(){let B="";for(let Q=0;Q<2;Q++)B=B+Math.random().toString().slice(2);return B}const f=h();d["Content-Type"]="multipart/related; boundary="+f;const m=vk(e,r,i),b=C1(m,t),y="--"+f+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+f+`\r
Content-Type: `+m.contentType+`\r
\r
`,v=`\r
--`+f+"--",N=mi.getBlob(y,r,v);if(N===null)throw lk();const E={name:m.fullPath},I=Wo(l,s.host,s._protocol),T="POST",L=s.maxUploadRetryTime,$=new Oi(I,T,Cp(s,t),L);return $.urlParams=E,$.headers=d,$.body=N.uploadData(),$.errorHandler=mu(e),$}class M0{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}}function R1(s,e){let t=null;try{t=s.getResponseHeader("X-Goog-Upload-Status")}catch{Fa(!1)}return Fa(!!t&&(e||["active"]).indexOf(t)!==-1),t}function iz(s,e,t,r,i){const l=e.bucketOnlyServerUrl(),d=vk(e,r,i),h={name:d.fullPath},f=Wo(l,s.host,s._protocol),m="POST",b={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":d.contentType,"Content-Type":"application/json; charset=utf-8"},y=C1(d,t),v=s.maxUploadRetryTime;function N(I){R1(I);let T;try{T=I.getResponseHeader("X-Goog-Upload-URL")}catch{Fa(!1)}return Fa(Ap(T)),T}const E=new Oi(f,m,N,v);return E.urlParams=h,E.headers=b,E.body=y,E.errorHandler=mu(e),E}function oz(s,e,t,r){const i={"X-Goog-Upload-Command":"query"};function l(m){const b=R1(m,["active","final"]);let y=null;try{y=m.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Fa(!1)}y||Fa(!1);const v=Number(y);return Fa(!isNaN(v)),new M0(v,r.size(),b==="final")}const d="POST",h=s.maxUploadRetryTime,f=new Oi(t,d,l,h);return f.headers=i,f.errorHandler=mu(e),f}const VT=256*1024;function lz(s,e,t,r,i,l,d,h){const f=new M0(0,0);if(d?(f.current=d.current,f.total=d.total):(f.current=0,f.total=r.size()),r.size()!==f.total)throw vB();const m=f.total-f.current;let b=m;i>0&&(b=Math.min(b,i));const y=f.current,v=y+b;let N="";b===0?N="finalize":m===b?N="upload, finalize":N="upload";const E={"X-Goog-Upload-Command":N,"X-Goog-Upload-Offset":`${f.current}`},I=r.slice(y,v);if(I===null)throw lk();function T(Q,Z){const Y=R1(Q,["active","final"]),C=f.current+b,P=r.size();let U;return Y==="final"?U=Cp(e,l)(Q,Z):U=null,new M0(C,P,Y==="final",U)}const L="POST",$=e.maxUploadRetryTime,B=new Oi(t,L,T,$);return B.headers=E,B.body=I.uploadData(),B.progressCallback=h||null,B.errorHandler=mu(s),B}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cz={STATE_CHANGED:"state_changed"},On={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function gy(s){switch(s){case"running":case"pausing":case"canceling":return On.RUNNING;case"paused":return On.PAUSED;case"success":return On.SUCCESS;case"canceled":return On.CANCELED;case"error":return On.ERROR;default:return On.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dz{constructor(e,t,r){if(EB(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{const l=e;this.next=l.next,this.error=l.error,this.complete=l.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ld(s){return(...e)=>{Promise.resolve().then(()=>s(...e))}}class uz{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=zl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=zl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=zl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i,l){if(this.sent_)throw Sh("cannot .send() more than once");if(Fo(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),l!==void 0)for(const d in l)l.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,l[d].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Sh("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Sh("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Sh("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Sh("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class hz extends uz{initXhr(){this.xhr_.responseType="text"}}function Da(){return new hz}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wk{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=kp(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(is.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const l=this.isExponentialBackoffExpired();if(hk(i.status,[]))if(l)i=ik();else{this.sleepTime=Math.max(this.sleepTime*2,uB),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(is.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,l)=>{this._resolve=i,this._reject=l,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{const r=iz(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Da,e,t);this._request=i,i.getPromise().then(l=>{this._request=void 0,this._uploadUrl=l,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,r)=>{const i=oz(this._ref.storage,this._ref._location,e,this._blob),l=this._ref.storage._makeRequest(i,Da,t,r);this._request=l,l.getPromise().then(d=>{d=d,this._request=void 0,this._updateProgress(d.current),this._needToFetchStatus=!1,d.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=VT*this._chunkMultiplier,t=new M0(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,l)=>{let d;try{d=lz(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(f){this._error=f,this._transition("error");return}const h=this._ref.storage._makeRequest(d,Da,i,l,!1);this._request=h,h.getPromise().then(f=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(f.current),f.finalized?(this._metadata=f.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){VT*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const r=yk(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Da,e,t);this._request=i,i.getPromise().then(l=>{this._request=void 0,this._metadata=l,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const r=az(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Da,e,t);this._request=i,i.getPromise().then(l=>{this._request=void 0,this._metadata=l,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=ok(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=gy(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){const l=new dz(t||void 0,r||void 0,i||void 0);return this._addObserver(l),()=>{this._removeObserver(l)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(gy(this._state)){case On.SUCCESS:ld(this._resolve.bind(null,this.snapshot))();break;case On.CANCELED:case On.ERROR:const t=this._reject;ld(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(gy(this._state)){case On.RUNNING:case On.PAUSED:e.next&&ld(e.next.bind(e,this.snapshot))();break;case On.SUCCESS:e.complete&&ld(e.complete.bind(e))();break;case On.CANCELED:case On.ERROR:e.error&&ld(e.error.bind(e,this._error))();break;default:e.error&&ld(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(e,t){this._service=e,t instanceof _n?this._location=t:this._location=_n.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new cc(e,t)}get root(){const e=new _n(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return xk(this._location.path)}get storage(){return this._service}get parent(){const e=$B(this._location.path);if(e===null)return null;const t=new _n(this._location.bucket,e);return new cc(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw dk(e)}}function fz(s,e,t){return s._throwIfRoot("uploadBytesResumable"),new wk(s,new mi(e),t)}function mz(s){const e={prefixes:[],items:[]};return jk(s,e).then(()=>e)}async function jk(s,e,t){const i=await Nk(s,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&await jk(s,e,i.nextPageToken)}function Nk(s,e){e!=null&&typeof e.maxResults=="number"&&pv("options.maxResults",1,1e3,e.maxResults);const t=e||{},r=ez(s.storage,s._location,"/",t.pageToken,t.maxResults);return s.storage.makeRequestWithTokens(r,Da)}function gz(s){s._throwIfRoot("getMetadata");const e=yk(s.storage,s._location,kp());return s.storage.makeRequestWithTokens(e,Da)}function pz(s,e){s._throwIfRoot("updateMetadata");const t=sz(s.storage,s._location,e,kp());return s.storage.makeRequestWithTokens(t,Da)}function xz(s){s._throwIfRoot("getDownloadURL");const e=tz(s.storage,s._location,kp());return s.storage.makeRequestWithTokens(e,Da).then(t=>{if(t===null)throw wB();return t})}function bz(s){s._throwIfRoot("deleteObject");const e=nz(s.storage,s._location);return s.storage.makeRequestWithTokens(e,Da)}function _k(s,e){const t=qB(s._location.path,e),r=new _n(s._location.bucket,t);return new cc(s.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yz(s){return/^[A-Za-z]+:\/\//.test(s)}function vz(s,e){return new cc(s,e)}function Tk(s,e){if(s instanceof D1){const t=s;if(t._bucket==null)throw yB();const r=new cc(t,t._bucket);return e!=null?Tk(r,e):r}else return e!==void 0?_k(s,e):s}function wz(s,e){if(e&&yz(e)){if(s instanceof D1)return vz(s,e);throw Id("To use ref(service, url), the first argument must be a Storage instance.")}else return Tk(s,e)}function UT(s,e){const t=e==null?void 0:e[ak];return t==null?null:_n.makeFromBucketSpec(t,s)}function jz(s,e,t,r={}){s.host=`${e}:${t}`;const i=Fo(e);i&&(Cv(`https://${s.host}/b`),Rv("Storage",!0)),s._isUsingEmulator=!0,s._protocol=i?"https":"http";const{mockUserToken:l}=r;l&&(s._overrideAuthToken=typeof l=="string"?l:yS(l,s.app.options.projectId))}class D1{constructor(e,t,r,i,l,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=l,this._isUsingEmulator=d,this._bucket=null,this._host=rk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=cB,this._maxUploadRetryTime=dB,this._requests=new Set,i!=null?this._bucket=_n.makeFromBucketSpec(i,this._host):this._bucket=UT(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=_n.makeFromBucketSpec(this._url,e):this._bucket=UT(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){pv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){pv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(as(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new cc(this,e)}_makeRequest(e,t,r,i,l=!0){if(this._deleted)return new NB(ck());{const d=OB(e,this._appId,r,i,t,this._firebaseVersion,l,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const FT="@firebase/storage",BT="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nz="storage";function _z(s,e,t){return s=Ge(s),fz(s,e,t)}function Tz(s){return s=Ge(s),gz(s)}function Sz(s,e){return s=Ge(s),pz(s,e)}function Ez(s,e){return s=Ge(s),Nk(s,e)}function Iz(s){return s=Ge(s),mz(s)}function Az(s){return s=Ge(s),xz(s)}function kz(s){return s=Ge(s),bz(s)}function zT(s,e){return s=Ge(s),wz(s,e)}function Cz(s,e){return _k(s,e)}function Rz(s,e,t,r={}){jz(s,e,t,r)}function Dz(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),r=s.getProvider("auth-internal"),i=s.getProvider("app-check-internal");return new D1(t,r,i,e,Ei)}function Oz(){Zn(new sn(Nz,Dz,"PUBLIC").setMultipleInstances(!0)),mn(FT,BT,""),mn(FT,BT,"esm2020")}Oz();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Rg(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new Rg(r,this,this._ref))},t)}on(e,t,r,i){let l;return t&&(typeof t=="function"?l=d=>t(new Rg(d,this,this._ref)):l={next:t.next?d=>t.next(new Rg(d,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,l,r||void 0,i||void 0)}}class qT{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new vi(e,this._service))}get items(){return this._delegate.items.map(e=>new vi(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=Cz(this._delegate,e);return new vi(t,this.storage)}get root(){return new vi(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return e==null?null:new vi(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new $T(_z(this._delegate,e,t),this)}putString(e,t=Rr.RAW,r){this._throwIfRoot("putString");const i=fk(t,e),l={...r};return l.contentType==null&&i.contentType!=null&&(l.contentType=i.contentType),new $T(new wk(this._delegate,new mi(i.data,!0),l),this)}listAll(){return Iz(this._delegate).then(e=>new qT(e,this.storage))}list(e){return Ez(this._delegate,e||void 0).then(t=>new qT(t,this.storage))}getMetadata(){return Tz(this._delegate)}updateMetadata(e){return Sz(this._delegate,e)}getDownloadURL(){return Az(this._delegate)}delete(){return this._throwIfRoot("delete"),kz(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw dk(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sk{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(HT(e))throw Id("ref() expected a child path but got a URL, use refFromURL instead.");return new vi(zT(this._delegate,e),this)}refFromURL(e){if(!HT(e))throw Id("refFromURL() expected a full URL but got a child path, use ref() instead.");try{_n.makeFromUrl(e,this._delegate.host)}catch{throw Id("refFromUrl() expected a valid full URL but got an invalid one.")}return new vi(zT(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){Rz(this._delegate,e,t,r)}}function HT(s){return/^[A-Za-z]+:\/\//.test(s)}const Pz="@firebase/storage-compat",Mz="0.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lz="storage-compat";function Vz(s,{instanceIdentifier:e}){const t=s.getProvider("app-compat").getImmediate(),r=s.getProvider("storage").getImmediate({identifier:e});return new Sk(t,r)}function Uz(s){const e={TaskState:On,TaskEvent:cz,StringFormat:Rr,Storage:Sk,Reference:vi};s.INTERNAL.registerComponent(new sn(Lz,Vz,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),s.registerVersion(Pz,Mz)}Uz(Mt);const Mh={project_id:"goo-now-1ce44",private_key_id:"56b453f3324317c51dbfacd19f32bb364f9b5a84",private_key:`-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC8LfXvjw05i6QA
eGMpaExBT38HlBOar3Ykux8w38ZlYL/1+X/HCe0n/QS2Sb7NVKBUGVFxWTjlX5aG
cGQeRYeSX9dJnohRE9IPbmu7I6YWX13mys6RSijKPQAxM7x9a9acVjbIaQyAP7V7
dwjnl4+ICb+QVMpkz4F87P2s9algCOYt5NY+1YNujoGzAfiiDl598Ib3hlnwwWiA
a52aDY51baXEa3LrrmYKDqxJDe59nAdVWZJS79h09m34lLHgVtPBWzhUnQ70dRhl
1ESI47dL2tEHb9wwgSMAB7iZv0Z59SwRHFr6+dsolzfcgZKWcwu2Gnno/NoV+CNT
Hvtis6K1AgMBAAECggEAAtcaFQK5OzWe2jz27jCQpL8Llp8xs+N9v9ctL4J+eZg+
EtCFu7OBfK7by9k4GTGeS+FSnTMwtybmsY0aYxSUk8KA5YUQNKe9GMDcvRHa12VF
bbmA6FN7YyC26Ic0i0YTPVUrICzpuePRnD/zMUpUfxlP5rXzlMBHCY4q1ASkiPpY
GIxWuV9ilT0lzbri2+a7CjJMRPLpffFJyt7fGcXqin0Fg8xGsXnsCeC1iEwXksDW
wqKGSqV7rShBfJxWvO1hn6cqUFuNlLTSmxeKE8w0RylIQNfQjJ1LMrv5fyo4SYUK
EFiUMFDhta6LLQ5j93XaYl4Ri2TwpmLGgm/DqNCpkQKBgQDtBuAYEQ2Uhv7W4wUA
+jnvbuZPDHFcLEFqUrXpu/vUoqTKRy7wG5vnD9NNr5gxPo9+wHKUevp67XftUmUv
pt9noy2bj+E4pIT22EUcTfLLXR4w31lZfszzWZoIzi9DT9ZEziv3T5/zm7ziW8HS
g4knJIK3dJ9BUzPFEegWk6YivQKBgQDLPhyysZHw5lY+tRELd0frLIraTAALIjNe
irUQIv4w8OA8Mvh9s2bGobM4CTscT3ZsghvDcGi1UEzceQa+Pb++qtl3c6IaI1G/
qTawUSAXMAaqY9qgFjQVatvgljFjjNAegKt+0+wJIpdtSXorV+52Te2IXNySVfWc
cTHdirA7WQKBgFdXz0BPGGgBDut0oKVpj+vRPAEpHqTOkhRyAiLtaLFEdeEsNfm4
0sxkooLgD/8lhI86r35TivW9iBHl6O+UWILCOM44SNAsn+qua1kwyCV0XOm5hB1c
gn2yKPbRs8zkIJseNkleCB0m6IWpNlUyr1nDNIAR85WI6WzXWmTnZ7MpAoGABbAF
SZLijKVFgJe8lF+QKaqjcBx0W9tnKJwlGQCBsIjtHYInpgzhMWnRBB5uAwrOO5cg
g8WfiINowzq3z5cWyJUrZMZdoPGgFgb8Os7qYPu9FAObWKOGbZsB8DUDyM9l+5SK
OBBiKJdJOYu22YOqbrEblpdSrN2u8+PPC24YJHECgYEAmLxOkqzcDiPHaoWBygRt
MMIctJTkgQfTzvLK0zWwBQIEd0hEe7J59g4gIepFQGFmX40hsVJKcgmk45EVfGSE
L2g2suJ5GV838jB0tioO0QQLo6RdDCfZ6Se6+Bp0AusZ4pg4Fe2q6dp/xVJQgcb/
G1UYnMbznK6Kq3HHG6lYCLU=
-----END PRIVATE KEY-----
`,client_email:"firebase-adminsdk-fbsvc@goo-now-1ce44.iam.gserviceaccount.com",token_uri:"https://oauth2.googleapis.com/token"};function xv(s){return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function Fz(s){const e=new Uint8Array(s);let t="";for(let r=0;r<e.byteLength;r++)t+=String.fromCharCode(e[r]);return xv(t)}function Bz(s){const e=window.atob(s),t=e.length,r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);return r.buffer}let Dg=null,GT=0;const Ek=async()=>{if(Dg&&Date.now()<GT)return Dg;try{const s={alg:"RS256",typ:"JWT"},e=Math.floor(Date.now()/1e3),t={iss:Mh.client_email,scope:"https://www.googleapis.com/auth/firebase.messaging",aud:Mh.token_uri,exp:e+3600,iat:e},r=xv(JSON.stringify(s)),i=xv(JSON.stringify(t)),l=`${r}.${i}`,d=Mh.private_key.replace(/-----BEGIN PRIVATE KEY-----/,"").replace(/-----END PRIVATE KEY-----/,"").replace(/\s/g,""),h=Bz(d),f=await window.crypto.subtle.importKey("pkcs8",h,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),m=await window.crypto.subtle.sign("RSASSA-PKCS1-v1_5",f,new TextEncoder().encode(l)),b=`${l}.${Fz(m)}`,v=await(await fetch(Mh.token_uri,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer&assertion=${b}`})).json();return v.access_token?(Dg=v.access_token,GT=Date.now()+v.expires_in*1e3-6e4,console.log("FCM V1 Token Generated successfully"),Dg):(console.error("Failed to generate FCM Token",v),null)}catch(s){return console.error("Error generating FCM V1 Token:",s),null}};let Zt,Ad,WT=!1;const zz=s=>(Ad||(Ad=Mt.auth()),new Mt.auth.RecaptchaVerifier(s,{size:"invisible",callback:()=>{console.log("Recaptcha resolved")}})),$z=async(s,e)=>(console.log(`[PhoneAuth] Initiating for ${s}...`),console.log("[PhoneAuth] Using Simulation Mode (Bypassing Billing/SMS)"),new Promise(t=>{setTimeout(()=>{t({success:!0,confirmationResult:{verificationId:"simulated-verification-id-"+Date.now(),confirm:async r=>{var i;if(r==="123456"){console.log("[PhoneAuth] Simulation Code Valid. Signing in anonymously..."),Ad||(Ad=Mt.auth());const l=await Ad.signInAnonymously();return{user:{...l.user,phoneNumber:s,uid:(i=l.user)==null?void 0:i.uid}}}else throw new Error("    ( 123456)")}}})},1500)})),Ha=(s,e=new WeakSet)=>{if(s==null)return null;if(typeof s!="object")return s;if(s instanceof Date)return s.toISOString();if(typeof s.toDate=="function")try{return s.toDate().toISOString()}catch{return null}if(Object.prototype.hasOwnProperty.call(s,"seconds")&&Object.prototype.hasOwnProperty.call(s,"nanoseconds"))return new Date(s.seconds*1e3).toISOString();if(e.has(s))return null;if(e.add(s),Array.isArray(s))return s.map(r=>Ha(r,e)).filter(r=>r!==void 0);const t={};for(const r in s)if(Object.prototype.hasOwnProperty.call(s,r)){const i=s[r];if(r.startsWith("_")||typeof i=="function")continue;const l=Ha(i,e);l!==void 0&&(t[r]=l)}return t},Ik=s=>{if(!Mt.apps.length)try{const e=Mt.initializeApp(s);if(Zt=e.firestore(),Ad=e.auth(),!WT){try{Zt.settings({ignoreUndefinedProperties:!0,merge:!0,cacheSizeBytes:Mt.firestore.CACHE_SIZE_UNLIMITED})}catch(t){console.warn("Firestore settings error (might be already applied):",t)}Zt.enablePersistence({synchronizeTabs:!0}).catch(t=>{t.code==="failed-precondition"?console.warn("Persistence failed: Multiple tabs open"):t.code==="unimplemented"&&console.warn("Persistence not supported by browser")}),WT=!0}return!0}catch(e){return console.error("Firebase Init Error:",e),!1}return Zt||(Zt=Mt.firestore()),!0},Hs=(s,e)=>{if(!Zt)return()=>{};const t=new Map;let r=!1;return Zt.collection(s).onSnapshot({includeMetadataChanges:!0},i=>{let l=!1;if(i.docChanges().forEach(d=>{if(l=!0,d.type==="removed")t.delete(d.doc.id);else{const h=d.doc.data(),f=Ha(h);t.set(d.doc.id,{id:d.doc.id,...f})}}),l||!r){r=!0;const d=Array.from(t.values());e(d)}},i=>console.error(`Subscription error [${s}]:`,i))},Lh=(s,e,t)=>{if(!Zt)return()=>{};let r=Zt.collection(s);e.forEach(d=>{r=r.where(d.field,d.op,d.value)});const i=new Map;let l=!1;return r.onSnapshot({includeMetadataChanges:!0},d=>{let h=!1;if(!l&&d.metadata.fromCache&&d.empty){console.log(`[QuerySubscription] Ignoring empty cache snapshot for ${s}`);return}if(d.docChanges().forEach(f=>{if(h=!0,f.type==="removed")i.delete(f.doc.id);else{const m=f.doc.data(),b=Ha(m);i.set(f.doc.id,{id:f.doc.id,...b})}}),h||!l){l=!0;const f=Array.from(i.values());t(f)}},d=>console.error(`Query Subscription error [${s}]:`,d))},Ia=async(s,e)=>{if(!Zt||e.length===0)return;const t=400,r=Ha(e);for(let i=0;i<r.length;i+=t){const l=r.slice(i,i+t),d=Zt.batch();l.forEach(h=>{if(!h.id)return;const f=Zt.collection(s).doc(String(h.id));d.set(f,{...h,serverUpdatedAt:Mt.firestore.FieldValue.serverTimestamp()},{merge:!0})}),await d.commit()}},at=async(s,e,t)=>{if(!Zt)return;const r=Ha(t);return await Zt.collection(s).doc(e).set({...r,serverUpdatedAt:Mt.firestore.FieldValue.serverTimestamp()},{merge:!0})},Js=async(s,e)=>{if(!(!Zt||!e))return await Zt.collection(s).doc(String(e)).delete()},L0=async(s,e)=>{if(!Zt)return;const t=Ha(e);return await Zt.collection(s).add({...t,serverUpdatedAt:Mt.firestore.FieldValue.serverTimestamp()})},Ak=async s=>{if(!Zt)return{success:!1,error:"Firebase DB not not initialized"};try{const e=await Zt.collection("users").doc(s).get();if(e.exists)return{success:!0,data:{id:e.id,...e.data()}};const t=await Zt.collection("users").where("phone","==",s).limit(1).get();if(!t.empty){const r=t.docs[0];return{success:!0,data:{id:r.id,...r.data()}}}return{success:!1,error:"not_found"}}catch(e){return console.error("Error fetching user:",e),{success:!1,error:"network_error"}}},py=700*1024,kk=async(s,e="files",t)=>{if(!Zt)throw new Error("Firebase DB not initialized");return new Promise((r,i)=>{const l=new FileReader;l.onload=async d=>{var h;try{const f=((h=d.target)==null?void 0:h.result).split(",")[1],m=Math.ceil(f.length/py),b=`FILE-${Date.now()}`;await Zt.collection("stored_files").doc(b).set({name:s.name,size:s.size,type:s.type,totalChunks:m,createdAt:Mt.firestore.FieldValue.serverTimestamp(),isChunked:!0});for(let y=0;y<m;y++){const v=f.slice(y*py,(y+1)*py);await Zt.collection("stored_files").doc(b).collection("chunks").doc(y.toString()).set({data:v,index:y});const N=Math.round((y+1)/m*100);t&&t(N),console.log(`[Firestore Upload] Chunk ${y+1}/${m} uploaded.`)}r(`FIRESTORE_FILE:${b}`)}catch(f){console.error("Firestore chunk upload failed:",f),i(f)}},l.onerror=d=>i(d),l.readAsDataURL(s)})},Dp=async s=>{if(!Zt)throw new Error("Firebase DB not initialized");const e=await Zt.collection("stored_files").doc(s).get();if(!e.exists)throw new Error("File not found");const t=e.data();if(!t)throw new Error("File metadata missing");const r=await Zt.collection("stored_files").doc(s).collection("chunks").orderBy("index").get();let i="";r.forEach(m=>{i+=m.data().data});const l=atob(i),d=new Array(l.length);for(let m=0;m<l.length;m++)d[m]=l.charCodeAt(m);const h=new Uint8Array(d),f=new Blob([h],{type:t.type||"application/vnd.android.package-archive"});return URL.createObjectURL(f)},O1=async(s,e="updates",t)=>{if(!Mt.apps.length)throw new Error("Firebase not initialized");const r=Mt.app();if(r.options.storageBucket)try{console.log(`[Upload] Attempting Storage upload to ${r.options.storageBucket}...`);const d=Mt.storage().ref().child(`${e}/${Date.now()}_${s.name}`),h={contentType:s.type||"application/vnd.android.package-archive"},f=d.put(s,h);return await new Promise((m,b)=>{f.on("state_changed",y=>{const v=y.bytesTransferred/y.totalBytes*100;t&&t(v)},y=>{console.warn("[Storage Upload Failed] Switching to Firestore fallback...",y),b(y)},()=>{f.snapshot.ref.getDownloadURL().then(m).catch(b)})})}catch{console.log("Storage failed, trying Firestore Chunking...")}else console.log("No storage bucket defined. Using Firestore Chunking...");return await kk(s,e,t)},qt=async(s,e)=>{try{const t=s.toLowerCase();let r=t;t==="customer"&&(r="user");let i="";e.targetId&&e.targetId!=="all"&&e.targetId!=="multiple"?i=`${r}_${e.targetId}_v2`:r==="admin"?i="admin_v2":i=`${r}s_v2`,console.log(`[Notification] Preparing to send to topic: ${i}`);const l=await Ek();if(!l)return console.error("[Notification] Failed to generate access token"),!1;console.log("[Notification] Access Token generated successfully.");const d=Mh.project_id,h={message:{topic:i,notification:{title:e.title,body:e.body},data:{type:"order_update",url:e.url||"/",title:e.title,body:e.body,target_id:e.targetId||"",timestamp:new Date().toISOString(),sound:"default"},android:{priority:"HIGH",ttl:"2419200s",notification:{channel_id:"high_importance_channel_v2",sound:"default",default_sound:!0,default_vibrate_timings:!0,notification_priority:"PRIORITY_HIGH",visibility:"PUBLIC"}},apns:{headers:{"apns-priority":"10"},payload:{aps:{sound:"default",badge:1,"content-available":1}}}}},f=await fetch(`https://fcm.googleapis.com/v1/projects/${d}/messages:send`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify(h)});if(f.ok)return console.log(`[Notification] Sent successfully to ${i}`),!0;{const m=await f.text();return console.error(`[Notification] FCM Error: ${m}`),!1}}catch(t){return console.error("[Notification] Failed to send:",t),!1}},bv=async s=>{try{if(!Mt.messaging.isSupported())return;const t=await Mt.messaging().getToken({vapidKey:"YOUR_VAPID_KEY_IF_NEEDED"});if(!t){console.warn("[WebNotification] No FCM token available.");return}const r=await Ek();if(!r)return;const i=await fetch(`https://iid.googleapis.com/iid/v1/${t}/rel/topics/${s}`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});i.ok?console.log(`[WebNotification] Subscribed content-available to ${s}`):console.error(`[WebNotification] Failed to subscribe to ${s}:`,await i.text())}catch(e){console.error("[WebNotification] Subscription Error:",e)}},KT=Object.freeze(Object.defineProperty({__proto__:null,addData:L0,batchSaveData:Ia,deepClean:Ha,deleteData:Js,downloadFileFromFirestore:Dp,getUser:Ak,initFirebase:Ik,sendExternalNotification:qt,setupRecaptcha:zz,signInWithPhone:$z,subscribeToCollection:Hs,subscribeToQuery:Lh,subscribeWebToTopic:bv,updateData:at,uploadFile:O1,uploadFileToFirestore:kk},Symbol.toStringTag,{value:"Module"})),xy=({title:s,value:e,subValue:t,icon:r,color:i,trend:l,trendValue:d})=>n.jsxs("div",{className:"bg-gray-800 border border-gray-700 p-5 rounded-2xl shadow-lg relative overflow-hidden group",children:[n.jsx("div",{className:`absolute top-0 right-0 w-24 h-24 ${i} opacity-5 blur-3xl -mr-10 -mt-10 group-hover:opacity-10 transition-opacity`}),n.jsxs("div",{className:"flex justify-between items-start relative z-10",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-500 text-xs font-bold uppercase tracking-wider mb-1",children:s}),n.jsx("h3",{className:"text-2xl font-black text-white",children:e}),t&&n.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:t})]}),n.jsx("div",{className:`p-3 rounded-xl bg-gray-900/50 border border-gray-700 ${i.replace("bg-","text-")}`,children:r})]}),l&&n.jsxs("div",{className:"mt-4 flex items-center gap-1 relative z-10",children:[l==="up"?n.jsx(lS,{className:"w-3 h-3 text-green-500"}):n.jsx(B3,{className:"w-3 h-3 text-red-500"}),n.jsx("span",{className:`text-[10px] font-bold ${l==="up"?"text-green-500":"text-red-500"}`,children:d}),n.jsx("span",{className:"text-[10px] text-gray-600",children:" "})]})]}),qz=({isOpen:s,onClose:e,type:t,users:r,onGenerate:i})=>{const[l,d]=w.useState(""),[h,f]=w.useState("all"),[m,b]=w.useState(""),[y,v]=w.useState(""),[N,E]=w.useState("");Wt(()=>s?(e(),!0):!1,[s]);const I=w.useMemo(()=>r.filter(L=>{var $,B;return(L==null?void 0:L.role)===t&&((($=L==null?void 0:L.name)==null?void 0:$.toLowerCase().includes(N.toLowerCase()))||((B=L==null?void 0:L.phone)==null?void 0:B.includes(N)))}),[r,t,N]);if(!s)return null;const T=()=>{l&&(i(l,{type:h,start:h==="custom"?m:void 0,end:h==="custom"?y:void 0}),e())};return n.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-2xl border border-gray-700 shadow-2xl overflow-hidden animate-pop-in flex flex-col max-h-[85vh]",onClick:L=>L.stopPropagation(),children:[n.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[n.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[t==="driver"?n.jsx(Ut,{className:"w-5 h-5 text-blue-400"}):n.jsx(Xn,{className:"w-5 h-5 text-purple-400"}),t==="driver"?"  ":"  "]}),n.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white p-1 rounded-full hover:bg-gray-800",children:n.jsx(rt,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto custom-scrollbar",children:[n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:"text-xs font-bold text-gray-400 block",children:[" ",t==="driver"?"":""]}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"text",placeholder:"   ...",value:N,onChange:L=>E(L.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-3 px-4 pl-10 text-white text-sm focus:border-blue-500 outline-none"}),n.jsx(Ln,{className:"absolute left-3 top-3.5 w-4 h-4 text-gray-500"})]}),n.jsx("div",{className:"max-h-40 overflow-y-auto bg-[#0f172a] border border-gray-600 rounded-xl custom-scrollbar",children:I.length>0?I.map(L=>n.jsxs("button",{onClick:()=>d(L.id),className:`w-full flex items-center justify-between p-3 text-right hover:bg-gray-800 border-b border-gray-700/50 last:border-0 transition-colors ${l===L.id?"bg-blue-900/20 text-blue-400":"text-gray-300"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden",children:L.storeImage?n.jsx("img",{src:L.storeImage,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-4 h-4"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-bold",children:L.name}),n.jsx("p",{className:"text-[10px] opacity-70 font-mono",children:L.phone})]})]}),l===L.id&&n.jsx(Xe,{className:"w-4 h-4"})]},L.id)):n.jsx("p",{className:"p-4 text-center text-xs text-gray-500",children:"  "})})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("label",{className:"text-xs font-bold text-gray-400 block",children:" "}),n.jsxs("div",{className:"flex bg-[#0f172a] p-1 rounded-xl border border-gray-600",children:[n.jsx("button",{onClick:()=>f("all"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${h==="all"?"bg-blue-600 text-white shadow-md":"text-gray-400 hover:text-white"}`,children:"  "}),n.jsx("button",{onClick:()=>f("custom"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${h==="custom"?"bg-blue-600 text-white shadow-md":"text-gray-400 hover:text-white"}`,children:" "})]}),h==="custom"&&n.jsxs("div",{className:"grid grid-cols-2 gap-3 animate-fadeIn",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-[10px] text-gray-500 mb-1 block",children:""}),n.jsx("input",{type:"date",value:m,onChange:L=>b(L.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-lg py-2 px-3 text-white text-xs outline-none focus:border-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-[10px] text-gray-500 mb-1 block",children:""}),n.jsx("input",{type:"date",value:y,onChange:L=>v(L.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-lg py-2 px-3 text-white text-xs outline-none focus:border-blue-500"})]})]})]})]}),n.jsx("div",{className:"p-5 border-t border-gray-700 bg-[#151e2d]",children:n.jsxs("button",{onClick:T,disabled:!l||h==="custom"&&(!m||!y),className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:text-gray-500 text-white font-bold py-3.5 rounded-xl shadow-lg transition-all active:scale-95 flex items-center justify-center gap-2",children:[n.jsx(Mr,{className:"w-5 h-5"})," "]})})]})})},Hz=({isOpen:s,onClose:e,reportData:t})=>{if(Wt(()=>s?(e(),!0):!1,[s]),!s||!t)return null;const{user:r,orders:i,summary:l,dateLabel:d}=t,h=(r==null?void 0:r.role)==="driver",f=m=>{if(!m)return"---";try{let b;return m.seconds?b=new Date(m.seconds*1e3):b=new Date(m),isNaN(b.getTime())?"---":b.toLocaleString("ar-EG-u-nu-latn",{month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0})}catch{return"---"}};return n.jsx("div",{className:"fixed inset-0 z-[100] bg-black/90 backdrop-blur-sm flex items-center justify-center p-0 sm:p-4 animate-fadeIn",onClick:e,children:n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-2xl h-full sm:h-auto sm:max-h-[90vh] sm:rounded-2xl border-x-0 sm:border border-gray-700 shadow-2xl overflow-hidden animate-slide-up flex flex-col",onClick:m=>m.stopPropagation(),children:[n.jsxs("div",{className:"p-5 border-b border-gray-700 bg-[#151e2d] flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"text-xl font-black text-white flex items-center gap-2",children:[r.name,n.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded border ${h?"bg-blue-500/10 text-blue-400 border-blue-500/20":"bg-purple-500/10 text-purple-400 border-purple-500/20"}`,children:h?"":""})]}),n.jsxs("p",{className:"text-xs text-gray-400 mt-1 flex items-center gap-1",children:[n.jsx(Ba,{className:"w-3 h-3"}),d]})]}),n.jsx("button",{onClick:e,className:"bg-gray-800 p-2 rounded-full text-gray-400 hover:text-white transition-colors",children:n.jsx(rt,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-5 space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[n.jsxs("div",{className:"bg-gray-800 p-3 rounded-xl border border-gray-700 text-center",children:[n.jsx("p",{className:"text-[10px] text-gray-500 font-bold mb-1",children:" "}),n.jsx("p",{className:"text-xl font-black text-white",children:l.count})]}),n.jsxs("div",{className:"bg-gray-800 p-3 rounded-xl border border-gray-700 text-center",children:[n.jsx("p",{className:"text-[10px] text-gray-500 font-bold mb-1",children:" "}),n.jsxs("p",{className:"text-xl font-black text-green-400",children:[l.totalRevenue.toLocaleString("en-US")," ",n.jsx("span",{className:"text-[10px]",children:"."})]})]}),n.jsxs("div",{className:"bg-gray-800 p-3 rounded-xl border border-gray-700 text-center",children:[n.jsx("p",{className:"text-[10px] text-gray-500 font-bold mb-1",children:" "}),n.jsxs("p",{className:"text-xl font-black text-blue-400",children:[l.totalDelivery.toLocaleString("en-US")," ",n.jsx("span",{className:"text-[10px]",children:"."})]})]}),n.jsxs("div",{className:"bg-gray-800 p-3 rounded-xl border border-gray-700 text-center",children:[n.jsx("p",{className:"text-[10px] text-gray-500 font-bold mb-1",children:h?" ":" "}),n.jsxs("p",{className:`text-xl font-black ${h?"text-yellow-400":"text-red-400"}`,children:[h?l.driverEarnings.toLocaleString("en-US"):l.appCommission.toLocaleString("en-US")," ",n.jsx("span",{className:"text-[10px]",children:"."})]})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("h4",{className:"text-sm font-bold text-white flex items-center gap-2",children:[n.jsx(Mr,{className:"w-4 h-4 text-gray-400"})," "]}),i.length>0?i.map(m=>{var b,y,v;return n.jsxs("div",{className:"bg-[#252525] p-4 rounded-2xl border border-white/5 flex flex-col gap-3 shadow-md hover:border-white/10 transition-all",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"font-mono text-sm text-blue-400 font-black bg-blue-900/10 px-2 py-0.5 rounded border border-blue-500/20",children:["#",m.id]}),n.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full font-bold ${m.status===ce.Delivered?"bg-green-500/10 text-green-400":m.status===ce.Cancelled?"bg-red-500/10 text-red-400":"bg-yellow-500/10 text-yellow-400"}`,children:m.status})]}),n.jsxs("div",{className:"flex flex-col items-end",children:[n.jsx("p",{className:"text-xs text-gray-400",children:" "}),n.jsxs("p",{className:"text-sm font-bold text-white",children:[(b=m.totalPrice)==null?void 0:b.toLocaleString("en-US")," ."]})]})]}),n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(pn,{className:"w-4 h-4 text-gray-500 mt-0.5 flex-shrink-0"}),n.jsx("p",{className:"text-xs text-gray-300 leading-relaxed",children:h?` : ${m.merchantName}`:` : ${(y=m.customer)==null?void 0:y.address}`})]}),n.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-gray-700 mt-1 bg-black/20 -mx-4 -mb-4 px-4 py-3 rounded-b-2xl",children:[n.jsxs("div",{className:"flex items-center gap-1.5 text-gray-400 text-[10px]",children:[n.jsx(xt,{className:"w-3 h-3"}),n.jsx("span",{className:"dir-ltr",children:f(m.deliveredAt||m.createdAt)})]}),h&&n.jsxs("div",{className:"flex items-center gap-2 bg-green-900/20 px-3 py-1 rounded-lg border border-green-500/20",children:[n.jsx("span",{className:"text-[10px] text-green-300 font-bold",children:" :"}),n.jsxs("span",{className:"text-sm font-black text-green-400",children:[((v=m.deliveryFee)==null?void 0:v.toLocaleString("en-US"))||0," ."]})]})]})]},m.id)}):n.jsx("div",{className:"text-center py-10 text-gray-500 bg-gray-800/30 rounded-xl border border-dashed border-gray-700",children:"     "})]})]})]})})},QT=s=>{const e=new Date(s);return e.getHours()<6&&e.setDate(e.getDate()-1),e.setHours(0,0,0,0),e},Gz=({isOpen:s,onClose:e,orders:t,users:r})=>{const i=w.useMemo(()=>{if(!s)return null;const l=QT(new Date),d=t.filter(T=>{const L=T.createdAt.seconds?new Date(T.createdAt.seconds*1e3):new Date(T.createdAt);return QT(L).getTime()===l.getTime()}),h=d.filter(T=>T.status===ce.Delivered),f=d.filter(T=>T.status===ce.Cancelled),m=d.filter(T=>T.status===ce.Pending),b=h.reduce((T,L)=>T+(L.totalPrice||0),0),y=h.reduce((T,L)=>T+(L.deliveryFee||0),0);let v=0;const N={};h.forEach(T=>{const L=r.find($=>($==null?void 0:$.id)===T.driverId);if(L){let $=0;L.commissionType==="fixed"?$=L.commissionRate||0:$=(T.deliveryFee||0)*((L.commissionRate||0)/100),$>0&&(v+=$),N[L.id]||(N[L.id]={name:L.name,count:0,total:0}),N[L.id].count+=1,N[L.id].total+=T.deliveryFee||0}});const E=Object.values(N).sort((T,L)=>L.count-T.count).slice(0,5),I=v*.15;return{date:l,count:d.length,deliveredCount:h.length,cancelledCount:f.length,pendingCount:m.length,totalRevenue:b,totalDeliveryFees:y,totalCommission:v,adminShare:I,topDrivers:E}},[s,t,r]);return!s||!i?null:n.jsx("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:n.jsxs("div",{className:"bg-[#0f172a] w-full max-w-3xl max-h-[90vh] rounded-3xl border border-gray-800 shadow-2xl overflow-hidden flex flex-col",onClick:l=>l.stopPropagation(),children:[n.jsxs("div",{className:"px-6 py-4 border-b border-gray-800 bg-[#1e293b] flex justify-between items-center sticky top-0 z-10",children:[n.jsx("div",{children:n.jsxs("h2",{className:"text-xl font-black text-white flex items-center gap-2",children:[" ",n.jsx("span",{className:"text-[10px] bg-blue-600/20 text-blue-300 px-2 py-0.5 rounded border border-blue-500/20",children:i.date.toLocaleDateString("ar-EG",{weekday:"long",day:"numeric",month:"short"})})]})}),n.jsx("button",{onClick:e,className:"p-1.5 bg-gray-800 rounded-lg text-gray-400 hover:text-white transition-all",children:n.jsx(rt,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-5 space-y-6 custom-scrollbar",children:[n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[n.jsxs("div",{className:"bg-gray-800/40 p-3 rounded-xl border border-gray-700/50 flex flex-col items-center",children:[n.jsx("span",{className:"text-[10px] text-gray-500 font-bold mb-1",children:""}),n.jsx("span",{className:"text-2xl font-black text-white",children:i.count})]}),n.jsxs("div",{className:"bg-green-500/5 p-3 rounded-xl border border-green-500/10 flex flex-col items-center",children:[n.jsx("span",{className:"text-[10px] text-green-500/70 font-bold mb-1",children:""}),n.jsx("span",{className:"text-2xl font-black text-green-400",children:i.deliveredCount})]}),n.jsxs("div",{className:"bg-red-500/5 p-3 rounded-xl border border-red-500/10 flex flex-col items-center",children:[n.jsx("span",{className:"text-[10px] text-red-500/70 font-bold mb-1",children:""}),n.jsx("span",{className:"text-2xl font-black text-red-400",children:i.cancelledCount})]}),n.jsxs("div",{className:"bg-yellow-500/5 p-3 rounded-xl border border-yellow-500/10 flex flex-col items-center",children:[n.jsx("span",{className:"text-[10px] text-yellow-500/70 font-bold mb-1",children:""}),n.jsx("span",{className:"text-2xl font-black text-yellow-400",children:i.pendingCount})]})]}),n.jsx("div",{className:"bg-[#161f32] rounded-2xl p-5 border border-gray-800 relative overflow-hidden",children:n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-y-4 gap-x-8 relative z-10",children:[n.jsxs("div",{className:"flex justify-between items-center border-b border-gray-700/50 pb-2",children:[n.jsx("span",{className:"text-xs text-gray-400",children:" "}),n.jsxs("span",{className:"text-lg font-bold text-white",children:[i.totalRevenue.toLocaleString()," ",n.jsx("span",{className:"text-[10px] text-gray-600",children:"."})]})]}),n.jsxs("div",{className:"flex justify-between items-center border-b border-gray-700/50 pb-2",children:[n.jsx("span",{className:"text-xs text-gray-400",children:" "}),n.jsxs("span",{className:"text-lg font-bold text-blue-400",children:[i.totalDeliveryFees.toLocaleString()," ",n.jsx("span",{className:"text-[10px] text-gray-600",children:"."})]})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-xs text-gray-400",children:"  ()"}),n.jsxs("span",{className:"text-xl font-black text-green-400",children:[i.totalCommission.toLocaleString()," ",n.jsx("span",{className:"text-[10px] text-gray-600",children:"."})]})]}),n.jsxs("div",{className:"flex justify-between items-center bg-orange-900/10 -m-1 p-1 px-3 rounded-lg border border-orange-500/10",children:[n.jsx("span",{className:"text-xs text-orange-400 font-bold",children:"  (15%)"}),n.jsxs("span",{className:"text-lg font-black text-orange-400",children:[i.adminShare.toLocaleString()," ",n.jsx("span",{className:"text-[10px]",children:"."})]})]})]})}),n.jsxs("div",{children:[n.jsxs("h3",{className:"text-sm font-bold text-gray-400 mb-3 flex items-center gap-2",children:[n.jsx(Ut,{className:"w-4 h-4"})," "]}),n.jsx("div",{className:"space-y-2",children:i.topDrivers.length>0?i.topDrivers.slice(0,3).map((l,d)=>n.jsxs("div",{className:"flex items-center justify-between p-2.5 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-6 h-6 rounded bg-gray-700 flex items-center justify-center text-xs font-bold text-white",children:d+1}),n.jsx("span",{className:"text-xs font-bold text-gray-300",children:l.name})]}),n.jsxs("span",{className:"text-xs font-bold text-blue-400",children:[l.count," "]})]},d)):n.jsx("p",{className:"text-xs text-gray-600 text-center py-2",children:"  "})})]})]})]})})},Og=s=>s.toLocaleString("en-US",{maximumFractionDigits:1}),Ck=({orders:s,users:e,payments:t,currentUser:r})=>{const i=w.useMemo(()=>s.filter(S=>!S.isArchived),[s]),[l,d]=w.useState(!1),[h,f]=w.useState("driver"),[m,b]=w.useState(!1),[y,v]=w.useState(null),[N,E]=w.useState(!1),[I,T]=w.useState(!1),[L,$]=w.useState(!1),[B,Q]=w.useState(!1),[Z,Y]=w.useState([]),[C,P]=w.useState(null);w.useEffect(()=>{if(B){const S=Hs("monthly_reports",ae=>{const K=ae.sort((k,q)=>q.createdAt.getTime()-k.createdAt.getTime());Y(K)});return()=>S()}},[B]);const U=async()=>{T(!0);try{const S=new Date,K=`${["","","","","","","","","","","",""][S.getMonth()]} ${S.getFullYear()}`,k=[...i];if(k.length===0){alert("   ."),T(!1),$(!1);return}const q=k.filter(We=>We.id.startsWith("ORD-")),W=k.filter(We=>We.id.startsWith("S-")),ne=(We,it)=>{const ke=We.reduce((et,ge)=>{const ee=ge.id.replace(it,""),fe=parseInt(ee||"0");return Math.max(et,fe)},0);return ke>0?`${it}${ke}`:`${it}0`},M=ne(q,"ORD-"),R=ne(W,"S-"),V=k.filter(We=>We.status===ce.Delivered),X=k.filter(We=>We.status===ce.Cancelled);let H=0,se=0,J=0;const oe={};V.forEach(We=>{const it=e.find(et=>et.id===We.driverId);H+=We.totalPrice||0,se+=We.deliveryFee||0;let ke=0;if(it&&(it.commissionType==="fixed"?ke=it.commissionRate||0:ke=(We.deliveryFee||0)*((it.commissionRate||0)/100)),ke>0&&(J+=ke),it&&!oe[it.id]){const et=V.filter(_e=>_e.driverId===it.id&&!_e.reconciled),ge=et.reduce((_e,Me)=>_e+(Me.deliveryFee||0),0);let ee=0;et.forEach(_e=>{it.commissionType==="fixed"?ee+=it.commissionRate||0:ee+=(_e.deliveryFee||0)*((it.commissionRate||0)/100)});const fe=ge-ee;oe[it.id]={name:it.name,role:"driver",balance:fe,ordersCount:et.length}}});const je={id:`ARCHIVE_${S.getTime()}`,month:S.getMonth(),year:S.getFullYear(),monthLabel:K,totalRevenue:H,totalDeliveryFees:se,totalAppProfit:J,adminShare:J*.15,totalDriverPayouts:se-J,createdAt:S,archivedOrdersCount:k.length,deliveredOrdersCount:V.length,cancelledOrdersCount:X.length,lastRegularOrderId:M,lastShoppingOrderId:R,walletSnapshots:oe,archivedBy:r.id};await L0("monthly_reports",je);const ye=400,Pe=[];await L0("monthly_reports",newReport);for(const We of userUpdates)await at("users",We.id,{walletOpeningBalance:We.walletOpeningBalance});const Fe=archivedOrders.map(We=>({id:We.id,isArchived:!0,archiveMonth:newReport.monthLabel}));await Ia("orders",Fe);const lt=t.filter(We=>{var it;return!((it=We.reconciledOrderIds)!=null&&it.includes("ARCHIVED"))}).map(We=>({id:We.id,reconciledOrderIds:["ARCHIVED"]}));await Ia("payments",lt),$(!1),window.location.reload()}catch(S){console.error("Archive Failed:",S),alert("   ")}finally{T(!1)}},O=w.useMemo(()=>{const S=i.filter(X=>X.status===ce.Delivered),ae=S.reduce((X,H)=>X+(H.totalPrice||0),0),K=S.reduce((X,H)=>X+(H.deliveryFee||0),0);let k=0;S.forEach(X=>{const H=e.find(se=>(se==null?void 0:se.id)===X.driverId);if(H){let se=0;H.commissionType==="fixed"?se=H.commissionRate||0:se=(X.deliveryFee||0)*((H.commissionRate||0)/100),se>0&&(k+=se)}});const q=new Date,W=q.getMonth(),ne=q.getFullYear(),M=S.filter(X=>{var se;const H=(se=X.deliveredAt)!=null&&se.seconds?new Date(X.deliveredAt.seconds*1e3):new Date(X.deliveredAt||X.createdAt);return H.getMonth()===W&&H.getFullYear()===ne}),R=M.reduce((X,H)=>X+(H.totalPrice||0),0);let V=0;return M.forEach(X=>{const H=e.find(se=>(se==null?void 0:se.id)===X.driverId);if(H){let se=0;H.commissionType==="fixed"?se=H.commissionRate||0:se=(X.deliveryFee||0)*((H.commissionRate||0)/100),se>0&&(V+=se)}}),{orderCount:i.length,deliveredCount:S.length,cancelledCount:i.filter(X=>X.status===ce.Cancelled).length,pendingCount:i.filter(X=>X.status===ce.Pending).length,totalRevenue:ae,totalDeliveryFees:K,totalCommission:k,merchantsCount:e.filter(X=>(X==null?void 0:X.role)==="merchant").length,driversCount:e.filter(X=>(X==null?void 0:X.role)==="driver").length,monthlyRevenue:R,monthlyCommission:V,commission15PercentTotal:k*.15,commission15PercentMonthly:V*.15}},[i,e]),D=S=>{f(S),d(!0)},F=(S,ae)=>{const K=e.find(X=>(X==null?void 0:X.id)===S);if(!K)return;let k=i.filter(X=>K.role==="driver"?X.driverId===S:X.merchantId===S),q="  ";if(ae.type==="custom"&&ae.start&&ae.end){const X=new Date(ae.start),H=new Date(ae.end);H.setHours(23,59,59),k=k.filter(se=>{const J=new Date(se.createdAt);return J>=X&&J<=H}),q=` ${ae.start}  ${ae.end}`}const W=k.filter(X=>X.status===ce.Delivered),ne=W.reduce((X,H)=>X+(H.totalPrice||0),0),M=W.reduce((X,H)=>X+(H.deliveryFee||0),0);let R=0,V=0;K.role==="driver"&&(K.commissionType==="fixed"?R=W.reduce((X,H)=>{let se=0;return K.commissionType==="fixed"?se=K.commissionRate||0:se=(H.deliveryFee||0)*((K.commissionRate||0)/100),X+se},0):R=W.reduce((X,H)=>{const se=(H.deliveryFee||0)*((K.commissionRate||0)/100);return X+se},0),V=M-R),v({user:K,orders:k.sort((X,H)=>{const se=X.createdAt.seconds?X.createdAt.seconds:new Date(X.createdAt).getTime();return(H.createdAt.seconds?H.createdAt.seconds:new Date(H.createdAt).getTime())-se}),summary:{count:k.length,totalRevenue:ne,totalDelivery:M,appCommission:R,driverEarnings:V},dateLabel:q}),b(!0)};return n.jsxs("div",{className:"space-y-8 pb-32 animate-fadeIn relative",children:[n.jsxs("div",{className:"flex flex-col gap-6 border-b border-gray-700 pb-6",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"p-4 bg-red-600 rounded-2xl shadow-xl shadow-red-900/20",children:n.jsx(Ef,{className:"w-8 h-8 text-white"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-3xl font-black text-white tracking-tight",children:" "}),n.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"    "})]})]}),n.jsxs("div",{className:"flex gap-3 flex-wrap",children:[r.role==="admin"&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>$(!0),className:"flex-1 bg-red-900/40 hover:bg-red-900/60 border border-red-800 rounded-xl p-3 flex items-center justify-center gap-2 transition-all active:scale-95 group shadow-lg shadow-red-900/20",children:[n.jsx("div",{className:"p-2 bg-red-500/20 rounded-full group-hover:bg-red-500/30",children:n.jsx(jt,{className:"w-5 h-5 text-red-400"})}),n.jsx("span",{className:"text-sm font-bold text-white",children:"  "})]}),n.jsxs("button",{onClick:()=>Q(!0),className:"flex-1 bg-gray-800 hover:bg-gray-700 border border-gray-700 rounded-xl p-3 flex items-center justify-center gap-2 transition-all active:scale-95 group",children:[n.jsx("div",{className:"p-2 bg-gray-700/50 rounded-full group-hover:bg-gray-600",children:n.jsx(xt,{className:"w-5 h-5 text-gray-300"})}),n.jsx("span",{className:"text-sm font-bold text-gray-200",children:" "})]}),n.jsxs("button",{onClick:()=>E(!0),className:"flex-1 bg-gradient-to-r from-blue-900 to-blue-800 hover:from-blue-800 hover:to-blue-700 border border-blue-700 rounded-xl p-3 flex items-center justify-center gap-2 transition-all active:scale-95 group shadow-lg shadow-blue-900/30",children:[n.jsx("div",{className:"p-2 bg-blue-500/20 rounded-full group-hover:bg-blue-500/30",children:n.jsx(Mr,{className:"w-5 h-5 text-blue-200"})}),n.jsx("span",{className:"text-sm font-bold text-white",children:"  "})]})]}),n.jsxs("button",{onClick:()=>D("driver"),className:"flex-1 bg-gray-800 hover:bg-gray-700 border border-gray-700 rounded-xl p-3 flex items-center justify-center gap-2 transition-all active:scale-95 group",children:[n.jsx("div",{className:"p-2 bg-blue-500/10 rounded-full group-hover:bg-blue-500/20",children:n.jsx(Ut,{className:"w-5 h-5 text-blue-400"})}),n.jsx("span",{className:"text-sm font-bold text-gray-200",children:" "})]}),n.jsxs("button",{onClick:()=>D("merchant"),className:"flex-1 bg-gray-800 hover:bg-gray-700 border border-gray-700 rounded-xl p-3 flex items-center justify-center gap-2 transition-all active:scale-95 group",children:[n.jsx("div",{className:"p-2 bg-purple-500/10 rounded-full group-hover:bg-purple-500/20",children:n.jsx(Xn,{className:"w-5 h-5 text-purple-400"})}),n.jsx("span",{className:"text-sm font-bold text-gray-200",children:" "})]})]})]}),r.role==="admin"&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[n.jsx(xy,{title:" ",value:`${O.totalRevenue.toLocaleString("en-US")} .`,subValue:"    ",icon:n.jsx(eu,{className:"w-6 h-6"}),color:"bg-green-500",trend:"up",trendValue:"+12%"}),n.jsx(xy,{title:" ",value:`${O.totalDeliveryFees.toLocaleString("en-US")} .`,subValue:"   ",icon:n.jsx(Ut,{className:"w-6 h-6"}),color:"bg-blue-500"}),n.jsx(xy,{title:" ",value:`${O.totalCommission.toLocaleString("en-US")} .`,subValue:"    ",icon:n.jsx(lS,{className:"w-6 h-6"}),color:"bg-red-500",trend:"up",trendValue:"+5%"})]}),r.role==="admin"&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsx("div",{className:"bg-gradient-to-br from-purple-900/50 to-purple-800/30 p-5 rounded-2xl border border-purple-500/30 relative overflow-hidden",children:n.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[n.jsx("div",{className:"p-3 bg-purple-500/20 rounded-xl text-purple-300",children:n.jsx(Ba,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-purple-200 font-bold mb-1",children:"   "}),n.jsxs("h3",{className:"text-2xl font-black text-white",children:[O.totalCommission.toLocaleString("en-US")," ",n.jsx("span",{className:"text-sm font-normal text-purple-300",children:"."})]})]})]})}),n.jsx("div",{className:"bg-gradient-to-br from-orange-900/50 to-orange-800/30 p-5 rounded-2xl border border-orange-500/30 relative overflow-hidden",children:n.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[n.jsx("div",{className:"p-3 bg-orange-500/20 rounded-xl text-orange-300",children:n.jsx(B0,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-orange-200 font-bold mb-1",children:"  ( )"}),n.jsxs("h3",{className:"text-2xl font-black text-white",children:[O.commission15PercentTotal.toLocaleString("en-US")," ",n.jsx("span",{className:"text-sm font-normal text-orange-300",children:"."})]})]})]})})]}),n.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-2xl border border-gray-700 flex flex-col items-center text-center",children:[n.jsx(Xe,{className:"w-8 h-8 text-green-500 mb-2"}),n.jsx("span",{className:"text-2xl font-black text-white",children:O.deliveredCount}),n.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase",children:" "})]}),n.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-2xl border border-gray-700 flex flex-col items-center text-center",children:[n.jsx(xt,{className:"w-8 h-8 text-yellow-500 mb-2"}),n.jsx("span",{className:"text-2xl font-black text-white",children:O.pendingCount}),n.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase",children:" "})]}),n.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-2xl border border-gray-700 flex flex-col items-center text-center",children:[n.jsx(rt,{className:"w-8 h-8 text-red-500 mb-2"}),n.jsx("span",{className:"text-2xl font-black text-white",children:O.cancelledCount}),n.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase",children:" "})]}),n.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-2xl border border-gray-700 flex flex-col items-center text-center",children:[n.jsx(Zd,{className:"w-8 h-8 text-purple-500 mb-2"}),n.jsx("span",{className:"text-2xl font-black text-white",children:e.length}),n.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase",children:" "})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[n.jsxs("div",{className:"bg-gray-800 p-6 rounded-3xl border border-gray-700 shadow-xl",children:[n.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2",children:[n.jsx(Xn,{className:"w-5 h-5 text-purple-400"})," "]}),n.jsx("div",{className:"space-y-4",children:["restaurant","market","pharmacy"].map(S=>{const ae=e.filter(k=>(k==null?void 0:k.role)==="merchant"&&k.storeCategory===S).length,K=O.merchantsCount>0?ae/O.merchantsCount*100:0;return n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-400",children:[n.jsx("span",{children:S==="restaurant"?"":S==="market"?" ":""}),n.jsx("span",{className:"text-white",children:ae})]}),n.jsx("div",{className:"h-2 bg-gray-900 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-purple-600 transition-all duration-1000",style:{width:`${K}%`}})})]},S)})})]}),n.jsxs("div",{className:"bg-gray-800 p-6 rounded-3xl border border-gray-700 shadow-xl",children:[n.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2",children:[n.jsx(Ut,{className:"w-5 h-5 text-blue-400"})," "]}),n.jsxs("div",{className:"flex flex-col justify-center h-full",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 rounded-2xl mb-3 border border-white/5",children:[n.jsx("span",{className:"text-sm text-gray-400 font-bold",children:"  "}),n.jsx("span",{className:"text-xl font-black text-blue-400",children:O.deliveredCount>0?(O.deliveredCount/Math.max(O.driversCount,1)).toFixed(1):0})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 rounded-2xl border border-white/5",children:[n.jsx("span",{className:"text-sm text-gray-400 font-bold",children:"  "}),n.jsxs("span",{className:"text-xl font-black text-green-400",children:[O.orderCount>0?(O.deliveredCount/O.orderCount*100).toFixed(0):0,"%"]})]})]})]})]}),n.jsx(qz,{isOpen:l,onClose:()=>d(!1),type:h,users:e,onGenerate:F}),n.jsx(Hz,{isOpen:m,onClose:()=>b(!1),reportData:y}),L&&n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[n.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:()=>!I&&$(!1)}),n.jsx("div",{className:"bg-[#1a1a1a] rounded-3xl w-full max-w-md p-6 border border-red-500/30 relative z-10 animate-scaleIn shadow-2xl shadow-red-900/20",children:n.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[n.jsx("div",{className:"p-4 bg-red-500/10 rounded-full animate-pulse",children:n.jsx($3,{className:"w-12 h-12 text-red-500"})}),n.jsx("h3",{className:"text-2xl font-black text-white",children:"     "}),n.jsxs("p",{className:"text-gray-400 font-medium leading-relaxed",children:["   ",n.jsx("span",{className:"text-red-400 font-bold",children:"   "}),"     .",n.jsx("br",{}),"           ."]}),n.jsxs("div",{className:"w-full bg-red-900/20 border border-red-900/50 rounded-xl p-4 mt-2",children:[n.jsxs("div",{className:"flex justify-between items-center mb-2 text-red-200 text-sm font-bold",children:[n.jsx("span",{children:"  "}),n.jsxs("span",{children:[O.totalCommission.toLocaleString("en-US")," ."]})]}),n.jsxs("div",{className:"flex justify-between items-center text-red-200 text-sm font-bold",children:[n.jsx("span",{children:"  (15%)"}),n.jsxs("span",{children:[O.commission15PercentTotal.toLocaleString("en-US")," ."]})]})]}),n.jsxs("div",{className:"flex w-full gap-3 mt-4",children:[n.jsx("button",{onClick:U,disabled:I,className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-3 rounded-xl transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:I?" ...":"    "}),n.jsx("button",{onClick:()=>$(!1),disabled:I,className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 rounded-xl transition-all",children:""})]})]})})]}),B&&n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[n.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md",onClick:()=>Q(!1)}),n.jsxs("div",{className:"bg-[#121212] rounded-3xl w-full max-w-4xl max-h-[85vh] flex flex-col border border-gray-800 relative z-10 animate-scaleIn",children:[n.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-[#1a1a1a] rounded-t-3xl",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"text-2xl font-black text-white flex items-center gap-3",children:[n.jsx(xt,{className:"w-8 h-8 text-blue-500"}),"  "]}),n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"     "})]}),n.jsx("button",{onClick:()=>Q(!1),className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:n.jsx(rt,{className:"w-6 h-6 text-gray-400"})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-6 scrollbar-hide",children:n.jsx("div",{className:"grid gap-4",children:Z.length===0?n.jsx("div",{className:"text-center py-20 text-gray-500",children:n.jsx("p",{children:"     "})}):Z.map(S=>n.jsxs("div",{className:"bg-[#1a1a1a] border border-gray-800 p-5 rounded-2xl hover:border-gray-600 transition-colors group",children:[n.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"p-3 bg-blue-500/10 rounded-xl",children:n.jsx(Ba,{className:"w-6 h-6 text-blue-400"})}),n.jsxs("div",{children:[n.jsxs("h4",{className:"text-lg font-bold text-white",children:["  ",S.month+1," / ",S.year]}),n.jsxs("p",{className:"text-xs text-gray-500",children:["   ",new Date(S.createdAt).toLocaleDateString("ar-EG")]})]})]}),n.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-500/10 rounded-full border border-green-500/20",children:[n.jsx("span",{className:"text-xs text-green-400 font-bold",children:""}),n.jsx(Xe,{className:"w-4 h-4 text-green-500"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-black/40 p-3 rounded-xl border border-white/5",children:[n.jsx("p",{className:"text-xs text-gray-400 mb-1",children:" "}),n.jsx("p",{className:"text-lg font-bold text-white",children:Og(S.totalRevenue)})]}),n.jsxs("div",{className:"bg-black/40 p-3 rounded-xl border border-white/5",children:[n.jsx("p",{className:"text-xs text-gray-400 mb-1",children:" "}),n.jsx("p",{className:"text-lg font-bold text-blue-400",children:Og(S.totalDeliveryFees)})]}),n.jsxs("div",{className:"bg-black/40 p-3 rounded-xl border border-white/5",children:[n.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"  "}),n.jsx("p",{className:"text-lg font-bold text-green-400",children:Og(S.totalAppProfit)})]}),n.jsxs("div",{className:"bg-black/40 p-3 rounded-xl border border-white/5",children:[n.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"  (15%)"}),n.jsx("p",{className:"text-lg font-bold text-orange-400",children:Og(S.totalAppProfit*.15)})]})]})]},S.id))})})]})]}),n.jsx(Gz,{isOpen:N,onClose:()=>E(!1),orders:i,users:e})]})},Wz=({title:s,message:e,placeholder:t="",defaultValue:r="",inputType:i="text",onClose:l,onConfirm:d,confirmButtonText:h="",cancelButtonText:f=""})=>{const[m,b]=w.useState(!1),[y,v]=w.useState(r),N=w.useRef(null);w.useEffect(()=>{requestAnimationFrame(()=>b(!0)),setTimeout(()=>{var L,$;(L=N.current)==null||L.focus(),r&&(($=N.current)==null||$.select())},100)},[]),Wt(()=>(E(),!0));const E=()=>{b(!1),setTimeout(l,200)},I=()=>{y.trim()&&(b(!1),setTimeout(()=>d(y),200))},T=L=>{L.key==="Enter"&&I(),L.key==="Escape"&&E()};return z0.createPortal(n.jsx("div",{className:`fixed inset-0 z-[110] flex items-center justify-center p-4 transition-all duration-300 ease-out ${m?"backdrop-blur-[2px] bg-black/60":"opacity-0 pointer-events-none"}`,onClick:E,style:{touchAction:"none"},children:n.jsxs("div",{className:`
            w-full max-w-sm bg-[#1e293b] rounded-2xl border border-gray-700/50 shadow-2xl 
            transform transition-all duration-300 ease-[cubic-bezier(0.34,1.56,0.64,1)] relative overflow-hidden
            ${m?"scale-100 translate-y-0 opacity-100":"scale-90 translate-y-10 opacity-0"}
        `,onClick:L=>L.stopPropagation(),children:[n.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-blue-500"}),n.jsxs("div",{className:"p-6",children:[n.jsx("h3",{className:"text-xl font-bold text-white mb-2 text-center",children:s}),n.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-6 text-center",children:e}),n.jsx("div",{className:"relative mb-6",children:n.jsx("input",{ref:N,type:i,value:y,onChange:L=>v(L.target.value),onKeyDown:T,placeholder:t,className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-3 px-4 text-white text-center focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition-all font-mono text-lg",dir:"ltr"})}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{type:"button",onClick:I,className:"flex-1 py-3 px-4 rounded-xl bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white font-bold text-sm shadow-lg shadow-blue-900/30 transform transition-transform active:scale-95",children:h}),n.jsx("button",{type:"button",onClick:E,className:"flex-1 py-3 px-4 rounded-xl bg-gray-700/50 hover:bg-gray-700 text-gray-300 font-bold text-sm border border-gray-600/50 transition-colors active:scale-95",children:f})]})]})]})}),document.body)},Kz=({isOpen:s,onClose:e,title:t,message:r,onConfirm:i,confirmText:l="",cancelText:d="",type:h="danger"})=>s?n.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fadeIn",children:n.jsx("div",{className:"bg-[#1e293b] border border-white/10 rounded-2xl w-full max-w-sm p-6 shadow-2xl animate-scaleIn",children:n.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[n.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${h==="danger"?"bg-red-500/10 text-red-500":"bg-blue-500/10 text-blue-500"}`,children:h==="danger"?n.jsx(jt,{className:"w-6 h-6"}):n.jsx(Ao,{className:"w-6 h-6"})}),n.jsx("h3",{className:"text-lg font-bold text-white",children:t}),n.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:r}),n.jsxs("div",{className:"flex gap-3 w-full mt-2",children:[n.jsx("button",{onClick:e,className:"flex-1 px-4 py-2.5 rounded-xl border border-white/10 text-gray-400 hover:bg-white/5 transition-colors font-medium text-sm",children:d}),n.jsx("button",{onClick:()=>{i(),e()},className:`flex-1 px-4 py-2.5 rounded-xl font-bold text-white shadow-lg transition-transform active:scale-95 text-sm ${h==="danger"?"bg-red-600 hover:bg-red-500 shadow-red-500/20":"bg-blue-600 hover:bg-blue-500 shadow-blue-500/20"}`,children:l})]})]})})}):null,Pg=({active:s,label:e,icon:t,onClick:r})=>n.jsxs("button",{onClick:r,className:`relative flex items-center gap-2 px-6 py-4 transition-all duration-300 ${s?"text-blue-400":"text-gray-400 hover:text-gray-200"}`,children:[n.jsx(t,{className:`w-4 h-4 ${s?"animate-bounce-slow":""}`}),n.jsx("span",{className:"font-bold text-sm tracking-wide",children:e}),s&&n.jsx("span",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-transparent via-blue-500 to-transparent shadow-[0_-2px_8px_rgba(59,130,246,0.5)] animate-width-expand"})]}),Nl=({onClick:s,label:e,icon:t,variant:r="primary",loading:i=!1,disabled:l=!1,className:d=""})=>{const h={primary:"bg-blue-600 hover:bg-blue-500 border-blue-500/50 text-white shadow-blue-900/20",danger:"bg-red-600/10 hover:bg-red-600/20 border-red-500/30 text-red-500 hover:text-red-400",secondary:"bg-gray-800 hover:bg-gray-700 border-gray-700 text-gray-300"};return n.jsxs("button",{onClick:s,disabled:l||i,className:`flex items-center justify-center gap-2 px-4 py-2 rounded-lg border text-xs font-bold transition-all active:scale-[0.98] shadow-lg disabled:opacity-50 disabled:cursor-not-allowed ${h[r]} ${d}`,children:[i?n.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):t&&n.jsx(t,{className:"w-4 h-4"}),n.jsx("span",{children:e})]})},Qz=({active:s})=>n.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-[10px] font-bold border ${s?"bg-emerald-500/10 text-emerald-400 border-emerald-500/20":"bg-gray-500/10 text-gray-400 border-gray-500/20"}`,children:[n.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${s?"bg-emerald-500 animate-pulse":"bg-gray-500"}`}),s?" ":" "]}),Yz=({message:s,type:e,onClose:t})=>(w.useEffect(()=>{const r=setTimeout(t,4e3);return()=>clearTimeout(r)},[t]),n.jsxs("div",{className:`fixed bottom-6 left-1/2 -translate-x-1/2 z-[100] flex items-center gap-3 px-6 py-3 rounded-full border backdrop-blur-xl shadow-2xl animate-slide-up ${e==="success"?"bg-emerald-900/80 border-emerald-500/30 text-emerald-100":e==="error"?"bg-red-900/80 border-red-500/30 text-red-100":"bg-blue-900/80 border-blue-500/30 text-blue-100"}`,children:[e==="success"?n.jsx(Xe,{className:"w-5 h-5"}):e==="error"?n.jsx(rt,{className:"w-5 h-5"}):n.jsx(Ao,{className:"w-5 h-5"}),n.jsx("span",{className:"text-sm font-medium",children:s})]})),Xz=({currentUser:s})=>{const[e,t]=w.useState("updates"),[r,i]=w.useState(!1),[l,d]=w.useState(null),[h,f]=w.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),[m,b]=w.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{},onClose:()=>{}}),y=(H,se,J="",oe="text",je="")=>new Promise(ye=>{b({isOpen:!0,title:H,message:se,defaultValue:J,inputType:oe,placeholder:je,onConfirm:Pe=>{b(Fe=>({...Fe,isOpen:!1})),ye(Pe)},onClose:()=>{b(Pe=>({...Pe,isOpen:!1})),ye(null)}})}),[v,N]=w.useState("GOO NOW"),[E,I]=w.useState("1.0.0"),[T,L]=w.useState(""),[$,B]=w.useState(""),[Q,Z]=w.useState(""),[Y,C]=w.useState([]),[P,U]=w.useState(!1),[O,D]=w.useState(0),[F,S]=w.useState([]),ae=w.useRef(null);w.useEffect(()=>{const H=Hs("system_metadata",J=>{const oe=J.find(je=>je.id==="config");oe&&(N(oe.appName||""),I(oe.appVersion||""))}),se=Hs("app_updates",J=>{S(J.sort((oe,je)=>new Date(je.timestamp).getTime()-new Date(oe.timestamp).getTime()))});return()=>{H(),se()}},[]);const K=(H,se)=>d({msg:H,type:se}),k=(H,se,J,oe="danger")=>{f({isOpen:!0,title:H,message:se,onConfirm:J,type:oe})},q=async()=>{if(!v||!E)return K("   ","error");try{await at("system_metadata","config",{appName:v,appVersion:E,updatedAt:new Date().toISOString()}),K("  ","success")}catch{K(" ","error")}},W=async H=>{var J;const se=(J=H.target.files)==null?void 0:J[0];if(se){U(!0),D(0);try{const oe=await O1(se,`updates/${se.name}`,je=>{D(Math.round(je))});B(oe),K("   ","success")}catch(oe){console.error(oe),K("  ","error")}finally{U(!1),D(100)}}},ne=async()=>{if(!T||!$)return K("   ","error");if(Y.length===0)return K("       ( Admin )","error");k("  ",`     ${T} : ${Y.join(" ")}.   `,async()=>{try{const H={version:T,url:$,notes:Q,target_roles:Y,timestamp:new Date().toISOString(),isActive:!0,forceUpdate:!0};await L0("app_updates",H),await at("settings","app_update",{...H,id:"app_update"});for(const se of Y)await qt(se,{title:` ${T} `,body:"    ",url:"/?target=main"});K("   ","success"),L(""),B(""),C([])}catch{K("   ","error")}},"info")},M=async H=>{k(" ","         .",async()=>{try{await Js("app_updates",H),K(" ","success")}catch{K(" ","error")}})},R=async()=>{k("  ","      .   ",async()=>{await Js("settings","app_update"),K("  ","success")})},V=async()=>{const H=new Date,se=new Date(H.getFullYear(),H.getMonth(),1).toISOString().split("T")[0],J=await y("  ","  (YYYY-MM-DD).        **  :",se,"text","YYYY-MM-DD");if(!J)return;const oe=new Date(J);if(isNaN(oe.getTime()))return K("  ","error");k("   ",`         ${J}.

  (  )  .

  `,async()=>{K(" ...","info");try{const je=Mt.firestore.Timestamp.fromDate(oe),ye=await Mt.firestore().collection("orders").where("createdAt","<",je).get();if(ye.empty)return K("     ","info");const Pe=400;let Fe=Mt.firestore().batch(),Re=0,lt=0;for(const We of ye.docs)Fe.delete(We.ref),Re++,Re>=Pe&&(await Fe.commit(),Fe=Mt.firestore().batch(),lt+=Re,Re=0);Re>0&&(await Fe.commit(),lt+=Re),K(`  ${lt}   .`,"success"),setTimeout(()=>window.location.reload(),2e3)}catch(je){console.error(je),K("   ","error")}},"danger")},X=async()=>{const H=await y("  ","      ( ):","6","number");if(!H)return;const se=await y("  ","      ( ):","10000","number");if(!se)return;const J=parseInt(H),oe=parseInt(se);if(isNaN(J)||isNaN(oe)||J>oe)return K("  ","error");k("   ",`        ${J}  ${oe} ().

    .

  `,async()=>{K("  ...","info");try{const je=await Mt.firestore().collection("orders").get(),ye=400;let Pe=Mt.firestore().batch(),Fe=0,Re=0;const lt=je.docs.filter(We=>{const ke=We.data().id||"",et=parseInt(ke.replace(/\D/g,"")||"0");return et>=J&&et<=oe});if(lt.length===0)return K("     ","info");for(const We of lt)Pe.delete(We.ref),Fe++,Fe>=ye&&(await Pe.commit(),Pe=Mt.firestore().batch(),Re+=Fe,Fe=0);Fe>0&&(await Pe.commit(),Re+=Fe),K(`  ${Re}    ${J}-${oe}.`,"success"),setTimeout(()=>window.location.reload(),2e3)}catch(je){console.error(je),K("   ","error")}},"danger")};return n.jsxs("div",{className:"flex flex-col min-h-screen bg-[#0f172a] text-white font-sans selection:bg-blue-500/30",children:[n.jsx("div",{className:"sticky top-0 z-40 bg-[#1e293b]/80 backdrop-blur-md border-b border-white/5 shadow-xl",children:n.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6",children:[n.jsxs("div",{className:"flex items-center justify-between h-16 border-b border-white/5 mb-1",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-tr from-blue-600 to-indigo-600 flex items-center justify-center shadow-lg shadow-blue-500/20",children:n.jsx(hn,{className:"w-5 h-5 text-white"})}),n.jsx("h1",{className:"text-lg font-black tracking-tight text-white",children:" "})]}),n.jsxs("div",{className:"text-xs font-mono text-gray-500",children:[v," v",E]})]}),n.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto no-scrollbar",children:[n.jsx(Pg,{active:e==="updates",onClick:()=>t("updates"),label:" ",icon:Ft}),n.jsx(Pg,{active:e==="general",onClick:()=>t("general"),label:"",icon:F3}),n.jsx(Pg,{active:e==="maintenance",onClick:()=>t("maintenance"),label:" ",icon:Mb}),n.jsx(Pg,{active:e==="database",onClick:()=>t("database"),label:" ",icon:H3})]})]})}),n.jsx("div",{className:"flex-1 p-4 sm:p-8 overflow-y-auto",children:n.jsxs("div",{className:"max-w-4xl mx-auto animate-fadeIn",children:[e==="general"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-[#1e293b] border border-white/5 rounded-2xl p-6 shadow-xl",children:[n.jsxs("h2",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[n.jsx("div",{className:"w-1 h-5 bg-blue-500 rounded-full"}),"  "]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-xs text-gray-400 font-bold uppercase",children:" "}),n.jsx("input",{value:v,onChange:H=>N(H.target.value),className:"w-full bg-[#0f172a] border border-gray-700/50 rounded-lg px-4 py-3 text-sm focus:border-blue-500 outline-none transition-colors"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-xs text-gray-400 font-bold uppercase",children:" "}),n.jsx("input",{value:E,onChange:H=>I(H.target.value),className:"w-full bg-[#0f172a] border border-gray-700/50 rounded-lg px-4 py-3 text-sm focus:border-blue-500 outline-none transition-colors"})]})]}),n.jsx("div",{className:"mt-8 flex justify-end",children:n.jsx(Nl,{label:" ",icon:W3,onClick:q})})]}),n.jsxs("div",{className:"bg-[#1e293b] border border-white/5 rounded-2xl p-6 shadow-xl",children:[n.jsx("h3",{className:"font-bold text-lg mb-4 text-gray-300",children:" "}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(Nl,{label:" ",variant:"danger",icon:jt,onClick:R}),n.jsx(Nl,{label:" ",variant:"secondary",icon:ef,onClick:()=>window.location.reload()})]})]})]}),e==="maintenance"&&n.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[n.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-2xl p-6 text-center",children:[n.jsx("h2",{className:"text-xl font-bold text-red-500 mb-2",children:"  / "}),n.jsx("p",{className:"text-gray-400 text-sm",children:"      .   ."})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-[#1e293b] border border-white/5 rounded-2xl p-6 shadow-xl hover:border-blue-500/30 transition-all group",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-500/10 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:n.jsx(jt,{className:"w-6 h-6 text-blue-400"})}),n.jsx("h3",{className:"font-bold text-lg text-white mb-2",children:"  "}),n.jsxs("p",{className:"text-sm text-gray-400 leading-relaxed mb-6",children:["      .   ",n.jsx("strong",{children:""}),"          ."]}),n.jsx(Nl,{label:"  ...",variant:"primary",icon:Xe,onClick:V,className:"w-full justify-center py-3 bg-blue-600 hover:bg-blue-500"})]}),n.jsxs("div",{className:"bg-[#1e293b] border border-white/5 rounded-2xl p-6 shadow-xl hover:border-amber-500/30 transition-all group",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-amber-500/10 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:n.jsx(Mb,{className:"w-6 h-6 text-amber-500"})}),n.jsx("h3",{className:"font-bold text-lg text-white mb-2",children:"  "}),n.jsx("p",{className:"text-sm text-gray-400 leading-relaxed mb-6",children:"     (  6  1000)        ."}),n.jsx(Nl,{label:"  ...",variant:"danger",icon:jt,onClick:X,className:"w-full justify-center py-3"})]}),n.jsxs("div",{className:"bg-[#1e293b] border border-white/5 rounded-2xl p-6 shadow-xl opacity-60",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-700/30 flex items-center justify-center mb-4",children:n.jsx(Mb,{className:"w-6 h-6 text-gray-400"})}),n.jsx("h3",{className:"font-bold text-lg text-gray-300 mb-2",children:"  "}),n.jsx("p",{className:"text-sm text-gray-500 leading-relaxed mb-6",children:"      . (  )"}),n.jsx("button",{disabled:!0,className:"w-full py-3 rounded-lg border border-gray-700 text-gray-600 font-bold text-xs cursor-not-allowed",children:" "})]})]})]}),e==="updates"&&n.jsxs("div",{className:"space-y-8",children:[n.jsx("div",{className:"bg-gradient-to-br from-[#1e293b] to-[#0f172a] border border-white/5 rounded-2xl p-6 shadow-2xl relative overflow-hidden",children:n.jsxs("div",{className:"relative z-10 grid grid-cols-1 lg:grid-cols-2 gap-8",children:[n.jsxs("div",{className:"space-y-5",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-xs text-gray-400 font-bold uppercase",children:"  (SemVer)"}),n.jsxs("div",{className:"relative",children:[n.jsx(Ao,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),n.jsx("input",{placeholder:"e.g. 2.1.0",value:T,onChange:H=>L(H.target.value),className:"w-full bg-[#0f172a] border border-gray-700/50 rounded-lg pl-10 pr-4 py-3 text-sm focus:border-blue-500 outline-none font-mono"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-xs text-gray-400 font-bold uppercase",children:" APK"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{value:$,onChange:H=>B(H.target.value),placeholder:" ...",className:"flex-1 bg-[#0f172a] border border-gray-700/50 rounded-lg px-4 py-3 text-xs text-gray-300 focus:border-blue-500 outline-none"}),n.jsx("button",{onClick:()=>{var H;return(H=ae.current)==null?void 0:H.click()},className:`px-4 rounded-lg border border-gray-600 hover:bg-white/5 transition-colors flex items-center gap-2 ${P?"cursor-wait opacity-70":""}`,children:P?n.jsxs("span",{className:"text-xs font-bold text-blue-400",children:[O,"%"]}):n.jsx(gr,{className:"w-5 h-5 text-gray-400"})}),n.jsx("input",{type:"file",ref:ae,accept:".apk",hidden:!0,onChange:W})]}),P&&n.jsx("div",{className:"w-full h-1 bg-gray-800 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-blue-500 transition-all duration-200",style:{width:`${O}%`}})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-xs text-gray-400 font-bold uppercase",children:""}),n.jsx("textarea",{value:Q,onChange:H=>Z(H.target.value),className:"w-full h-24 bg-[#0f172a] border border-gray-700/50 rounded-lg px-4 py-3 text-sm focus:border-blue-500 outline-none resize-none",placeholder:" ..."})]})]}),n.jsxs("div",{className:"space-y-5 flex flex-col justify-between",children:[n.jsxs("div",{className:"space-y-3",children:[n.jsx("label",{className:"text-xs text-gray-400 font-bold uppercase block text-amber-500",children:"   "}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:["driver","merchant","supervisor","admin"].map(H=>n.jsxs("button",{onClick:()=>C(se=>se.includes(H)?se.filter(J=>J!==H):[...se,H]),className:`px-3 py-2 rounded-lg text-xs font-bold border transition-all flex items-center justify-center gap-2 ${Y.includes(H)?"bg-blue-500/20 border-blue-500 text-blue-400":"bg-[#0f172a] border-gray-700 text-gray-500 hover:border-gray-500"}`,children:[Y.includes(H)&&n.jsx(Xe,{className:"w-3 h-3"}),H.toUpperCase()]},H))}),n.jsx("p",{className:"text-[10px] text-gray-500 leading-tight",children:"*  'ADMIN'      ."})]}),n.jsx(Nl,{label:`  ${T||"..."}`,icon:Ft,className:"w-full py-4 text-sm bg-gradient-to-r from-blue-600 to-indigo-600 border-none",onClick:ne})]})]})}),n.jsxs("div",{className:"bg-[#1e293b] border border-white/5 rounded-2xl overflow-hidden shadow-xl",children:[n.jsx("div",{className:"bg-[#0f172a]/50 p-4 border-b border-white/5",children:n.jsx("h3",{className:"font-bold text-sm text-gray-300",children:" "})}),n.jsxs("div",{className:"max-h-64 overflow-y-auto",children:[F.map(H=>n.jsxs("div",{className:"p-4 border-b border-white/5 flex items-center justify-between hover:bg-white/5 transition-colors group",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"w-10 h-10 rounded-lg bg-blue-500/10 flex items-center justify-center font-mono font-bold text-blue-400 text-sm",children:["v",H.version]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-bold text-sm text-white",children:new Date(H.timestamp).toLocaleDateString("ar-EG")}),n.jsx(Qz,{active:H.isActive})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-0.5 line-clamp-1",children:H.notes||"No notes"})]})]}),n.jsx("button",{onClick:()=>M(H.id),className:"p-2 text-gray-600 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-all",children:n.jsx(jt,{className:"w-4 h-4"})})]},H.id)),F.length===0&&n.jsx("div",{className:"p-8 text-center text-gray-500 text-xs",children:"  "})]})]})]}),e==="database"&&n.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center space-y-4 animate-fadeIn",children:[n.jsx("div",{className:"w-20 h-20 bg-amber-500/10 rounded-full flex items-center justify-center mb-4",children:n.jsx(P3,{className:"w-10 h-10 text-amber-500"})}),n.jsx("h2",{className:"text-2xl font-bold",children:"Firebase Connected"}),n.jsx("p",{className:"text-gray-400 max-w-md",children:"The system is currently using Firebase Realtime & Firestore for data synchronization."}),n.jsx("div",{className:"pt-6",children:n.jsx(Nl,{label:"Check Connection",variant:"secondary",icon:G3})})]})]})}),l&&n.jsx(Yz,{message:l.msg,type:l.type,onClose:()=>d(null)}),n.jsx(Kz,{isOpen:h.isOpen,onClose:()=>f({...h,isOpen:!1}),title:h.title,message:h.message,onConfirm:h.onConfirm,type:h.type}),m.isOpen&&n.jsx(Wz,{title:m.title,message:m.message,defaultValue:m.defaultValue,inputType:m.inputType,placeholder:m.placeholder,onConfirm:m.onConfirm,onClose:m.onClose,confirmButtonText:""})]})},Jz=({options:s,value:e,onChange:t,placeholder:r="Select an option"})=>{const[i,l]=w.useState(!1),[d,h]=w.useState(""),f=w.useRef(null),m=w.useMemo(()=>s.find(v=>v.value===e),[s,e]),b=w.useMemo(()=>d?s.filter(v=>v.label.toLowerCase().includes(d.toLowerCase())||v.sublabel&&v.sublabel.toLowerCase().includes(d.toLowerCase())):s,[s,d]);w.useEffect(()=>{const v=N=>{f.current&&!f.current.contains(N.target)&&l(!1)};return document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v)}},[]);const y=v=>{t(v),l(!1),h("")};return n.jsxs("div",{className:"relative",ref:f,children:[n.jsxs("button",{type:"button",onClick:()=>l(!i),className:"w-full flex justify-between items-center text-right px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none",children:[n.jsx("span",{className:m?"text-neutral-100":"text-neutral-400",children:m?m.label:r}),n.jsx(U0,{className:`w-5 h-5 text-neutral-400 transition-transform ${i?"transform rotate-180":""}`})]}),i&&n.jsxs("div",{className:"absolute z-30 mt-1 w-full bg-gray-800 shadow-lg rounded-md border border-gray-600 max-h-60 flex flex-col",children:[n.jsxs("div",{className:"p-2 border-b border-gray-700 relative",children:[n.jsx(Ln,{className:"absolute top-1/2 left-4 transform -translate-y-1/2 w-5 h-5 text-neutral-400"}),n.jsx("input",{type:"text",placeholder:"...",value:d,onChange:v=>h(v.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-900 text-white border border-gray-600 rounded-md focus:outline-none focus:ring-1 focus:ring-red-500 placeholder:text-neutral-500",autoFocus:!0})]}),n.jsx("div",{className:"overflow-y-auto flex-1",children:b.length>0?b.map(v=>n.jsxs("button",{type:"button",onClick:()=>y(v.value),className:`w-full text-right px-4 py-3 text-sm flex justify-between items-center transition-colors ${e===v.value?"bg-red-500/20 text-red-400":"text-neutral-200 hover:bg-gray-700"}`,children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-semibold",children:v.label}),v.sublabel&&n.jsx("p",{className:"text-xs text-neutral-400",children:v.sublabel})]}),e===v.value&&n.jsx(Xe,{className:"w-5 h-5"})]},v.value)):n.jsx("p",{className:"text-center text-neutral-500 py-4",children:"  ."})})]})]})},Zz=({onClose:s,onSave:e,merchants:t,adminUser:r,initialMerchantId:i,initialCategoryId:l,initialText:d})=>{const[h,f]=w.useState(i||""),[m,b]=w.useState(l||""),[y,v]=w.useState(d||"");Wt(()=>(s(),!0),[]);const N=w.useMemo(()=>{const L=t.map($=>({value:$.id,label:$.name,sublabel:$.phone}));return r&&L.unshift({value:r.id,label:`${r.name} ()`,sublabel:"  "}),L},[t,r]),E=w.useMemo(()=>{if(!h)return[];if(r&&h===r.id)return[];const L=t.find(B=>B.id===h);if(!L||!L.products)return[];const $=new Set(L.products.map(B=>B.category||""));return Array.from($).map(B=>({value:B,label:B}))},[h,t,r]),I=()=>e(h,m||void 0,y||void 0),T=r&&h===r.id;return n.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-md flex items-center justify-center z-[150] p-4 animate-fadeIn",onClick:s,children:n.jsxs("div",{className:"bg-[#1e293b] rounded-2xl shadow-2xl w-full max-w-md border border-gray-700 overflow-hidden animate-pop-in flex flex-col max-h-[90vh]",onClick:L=>L.stopPropagation(),children:[n.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[n.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[n.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg shadow-lg shadow-blue-900/20",children:n.jsx(a0,{className:"w-5 h-5 text-blue-400"})}),"  "]}),n.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white transition-colors bg-gray-800 p-2 rounded-full hover:bg-gray-700",children:n.jsx(rt,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-8 overflow-y-auto custom-scrollbar bg-[#1e293b]",children:[n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-blue-400 mb-1",children:[n.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 flex items-center justify-center text-xs border border-blue-500/30",children:"1"}),"  (  )"]}),n.jsx(Jz,{options:N,value:h,onChange:L=>{f(L),b("")},placeholder:"  ..."})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-purple-400 mb-1",children:[n.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 flex items-center justify-center text-xs border border-purple-500/30",children:"2"}),"  ()"]}),n.jsx("input",{type:"text",value:y,onChange:L=>v(L.target.value),placeholder:":  50%  !",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3 text-white focus:border-purple-500 outline-none transition-colors"}),n.jsx("p",{className:"text-[10px] text-gray-500",children:"    "})]}),n.jsxs("div",{className:`transition-all duration-500 ease-in-out ${h&&!T?"opacity-100 translate-y-0":"opacity-50 translate-y-4 grayscale pointer-events-none"}`,children:[n.jsx("div",{className:"h-px bg-gray-700 mb-6"}),n.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-orange-400 mb-4",children:[n.jsx("span",{className:"w-6 h-6 rounded-full bg-orange-500/20 flex items-center justify-center text-xs border border-orange-500/30",children:"3"}),"     ()"]}),T?n.jsxs("div",{className:"flex flex-col items-center justify-center p-6 bg-blue-900/10 rounded-xl border border-blue-500/20 text-center",children:[n.jsx("div",{className:"w-12 h-12 bg-blue-500/10 rounded-full flex items-center justify-center mb-2",children:n.jsx(dt,{className:"w-6 h-6 text-blue-400"})}),n.jsx("p",{className:"text-blue-200 text-sm font-bold",children:"   "}),n.jsx("p",{className:"text-blue-400/60 text-xs mt-1",children:"    "})]}):E.length>0?n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("button",{onClick:()=>b(""),className:`relative p-3 rounded-xl border-2 transition-all flex flex-col items-center justify-center gap-2 h-24 group ${m===""?"bg-red-600/10 border-red-500 shadow-lg shadow-red-900/20":"bg-gray-800 border-gray-700 hover:border-gray-500"}`,children:[n.jsx(Io,{className:`w-6 h-6 ${m===""?"text-red-500":"text-gray-500 group-hover:text-gray-300"}`}),n.jsx("span",{className:`text-xs font-bold ${m===""?"text-white":"text-gray-400 group-hover:text-gray-300"}`,children:" "}),m===""&&n.jsx("div",{className:"absolute top-2 right-2",children:n.jsx(Xe,{className:"w-4 h-4 text-red-500"})})]}),E.map(L=>n.jsxs("button",{onClick:()=>b(L.value),className:`relative p-3 rounded-xl border-2 transition-all flex flex-col items-center justify-center gap-2 h-24 group ${m===L.value?"bg-red-600/10 border-red-500 shadow-lg shadow-red-900/20":"bg-gray-800 border-gray-700 hover:border-gray-500"}`,children:[n.jsx(bn,{className:`w-6 h-6 ${m===L.value?"text-red-500":"text-gray-500 group-hover:text-gray-300"}`}),n.jsx("span",{className:`text-xs font-bold text-center line-clamp-2 leading-tight ${m===L.value?"text-white":"text-gray-400 group-hover:text-gray-300"}`,children:L.label}),m===L.value&&n.jsx("div",{className:"absolute top-2 right-2",children:n.jsx(Xe,{className:"w-4 h-4 text-red-500"})})]},L.value))]}):n.jsxs("div",{className:"flex flex-col items-center justify-center p-6 bg-gray-800/50 rounded-xl border border-gray-700 text-center border-dashed",children:[n.jsx(bn,{className:"w-10 h-10 text-gray-600 mb-2 opacity-50"}),n.jsx("p",{className:"text-gray-400 text-xs",children:"     ."})]})]})]}),n.jsxs("div",{className:"p-5 border-t border-gray-700 bg-[#151e2d] flex gap-3",children:[n.jsxs("button",{onClick:I,disabled:!h,className:"flex-1 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white font-bold py-3.5 rounded-xl transition-all shadow-lg active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[n.jsx(Xe,{className:"w-5 h-5"})," "]}),i&&n.jsx("button",{onClick:()=>e("",void 0,""),className:"px-4 bg-red-500/10 hover:bg-red-500/20 text-red-400 font-bold py-3.5 rounded-xl transition-colors border border-red-500/20 flex items-center justify-center",title:" ",children:n.jsx(jt,{className:"w-5 h-5"})})]})]})})},Rk=({images:s,isEnabled:e,onAddImage:t,onDeleteImage:r,onUpdateImage:i,onToggleSlider:l,merchants:d=[],adminUser:h})=>{var C,P,U;const f=w.useRef(null),m=w.useRef(null),[b,y]=w.useState(null),[v,N]=w.useState(null),[E,I]=w.useState(!1),[T,L]=w.useState(0);w.useEffect(()=>{if(s.length>1){const O=setInterval(()=>{L(D=>(D+1)%s.length)},3e3);return()=>clearInterval(O)}else L(0)},[s.length]);const $=w.useMemo(()=>s.filter(O=>O.active!==!1),[s]);$.length>0;const B=O=>{if(!O.linkedMerchantId)return{name:" ",type:"none"};if(h&&O.linkedMerchantId===h.id)return{name:" ( )",type:"admin"};const D=d.find(F=>F.id===O.linkedMerchantId);return{name:D?D.name:"  ",category:O.linkedCategoryId,type:"merchant"}},Q=O=>new Promise((D,F)=>{const S=new FileReader;S.readAsDataURL(O),S.onload=ae=>{var k;const K=new Image;K.src=(k=ae.target)==null?void 0:k.result,K.onload=()=>{const q=document.createElement("canvas"),W=1920,ne=1920;let M=K.width,R=K.height;M>R?M>W&&(R*=W/M,M=W):R>ne&&(M*=ne/R,R=ne),q.width=M,q.height=R;const V=q.getContext("2d");V?(V.imageSmoothingEnabled=!0,V.imageSmoothingQuality="high",V.drawImage(K,0,0,M,R),D(q.toDataURL("image/jpeg",.95))):F(new Error("Canvas context failed"))},K.onerror=q=>F(q)},S.onerror=ae=>F(ae)}),Z=async O=>{var F;const D=(F=O.target.files)==null?void 0:F[0];if(D&&t){I(!0);try{const S=await Q(D),ae={id:`SLIDE-${Date.now()}`,url:S,active:!0,createdAt:new Date,linkedMerchantId:"",linkedCategoryId:""};t(ae)}catch(S){console.error("Image upload failed",S),alert("  .    .")}finally{I(!1)}}f.current&&(f.current.value="")},Y=async O=>{var F;const D=(F=O.target.files)==null?void 0:F[0];if(D&&i&&b){I(!0);try{const S=await Q(D);i(b,{url:S}),y(null)}catch(S){console.error("Image update failed",S),alert("  .")}finally{I(!1)}}m.current&&(m.current.value="")};return n.jsxs("div",{className:"space-y-8 pb-32 animate-fadeIn",children:[n.jsxs("div",{className:"bg-[#111] p-6 rounded-[2.5rem] border border-gray-800 shadow-2xl relative overflow-hidden",children:[n.jsxs("div",{className:"flex justify-between items-center mb-6 px-2",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-red-600 rounded-full flex items-center justify-center shadow-lg shadow-red-900/20",children:n.jsx(fr,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-black text-white tracking-wide",children:" "}),n.jsx("p",{className:"text-xs text-gray-400 font-medium",children:"    "})]})]}),n.jsxs("button",{onClick:()=>l&&l(!e),className:`group relative flex items-center gap-3 pl-1 pr-4 py-1.5 rounded-full transition-all duration-300 border ${e?"bg-green-900/20 border-green-500/30":"bg-red-900/20 border-red-500/30"}`,children:[n.jsx("span",{className:`text-[10px] font-bold ${e?"text-green-400":"text-red-400"}`,children:e?"":""}),n.jsx("div",{className:`w-10 h-6 rounded-full relative transition-colors duration-300 ${e?"bg-green-600":"bg-red-600"}`,children:n.jsx("div",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full shadow-md transition-transform duration-300 ease-spring ${e?"translate-x-4":"translate-x-0"}`})})]})]}),n.jsxs("div",{className:"relative w-full max-w-sm mx-auto aspect-[16/9] sm:aspect-[2/1] rounded-2xl overflow-hidden shadow-2xl border border-gray-700 bg-gray-900 group",children:[$.length>0?$.map((O,D)=>{const F=D===T,S=!!O.textOverlay,ae=h&&O.linkedMerchantId===h.id;return n.jsxs("div",{className:`absolute inset-0 transition-opacity duration-700 ease-in-out ${F?"opacity-100 z-10":"opacity-0 z-0"}`,children:[n.jsx("img",{src:O.url,className:"w-full h-full object-cover",alt:"Slide"}),n.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent pointer-events-none"}),ae&&h&&n.jsxs("div",{className:"absolute bottom-4 left-4 z-20 flex items-center gap-2 bg-black/40 backdrop-blur-md border border-white/10 px-3 py-1.5 rounded-full animate-fade-slide-up",children:[n.jsx("div",{className:"w-6 h-6 rounded-full border border-white/50 overflow-hidden bg-gray-800",children:h.storeImage?n.jsx("img",{src:h.storeImage,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-full h-full p-1 text-gray-400"})}),O.textOverlay?n.jsx("span",{className:"text-[10px] font-bold text-white max-w-[150px] truncate",children:O.textOverlay}):n.jsx("span",{className:"text-[10px] font-bold text-white",children:""})]}),S&&!ae&&n.jsx("div",{className:"absolute bottom-4 right-4 max-w-[70%] text-right z-20",children:n.jsx("p",{className:"text-white font-bold text-sm drop-shadow-md bg-black/30 backdrop-blur-sm px-3 py-1 rounded-lg inline-block border border-white/10",children:O.textOverlay})})]},O.id)}):n.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-gray-600",children:[n.jsx(fr,{className:"w-12 h-12 mb-2 opacity-20"}),n.jsx("span",{className:"text-xs font-bold opacity-50",children:"   "})]}),$.length>1&&n.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1 z-30",children:$.map((O,D)=>n.jsx("div",{className:`h-1 rounded-full transition-all duration-300 ${D===T?"bg-white w-4":"bg-white/30 w-1"}`},D))})]}),n.jsx("p",{className:"text-center text-[10px] text-gray-600 mt-3 font-mono",children:"LIVE PREVIEW MODE"})]}),n.jsxs("div",{className:"flex justify-between items-center px-2",children:[n.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[n.jsx(bn,{className:"w-5 h-5 text-gray-400"}),"  (",s.length,")"]}),n.jsxs("button",{onClick:()=>{var O;return(O=f.current)==null?void 0:O.click()},disabled:E,className:"bg-red-600 hover:bg-red-700 text-white pl-4 pr-5 py-2.5 rounded-xl font-bold shadow-lg shadow-red-900/20 active:scale-95 transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[E?n.jsx("div",{className:"w-4 h-4 border-2 border-white/50 border-t-white rounded-full animate-spin"}):n.jsx(gr,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm",children:" "})]}),n.jsx("input",{ref:f,type:"file",className:"hidden",accept:"image/*",onChange:Z}),n.jsx("input",{ref:m,type:"file",className:"hidden",accept:"image/*",onChange:Y})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:[s.map(O=>{const D=B(O),F=O.active!==!1;return n.jsxs("div",{className:`group relative bg-[#1e1e1e] rounded-3xl overflow-hidden border transition-all duration-300 ${F?"border-gray-700 shadow-lg hover:border-gray-500":"border-gray-800 opacity-60 hover:opacity-100"}`,children:[n.jsxs("div",{className:"relative aspect-video w-full bg-gray-900 overflow-hidden",children:[n.jsx("img",{src:O.url,alt:"Slider",className:`w-full h-full object-cover transition-transform duration-700 group-hover:scale-105 ${F?"":"grayscale"}`}),O.textOverlay&&n.jsx("div",{className:"absolute bottom-2 right-2 left-2 z-10",children:n.jsx("span",{className:"text-[10px] text-white bg-black/50 backdrop-blur-sm px-2 py-1 rounded truncate block text-center border border-white/10",children:O.textOverlay})}),n.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3 backdrop-blur-[2px] z-20",children:[n.jsx("button",{onClick:()=>{var S;y(O.id),(S=m.current)==null||S.click()},className:"w-9 h-9 rounded-full bg-white text-black flex items-center justify-center shadow-lg hover:scale-110 transition-transform",title:" ",children:n.jsx(Jn,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>N(O.id),className:"w-9 h-9 rounded-full bg-blue-500 text-white flex items-center justify-center shadow-lg hover:scale-110 transition-transform",title:" ",children:n.jsx(a0,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>r&&r(O.id),className:"w-9 h-9 rounded-full bg-red-600 text-white flex items-center justify-center shadow-lg hover:scale-110 transition-transform",title:"",children:n.jsx(jt,{className:"w-4 h-4"})})]}),n.jsx("div",{className:"absolute top-3 left-3 z-20",children:n.jsx("button",{onClick:()=>i&&i(O.id,{active:!F}),className:`p-1.5 rounded-full backdrop-blur-md border shadow-sm transition-colors ${F?"bg-green-500/20 border-green-500/30 text-green-400":"bg-black/40 border-white/10 text-gray-400"}`,children:F?n.jsx(na,{className:"w-3.5 h-3.5"}):n.jsx(wi,{className:"w-3.5 h-3.5"})})})]}),n.jsx("div",{className:"p-4 border-t border-gray-700/50 bg-[#252525]",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border border-white/5 ${D.type==="admin"?"bg-blue-500/10 text-blue-400":D.type==="merchant"?"bg-purple-500/10 text-purple-400":"bg-gray-700 text-gray-500"}`,children:D.type==="admin"?n.jsx(dt,{className:"w-4 h-4"}):D.type==="merchant"?n.jsx(Io,{className:"w-4 h-4"}):n.jsx(a0,{className:"w-4 h-4"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-xs font-bold text-white truncate",children:D.name}),n.jsx("p",{className:"text-[10px] text-gray-500 truncate flex items-center gap-1",children:D.category?n.jsxs(n.Fragment,{children:[n.jsx(bn,{className:"w-3 h-3"}),D.category]}):D.type==="none"?" ":" "})]})]})})]},O.id)}),s.length===0&&n.jsxs("div",{className:"col-span-full py-20 text-center border-2 border-dashed border-gray-800 rounded-[2rem] bg-[#1a1a1a]/50",children:[n.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4 mx-auto shadow-inner border border-gray-700",children:n.jsx(fr,{className:"w-10 h-10 text-gray-600 opacity-50"})}),n.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:"   "}),n.jsx("p",{className:"text-xs text-gray-500",children:"     "})]})]}),v&&n.jsx(Zz,{onClose:()=>N(null),onSave:(O,D,F)=>{i&&v&&(i(v,{linkedMerchantId:O||void 0,linkedCategoryId:D||void 0,textOverlay:F||void 0}),N(null))},merchants:d,adminUser:h,initialMerchantId:(C=s.find(O=>O.id===v))==null?void 0:C.linkedMerchantId,initialCategoryId:(P=s.find(O=>O.id===v))==null?void 0:P.linkedCategoryId,initialText:(U=s.find(O=>O.id===v))==null?void 0:U.textOverlay})]})},Dk=({merchants:s,onClose:e,onSave:t})=>{const[r,i]=w.useState({phone:"",address:""}),[l,d]=w.useState(""),[h,f]=w.useState(""),[m,b]=w.useState(1),[y,v]=w.useState(""),[N,E]=w.useState("idle"),[I,T]=w.useState(0),[L,$]=w.useState(!1),[B,Q]=w.useState(""),[Z,Y]=w.useState("all");Wt(()=>L?($(!1),!0):(e(),!0),[L,e]);const C=()=>$(!0),P=()=>$(!1),U=w.useMemo(()=>["all",...Array.from(new Set(s.map(ne=>ne.storeCategory||" ")))],[s]),O=w.useMemo(()=>s.filter(W=>{const ne=W.name.toLowerCase().includes(B.toLowerCase())||W.phone&&W.phone.includes(B),M=Z==="all"||(W.storeCategory||" ")===Z;return ne&&M}),[s,B,Z]),D=w.useMemo(()=>s.find(W=>W.id===h),[s,h]),F=async()=>{if(!r.phone||!r.address||!h){v("      .");return}if(!/^\d{11}$/.test(r.phone)){v("      11 .");return}const W=(D==null?void 0:D.name)||"  ";v(""),E("saving"),T(0);try{if(m===1)await t({customer:{...r},notes:l,merchantId:h,merchantName:W}),T(100);else{const ne=[];for(let M=0;M<m;M++)ne.push({customer:{...r},notes:l,merchantId:h,merchantName:W});T(50),await t(ne),T(100)}E("success"),setTimeout(()=>{e()},1800)}catch(ne){E("idle"),v("    ."),console.error(ne)}},S=()=>{m<1e3&&b(W=>W+1)},ae=()=>{m>1&&b(W=>W-1)},K=W=>{let ne=parseInt(W.target.value);isNaN(ne)&&(ne=1),ne<1&&(ne=1),ne>1e3&&(ne=1e3),b(ne)},k=W=>{f(W),$(!1),Q("")},q=W=>W==="restaurant"||W===""?n.jsx(Lr,{className:"w-4 h-4"}):W==="market"||W===" "?n.jsx(xn,{className:"w-4 h-4"}):n.jsx(bn,{className:"w-4 h-4"});return n.jsxs("div",{className:"flex flex-col h-full w-full bg-[#111827] animate-page-enter relative overflow-hidden",children:[n.jsxs("div",{className:`absolute inset-0 z-[60] bg-[#111827] flex flex-col items-center justify-center transition-all duration-500 ${N==="success"?"opacity-100 visible":"opacity-0 invisible pointer-events-none"}`,children:[n.jsxs("div",{className:`relative w-32 h-32 flex items-center justify-center mb-8 transition-transform duration-700 ${N==="success"?"scale-100":"scale-50"}`,children:[n.jsx("div",{className:"absolute inset-0 bg-green-500 rounded-full opacity-20 animate-ping"}),n.jsx("div",{className:"relative bg-gradient-to-br from-green-500 to-emerald-600 rounded-full p-6 shadow-[0_0_40px_rgba(16,185,129,0.4)]",children:n.jsx(Xe,{className:"w-20 h-20 text-white"})})]}),n.jsx("h2",{className:`text-4xl font-black text-white mb-2 tracking-tight transition-all duration-500 delay-100 ${N==="success"?"translate-y-0 opacity-100":"translate-y-10 opacity-0"}`,children:" !"}),n.jsx("p",{className:`text-gray-400 text-lg transition-all duration-500 delay-200 ${N==="success"?"translate-y-0 opacity-100":"translate-y-10 opacity-0"}`,children:m>1?`  ${m}   `:"    "})]}),n.jsxs("div",{className:"flex-none bg-[#1f2937]/90 backdrop-blur-md border-b border-gray-700 flex items-center justify-between px-4 shadow-lg z-20 pt-safe h-16 box-content",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{onClick:e,disabled:N==="saving",className:"bg-gray-800 p-2.5 rounded-full text-gray-400 hover:text-white transition-colors active:bg-gray-700 border border-gray-700",children:n.jsx(zs,{className:"w-5 h-5 rotate-180"})}),n.jsx("h2",{className:"text-lg font-bold text-white",children:"  "})]}),N==="saving"&&n.jsxs("div",{className:"flex items-center gap-2 bg-yellow-500/10 px-3 py-1 rounded-full border border-yellow-500/20",children:[n.jsx("div",{className:"w-3 h-3 border-2 border-yellow-500 border-t-transparent rounded-full animate-spin"}),n.jsx("span",{className:"text-xs font-bold text-yellow-500",children:I===100?"":" ..."})]})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-5 space-y-6 scroll-smooth pb-4 bg-[#111827]",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-xs font-bold text-gray-400 block px-1 uppercase tracking-wider",children:" ()"}),n.jsxs("button",{onClick:C,disabled:N==="saving",className:`w-full p-4 rounded-2xl border transition-all flex items-center justify-between group ${D?"bg-gradient-to-r from-[#1f2937] to-[#1a202c] border-red-500/50 shadow-lg shadow-red-900/10":"bg-[#1f2937] border-gray-700 hover:border-gray-500 hover:bg-[#2d3748]"}`,children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center overflow-hidden border ${D?"bg-[#111] border-red-500/30":"bg-gray-800 border-gray-600"}`,children:D&&D.storeImage?n.jsx("img",{src:D.storeImage,alt:D.name,className:"w-full h-full object-cover"}):n.jsx(Io,{className:`w-6 h-6 ${D?"text-red-500":"text-gray-500"}`})}),n.jsxs("div",{className:"text-right",children:[n.jsx("span",{className:`block font-bold text-base ${D?"text-white":"text-gray-400"}`,children:D?D.name:"  "}),D?n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx("span",{className:"text-xs text-gray-500 font-mono",children:D.phone}),n.jsx("span",{className:"text-[10px] bg-black/30 px-2 py-0.5 rounded text-gray-300 border border-gray-700",children:D.storeCategory||""})]}):n.jsx("span",{className:"text-xs text-gray-500",children:"  "})]})]}),n.jsx("div",{className:"p-2 rounded-full bg-gray-800 group-hover:bg-gray-700 transition-colors",children:n.jsx(U0,{className:"w-4 h-4 text-gray-400 group-hover:text-white"})})]})]}),n.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-700 to-transparent"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("h3",{className:"text-xs font-bold text-gray-400 flex items-center gap-2 px-1 uppercase tracking-wider",children:[n.jsx(dt,{className:"w-4 h-4"}),"   ()"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"relative group",children:[n.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-4 text-gray-500 group-focus-within:text-red-500 transition-colors",children:n.jsx($s,{className:"w-5 h-5"})}),n.jsx("input",{type:"tel",value:r.phone,onChange:W=>i({...r,phone:W.target.value}),placeholder:"  (11 )",className:"w-full bg-[#1f2937] border border-gray-700 rounded-xl py-4 pl-12 pr-4 text-white text-right placeholder:text-right focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all font-mono shadow-sm",dir:"rtl",maxLength:11,disabled:N==="saving"})]}),n.jsxs("div",{className:"relative group",children:[n.jsx("div",{className:"absolute top-4 left-4 text-gray-500 group-focus-within:text-red-500 transition-colors",children:n.jsx(pn,{className:"w-5 h-5"})}),n.jsx("textarea",{value:r.address,onChange:W=>i({...r,address:W.target.value}),placeholder:"  (   )...",className:"w-full bg-[#1f2937] border border-gray-700 rounded-xl py-3.5 pl-12 pr-4 text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all shadow-sm resize-none h-24 leading-relaxed",disabled:N==="saving"})]})]})]}),n.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-700 to-transparent"}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("h3",{className:"text-xs font-bold text-gray-400 flex items-center gap-2 px-1 uppercase tracking-wider",children:[n.jsx(Mr,{className:"w-4 h-4"}),"  "]})}),n.jsxs("div",{className:"bg-[#1f2937] p-4 rounded-xl border border-gray-700 flex items-center justify-between shadow-sm",children:[n.jsx("span",{className:"text-sm text-gray-200 font-bold",children:"  "}),n.jsxs("div",{className:"flex items-center gap-3 bg-[#111] p-1.5 rounded-lg border border-gray-700 shadow-inner",children:[n.jsx("button",{onClick:ae,disabled:N==="saving",className:"w-9 h-9 flex items-center justify-center bg-gray-800 text-white rounded-md hover:bg-gray-700 active:scale-95 transition-all",children:n.jsx(oS,{className:"w-4 h-4"})}),n.jsx("div",{className:"w-10 text-center",children:n.jsx("input",{type:"number",min:"1",max:"1000",value:m,onChange:K,onFocus:W=>W.target.select(),disabled:N==="saving",className:"w-full bg-transparent text-center font-black text-xl text-white outline-none border-none p-0 focus:ring-0 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})}),n.jsx("button",{onClick:S,disabled:N==="saving",className:"w-9 h-9 flex items-center justify-center bg-red-600 text-white rounded-md hover:bg-red-700 active:scale-95 transition-all shadow-lg shadow-red-900/20",children:n.jsx(Gs,{className:"w-4 h-4"})})]})]}),n.jsx("div",{className:"relative group",children:n.jsx("textarea",{value:l,onChange:W=>d(W.target.value),placeholder:"   ()...",rows:3,className:"w-full bg-[#1f2937] border border-gray-700 rounded-xl p-4 text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all resize-none shadow-sm",disabled:N==="saving"})})]}),y&&n.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 p-4 rounded-xl text-center animate-fadeIn flex items-center justify-center gap-2",children:[n.jsx(rt,{className:"w-5 h-5 text-red-500"}),n.jsx("p",{className:"text-red-400 text-sm font-bold",children:y})]})]}),n.jsx("div",{className:"flex-none bg-[#1f2937] border-t border-gray-700 p-4 z-20 pb-6 sm:pb-4 shadow-[0_-5px_20px_rgba(0,0,0,0.3)]",children:n.jsx("button",{onClick:F,disabled:N==="saving",className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-bold py-4 rounded-xl shadow-lg shadow-red-900/30 active:scale-[0.98] transition-all flex items-center justify-center gap-2 disabled:bg-none disabled:bg-gray-700 disabled:text-gray-500 disabled:cursor-not-allowed disabled:shadow-none group",children:N==="saving"?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),n.jsxs("span",{children:["  (",I,"%)"]})]}):n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-lg",children:" "}),m>1&&n.jsxs("span",{className:"bg-white/20 px-2 py-0.5 rounded text-sm font-mono",children:["x",m]}),n.jsx(zs,{className:"w-5 h-5 opacity-0 -translate-x-2 group-hover:opacity-100 group-hover:translate-x-0 transition-all duration-300"})]})})}),L&&n.jsxs("div",{className:"fixed inset-0 z-[120] bg-black/90 backdrop-blur-sm flex flex-col animate-fadeIn",children:[n.jsxs("div",{className:"flex-none p-4 pt-safe flex items-center gap-4 bg-[#1f2937] border-b border-gray-700 shadow-md z-30",children:[n.jsx("button",{onClick:P,className:"bg-gray-800 hover:bg-gray-700 text-white p-2.5 rounded-full transition-colors active:scale-95",children:n.jsx(zs,{className:"w-6 h-6 rotate-180"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-lg font-bold text-white",children:" "}),n.jsxs("p",{className:"text-xs text-gray-400",children:[O.length,"  "]})]})]}),n.jsxs("div",{className:"flex-none bg-[#1f2937] p-4 pt-2 space-y-3 border-b border-gray-800 z-20",children:[n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"text",placeholder:"    ...",value:B,onChange:W=>Q(W.target.value),className:"w-full bg-[#111] border border-gray-700 rounded-xl py-3 pl-4 pr-11 text-white focus:ring-1 focus:ring-red-500 focus:border-red-500 placeholder-gray-500 shadow-inner outline-none transition-all",autoFocus:!0}),n.jsx(Ln,{className:"absolute right-3.5 top-3.5 w-5 h-5 text-gray-500"})]}),n.jsx("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide pb-1",children:U.map(W=>n.jsx("button",{onClick:()=>Y(W),className:`px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-all border ${Z===W?"bg-red-600 text-white border-red-600 shadow-md":"bg-gray-800 text-gray-400 border-gray-700 hover:border-gray-500"}`,children:W==="all"?"":W},W))})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-[#111] custom-scrollbar",children:O.length>0?n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:O.map(W=>n.jsxs("button",{onClick:()=>k(W.id),className:`w-full flex items-center p-3 rounded-xl border transition-all active:scale-[0.98] ${h===W.id?"bg-red-900/10 border-red-500 shadow-lg shadow-red-900/10 ring-1 ring-red-500/30":"bg-[#1e1e1e] border-gray-800 hover:border-gray-600 hover:bg-[#252525]"}`,children:[n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center overflow-hidden border-2 shadow-sm ${h===W.id?"border-red-500":"border-gray-700 bg-gray-800"}`,children:W.storeImage?n.jsx("img",{src:W.storeImage,alt:W.name,className:"w-full h-full object-cover"}):n.jsx("span",{className:"text-lg font-bold text-gray-500",children:W.name.charAt(0)})}),h===W.id&&n.jsx("div",{className:"absolute -bottom-1 -right-1 bg-red-500 text-white rounded-full p-0.5 border-2 border-[#1e1e1e] shadow-sm animate-bounce",children:n.jsx(Xe,{className:"w-3 h-3"})})]}),n.jsxs("div",{className:"mr-3 flex-1 text-right min-w-0",children:[n.jsx("div",{className:"flex justify-between items-start",children:n.jsx("p",{className:`font-bold text-sm truncate ${h===W.id?"text-white":"text-gray-200"}`,children:W.name})}),n.jsx("p",{className:"text-xs text-gray-500 font-mono mt-0.5",children:W.phone}),n.jsx("div",{className:"flex items-center gap-2 mt-1.5",children:n.jsxs("span",{className:"text-[10px] bg-black/40 text-gray-400 px-2 py-0.5 rounded border border-gray-700 flex items-center gap-1",children:[q(W.storeCategory||""),W.storeCategory||" "]})})]})]},W.id))}):n.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[n.jsx(Io,{className:"w-16 h-16 mb-4 opacity-10"}),n.jsx("p",{className:"text-sm font-bold",children:"    "})]})})]})]})},Ok=({activeView:s,onNavigate:e,availableViews:t,isVisible:r=!0,mode:i="dark"})=>{const l=[{id:"orders",label:"",icon:Ut},{id:"users",label:"",icon:Zd},{id:"stores",label:"",icon:Xn},{id:"special",label:" ",icon:Ft},{id:"shopping",label:" ",icon:xn},{id:"slider",label:"",icon:fr},{id:"wallet",label:"",icon:eu},{id:"games",label:"",icon:$l},{id:"settings",label:"",icon:hn}],d=m=>{try{e(m)}catch(b){console.error("Navigation error:",b)}},h=t?l.filter(m=>t.includes(m.id)):l.filter(m=>["orders","users","stores","special","shopping","wallet","settings","games"].includes(m.id)),f=i==="light";return n.jsx("div",{className:`fixed left-4 right-4 z-40 transition-transform duration-300 ease-in-out ${r?"translate-y-0 bottom-8":"translate-y-[150%] bottom-8"}`,children:n.jsx("nav",{className:`${f?"bg-white/95 border-gray-200 shadow-[0_10px_30px_rgba(0,0,0,0.12)]":"bg-gray-800/95 border-gray-700 shadow-[0_10px_40px_rgba(0,0,0,0.4)]"} backdrop-blur-xl border flex justify-around items-center h-[70px] rounded-[30px] px-2 transition-colors duration-300`,children:h.map(m=>{const b=m.icon,y=s===m.id;return n.jsxs("button",{onClick:()=>d(m.id),className:"group relative flex-1 h-full flex flex-col items-center justify-center outline-none select-none",type:"button",style:{WebkitTapHighlightColor:"transparent"},children:[n.jsxs("div",{className:`relative transition-all duration-300 ease-out p-2 rounded-2xl ${y?"-translate-y-2":"translate-y-1"}`,children:[n.jsx("div",{className:`absolute inset-0 bg-red-600 rounded-2xl transition-all duration-300 ${y?"opacity-100 scale-100 rotate-3":"opacity-0 scale-50 rotate-0"}`}),n.jsx(b,{className:`w-6 h-6 transition-all duration-300 z-10 relative ${y?"text-white":f?"text-gray-400":"text-gray-500"}`})]}),n.jsx("span",{className:`text-[10px] font-bold tracking-wide transition-all duration-300 absolute bottom-2 ${y?"text-red-600 opacity-100 translate-y-0":`${f?"text-gray-400":"text-gray-500"} opacity-0 translate-y-2`}`,children:m.label})]},m.id)})})})},YT=({status:s,icon:e,color:t,onClick:r,subLabel:i})=>n.jsxs("button",{type:"button",onClick:l=>{l.stopPropagation(),r()},className:`w-full text-right p-4 rounded-xl flex items-center space-x-4 space-x-reverse transition-all duration-200 border border-gray-700 bg-gray-900 active:bg-gray-800 group relative z-10 ${t}`,children:[n.jsx("div",{className:"p-3 bg-white/5 rounded-full group-active:bg-white/10 transition-colors pointer-events-none",children:e}),n.jsxs("div",{className:"pointer-events-none",children:[n.jsx("p",{className:"font-bold text-neutral-100 text-md",children:s}),n.jsx("p",{className:"text-xs text-neutral-400",children:i})]})]}),Pk=({order:s,onClose:e,onSelectStatus:t,onTransferOrder:r})=>{Wt(()=>(e(),!0),[e]);const i=s.type==="shopping_order",d=[{status:ce.WaitingMerchant,icon:i?n.jsx(Ft,{className:"w-6 h-6 text-purple-400"}):n.jsx(xt,{className:"w-6 h-6 text-purple-400"}),color:"hover:border-purple-500/50",label:i?" ":ce.WaitingMerchant,sub:i?"    ":"  "},{status:ce.Preparing,icon:n.jsx(Lr,{className:"w-6 h-6 text-orange-400"}),color:"hover:border-orange-500/50",label:i?" ":ce.Preparing,sub:i?"  / ":"  "},{status:ce.Pending,icon:n.jsx(xn,{className:"w-6 h-6 text-yellow-400"}),color:"hover:border-yellow-500/50",label:i?" ":ce.Pending,sub:i?"    ":"  "},{status:ce.InTransit,icon:n.jsx(iS,{className:"w-6 h-6 text-sky-400"}),color:"hover:border-sky-500/50",label:ce.InTransit,sub:"  "},{status:ce.Delivered,icon:n.jsx(Xe,{className:"w-6 h-6 text-green-400"}),color:"hover:border-green-500/50",label:ce.Delivered,sub:"   "},{status:ce.Cancelled,icon:n.jsx(rt,{className:"w-6 h-6 text-red-400"}),color:"hover:border-red-500/50",label:ce.Cancelled,sub:"  "}].filter(h=>h.status===s.status||s.status===ce.Pending&&h.status===ce.Delivered?!1:i?!0:h.status!==ce.WaitingMerchant&&h.status!==ce.Preparing);return z0.createPortal(n.jsx("div",{className:"fixed inset-0 z-[99999] flex items-end sm:items-center justify-center p-0 sm:p-4",style:{backgroundColor:"rgba(0,0,0,0.85)",backdropFilter:"blur(2px)",touchAction:"none"},onClick:h=>{h.preventDefault(),h.stopPropagation(),e()},children:n.jsxs("div",{className:"bg-gray-800 w-full max-w-md rounded-t-2xl sm:rounded-2xl border border-gray-700 shadow-2xl relative flex flex-col max-h-[85vh] animate-sheet-up",onClick:h=>{h.stopPropagation()},children:[n.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-2xl",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-neutral-100",children:"  "}),n.jsxs("p",{className:"font-mono text-xs text-red-400 mt-0.5 tracking-wider",children:[i?"  ":"  ","#",s.id]})]}),n.jsx("button",{type:"button",onClick:h=>{h.stopPropagation(),e()},className:"text-neutral-400 hover:text-white p-3 rounded-full bg-gray-800 hover:bg-gray-700 transition-colors",children:n.jsx(rt,{className:"w-6 h-6"})})]}),n.jsxs("div",{className:"p-5 overflow-y-auto space-y-4 bg-gray-800",children:[n.jsxs("div",{className:"flex justify-between items-center bg-black/20 p-3 rounded-lg border border-white/5",children:[n.jsx("p",{className:"text-sm text-neutral-400 font-medium",children:" :"}),n.jsx("span",{className:"font-bold text-white bg-gray-700 px-3 py-1 rounded-full text-xs border border-gray-600 shadow-sm",children:s.status})]}),s.status===ce.InTransit&&r&&n.jsxs("div",{className:"mb-2",children:[n.jsx(YT,{status:"   ",subLabel:"   ",icon:n.jsx(dt,{className:"w-6 h-6 text-indigo-400"}),color:"bg-indigo-900/10 border-indigo-500/30 hover:bg-indigo-900/20",onClick:()=>r(s)}),n.jsxs("div",{className:"flex items-center gap-2 my-4 opacity-50",children:[n.jsx("div",{className:"h-px bg-gray-600 flex-1"}),n.jsx("span",{className:"text-[10px] text-gray-400 font-bold",children:"  "}),n.jsx("div",{className:"h-px bg-gray-600 flex-1"})]})]}),n.jsx("div",{className:"space-y-3",children:d.map(h=>n.jsx(YT,{status:h.label,subLabel:h.sub,icon:h.icon,color:h.color,onClick:()=>t(s,h.status)},h.status))})]}),n.jsx("div",{className:"p-4 border-t border-gray-700 bg-gray-900 rounded-b-2xl",children:n.jsx("button",{type:"button",onClick:h=>{h.stopPropagation(),e()},className:"w-full py-3.5 rounded-xl bg-gray-800 text-gray-300 font-bold hover:bg-gray-700 transition-colors border border-gray-600 active:bg-gray-600",children:""})})]})}),document.body)},V0=({order:s,drivers:e,onClose:t,onSave:r,targetStatus:i})=>{const[l,d]=w.useState(""),[h,f]=w.useState(s.deliveryFee||""),[m,b]=w.useState(""),[y,v]=w.useState("");Wt(()=>(t(),!0),[t]);const N="w-full px-4 py-4 border border-gray-600 bg-[#111] text-white rounded-xl shadow-inner focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-lg font-bold text-center font-mono",E=s.status===ce.InTransit&&i===ce.InTransit,I=E?"   ":i===ce.Delivered?"  ":"  ",T=E?" ":i===ce.Delivered?"  ":"  ",L=E?"bg-indigo-600 hover:bg-indigo-700":i===ce.Delivered?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700",$=w.useMemo(()=>e.filter(Q=>Q.name.toLowerCase().includes(m.toLowerCase())||Q.phone&&Q.phone.includes(m)),[e,m]),B=()=>{const Q=h!==""?parseFloat(String(h)):void 0;if(!l||Q===void 0||Q<0){v("      .");return}v(""),r(l,Q)};return z0.createPortal(n.jsx("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center p-0 sm:p-4 bg-black/80 backdrop-blur-sm transition-all duration-300 animate-fadeIn",style:{touchAction:"none"},onClick:Q=>{Q.stopPropagation(),t()},children:n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-lg rounded-t-[2rem] sm:rounded-[2rem] border border-gray-700 shadow-2xl relative flex flex-col max-h-[85vh] animate-sheet-up overflow-hidden",onClick:Q=>Q.stopPropagation(),children:[n.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d] relative z-10",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`p-3 rounded-xl shadow-lg ${E?"bg-indigo-500/20 text-indigo-400":"bg-blue-500/20 text-blue-400"}`,children:n.jsx(Ut,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-white",children:I}),n.jsxs("p",{className:"font-mono text-xs text-gray-400 mt-0.5 tracking-wider",children:["ORDER #",s.id]})]})]}),n.jsx("button",{type:"button",onClick:t,className:"text-gray-400 hover:text-white p-2 rounded-full bg-gray-800 hover:bg-gray-700 transition-colors",children:n.jsx(rt,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto custom-scrollbar bg-[#1e293b] relative",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 uppercase tracking-wide",children:" "}),n.jsxs("div",{className:"bg-[#111] rounded-2xl border border-gray-700 overflow-hidden shadow-sm",children:[n.jsxs("div",{className:"relative border-b border-gray-700",children:[n.jsx(Ln,{className:"absolute top-1/2 right-4 transform -translate-y-1/2 w-5 h-5 text-gray-500"}),n.jsx("input",{type:"text",placeholder:"   ...",value:m,onChange:Q=>b(Q.target.value),className:"w-full pr-12 pl-4 py-4 bg-[#111] text-white placeholder:text-gray-600 focus:outline-none transition-colors text-sm"})]}),n.jsxs("div",{className:"max-h-48 overflow-y-auto p-2 space-y-1 custom-scrollbar",children:[$.map(Q=>n.jsxs("button",{type:"button",onClick:()=>d(Q.id),className:`w-full flex justify-between items-center text-right p-3 rounded-xl transition-all duration-200 border ${l===Q.id?"bg-blue-600 text-white border-blue-500 shadow-md transform scale-[1.02]":"bg-transparent border-transparent text-gray-300 hover:bg-gray-800"}`,children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-bold block text-sm",children:Q.name}),n.jsxs("span",{className:`text-xs font-mono flex items-center gap-1 mt-0.5 ${l===Q.id?"text-blue-200":"text-gray-500"}`,children:[n.jsx($s,{className:"w-3 h-3"}),Q.phone]})]}),l===Q.id&&n.jsx(Xe,{className:"w-5 h-5 text-white"})]},Q.id)),$.length===0&&n.jsx("div",{className:"text-center py-6 text-gray-500 text-sm",children:"   "})]})]})]}),n.jsxs("div",{className:"bg-[#151e2d] p-4 rounded-2xl border border-gray-700",children:[n.jsx("label",{htmlFor:"deliveryFee",className:"block text-xs font-bold text-gray-400 mb-3 text-center uppercase tracking-wide",children:E?"  ()":"  "}),n.jsxs("div",{className:"relative max-w-[200px] mx-auto",children:[n.jsx("input",{type:"number",id:"deliveryFee",value:h,onChange:Q=>f(Q.target.value),placeholder:"0",className:N}),n.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-bold text-sm pointer-events-none",children:"."})]})]}),y&&n.jsx("div",{className:"text-red-400 text-xs font-bold bg-red-900/20 p-3 rounded-xl border border-red-500/30 text-center animate-bounce",children:y})]}),n.jsx("div",{className:"p-5 bg-[#151e2d] border-t border-gray-700 relative z-10",children:n.jsx("button",{type:"button",onClick:B,className:`w-full py-4 text-base font-bold text-white rounded-xl shadow-lg shadow-black/20 transition-all active:scale-[0.98] flex justify-center items-center gap-2 ${L}`,children:T})})]})}),document.body)},e$=({users:s,onClose:e,onSelect:t,title:r})=>{const[i,l]=w.useState(""),[d,h]=w.useState(7),f=w.useMemo(()=>{const b=i.toLowerCase();return s.filter(y=>{const v=y.role==="driver"?"":y.role==="merchant"?"":y.role==="admin"?"":"";return y.name.toLowerCase().includes(b)||y.phone&&y.phone.includes(b)||v.includes(b)})},[s,i]),m=[{label:"24 ",value:1},{label:"3 ",value:3},{label:"",value:7},{label:"",value:30},{label:"",value:null}];return n.jsx("div",{className:"fixed inset-0 z-[80] bg-black/90 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-2xl border border-gray-700 shadow-2xl flex flex-col max-h-[85vh]",onClick:b=>b.stopPropagation(),children:[n.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-[#151e2d] rounded-t-2xl",children:[n.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[n.jsx(bd,{className:"w-5 h-5 text-yellow-400"}),r]}),n.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:n.jsx(rt,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"p-4 border-b border-gray-700/50 space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"text-xs font-bold text-gray-400 mb-2 flex items-center gap-1",children:[n.jsx(xt,{className:"w-3 h-3"}),"  ( )"]}),n.jsx("div",{className:"flex bg-[#0f172a] p-1 rounded-xl border border-gray-600 overflow-x-auto scrollbar-hide",children:m.map(b=>n.jsx("button",{onClick:()=>h(b.value),className:`flex-1 min-w-[60px] py-2 text-[10px] font-bold rounded-lg transition-all whitespace-nowrap ${d===b.value?"bg-blue-600 text-white shadow-md":"text-gray-400 hover:text-white"}`,children:b.label},b.label))})]}),n.jsxs("div",{className:"relative",children:[n.jsx(Ln,{className:"absolute right-3 top-2.5 w-4 h-4 text-gray-500"}),n.jsx("input",{type:"text",placeholder:"   ...",value:i,onChange:b=>l(b.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-2 pl-4 pr-10 text-white text-sm focus:border-blue-500 outline-none",autoFocus:!0})]})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-2 custom-scrollbar",children:f.length>0?f.map(b=>n.jsxs("button",{onClick:()=>t(b,d),className:"w-full flex items-center justify-between p-3 hover:bg-gray-700/50 rounded-xl transition-colors border-b border-gray-700/30 last:border-0 group",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border border-gray-600",children:b.storeImage?n.jsx("img",{src:b.storeImage,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-5 h-5 text-gray-400"})}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-sm font-bold text-white group-hover:text-yellow-400 transition-colors",children:b.name}),n.jsxs("p",{className:"text-[10px] text-gray-500 flex items-center gap-1",children:[n.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${b.role==="driver"?"bg-orange-500":b.role==="merchant"?"bg-purple-500":b.role==="admin"?"bg-red-500":"bg-blue-500"}`}),b.role==="driver"?"":b.role==="merchant"?"":b.role==="admin"?"":""]})]})]}),n.jsxs("div",{className:"flex flex-col items-end gap-1",children:[n.jsx("div",{className:"bg-blue-600 text-white px-3 py-1 rounded-lg text-xs font-bold shadow-lg shadow-blue-900/20",children:""}),d&&n.jsxs("span",{className:"text-[9px] text-gray-400",children:[d," "]})]})]},b.id)):n.jsx("p",{className:"text-center text-gray-500 py-8 text-sm",children:"  "})})]})})},Mg={All:({className:s})=>n.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[n.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),n.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),n.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),n.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),Restaurant:({className:s})=>n.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[n.jsx("path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"}),n.jsx("path",{d:"M7 2v20"}),n.jsx("path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"})]}),Market:({className:s})=>n.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[n.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),n.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),Pharmacy:({className:s})=>n.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[n.jsx("path",{d:"M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8z"}),n.jsx("path",{d:"M12 7v10"}),n.jsx("path",{d:"M7 12h10"})]})},Mk=({onClose:s,currentTheme:e,onUpdateTheme:t,appConfig:r,onUpdateAppConfig:i,users:l,onUpdateUser:d,sendNotification:h,currentUser:f})=>{const[m,b]=w.useState("main"),[y,v]=w.useState("frames"),[N,E]=w.useState(!1),[I,T]=w.useState(!1),[L,$]=w.useState(!1),[B,Q]=w.useState(""),[Z,Y]=w.useState(null),[C,P]=w.useState("frame"),[U,O]=w.useState(!1),[D,F]=w.useState(null),[S,ae]=w.useState(""),[K,k]=w.useState(!1),[q,W]=w.useState([]),[ne,M]=w.useState(r==null?void 0:r.customFont),[R,V]=w.useState(null),X=w.useRef(null),H=w.useRef(null),se=w.useRef(null),[J,oe]=w.useState(null),[je,ye]=w.useState(null);Wt(()=>U?(O(!1),!0):R!=null&&R.isOpen?(V(null),!0):I?(T(!1),!0):L?($(!1),!0):m!=="main"?(b("main"),!0):(s(),!0),[m,I,R,L,U]),w.useEffect(()=>{M(r==null?void 0:r.customFont)},[r==null?void 0:r.customFont]),w.useEffect(()=>{var Te;(Te=e.customer)!=null&&Te.categories&&e.customer.categories.length>0?W(e.customer.categories):W([{id:"all",key:"cat_all",label:"",isVisible:!0,sortOrder:0},{id:"restaurant",key:"cat_restaurant",label:"",isVisible:!0,sortOrder:1},{id:"market",key:"cat_market",label:"",isVisible:!0,sortOrder:2},{id:"pharmacy",key:"cat_pharmacy",label:"",isVisible:!0,sortOrder:3}])},[e]);const Pe=(Te,we)=>{const pe={...e[Te]||{icons:{},splash:{},layout:{}},...we};t(Te,pe),E(!0),setTimeout(()=>E(!1),1500)},Fe=Te=>{var De;oe(Te);const we=q.find(pe=>pe.id===Te);ye((we==null?void 0:we.icon)||null),(De=X.current)==null||De.click()},Re=Te=>new Promise((we,De)=>{const pe=new FileReader;pe.onload=Le=>{var Ze;const qe=new Image;qe.src=(Ze=Le.target)==null?void 0:Ze.result,qe.onload=()=>{const pt=document.createElement("canvas"),mt=128;pt.width=mt,pt.height=mt;const Ns=pt.getContext("2d");if(!Ns){De("Canvas error");return}const Dt=Math.min(mt/qe.width,mt/qe.height),Cs=mt/2-qe.width/2*Dt,Un=mt/2-qe.height/2*Dt;Ns.drawImage(qe,Cs,Un,qe.width*Dt,qe.height*Dt),we(pt.toDataURL("image/png"))},qe.onerror=De},pe.onerror=De,pe.readAsDataURL(Te)}),lt=async Te=>{var De;const we=(De=Te.target.files)==null?void 0:De[0];if(we&&J){k(!0);try{const pe=await Re(we),Le=q.map(qe=>qe.id===J?{...qe,icon:pe}:qe);W(Le),Pe("customer",{categories:Le}),ye(pe)}catch(pe){console.error("Error processing icon:",pe),alert("    ")}finally{k(!1)}}X.current&&(X.current.value="")},We=async Te=>{var De;const we=(De=Te.target.files)==null?void 0:De[0];if(we){if(!we.name.endsWith(".ttf")){alert("       .ttf");return}k(!0);const pe=new FileReader;pe.onload=Le=>{var Ze;const qe=(Ze=Le.target)==null?void 0:Ze.result;M(qe),i&&r&&(i({...r,customFont:qe}),E(!0),setTimeout(()=>E(!1),2e3)),k(!1)},pe.onerror=()=>{k(!1),alert("   ")},pe.readAsDataURL(we)}se.current&&(se.current.value="")},it=()=>{V({isOpen:!0,title:"  ",message:"         ",variant:"danger",onConfirm:()=>{M(void 0),i&&r&&(i({...r,customFont:""}),E(!0),setTimeout(()=>E(!1),2e3)),V(null)}})},ke=Te=>{var De;const we=(De=Te.target.files)==null?void 0:De[0];if(we){if(!we.type.includes("png")&&!we.type.includes("gif")){alert("    PNG  GIF");return}const pe=new FileReader;pe.onload=Le=>{var qe;Y((qe=Le.target)==null?void 0:qe.result)},pe.readAsDataURL(we)}H.current&&(H.current.value="")},et=()=>{if(!B||!Z)return;const we={id:`${C}_${Date.now()}`,label:B,url:Z,type:C},pe=[...C==="frame"?e.customer.customFrames||[]:e.customer.customBadges||[],we];Pe("customer",C==="frame"?{customFrames:pe}:{customBadges:pe}),Q(""),Y(null),$(!1)},ge=(Te,we)=>{V({isOpen:!0,title:` ${we==="frame"?"":""}`,message:"    ",variant:"danger",onConfirm:()=>{const pe=(we==="frame"?e.customer.customFrames||[]:e.customer.customBadges||[]).filter(Le=>Le.id!==Te);Pe("customer",we==="frame"?{customFrames:pe}:{customBadges:pe}),V(null)}})},ee=Te=>{F(Te),O(!0)},fe=(Te,we)=>{if(!D)return;const De={},pe=D.type==="frame"?"":"";let Le=null;if(we){const pt=new Date;pt.setDate(pt.getDate()+we),Le=pt.toISOString()}D.type==="frame"?(De.specialFrame=D.url,De.specialFrameExpiry=Le):(De.specialBadge=D.url,De.specialBadgeExpiry=Le),d(Te.id,De);const qe=we?` ${we} `:" ",Ze=`!   ${pe}  (${D.label}) ${qe}.     !`;h(Te.role,{title:" ! ",body:Ze,targetId:Te.id,url:"/?target=profile"}),O(!1),F(null),E(!0),setTimeout(()=>E(!1),2e3)},_e=()=>{if(!S.trim())return;const Te=`cat_${Date.now()}`,we={id:Te,key:Te,label:S,isVisible:!0,sortOrder:q.length},De=[...q,we];W(De),Pe("customer",{categories:De}),ae(""),T(!1)},Me=Te=>{V({isOpen:!0,title:" ",message:"      ",variant:"danger",onConfirm:()=>{const we=q.filter(De=>De.id!==Te);W(we),Pe("customer",{categories:we}),V(null)}})},st=Te=>{const we=q.map(De=>De.id===Te?{...De,isVisible:!De.isVisible}:De);W(we),Pe("customer",{categories:we})},tt=Te=>{V({isOpen:!0,title:" ",message:"      ",variant:"primary",onConfirm:()=>{const we=q.map(De=>De.id===Te?{...De,icon:void 0}:De);W(we),Pe("customer",{categories:we}),V(null)}})},Ie=(Te,we)=>{const De=q.map(pe=>pe.id===Te?{...pe,label:we}:pe);W(De)},$e=()=>{Pe("customer",{categories:q})},bt=w.useMemo(()=>l.filter(Te=>Te.specialFrame||Te.specialBadge),[l]),Lt=(Te,we)=>{V({isOpen:!0,title:` ${we==="frame"?"":""}`,message:`     ${we==="frame"?"":""}  ${Te.name}`,variant:"danger",onConfirm:()=>{const De={};we==="frame"?(De.specialFrame=null,De.specialFrameExpiry=null):(De.specialBadge=null,De.specialBadgeExpiry=null),d(Te.id,De),V(null)}})},At=e.customer.customFrames||[],os=e.customer.customBadges||[],nn=()=>{switch(m){case"categories":return" ";case"decorations":return" ";case"active_gifts":return"  ";default:return" "}};return f==null||f.role,n.jsxs("div",{className:"fixed inset-0 z-[60] bg-[#0f172a] text-white flex flex-col overflow-hidden animate-fadeIn",children:[N&&n.jsx("div",{className:"absolute inset-0 z-[70] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-fadeIn",children:n.jsxs("div",{className:"bg-green-600 px-6 py-3 rounded-full shadow-2xl flex items-center gap-2 animate-bounce",children:[n.jsx(Xe,{className:"w-6 h-6 text-white"}),n.jsx("span",{className:"font-bold text-white",children:"  "})]})}),n.jsx("div",{className:"flex-none px-4 pt-safe h-16 box-content flex items-center justify-between border-b border-gray-800 bg-[#1e293b]/90 backdrop-blur-md sticky top-0 z-20 shadow-md",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{onClick:m==="main"?s:()=>b("main"),className:"p-2 rounded-full bg-gray-800 hover:bg-gray-700 transition-colors border border-gray-700",children:n.jsx(zs,{className:"w-6 h-6 rotate-180"})}),n.jsx("h1",{className:"text-xl font-black tracking-wide",children:nn()})]})}),n.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[n.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-blue-600/5 rounded-full blur-[120px] pointer-events-none translate-x-1/2 -translate-y-1/2"}),m==="main"&&n.jsx("div",{className:"h-full overflow-y-auto custom-scrollbar",children:n.jsxs("div",{className:"max-w-5xl mx-auto w-full p-6 flex flex-col gap-8 min-h-full",children:[n.jsxs("div",{className:"bg-[#1e293b]/80 backdrop-blur-sm rounded-[2rem] p-6 border border-gray-700 shadow-xl relative overflow-hidden group",children:[n.jsx("div",{className:"absolute top-0 left-0 w-1.5 h-full bg-blue-500"}),n.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start md:items-center",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[n.jsx(tf,{className:"w-6 h-6 text-blue-400"})," "]}),ne&&n.jsxs("span",{className:"bg-green-500/20 text-green-400 text-[10px] font-bold px-2 py-1 rounded-full border border-green-500/20 flex items-center gap-1",children:[n.jsx(Xe,{className:"w-3 h-3"})," "]})]}),n.jsxs("p",{className:"text-gray-400 text-sm leading-relaxed",children:["     ",n.jsx("code",{children:".ttf"}),"        ."]})]}),n.jsxs("div",{className:"flex gap-3 w-full md:w-auto",children:[n.jsx("button",{onClick:()=>{var Te;return(Te=se.current)==null?void 0:Te.click()},disabled:K,className:"flex-1 md:flex-none bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg active:scale-95 transition-all flex justify-center items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed min-w-[160px]",children:K?n.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):n.jsxs(n.Fragment,{children:[n.jsx(gr,{className:"w-5 h-5"}),n.jsx("span",{children:"  (.ttf)"})]})}),ne&&n.jsx("button",{onClick:it,className:"px-4 bg-red-500/10 hover:bg-red-500/20 text-red-400 font-bold py-3 rounded-xl transition-colors border border-red-500/20",title:"  ",children:n.jsx(jt,{className:"w-5 h-5"})})]}),n.jsx("input",{type:"file",ref:se,accept:".ttf",className:"hidden",onChange:We})]})]}),n.jsxs("div",{children:[n.jsxs("h2",{className:"text-lg font-bold text-gray-400 mb-4 px-2 flex items-center gap-2",children:[n.jsx(Nv,{className:"w-5 h-5"})," "]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[n.jsxs("button",{onClick:()=>b("categories"),className:"group relative overflow-hidden bg-gradient-to-br from-cyan-900 to-blue-900 rounded-[2rem] p-8 flex items-center justify-between shadow-lg hover:shadow-cyan-500/20 transition-all active:scale-98 border border-white/5 h-40",children:[n.jsxs("div",{className:"z-10 text-right",children:[n.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:translate-x-1 transition-transform",children:" "}),n.jsx("p",{className:"text-cyan-200 text-sm font-medium",children:"   "})]}),n.jsx("div",{className:"w-16 h-16 bg-white/10 rounded-2xl flex items-center justify-center z-10 backdrop-blur-sm border border-white/10 group-hover:scale-110 transition-transform duration-500",children:n.jsx(bn,{className:"w-8 h-8 text-cyan-300"})}),n.jsx("div",{className:"absolute -bottom-10 -left-10 w-40 h-40 bg-cyan-500/20 rounded-full blur-[50px] group-hover:bg-cyan-400/30 transition-colors"})]}),n.jsxs("button",{onClick:()=>b("decorations"),className:"group relative overflow-hidden bg-gradient-to-br from-purple-900 to-pink-900 rounded-[2rem] p-8 flex items-center justify-between shadow-lg hover:shadow-purple-500/20 transition-all active:scale-98 border border-white/5 h-40",children:[n.jsxs("div",{className:"z-10 text-right",children:[n.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:translate-x-1 transition-transform",children:" "}),n.jsx("p",{className:"text-purple-200 text-sm font-medium",children:"   "})]}),n.jsx("div",{className:"w-16 h-16 bg-white/10 rounded-2xl flex items-center justify-center z-10 backdrop-blur-sm border border-white/10 group-hover:scale-110 transition-transform duration-500",children:n.jsx(ra,{className:"w-8 h-8 text-purple-300"})}),n.jsx("div",{className:"absolute -bottom-10 -left-10 w-40 h-40 bg-purple-500/20 rounded-full blur-[50px] group-hover:bg-purple-400/30 transition-colors"})]}),n.jsxs("button",{onClick:()=>b("active_gifts"),className:"group relative overflow-hidden bg-gradient-to-br from-gray-800 to-gray-900 rounded-[2rem] p-8 flex items-center justify-between shadow-lg hover:shadow-gray-500/20 transition-all active:scale-98 border border-white/5 h-40 md:col-span-2",children:[n.jsxs("div",{className:"z-10 text-right",children:[n.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:translate-x-1 transition-transform",children:"  "}),n.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"   "})]}),n.jsx("div",{className:"w-16 h-16 bg-white/10 rounded-2xl flex items-center justify-center z-10 backdrop-blur-sm border border-white/10 group-hover:scale-110 transition-transform duration-500",children:n.jsx(Mr,{className:"w-8 h-8 text-white"})})]})]})]})]})}),m==="active_gifts"&&n.jsx("div",{className:"h-full overflow-y-auto custom-scrollbar p-6 bg-[#0f172a]",children:n.jsx("div",{className:"max-w-4xl mx-auto space-y-4",children:bt.length===0?n.jsxs("div",{className:"text-center py-20 text-gray-500 bg-gray-800/30 rounded-3xl border border-dashed border-gray-700",children:[n.jsx(bd,{className:"w-16 h-16 mx-auto mb-4 opacity-30"}),n.jsx("p",{className:"font-bold",children:"   "})]}):n.jsx("div",{className:"grid gap-4",children:bt.map(Te=>{const we=Te.specialFrameExpiry?new Date(Te.specialFrameExpiry):null,De=Te.specialBadgeExpiry?new Date(Te.specialBadgeExpiry):null,pe=new Date,Le=qe=>{if(!qe)return"";const Ze=qe.getTime()-pe.getTime(),pt=Math.ceil(Ze/(1e3*60*60*24));return pt>0?` ${pt} `:""};return n.jsxs("div",{className:"bg-[#1e293b] p-4 rounded-2xl border border-gray-700 shadow-md flex flex-col md:flex-row items-center justify-between gap-4",children:[n.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border border-gray-600",children:Te.storeImage?n.jsx("img",{src:Te.storeImage,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-6 h-6 text-gray-400"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-bold text-white text-lg",children:Te.name}),n.jsx("p",{className:"text-gray-400 text-xs font-mono",children:Te.phone})]})]}),n.jsxs("div",{className:"flex flex-col md:flex-row gap-4 w-full md:w-auto",children:[Te.specialFrame&&n.jsxs("div",{className:"bg-black/20 p-3 rounded-xl border border-white/5 flex items-center gap-3 flex-1",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center overflow-hidden",children:Te.specialFrame.startsWith("http")||Te.specialFrame.startsWith("data:")?n.jsx("img",{src:Te.specialFrame,className:"w-full h-full object-cover"}):n.jsx("span",{className:"text-[10px]",children:""})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-xs text-gray-300 font-bold",children:""}),n.jsx("p",{className:"text-[10px] text-yellow-500",children:Le(we)})]}),n.jsx("button",{onClick:()=>Lt(Te,"frame"),className:"text-red-400 hover:bg-red-500/10 p-2 rounded-lg transition-colors",children:n.jsx(jt,{className:"w-4 h-4"})})]}),Te.specialBadge&&n.jsxs("div",{className:"bg-black/20 p-3 rounded-xl border border-white/5 flex items-center gap-3 flex-1",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center overflow-hidden",children:Te.specialBadge.startsWith("http")||Te.specialBadge.startsWith("data:")?n.jsx("img",{src:Te.specialBadge,className:"w-full h-full object-cover"}):n.jsx("span",{className:"text-[10px]",children:""})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-xs text-gray-300 font-bold",children:""}),n.jsx("p",{className:"text-[10px] text-blue-400",children:Le(De)})]}),n.jsx("button",{onClick:()=>Lt(Te,"badge"),className:"text-red-400 hover:bg-red-500/10 p-2 rounded-lg transition-colors",children:n.jsx(jt,{className:"w-4 h-4"})})]})]})]},Te.id)})})})}),m==="decorations"&&n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsxs("div",{className:"flex border-b border-gray-800 bg-[#151e2d] z-10 shadow-sm flex-none",children:[n.jsxs("button",{onClick:()=>v("frames"),className:`flex-1 py-4 font-bold text-sm transition-colors relative ${y==="frames"?"text-white":"text-gray-500 hover:text-gray-300"}`,children:[" (Frames)",y==="frames"&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-purple-500"})]}),n.jsxs("button",{onClick:()=>v("badges"),className:`flex-1 py-4 font-bold text-sm transition-colors relative ${y==="badges"?"text-white":"text-gray-500 hover:text-gray-300"}`,children:[" (Badges)",y==="badges"&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-500"})]})]}),n.jsxs("div",{className:"flex-none p-4 bg-[#1a1a1a] border-b border-gray-800 flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsx("h3",{className:`font-bold text-lg ${y==="frames"?"text-purple-400":"text-blue-400"}`,children:y==="frames"?" ":" "}),n.jsx("p",{className:"text-xs text-gray-400",children:y==="frames"?" GIF  PNG .":"   ."})]}),n.jsxs("button",{onClick:()=>{P(y==="frames"?"frame":"badge"),$(!0)},className:`px-4 py-2 rounded-xl text-sm font-bold flex items-center gap-2 transition-colors shadow-lg active:scale-95 ${y==="frames"?"bg-purple-600 hover:bg-purple-700 text-white shadow-purple-900/20":"bg-blue-600 hover:bg-blue-700 text-white shadow-blue-900/20"}`,children:[n.jsx(Gs,{className:"w-4 h-4"}),"  "]})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar bg-[#0f172a]",children:y==="frames"?n.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 pb-10",children:At.length>0?At.map(Te=>n.jsxs("div",{className:"bg-[#1e293b] p-4 rounded-xl border border-gray-700 flex flex-col items-center gap-3 relative group hover:border-purple-500 transition-colors shadow-sm",children:[n.jsxs("div",{className:"relative w-24 h-24 flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 m-auto w-20 h-20 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border-2 border-gray-600",children:n.jsx(dt,{className:"w-10 h-10 text-gray-500"})}),n.jsx("img",{src:Te.url,className:"absolute inset-0 w-full h-full object-contain pointer-events-none z-10",alt:Te.label})]}),n.jsx("div",{className:"text-center w-full",children:n.jsx("p",{className:"font-bold text-sm truncate w-full text-gray-200",children:Te.label})}),n.jsxs("div",{className:"flex gap-2 w-full justify-center",children:[n.jsxs("button",{onClick:()=>ee(Te),className:"px-3 py-1.5 bg-yellow-500/10 text-yellow-400 rounded-lg text-xs font-bold hover:bg-yellow-500/20 transition-colors flex items-center gap-1",children:[n.jsx(bd,{className:"w-3 h-3"})," "]}),(f==null?void 0:f.role)==="admin"&&n.jsx("button",{onClick:()=>ge(Te.id,"frame"),className:"p-1.5 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500/20 transition-colors",title:"  ",children:n.jsx(jt,{className:"w-4 h-4"})})]})]},Te.id)):n.jsxs("div",{className:"col-span-full py-20 text-center text-gray-500 border-2 border-dashed border-gray-800 rounded-2xl",children:[n.jsx(fr,{className:"w-12 h-12 mx-auto mb-2 opacity-30"}),n.jsx("p",{className:"font-bold",children:" "}),n.jsx("p",{className:"text-xs",children:"    "})]})}):n.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3 pb-10",children:os.length>0?os.map(Te=>n.jsxs("div",{className:"bg-[#1e293b] p-3 rounded-2xl border border-gray-700 flex flex-col items-center gap-3 relative group hover:border-blue-500 transition-colors shadow-sm",children:[n.jsxs("div",{className:"w-20 h-20 bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl flex items-center justify-center border border-gray-600 shadow-inner relative overflow-hidden group-hover:border-blue-500 transition-colors",children:[n.jsx("div",{className:"absolute inset-0 bg-blue-500/5 opacity-0 group-hover:opacity-100 transition-opacity"}),n.jsx("img",{src:Te.url,className:"w-full h-full object-contain p-3 drop-shadow-md",alt:Te.label})]}),n.jsx("p",{className:"font-bold text-xs truncate w-full text-center text-gray-200",children:Te.label}),n.jsxs("div",{className:"flex gap-2 w-full justify-center mt-auto",children:[n.jsx("button",{onClick:()=>ee(Te),className:"px-3 py-1.5 bg-yellow-500/10 text-yellow-400 rounded-lg text-xs font-bold hover:bg-yellow-500/20 transition-colors flex-1 flex items-center justify-center gap-1",title:"",children:n.jsx(bd,{className:"w-3 h-3"})}),(f==null?void 0:f.role)==="admin"&&n.jsx("button",{onClick:()=>ge(Te.id,"badge"),className:"p-1.5 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500/20 transition-colors",title:"  ",children:n.jsx(jt,{className:"w-3 h-3"})})]})]},Te.id)):n.jsxs("div",{className:"col-span-full py-20 text-center text-gray-500 border-2 border-dashed border-gray-800 rounded-2xl",children:[n.jsx(ra,{className:"w-12 h-12 mx-auto mb-2 opacity-30"}),n.jsx("p",{className:"font-bold",children:" "}),n.jsx("p",{className:"text-xs",children:"   "})]})})})]}),m==="categories"&&n.jsxs("div",{className:"flex flex-col h-full",children:[n.jsxs("div",{className:"flex-none p-6 border-b border-gray-800 bg-[#1a1a1a] flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-lg text-white",children:" "}),n.jsx("p",{className:"text-xs text-gray-400",children:"     "})]}),n.jsxs("button",{onClick:()=>T(!0),className:"bg-cyan-600 hover:bg-cyan-700 text-white px-4 py-2 rounded-xl text-sm font-bold flex items-center gap-2 transition-colors shadow-lg shadow-cyan-900/20 active:scale-95",children:[n.jsx(Gs,{className:"w-4 h-4"}),"  "]})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-[#0f172a] custom-scrollbar",children:n.jsx("div",{className:"grid gap-3 max-w-4xl mx-auto pb-10",children:q.map((Te,we)=>{const De=Te.key==="cat_all"?Mg.All:Te.key==="cat_restaurant"?Mg.Restaurant:Te.key==="cat_market"?Mg.Market:Te.key==="cat_pharmacy"?Mg.Pharmacy:bn;return n.jsxs("div",{className:"bg-[#1e293b] p-3 rounded-2xl border border-gray-700 flex items-center gap-4 group hover:border-gray-500 transition-colors shadow-sm",children:[n.jsxs("div",{onClick:()=>Fe(Te.id),className:"w-14 h-14 bg-[#0f172a] rounded-xl flex items-center justify-center cursor-pointer border border-gray-600 hover:border-blue-500 relative overflow-hidden flex-shrink-0 shadow-inner group-hover:scale-105 transition-transform",children:[K&&J===Te.id?n.jsx("div",{className:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}):Te.icon?n.jsx("img",{src:Te.icon,alt:Te.label,className:"w-full h-full object-contain p-3"}):n.jsx(De,{className:"w-6 h-6 text-gray-500"}),n.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center transition-opacity backdrop-blur-[1px]",children:n.jsx(Jn,{className:"w-4 h-4 text-white"})})]}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("input",{type:"text",value:Te.label,onChange:pe=>Ie(Te.id,pe.target.value),onBlur:$e,className:"w-full bg-transparent text-white font-bold text-lg outline-none border-b border-transparent focus:border-blue-500 pb-1 transition-colors"}),n.jsxs("p",{className:"text-[10px] text-gray-500 truncate font-mono mt-1 opacity-60",children:["ID: ",Te.key]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[Te.icon&&n.jsx("button",{onClick:()=>tt(Te.id),className:"p-2.5 rounded-xl text-yellow-400 bg-yellow-400/10 hover:bg-yellow-400/20 transition-colors border border-yellow-400/20",title:" ",children:n.jsx(ef,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>st(Te.id),className:`p-2.5 rounded-xl transition-colors border ${Te.isVisible?"text-green-400 bg-green-400/10 border-green-400/20":"text-gray-500 bg-gray-800 border-gray-700"}`,title:Te.isVisible?"":"",children:Te.isVisible?n.jsx(na,{className:"w-4 h-4"}):n.jsx(wi,{className:"w-4 h-4"})}),Te.id!=="all"&&n.jsx("button",{onClick:()=>Me(Te.id),className:"p-2.5 rounded-xl text-red-400 bg-red-400/10 hover:bg-red-400/20 transition-colors border border-red-400/20",title:"",children:n.jsx(jt,{className:"w-4 h-4"})})]})]},Te.id)})})})]})]}),L&&n.jsx("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>$(!1),children:n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-3xl border border-gray-700 shadow-2xl p-6 animate-pop-in",onClick:Te=>Te.stopPropagation(),children:[n.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2",children:[n.jsx(gr,{className:"w-6 h-6 text-green-500"}),C==="frame"?"  ":"  "]}),n.jsxs("div",{className:"space-y-5",children:[n.jsx("div",{onClick:()=>{var Te;return(Te=H.current)==null?void 0:Te.click()},className:`w-full h-40 bg-[#0f172a] border-2 border-dashed ${Z?"border-green-500":"border-gray-600"} rounded-2xl flex flex-col items-center justify-center cursor-pointer hover:bg-gray-800 transition-colors group relative overflow-hidden`,children:Z?n.jsx("img",{src:Z,alt:"Preview",className:"h-full object-contain p-4 animate-fadeIn"}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-12 h-12 bg-gray-800 rounded-full flex items-center justify-center mb-2 group-hover:scale-110 transition-transform",children:n.jsx(fr,{className:"w-6 h-6 text-gray-500 group-hover:text-white"})}),n.jsx("span",{className:"text-xs text-gray-400 font-medium",children:"   (PNG/GIF)"})]})}),n.jsx("input",{ref:H,type:"file",accept:"image/png, image/gif",className:"hidden",onChange:ke}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2",children:" / "}),n.jsx("input",{type:"text",value:B,onChange:Te=>Q(Te.target.value),placeholder:C==="frame"?":   ":":   ",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3.5 text-white focus:border-green-500 outline-none transition-colors"})]}),n.jsx("button",{onClick:et,disabled:!B.trim()||!Z,className:"w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3.5 rounded-xl shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all active:scale-95",children:" "})]})]})}),U&&D&&n.jsx(e$,{users:l,onClose:()=>O(!1),onSelect:fe,title:` ${D.type==="frame"?"":""} "${D.label}"`}),I&&n.jsx("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>T(!1),children:n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-3xl border border-gray-700 shadow-2xl p-6 animate-pop-in",onClick:Te=>Te.stopPropagation(),children:[n.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2",children:[n.jsx(Gs,{className:"w-6 h-6 text-blue-500"}),"  "]}),n.jsxs("div",{className:"space-y-5",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2",children:"  (  )"}),n.jsx("input",{type:"text",value:S,onChange:Te=>ae(Te.target.value),placeholder:":  ...",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3.5 text-white focus:border-blue-500 outline-none transition-colors",autoFocus:!0})]}),n.jsx("button",{onClick:_e,disabled:!S.trim(),className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3.5 rounded-xl shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all active:scale-95",children:""})]})]})}),R&&n.jsx(fs,{title:R.title,message:R.message,onClose:()=>V(null),onConfirm:R.onConfirm,confirmVariant:R.variant||"primary",confirmButtonText:" "}),n.jsx("input",{type:"file",ref:X,className:"hidden",accept:"image/*",onChange:lt})]})},Lk=({logs:s,onClearLogs:e})=>{const[t,r]=w.useState(""),[i,l]=w.useState("all"),[d,h]=w.useState(!1),[f,m]=w.useState(20),b=w.useMemo(()=>(m(20),s.filter(T=>{const L=T.actorName.toLowerCase().includes(t.toLowerCase())||T.target.toLowerCase().includes(t.toLowerCase())||T.details.toLowerCase().includes(t.toLowerCase()),$=i==="all"||T.actionType===i;return L&&$}).sort((T,L)=>{const $=new Date(T.createdAt).getTime();return new Date(L.createdAt).getTime()-$})),[s,t,i]),y=w.useMemo(()=>b.slice(0,f),[b,f]),v=T=>{switch(T){case"create":return"text-green-400 bg-green-500/10 border-green-500/20";case"delete":return"text-red-400 bg-red-500/10 border-red-500/20";case"update":return"text-blue-400 bg-blue-500/10 border-blue-500/20";case"login":return"text-purple-400 bg-purple-500/10 border-purple-500/20";case"financial":return"text-yellow-400 bg-yellow-500/10 border-yellow-500/20";default:return"text-gray-400 bg-gray-500/10 border-gray-500/20"}},N=T=>{switch(T){case"create":return" ";case"delete":return" ";case"update":return" ";case"login":return" ";case"financial":return" ";default:return T}},E=T=>{try{const L=new Date(T);if(isNaN(L.getTime()))return{dayName:" ",dateStr:"--",timeStr:"--"};const $=L.toLocaleDateString("ar-EG-u-nu-latn",{weekday:"long"}),B=L.toLocaleDateString("ar-EG-u-nu-latn",{day:"numeric",month:"long",year:"numeric"}),Q=L.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"2-digit",minute:"2-digit",hour12:!0});return{dayName:$,dateStr:B,timeStr:Q}}catch{return{dayName:"-",dateStr:"-",timeStr:"-"}}},I=()=>{e(),h(!1)};return n.jsxs("div",{className:"space-y-6 pb-24 animate-fadeIn",children:[n.jsxs("div",{className:"bg-gray-800 p-4 rounded-2xl shadow-lg border border-gray-700/50 flex flex-col md:flex-row gap-4 items-center",children:[n.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[n.jsx("div",{className:"p-3 bg-blue-500/20 rounded-xl text-blue-400",children:n.jsx(Or,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-white",children:" "}),n.jsx("p",{className:"text-xs text-gray-400",children:"     "})]})]}),n.jsxs("div",{className:"relative flex-1 w-full flex items-center gap-3",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(Ln,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 w-5 h-5"}),n.jsx("input",{type:"text",placeholder:"     ...",value:t,onChange:T=>r(T.target.value),className:"w-full bg-gray-900 text-white rounded-xl py-3 pr-12 pl-4 border border-gray-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition-all placeholder-gray-500"})]}),s.length>0&&n.jsx("button",{onClick:()=>h(!0),className:"bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/20 p-3 rounded-xl transition-all active:scale-95",title:" ",children:n.jsx(jt,{className:"w-6 h-6"})})]})]}),n.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:["all","create","update","delete","financial","login"].map(T=>n.jsx("button",{onClick:()=>l(T),className:`px-4 py-2 rounded-lg text-xs font-bold whitespace-nowrap transition-colors border ${i===T?"bg-blue-600 text-white border-blue-600 shadow-lg":"bg-gray-800 text-gray-400 border-gray-700 hover:bg-gray-700"}`,children:T==="all"?"":N(T)},T))}),n.jsx("div",{className:"space-y-3",children:y.length>0?y.map(T=>{const{dayName:L,dateStr:$,timeStr:B}=E(T.createdAt);return n.jsxs("div",{className:"bg-[#1e293b] rounded-xl p-4 border border-gray-700 hover:border-gray-500 transition-all flex flex-col md:flex-row gap-4 items-start md:items-center justify-between shadow-sm group",children:[n.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[n.jsx("div",{className:`p-2.5 rounded-xl border mt-1 shadow-inner ${v(T.actionType)}`,children:n.jsx(Or,{className:"w-5 h-5"})}),n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsxs("span",{className:"text-white font-bold text-sm flex items-center gap-1",children:[n.jsx(dt,{className:"w-3 h-3 text-gray-500"}),T.actorName]}),n.jsx("span",{className:"text-gray-600 text-xs",children:"|"}),n.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded border font-bold ${v(T.actionType)}`,children:N(T.actionType)}),n.jsx("span",{className:"text-gray-500 text-xs bg-black/20 px-2 py-0.5 rounded border border-white/5 font-mono",children:T.target})]}),n.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:T.details})]})]}),n.jsxs("div",{className:"flex flex-col items-end gap-1 text-xs text-gray-500 bg-black/20 px-3 py-2 rounded-lg border border-white/5 w-full md:w-auto",children:[n.jsxs("div",{className:"flex items-center gap-1.5 text-gray-400",children:[n.jsx(Ba,{className:"w-3 h-3"}),n.jsxs("span",{children:[L," ",$]})]}),n.jsxs("div",{className:"flex items-center gap-1.5 text-gray-300 font-bold font-mono",children:[n.jsx(xt,{className:"w-3 h-3 text-blue-400"}),n.jsx("span",{children:B})]})]})]},T.id)}):n.jsxs("div",{className:"text-center py-16 text-gray-500 bg-gray-800/30 rounded-2xl border border-dashed border-gray-700",children:[n.jsx(Or,{className:"w-16 h-16 mx-auto mb-4 opacity-20"}),n.jsx("h3",{className:"text-lg font-bold text-gray-400",children:"  "}),n.jsx("p",{className:"text-xs mt-1",children:"       ."})]})}),b.length>f&&n.jsxs("button",{onClick:()=>m(T=>T+20),className:"w-full py-3 bg-gray-800 hover:bg-gray-700 text-gray-300 font-bold rounded-xl transition-all",children:["  (",b.length-f," )"]}),d&&n.jsx(fs,{title:"  ",message:"               .",onClose:()=>h(!1),onConfirm:I,confirmButtonText:"  ",confirmVariant:"danger"})]})},Vk=({promoCodes:s,pointsConfig:e,onAddPromo:t,onDeletePromo:r,onUpdatePointsConfig:i})=>{const[l,d]=w.useState("promos"),[h,f]=w.useState(!1),[m,b]=w.useState(""),[y,v]=w.useState(""),[N,E]=w.useState("percentage"),[I,T]=w.useState(""),[L,$]=w.useState((e==null?void 0:e.isPointsEnabled)??!0),[B,Q]=w.useState("1"),[Z,Y]=w.useState(String((e==null?void 0:e.pointsPerCurrency)||1)),[C,P]=w.useState((e==null?void 0:e.currencyPerPoint)||.1);w.useEffect(()=>{$((e==null?void 0:e.isPointsEnabled)??!0),P((e==null?void 0:e.currencyPerPoint)||.1);const D=(e==null?void 0:e.pointsPerCurrency)||1;D<1&&1/D%10===0?(Q(String(1/D)),Y("1")):(Q("1"),Y(String(D)))},[e]);const U=()=>{if(!m||!y)return;const D={id:`PROMO-${Date.now()}`,code:m.toUpperCase(),type:N,value:parseFloat(y),isActive:!0,usageCount:0,maxUsage:I?parseInt(I):void 0};t(D),b(""),v(""),T("")},O=()=>{const D=parseFloat(B),F=parseFloat(Z);if(isNaN(D)||D<=0||isNaN(F)||F<0){alert("      .");return}const S=F/D;i({pointsPerCurrency:S,currencyPerPoint:C,isPointsEnabled:L}),f(!0),setTimeout(()=>f(!1),2e3)};return n.jsxs("div",{className:"space-y-6 pb-24 animate-fadeIn relative",children:[h&&n.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm animate-fadeIn",children:n.jsxs("div",{className:"bg-gray-800 border border-green-500/50 rounded-2xl p-6 shadow-2xl flex flex-col items-center animate-pop-in",children:[n.jsx("div",{className:"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mb-4",children:n.jsx(Xe,{className:"w-10 h-10 text-green-500"})}),n.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),n.jsx("p",{className:"text-gray-400",children:"   ."})]})}),n.jsxs("h2",{className:"text-2xl font-bold text-white mb-6 flex items-center gap-3",children:[n.jsx(tf,{className:"w-8 h-8 text-yellow-500"})," "]}),n.jsxs("div",{className:"flex bg-gray-800 p-1 rounded-xl w-fit mb-6",children:[n.jsx("button",{onClick:()=>d("promos"),className:`px-6 py-2 rounded-lg text-sm font-bold transition-all ${l==="promos"?"bg-yellow-500 text-black shadow-lg":"text-gray-400 hover:text-white"}`,children:" "}),n.jsx("button",{onClick:()=>d("points"),className:`px-6 py-2 rounded-lg text-sm font-bold transition-all ${l==="points"?"bg-yellow-500 text-black shadow-lg":"text-gray-400 hover:text-white"}`,children:" "})]}),l==="promos"?n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-gray-800 p-5 rounded-2xl border border-gray-700 shadow-lg",children:[n.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[n.jsx(Gs,{className:"w-5 h-5 text-green-500"}),"  "]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsx("input",{type:"text",placeholder:" (: SALE20)",value:m,onChange:D=>b(D.target.value),className:"bg-gray-900 border border-gray-600 rounded-xl px-4 py-3 text-white focus:border-yellow-500 outline-none uppercase font-mono"}),n.jsxs("div",{className:"flex bg-gray-900 rounded-xl border border-gray-600 overflow-hidden",children:[n.jsx("input",{type:"number",placeholder:"",value:y,onChange:D=>v(D.target.value),className:"flex-1 bg-transparent px-4 py-3 text-white outline-none"}),n.jsxs("select",{value:N,onChange:D=>E(D.target.value),className:"bg-gray-800 text-gray-300 px-3 text-xs outline-none border-r border-gray-600",children:[n.jsx("option",{value:"percentage",children:"%"}),n.jsx("option",{value:"fixed",children:"."})]})]}),n.jsx("input",{type:"number",placeholder:"   ()",value:I,onChange:D=>T(D.target.value),className:"bg-gray-900 border border-gray-600 rounded-xl px-4 py-3 text-white focus:border-yellow-500 outline-none"}),n.jsx("button",{onClick:U,disabled:!m||!y,className:"bg-green-600 hover:bg-green-700 text-white font-bold rounded-xl py-3 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:" "})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[s.map(D=>n.jsxs("div",{className:"bg-[#1e293b] rounded-xl p-4 border border-gray-700 flex justify-between items-center group relative overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 right-0 w-1 h-full bg-yellow-500"}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-mono font-bold text-white text-lg tracking-wider",children:D.code}),n.jsx("span",{className:"text-xs bg-yellow-500/20 text-yellow-400 px-2 py-0.5 rounded border border-yellow-500/20",children:D.type==="percentage"?`${D.value}%`:`${D.value} .`})]}),n.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[" : ",n.jsx("span",{className:"text-white font-bold",children:D.usageCount})," ",D.maxUsage?`/ ${D.maxUsage}`:""]})]}),n.jsx("button",{onClick:()=>r(D.id),className:"p-2 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500/20 transition-colors",children:n.jsx(jt,{className:"w-5 h-5"})})]},D.id)),s.length===0&&n.jsxs("div",{className:"col-span-full text-center py-10 text-gray-500 bg-gray-800/30 rounded-xl border border-dashed border-gray-700",children:[n.jsx(tf,{className:"w-12 h-12 mx-auto mb-2 opacity-20"}),"   "]})]})]}):n.jsxs("div",{className:"bg-gray-800 p-6 rounded-2xl border border-gray-700 shadow-lg max-w-xl",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6 border-b border-gray-700 pb-4",children:[n.jsx("h3",{className:"text-lg font-bold text-white",children:" "}),n.jsx("button",{onClick:()=>$(!L),className:`relative w-14 h-7 rounded-full transition-colors duration-300 ${L?"bg-green-600":"bg-gray-600"}`,children:n.jsx("div",{className:`absolute top-1 left-1 bg-white w-5 h-5 rounded-full transition-transform duration-300 shadow-md ${L?"translate-x-7":"translate-x-0"}`})})]}),n.jsxs("div",{className:`space-y-6 transition-opacity duration-300 ${L?"opacity-100":"opacity-50 pointer-events-none"}`,children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2 font-bold",children:"  "}),n.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-600 flex items-center gap-3",children:[n.jsx("span",{className:"text-gray-400 text-sm",children:"  "}),n.jsx("div",{className:"relative w-20",children:n.jsx("input",{type:"number",value:Z,onChange:D=>Y(D.target.value),className:"w-full bg-gray-800 border border-gray-500 rounded-lg px-2 py-1.5 text-center text-white font-bold focus:border-yellow-500 outline-none"})}),n.jsx("span",{className:"text-yellow-500 font-bold text-sm",children:""}),n.jsx("span",{className:"text-gray-400 text-sm",children:" "}),n.jsxs("div",{className:"relative w-24",children:[n.jsx("input",{type:"number",value:B,onChange:D=>Q(D.target.value),className:"w-full bg-gray-800 border border-gray-500 rounded-lg px-2 py-1.5 text-center text-white font-bold focus:border-green-500 outline-none"}),n.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-[10px] text-gray-500",children:"."})]})]}),n.jsx("p",{className:"text-[10px] text-gray-500 mt-2 mr-1",children:": 1    100   0.5    1 ."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-400 mb-2 font-bold",children:"   "}),n.jsxs("div",{className:"flex items-center gap-3 bg-gray-900/50 p-4 rounded-xl border border-gray-600",children:[n.jsx(B0,{className:"w-5 h-5 text-yellow-500"}),n.jsx("span",{className:"text-white font-bold text-sm",children:"1  ="}),n.jsx("input",{type:"number",value:C,onChange:D=>P(parseFloat(D.target.value)),className:"w-24 bg-gray-800 border border-gray-500 rounded-lg px-3 py-1.5 text-center text-white font-bold focus:border-green-500 outline-none"}),n.jsx("span",{className:"text-green-500 font-bold text-sm",children:"."})]})]}),n.jsxs("div",{className:"bg-blue-900/20 p-4 rounded-xl border border-blue-500/20 text-sm text-blue-200",children:[n.jsx("p",{className:"font-bold mb-1 text-white",children:" :"}),"    ",n.jsxs("strong",{children:[B||0," ."]}),"   ",n.jsx("strong",{children:Z||0})," .",n.jsx("br",{}),"    ",n.jsx("strong",{children:(parseFloat(Z||"0")*C).toFixed(2)})," ."]})]}),n.jsx("button",{onClick:O,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl transition-colors shadow-lg mt-6",children:" "})]})]})},t$=["    ","     .","  .","    ","  .    "],XT=["","","","","",""],Uk=({users:s,currentUser:e,isRestricted:t,onBack:r})=>{const[i,l]=w.useState([]),[d,h]=w.useState(null),[f,m]=w.useState(""),[b,y]=w.useState(""),[v,N]=w.useState(null),[E,I]=w.useState(!1),[T,L]=w.useState(!1),[$,B]=w.useState(null),[Q,Z]=w.useState(null),[Y,C]=w.useState(null),[P,U]=w.useState(null),[O,D]=w.useState(null),[F,S]=w.useState(!1),[ae,K]=w.useState({isWhatsappEnabled:!0,whatsappNumber:"",isChatEnabled:!0,allowImageSending:!0,isAutoReplyEnabled:!1,autoReplyText:"   .   ."}),k=w.useRef(null),q=w.useRef(null),W=w.useRef(null),ne=w.useRef(null),[M,R]=w.useState(null);Wt(()=>O?(D(null),!0):F?(S(!1),!0):M?(R(null),!0):d?(h(null),!0):r?(r(),!0):!1,[M,d,r,F,O]),w.useEffect(()=>{const ge=Hs("support_chats",fe=>{const _e=fe.sort((Me,st)=>new Date(st.lastUpdated).getTime()-new Date(Me.lastUpdated).getTime());l(_e)}),ee=Hs("settings",fe=>{const _e=fe.find(Me=>Me.id==="support_config");if(_e){const{allowVoiceNotes:Me,...st}=_e;K(tt=>({...tt,...st}))}});return()=>{ge(),ee()}},[]),w.useEffect(()=>{d&&W.current&&!Q&&!O&&W.current.scrollIntoView({behavior:"smooth"})},[i,d,Q]),w.useEffect(()=>{if(d){const ge=i.find(ee=>ee.id===d);ge&&ge.unreadCount>0&&at("support_chats",d,{unreadCount:0})}},[d,i]);const V=w.useMemo(()=>i.find(ge=>ge.id===d),[i,d]),X=w.useMemo(()=>V?s.find(ge=>ge.id===V.userId):null,[V,s]),H=w.useMemo(()=>f?i.filter(ge=>ge.userName.toLowerCase().includes(f.toLowerCase())||ge.userPhone.includes(f)):i,[i,f]),se=async(ge=b,ee=v)=>{if(!ge.trim()&&!ee||!d||!V)return;let fe=[...V.messages||[]],_e=ge;if(Q)fe=fe.map(Me=>Me.id===Q.id?{...Me,text:ge,image:ee||Me.image}:Me),_e=" "+ge;else{let Me=ge;$&&(Me=`[ : ${$.text.substring(0,50)+($.text.length>50?"...":"")}]
${ge}`);const st=fe.reduce((bt,Lt)=>{const At=parseInt(Lt.id);return isNaN(At)?bt:Math.max(bt,At)},0),Ie={id:String(st+1),text:Me,image:ee||void 0,sender:"admin",createdAt:new Date,isRead:!1};fe.push(Ie);const $e=(X==null?void 0:X.role)||"user";qt($e,{title:"   ",body:Me||"   ",targetId:d,url:"/?target=support"})}await at("support_chats",d,{messages:fe,lastMessage:ee?" ":_e,lastUpdated:new Date}),y(""),N(null),Z(null),B(null),I(!1),L(!1)},J=async(ge,ee)=>{if(!d||!V)return;const fe=ge.reactions||[],_e=fe.includes(ee)?fe.filter(st=>st!==ee):[...fe,ee],Me=V.messages.map(st=>st.id===ge.id?{...st,reactions:_e}:st);await at("support_chats",d,{messages:Me}),D(null)},oe=async()=>{if(!Y||!d||!V)return;const ge=V.messages.filter(fe=>fe.id!==Y.id),ee=ge.length>0?ge[ge.length-1].text:"  ";await at("support_chats",d,{messages:ge,lastMessage:ee}),C(null)},je=async()=>{P&&(await Js("support_chats",P),U(null),h(null))},ye=ge=>{D(ge)},Pe=ge=>{ne.current=setTimeout(()=>ye(ge),500)},Fe=()=>{ne.current&&clearTimeout(ne.current)},Re=ge=>{var fe,_e;const ee=document.querySelectorAll(".message-text");for(let Me=0;Me<ee.length;Me++)if((fe=ee[Me].textContent)!=null&&fe.includes(ge)){ee[Me].scrollIntoView({behavior:"smooth",block:"center"}),(_e=ee[Me].parentElement)==null||_e.classList.add("ring-2","ring-yellow-400"),setTimeout(()=>{var st;return(st=ee[Me].parentElement)==null?void 0:st.classList.remove("ring-2","ring-yellow-400")},1500);break}},lt=ge=>{const ee=ge.match(/^\[ : (.*?)\]\n(.*)/s);if(ee){const fe=ee[1],_e=ee[2];return n.jsxs(n.Fragment,{children:[n.jsx("div",{onClick:Me=>{Me.stopPropagation(),Re(fe)},className:"mb-2 pb-1 border-b border-white/10 cursor-pointer active:opacity-70",children:n.jsxs("p",{className:"text-[10px] text-white/50 line-clamp-1 italic flex items-center gap-1",children:[n.jsx(yd,{className:"w-3 h-3"}),fe]})}),n.jsx("span",{className:"message-text",children:We(_e)})]})}return n.jsx("span",{className:"message-text",children:We(ge)})},We=ge=>ge.split(/(https?:\/\/[^\s]+)/g).map((fe,_e)=>fe.match(/^https?:\/\//)?n.jsx("a",{href:fe,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 underline break-all",children:fe},_e):fe),it=ge=>{var fe;const ee=(fe=ge.target.files)==null?void 0:fe[0];if(ee){const _e=new FileReader;_e.onloadend=()=>N(_e.result),_e.readAsDataURL(ee)}},ke=async()=>{await at("settings","support_config",{id:"support_config",...ae}),S(!1)},et=ge=>ge.startsWith("http");return n.jsxs("div",{className:"flex h-full bg-[#0f172a] text-white relative overflow-hidden",children:[n.jsxs("div",{className:`w-full md:w-80 lg:w-96 bg-[#1e293b] border-l border-gray-700 flex flex-col absolute md:relative z-20 h-full transition-transform duration-300 ${d?"-translate-x-full md:translate-x-0":"translate-x-0"}`,children:[n.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[n.jsxs("h2",{className:"font-bold text-lg flex items-center gap-2",children:[n.jsx(Vr,{className:"w-6 h-6 text-teal-400"})," "]}),n.jsxs("div",{className:"flex items-center gap-2",children:[!t&&n.jsx("button",{onClick:()=>S(!0),className:"p-2 hover:bg-gray-700 rounded-full text-gray-400 hover:text-white transition-colors",children:n.jsx(hn,{className:"w-5 h-5"})}),r&&n.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-700 rounded-full md:hidden",children:n.jsx(zs,{className:"w-5 h-5 rotate-180"})})]})]}),n.jsx("div",{className:"p-3",children:n.jsxs("div",{className:"relative",children:[n.jsx(Ln,{className:"absolute right-3 top-2.5 w-4 h-4 text-gray-500"}),n.jsx("input",{type:"text",placeholder:"  ...",value:f,onChange:ge=>m(ge.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-2 pl-4 pr-10 text-sm focus:border-teal-500 outline-none text-white"})]})}),n.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:H.map(ge=>{const ee=s.find(fe=>fe.id===ge.userId);return n.jsxs("button",{onClick:()=>h(ge.id),className:`w-full p-4 flex items-center gap-3 hover:bg-[#2a3649] transition-colors border-b border-gray-700/50 ${d===ge.id?"bg-[#2a3649] border-r-4 border-r-teal-500":""}`,children:[n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-700 flex items-center justify-center text-gray-400 overflow-hidden border border-gray-600",children:ee!=null&&ee.storeImage?n.jsx("img",{src:ee.storeImage,alt:ge.userName,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-6 h-6"})}),ge.unreadCount>0&&n.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full border-2 border-[#1e293b]",children:ge.unreadCount})]}),n.jsxs("div",{className:"flex-1 text-right overflow-hidden",children:[n.jsxs("div",{className:"flex justify-between items-center mb-1",children:[n.jsx("span",{className:"font-bold text-sm text-white truncate",children:ge.userName}),n.jsx("span",{className:"text-[10px] text-gray-500",children:new Date(ge.lastUpdated).toLocaleDateString()})]}),n.jsx("p",{className:`text-xs truncate ${ge.unreadCount>0?"text-white font-bold":"text-gray-400"}`,children:ge.lastMessage||" "})]})]},ge.id)})})]}),n.jsx("div",{className:`flex-1 flex flex-col bg-[#0f172a] absolute md:relative inset-0 z-10 transition-transform duration-300 ${d?"translate-x-0":"translate-x-full md:translate-x-0"}`,children:V?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"p-3 border-b border-gray-700 flex justify-between items-center bg-[#151e2d] shadow-sm z-20",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{onClick:()=>h(null),className:"md:hidden p-2 hover:bg-gray-700 rounded-full text-gray-400",children:n.jsx(zs,{className:"w-6 h-6"})}),n.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border border-gray-600",children:X!=null&&X.storeImage?n.jsx("img",{src:X.storeImage,alt:V.userName,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-5 h-5 text-gray-400"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-white text-sm",children:V.userName}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-400",children:[n.jsx($s,{className:"w-3 h-3"}),n.jsx("span",{className:"font-mono",children:V.userPhone})]})]})]}),!t&&n.jsx("button",{onClick:()=>U(V.id),className:"p-2 text-red-400 hover:bg-red-500/10 rounded-full transition-colors",children:n.jsx(jt,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-[#0b1120] custom-scrollbar",children:[V.messages.map((ge,ee)=>{const fe=ge.sender==="admin",_e=ge.image&&et(ge.image);return n.jsx("div",{className:`flex ${fe?"justify-end":"justify-start"}`,onTouchStart:()=>Pe(ge),onTouchEnd:Fe,onMouseDown:()=>Pe(ge),onMouseUp:Fe,onContextMenu:Me=>{Me.preventDefault(),ye(ge)},children:n.jsxs("div",{className:`relative max-w-[75%] rounded-2xl p-2 select-none shadow-sm ${_e?"bg-transparent shadow-none":fe?"bg-teal-700 text-white rounded-br-none":"bg-gray-700 text-gray-100 rounded-bl-none"}`,children:[ge.image&&n.jsx("img",{src:ge.image,className:_e?"w-32 h-32 object-contain cursor-pointer drop-shadow-lg":"rounded-lg mb-2 max-h-48 object-cover cursor-pointer",onClick:Me=>{Me.stopPropagation(),R(ge.image)},alt:"attachment"}),ge.text&&n.jsx("div",{className:"text-sm whitespace-pre-wrap leading-relaxed px-1",children:lt(ge.text)}),n.jsxs("div",{className:`flex items-center justify-end gap-1 mt-1 text-[10px] ${_e?"text-gray-400":fe?"text-teal-200":"text-gray-400"}`,children:[n.jsx("span",{children:new Date(ge.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),fe&&n.jsx(Xe,{className:"w-3 h-3"})]}),ge.reactions&&ge.reactions.length>0&&n.jsx("div",{className:`absolute -bottom-2 ${fe?"left-0":"right-0"} flex -space-x-1`,children:ge.reactions.map((Me,st)=>n.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-800 border border-gray-600 flex items-center justify-center text-[10px] shadow-sm",children:Me},st))})]})},ee)}),n.jsx("div",{ref:W})]}),n.jsxs("div",{className:"p-3 bg-[#151e2d] border-t border-gray-700",children:[($||Q)&&n.jsxs("div",{className:"flex justify-between items-center bg-gray-800 p-2 rounded-t-lg border-b border-gray-700 mb-2",children:[n.jsx("div",{className:"flex items-center gap-2 text-xs",children:Q?n.jsxs(n.Fragment,{children:[n.jsx(Jn,{className:"w-4 h-4 text-blue-400"}),n.jsx("span",{className:"text-blue-300 font-bold",children:"  "})]}):n.jsxs(n.Fragment,{children:[n.jsx(yd,{className:"w-4 h-4 text-purple-400"}),n.jsx("span",{className:"text-purple-300 font-bold",children:" :"}),n.jsx("span",{className:"text-gray-400 truncate max-w-[150px]",children:$==null?void 0:$.text})]})}),n.jsx("button",{onClick:()=>{B(null),Z(null),y(""),N(null)},className:"text-gray-500 hover:text-white",children:n.jsx(rt,{className:"w-4 h-4"})})]}),v&&n.jsxs("div",{className:"relative w-fit mb-2",children:[n.jsx("img",{src:v,className:"h-20 w-20 rounded-lg object-cover border border-gray-600",alt:"preview"}),n.jsx("button",{onClick:()=>N(null),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5",children:n.jsx(rt,{className:"w-4 h-4"})})]}),n.jsxs("div",{className:"flex items-end gap-2",children:[n.jsxs("div",{className:"flex-1 bg-gray-800 rounded-2xl flex items-center px-2 border border-gray-600 focus-within:border-teal-500 transition-colors",children:[ae.allowImageSending&&n.jsx("button",{onClick:()=>{var ge;return(ge=k.current)==null?void 0:ge.click()},className:"p-2 text-gray-400 hover:text-teal-400",children:n.jsx(h_,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>L(!T),className:`p-2 transition-colors ${T?"text-yellow-400":"text-gray-400 hover:text-yellow-400"}`,children:n.jsx(Ao,{className:"w-5 h-5"})}),n.jsx("textarea",{ref:q,value:b,onChange:ge=>y(ge.target.value),placeholder:"  ...",rows:1,className:"flex-1 bg-transparent text-white p-3 text-sm outline-none resize-none max-h-24 custom-scrollbar"}),n.jsx("button",{onClick:()=>I(!E),className:"p-2 text-gray-400 hover:text-yellow-400",children:n.jsx("span",{className:"text-lg",children:""})})]}),n.jsx("button",{onClick:()=>se(),disabled:!b.trim()&&!v,className:`p-3 text-white rounded-full shadow-lg transition-transform active:scale-95 ${Q?"bg-blue-600 hover:bg-blue-500":"bg-teal-600 hover:bg-teal-500"} disabled:opacity-50 disabled:cursor-not-allowed`,children:Q?n.jsx(Xe,{className:"w-5 h-5"}):n.jsx(cS,{className:"w-5 h-5 ml-0.5"})})]}),n.jsx("input",{ref:k,type:"file",accept:"image/*",className:"hidden",onChange:it}),(T||E)&&n.jsxs("div",{className:"absolute bottom-20 left-4 right-4 bg-gray-800 border border-gray-600 rounded-xl p-2 shadow-2xl flex gap-2 overflow-x-auto z-30",children:[T&&t$.map((ge,ee)=>n.jsx("button",{onClick:()=>{y(ge),L(!1)},className:"whitespace-nowrap px-3 py-1.5 bg-gray-700 rounded-full text-xs text-white",children:ge},ee)),E&&XT.map(ge=>n.jsx("button",{onClick:()=>y(ee=>ee+ge),className:"text-2xl hover:bg-white/10 p-2 rounded",children:ge},ge))]})]})]}):n.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-500",children:[n.jsx(Vr,{className:"w-16 h-16 opacity-50 mb-4"}),n.jsx("h3",{className:"text-xl font-bold text-gray-300",children:"  "}),n.jsx("p",{className:"text-sm mt-2",children:"  "})]})}),O&&n.jsx("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fadeIn",onClick:()=>D(null),children:n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-gray-700 shadow-2xl p-4 animate-sheet-up",onClick:ge=>ge.stopPropagation(),children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h3",{className:"text-white font-bold",children:" "}),n.jsx("button",{onClick:()=>D(null),children:n.jsx(rt,{className:"w-5 h-5 text-gray-400"})})]}),n.jsx("div",{className:"flex gap-4 justify-center mb-6 bg-black/20 p-3 rounded-xl",children:XT.slice(0,5).map(ge=>n.jsx("button",{onClick:()=>J(O,ge),className:"text-2xl hover:scale-125 transition-transform",children:ge},ge))}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("button",{onClick:()=>{var ge;B(O),D(null),(ge=q.current)==null||ge.focus()},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 transition-colors text-white",children:[n.jsx("div",{className:"p-2 bg-blue-500/20 rounded-full text-blue-400",children:n.jsx(yd,{className:"w-4 h-4"})}),n.jsx("span",{className:"font-bold",children:"  "})]}),O.sender==="admin"&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>{Z(O),y(O.text),N(O.image||null),D(null)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 transition-colors text-white",children:[n.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-full text-yellow-400",children:n.jsx(Jn,{className:"w-4 h-4"})}),n.jsx("span",{className:"font-bold",children:""})]}),!t&&n.jsxs("button",{onClick:()=>{C(O),D(null)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 transition-colors text-red-400",children:[n.jsx("div",{className:"p-2 bg-red-500/20 rounded-full text-red-500",children:n.jsx(jt,{className:"w-4 h-4"})}),n.jsx("span",{className:"font-bold",children:""})]})]}),!t&&O.sender!=="admin"&&n.jsxs("button",{onClick:()=>{C(O),D(null)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 transition-colors text-red-400",children:[n.jsx("div",{className:"p-2 bg-red-500/20 rounded-full text-red-500",children:n.jsx(jt,{className:"w-4 h-4"})}),n.jsx("span",{className:"font-bold",children:" ()"})]})]})]})}),F&&n.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>S(!1),children:n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-2xl p-6 border border-gray-700 shadow-2xl",onClick:ge=>ge.stopPropagation(),children:[n.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[n.jsx(hn,{className:"w-6 h-6 text-teal-400"}),"  "]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-blue-500/5 p-4 rounded-xl border border-blue-500/20 mb-2",children:[n.jsx("h4",{className:"text-xs font-bold text-blue-400 mb-3 uppercase tracking-wider",children:" "}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:"flex items-center justify-between text-white cursor-pointer",children:[n.jsxs("span",{className:"text-sm font-bold flex items-center gap-2",children:[n.jsx(_v,{className:"w-4 h-4 text-blue-400"}),"  (In-App)"]}),n.jsx("input",{type:"checkbox",checked:ae.isChatEnabled,onChange:ge=>K({...ae,isChatEnabled:ge.target.checked}),className:"h-5 w-5 rounded bg-gray-700 border-gray-600 text-blue-500 focus:ring-blue-500"})]}),n.jsx("div",{className:"h-px bg-blue-500/10 w-full"}),n.jsxs("label",{className:"flex items-center justify-between text-white cursor-pointer",children:[n.jsxs("span",{className:"text-sm font-bold flex items-center gap-2",children:[n.jsx(Vl,{className:"w-4 h-4 text-green-500"})," "]}),n.jsx("input",{type:"checkbox",checked:ae.isWhatsappEnabled,onChange:ge=>K({...ae,isWhatsappEnabled:ge.target.checked}),className:"h-5 w-5 rounded bg-gray-700 border-gray-600 text-green-500 focus:ring-green-500"})]}),ae.isWhatsappEnabled&&n.jsx("div",{className:"mt-1 mr-6",children:n.jsx("input",{type:"text",value:ae.whatsappNumber,onChange:ge=>K({...ae,whatsappNumber:ge.target.value}),className:"w-full bg-[#0f172a] border border-gray-600 rounded-lg p-2.5 text-white text-sm outline-none focus:border-green-500 font-mono dir-ltr placeholder-gray-500",placeholder:"201xxxxxxxxx"})})]})]}),n.jsxs("label",{className:"flex items-center justify-between text-white cursor-pointer p-3 bg-gray-800 rounded-xl hover:bg-gray-750 transition-colors",children:[n.jsxs("span",{className:"text-sm flex items-center gap-2",children:[n.jsx(h_,{className:"w-4 h-4 text-blue-400"}),"  "]}),n.jsx("input",{type:"checkbox",checked:ae.allowImageSending,onChange:ge=>K({...ae,allowImageSending:ge.target.checked}),className:"h-5 w-5 rounded bg-gray-700 border-gray-600 text-teal-500 focus:ring-teal-500"})]}),n.jsxs("div",{className:"p-3 bg-gray-800 rounded-xl",children:[n.jsxs("label",{className:"flex items-center justify-between text-white cursor-pointer mb-2",children:[n.jsxs("span",{className:"text-sm flex items-center gap-2",children:[n.jsx(Ao,{className:"w-4 h-4 text-yellow-400"}),"  "]}),n.jsx("input",{type:"checkbox",checked:ae.isAutoReplyEnabled,onChange:ge=>K({...ae,isAutoReplyEnabled:ge.target.checked}),className:"h-5 w-5 rounded bg-gray-700 border-gray-600 text-teal-500 focus:ring-teal-500"})]}),ae.isAutoReplyEnabled&&n.jsx("textarea",{value:ae.autoReplyText,onChange:ge=>K({...ae,autoReplyText:ge.target.value}),className:"w-full bg-[#0f172a] rounded-lg p-2 text-white text-sm border border-gray-600 focus:border-teal-500 outline-none resize-none h-20"})]})]}),n.jsx("button",{onClick:ke,className:"w-full bg-teal-600 hover:bg-teal-700 text-white font-bold py-3.5 rounded-xl mt-6 transition-colors shadow-lg",children:" "})]})}),M&&n.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex items-center justify-center p-4",onClick:()=>R(null),children:[n.jsx("img",{src:M,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl"}),n.jsx("button",{className:"absolute top-4 right-4 bg-white/10 p-2 rounded-full text-white hover:bg-white/20",children:n.jsx(rt,{className:"w-6 h-6"})})]}),Y&&n.jsx(fs,{title:" ",message:"      ",onClose:()=>C(null),onConfirm:oe,confirmButtonText:"",confirmVariant:"danger"}),P&&n.jsx(fs,{title:" ",message:":     .",onClose:()=>U(null),onConfirm:je,confirmButtonText:" ",confirmVariant:"danger"})]})},JT=({src:s,alt:e,className:t})=>{const[r,i]=Is.useState(s);return Is.useEffect(()=>{let l=!0;if(s&&s.startsWith("FIRESTORE_FILE:")){const d=s.replace("FIRESTORE_FILE:","");Dp(d).then(h=>{l&&i(h)}).catch(h=>{console.error("Failed to load image:",h)})}else i(s);return()=>{l=!1}},[s]),n.jsx("img",{src:r,alt:e,className:t})},s$=({appConfig:s,onUpdateAppConfig:e})=>{const[t,r]=w.useState(!1),[i,l]=w.useState(null),[d,h]=w.useState({isActive:!0}),f=(s==null?void 0:s.games)||[],[m,b]=w.useState(!1),y=Is.useRef(null),v=async T=>{var $;const L=($=T.target.files)==null?void 0:$[0];if(L){b(!0);try{const B=await O1(L,"game_images");h(Q=>({...Q,image:B}))}catch(B){console.error("Upload failed",B),alert("  .    .")}finally{b(!1)}}},N=()=>{if(!d.name||!d.url||!d.image)return;let T=[...f];if(i)T=T.map(L=>L.id===i.id?{...L,...d}:L);else{const L={id:Date.now().toString(),name:d.name,url:d.url,image:d.image,isActive:d.isActive??!0,createdAt:new Date,playCount:0};T.push(L)}e({...s,appName:(s==null?void 0:s.appName)||"",appVersion:(s==null?void 0:s.appVersion)||"",games:T}),r(!1),l(null),h({isActive:!0}),b(!1)},E=T=>{if(confirm("      ")){const L=f.filter($=>$.id!==T);e({...s,appName:(s==null?void 0:s.appName)||"",appVersion:(s==null?void 0:s.appVersion)||"",games:L})}},I=T=>{l(T),h(T),r(!0)};return n.jsxs("div",{className:"flex flex-col h-full text-white",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-800",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-black",children:" "}),n.jsx("p",{className:"text-sm text-gray-500",children:"   "})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-3 bg-[#252525] px-4 py-2 rounded-xl border border-white/5",children:[n.jsx("span",{className:`text-xs font-bold ${(s==null?void 0:s.isGamesEnabled)??!0?"text-green-400":"text-gray-500"}`,children:(s==null?void 0:s.isGamesEnabled)??!0?"":""}),n.jsx("button",{onClick:()=>{const T=(s==null?void 0:s.isGamesEnabled)??!0;e({...s,appName:(s==null?void 0:s.appName)||"",appVersion:(s==null?void 0:s.appVersion)||"",isGamesEnabled:!T})},className:`w-12 h-6 rounded-full p-1 transition-colors ${(s==null?void 0:s.isGamesEnabled)??!0?"bg-green-600":"bg-gray-700"}`,children:n.jsx("div",{className:`w-4 h-4 rounded-full bg-white transition-transform ${(s==null?void 0:s.isGamesEnabled)??!0?"translate-x-[-24px]":"translate-x-0"}`})})]}),n.jsxs("button",{onClick:()=>{l(null),h({isActive:!0}),r(!0)},className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-xl transition-colors font-bold",children:[n.jsx(Gs,{className:"w-5 h-5"}),n.jsx("span",{children:" "})]})]})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:f.length===0?n.jsxs("div",{className:"text-center py-20 text-gray-500",children:[n.jsx($l,{className:"w-16 h-16 mx-auto mb-4 opacity-20"}),n.jsx("p",{children:"   "})]}):n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(T=>n.jsxs("div",{className:"bg-[#1a1a1a] border border-gray-800 rounded-2xl overflow-hidden group hover:border-red-500/50 transition-all",children:[n.jsxs("div",{className:"aspect-video relative",children:[n.jsx(JT,{src:T.image,alt:T.name,className:"w-full h-full object-cover"}),n.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[n.jsx("button",{onClick:()=>I(T),className:"p-2 bg-white text-black rounded-full hover:scale-110 transition-transform",children:n.jsx(K3,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>E(T.id),className:"p-2 bg-red-600 text-white rounded-full hover:scale-110 transition-transform",children:n.jsx(jt,{className:"w-5 h-5"})})]}),!T.isActive&&n.jsx("div",{className:"absolute top-2 left-2 bg-red-600 text-white text-[10px] px-2 py-0.5 rounded-full font-bold",children:" "})]}),n.jsxs("div",{className:"p-4",children:[n.jsx("h3",{className:"font-bold text-lg mb-1",children:T.name}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 truncate",children:[n.jsx(Q3,{className:"w-3 h-3"}),n.jsx("a",{href:T.url,target:"_blank",rel:"noopener noreferrer",className:"hover:text-red-400",children:T.url})]})]})]},T.id))})}),t&&n.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",onClick:()=>r(!1),children:n.jsxs("div",{className:"bg-[#222] border border-gray-700 w-full max-w-md rounded-2xl overflow-hidden shadow-2xl animate-scale-in",onClick:T=>T.stopPropagation(),children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[n.jsx("h3",{className:"font-bold",children:i?" ":"  "}),n.jsx("button",{onClick:()=>r(!1),children:n.jsx(rt,{className:"w-5 h-5 text-gray-400 hover:text-white"})})]}),n.jsxs("div",{className:"p-4 space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-1",children:" "}),n.jsx("input",{type:"text",value:d.name||"",onChange:T=>h({...d,name:T.target.value}),className:"w-full bg-[#111] border border-gray-700 rounded-xl px-3 py-2 text-sm focus:border-red-500 outline-none transition-colors",placeholder:": Flappy Bird"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-1",children:"  (URL)"}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"url",value:d.url||"",onChange:T=>h({...d,url:T.target.value}),className:"w-full bg-[#111] border border-gray-700 rounded-xl pl-10 pr-3 py-2 text-sm focus:border-red-500 outline-none transition-colors dir-ltr",placeholder:"https://...",style:{direction:"ltr"}}),n.jsx($l,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-500"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-1",children:" "}),n.jsx("input",{type:"file",ref:y,className:"hidden",accept:"image/*",onChange:v}),d.image?n.jsxs("div",{className:"relative aspect-video rounded-xl overflow-hidden border border-gray-700 group",children:[n.jsx(JT,{src:d.image,className:"w-full h-full object-cover"}),n.jsxs("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[n.jsx("button",{onClick:()=>{var T;return(T=y.current)==null?void 0:T.click()},className:"px-3 py-1 bg-white text-black text-xs font-bold rounded-lg",children:""}),n.jsx("button",{onClick:()=>h(T=>({...T,image:""})),className:"px-3 py-1 bg-red-600 text-white text-xs font-bold rounded-lg",children:""})]})]}):n.jsx("button",{onClick:()=>{var T;return(T=y.current)==null?void 0:T.click()},disabled:m,className:"w-full aspect-video rounded-xl border-2 border-dashed border-gray-700 flex flex-col items-center justify-center gap-2 hover:border-gray-500 hover:bg-white/5 transition-all text-gray-500",children:m?n.jsx("div",{className:"w-6 h-6 border-2 border-red-500 border-t-transparent rounded-full animate-spin"}):n.jsxs(n.Fragment,{children:[n.jsx(fr,{className:"w-8 h-8"}),n.jsx("span",{className:"text-sm font-bold",children:"  "})]})})]}),n.jsxs("div",{className:"flex items-center gap-3 bg-[#1a1a1a] p-3 rounded-xl border border-gray-800",children:[n.jsx("input",{type:"checkbox",id:"isActive",checked:d.isActive??!0,onChange:T=>h({...d,isActive:T.target.checked}),className:"w-4 h-4 accent-red-600"}),n.jsx("label",{htmlFor:"isActive",className:"text-sm font-medium cursor-pointer select-none",children:" "})]})]}),n.jsxs("div",{className:"p-4 border-t border-gray-700 flex gap-3",children:[n.jsx("button",{onClick:N,disabled:m,className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-2.5 rounded-xl transition-colors disabled:opacity-50",children:m?" ...":""}),n.jsx("button",{onClick:()=>r(!1),className:"px-6 bg-gray-700 hover:bg-gray-600 text-white font-bold py-2.5 rounded-xl transition-colors",children:""})]})]})})]})},Fk=({onRefresh:s,children:e,className:t="",refreshing:r})=>{const[i,l]=w.useState(null),[d,h]=w.useState(0),[f,m]=w.useState(!1),b=w.useRef(null),y=80,v=150,N=w.useRef(!1);w.useEffect(()=>{r!==void 0&&m(r)},[r]);const E=$=>{b.current&&b.current.scrollTop<=0&&!f?l($.targetTouches[0].clientY):l(null)},I=$=>{if(i===null||f)return;const Q=$.targetTouches[0].clientY-i;if(Q>0){const Z=Math.min(Q*.5,v);$.cancelable&&Q>5,h(Z)}},T=async()=>{if(!(i===null||f)){if(d>=y){m(!0),N.current=!0,h(y);try{await s()}finally{setTimeout(()=>{m(!1),N.current=!1,h(0)},500)}}else h(0);l(null)}},L={transition:"none"};return n.jsxs("div",{ref:b,className:`relative overflow-y-auto h-full ${t}`,onTouchStart:E,onTouchMove:I,onTouchEnd:T,children:[n.jsx("div",{className:"absolute left-0 right-0 top-0 flex justify-center items-center pointer-events-none z-10",style:{height:y,transform:`translateY(${d-y}px)`,transition:i===null?"transform 0.3s cubic-bezier(0.25, 0.8, 0.5, 1)":"none",opacity:Math.min(d/(y*.8),1)},children:n.jsx("div",{className:`rounded-full bg-[#252525] border border-gray-700 p-2 shadow-lg flex items-center justify-center ${f?"animate-spin-slow":""}`,children:f?n.jsxs("svg",{className:"w-6 h-6 text-red-600 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):n.jsx("svg",{className:"w-6 h-6 text-red-600",style:{transform:`rotate(${d*2}deg)`},xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})})}),n.jsx("div",{style:L,children:e})]})},Cn=({icon:s,label:e,onClick:t,isActive:r,danger:i})=>n.jsxs("button",{onClick:t,className:`w-full flex items-center gap-4 p-4 rounded-2xl transition-all duration-300 group relative overflow-hidden active:scale-95 mb-2 ${i?"text-red-400 hover:bg-red-500/10":r?"bg-red-600/20 text-white border border-red-500/30 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[r&&n.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 bg-red-600 rounded-l-full"}),n.jsx("div",{className:`relative z-10 transition-transform group-hover:scale-110 duration-300 ${r?"text-red-500":""}`,children:s}),n.jsx("span",{className:`relative z-10 font-bold text-sm ${r?"translate-x-1":""} transition-transform duration-300`,children:e})]}),n$=s=>{var it,ke,et,ge;const[e,t]=w.useState("orders"),[r,i]=w.useState(!1),[l,d]=w.useState(null),[h,f]=w.useState(null),[m,b]=w.useState(null),[y,v]=w.useState(null),[N,E]=w.useState(null),[I,T]=w.useState(null),[L,$]=w.useState(null);w.useEffect(()=>{const ee=fe=>{const{target:_e,id:Me}=fe.detail;_e==="orders"||_e==="order"&&Me?t("orders"):_e==="users"?t("users"):_e==="reports"?t("reports"):_e==="messages"?t("messages"):_e==="stores"?t("stores"):_e==="notifications"?t("notifications"):_e==="support"&&t("support")};return window.addEventListener("app-navigation",ee),()=>window.removeEventListener("app-navigation",ee)},[]);const[B,Q]=w.useState([]),[Z,Y]=w.useState(!0),C=w.useRef(0);w.useEffect(()=>{const ee=Hs("support_chats",fe=>{const _e=fe.filter(Me=>Me.unreadCount>0);Q(_e)});return()=>ee()},[]),w.useEffect(()=>{const fe=new URLSearchParams(window.location.search).get("target");fe&&(fe==="messages"?t("messages"):fe==="orders"||fe==="order"?t("orders"):fe==="notifications"&&t("notifications"))},[window.location.search]),Wt(()=>I?(T(null),!0):L?($(null),!0):y?(v(null),!0):N?(E(null),!0):m?(b(null),!0):l?(d(null),!0):h?(f(null),!0):r?(i(!1),!0):e!=="orders"?(t("orders"),!0):!1,[r,l,h,m,y,N,I,L,e]);const P=w.useMemo(()=>s.users.find(ee=>ee.id===s.user.id)||s.user,[s.users,s.user]),U=((ke=(it=s.currentTheme)==null?void 0:it.admin)==null?void 0:ke.mode)||"dark",O=s.users.filter(ee=>ee.status==="pending"&&ee.role!=="admin").length,D=s.orders.filter(ee=>ee.status===ce.Pending).length,F=B.length,S=O+s.passwordResetRequests.length+D+F,ae=w.useMemo(()=>s.users.filter(ee=>ee.role==="driver"),[s.users]),K=w.useMemo(()=>s.users.filter(ee=>ee.role==="merchant"),[s.users]),k=w.useCallback(()=>t("add_order"),[]),q=w.useCallback(ee=>b(ee),[]),W=w.useCallback(async(ee,fe)=>{const _e=s.orders.filter(st=>st.status===ce.Pending&&!st.driverId);if(_e.length===0)return;const Me=_e.map(st=>({...st,driverId:ee,deliveryFee:fe,status:ce.InTransit}));await s.onBulkUpdate(Me),s.showNotification(`  ${Me.length}   `,"success")},[s.orders,s.onBulkUpdate,s.showNotification]),ne=w.useCallback(async ee=>{let fe=[];ee===ce.Pending?fe=s.orders.filter(Me=>Me.status!==ce.Pending&&Me.status!==ce.Delivered&&Me.status!==ce.Cancelled).map(Me=>({id:Me.id,status:ce.Pending,driverId:null,deliveryFee:null})):ee===ce.Delivered&&(fe=s.orders.filter(Me=>Me.status===ce.InTransit).map(Me=>({id:Me.id,status:ce.Delivered,deliveredAt:new Date}))),fe.length>0?(await s.onBulkUpdate(fe),s.showNotification(`   ${fe.length}  `,"success")):s.showNotification("    ","info")},[s.orders,s.onBulkUpdate,s.showNotification]),M=w.useCallback(async ee=>{const fe=ee==="all"?s.orders.filter(Me=>!Me.isArchived):s.orders.filter(Me=>Me.status===ee&&!Me.isArchived);if(fe.length===0){s.showNotification("   ","info");return}const _e=ee==="all"?`   ${fe.length}     !

           1.

  `:`  ${fe.length}  (${ee}) .

  `;$({type:ee==="all"?"all":"status",target:ee,message:_e})},[s.orders,$]),R=async()=>{if(!L)return;const{type:ee,target:fe}=L;let _e=[];if(ee==="all"?_e=s.orders.filter(Me=>!Me.isArchived):ee==="status"&&(_e=s.orders.filter(Me=>Me.status===fe&&!Me.isArchived)),_e.length===0){$(null);return}try{const st=[];for(let tt=0;tt<_e.length;tt+=400)st.push(_e.slice(tt,tt+400));for(const tt of st)await Promise.all(tt.map(Ie=>s.deleteOrder(Ie.id)));s.showNotification(`   ${_e.length}     

${ee==="all"?"    ...":""}`,"success"),ee==="all"&&setTimeout(()=>{window.location.reload()},1500)}catch(Me){console.error("Bulk delete error:",Me),s.showNotification("    ","error")}finally{$(null)}},V=w.useRef(null),X=w.useRef(0),H=w.useCallback(async()=>{if(!I)return;const{order:ee,newStatus:fe}=I;s.updateOrderStatus(ee.id,fe),T(null)},[I,s.updateOrderStatus]),se=ee=>{const fe=ee.currentTarget.scrollTop;e==="orders"&&(X.current=fe);const _e=fe-C.current;Math.abs(_e)>5&&(_e>0&&fe>20?Y(!1):Y(!0)),C.current=fe};w.useEffect(()=>{e==="orders"&&V.current&&requestAnimationFrame(()=>{V.current&&(V.current.scrollTop=X.current)})},[e]);const J=((et=s.appConfig)==null?void 0:et.appName.split(" "))||["GOO","NOW"],oe=J[0],je=J.slice(1).join(" "),ye=((ge=s.appConfig)==null?void 0:ge.appName)||"GOO NOW",Pe=async()=>new Promise(ee=>{setTimeout(()=>{ee()},1500)}),Fe=ee=>{if(ee!=null&&ee.startsWith("data:")||ee!=null&&ee.startsWith("http"))return"p-0";switch(ee){case"gold":return"p-[3px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[3px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[3px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[3px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-[2px] bg-gradient-to-br from-red-600 to-red-800"}},Re=ee=>{if(!ee||ee==="none")return null;if(ee!=null&&ee.startsWith("data:")||ee!=null&&ee.startsWith("http"))return n.jsx("div",{className:"w-8 h-8 min-w-[2rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:n.jsx("img",{src:ee,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let fe=null,_e="";switch(ee){case"verified":fe=Si,_e="text-blue-400 fill-blue-500/20";break;case"vip":fe=ra,_e="text-yellow-400 fill-yellow-500/20";break;case"star":fe=pr,_e="text-purple-400 fill-purple-500/20";break;case"popular":fe=Ft,_e="text-red-400 fill-red-500/20";break;case"admin-badge":fe=hn,_e="text-red-500";break;case"mod-badge":fe=Or,_e="text-green-500";break}return fe?n.jsx(fe,{className:`w-5 h-5 ${_e}`}):null},lt=ee=>(ee==null?void 0:ee.startsWith("data:"))||(ee==null?void 0:ee.startsWith("http")),We=e==="support";return n.jsxs("div",{className:`flex flex-col h-screen overflow-hidden ${U==="light"?"bg-gray-100":"bg-gray-900"}`,children:[r&&n.jsxs("div",{className:"fixed inset-0 z-[100] flex justify-start animate-fadeIn",dir:"rtl",children:[n.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-md transition-all duration-500",onClick:()=>i(!1)}),n.jsxs("div",{className:`w-[290px] h-full ${U==="light"?"bg-white/90":"bg-gray-900/80"} backdrop-blur-2xl border-l border-white/10 shadow-2xl relative flex flex-col z-10 pt-safe rounded-l-[40px] overflow-hidden transform transition-transform duration-300 animate-slide-in-right`,children:[n.jsxs("div",{className:"p-8 border-b border-white/5 flex flex-col items-center relative",children:[n.jsx("button",{onClick:()=>i(!1),className:"absolute top-4 left-4 p-2.5 rounded-full bg-white/5 hover:bg-red-500/20 text-gray-400 hover:text-red-400 border border-white/10 transition-all duration-300 shadow-sm active:scale-90 z-50",children:n.jsx(rt,{className:"w-5 h-5"})}),n.jsxs("button",{onClick:()=>{d(P),i(!1)},className:`relative w-24 h-24 flex items-center justify-center rounded-full shadow-2xl mb-4 group/avatar cursor-pointer transition-transform active:scale-95 ${lt(P.specialFrame)?"":Fe(P.specialFrame)}`,children:[lt(P.specialFrame)&&n.jsx("img",{src:P.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.65] pointer-events-none",alt:"frame"}),n.jsxs("div",{className:`${lt(P.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-gray-900 overflow-hidden border-2 border-white/10 flex items-center justify-center relative z-0`,children:[P.storeImage?n.jsx("img",{src:P.storeImage,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-10 h-10 text-gray-500"}),n.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover/avatar:opacity-100 transition-opacity",children:n.jsx(hn,{className:"w-6 h-6 text-white"})})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h3",{className:`font-black text-xl tracking-tight ${U==="light"?"text-gray-900":"text-white"}`,children:P.name}),Re(P.specialBadge)]}),n.jsx("p",{className:"text-[10px] font-bold text-red-500 uppercase tracking-[0.2em] mt-1",children:"Administrator"})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-1 custom-scrollbar",children:[n.jsx("div",{className:"px-4 py-2 text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2",children:" "}),n.jsx(Cn,{icon:n.jsx(Ut,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("orders"),i(!1)},isActive:e==="orders"}),n.jsx(Cn,{icon:n.jsx(Ef,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("reports"),i(!1)},isActive:e==="reports"}),n.jsx(Cn,{icon:n.jsx(eu,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("wallet"),i(!1)},isActive:e==="wallet"}),n.jsx(Cn,{icon:n.jsx(Vr,{className:"w-5 h-5"}),label:"  (Chat)",onClick:()=>{t("support"),i(!1)},isActive:e==="support"}),n.jsx(Cn,{icon:n.jsx(Zd,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("users"),i(!1)},isActive:e==="users"}),n.jsx(Cn,{icon:n.jsx(Xn,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("stores"),i(!1)},isActive:e==="stores"}),n.jsx(Cn,{icon:n.jsx(Tn,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("notifications"),i(!1)},isActive:e==="notifications"}),n.jsx(Cn,{icon:n.jsx(Or,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("logs"),i(!1)},isActive:e==="logs"}),n.jsx(Cn,{icon:n.jsx(tf,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("loyalty"),i(!1)},isActive:e==="loyalty"}),n.jsx(Cn,{icon:n.jsx(Dr,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("messages"),i(!1)},isActive:e==="messages"}),n.jsx(Cn,{icon:n.jsx(fr,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("slider"),i(!1)},isActive:e==="slider"}),n.jsx(Cn,{icon:n.jsx(Nv,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("customizer"),i(!1)},isActive:e==="customizer"}),n.jsx(Cn,{icon:n.jsx(hn,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("settings"),i(!1)},isActive:e==="settings"}),n.jsx(Cn,{icon:n.jsx($l,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("games"),i(!1)},isActive:e==="games"})]}),n.jsx("div",{className:"p-6 border-t border-white/5 bg-black/20 pb-safe",children:n.jsx(Cn,{icon:n.jsx(Sf,{className:"w-5 h-5"}),label:" ",onClick:s.onLogout,danger:!0})})]})]}),!We&&e!=="add_order"&&n.jsx("header",{className:`${U==="light"?"bg-white/95":"bg-gray-800/95"} backdrop-blur-md border-b border-red-500/20 sticky top-0 z-30 shadow-xl pt-safe rounded-b-[35px] mx-2 mt-1 transition-all duration-300`,children:n.jsxs("div",{className:"max-w-7xl mx-auto py-3 px-4 flex justify-between items-center relative h-14",children:[n.jsx("button",{onClick:()=>i(!0),className:"flex items-center gap-3 active:scale-95 transition-transform group focus:outline-none",children:n.jsxs("div",{className:`relative w-11 h-11 flex items-center justify-center rounded-full shadow-lg transition-all duration-300 group-hover:shadow-red-500/20 group-hover:ring-2 group-hover:ring-red-500/50 ${lt(P.specialFrame)?"":Fe(P.specialFrame)}`,children:[lt(P.specialFrame)&&n.jsx("img",{src:P.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.5] pointer-events-none",alt:"frame"}),n.jsx("div",{className:`${lt(P.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-white flex items-center justify-center overflow-hidden relative z-0`,children:P.storeImage?n.jsx("img",{src:P.storeImage,className:"w-full h-full object-cover"}):n.jsx("div",{className:"text-gray-900 font-bold",children:P.name.charAt(0)})})]})}),n.jsxs("h1",{className:"text-xl font-black absolute left-1/2 -translate-x-1/2 select-none",children:[n.jsx("span",{className:"text-red-600",children:oe}),n.jsx("span",{className:U==="light"?"text-gray-900 ml-1":"text-white ml-1",children:je})]}),n.jsx("div",{className:"flex items-center gap-1",children:n.jsxs("button",{onClick:()=>t("notifications"),className:"relative p-2.5 rounded-xl bg-white/5 hover:bg-white/10 transition-colors",children:[n.jsx(Tn,{className:`w-6 h-6 ${S>0?"text-yellow-500":"text-gray-400"}`}),S>0&&n.jsx("span",{className:"absolute top-1.5 right-1.5 w-4 h-4 flex items-center justify-center bg-red-600 text-[9px] font-bold text-white rounded-full ring-2 ring-gray-800 animate-pulse",children:S})]})})]})}),n.jsx("main",{ref:V,className:e==="add_order"?"flex-1 bg-[#111] h-full":We?"flex-1 h-full relative":"flex-1 overflow-y-auto p-4 sm:p-6 pb-24 relative",onScroll:We?void 0:se,children:n.jsxs(Fk,{onRefresh:Pe,className:"",children:[n.jsx("div",{className:e==="orders"?"block":"hidden",children:n.jsx($g,{orders:s.orders,users:s.users,deleteOrder:s.deleteOrder,updateOrderStatus:s.updateOrderStatus,editOrder:s.editOrder,assignDriverAndSetStatus:s.assignDriverAndSetStatus,adminAddOrder:s.adminAddOrder,onOpenStatusModal:q,onNavigateToAdd:k,onBulkAssign:W,onBulkStatusUpdate:ne,onBulkDelete:M,appName:ye,currentUser:s.user,viewMode:"default"})}),n.jsx("div",{className:e==="shopping"?"block":"hidden",children:n.jsx($g,{orders:s.orders,users:s.users,deleteOrder:s.deleteOrder,updateOrderStatus:s.updateOrderStatus,editOrder:s.editOrder,assignDriverAndSetStatus:s.assignDriverAndSetStatus,adminAddOrder:s.adminAddOrder,onOpenStatusModal:q,onNavigateToAdd:k,onBulkAssign:W,onBulkStatusUpdate:ne,onBulkDelete:M,appName:ye,currentUser:s.user,viewMode:"shopping"})}),n.jsx("div",{className:e==="special"?"block":"hidden",children:n.jsx($g,{orders:s.orders,users:s.users,deleteOrder:s.deleteOrder,updateOrderStatus:s.updateOrderStatus,editOrder:s.editOrder,assignDriverAndSetStatus:s.assignDriverAndSetStatus,adminAddOrder:s.adminAddOrder,onOpenStatusModal:q,onNavigateToAdd:k,onBulkAssign:W,onBulkStatusUpdate:ne,onBulkDelete:M,appName:ye,currentUser:s.user,viewMode:"special"})}),e==="reports"&&n.jsx(Ck,{orders:s.orders,users:s.users,payments:s.payments,currentUser:s.user}),e==="add_order"&&n.jsx(Dk,{merchants:K,onClose:()=>t("orders"),onSave:s.adminAddOrder}),e==="users"&&n.jsx(uS,{users:s.users,updateUser:s.updateUser,onDeleteUser:s.deleteUser,onAdminAddUser:s.adminAddUser,setEditingUser:d,onViewUser:f,appName:ye,currentUser:s.user}),e==="stores"&&n.jsx(fS,{users:s.users,orders:s.orders,updateUser:s.updateUser}),e==="notifications"&&n.jsx(mS,{users:s.users,updateUser:s.updateUser,onDeleteUser:s.deleteUser,passwordResetRequests:s.passwordResetRequests,resolvePasswordResetRequest:s.resolvePasswordResetRequest,setEditingUser:d,pendingOrders:s.orders.filter(ee=>ee.status===ce.Pending&&!ee.driverId),onNavigateToOrders:()=>t("orders"),unreadChats:B,onNavigateToSupport:()=>t("support")}),e==="wallet"&&n.jsx(gS,{orders:s.orders,users:s.users,payments:s.payments,updateUser:s.updateUser,handleDriverPayment:s.handleDriverPayment,onDeletePayment:ee=>Js("payments",ee),currentUser:s.user}),e==="messages"&&n.jsx(pS,{users:s.users,onSendMessage:s.sendMessage,messages:s.messages,deleteMessage:s.deleteMessage}),e==="slider"&&n.jsx(Rk,{images:s.sliderImages,isEnabled:s.sliderConfig.isEnabled,onAddImage:s.onAddSliderImage,onDeleteImage:s.onDeleteSliderImage,onUpdateImage:s.onUpdateSliderImage,onToggleSlider:s.onToggleSlider,merchants:K,adminUser:s.user}),e==="customizer"&&n.jsx(Mk,{currentTheme:s.currentTheme,onUpdateTheme:s.onUpdateTheme,onClose:()=>t("orders"),appConfig:s.appConfig,onUpdateAppConfig:s.onUpdateAppConfig,users:s.users,onUpdateUser:s.updateUser,sendNotification:qt,currentUser:s.user}),e==="logs"&&n.jsx(Lk,{logs:s.auditLogs,onClearLogs:s.onClearLogs}),e==="loyalty"&&n.jsx(Vk,{promoCodes:s.promoCodes,pointsConfig:s.pointsConfig,onAddPromo:s.onAddPromo,onDeletePromo:s.onDeletePromo,onUpdatePointsConfig:s.onUpdatePointsConfig}),e==="support"&&n.jsx(Uk,{users:s.users,currentUser:s.user,onBack:()=>t("orders")}),e==="settings"&&n.jsx(Xz,{onSuccess:()=>window.location.reload(),onDisconnect:()=>window.location.reload(),appConfig:s.appConfig,onUpdateAppConfig:s.onUpdateAppConfig}),e==="games"&&n.jsx(s$,{appConfig:s.appConfig,onUpdateAppConfig:s.onUpdateAppConfig})]})}),!We&&e!=="add_order"&&n.jsx(Ok,{activeView:e,onNavigate:ee=>t(ee),isVisible:Z,mode:U}),l&&n.jsx(Tv,{user:l,onClose:()=>d(null),onSave:(ee,fe)=>{s.updateUser(ee,fe),d(null)},isLastAdmin:l.role==="admin",isPrimaryAdmin:l.id==="5",appName:ye,currentUser:s.user}),h&&n.jsx(Sv,{user:h,onClose:()=>f(null),onApprove:(ee,fe)=>{s.updateUser(ee,fe),f(null)},onDelete:ee=>{s.deleteUser(ee),f(null)}}),m&&n.jsx(Pk,{order:m,onClose:()=>b(null),onSelectStatus:(ee,fe)=>{b(null),setTimeout(()=>{fe===ce.InTransit?v(ee):T({order:ee,newStatus:fe})},150)},onTransferOrder:ee=>{b(null),setTimeout(()=>{E(ee)},100)}}),y&&n.jsx(V0,{order:y,drivers:ae,targetStatus:ce.InTransit,onClose:()=>v(null),onSave:(ee,fe)=>{s.assignDriverAndSetStatus(y.id,ee,fe,ce.InTransit),v(null)}}),N&&n.jsx(V0,{order:N,drivers:ae,targetStatus:ce.InTransit,onClose:()=>E(null),onSave:(ee,fe)=>{s.assignDriverAndSetStatus(N.id,ee,fe,ce.InTransit),E(null)}}),I&&n.jsx(fs,{title:"  ",message:"    ",onClose:()=>T(null),onConfirm:H,confirmVariant:I.newStatus===ce.Delivered?"success":"primary"}),L&&n.jsx(fs,{title:L.type==="all"?"  ":" ",message:L.message,onClose:()=>$(null),onConfirm:R,confirmVariant:"danger",confirmButtonText:"  ",cancelButtonText:""})]})},r$=({addOrder:s})=>{const[e,t]=w.useState({phone:"",address:""}),[r,i]=w.useState(""),[l,d]=w.useState(""),[h,f]=w.useState("idle"),m=w.useRef(null),b=w.useRef(null),y=w.useRef(null),v=E=>{const{name:I,value:T}=E.target;if(I==="phone"){const L=T.replace(/\D/g,"");L.length<=11&&t({...e,phone:L})}else t({...e,[I]:T})},N=async E=>{if(E.preventDefault(),!e.phone||!e.address){d("    .");return}if(!/^\d{11}$/.test(e.phone)){d("       11 .");return}d(""),f("submitting");const I={customer:{...e},notes:r};try{await s(I),f("success"),setTimeout(()=>{m.current&&(m.current.value=""),b.current&&(b.current.value=""),y.current&&(y.current.value=""),t({phone:"",address:""}),i(""),f("idle")},1500)}catch{f("idle"),d("    .")}};return n.jsxs("div",{className:"bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700 relative overflow-hidden transition-all duration-300",children:[n.jsxs("div",{className:`absolute inset-0 bg-gray-800 z-10 flex flex-col items-center justify-center transition-opacity duration-300 ${h==="success"?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:[n.jsx("div",{className:"scale-125 transform transition-transform duration-500 animate-bounce",children:n.jsx(Xe,{className:"w-20 h-20 text-green-500"})}),n.jsx("h3",{className:"text-xl font-bold text-white mt-4",children:"   !"})]}),n.jsx("h2",{className:"text-2xl font-bold text-neutral-100 mb-6 flex items-center justify-between",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(u_,{className:"w-6 h-6 ml-3 text-red-500"}),n.jsx("span",{children:"  "})]})}),n.jsxs("form",{onSubmit:N,className:`space-y-4 transition-opacity duration-300 ${h==="success"?"opacity-0":"opacity-100"}`,children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-neutral-300 mb-2",children:" "}),n.jsx("input",{ref:m,type:"tel",inputMode:"numeric",pattern:"[0-9]*",maxLength:11,name:"phone",id:"phone",value:e.phone,onChange:v,required:!0,disabled:h==="submitting",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-neutral-100 placeholder:text-neutral-500 focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none disabled:opacity-50 text-right placeholder:text-right font-mono",placeholder:"    11 ",dir:"rtl"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-neutral-300 mb-2",children:" "}),n.jsx("input",{ref:b,type:"text",name:"address",id:"address",value:e.address,onChange:v,required:!0,disabled:h==="submitting",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-neutral-100 placeholder:text-neutral-500 focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none disabled:opacity-50"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-neutral-300 mb-2",children:" ()"}),n.jsx("textarea",{ref:y,id:"notes",value:r,onChange:E=>i(E.target.value),rows:3,disabled:h==="submitting",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-neutral-100 placeholder:text-neutral-500 focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none disabled:opacity-50"})]}),l&&n.jsx("p",{className:"text-red-400 text-sm text-center",children:l}),n.jsx("div",{className:"pt-2",children:n.jsx("button",{type:"submit",disabled:h==="submitting",className:"w-full flex justify-center items-center bg-red-600 text-white font-bold px-6 py-3 rounded-lg shadow-md hover:bg-red-700 transition-colors disabled:bg-gray-600 disabled:cursor-not-allowed",children:h==="submitting"?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin ml-2"}),n.jsx("span",{children:"  ..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(u_,{className:"w-5 h-5 ml-2"}),n.jsx("span",{children:" "})]})})})]})]})},a$=({order:s,driver:e,viewingMerchant:t})=>{var d,h;const r=(()=>{try{const f=s.createdAt;let m;if(f.seconds?m=new Date(f.seconds*1e3):m=new Date(f),isNaN(m.getTime()))return"";const b=m.toLocaleDateString("ar-EG-u-nu-latn",{weekday:"short"}),y=m.toLocaleDateString("ar-EG-u-nu-latn",{day:"numeric",month:"numeric"}),v=m.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric"});return`${b} ${y} - ${v}`}catch{return""}})(),i=w.useMemo(()=>{if(!(t!=null&&t.canShowDeliveryTime)||s.status!==ce.Delivered||!s.deliveredAt)return null;try{let f;return s.deliveredAt.seconds?f=new Date(s.deliveredAt.seconds*1e3):f=new Date(s.deliveredAt),isNaN(f.getTime())?null:f.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric",hour12:!0})}catch{return null}},[s.deliveredAt,s.status,t]),l=s.type==="shopping_order";return n.jsxs("div",{className:`bg-gray-800 rounded-2xl p-4 space-y-3 transition-all border shadow-sm hover:shadow-md relative overflow-hidden group ${l?"border-purple-500/30":"border-gray-700"}`,children:[l&&n.jsx("div",{className:"absolute top-0 left-0 bg-purple-600 text-white text-[9px] px-2 py-0.5 rounded-br-lg font-bold z-10",children:" "}),n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1.5 flex-wrap",children:[n.jsxs("span",{className:"font-mono text-xs text-red-400 bg-red-900/10 px-2 py-0.5 rounded-md border border-red-900/30 font-bold tracking-wider",children:["#",s.id]}),n.jsxs("span",{className:"text-[10px] text-gray-400 font-medium flex items-center gap-1 bg-black/20 px-2 py-0.5 rounded-md",children:[n.jsx(xt,{className:"w-3 h-3 opacity-70"}),r]}),i&&n.jsxs("span",{className:"text-[10px] text-green-400 font-bold flex items-center gap-1 bg-green-900/20 px-2 py-0.5 rounded-md border border-green-500/20 animate-fadeIn",children:[n.jsx(Xe,{className:"w-3 h-3"}),": ",i]})]}),n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"mt-0.5",children:l?n.jsx(Ft,{className:"w-4 h-4 text-purple-400"}):n.jsx(xn,{className:"w-4 h-4 text-gray-500"})}),n.jsx("p",{className:"font-bold text-white text-sm leading-snug line-clamp-2",children:((d=s.customer)==null?void 0:d.address)||"  "})]}),s.notes&&n.jsxs("div",{className:"mt-2 bg-red-900/10 p-2.5 rounded-lg border border-red-500/20",children:[n.jsx("p",{className:"text-[11px] font-bold text-red-400 mb-1",children:":"}),n.jsx("p",{className:"text-xs text-gray-200 leading-relaxed font-medium",children:s.notes})]}),n.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[n.jsxs("p",{className:"text-xs text-gray-400 flex items-center gap-1 bg-gray-700/30 px-2 py-1 rounded-lg",children:[n.jsx(dt,{className:"w-3 h-3"}),n.jsx("span",{className:"font-mono dir-ltr copyable-phone",children:((h=s.customer)==null?void 0:h.phone)||""})]}),s.totalPrice&&n.jsxs("p",{className:"text-xs font-bold text-green-400 bg-green-900/10 px-2 py-1 rounded-lg border border-green-500/10",children:[s.totalPrice.toLocaleString("en-US")," ."]})]})]}),n.jsx("div",{className:"flex-shrink-0 mr-2 flex flex-col items-end gap-2",children:n.jsx(dS,{status:s.status})})]}),n.jsx("div",{className:"pt-3 border-t border-gray-700/50",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"p-1.5 bg-gray-700 rounded-full ml-2 border border-gray-600",children:n.jsx(Ut,{className:`w-3.5 h-3.5 ${e.name!==" "?"text-blue-400":"text-gray-500"}`})}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-[10px] text-gray-500",children:" "}),n.jsx("span",{className:`text-xs font-bold ${e.name===" "?"text-gray-500 italic":"text-white"}`,children:e.name})]})]}),e.phone&&(s.status===ce.InTransit||s.status===ce.Delivered)&&n.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[n.jsx("a",{href:`https://wa.me/2${e.phone}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-green-600/10 text-green-400 rounded-lg hover:bg-green-600/20 transition-colors border border-green-500/10",children:n.jsx(Vl,{className:"w-4 h-4"})}),n.jsx("a",{href:`tel:${e.phone}`,className:"p-2 bg-blue-600/10 text-blue-400 rounded-lg hover:bg-blue-600/20 transition-colors border border-blue-500/10",children:n.jsx($s,{className:"w-4 h-4"})})]})]})})]})},by=({active:s,label:e,count:t,onClick:r,icon:i})=>n.jsxs("button",{onClick:r,className:`flex items-center gap-2 px-4 py-2.5 rounded-xl text-xs font-bold transition-all border whitespace-nowrap ${s?"bg-red-600 text-white border-red-500 shadow-lg shadow-red-900/20":"bg-gray-800 text-gray-400 border-gray-700 hover:bg-gray-700 hover:text-gray-200"}`,children:[i&&n.jsx("span",{className:s?"text-white":"text-gray-500",children:i}),e,t!==void 0&&n.jsx("span",{className:`px-1.5 py-0.5 rounded-md text-[10px] ${s?"bg-white/20 text-white":"bg-black/20 text-gray-500"}`,children:t})]}),i$=({orders:s,users:e,viewingMerchant:t})=>{const[r,i]=w.useState(""),[l,d]=w.useState("today"),[h,f]=w.useState(!1),[m,b]=w.useState(new Date().toISOString().split("T")[0]),[y,v]=w.useState(20),N=w.useRef(null),E=Q=>{const Z=Q.createdAt;return typeof Z.toDate=="function"?Z.toDate():Z.seconds?new Date(Z.seconds*1e3):new Date(Z)},I=Q=>{const Z=new Date(Q);return Z.getHours()<6&&Z.setDate(Z.getDate()-1),Z.setHours(0,0,0,0),Z},T=w.useMemo(()=>{if(l==="all")return s;const Q=l==="today"?I(new Date):new Date(m);return Q.setHours(0,0,0,0),s.filter(Z=>{const Y=E(Z);return I(Y).getTime()===Q.getTime()})},[s,l,m]),L=w.useMemo(()=>T.filter(Q=>!h||Q.type==="shopping_order").filter(Q=>{var Z,Y;return Q.id.toLowerCase().includes(r.toLowerCase())||(((Z=Q.customer)==null?void 0:Z.address)||"").toLowerCase().includes(r.toLowerCase())||(((Y=Q.customer)==null?void 0:Y.phone)||"").includes(r)}).sort((Q,Z)=>E(Z).getTime()-E(Q).getTime()),[T,h,r]),$=w.useMemo(()=>{const Q=I(new Date);return{today:s.filter(Z=>I(E(Z)).getTime()===Q.getTime()).length,all:s.length,shopping:s.filter(Z=>Z.type==="shopping_order").length}},[s]);w.useEffect(()=>{v(20)},[L.length]),w.useEffect(()=>{const Q=new IntersectionObserver(Z=>{Z[0].isIntersecting&&y<L.length&&v(Y=>Y+20)},{threshold:.1});return N.current&&Q.observe(N.current),()=>Q.disconnect()},[L.length,y]);const B=w.useMemo(()=>L.slice(0,y),[L,y]);return n.jsxs("div",{className:"bg-gray-900 flex flex-col h-full min-h-full",children:[n.jsxs("div",{className:"px-4 py-4 flex items-center gap-2 bg-gray-900 border-b border-gray-800",children:[n.jsx("div",{className:"p-2 bg-red-600/10 rounded-xl text-red-500",children:n.jsx(Ef,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-black text-white",children:" "}),n.jsx("p",{className:"text-xs text-gray-400 font-medium",children:"   "})]})]}),n.jsxs("div",{className:"bg-gray-900 border-b border-gray-800 pb-2",children:[n.jsx("div",{className:"px-4 pt-3 pb-3",children:n.jsxs("div",{className:"relative",children:[n.jsx(Ln,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 w-5 h-5"}),n.jsx("input",{type:"text",placeholder:"    ...",value:r,onChange:Q=>i(Q.target.value),className:"w-full pl-4 pr-10 py-3 bg-gray-800 border border-gray-700 rounded-xl text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all placeholder-gray-500 text-sm shadow-inner"})]})}),n.jsxs("div",{className:"flex gap-2 overflow-x-auto px-4 pb-2 scrollbar-hide items-center",children:[n.jsx(by,{active:l==="today"&&!h,label:" ",count:$.today,onClick:()=>{d("today"),f(!1)},icon:n.jsx(xt,{className:"w-4 h-4"})}),n.jsx(by,{active:h,label:" ",count:$.shopping,onClick:()=>f(!h),icon:n.jsx(Ft,{className:"w-4 h-4"})}),n.jsx(by,{active:l==="all"&&!h,label:" ( )",count:$.all,onClick:()=>{d("all"),f(!1)},icon:n.jsx(Mr,{className:"w-4 h-4"})}),n.jsxs("div",{className:`flex items-center gap-2 px-2 py-1.5 rounded-xl border transition-all ${l==="custom"?"bg-blue-900/20 border-blue-500":"bg-gray-800 border-gray-700"}`,children:[n.jsx("input",{type:"date",value:m,onChange:Q=>{b(Q.target.value),d("custom"),f(!1)},className:"bg-transparent text-white text-xs font-bold outline-none cursor-pointer"}),n.jsx(Ba,{className:`w-4 h-4 ${l==="custom"?"text-blue-400":"text-gray-500"}`})]})]})]}),n.jsx("div",{className:"p-4 space-y-3 pb-24",children:B.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 py-20 bg-gray-800/20 rounded-3xl border border-dashed border-gray-700 mt-4",children:[n.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4 shadow-inner",children:n.jsx(F0,{className:"w-10 h-10 opacity-30"})}),n.jsx("h3",{className:"text-lg font-bold text-gray-300",children:"  "}),n.jsx("p",{className:"text-sm mt-1",children:"     ."})]}):n.jsxs(n.Fragment,{children:[B.map(Q=>{var Z,Y;return n.jsx(a$,{order:Q,driver:{name:((Z=e.find(C=>C.id===Q.driverId))==null?void 0:Z.name)||" ",phone:(Y=e.find(C=>C.id===Q.driverId))==null?void 0:Y.phone},viewingMerchant:t},Q.id)}),n.jsx("div",{ref:N,className:"h-10 flex items-center justify-center",children:y<L.length&&n.jsx("div",{className:"w-6 h-6 border-2 border-red-500 border-t-transparent rounded-full animate-spin"})})]})})]})},o$=({orders:s,onUpdateStatus:e,theme:t,users:r})=>{var y,v;const[i,l]=w.useState(null),d=s.filter(N=>N.status===ce.WaitingMerchant||N.status===ce.Preparing).sort((N,E)=>{const I=new Date(N.createdAt).getTime()||0,T=new Date(E.createdAt).getTime()||0;return I-T});if(d.length===0)return n.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 min-h-[60vh]",children:[(v=(y=t==null?void 0:t.merchant)==null?void 0:y.icons)!=null&&v.img_empty_list?n.jsx("img",{src:t.merchant.icons.img_empty_list,className:"w-24 h-24 mb-6 object-contain",alt:"Empty"}):n.jsx(F0,{className:"w-24 h-24 mb-6 opacity-20"}),n.jsx("h3",{className:"text-xl font-bold text-neutral-300 mb-2",children:"   "}),n.jsx("p",{className:"text-sm text-gray-400",children:"       ."})]});const h=({name:N,Default:E,className:I})=>{var L,$;const T=($=(L=t==null?void 0:t.merchant)==null?void 0:L.icons)==null?void 0:$[N];return T?n.jsx("img",{src:T,className:`${I} object-contain`,alt:N}):n.jsx(E,{className:I})},f=N=>{if(N!=null&&N.startsWith("data:")||N!=null&&N.startsWith("http"))return"p-0";switch(N){case"gold":return"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[2px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[2px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-0"}},m=N=>(N==null?void 0:N.startsWith("data:"))||(N==null?void 0:N.startsWith("http")),b=()=>{i&&(e(i,ce.Cancelled),l(null))};return n.jsxs("div",{className:"space-y-6 pb-24",children:[n.jsxs("h2",{className:"text-2xl font-bold text-white mb-6 flex items-center gap-3 border-b border-gray-700 pb-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-500 opacity-20"}),n.jsx(h,{name:"ic_notification",Default:xn,className:"w-8 h-8 text-red-500 relative"})]}),"   (",d.length,")"]}),d.map(N=>{var L,$,B,Q,Z,Y,C;const E=N.status===ce.WaitingMerchant,I=new Date(N.createdAt).toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric"}),T=r==null?void 0:r.find(P=>{var U;return P.phone===((U=N.customer)==null?void 0:U.phone)});return n.jsxs("div",{className:`rounded-2xl border shadow-xl overflow-hidden transition-all duration-300 ${E?"bg-gray-800 border-purple-500/50 shadow-purple-900/10":"bg-gray-800 border-orange-500/50 shadow-orange-900/10"}`,children:[n.jsxs("div",{className:`p-4 flex justify-between items-center ${E?"bg-gradient-to-r from-purple-900/40 to-gray-800":"bg-gradient-to-r from-orange-900/40 to-gray-800"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:`text-xs font-bold px-3 py-1.5 rounded-full text-white shadow-sm ${E?"bg-purple-600":"bg-orange-600"}`,children:E?" ":" "}),n.jsxs("span",{className:"text-gray-300 text-sm font-mono font-semibold tracking-wider",children:["#",N.id]})]}),n.jsxs("div",{className:"flex items-center text-gray-400 text-xs bg-black/20 px-2 py-1 rounded-lg",children:[n.jsx(h,{name:"ic_time",Default:xt,className:"w-3.5 h-3.5 ml-1.5"}),I]})]}),n.jsxs("div",{className:"p-5 border-b border-gray-700/50",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:`relative w-10 h-10 flex items-center justify-center rounded-full ${m(T==null?void 0:T.specialFrame)?"":f(T==null?void 0:T.specialFrame)}`,children:[m(T==null?void 0:T.specialFrame)&&n.jsx("img",{src:T==null?void 0:T.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-125 pointer-events-none",alt:"frame"}),n.jsx("div",{className:`${m(T==null?void 0:T.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-gray-700/50 flex items-center justify-center overflow-hidden border border-gray-600 relative z-0`,children:T!=null&&T.storeImage?n.jsx("img",{src:T.storeImage,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-5 h-5 text-gray-300"})})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-400 text-xs mb-0.5",children:""}),n.jsx("p",{className:"text-white font-bold text-lg",children:((L=N.customer)==null?void 0:L.name)||" "}),n.jsx("p",{className:"text-gray-500 text-sm font-mono dir-ltr text-right",children:(($=N.customer)==null?void 0:$.phone)||""})]})]}),n.jsxs("div",{className:"text-left bg-gray-700/30 p-2 rounded-lg border border-gray-600/30",children:[n.jsx("p",{className:"text-gray-400 text-xs mb-1",children:""}),n.jsxs("p",{className:"text-green-400 font-bold text-xl",children:[(B=N.totalPrice)==null?void 0:B.toLocaleString("en-US")," ",n.jsx("span",{className:"text-xs",children:"."})]})]})]}),N.notes&&n.jsxs("div",{className:"mt-4 bg-red-900/10 border border-red-500/20 p-3 rounded-lg",children:[n.jsx("p",{className:"text-xs text-red-400 font-bold mb-1",children:" :"}),n.jsx("p",{className:"text-sm text-gray-300",children:N.notes})]})]}),n.jsxs("div",{className:"p-5 space-y-3 bg-[#1a1a1a]/50",children:[n.jsxs("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:["  (",((Q=N.items)==null?void 0:Q.length)||0,")"]}),(Z=N.items)==null?void 0:Z.map((P,U)=>{var O,D;return n.jsxs("div",{className:"flex gap-4 bg-[#252525] p-3 rounded-xl border border-gray-700/50 items-center",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-800 rounded-lg overflow-hidden flex-shrink-0 border border-gray-600",children:P.image?n.jsx("img",{src:P.image,alt:P.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:(D=(O=t==null?void 0:t.merchant)==null?void 0:O.icons)!=null&&D.img_default_product?n.jsx("img",{src:t.merchant.icons.img_default_product,className:"w-6 h-6 object-contain"}):n.jsx(fr,{className:"w-6 h-6 opacity-50"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"flex justify-between items-start mb-1",children:n.jsx("h4",{className:"text-white font-bold text-sm truncate pl-2",children:P.name})}),n.jsxs("p",{className:"text-gray-400 text-xs",children:[P.price.toLocaleString("en-US")," . "]}),n.jsxs("p",{className:"text-green-500 font-bold text-sm mt-1",children:[": ",(P.price*P.quantity).toLocaleString("en-US")," ."]})]}),n.jsxs("div",{className:"flex flex-col items-center justify-center bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 min-w-[3.5rem]",children:[n.jsx("span",{className:"text-[10px] text-gray-400 mb-0.5",children:""}),n.jsx("span",{className:"text-xl font-black text-white",children:P.quantity})]})]},U)})]}),n.jsx("div",{className:"p-4 bg-gray-800 border-t border-gray-700",children:n.jsx("div",{className:"flex gap-3",children:E?n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>l(N.id),className:"flex-1 bg-gray-700 hover:bg-red-900/50 text-gray-300 hover:text-red-400 py-3.5 rounded-xl font-bold transition-colors border border-gray-600 hover:border-red-500/50 flex items-center justify-center gap-2",children:[((C=(Y=t==null?void 0:t.merchant)==null?void 0:Y.icons)==null?void 0:C.btn_delete)&&n.jsx("img",{src:t.merchant.icons.btn_delete,className:"w-4 h-4 object-contain"})," "]}),n.jsxs("button",{onClick:()=>e(N.id,ce.Preparing),className:"flex-[2] bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-500 hover:to-purple-600 text-white py-3.5 rounded-xl font-bold shadow-lg shadow-purple-900/30 transition-all active:scale-95 flex items-center justify-center gap-2 border border-purple-500/20",children:[n.jsx(Xe,{className:"w-5 h-5"}),"  "]})]}):n.jsxs("button",{onClick:()=>e(N.id,ce.Pending),className:"w-full bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-500 hover:to-orange-600 text-white py-4 rounded-xl font-bold shadow-lg shadow-orange-900/30 transition-all active:scale-95 flex items-center justify-center gap-2 border border-orange-500/20",children:[n.jsx(xn,{className:"w-5 h-5"}),"  ( )"]})})})]},N.id)}),i&&n.jsx(fs,{title:" ",message:"            .",onClose:()=>l(null),onConfirm:b,confirmButtonText:" ",confirmVariant:"danger"})]})},l$=({messages:s,onMarkAsSeen:e,hideMessage:t})=>{const[r,i]=w.useState(null);w.useEffect(()=>{s.forEach(d=>{e(d.id)})},[s,e]);const l=()=>{r&&(t(r),i(null))};return n.jsxs("div",{className:"space-y-6 pb-24 animate-fadeIn p-1",children:[n.jsxs("h2",{className:"text-2xl font-bold text-white mb-2 flex items-center gap-3 px-2",children:[n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-0 bg-red-500 blur-lg opacity-20 rounded-full"}),n.jsx(Dr,{className:"w-8 h-8 text-red-500 relative"})]}),n.jsx("span",{children:" "})]}),s.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 min-h-[50vh] bg-gray-800/30 rounded-3xl border border-gray-700/50 p-8 mx-2",children:[n.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4 shadow-inner border border-gray-700",children:n.jsx(Dr,{className:"w-8 h-8 text-gray-600"})}),n.jsx("p",{className:"text-lg font-semibold text-gray-300",children:"  "}),n.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"   ."})]}):n.jsx("div",{className:"space-y-5 px-2",children:s.map(d=>{const h=(()=>{try{const f=new Date(d.createdAt);return isNaN(f.getTime())?"":f.toLocaleString("ar-EG-u-nu-latn",{weekday:"short",day:"numeric",hour:"numeric",minute:"numeric"})}catch{return""}})();return n.jsxs("div",{className:"relative bg-[#1e1e1e] rounded-2xl shadow-lg border border-gray-700 overflow-hidden group hover:border-gray-500 transition-colors duration-300",children:[n.jsxs("div",{className:"bg-gradient-to-r from-[#2a2a2a] to-[#1e1e1e] p-4 flex justify-between items-start border-b border-gray-700/50",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-purple-600/10 rounded-xl border border-purple-500/20",children:n.jsx(dt,{className:"w-5 h-5 text-purple-400"})}),n.jsxs("div",{children:[n.jsx("span",{className:"block text-sm font-bold text-white",children:" "}),n.jsx("span",{className:"text-[10px] text-purple-400 bg-purple-900/20 px-2 py-0.5 rounded border border-purple-500/20",children:" "})]})]}),n.jsxs("div",{className:"text-[10px] font-medium text-gray-400 flex items-center gap-1.5 bg-black/30 px-2 py-1 rounded-md border border-white/5",children:[n.jsx(xt,{className:"w-3 h-3"}),h]})]}),n.jsxs("div",{className:"p-5",children:[d.image&&n.jsx("div",{className:"mb-4 rounded-xl overflow-hidden border border-gray-600 bg-black",children:n.jsx("img",{src:d.image,alt:"",className:"w-full h-auto max-h-64 object-contain mx-auto"})}),n.jsx("p",{className:"text-gray-200 text-sm leading-7 whitespace-pre-wrap",children:d.text})]}),n.jsx("div",{className:"px-4 py-3 bg-[#151515] flex justify-end border-t border-gray-800",children:n.jsxs("button",{onClick:()=>i(d.id),className:"flex items-center gap-2 text-gray-500 hover:text-red-400 transition-colors text-xs font-bold px-3 py-1.5 rounded-lg hover:bg-red-500/5",children:[n.jsx(jt,{className:"w-4 h-4"}),n.jsx("span",{children:""})]})})]},d.id)})}),r&&n.jsx(fs,{title:" ",message:"              .",onClose:()=>i(null),onConfirm:l,confirmButtonText:"",confirmVariant:"danger"})]})},Lg=({icon:s,label:e,subLabel:t,onClick:r,danger:i,active:l})=>n.jsxs("button",{onClick:r,className:`w-full flex items-center justify-between p-4 rounded-xl border border-transparent transition-all active:scale-[0.98] ${i?"bg-red-900/10 hover:bg-red-900/20 text-red-500":"bg-[#252525] hover:bg-[#303030] text-white hover:border-[#333]"}`,children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:`p-2.5 rounded-full ${i?"bg-red-500/10":l?"bg-green-500/20 text-green-400":"bg-gray-800 text-gray-300"}`,children:Is.cloneElement(s,{className:`w-5 h-5 ${i?"text-red-500":""}`})}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:`font-bold text-sm ${i?"text-red-400":"text-gray-200"}`,children:e}),t&&n.jsx("p",{className:`text-xs mt-0.5 ${l?"text-green-400":"text-gray-500"}`,children:t})]})]}),!i&&n.jsx(zs,{className:"w-5 h-5 text-gray-600"})]}),c$=({merchant:s,onLogout:e,onUpdateUser:t,onUpdateTheme:r,currentTheme:i})=>{var M,R;const[l,d]=w.useState("menu"),[h,f]=w.useState(""),[m,b]=w.useState(""),[y,v]=w.useState(!1),[N,E]=w.useState(((M=s.workingHours)==null?void 0:M.start)||"09:00"),[I,T]=w.useState(((R=s.workingHours)==null?void 0:R.end)||"23:00"),[L,$]=w.useState(s.storeImage||null),[B,Q]=w.useState(!1),Z=w.useRef(null),[Y,C]=w.useState(null),[P,U]=w.useState(!1),[O,D]=w.useState(!1),F=()=>{if(!h||h.length<6){C({text:"     6   .",type:"error"});return}if(h!==m){C({text:"   .",type:"error"});return}t(s.id,{password:h}),C({text:"    .",type:"success"}),setTimeout(()=>{d("menu"),f(""),b(""),C(null)},1500)},S=()=>{t(s.id,{workingHours:{start:N,end:I}}),C({text:"    .",type:"success"}),setTimeout(()=>{d("menu"),C(null)},1500)},ae=()=>{s.hasFreeDelivery?t(s.id,{hasFreeDelivery:!1}):D(!0)},K=()=>{t(s.id,{hasFreeDelivery:!0}),qt("admin",{title:"    ",body:`  "${s.name}"    .   .`,url:"/?target=stores",targetId:"all"}),D(!1)},k=V=>{var H;const X=(H=V.target.files)==null?void 0:H[0];if(X){Q(!0);const se=new FileReader;se.onloadend=()=>{const J=new Image;J.src=se.result,J.onload=()=>{const oe=document.createElement("canvas"),je=1200,ye=je/J.width;oe.width=je,oe.height=J.height*ye;const Pe=oe.getContext("2d");if(Pe){Pe.imageSmoothingEnabled=!0,Pe.imageSmoothingQuality="high",Pe.drawImage(J,0,0,oe.width,oe.height);const Fe=oe.toDataURL("image/jpeg",.9);setTimeout(()=>{$(Fe),t(s.id,{storeImage:Fe}),Q(!1)},800)}}},se.readAsDataURL(X)}},q=V=>{if(V!=null&&V.startsWith("data:")||V!=null&&V.startsWith("http"))return"p-0";switch(V){case"gold":return"p-[4px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_15px_rgba(252,246,186,0.5)]";case"neon":return"p-[4px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_15px_rgba(34,211,238,0.6)]";case"royal":return"p-[4px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-xl border border-purple-500/30";case"fire":return"p-[4px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_15px_rgba(239,68,68,0.5)]";default:return"p-0"}},W=V=>{if(!V||V==="none")return null;if(V!=null&&V.startsWith("data:")||V!=null&&V.startsWith("http"))return n.jsx("div",{className:"w-8 h-8 min-w-[2rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:n.jsx("img",{src:V,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let X=null,H="";switch(V){case"verified":X=Si,H="text-blue-400 fill-blue-500/20";break;case"vip":X=ra,H="text-yellow-400 fill-yellow-500/20";break;case"star":X=pr,H="text-purple-400 fill-purple-500/20";break;case"popular":X=Ft,H="text-red-400 fill-red-500/20";break}return X?n.jsx(X,{className:`w-6 h-6 ml-2 ${H}`}):null},ne=V=>(V==null?void 0:V.startsWith("data:"))||(V==null?void 0:V.startsWith("http"));return n.jsxs("div",{className:"pb-24 animate-fadeIn",children:[n.jsxs("div",{className:"flex items-center gap-4 py-4 mb-2",children:[l!=="menu"?n.jsx("button",{onClick:()=>d("menu"),className:"bg-[#252525] p-2 rounded-full text-gray-400 hover:text-white",children:n.jsx(zs,{className:"w-6 h-6 rotate-180"})}):n.jsx("div",{className:"w-10"}),n.jsx("h2",{className:"text-2xl font-bold text-white flex-1 text-center",children:l==="menu"?" ":l==="settings"?"":" "}),n.jsx("div",{className:"w-10"})]}),l==="menu"&&n.jsxs("div",{className:"space-y-8",children:[n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsxs("div",{className:`relative w-full aspect-video max-h-48 rounded-2xl overflow-hidden bg-[#252525] border-2 border-[#333] shadow-lg group ${ne(s.specialFrame)?"":q(s.specialFrame)}`,children:[ne(s.specialFrame)&&n.jsx("img",{src:s.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain pointer-events-none border-4 border-transparent",alt:"frame"}),n.jsxs("div",{className:`${ne(s.specialFrame)?"w-[92%] h-[92%] m-auto":"w-full h-full"} overflow-hidden rounded-xl relative z-0 flex items-center justify-center`,children:[B&&n.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 z-50 backdrop-blur-sm",children:n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full opacity-75 animate-ping absolute top-0 left-0"}),n.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center relative z-10 shadow-lg shadow-blue-500/50",children:n.jsx(gr,{className:"w-6 h-6 text-white animate-bounce"})}),n.jsx("div",{className:"w-20 h-20 border-4 border-blue-400/30 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"})]})}),L?n.jsx("img",{src:L,alt:s.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:n.jsx(Io,{className:"w-12 h-12"})}),n.jsxs("button",{onClick:()=>{var V;return!B&&((V=Z.current)==null?void 0:V.click())},className:"absolute bottom-3 left-3 bg-purple-600 text-white px-3 py-1.5 rounded-lg text-xs font-bold shadow-lg flex items-center gap-2 transition-transform active:scale-95 z-20",children:[n.jsx(Jr,{className:"w-4 h-4"})," "]}),n.jsx("input",{ref:Z,type:"file",accept:"image/*",className:"absolute opacity-0 w-0 h-0 pointer-events-none",onChange:k})]})]}),n.jsxs("div",{className:"mt-4 text-center flex items-center gap-2 justify-center",children:[n.jsx("h3",{className:"text-2xl font-bold text-white",children:s.name}),W(s.specialBadge)]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("h3",{className:"text-xs font-bold text-gray-500 mr-2 uppercase tracking-wider",children:""}),n.jsx(Lg,{icon:n.jsx(Ut,{}),label:"  ",subLabel:s.hasFreeDelivery?"  ":"  ( )",onClick:ae,active:s.hasFreeDelivery})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("h3",{className:"text-xs font-bold text-gray-500 mr-2 uppercase tracking-wider",children:" "}),n.jsx(Lg,{icon:n.jsx(xt,{}),label:" ",subLabel:s.workingHours?`${s.workingHours.start} - ${s.workingHours.end}`:" ",onClick:()=>d("hours")}),n.jsx(Lg,{icon:n.jsx(hn,{}),label:"  ",onClick:()=>d("settings")}),n.jsx(Lg,{icon:n.jsx(Sf,{}),label:" ",danger:!0,onClick:()=>U(!0)})]})]}),l==="hours"&&n.jsxs("div",{className:"bg-[#252525] p-6 rounded-2xl border border-[#333] space-y-6 animate-fadeIn",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 text-center",children:" "}),n.jsx("input",{type:"time",value:N,onChange:V=>E(V.target.value),className:"w-full px-2 py-4 bg-[#1a1a1a] border border-[#333] rounded-xl text-white text-center font-mono text-lg outline-none"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 text-center",children:" "}),n.jsx("input",{type:"time",value:I,onChange:V=>T(V.target.value),className:"w-full px-2 py-4 bg-[#1a1a1a] border border-[#333] rounded-xl text-white text-center font-mono text-lg outline-none"})]})]}),Y&&n.jsx("div",{className:`p-4 rounded-xl text-sm font-bold text-center ${Y.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:Y.text}),n.jsx("button",{onClick:S,className:"w-full bg-purple-600 text-white font-bold py-4 rounded-xl shadow-lg active:scale-95",children:" "})]}),l==="settings"&&n.jsxs("div",{className:"bg-[#252525] p-6 rounded-2xl border border-[#333] space-y-6 animate-fadeIn",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:"  "}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:y?"text":"password",value:h,onChange:V=>f(V.target.value),className:"w-full bg-[#1a1a1a] border border-[#333] rounded-xl p-4 text-white outline-none",placeholder:"******"}),n.jsx("button",{onClick:()=>v(!y),className:"absolute left-4 top-4 text-gray-500",children:y?n.jsx(wi,{className:"w-5 h-5"}):n.jsx(na,{className:"w-5 h-5"})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:"  "}),n.jsx("input",{type:"password",value:m,onChange:V=>b(V.target.value),className:"w-full bg-[#1a1a1a] border border-[#333] rounded-xl p-4 text-white outline-none",placeholder:"******"})]})]}),Y&&n.jsx("div",{className:`p-4 rounded-xl text-sm font-bold text-center ${Y.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:Y.text}),n.jsx("button",{onClick:F,className:"w-full bg-blue-600 text-white font-bold py-4 rounded-xl shadow-lg active:scale-95",children:" "})]}),P&&n.jsx(fs,{title:" ",message:"      ",onClose:()=>U(!1),onConfirm:()=>{U(!1),e()},confirmButtonText:" ",cancelButtonText:"",confirmVariant:"danger"}),O&&n.jsx(fs,{title:"  ",message:"                   .",onClose:()=>D(!1),onConfirm:K,confirmButtonText:" ",cancelButtonText:"",confirmVariant:"success"})]})},d$=({activePage:s,onNavigate:e,messageCount:t=0,theme:r,showMenu:i=!0})=>{const l=[{id:"home",key:"nav_home",label:"",icon:wv},{id:"messages",key:"nav_messages",label:"",icon:Dr},...i?[{id:"menu",key:"nav_menu",label:"",icon:Lr}]:[],{id:"history",key:"nav_history",label:"",icon:Mr}];return n.jsx("div",{className:"fixed left-4 right-4 z-40 transition-transform duration-300 ease-in-out",style:{bottom:"calc(1.5rem + env(safe-area-inset-bottom))"},children:n.jsx("nav",{className:"bg-gray-900/95 backdrop-blur-xl border border-gray-700 shadow-[0_10px_40px_rgba(0,0,0,0.6)] flex justify-around items-center h-[70px] rounded-[30px] px-2 safe-area-pb",children:l.map(d=>{var b,y;const h=d.icon,f=(y=(b=r==null?void 0:r.merchant)==null?void 0:b.icons)==null?void 0:y[d.key],m=s===d.id;return n.jsxs("button",{onClick:()=>e(d.id),className:"group relative flex-1 h-full flex flex-col items-center justify-center outline-none select-none",style:{WebkitTapHighlightColor:"transparent"},children:[n.jsxs("div",{className:`relative transition-all duration-300 ease-out p-1.5 rounded-2xl ${m?"-translate-y-2":"translate-y-1"}`,children:[n.jsx("div",{className:`absolute inset-0 bg-red-500/20 blur-xl rounded-full transition-opacity duration-300 ${m?"opacity-100":"opacity-0"}`}),f?n.jsx("img",{src:f,alt:d.label,className:`w-6 h-6 object-contain z-10 relative ${m?"drop-shadow-md":"grayscale opacity-70"}`},f):n.jsx("div",{className:"relative z-10",children:n.jsx(h,{className:`w-6 h-6 transition-all duration-300 ${m?"text-red-500 drop-shadow-[0_2px_8px_rgba(239,68,68,0.4)]":"text-gray-500"}`})}),d.id==="messages"&&t>0&&n.jsx("span",{className:"absolute -top-1 -right-2 bg-red-600 text-white text-[10px] rounded-full w-4 h-4 flex items-center justify-center font-bold border-2 border-gray-900 animate-pulse z-20 shadow-sm",children:t})]}),n.jsx("span",{className:`text-[10px] font-bold tracking-wide transition-all duration-300 absolute bottom-2 ${m?"text-white translate-y-0 opacity-100":"text-gray-500 translate-y-2 opacity-0"}`,children:d.label}),m&&n.jsx("span",{className:"absolute bottom-1 w-1 h-1 bg-red-500 rounded-full shadow-[0_0_5px_rgba(239,68,68,0.8)]"})]},d.id)})})})},u$=({message:s,onClose:e})=>n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50 p-4",onClick:e,children:n.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-sm text-white",onClick:t=>t.stopPropagation(),children:[n.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[n.jsx("h3",{className:"text-lg font-bold text-neutral-100",children:"  "}),n.jsx("button",{onClick:e,className:"text-neutral-400 hover:text-white",children:n.jsx(rt,{className:"w-6 h-6"})})]}),n.jsxs("div",{className:"p-6 space-y-4 max-h-[60vh] overflow-y-auto",children:[s.image&&n.jsx("img",{src:s.image,alt:"",className:"w-full h-auto rounded-md object-contain"}),n.jsx("p",{className:"text-neutral-200 whitespace-pre-wrap",children:s.text})]}),n.jsx("div",{className:"bg-gray-900 px-4 py-3 flex justify-end rounded-b-lg",children:n.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none",children:""})})]})}),h$=({merchant:s,orders:e,users:t,addOrder:r,messages:i,seenMessageIds:l,markMessageAsSeen:d,hideMessage:h,deletedMessageIds:f,onUpdateUser:m,onUpdateOrderStatus:b,onLogout:y,appTheme:v,onUpdateTheme:N,initialRoute:E,appConfig:I})=>{const[T,L]=w.useState("home"),[$,B]=w.useState(null),Q=s.canManageMenu!==!1;w.useEffect(()=>{(E==null?void 0:E.target)==="incoming"||(E==null?void 0:E.target)==="orders"?L("incoming"):(E==null?void 0:E.target)==="messages"?L("messages"):(E==null?void 0:E.target)==="profile"&&L("profile")},[E]),w.useEffect(()=>{If("merchant",s.id)},[s.id]),w.useEffect(()=>{ys.reportContext(T)},[T]),Wt(()=>$?(B(null),!0):T!=="home"?(L("home"),!0):!1,[T,$]);const Z=w.useMemo(()=>e.filter(k=>k.merchantId===s.id),[e,s.id]),Y=w.useMemo(()=>Z.filter(k=>k.status===ce.WaitingMerchant).length,[Z]),C=w.useMemo(()=>i.filter(k=>!f.includes(k.id)&&k.targetRole==="merchant").sort((k,q)=>new Date(q.createdAt).getTime()-new Date(k.createdAt).getTime()),[i,f]),P=w.useMemo(()=>C.filter(k=>{var q;return!((q=k.readBy)!=null&&q.includes(s.id))}).length,[C,s.id]),U=k=>{if(k!=null&&k.startsWith("data:")||k!=null&&k.startsWith("http"))return"p-0";switch(k){case"gold":return"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[2px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[2px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-0"}},O=k=>(k==null?void 0:k.startsWith("data:"))||(k==null?void 0:k.startsWith("http")),D=()=>{switch(T){case"home":return n.jsxs("div",{className:"max-w-2xl mx-auto space-y-6 animate-fadeIn",children:[n.jsx(r$,{addOrder:r}),Y>0&&n.jsxs("button",{onClick:()=>L("incoming"),className:"w-full bg-purple-600/20 border border-purple-500 text-purple-200 p-4 rounded-xl flex justify-between items-center animate-pulse",children:[n.jsxs("span",{className:"font-bold",children:[" ",Y,"  "]}),n.jsx("span",{className:"bg-purple-600 text-white px-3 py-1 rounded-full text-xs font-black",children:""})]})]});case"incoming":return n.jsx(o$,{orders:Z,onUpdateStatus:b||(()=>{}),theme:v,users:t});case"history":return n.jsx(i$,{orders:Z,users:t,viewingMerchant:s});case"menu":return Q?n.jsx(hS,{merchant:s,onUpdateMerchant:m||(()=>{})}):null;case"messages":return n.jsx(l$,{messages:C,onMarkAsSeen:d,hideMessage:h});case"profile":return n.jsx(c$,{merchant:s,onLogout:y,onUpdateUser:m||(()=>{}),onUpdateTheme:N,currentTheme:v});default:return null}},F=(I==null?void 0:I.appName)||"GOO NOW",[S,...ae]=F.split(" "),K=ae.join(" ");return n.jsxs("div",{className:"fixed inset-0 bg-gray-900 text-white flex flex-col",children:[n.jsxs("header",{className:"flex-none border-b border-gray-700 flex justify-between items-center bg-gray-900 z-30 shadow-md pt-safe px-4 h-16 box-content",children:[n.jsx("div",{className:"flex items-center",children:n.jsxs("button",{onClick:()=>L("profile"),className:`relative w-10 h-10 flex items-center justify-center rounded-full transition-transform active:scale-95 ${O(s.specialFrame)?"":U(s.specialFrame)}`,children:[O(s.specialFrame)&&n.jsx("img",{src:s.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-125 pointer-events-none",alt:"frame"}),n.jsx("div",{className:`${O(s.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full overflow-hidden border border-gray-600 relative z-0 flex items-center justify-center ${T==="profile"?"ring-2 ring-red-500":""}`,children:s.storeImage?n.jsx("img",{src:s.storeImage,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full bg-gray-800 flex items-center justify-center",children:n.jsx(dt,{className:"w-5 h-5 text-gray-400"})})})]})}),n.jsxs("h1",{className:"text-xl font-bold font-sans",children:[n.jsx("span",{className:"text-red-500",children:S}),n.jsx("span",{className:"text-white ml-1",children:K})]}),n.jsxs("button",{onClick:()=>L("incoming"),className:"relative p-2",children:[n.jsx(Tn,{className:`w-6 h-6 ${Y>0?"text-yellow-400":"text-gray-400"}`}),Y>0&&n.jsx("span",{className:"absolute top-1 right-1 w-2.5 h-2.5 bg-red-500 rounded-full animate-bounce"})]})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto pb-24 p-4 hardware-accelerated",children:[$&&n.jsx(u$,{message:$,onClose:()=>{d($.id),B(null)}}),D()]}),n.jsx(d$,{activePage:T,onNavigate:k=>L(k),messageCount:P,theme:v,showMenu:Q})]})},f$=Is.memo(({order:s,users:e,onViewDetails:t,theme:r})=>{var b;const i=s.status===ce.Pending,l=s.type==="shopping_order",d=w.useMemo(()=>e==null?void 0:e.find(y=>y.id===s.merchantId),[e,s.merchantId]),h=w.useMemo(()=>{try{let y;const v=s.createdAt;return v&&typeof v.toDate=="function"?y=v.toDate():v&&v.seconds?y=new Date(v.seconds*1e3):v instanceof Date?y=v:y=new Date(v),isNaN(y.getTime())?{day:"---",date:"---",time:"---"}:{day:y.toLocaleDateString("ar-EG-u-nu-latn",{weekday:"long"}),date:y.toLocaleDateString("ar-EG-u-nu-latn",{day:"numeric",month:"numeric",year:"numeric"}),time:y.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric",hour12:!0})}}catch{return{day:"---",date:"---",time:"---"}}},[s.createdAt]),f=y=>{if(y!=null&&y.startsWith("data:")||y!=null&&y.startsWith("http"))return"p-0";switch(y){case"gold":return"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[2px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[2px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-0"}},m=y=>(y==null?void 0:y.startsWith("data:"))||(y==null?void 0:y.startsWith("http"));return n.jsxs("button",{type:"button",onClick:y=>{y.stopPropagation(),t()},className:`w-full text-right bg-[#1e1e1e] rounded-2xl overflow-hidden shadow-lg transition-all duration-200 relative group border ${l?"border-purple-500/30":"border-white/5"} active:scale-[0.98] mb-1 cursor-pointer select-none`,children:[n.jsx("div",{className:`absolute right-0 top-0 bottom-0 w-1.5 z-10 ${l?"bg-gradient-to-b from-purple-600 to-indigo-500":i?"bg-gradient-to-b from-blue-500 to-blue-700":"bg-gradient-to-b from-green-500 to-emerald-700"}`}),l&&n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-900/10 to-transparent pointer-events-none"}),n.jsxs("div",{className:"p-4 pl-3 relative z-0",children:[n.jsxs("div",{className:"flex justify-between items-center mb-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"font-mono text-base font-black text-red-500 tracking-wider",children:["#",s.id]}),l&&n.jsxs("span",{className:"bg-purple-500/10 text-purple-400 text-[9px] font-bold px-2 py-0.5 rounded border border-purple-500/20 flex items-center gap-1",children:[n.jsx(Ft,{className:"w-3 h-3"})," "]})]}),n.jsx("div",{className:"flex items-center gap-1",children:n.jsx("span",{className:`text-[10px] font-black px-2 py-1 rounded-lg ${i?"bg-blue-500/10 text-blue-400 border border-blue-500/20 animate-pulse":"bg-green-500/10 text-green-400 border border-green-500/20"}`,children:i?" ":s.status})})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[n.jsxs("div",{className:"flex items-center gap-1.5 bg-black/30 px-2 py-1 rounded border border-white/5 shadow-inner",children:[n.jsx(Ba,{className:"w-3.5 h-3.5 text-blue-400"}),n.jsxs("span",{className:"text-[10px] font-black text-gray-300",children:[h.day," ",h.date]})]}),n.jsxs("div",{className:"flex items-center gap-1.5 bg-black/30 px-2 py-1 rounded border border-white/5 shadow-inner",children:[n.jsx(xt,{className:"w-3.5 h-3.5 text-yellow-400"}),n.jsx("span",{className:"text-[10px] font-black text-gray-300 font-mono",children:h.time})]})]}),n.jsxs("div",{className:"space-y-3 pr-1",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"mt-0.5 p-1.5 rounded-full bg-blue-500/10 text-blue-400 flex-shrink-0",children:n.jsx(pn,{className:"w-4 h-4"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-[9px] text-gray-500 font-bold mb-0.5 uppercase",children:"  ()"}),n.jsx("p",{className:"text-gray-200 font-bold text-sm leading-tight line-clamp-2",children:((b=s.customer)==null?void 0:b.address)||"  "})]})]}),n.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-xl border ${l?"bg-purple-900/10 border-purple-500/10":"bg-white/5 border-white/5"}`,children:[n.jsxs("div",{className:`relative flex items-center justify-center rounded-full flex-shrink-0 ${m(d==null?void 0:d.specialFrame)?"":f(d==null?void 0:d.specialFrame)}`,children:[m(d==null?void 0:d.specialFrame)&&n.jsx("img",{src:d==null?void 0:d.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-125 pointer-events-none",alt:"frame"}),n.jsx("div",{className:`${m(d==null?void 0:d.specialFrame)?"w-[85%] h-[85%]":"w-8 h-8"} rounded-full overflow-hidden bg-purple-500/10 flex items-center justify-center border border-purple-500/20 relative z-0`,children:l?n.jsx(Ft,{className:"w-4 h-4 text-purple-400"}):n.jsx(Xn,{className:"w-4 h-4 text-purple-400"})})]}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:`text-[9px] font-bold mb-0.5 uppercase ${l?"text-purple-300":"text-purple-400"}`,children:l?" ":" ()"}),l?n.jsxs("p",{className:"text-gray-200 text-xs leading-relaxed line-clamp-2 italic",children:['"',s.notes||"   ",'"']}):n.jsx("h4",{className:"font-black text-white text-sm truncate group-hover:text-red-400 transition-colors",children:(d==null?void 0:d.name)||s.merchantName||"   "})]})]})]}),n.jsxs("div",{className:"mt-4 pt-3 flex justify-between items-center bg-black/20 -mx-4 -mb-4 px-4 py-3",children:[n.jsx("div",{className:"flex flex-col",children:s.deliveryFee&&(s.status===ce.InTransit||s.status===ce.Delivered)?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-[9px] text-gray-500 font-bold",children:" "}),n.jsxs("span",{className:"text-green-400 font-black text-base leading-none",children:[s.deliveryFee.toLocaleString("en-US")," ",n.jsx("span",{className:"text-[9px] font-medium",children:"."})]})]}):n.jsx("span",{className:"text-[10px] font-bold text-gray-400 italic",children:"    "})}),n.jsxs("div",{className:"flex items-center gap-1.5 text-gray-400 text-[10px] font-black bg-white/5 px-3 py-1.5 rounded-xl border border-white/5 group-hover:bg-white/10 transition-all",children:[n.jsx("span",{children:" "}),n.jsx(zs,{className:"w-3.5 h-3.5 group-hover:-translate-x-1 transition-transform"})]})]})]})]})},(s,e)=>s.order.id===e.order.id&&s.order.status===e.order.status&&s.order.driverId===e.order.driverId&&s.order.deliveryFee===e.order.deliveryFee&&s.order.totalPrice===e.order.totalPrice&&s.users===e.users&&s.theme===e.theme),yy=()=>n.jsxs("div",{className:"bg-[#2A2A2A] rounded-xl p-4 border border-gray-700/50 animate-pulse",children:[n.jsxs("div",{className:"flex justify-between items-start mb-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 bg-white/5 rounded-full"}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"h-3 w-32 bg-white/10 rounded"}),n.jsx("div",{className:"h-2 w-20 bg-white/5 rounded"})]})]}),n.jsx("div",{className:"h-6 w-16 bg-white/5 rounded-full"})]}),n.jsxs("div",{className:"space-y-3 my-4",children:[n.jsx("div",{className:"h-2 w-full bg-white/5 rounded"}),n.jsx("div",{className:"h-2 w-3/4 bg-white/5 rounded"})]}),n.jsxs("div",{className:"flex gap-2 mt-4",children:[n.jsx("div",{className:"flex-1 h-10 bg-white/10 rounded-lg"}),n.jsx("div",{className:"flex-1 h-10 bg-white/5 rounded-lg"})]})]}),m$=({customImage:s})=>n.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 min-h-[60vh]",children:[n.jsx("div",{className:"relative mb-4 opacity-50",children:s?n.jsx("img",{src:s,alt:"Empty",className:"w-40 h-40 object-contain"}):n.jsxs("svg",{className:"w-40 h-40",viewBox:"0 0 100 100",children:[n.jsx("defs",{children:n.jsxs("linearGradient",{id:"grad1",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[n.jsx("stop",{offset:"0%",style:{stopColor:"rgb(59, 130, 246)",stopOpacity:.5}}),n.jsx("stop",{offset:"100%",style:{stopColor:"rgb(239, 68, 68)",stopOpacity:.5}})]})}),n.jsx("path",{d:"M 50,5 L 95,27.5 L 95,72.5 L 50,95 L 5,72.5 L 5,27.5 Z",fill:"url(#grad1)",fillOpacity:"0.1"}),n.jsx("path",{d:"M 50,5 L 95,27.5 L 50,50 L 5,27.5 Z",fill:"url(#grad1)",fillOpacity:"0.15"}),n.jsx("path",{d:"M 95,27.5 L 95,72.5 L 50,50 Z",fill:"url(#grad1)",fillOpacity:"0.1"}),n.jsx("path",{d:"M 5,27.5 L 5,72.5 L 50,50 Z",fill:"url(#grad1)",fillOpacity:"0.2"}),n.jsx("g",{transform:"translate(35, 30) scale(1.2)",children:n.jsx(F0,{})})]})}),n.jsx("h3",{className:"text-lg font-semibold text-neutral-400 mt-2",children:"   "})]}),vy=({orders:s,users:e,onViewOrder:t,theme:r,isLoading:i})=>{var l,d;return i?n.jsxs("div",{className:"p-4 space-y-3",children:[n.jsx(yy,{}),n.jsx(yy,{}),n.jsx(yy,{})]}):s.length===0?n.jsx(m$,{customImage:(d=(l=r==null?void 0:r.driver)==null?void 0:l.icons)==null?void 0:d.img_empty_orders}):n.jsx("div",{className:"p-4 space-y-3",children:s.map((h,f)=>n.jsx("div",{className:"animate-fade-in-up hardware-accelerated",className:"animate-fade-in-up hardware-accelerated",style:{animationDelay:"0ms"},children:n.jsx(f$,{order:h,users:e,onViewDetails:()=>t(h),theme:r})},h.id))})},g$=({onStartShift:s})=>n.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-white h-[calc(100vh-8rem)] p-4",children:[n.jsxs("div",{className:"relative mb-6",children:[n.jsx("div",{className:"absolute inset-0 bg-red-500 rounded-full blur-2xl opacity-30 animate-pulse"}),n.jsx(O3,{className:"w-24 h-24 text-gray-500 relative z-10"})]}),n.jsx("h2",{className:"text-2xl font-bold text-neutral-100 mb-2",children:"   "}),n.jsx("p",{className:"text-neutral-400 mb-8 max-w-xs",children:"  .           ."}),n.jsx("button",{onClick:s,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-lg transition-transform transform hover:scale-105 shadow-lg",children:" "})]}),p$=s=>{const{activeTab:e,users:t}=s,r=()=>{s.customStartShift?s.customStartShift():s.onUpdateUser(s.driver.id,{dailyLogStatus:"active",dailyLogStartedAt:new Date})};return s.driver.dailyLogMode==="12_hour"&&s.driver.dailyLogStatus!=="active"?n.jsx(g$,{onStartShift:r}):n.jsxs("div",{className:"bg-[#1A1A1A] min-h-full",children:[e==="home"&&n.jsx(vy,{orders:s.standardNewOrders,users:t,listType:"new",onViewOrder:s.onViewOrder,theme:s.theme,isLoading:s.isLoading}),e==="in-transit"&&n.jsx(vy,{orders:s.inTransitOrders,users:t,listType:"in-transit",onViewOrder:s.onViewOrder,theme:s.theme,isLoading:s.isLoading}),e==="delinow"&&n.jsx(vy,{orders:s.delinowNewOrders,users:t,listType:"new",onViewOrder:s.onViewOrder,theme:s.theme,isLoading:s.isLoading})]})},Vg=({label:s,value:e,currency:t=".",colorClass:r="text-white"})=>n.jsxs("div",{className:"flex justify-between items-baseline bg-[#2A2A2A] p-3 rounded-md",children:[n.jsx("span",{className:"text-sm font-medium text-gray-400",children:s}),n.jsxs("span",{className:`text-lg font-bold ${r}`,children:[e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})," ",t]})]}),x$=({driver:s,orders:e,users:t})=>{const r=e.filter(E=>{const I=String(E.driverId)===String(s.id),T=E.status===ce.Delivered,L=E.status!==ce.Cancelled,$=!E.reconciled,B=!E.isArchived;return I&&T&&L&&$&&B}),i=E=>Math.round((E+Number.EPSILON)*100)/100,l=E=>typeof E=="number"?E:typeof E=="string"&&parseFloat(E)||0,d=r.reduce((E,I)=>E+l(I.deliveryFee),0),h=l(s.commissionRate);let f=0;s.commissionType==="fixed"?f=r.length*h:f=d*(h/100);const m=l(s.walletOpeningBalance),b=i(d),y=i(f),v=i(b-y+m),N=s.commissionType==="fixed"?`${h} ./`:`${h}%`;return n.jsxs("div",{className:"p-4 text-white",children:[n.jsxs("div",{className:"bg-[#1F1F1F] p-5 rounded-xl shadow-lg flex flex-col space-y-4 border-t-4 border-red-500",children:[n.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[n.jsx("div",{className:"p-3 bg-gray-700 rounded-full",children:n.jsx(vv,{className:"w-6 h-6 text-red-400"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-lg text-white",children:""}),n.jsx("p",{className:"text-xs text-gray-400",children:"  ( )"})]})]}),n.jsxs("div",{className:"space-y-2 pt-3 border-t border-gray-700",children:[n.jsxs("h4",{className:"text-sm font-semibold text-gray-400 mb-2",children:["  (",r.length," ",r.length===1?"":"",")"]}),l(s.walletOpeningBalance)!==0&&n.jsx(Vg,{label:"  ()",value:l(s.walletOpeningBalance),colorClass:"text-yellow-400"}),n.jsx(Vg,{label:"  ()",value:b,colorClass:"text-blue-400"}),n.jsx(Vg,{label:`  (${N})`,value:y,colorClass:"text-red-400"}),n.jsx(Vg,{label:" ",value:v,colorClass:"text-green-400"})]}),n.jsx("div",{className:"text-center pt-4",children:n.jsx("p",{className:"text-xs text-gray-500",children:"         ."})})]}),n.jsxs("div",{className:"mt-6",children:[n.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"   "}),r.length>0?n.jsx("div",{className:"space-y-4",children:r.map((E,I)=>{const T=t.find($=>$.id===E.merchantId),L=(()=>{try{if(!E.deliveredAt)return"";const $=new Date(E.deliveredAt);return isNaN($.getTime())?"":$.toLocaleString("ar-EG-u-nu-latn",{month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"})}catch{return""}})();return n.jsxs("div",{className:"bg-[#2A2A2A] p-4 rounded-lg shadow-md border border-gray-700 flex flex-col space-y-4 animate-fade-in-up hardware-accelerated",style:{animationDelay:`${Math.min(I*50,500)}ms`},children:[n.jsxs("div",{className:"flex justify-between items-center pb-3 border-b border-gray-700",children:[n.jsx("span",{className:"font-mono text-sm text-gray-400",children:E.id}),n.jsxs("span",{className:"text-xl font-bold text-green-400",children:[l(E.deliveryFee).toLocaleString("en-US")," ."]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-start space-x-3 space-x-reverse",children:[n.jsx(pn,{className:"w-5 h-5 text-red-400 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-400",children:""}),n.jsx("p",{className:"font-semibold text-white",children:E.customer.address}),n.jsxs("p",{className:"text-sm text-gray-300 flex items-center mt-1",children:[n.jsx($s,{className:"w-4 h-4 ml-2"}),n.jsx("span",{children:E.customer.phone})]})]})]}),n.jsxs("div",{className:"flex items-start space-x-3 space-x-reverse",children:[n.jsx(Io,{className:"w-5 h-5 text-blue-400 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-400",children:""}),n.jsx("p",{className:"font-semibold text-white",children:E.merchantName}),(T==null?void 0:T.phone)&&n.jsxs("p",{className:"text-sm text-gray-300 flex items-center mt-1",children:[n.jsx($s,{className:"w-4 h-4 ml-2"}),n.jsx("span",{children:T.phone})]})]})]})]}),n.jsxs("div",{className:"flex items-center justify-end text-xs text-neutral-500 pt-3 border-t border-gray-700",children:[n.jsx(xt,{className:"w-4 h-4 ml-2"}),n.jsxs("span",{children:[" : ",L]})]})]},E.id)})}):n.jsx("div",{className:"bg-[#1F1F1F] p-8 rounded-lg text-center text-gray-500 border border-gray-800",children:n.jsx("p",{children:" !    ."})})]})]})},b$=({activePage:s,onNavigate:e,messageCount:t,theme:r,appConfig:i})=>{const l=(i==null?void 0:i.isGamesEnabled)??!0;return n.jsxs("nav",{className:"fixed bottom-0 left-0 right-0 bg-[#1A1A1A] border-t border-[#333] flex justify-around items-end h-[80px] z-40 pb-5 safe-area-pb transition-all duration-300",children:[n.jsxs("button",{onClick:()=>e("home"),className:"group relative flex-1 h-full flex flex-col items-center justify-center outline-none select-none",style:{WebkitTapHighlightColor:"transparent"},children:[n.jsx("div",{className:`relative transition-all duration-300 ease-out p-1.5 rounded-2xl ${s==="home"?"-translate-y-1.5":"translate-y-1"}`,children:n.jsx(wv,{className:`w-6 h-6 transition-all duration-300 ${s==="home"?"text-red-500 drop-shadow-[0_2px_8px_rgba(239,68,68,0.4)]":"text-gray-500"}`})}),n.jsx("span",{className:`text-[10px] font-bold tracking-wide transition-all duration-300 ${s==="home"?"text-white":"text-gray-500"}`,children:""})]}),l&&n.jsxs("button",{onClick:()=>e("games"),className:"group relative flex-1 h-full flex flex-col items-center justify-center outline-none select-none",style:{WebkitTapHighlightColor:"transparent"},children:[n.jsx("div",{className:`relative transition-all duration-300 ease-out p-1.5 rounded-2xl ${s==="games"?"-translate-y-1.5 scale-110":"translate-y-1"}`,children:n.jsx($l,{className:`w-6 h-6 transition-all duration-300 ${s==="games"?"text-purple-500 drop-shadow-[0_2px_8px_rgba(168,85,247,0.4)]":"text-gray-500"}`})}),n.jsx("span",{className:`text-[10px] font-bold tracking-wide transition-all duration-300 ${s==="games"?"text-white":"text-gray-500"}`,children:""})]}),n.jsxs("button",{onClick:()=>e("wallet"),className:"group relative flex-1 h-full flex flex-col items-center justify-center outline-none select-none",style:{WebkitTapHighlightColor:"transparent"},children:[n.jsx("div",{className:`relative transition-all duration-300 ease-out p-1.5 rounded-2xl ${s==="wallet"?"-translate-y-1.5":"translate-y-1"}`,children:n.jsx(vv,{className:`w-6 h-6 transition-all duration-300 ${s==="wallet"?"text-amber-500 drop-shadow-[0_2px_8px_rgba(245,158,11,0.4)]":"text-gray-500"}`})}),n.jsx("span",{className:`text-[10px] font-bold tracking-wide transition-all duration-300 ${s==="wallet"?"text-white":"text-gray-500"}`,children:""})]})]})},wy=({phone:s})=>s?n.jsxs("div",{className:"flex gap-3 mt-3 pt-3 border-t border-white/5",children:[n.jsxs("a",{href:`tel:${s}`,className:"flex-1 bg-blue-500/10 hover:bg-blue-500/20 text-blue-400 border border-blue-500/20 py-2.5 rounded-xl flex items-center justify-center gap-2 transition-all active:scale-95 clickable",children:[n.jsx($s,{className:"w-4 h-4"}),n.jsx("span",{className:"font-bold text-sm",children:""})]}),n.jsxs("a",{href:`https://wa.me/2${s}`,target:"_blank",rel:"noopener noreferrer",className:"flex-1 bg-green-500/10 hover:bg-green-500/20 text-green-400 border border-green-500/20 py-2.5 rounded-xl flex items-center justify-center gap-2 transition-all active:scale-95 clickable",children:[n.jsx(Vl,{className:"w-4 h-4"}),n.jsx("span",{className:"font-bold text-sm",children:""})]})]}):null,y$=({order:s,users:e,listType:t,driver:r,onAcceptOrder:i,onUpdateStatus:l,onBack:d,theme:h})=>{var Y,C,P,U,O,D;const[f,m]=w.useState(""),[b,y]=w.useState(""),v=e.find(F=>F.id===s.merchantId),N=()=>{const F=parseFloat(f);if(isNaN(F)||F<=0){y("  ");return}y(""),i(s.id,r.id,F)},E=(()=>{try{const F=new Date(s.createdAt);if(isNaN(F.getTime()))return"";const S=F.toLocaleDateString("ar-EG",{weekday:"long"}),ae=F.toLocaleDateString("ar-EG",{day:"numeric",month:"numeric"}),K=F.toLocaleTimeString("ar-EG",{hour:"numeric",minute:"numeric"});return`${S} ${ae} - ${K}`}catch{return""}})(),I=s.type==="shopping_order"&&(!s.items||s.items.length===0);let T=s.notes||"",L="",$=null;if(I&&s.notes){const F=s.notes.split("-----------");if(T=F[0].trim(),F.length>1){L=F[1].trim();const S=L.match(/01[0125][0-9]{8}/);S&&($=S[0])}}const B=s.finalPrice??s.totalPrice??0,Q=(s.deliveryFee||0)+B,Z=f!==""&&!isNaN(parseFloat(f))&&parseFloat(f)>0;return n.jsxs("div",{className:"fixed inset-0 flex flex-col bg-[#1A1A1A] text-white overflow-hidden z-[60]",children:[n.jsx("div",{className:"flex-none bg-[#1F1F1F] border-b border-white/5 shadow-sm z-10 pt-safe",children:n.jsxs("div",{className:"px-5 py-3 flex justify-between items-center",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{onClick:d,className:"p-2 -mr-2 text-gray-300 hover:text-white bg-white/5 hover:bg-white/10 rounded-full transition-colors active:scale-95 clickable",children:n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5 rotate-180",children:[n.jsx("path",{d:"M5 12h14"}),n.jsx("path",{d:"M12 5l7 7-7 7"})]})}),n.jsxs("div",{children:[n.jsxs("h1",{className:"text-xl font-black text-red-500 font-mono tracking-wider leading-none",children:["#",s.id]}),n.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] text-gray-400 mt-1.5",children:[n.jsx(xt,{className:"w-3 h-3 text-gray-500"}),n.jsx("span",{children:E})]})]})]}),s.type==="shopping_order"?n.jsxs("div",{className:"bg-purple-500/10 text-purple-300 px-3 py-1.5 rounded-lg text-[10px] font-bold border border-purple-500/20 flex items-center gap-1.5",children:[n.jsx(Ft,{className:"w-3.5 h-3.5"}),I?" ":""]}):n.jsxs("div",{className:"bg-blue-500/10 text-blue-300 px-3 py-1.5 rounded-lg text-[10px] font-bold border border-blue-500/20 flex items-center gap-1.5",children:[n.jsx(xn,{className:"w-3.5 h-3.5"})," "]})]})}),n.jsxs("div",{className:`flex-1 overflow-y-auto p-4 space-y-5 custom-scrollbar ${t==="in-transit"?"pb-44":"pb-10"}`,children:[n.jsx("div",{className:"bg-[#252525] rounded-2xl border border-white/5 p-4 shadow-lg relative overflow-hidden",children:n.jsxs("div",{className:"flex items-start gap-4 relative z-10",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-[#1A1A1A] border-2 border-red-500/30 flex items-center justify-center shadow-lg text-red-400 flex-shrink-0",children:n.jsx(pn,{className:"w-5 h-5"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-[10px] text-gray-400 font-bold mb-0.5 uppercase tracking-wider",children:" ( )"}),n.jsx("h3",{className:"text-lg font-bold text-white leading-snug break-words",children:((Y=s.customer)==null?void 0:Y.address)||"  "}),n.jsx("p",{className:"text-sm text-gray-300 font-medium mt-1",children:((C=s.customer)==null?void 0:C.name)||""})]}),n.jsx("span",{className:"text-xs text-cyan-400 font-bold font-mono bg-black/20 px-2 py-1 rounded text-left mt-1 selectable",dir:"ltr",children:(P=s.customer)==null?void 0:P.phone})]}),n.jsx(wy,{phone:((U=s.customer)==null?void 0:U.phone)||""})]})]})}),I?n.jsxs("div",{className:"bg-[#2A2A2A] rounded-2xl border border-dashed border-purple-500/30 p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Mr,{className:"w-4 h-4 text-purple-400"}),n.jsx("h4",{className:"text-xs font-bold text-gray-300",children:"  "})]}),n.jsx("p",{className:"text-sm text-white leading-relaxed whitespace-pre-wrap font-medium",children:T}),$&&n.jsxs("div",{className:"mt-3 pt-2 border-t border-white/5",children:[n.jsxs("p",{className:"text-[10px] text-green-400 flex items-center gap-1 mb-2",children:[n.jsx(Xe,{className:"w-3 h-3"}),"    : ",n.jsx("span",{className:"font-mono text-white ml-1 text-left selectable",dir:"ltr",children:$})]}),n.jsx(wy,{phone:$})]})]}):n.jsxs("div",{className:"bg-[#252525] rounded-2xl border border-white/5 p-4 relative overflow-hidden",children:[(!s.items||s.items.length===0)&&s.notes?n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Mr,{className:"w-4 h-4 text-purple-400"}),n.jsx("h4",{className:"text-xs font-bold text-gray-300",children:"  ( )"})]}),n.jsx("p",{className:"text-sm text-white leading-relaxed whitespace-pre-wrap font-medium bg-[#1A1A1A] p-3 rounded-xl border border-white/5",children:s.notes})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-3 relative z-10",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(xn,{className:"w-4 h-4 text-yellow-500"}),n.jsx("h4",{className:"text-xs font-bold text-gray-300",children:s.items&&s.items.length>0?" ":" "})]}),n.jsxs("span",{className:"text-xs font-bold text-gray-400 bg-black/20 px-2 py-0.5 rounded",children:[((O=s.items)==null?void 0:O.length)||0," "]})]}),n.jsx("div",{className:"space-y-3 relative z-10",children:(D=s.items)==null?void 0:D.map((F,S)=>n.jsxs("div",{className:"flex justify-between items-center bg-[#1A1A1A] p-2 rounded-lg border border-white/5",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"w-6 h-6 rounded bg-gray-700 flex items-center justify-center text-xs font-bold text-white",children:[F.quantity,"x"]}),n.jsx("span",{className:"text-sm text-gray-200",children:F.name})]}),n.jsx("span",{className:"text-sm font-mono text-gray-400",children:F.price})]},S))}),B>0&&n.jsxs("div",{className:"mt-4 pt-3 border-t border-white/5 flex justify-between items-center",children:[n.jsx("span",{className:"text-xs text-gray-400",children:" "}),n.jsxs("span",{className:"text-lg font-bold text-white",children:[B," ."]})]})]}),v&&n.jsxs("div",{className:"mt-4 pt-3 border-t border-white/5",children:[n.jsxs("div",{className:"flex justify-between items-start mb-2",children:[n.jsxs("div",{children:[n.jsxs("span",{className:"text-xs text-purple-400 font-bold flex items-center gap-1",children:[n.jsx(Io,{className:"w-3 h-3"})," "]}),n.jsx("span",{className:"text-sm text-white font-bold block mt-1",children:v.name})]}),v.phone&&n.jsx("span",{className:"text-xs text-purple-300 font-bold font-mono bg-black/20 px-2 py-1 rounded text-left mt-1 selectable",dir:"ltr",children:v.phone})]}),n.jsx(wy,{phone:v.phone||""})]})]}),t==="new"&&n.jsx("div",{className:"bg-[#1F1F1F] p-4 rounded-2xl border border-white/5 shadow-lg mt-2",children:n.jsxs("div",{className:"flex gap-3 items-center",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx("input",{type:"number",inputMode:"decimal",value:f,onChange:F=>{m(F.target.value),y("")},placeholder:"0",className:"w-full bg-[#111] border border-gray-600 rounded-xl px-4 py-3 text-white font-bold text-center text-lg outline-none focus:border-red-500 transition-colors"}),n.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 text-xs font-bold pointer-events-none",children:"."}),b&&n.jsx("div",{className:"absolute -top-8 left-0 right-0 text-red-500 text-xs text-center font-bold bg-[#1F1F1F] py-1 rounded shadow-md border border-red-500/30",children:b})]}),n.jsxs("button",{onClick:N,disabled:!Z,className:`flex-[2] text-white font-bold py-3.5 rounded-xl shadow-lg transition-all flex items-center justify-center gap-2 clickable
                                    ${Z?"bg-red-600 hover:bg-red-700 active:scale-95":"bg-gray-700 text-gray-400 opacity-50 cursor-not-allowed shadow-none"}`,children:[n.jsx(Xe,{className:"w-5 h-5"}),"  "]})]})})]}),t==="in-transit"&&n.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-[#1F1F1F] border-t border-white/5 z-50 shadow-[0_-5px_20px_rgba(0,0,0,0.4)] transition-all duration-200",style:{paddingBottom:"calc(1rem + env(safe-area-inset-bottom))"},children:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between items-center bg-black/20 p-3 rounded-xl border border-white/5",children:[n.jsx("span",{className:"text-xs text-gray-400",children:"  ( )"}),n.jsxs("span",{className:"text-xl font-black text-green-400",children:[Q," ",n.jsx("span",{className:"text-xs font-bold text-gray-500",children:"."})]})]}),n.jsxs("button",{onClick:()=>l(s.id,ce.Delivered),className:"w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 rounded-xl shadow-lg active:scale-95 transition-all flex items-center justify-center gap-2 clickable",children:[n.jsx(Xe,{className:"w-5 h-5"}),"  "]})]})})]})},Ug=({icon:s,label:e,subLabel:t,onClick:r,danger:i,active:l,disabled:d})=>n.jsxs("button",{onClick:d?void 0:r,className:`w-full flex items-center justify-between p-4 rounded-xl border border-transparent transition-all ${d?"cursor-default opacity-80":"active:scale-[0.98]"} ${i?"bg-red-900/10 hover:bg-red-900/20 text-red-500":"bg-[#252525] hover:bg-[#303030] text-white hover:border-[#333]"}`,children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:`p-2.5 rounded-full ${i?"bg-red-500/10":l?"bg-green-500/20 text-green-400":"bg-gray-800 text-gray-300"}`,children:Is.cloneElement(s,{className:`w-5 h-5 ${i?"text-red-500":""}`})}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:`font-bold text-sm ${i?"text-red-400":"text-gray-200"}`,children:e}),t&&n.jsx("p",{className:`text-xs mt-0.5 ${l?"text-green-400":"text-gray-500"}`,children:t})]})]}),!i&&!d&&n.jsx(zs,{className:"w-5 h-5 text-gray-600"}),d&&l&&n.jsx(Xe,{className:"w-5 h-5 text-green-500"})]}),v$=({driver:s,onClose:e,onLogout:t,onUpdateUser:r,onUpdateTheme:i,currentTheme:l})=>{const[d,h]=w.useState("menu"),[f,m]=w.useState(""),[b,y]=w.useState(""),[v,N]=w.useState(!1),[E,I]=w.useState(s.storeImage||null),[T,L]=w.useState(!1),[$,B]=w.useState(null),Q=w.useRef(null),Z=s.dailyLogStatus==="active",Y=s.dailyLogMode==="always_open",C=()=>{if(!f||f.length<6){B({text:"     6   .",type:"error"});return}if(f!==b){B({text:"   .",type:"error"});return}r(s.id,{password:f}),B({text:"    .",type:"success"}),setTimeout(()=>{h("menu"),m(""),y(""),B(null)},1500)},P=()=>{if(s.dailyLogMode==="always_open")return;const S=s.dailyLogStatus==="active"?"closed":"active",ae={dailyLogStatus:S};S==="active"&&(ae.dailyLogStartedAt=new Date),r(s.id,ae)},U=S=>{var K;const ae=(K=S.target.files)==null?void 0:K[0];if(ae){L(!0);const k=new FileReader;k.onloadend=()=>{const q=new Image;q.src=k.result,q.onload=()=>{const W=document.createElement("canvas"),ne=1024,M=ne/q.width;W.width=ne,W.height=q.height*M;const R=W.getContext("2d");if(R){R.imageSmoothingEnabled=!0,R.imageSmoothingQuality="high",R.drawImage(q,0,0,W.width,W.height);const V=W.toDataURL("image/jpeg",.9);setTimeout(()=>{I(V),r(s.id,{storeImage:V}),L(!1)},800)}}},k.readAsDataURL(ae)}},O=S=>{if(S!=null&&S.startsWith("data:")||S!=null&&S.startsWith("http"))return"p-0";switch(S){case"gold":return"p-[4px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_15px_rgba(252,246,186,0.5)]";case"neon":return"p-[4px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_15px_rgba(34,211,238,0.6)]";case"royal":return"p-[4px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-xl border border-purple-500/30";case"fire":return"p-[4px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_15px_rgba(239,68,68,0.5)]";default:return"p-0"}},D=S=>{if(!S||S==="none")return null;if(S!=null&&S.startsWith("data:")||S!=null&&S.startsWith("http"))return n.jsx("div",{className:"w-8 h-8 min-w-[2rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:n.jsx("img",{src:S,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let ae=null,K="";switch(S){case"verified":ae=Si,K="text-blue-400 fill-blue-500/20";break;case"vip":ae=ra,K="text-yellow-400 fill-yellow-500/20";break;case"star":ae=pr,K="text-purple-400 fill-purple-500/20";break;case"popular":ae=Ft,K="text-red-400 fill-red-500/20";break}return ae?n.jsx(ae,{className:`w-6 h-6 ml-2 ${K}`}):null},F=S=>(S==null?void 0:S.startsWith("data:"))||(S==null?void 0:S.startsWith("http"));return n.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm flex justify-center items-end sm:items-center z-50 animate-fadeIn",onClick:e,children:n.jsxs("div",{className:"bg-[#1a1a1a] w-full sm:max-w-md h-[90vh] sm:h-auto rounded-t-3xl sm:rounded-3xl border-t sm:border border-[#333] shadow-2xl flex flex-col relative overflow-hidden",onClick:S=>S.stopPropagation(),children:[n.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-[#333]",children:[d==="settings"?n.jsxs("button",{onClick:()=>h("menu"),className:"text-gray-400 hover:text-white flex items-center gap-1",children:[n.jsx(zs,{className:"w-5 h-5 rotate-180"}),n.jsx("span",{className:"text-sm font-bold",children:""})]}):n.jsx("h3",{className:"text-xl font-bold text-white",children:" "}),n.jsx("button",{onClick:e,className:"bg-[#252525] p-2 rounded-full text-gray-400 hover:text-white hover:bg-[#333] transition-colors",children:n.jsx(rt,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-6 scroll-smooth",children:d==="menu"?n.jsxs("div",{className:"space-y-8",children:[n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsxs("div",{className:"relative",children:[n.jsxs("div",{className:`relative w-24 h-24 flex items-center justify-center rounded-full ${F(s.specialFrame)?"":O(s.specialFrame)}`,children:[F(s.specialFrame)&&n.jsx("img",{src:s.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.7] pointer-events-none",alt:"frame"}),n.jsxs("div",{className:`${F(s.specialFrame)?"w-[85%] h-[85%]":"w-24 h-24"} bg-[#252525] rounded-full flex items-center justify-center border-4 border-[#1a1a1a] shadow-xl overflow-hidden relative group z-0`,children:[T&&n.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 z-50 backdrop-blur-sm",children:n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full opacity-75 animate-ping absolute top-0 left-0"}),n.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center relative z-10 shadow-lg shadow-blue-500/50",children:n.jsx(gr,{className:"w-4 h-4 text-white animate-bounce"})}),n.jsx("div",{className:"w-14 h-14 border-4 border-blue-400/30 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"})]})}),E?n.jsx("img",{src:E,alt:s.name,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-10 h-10 text-gray-500"})]})]}),n.jsx("button",{onClick:()=>{var S;return!T&&((S=Q.current)==null?void 0:S.click())},className:"absolute bottom-0 right-0 bg-red-600 text-white p-2 rounded-full border-4 border-[#1a1a1a] shadow-lg active:scale-95 z-20",children:n.jsx(Jr,{className:"w-4 h-4"})}),n.jsx("input",{ref:Q,type:"file",accept:"image/*",className:"absolute opacity-0 w-0 h-0 pointer-events-none",onChange:U})]}),n.jsxs("div",{className:"flex items-center gap-2 mt-3 justify-center",children:[n.jsx("h2",{className:"text-2xl font-bold text-white",children:s.name}),D(s.specialBadge)]}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx("span",{className:"bg-orange-500/10 text-orange-400 text-xs font-bold px-3 py-1 rounded-full border border-orange-500/20",children:" "}),n.jsx("span",{className:"text-gray-500 font-mono text-xs",children:s.phone})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("h3",{className:"text-xs font-bold text-gray-500 mr-2 uppercase tracking-wider",children:" "}),Y?n.jsx(Ug,{icon:n.jsx(Or,{}),label:":  ",subLabel:"    (  )",onClick:()=>{},active:!0,disabled:!0}):n.jsx(Ug,{icon:n.jsx(xt,{}),label:Z?"  ( )":"  ( )",subLabel:" 12  -   ",onClick:P,active:Z,danger:Z})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("h3",{className:"text-xs font-bold text-gray-500 mr-2 uppercase tracking-wider",children:""}),n.jsx(Ug,{icon:n.jsx(hn,{}),label:"  ",onClick:()=>h("settings")}),n.jsx(Ug,{icon:n.jsx(Sf,{}),label:" ",danger:!0,onClick:()=>{e(),t()}})]})]}):n.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsx("div",{className:"w-16 h-16 bg-blue-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-blue-500/20",children:n.jsx(hn,{className:"w-8 h-8 text-blue-400"})}),n.jsx("h3",{className:"text-lg font-bold text-white",children:"  "})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:"  "}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:v?"text":"password",value:f,onChange:S=>m(S.target.value),className:"w-full bg-[#252525] border border-[#333] rounded-xl p-4 text-white focus:border-blue-500 outline-none",placeholder:"******"}),n.jsx("button",{onClick:()=>N(!v),className:"absolute left-4 top-4 text-gray-500 hover:text-white",children:v?n.jsx(wi,{className:"w-5 h-5"}):n.jsx(na,{className:"w-5 h-5"})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:"  "}),n.jsx("input",{type:"password",value:b,onChange:S=>y(S.target.value),className:"w-full bg-[#252525] border border-[#333] rounded-xl p-4 text-white focus:border-blue-500 outline-none",placeholder:"******"})]})]}),$&&n.jsx("div",{className:`p-4 rounded-xl text-sm font-bold text-center ${$.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:$.text}),n.jsx("button",{onClick:C,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-xl shadow-lg mt-4",children:" "})]})})]})})},ZT=({onClose:s,currentCount:e,maxLimit:t})=>n.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-md flex justify-center items-center z-[100] p-4 animate-fadeIn",onClick:s,children:n.jsxs("div",{className:"bg-[#1a1a1a] w-full max-w-sm rounded-3xl border border-red-500/30 shadow-2xl overflow-hidden relative flex flex-col items-center p-8 text-center",onClick:r=>r.stopPropagation(),children:[n.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-white transition-colors bg-gray-800 p-1.5 rounded-full",children:n.jsx(rt,{className:"w-5 h-5"})}),n.jsxs("div",{className:"relative w-24 h-24 mb-6 flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-red-500/20 rounded-full animate-ping"}),n.jsx("div",{className:"relative bg-gradient-to-br from-red-600 to-red-800 w-20 h-20 rounded-full flex items-center justify-center shadow-lg border-2 border-red-400/50",children:n.jsx(jv,{className:"w-10 h-10 text-white animate-pulse"})})]}),n.jsx("h2",{className:"text-2xl font-black text-white mb-2 tracking-tight",children:"   !"}),n.jsxs("p",{className:"text-gray-400 text-sm leading-relaxed mb-6",children:["        .",n.jsx("br",{})," ",n.jsx("span",{className:"text-red-400 font-bold",children:e}),"      ",n.jsx("span",{className:"text-white font-bold bg-gray-700 px-2 rounded",children:t}),"."]}),n.jsxs("div",{className:"w-full bg-gray-800 rounded-xl p-4 border border-gray-700 mb-6",children:[n.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"  "}),n.jsx("div",{className:"w-full h-2.5 bg-gray-900 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-red-500 rounded-full w-full shadow-[0_0_10px_rgba(239,68,68,0.7)] animate-pulse"})}),n.jsxs("div",{className:"flex justify-between items-center mt-2 text-xs font-mono font-bold",children:[n.jsxs("span",{className:"text-white",children:[e," / ",t]}),n.jsx("span",{className:"text-red-400",children:""})]})]}),n.jsx("button",{onClick:s,className:"w-full bg-white text-black font-bold py-3.5 rounded-xl hover:bg-gray-200 transition-transform active:scale-95 shadow-lg",children:" "})]})}),jy={},w$=({src:s,alt:e,className:t})=>{const[r,i]=Is.useState(s&&!s.startsWith("FIRESTORE_FILE:")?s:jy[s]||""),[l,d]=Is.useState(!1);return Is.useEffect(()=>{let h=!0;if(s&&s.startsWith("FIRESTORE_FILE:")&&!jy[s]){const f=s.replace("FIRESTORE_FILE:","");f&&Dp(f).then(m=>{h&&m&&(jy[s]=m,i(m))}).catch(()=>{h&&d(!0)})}else s&&!r?i(s):s||d(!0);return()=>{h=!1}},[s,r]),l||!r?n.jsx("div",{className:`${t} bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center`,children:n.jsx($l,{className:"w-8 h-8 text-gray-700"})}):n.jsx("img",{src:r,alt:e,className:t,onError:()=>d(!0),loading:"eager"})},j$=({appConfig:s,onBack:e,onPlayGame:t})=>{var i;Is.useEffect(()=>{(s==null?void 0:s.isGamesEnabled)===!1&&e&&e()},[s==null?void 0:s.isGamesEnabled,e]);const r=((i=s==null?void 0:s.games)==null?void 0:i.filter(l=>l.isActive))||[];return n.jsxs("div",{className:"flex flex-col h-full bg-[#1A1A1A] text-white animate-fade-in-up pb-24",children:[n.jsx("div",{className:"relative z-50 overflow-hidden shadow-md border-b border-white/5 sticky top-0",children:n.jsxs("div",{className:"relative z-10 flex items-center justify-between py-2 px-3",children:[n.jsx("button",{onClick:e,className:"p-1.5 rounded-full bg-white/5 border border-white/10 hover:bg-white/10 active:scale-90 transition-all focus:outline-none focus:ring-2 focus:ring-red-500/50 flex items-center justify-center cursor-pointer","aria-label":"Back",style:{minWidth:"32px",minHeight:"32px"},children:n.jsx(kr,{className:"w-5 h-5 text-gray-100 rotate-180"})}),n.jsx("div",{className:"flex flex-col items-center",children:n.jsxs("h1",{className:"text-lg font-black tracking-tight text-white drop-shadow-sm",children:[" ",n.jsx("span",{className:"text-red-500 ml-1",children:"."})]})}),n.jsx("div",{className:"w-8"})," "]})}),n.jsx("div",{className:"flex-1",children:r.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center animate-slideUp",children:[n.jsx("div",{className:"w-20 h-20 rounded-3xl bg-gradient-to-br from-gray-800 to-black border border-white/5 flex items-center justify-center mb-6 shadow-2xl shadow-black/50",children:n.jsx($l,{className:"w-10 h-10 text-gray-600"})}),n.jsx("h3",{className:"text-lg font-bold text-gray-200",children:"   "}),n.jsx("p",{className:"text-xs text-gray-500 mt-2 max-w-[200px]",children:"    .   ."})]}):n.jsx("div",{className:"grid grid-cols-2 gap-3 pb-safe",children:r.map((l,d)=>n.jsxs("button",{onClick:()=>t(l.url),className:"group relative aspect-[4/5] rounded-2xl overflow-hidden border border-white/5 shadow-lg active:scale-[0.98] transition-all duration-300 animate-fade-in-up hardware-accelerated",style:{animationDelay:`${d*100}ms`},children:[n.jsx("div",{className:"absolute inset-0 z-0",children:n.jsx(w$,{src:l.image,alt:l.name,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110 opacity-100"})}),n.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-white/0 via-white/5 to-white/0 opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"})]},l.id))})})]})},N$=({url:s,onClose:e})=>{const t=w.useRef(null);return w.useEffect(()=>{const r=()=>{e()};return window.history.pushState({gamePlayer:!0},""),window.addEventListener("popstate",r),()=>{window.removeEventListener("popstate",r)}},[e]),n.jsxs("div",{className:"fixed inset-0 z-50 bg-[#111] flex flex-col animate-fadeIn",children:[n.jsxs("div",{className:"absolute top-0 right-0 left-0 flex items-center justify-between p-3 pt-safe z-[60] pointer-events-none",children:[n.jsx("button",{onClick:e,className:"pointer-events-auto p-2 rounded-full bg-red-600 text-white shadow-lg shadow-red-600/40 hover:bg-red-700 active:scale-90 transition-transform duration-200 border border-white/20 z-50 flex items-center justify-center cursor-pointer","aria-label":"Close Game",style:{minWidth:"36px",minHeight:"36px"},children:n.jsx(rt,{className:"w-5 h-5"})}),n.jsx("div",{className:"pointer-events-auto px-4 py-2 rounded-full bg-[#1a1a1a] border border-white/10 shadow-lg",children:n.jsx("span",{className:"text-[10px] font-bold text-gray-200 uppercase tracking-widest",children:"Web Player"})})]}),n.jsx("iframe",{ref:t,src:s,className:"flex-1 w-full h-full border-none bg-transparent",allow:"autoplay; fullscreen; vibration; gyroscope; accelerometer; clipboard-write; encrypted-media"})]})},cd=s=>s?new Date(s).getTime():0,_$=s=>{var k;const[e,t]=w.useState("home"),[r,i]=w.useState("home"),[l,d]=w.useState(null),[h,f]=w.useState(!1),[m,b]=w.useState(!1),[y,v]=w.useState(null),[N,E]=w.useState(!1),I=w.useRef(null),T=((k=s.appConfig)==null?void 0:k.appName)||"GOO NOW",[L,...$]=T.split(" "),B=$.join(" "),Q=T;w.useEffect(()=>{var q,W;if(((q=s.initialRoute)==null?void 0:q.target)==="order"&&s.initialRoute.id){const ne=s.orders.find(M=>{var R;return M.id===((R=s.initialRoute)==null?void 0:R.id)});ne&&(d(ne),ne.status===ce.InTransit&&i("in-transit"))}else((W=s.initialRoute)==null?void 0:W.target)==="messages"&&E(!0)},[s.initialRoute,s.orders]),w.useEffect(()=>{If("driver",s.driver.id)},[s.driver.id]),w.useEffect(()=>{ys.reportContext(e)},[e]),w.useEffect(()=>{const q=W=>{I.current&&!I.current.contains(W.target)&&E(!1)};return document.addEventListener("mousedown",q),()=>document.removeEventListener("mousedown",q)},[]);const Z=w.useRef(null);w.useEffect(()=>{Z.current=y},[y]),Wt(()=>N?(E(!1),!0):Z.current?(v(null),!0):h?(f(!1),!0):m?(b(!1),!0):l?(d(null),!0):e!=="home"?(t("home"),!0):r!=="home"?(i("home"),!0):!1,[h,m,l,e,r,N]);const{standardNewOrders:Y,delinowNewOrders:C,inTransitOrders:P}=w.useMemo(()=>{const q=[],W=[],ne=s.driver.id;for(const M of s.orders)M.status===ce.Pending&&!M.driverId?q.push(M):M.driverId===ne&&M.status===ce.InTransit&&W.push(M);return q.sort((M,R)=>cd(M.createdAt)-cd(R.createdAt)),W.sort((M,R)=>cd(M.createdAt)-cd(R.createdAt)),{standardNewOrders:q.filter(M=>M.type!=="shopping_order"),delinowNewOrders:q.filter(M=>M.type==="shopping_order"),inTransitOrders:W}},[s.orders,s.driver.id]),U=w.useMemo(()=>s.messages.filter(q=>{var W;return q.targetRole==="driver"&&(q.targetId==="all"||q.targetId===s.driver.id)&&!s.deletedMessageIds.includes(q.id)&&!((W=q.deletedBy)!=null&&W.includes(s.driver.id))}).sort((q,W)=>cd(W.createdAt)-cd(q.createdAt)),[s.messages,s.driver.id,s.deletedMessageIds]),O=w.useMemo(()=>U.filter(q=>{var W;return!((W=q.readBy)!=null&&W.includes(s.driver.id))}).length,[U,s.driver.id]);w.useEffect(()=>{N&&U.forEach(q=>{var W;(W=q.readBy)!=null&&W.includes(s.driver.id)||s.markMessageAsSeen(q.id)})},[N,U,s.driver.id]);const D=q=>{if(q!=null&&q.startsWith("data:")||q!=null&&q.startsWith("http"))return"p-0";switch(q){case"gold":return"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[2px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[2px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-0"}},F=q=>{if(!q||q==="none")return null;if(q!=null&&q.startsWith("data:")||q!=null&&q.startsWith("http"))return n.jsx("div",{className:"w-7 h-7 min-w-[1.75rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:n.jsx("img",{src:q,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let W=null,ne="";switch(q){case"verified":W=Si,ne="text-blue-400 fill-blue-500/20";break;case"vip":W=ra,ne="text-yellow-400 fill-yellow-500/20";break;case"star":W=pr,ne="text-purple-400 fill-purple-500/20";break;case"popular":W=Ft,ne="text-red-400 fill-red-500/20";break}return W?n.jsx(W,{className:`w-4 h-4 ml-1 ${ne}`}):null},S=q=>(q==null?void 0:q.startsWith("data:"))||(q==null?void 0:q.startsWith("http")),ae=()=>{E(!1)},K=async()=>new Promise(q=>{setTimeout(()=>{q()},1500)});return n.jsxs("div",{className:"fixed inset-0 flex flex-col bg-[#1A1A1A] text-white overflow-hidden",dir:"rtl",children:[h&&n.jsx(v$,{driver:s.driver,onClose:()=>f(!1),onLogout:s.onLogout,onUpdateUser:s.onUpdateUser,currentTheme:s.appTheme,onUpdateTheme:s.onUpdateTheme}),m&&n.jsx(ZT,{onClose:()=>b(!1),currentCount:P.length,maxLimit:s.driver.maxConcurrentOrders||0}),m&&n.jsx(ZT,{onClose:()=>b(!1),currentCount:P.length,maxLimit:s.driver.maxConcurrentOrders||0}),l?n.jsxs("div",{className:"fixed inset-0 bg-[#1A1A1A] z-50 flex flex-col animate-slide-in-bottom",children:[n.jsxs("header",{className:"flex-none flex bg-[#1A1A1A] border-b border-gray-800 h-14 items-center px-4 pt-safe box-content",children:[n.jsxs("button",{onClick:()=>d(null),className:"text-white flex items-center p-2",children:[n.jsx("span",{className:"text-2xl ml-2 rotate-180",children:""}),n.jsx("span",{className:"font-bold",children:""})]}),n.jsx("div",{className:"flex-1 text-center font-bold",children:" "})]}),n.jsx(y$,{order:l,users:s.users,listType:l.status===ce.InTransit?"in-transit":"new",driver:s.driver,onAcceptOrder:(q,W,ne)=>{s.onAcceptOrder(q,W,ne),d(null)},onUpdateStatus:(q,W)=>{s.onUpdateOrderStatus(q,W),d(null)},onBack:()=>d(null),theme:s.appTheme})]}):n.jsxs(n.Fragment,{children:[n.jsxs("header",{className:"flex-none bg-[#1A1A1A] z-30 border-b border-gray-800 h-14 flex justify-between items-center px-4 pt-safe box-content relative",children:[n.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 bg-white/5 py-1 px-3 rounded-full hover:bg-white/10 transition-colors",children:[n.jsxs("div",{className:`relative flex items-center justify-center rounded-full ${S(s.driver.specialFrame)?"":D(s.driver.specialFrame)}`,children:[S(s.driver.specialFrame)&&n.jsx("img",{src:s.driver.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-125 pointer-events-none",alt:"frame"}),n.jsx("div",{className:`${S(s.driver.specialFrame),"w-8 h-8"} rounded-full overflow-hidden border border-white/20 relative z-0 flex items-center justify-center`,children:s.driver.storeImage?n.jsx("img",{src:s.driver.storeImage,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-5 h-5 m-1.5"})})]}),n.jsx("span",{className:"text-sm font-bold truncate max-w-[80px]",children:s.driver.name}),F(s.driver.specialBadge)]}),n.jsxs("h1",{className:"text-xl font-bold",children:[n.jsx("span",{className:"text-red-500",children:L}),n.jsx("span",{className:"text-white ml-1",children:B})]}),n.jsxs("div",{className:"relative",ref:I,children:[n.jsxs("button",{onClick:()=>E(!N),className:`relative p-2 transition-colors ${N?"text-red-500":"text-gray-400 hover:text-white"}`,children:[n.jsx(Tn,{className:"w-6 h-6"}),O>0&&n.jsx("span",{className:"absolute top-1 right-1 w-2.5 h-2.5 bg-red-600 rounded-full animate-pulse border border-[#1A1A1A]"})]}),N&&n.jsxs("div",{className:"absolute top-12 left-0 w-80 bg-[#1e1e1e] border border-gray-700/50 rounded-2xl shadow-2xl overflow-hidden z-50 animate-pop-in origin-top-left",children:[n.jsxs("div",{className:"p-3 border-b border-gray-700/50 bg-[#252525] flex justify-between items-center",children:[n.jsx("span",{className:"text-xs font-bold text-white",children:""}),U.length>0&&n.jsx("button",{onClick:ae,className:"text-[10px] text-gray-400 hover:text-white transition-colors",children:""})]}),n.jsx("div",{className:"max-h-80 overflow-y-auto custom-scrollbar p-2 space-y-2",children:U.length===0?n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(Tn,{className:"w-8 h-8 mx-auto mb-2 opacity-20"}),n.jsx("p",{className:"text-[10px]",children:"   "})]}):U.map(q=>{const W=(()=>{try{const ne=new Date(q.createdAt);return isNaN(ne.getTime())?"":ne.toLocaleString("ar-EG",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"})}catch{return""}})();return n.jsxs("div",{className:"group relative bg-[#252525] rounded-xl border border-gray-700/50 shadow-sm overflow-hidden p-3 transition-all hover:bg-[#2a2a2a]",children:[n.jsxs("div",{className:"flex justify-between items-start mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-red-900/20 flex items-center justify-center text-red-500",children:n.jsx(Tn,{className:"w-4 h-4"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-xs font-bold text-white leading-tight",children:" "}),n.jsx("span",{className:"text-[9px] text-gray-500 font-mono",children:W})]})]}),n.jsx("button",{onClick:ne=>{ne.stopPropagation(),s.hideMessage(q.id)},className:"text-gray-600 hover:text-red-400 transition-colors p-1",children:n.jsx(jt,{className:"w-3.5 h-3.5"})})]}),n.jsxs("div",{children:[q.image&&n.jsx("div",{className:"mb-2 rounded-lg overflow-hidden border border-gray-600/30",children:n.jsx("img",{src:q.image,alt:"",className:"w-full h-32 object-contain bg-black/40"})}),n.jsx("p",{className:"text-gray-300 text-xs leading-relaxed font-medium",children:q.text})]}),n.jsxs("div",{className:"mt-2 flex items-center gap-1 text-[9px] text-gray-500",children:[n.jsx(Xe,{className:"w-2.5 h-2.5 text-green-500"}),n.jsx("span",{children:" "})]})]},q.id)})})]})]})]}),e==="home"&&n.jsx("div",{className:"flex-none px-3 py-2",children:n.jsxs("div",{className:"flex bg-[#2A2A2A] rounded-xl p-1 border border-gray-700",children:[n.jsxs("button",{onClick:()=>i("home"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${r==="home"?"bg-red-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[" (",Y.length,")"]}),n.jsxs("button",{onClick:()=>i("in-transit"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${r==="in-transit"?"bg-red-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[" (",P.length,")"]}),n.jsxs("button",{onClick:()=>i("delinow"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${r==="delinow"?"bg-red-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[Q," (",C.length,")"]})]})}),n.jsx("main",{className:"flex-1 overflow-hidden relative",children:n.jsxs(Fk,{onRefresh:K,className:"pb-36",children:[e==="home"&&n.jsx(p$,{driver:s.driver,users:s.users,standardNewOrders:Y,delinowNewOrders:C,inTransitOrders:P,onViewOrder:d,onUpdateUser:s.onUpdateUser,activeTab:r,theme:s.appTheme,isLoading:s.isLoading}),e==="wallet"&&n.jsx(x$,{driver:s.driver,orders:s.orders,users:s.users}),e==="games"&&n.jsx(j$,{driver:s.driver,appConfig:s.appConfig,onBack:()=>t("home"),onPlayGame:q=>v(q)})]})}),n.jsx(b$,{activePage:e,onNavigate:q=>t(q),messageCount:O,theme:s.appTheme,appConfig:s.appConfig})]}),y&&n.jsx(N$,{url:y,onClose:()=>v(null)})]})},Fg=({title:s,description:e,icon:t,colors:r,onClick:i,delay:l=0})=>n.jsxs("button",{onClick:i,className:"relative w-full h-32 sm:h-36 mt-4 group animate-fade-slide-up select-none",style:{animationDelay:`${l}ms`},children:[n.jsx("div",{className:"absolute -top-5 left-1/2 -translate-x-1/2 z-20",children:n.jsx("div",{className:"w-10 h-10 rounded-full p-1 bg-[#252525] shadow-lg group-hover:-translate-y-1 transition-transform duration-300",children:n.jsx("div",{className:`w-full h-full rounded-full flex items-center justify-center ${r.iconBg} border border-white/5`,children:t})})}),n.jsxs("div",{className:"relative w-full h-full transition-all duration-300 active:scale-95 rounded-[1.2rem]",children:[n.jsx("div",{className:"absolute -inset-[1px] rounded-[1.25rem] overflow-hidden z-0",children:n.jsx("div",{className:"absolute top-[-50%] left-[-50%] w-[200%] h-[200%] animate-[spin_3s_linear_infinite] bg-[conic-gradient(transparent,transparent,#ff0000,#ff8000,#ffff00,#00ff00,#00ffff,#0000ff,#ff00ff,#ff0000)] opacity-100"})}),n.jsxs("div",{className:"relative w-full h-full bg-[#252525] rounded-[1.2rem] p-3 pt-8 flex flex-col items-center text-center overflow-hidden z-10 shadow-md group-hover:shadow-xl",children:[n.jsx("div",{className:`absolute top-0 left-0 right-0 h-12 bg-gradient-to-b ${r.accent} to-transparent opacity-10 group-hover:opacity-20 transition-opacity`}),n.jsxs("div",{className:"relative z-10 w-full mt-1",children:[n.jsx("h3",{className:`text-xs font-bold ${r.text} mb-1 leading-tight group-hover:text-white transition-colors`,children:s}),n.jsx("p",{className:"text-[9px] text-gray-500 font-medium line-clamp-2 leading-relaxed px-1",children:e})]}),n.jsx("div",{className:`absolute bottom-0 left-1/2 -translate-x-1/2 w-0 h-0.5 ${r.text.replace("text-","bg-")} transition-all duration-500 group-hover:w-1/2 opacity-50`})]})]})]}),T$=s=>{if(s!=null&&s.startsWith("data:")||s!=null&&s.startsWith("http"))return"p-0";switch(s){case"gold":return"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.5)]";case"neon":return"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.6)]";case"royal":return"p-[4px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-xl border border-purple-500/30";case"fire":return"p-[4px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_15px_rgba(239,68,68,0.5)]";default:return"p-0"}},Ny=s=>(s==null?void 0:s.startsWith("data:"))||(s==null?void 0:s.startsWith("http")),S$=({user:s,onNavigate:e,sliderImages:t=[],sliderConfig:r,adminUser:i,merchants:l=[],messageCount:d=0,onOpenMessages:h,onOpenSupport:f,unreadSupportCount:m=0})=>{const[b,y]=w.useState(0),[v,N]=w.useState(""),[E,I]=w.useState(0),T=w.useRef(null),[L,$]=w.useState(!1),B=w.useRef(null);Wt(()=>L?($(!1),!0):!1,[L]),w.useEffect(()=>{const O=D=>{B.current&&!B.current.contains(D.target)&&$(!1)};return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[]),w.useEffect(()=>{const O=T.current;if(!O)return;const D=()=>{const F=O.scrollTop,S=Math.min(F/80,.95);I(S)};return O.addEventListener("scroll",D,{passive:!0}),()=>O.removeEventListener("scroll",D)},[]);const Q=(r==null?void 0:r.isEnabled)!==!1,Z=w.useMemo(()=>!t||!Array.isArray(t)?[]:t.filter(O=>O&&O.url&&O.active!==!1),[t]);w.useEffect(()=>{const O=new Date().getHours();O<12?N(" "):O<18?N(" "):N(" ")},[]),w.useEffect(()=>{y(0)},[Z.length]),w.useEffect(()=>{if(Q&&Z.length>1){const O=setInterval(()=>{y(D=>(D+1)%Z.length)},4e3);return()=>clearInterval(O)}},[Z.length,Q]);const Y=O=>{if(!O||O==="none")return null;if(O!=null&&O.startsWith("data:")||O!=null&&O.startsWith("http"))return n.jsx("div",{className:"w-6 h-6 min-w-[1.5rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-1 backdrop-blur-sm",children:n.jsx("img",{src:O,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let D=null,F="";switch(O){case"verified":D=Si,F="text-blue-400 fill-blue-500/20";break;case"vip":D=ra,F="text-yellow-400 fill-yellow-500/20";break;case"star":D=pr,F="text-purple-400 fill-purple-500/20";break;case"popular":D=Ft,F="text-red-400 fill-red-500/20";break}return D?n.jsx(D,{className:`w-4 h-4 ml-1 ${F}`}):null},C=(m||0)+(d||0),P=O=>{$(!1),O==="support"?f&&f():h&&h()},U=()=>{$(!1),h&&h()};return n.jsxs("div",{className:"h-full bg-[#1A1A1A] text-white flex flex-col font-sans overflow-hidden",children:[n.jsx("div",{className:"px-5 pt-safe pb-3 absolute top-0 left-0 right-0 z-50 transition-colors duration-200 box-content will-change-transform",style:{backgroundColor:`rgba(26, 26, 26, ${E})`,backdropFilter:`blur(${E*12}px)`,borderBottom:`1px solid rgba(255,255,255,${E*.05})`,boxShadow:`0 4px 20px rgba(0,0,0,${E*.1})`},children:n.jsxs("div",{className:"flex justify-between items-center mt-1",children:[n.jsxs("button",{onClick:()=>e("profile"),className:"bg-white/10 backdrop-blur-md border border-white/10 rounded-full pr-1 pl-4 py-1 flex items-center gap-3 shadow-lg active:scale-95 transition-all",children:[n.jsx("div",{className:"relative",children:n.jsxs("div",{className:`w-9 h-9 rounded-full relative flex items-center justify-center ${Ny(s.specialFrame)?"":T$(s.specialFrame)}`,children:[Ny(s.specialFrame)&&n.jsx("img",{src:s.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.7] pointer-events-none",alt:"frame"}),n.jsx("div",{className:`${Ny(s.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-[#1A1A1A] overflow-hidden relative z-0 flex items-center justify-center`,children:s.storeImage?n.jsx("img",{src:s.storeImage,alt:"User",className:"w-full h-full object-cover rounded-full"}):n.jsx("div",{className:"w-full h-full bg-[#252525] flex items-center justify-center",children:n.jsx(dt,{className:"w-4 h-4 text-gray-400"})})})]})}),n.jsxs("div",{className:"flex flex-col items-start animate-fade-slide-up",children:[n.jsxs("span",{className:"text-gray-300 text-[9px] font-medium mb-0.5 flex items-center gap-1 opacity-90",children:[v,"",n.jsx("span",{className:"text-yellow-500 animate-pulse",children:""})]}),n.jsxs("h1",{className:"text-xs font-black text-white tracking-wide leading-none flex items-center gap-1",children:[s.name.split(" ")[0],Y(s.specialBadge)]})]})]}),n.jsxs("div",{className:"relative pointer-events-auto",ref:B,children:[n.jsxs("button",{onClick:()=>$(!L),className:`relative w-10 h-10 bg-white/5 hover:bg-white/10 backdrop-blur-md rounded-full flex items-center justify-center border border-white/10 transition-all active:scale-90 shadow-sm ${C>0?"animate-swing":""}`,children:[n.jsx(Tn,{className:`w-5 h-5 ${C>0?"text-white":"text-gray-300"}`}),C>0&&n.jsx("span",{className:"absolute top-2 right-2 w-2.5 h-2.5 bg-red-600 rounded-full border-2 border-[#1A1A1A] animate-pulse"})]}),L&&n.jsxs("div",{className:"absolute top-12 left-0 w-64 bg-[#1e1e1e] border border-gray-700/50 rounded-2xl shadow-2xl overflow-hidden z-50 animate-pop-in origin-top-left",children:[n.jsxs("div",{className:"p-3 border-b border-gray-700/50 bg-[#252525] flex justify-between items-center",children:[n.jsx("span",{className:"text-xs font-bold text-white",children:""}),C>0&&n.jsx("button",{onClick:U,className:"text-[10px] text-gray-400 hover:text-white transition-colors",children:" "})]}),n.jsx("div",{className:"max-h-60 overflow-y-auto custom-scrollbar p-2 space-y-2",children:C===0?n.jsxs("div",{className:"text-center py-6 text-gray-500",children:[n.jsx(Tn,{className:"w-8 h-8 mx-auto mb-2 opacity-20"}),n.jsx("p",{className:"text-[10px]",children:"   "})]}):n.jsxs(n.Fragment,{children:[m!==void 0&&m>0&&n.jsxs("button",{onClick:()=>P("support"),className:"w-full flex items-center gap-3 p-2 rounded-xl hover:bg-white/5 transition-colors group text-right",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center text-green-400 shrink-0 border border-green-500/30",children:n.jsx(Vr,{className:"w-4 h-4"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-xs font-bold text-white mb-0.5",children:"   "}),n.jsxs("p",{className:"text-[10px] text-gray-400 truncate",children:[" ",m,"   "]})]}),n.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})]}),d!==void 0&&d>0&&n.jsxs("button",{onClick:()=>P("message"),className:"w-full flex items-center gap-3 p-2 rounded-xl hover:bg-white/5 transition-colors group text-right",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400 shrink-0 border border-blue-500/30",children:n.jsx(Dr,{className:"w-4 h-4"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-xs font-bold text-white mb-0.5",children:" "}),n.jsxs("p",{className:"text-[10px] text-gray-400 truncate",children:[" ",d,"    "]})]}),n.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]})]})})]})]})]})}),n.jsxs("div",{ref:T,className:"flex-1 overflow-y-auto pb-20 space-y-4 relative z-0 pt-24",onScroll:O=>{const D=O.currentTarget,F=Math.min(D.scrollTop/80,.95);I(F)},children:[Q&&Z.length>0&&n.jsx("div",{className:"px-4 mt-3 w-full relative z-10 h-40 sm:h-44",children:n.jsxs("div",{className:"relative w-full h-full rounded-[1.5rem] overflow-hidden shadow-2xl border border-white/5 bg-gray-800",children:[Z.map((O,D)=>{const F=O.linkedMerchantId?O.linkedMerchantId===(i==null?void 0:i.id)?i:l.find(S=>S.id===O.linkedMerchantId):null;return n.jsxs("div",{onClick:()=>{O.linkedMerchantId&&e("store-list")},className:`absolute inset-0 w-full h-full transition-opacity duration-700 ease-in-out cursor-pointer ${D===b?"opacity-100 z-10":"opacity-0 z-0"}`,children:[n.jsx("img",{src:O.url,className:"w-full h-full object-cover block",alt:"Offer"}),n.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent pointer-events-none"}),F&&n.jsx("div",{className:"absolute bottom-3 right-3 z-20 flex items-center justify-between pointer-events-none",children:n.jsxs("div",{className:"flex items-center gap-2 bg-black/40 backdrop-blur-md border border-white/10 pr-1 pl-3 py-1 rounded-full animate-fade-slide-up",children:[n.jsx("div",{className:"w-7 h-7 rounded-full border border-white/50 overflow-hidden bg-gray-800",children:F.storeImage?n.jsx("img",{src:F.storeImage,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-full h-full p-1 text-gray-400"})}),n.jsx("span",{className:"text-[10px] font-bold text-white max-w-[100px] truncate",children:F.id===(i==null?void 0:i.id)?"DELI NOW":F.name})]})}),O.textOverlay&&n.jsx("div",{className:"absolute bottom-3 left-3 max-w-[50%] z-20 flex flex-col items-start animate-fade-slide-up",children:n.jsx("div",{className:"bg-black/30 backdrop-blur-md border border-white/10 px-3 py-2 rounded-xl shadow-lg",children:n.jsx("p",{className:"text-white font-bold text-xs leading-relaxed drop-shadow-md",children:O.textOverlay})})})]},O.id)}),Z.length>1&&n.jsx("div",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 flex gap-1 z-20 pointer-events-none",children:Z.map((O,D)=>n.jsx("div",{className:`h-1 rounded-full transition-all duration-300 ${D===b?"bg-white w-4":"bg-white/30 w-1"}`},D))})]})}),n.jsxs("div",{className:"px-4 pb-4 relative z-10",children:[n.jsxs("h2",{className:"text-sm font-bold text-white mb-2 flex items-center gap-2",children:[n.jsx("span",{className:"w-1 h-4 bg-red-600 rounded-full"})," "]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx(Fg,{title:"  ",description:"   ",icon:n.jsx(Ft,{className:"w-5 h-5 text-purple-300"}),colors:{bg:"bg-[#252525]",border:"border-purple-500/20",text:"text-purple-400",iconBg:"bg-purple-500/10",accent:"from-purple-900"},onClick:()=>e("special-request"),delay:100}),n.jsx(Fg,{title:" ",description:"   ",icon:n.jsx(xn,{className:"w-5 h-5 text-orange-300"}),colors:{bg:"bg-[#252525]",border:"border-orange-500/20",text:"text-orange-400",iconBg:"bg-orange-500/10",accent:"from-orange-900"},onClick:()=>e("store-list"),delay:200}),n.jsx(Fg,{title:"",description:" -  ",icon:n.jsx(R3,{className:"w-5 h-5 text-blue-300"}),colors:{bg:"bg-[#252525]",border:"border-blue-500/20",text:"text-blue-400",iconBg:"bg-blue-500/10",accent:"from-blue-900"},onClick:()=>e("ride"),delay:300}),n.jsx(Fg,{title:" ",description:" -  ",icon:n.jsx(Ut,{className:"w-5 h-5 text-green-300"}),colors:{bg:"bg-[#252525]",border:"border-green-500/20",text:"text-green-400",iconBg:"bg-green-500/10",accent:"from-green-900"},onClick:()=>e("transport"),delay:400})]})]})]})]})},No={All:({className:s})=>n.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[n.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),n.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),n.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),n.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),Restaurant:({className:s})=>n.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[n.jsx("path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"}),n.jsx("path",{d:"M7 2v20"}),n.jsx("path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"})]}),Market:({className:s})=>n.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[n.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),n.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),Pharmacy:({className:s})=>n.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[n.jsx("path",{d:"M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8z"}),n.jsx("path",{d:"M12 7v10"}),n.jsx("path",{d:"M7 12h10"})]})},E$=[{id:"all",key:"cat_all",label:"",Icon:No.All},{id:"restaurant",key:"cat_restaurant",label:"",Icon:No.Restaurant},{id:"market",key:"cat_market",label:"",Icon:No.Market},{id:"pharmacy",key:"cat_pharmacy",label:"",Icon:No.Pharmacy}],I$=s=>{if(!s.workingHours||!s.workingHours.start||!s.workingHours.end)return!0;const e=new Date,t=e.getHours()*60+e.getMinutes(),[r,i]=s.workingHours.start.split(":").map(Number),[l,d]=s.workingHours.end.split(":").map(Number);if(isNaN(r)||isNaN(l))return!0;const h=r*60+(i||0),f=l*60+(d||0);return f<h?t>=h||t<f:t>=h&&t<f},Bg=()=>n.jsxs("div",{className:"bg-[#252525] rounded-[1.5rem] p-3 flex flex-col items-center border border-white/5 animate-pulse h-36",children:[n.jsx("div",{className:"-mt-6 mb-2",children:n.jsx("div",{className:"w-14 h-14 rounded-full bg-gray-700 border-2 border-[#1A1A1A]"})}),n.jsx("div",{className:"h-3 w-20 bg-gray-700 rounded-full mb-2"}),n.jsx("div",{className:"h-2 w-10 bg-gray-700 rounded-full mb-3"})]}),A$=({merchant:s,onClick:e,theme:t})=>{const r=I$(s),i=(l,d,h)=>{var m,b;const f=(b=(m=t==null?void 0:t.customer)==null?void 0:m.icons)==null?void 0:b[l];return f?n.jsx("img",{src:f,className:`${h} object-contain`,alt:l}):n.jsx(d,{className:h})};return n.jsxs("button",{onClick:e,className:`group relative bg-[#252525] rounded-[1.2rem] p-3 pt-7 flex flex-col items-center text-center transition-all duration-300 hover:-translate-y-1 active:scale-95 shadow-md border ${r?"border-white/5 hover:border-white/10":"border-red-900/20 opacity-80"} overflow-visible h-full`,children:[n.jsx("div",{className:"absolute -top-5",children:n.jsx("div",{className:`w-14 h-14 rounded-full p-0.5 bg-[#252525] shadow-lg ${r?"":"grayscale"}`,children:n.jsxs("div",{className:"w-full h-full rounded-full overflow-hidden border-2 border-[#1A1A1A] relative",children:[s.storeImage?n.jsx("img",{src:s.storeImage,alt:s.name,className:"w-full h-full object-cover transition-transform duration-700 group-hover:rotate-6 group-hover:scale-110"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-800 text-gray-500",children:n.jsx(Lr,{className:"w-5 h-5"})}),!r&&n.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:n.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"})})]})})}),n.jsx("h3",{className:"text-white font-bold text-xs mb-0.5 leading-tight line-clamp-1 w-full mt-2",children:s.name}),n.jsx("p",{className:"text-gray-500 text-[9px] mb-2 font-medium",children:s.storeCategory||""}),n.jsxs("div",{className:"flex items-center justify-center gap-1.5 w-full mt-auto",children:[n.jsxs("div",{className:"flex items-center gap-0.5 bg-[#1A1A1A] px-1.5 py-0.5 rounded border border-white/5",children:[n.jsx(xt,{className:"w-2.5 h-2.5 text-blue-400"}),n.jsxs("span",{className:"text-gray-300 text-[8px] font-bold",children:[s.responseTime||"30"," "]})]}),n.jsxs("div",{className:"flex items-center gap-0.5 bg-[#1A1A1A] px-1.5 py-0.5 rounded border border-white/5",children:[i("ic_star",pr,"w-2.5 h-2.5 text-yellow-500 fill-current"),n.jsx("span",{className:"text-gray-300 text-[8px] font-bold",children:"4.8"})]})]}),s.hasFreeDelivery&&n.jsx("div",{className:"absolute top-2 right-2",children:n.jsx(Ut,{className:"w-2.5 h-2.5 text-green-500"})})]})},k$=({user:s,merchants:e,onSelectMerchant:t,sliderImages:r=[],sliderConfig:i,onSpecialRequest:l,onOpenFavorites:d,adminUser:h,theme:f,messageCount:m=0,onOpenMessages:b,onOpenSupport:y,unreadSupportCount:v=0})=>{var se;const[N,E]=w.useState("all"),[I,T]=w.useState(""),[L,$]=w.useState(0),[B,Q]=w.useState(""),[Z,Y]=w.useState(!0),[C,P]=w.useState(0),U=w.useRef(null),[O,D]=w.useState(!1),F=w.useRef(null);Wt(()=>O?(D(!1),!0):!1,[O]),w.useEffect(()=>{const J=oe=>{F.current&&!F.current.contains(oe.target)&&D(!1)};return document.addEventListener("mousedown",J),()=>document.removeEventListener("mousedown",J)},[]),w.useEffect(()=>{const J=U.current;if(!J)return;const oe=()=>{const je=J.scrollTop,ye=Math.min(je/80,.95);P(ye)};return J.addEventListener("scroll",oe,{passive:!0}),()=>J.removeEventListener("scroll",oe)},[]),w.useEffect(()=>{const J=s.name?s.name.split(" ")[0]:" ";Q(` ${J}`);const oe=setTimeout(()=>Y(!1),800);return()=>clearTimeout(oe)},[s.name]);const S=(i==null?void 0:i.isEnabled)!==!1,ae=w.useMemo(()=>!r||!Array.isArray(r)?[]:r.filter(J=>J&&J.url&&J.active!==!1&&String(J.active)!=="false"),[r]),K=w.useMemo(()=>{var J;return(J=f==null?void 0:f.customer)!=null&&J.categories&&f.customer.categories.length>0?[...f.customer.categories].sort((je,ye)=>je.sortOrder-ye.sortOrder).filter(je=>je.isVisible).map(je=>{let ye=No.All;return je.key==="cat_restaurant"?ye=No.Restaurant:je.key==="cat_market"?ye=No.Market:je.key==="cat_pharmacy"&&(ye=No.Pharmacy),{id:je.id,label:je.label,Icon:ye,customIcon:je.icon}}):E$},[(se=f==null?void 0:f.customer)==null?void 0:se.categories]);w.useEffect(()=>{K.length>0&&!K.find(J=>J.id===N)&&E(K[0].id)},[K,N]),w.useEffect(()=>{$(0)},[ae.length]),w.useEffect(()=>{if(S&&ae.length>1){const J=setInterval(()=>{$(oe=>(oe+1)%ae.length)},4e3);return()=>clearInterval(J)}},[ae.length,S]);const k=e.filter(J=>{const oe=J.name.toLowerCase().includes(I.toLowerCase());let je=!0;if(N!=="all"){const ye=K.find(Pe=>Pe.id===N);ye&&(je=J.storeCategory===ye.label||J.storeCategory===ye.id,!je&&ye.id==="restaurant"&&J.storeCategory===""&&(je=!0),!je&&ye.id==="market"&&J.storeCategory===" "&&(je=!0),!je&&ye.id==="pharmacy"&&J.storeCategory===""&&(je=!0))}return oe&&je}),q=J=>{if(J.linkedMerchantId){const oe=e.find(je=>je.id===J.linkedMerchantId);oe&&t(oe,J.linkedCategoryId)}},W=(J,oe,je)=>{var Pe,Fe;const ye=(Fe=(Pe=f==null?void 0:f.customer)==null?void 0:Pe.icons)==null?void 0:Fe[J];return ye?n.jsx("img",{src:ye,className:`${je} object-contain`,alt:J}):n.jsx(oe,{className:je})},ne=J=>{if(J!=null&&J.startsWith("data:")||J!=null&&J.startsWith("http"))return"p-0";switch(J){case"gold":return"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[2px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[2px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-[2px] bg-gradient-to-tr from-red-500 to-orange-500"}},M=J=>{if(!J||J==="none")return null;if(J!=null&&J.startsWith("data:")||J!=null&&J.startsWith("http"))return n.jsx("div",{className:"w-6 h-6 min-w-[1.5rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-1 backdrop-blur-sm",children:n.jsx("img",{src:J,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let oe=null,je="";switch(J){case"verified":oe=Si,je="text-blue-400 fill-blue-500/20";break;case"vip":oe=ra,je="text-yellow-400 fill-yellow-500/20";break;case"star":oe=pr,je="text-purple-400 fill-purple-500/20";break;case"popular":oe=Ft,je="text-red-400 fill-red-500/20";break}return oe?n.jsx(oe,{className:`w-4 h-4 ml-1 ${je}`}):null},R=J=>(J==null?void 0:J.startsWith("data:"))||(J==null?void 0:J.startsWith("http")),V=(v||0)+(m||0),X=J=>{D(!1),J==="support"?y&&y():b&&b()},H=()=>{D(!1),b&&b()};return n.jsxs("div",{className:"h-[100dvh] flex flex-col relative overflow-hidden bg-[#1A1A1A] text-white font-sans",children:[n.jsx("div",{className:"absolute top-0 right-0 w-[200px] h-[200px] bg-red-500/5 rounded-full blur-[80px] -translate-y-1/2 translate-x-1/2 pointer-events-none"}),n.jsxs("div",{className:"px-5 pt-safe pb-3 absolute top-0 left-0 right-0 z-50 transition-colors duration-200 box-content will-change-transform",style:{backgroundColor:`rgba(26, 26, 26, ${C})`,backdropFilter:`blur(${C*12}px)`,borderBottom:`1px solid rgba(255,255,255,${C*.05})`,boxShadow:`0 4px 20px rgba(0,0,0,${C*.1})`},children:[n.jsxs("div",{className:"flex justify-between items-center mb-3 mt-1",children:[n.jsx("div",{className:"flex items-center",children:n.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/10 rounded-full pr-1 pl-4 py-1 flex items-center gap-3 shadow-lg",children:[n.jsx("div",{className:"relative",children:n.jsxs("div",{className:`w-9 h-9 rounded-full relative flex items-center justify-center ${R(s.specialFrame)?"":ne(s.specialFrame)}`,children:[R(s.specialFrame)&&n.jsx("img",{src:s.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-125 pointer-events-none",alt:"frame"}),n.jsx("div",{className:`${R(s.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-[#1A1A1A] overflow-hidden relative z-0 flex items-center justify-center`,children:s.storeImage?n.jsx("img",{src:s.storeImage,alt:"User",className:"w-full h-full object-cover rounded-full"}):n.jsx("div",{className:"w-full h-full bg-[#252525] flex items-center justify-center",children:n.jsx(dt,{className:"w-4 h-4 text-gray-400"})})})]})}),n.jsxs("div",{className:"flex flex-col items-start animate-fade-slide-up",children:[n.jsxs("span",{className:"text-gray-300 text-[9px] font-medium mb-0.5 flex items-center gap-1 opacity-90",children:[B,"",n.jsx("span",{className:"text-yellow-500 animate-pulse",children:""})]}),n.jsxs("h1",{className:"text-xs font-black text-white tracking-wide leading-none flex items-center gap-1",children:[s.name.split(" ")[0],M(s.specialBadge)]})]})]})}),n.jsxs("div",{className:"relative",ref:F,children:[n.jsxs("button",{onClick:()=>D(!O),className:`relative w-10 h-10 bg-white/5 hover:bg-white/10 backdrop-blur-md rounded-full flex items-center justify-center border border-white/10 transition-all active:scale-90 shadow-sm ${V>0?"animate-swing":""}`,children:[n.jsx(Tn,{className:`w-5 h-5 ${V>0?"text-white":"text-gray-300"}`}),V>0&&n.jsx("span",{className:"absolute top-2 right-2 w-2.5 h-2.5 bg-red-600 rounded-full border-2 border-[#1A1A1A] animate-pulse"})]}),O&&n.jsxs("div",{className:"absolute top-12 left-0 w-64 bg-[#1e1e1e] border border-gray-700/50 rounded-2xl shadow-2xl overflow-hidden z-50 animate-pop-in origin-top-left",children:[n.jsxs("div",{className:"p-3 border-b border-gray-700/50 bg-[#252525] flex justify-between items-center",children:[n.jsx("span",{className:"text-xs font-bold text-white",children:""}),V>0&&n.jsx("button",{onClick:H,className:"text-[10px] text-gray-400 hover:text-white transition-colors",children:" "})]}),n.jsx("div",{className:"max-h-60 overflow-y-auto custom-scrollbar p-2 space-y-2",children:V===0?n.jsxs("div",{className:"text-center py-6 text-gray-500",children:[n.jsx(Tn,{className:"w-8 h-8 mx-auto mb-2 opacity-20"}),n.jsx("p",{className:"text-[10px]",children:"   "})]}):n.jsxs(n.Fragment,{children:[v>0&&n.jsxs("button",{onClick:()=>X("support"),className:"w-full flex items-center gap-3 p-2 rounded-xl hover:bg-white/5 transition-colors group text-right",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center text-green-400 shrink-0 border border-green-500/30",children:n.jsx(Vr,{className:"w-4 h-4"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-xs font-bold text-white mb-0.5",children:"   "}),n.jsxs("p",{className:"text-[10px] text-gray-400 truncate",children:[" ",v,"   "]})]}),n.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})]}),m!==void 0&&m>0&&n.jsxs("button",{onClick:()=>X("message"),className:"w-full flex items-center gap-3 p-2 rounded-xl hover:bg-white/5 transition-colors group text-right",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400 shrink-0 border border-blue-500/30",children:n.jsx(Dr,{className:"w-4 h-4"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-xs font-bold text-white mb-0.5",children:" "}),n.jsxs("p",{className:"text-[10px] text-gray-400 truncate",children:[" ",m,"    "]})]}),n.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]})]})})]})]})]}),n.jsxs("div",{className:"relative mb-1",children:[n.jsx("div",{className:"absolute inset-y-0 right-3.5 flex items-center pointer-events-none",children:W("ic_search",Ln,"w-3.5 h-3.5 text-gray-500")}),n.jsx("input",{type:"text",className:"w-full bg-[#252525] text-white text-xs rounded-xl py-2.5 pr-9 pl-4 outline-none focus:ring-1 focus:ring-red-500/30 transition-all placeholder-gray-500 border border-white/5 shadow-inner",placeholder:"   ...",value:I,onChange:J=>T(J.target.value)})]})]}),n.jsx("div",{ref:U,className:"flex-1 overflow-y-auto pb-28 pt-28 scroll-smooth overscroll-none relative",onScroll:J=>{const oe=J.currentTarget,je=Math.min(oe.scrollTop/80,.95);P(je)},children:n.jsxs("div",{className:"space-y-4 pt-safe",children:[S&&ae.length>0&&n.jsx("div",{className:"px-5 relative z-10 h-36 sm:h-40",children:n.jsxs("div",{className:"relative w-full h-full rounded-2xl overflow-hidden shadow-lg group cursor-pointer border border-white/5 bg-gray-800",children:[ae.map((J,oe)=>{const je=J.linkedMerchantId?J.linkedMerchantId===(h==null?void 0:h.id)?h:e.find(Pe=>Pe.id===J.linkedMerchantId):null,ye=oe===L;return n.jsxs("div",{onClick:()=>q(J),className:`absolute inset-0 w-full h-full transition-opacity duration-1000 ease-in-out cursor-pointer ${ye?"opacity-100 z-10":"opacity-0 z-0"}`,children:[n.jsx("img",{src:J.url,className:`w-full h-full object-cover block transition-transform duration-[10000ms] ease-linear ${ye?"scale-110":"scale-100"}`,alt:"Banner"}),n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black/60 via-transparent to-transparent pointer-events-none"}),je&&n.jsx("div",{className:"absolute bottom-3 right-3 z-20 flex items-center justify-between pointer-events-none",children:n.jsxs("div",{className:"flex items-center gap-2 bg-black/40 backdrop-blur-md border border-white/10 pr-1 pl-3 py-1 rounded-full animate-fade-slide-up",children:[n.jsx("div",{className:"w-6 h-6 rounded-full border border-white/50 overflow-hidden bg-gray-800",children:je.storeImage?n.jsx("img",{src:je.storeImage,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-full h-full p-1 text-gray-400"})}),n.jsx("span",{className:"text-[9px] font-bold text-white max-w-[80px] truncate",children:je.name})]})}),J.textOverlay&&n.jsx("div",{className:"absolute bottom-3 left-3 max-w-[50%] z-20 flex flex-col items-start animate-fade-slide-up",children:n.jsx("div",{className:"bg-black/30 backdrop-blur-md border border-white/10 px-2 py-1.5 rounded-lg shadow-lg",children:n.jsx("p",{className:"text-white font-bold text-[10px] leading-relaxed drop-shadow-md",children:J.textOverlay})})})]},J.id)}),n.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1 z-20",children:ae.map((J,oe)=>n.jsx("div",{className:`w-1 h-1 rounded-full transition-all ${oe===L?"bg-white w-3":"bg-white/40"}`},oe))})]})}),n.jsx("div",{className:"px-5 animate-fade-slide-up",style:{animationDelay:"0.05s"},children:n.jsxs("button",{onClick:l,className:"w-full bg-gradient-to-r from-[#2A1010] to-[#1A0B0B] rounded-2xl border border-red-500/20 p-2.5 flex items-center justify-between group active:scale-98 transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-red-500/10 flex items-center justify-center text-red-400 group-hover:bg-red-500/20 transition-colors",children:W("ic_special",Ft,"w-3.5 h-3.5")}),n.jsxs("div",{className:"text-right",children:[n.jsx("h3",{className:"text-white font-bold text-xs",children:" "}),n.jsx("p",{className:"text-gray-500 text-[9px] mt-0.5",children:"   ."})]})]}),n.jsx("div",{className:"text-gray-600 group-hover:text-red-500 transition-colors",children:n.jsx(zs,{className:"w-4 h-4"})})]})}),n.jsxs("div",{className:"px-5 animate-fade-slide-up",style:{animationDelay:"0.1s"},children:[n.jsx("div",{className:"flex items-center justify-between mb-2",children:n.jsx("h3",{className:"text-xs font-bold text-white flex items-center gap-2",children:""})}),n.jsx("div",{className:"flex gap-2.5 overflow-x-auto pb-1 scrollbar-hide",children:Z?[1,2,3,4].map(J=>n.jsx("div",{className:"h-8 w-16 bg-[#252525] rounded-xl animate-pulse"},J)):K.map(J=>{const oe=N===J.id,je=J.Icon,ye=J.customIcon;return n.jsxs("button",{onClick:()=>E(J.id),className:`
                                        flex items-center gap-1.5 pl-3 pr-1.5 py-1.5 rounded-xl text-[10px] font-bold whitespace-nowrap transition-all duration-200 border
                                        ${oe?"bg-white text-black border-white shadow-sm scale-105 z-10":"bg-[#252525] text-gray-400 border-transparent hover:bg-[#303030]"}
                                    `,children:[n.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center ${oe?"bg-black text-white":"bg-white/5 text-gray-500"}`,children:ye?n.jsx("div",{className:`w-3 h-3 ${oe?"bg-white":"bg-gray-500"}`,style:{maskImage:`url(${ye})`,maskSize:"contain",maskRepeat:"no-repeat",maskPosition:"center",WebkitMaskImage:`url(${ye})`,WebkitMaskSize:"contain",WebkitMaskRepeat:"no-repeat",WebkitMaskPosition:"center"}}):n.jsx(je,{className:"w-3 h-3"})}),J.label]},J.id)})})]}),n.jsx("div",{className:"px-5 pb-10 animate-fade-slide-up",style:{animationDelay:"0.2s"},children:n.jsx("div",{className:"grid grid-cols-2 gap-3 mt-1",children:Z?n.jsxs(n.Fragment,{children:[n.jsx(Bg,{}),n.jsx(Bg,{}),n.jsx(Bg,{}),n.jsx(Bg,{})]}):k.length>0?k.map(J=>n.jsx(A$,{merchant:J,onClick:()=>t(J),theme:f},J.id)):n.jsxs("div",{className:"col-span-2 py-12 text-center flex flex-col items-center justify-center bg-[#252525] rounded-2xl border border-white/5 border-dashed",children:[n.jsx(Ln,{className:"w-8 h-8 text-gray-600 mb-2 opacity-50"}),n.jsx("p",{className:"text-gray-400 text-[10px] font-bold",children:"   "})]})})})]})})]})},C$=({product:s,onClose:e,onConfirm:t})=>{var r;return n.jsx("div",{className:"fixed inset-0 z-[60] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-gray-700 shadow-2xl overflow-hidden animate-pop-in",onClick:i=>i.stopPropagation(),children:[n.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[n.jsx("h3",{className:"font-bold text-white text-base",children:" "}),n.jsx("button",{onClick:e,className:"p-1 rounded-full bg-gray-700 text-gray-400 hover:text-white clickable",children:n.jsx(rt,{className:"w-4 h-4"})})]}),n.jsx("div",{className:"p-4 space-y-2",children:(r=s.sizes)==null?void 0:r.map((i,l)=>n.jsxs("button",{onClick:()=>t(i),className:"w-full flex justify-between items-center p-3 rounded-xl bg-gray-800 hover:bg-gray-700 border border-gray-700 hover:border-gray-500 transition-all group clickable",children:[n.jsx("span",{className:"font-bold text-gray-200 group-hover:text-white text-sm",children:i.name}),n.jsxs("span",{className:"font-bold text-green-400 text-sm",children:[i.price," ."]})]},l))})]})})},R$=({merchant:s,onBack:e,addToCart:t,cart:r,onViewCart:i,initialCategory:l,toggleFavorite:d,favoriteIds:h,appTheme:f})=>{const[m,b]=w.useState(""),[y,v]=w.useState(null),[N,E]=w.useState(0),[I,T]=w.useState(null),L=w.useRef(null),$=w.useRef(null),B=w.useRef({}),Q=w.useRef(!1);w.useEffect(()=>{const S=L.current;if(!S)return;const ae=()=>{const K=S.scrollTop,k=Math.min(K/100,.95);E(k)};return S.addEventListener("scroll",ae),()=>S.removeEventListener("scroll",ae)},[]);const Z=w.useMemo(()=>Array.from(new Set((s.products||[]).map(ae=>ae.category||""))),[s.products]);w.useEffect(()=>{const S=L.current;if(!S)return;const ae={root:S,rootMargin:"-80px 0px -70% 0px",threshold:0},K=q=>{Q.current||q.forEach(W=>{if(W.isIntersecting){const ne=W.target.getAttribute("data-category");if(ne){b(ne);const M=document.getElementById(`cat-btn-${ne}`);if(M&&$.current){const R=$.current,V=M.offsetLeft-R.offsetWidth/2+M.offsetWidth/2;R.scrollTo({left:V,behavior:"smooth"})}}}})},k=new IntersectionObserver(K,ae);return Object.values(B.current).forEach(q=>{q&&k.observe(q)}),()=>k.disconnect()},[Z]),w.useEffect(()=>{l&&Z.includes(l)?setTimeout(()=>F(l),100):Z.length>0&&b(Z[0])},[l]),Wt(()=>I?(T(null),!0):y?(v(null),!0):!1,[y,I]);const Y=r.reduce((S,ae)=>S+ae.quantity,0),C=r.reduce((S,ae)=>S+ae.price*ae.quantity,0),P=w.useMemo(()=>{const S={};return(s.products||[]).forEach(K=>{const k=K.category||"";S[k]||(S[k]=[]),S[k].push(K)}),S},[s.products]),U=S=>r.filter(ae=>ae.id===S).reduce((ae,K)=>ae+K.quantity,0),O=S=>{S.sizes&&S.sizes.length>0?T(S):t(S)},D=S=>{if(I){const ae={...I,price:S.price};t(ae,S),T(null)}},F=S=>{Q.current=!0,b(S);const ae=B.current[S],K=L.current;if(ae&&K){const q=ae.offsetTop-120;K.scrollTo({top:q,behavior:"smooth"}),setTimeout(()=>{Q.current=!1},600)}};return n.jsxs("div",{className:"bg-[#1A1A1A] text-white h-[100dvh] flex flex-col relative animate-page-enter font-sans overflow-hidden",children:[n.jsxs("div",{className:"absolute top-0 left-0 right-0 z-50 pt-safe px-4 pb-2 flex items-center justify-between transition-colors duration-200 pointer-events-none box-content h-12 will-change-transform",style:{backgroundColor:`rgba(26, 26, 26, ${N})`,backdropFilter:`blur(${N*12}px)`,borderBottom:`1px solid rgba(255,255,255,${N*.05})`,boxShadow:`0 4px 20px rgba(0,0,0,${N*.1})`},children:[n.jsx("button",{onClick:e,className:"w-9 h-9 rounded-full flex items-center justify-center text-white transition-all active:scale-95 shadow-lg pointer-events-auto bg-black/40 backdrop-blur-md border border-white/10 clickable",children:n.jsx(kr,{className:"w-5 h-5"})}),n.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 translate-y-1 pt-safe transition-opacity duration-300 pointer-events-none",style:{opacity:N>.8?1:0},children:n.jsx("h1",{className:"text-sm font-bold text-white shadow-sm text-center",children:s.name})})]}),n.jsxs("div",{ref:L,className:"flex-1 overflow-y-auto overflow-x-hidden scroll-smooth pb-safe overscroll-none",onScroll:S=>{const ae=S.currentTarget.scrollTop,K=Math.min(ae/100,.95);E(K)},children:[n.jsxs("div",{className:"relative h-44 w-full flex-shrink-0",children:[s.storeImage?n.jsx("img",{src:s.storeImage,alt:"cover",className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full bg-[#252525] flex items-center justify-center text-gray-600",children:n.jsx(bn,{className:"w-12 h-12 opacity-20"})}),n.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#1A1A1A] via-[#1A1A1A]/40 to-transparent"}),n.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 pt-8 bg-gradient-to-t from-[#1A1A1A] to-transparent",children:[n.jsxs("div",{className:"flex justify-between items-end mb-1",children:[n.jsx("h1",{className:"text-xl font-black text-white leading-tight shadow-sm drop-shadow-md",children:s.name}),n.jsxs("div",{className:"bg-white text-black text-[10px] font-bold px-1.5 py-0.5 rounded mb-1 flex items-center gap-0.5",children:["4.8 ",n.jsx(pr,{className:"w-2.5 h-2.5 inline pb-0.5 fill-current"})]})]}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-300 font-medium opacity-90 mb-2",children:[n.jsx("span",{className:"bg-red-500/20 text-red-300 px-1.5 py-0.5 rounded text-[10px] border border-red-500/30",children:s.storeCategory||""}),s.phone&&n.jsx("span",{className:"text-[10px] text-gray-400 font-mono selectable",children:s.phone})]}),n.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold w-fit",children:[n.jsxs("div",{className:"flex items-center gap-1 text-gray-300 bg-white/5 px-2 py-1 rounded-full backdrop-blur-md border border-white/10",children:[n.jsx(xt,{className:"w-3 h-3 text-blue-400"}),n.jsxs("span",{children:[s.responseTime||"30"," "]})]}),s.hasFreeDelivery&&n.jsxs("div",{className:"flex items-center gap-1 text-gray-300 bg-white/5 px-2 py-1 rounded-full backdrop-blur-md border border-white/10",children:[n.jsx(Ut,{className:"w-3 h-3 text-green-400"}),n.jsx("span",{children:""})]})]})]})]}),n.jsx("div",{className:"sticky top-0 z-40 bg-[#1A1A1A] border-b border-white/5 shadow-xl pt-1 pb-1",children:n.jsx("div",{ref:$,className:"flex gap-2 overflow-x-auto px-4 pb-2 scrollbar-hide",children:Z.map(S=>n.jsx("button",{id:`cat-btn-${S}`,onClick:()=>F(S),className:`
                            px-4 py-1.5 rounded-full text-[11px] font-bold whitespace-nowrap transition-all duration-300 border clickable
                            ${m===S?"bg-white text-black border-white shadow-sm scale-105":"bg-[#252525] text-gray-400 border-transparent hover:bg-[#303030]"}
                        `,children:S},S))})}),n.jsx("div",{className:"px-4 pt-3 space-y-5 pb-32",children:Z.map(S=>{var ae;return n.jsxs("div",{ref:K=>{B.current[S]=K},"data-category":S,className:"min-h-[60px]",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[n.jsx("h4",{className:"text-base font-black text-white",children:S}),n.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-gray-800 to-transparent"})]}),n.jsx("div",{className:"grid gap-2",children:(ae=P[S])==null?void 0:ae.map(K=>{var W;const k=U(K.id),q=K.sizes&&K.sizes.length>0;return n.jsxs("div",{className:"group bg-[#252525] rounded-xl p-2 border border-white/5 flex gap-3 relative overflow-hidden transition-all duration-300 active:bg-[#2a2a2a]",children:[k>0&&n.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-green-500"}),n.jsxs("div",{className:"w-20 h-20 bg-[#1A1A1A] rounded-lg overflow-hidden flex-shrink-0 cursor-pointer relative clickable",onClick:()=>K.image&&v(K.image),children:[K.image?n.jsx("img",{src:K.image,className:"w-full h-full object-cover",alt:K.name}):n.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:n.jsx(bn,{className:"w-5 h-5 opacity-30"})}),!K.available&&n.jsx("div",{className:"absolute inset-0 bg-black/70 flex items-center justify-center backdrop-blur-sm",children:n.jsx("span",{className:"text-[9px] font-bold text-white bg-red-600 px-2 py-0.5 rounded shadow-lg",children:" "})})]}),n.jsxs("div",{className:"flex-1 min-w-0 py-0.5 flex flex-col justify-between",children:[n.jsxs("div",{children:[n.jsx("div",{className:"flex justify-between items-start",children:n.jsx("h4",{className:"font-bold text-white text-xs mb-0.5 truncate",children:K.name})}),n.jsx("p",{className:"text-[9px] text-gray-400 line-clamp-2 leading-tight opacity-80",children:K.description})]}),n.jsxs("div",{className:"flex items-end justify-between mt-1",children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsxs("span",{className:"font-black text-white text-sm",children:[K.price>0?K.price:q?(W=K.sizes)==null?void 0:W[0].price:0,n.jsx("span",{className:"text-[9px] text-red-500 font-bold ml-0.5",children:"."})]}),q&&n.jsx("span",{className:"text-[8px] text-green-400 font-bold",children:" "})]}),k>0&&!q?n.jsxs("div",{className:"flex items-center bg-[#1A1A1A] rounded-full p-0.5 border border-green-500/30 shadow-lg",children:[n.jsx("div",{className:"px-2 text-xs font-bold text-white",children:k}),n.jsx("button",{onClick:()=>t(K),className:"w-5 h-5 bg-green-500 text-white rounded-full flex items-center justify-center active:scale-90 transition-transform clickable",children:n.jsx(Gs,{className:"w-3 h-3"})})]}):n.jsx("button",{onClick:()=>O(K),disabled:!K.available,className:`h-6 px-3 rounded-full flex items-center justify-center transition-all shadow active:scale-90 clickable ${K.available?k>0?"bg-green-600 text-white":"bg-white text-black hover:bg-gray-200":"bg-gray-700 text-gray-500 cursor-not-allowed"}`,children:k>0&&q?n.jsxs("span",{className:"text-[9px] font-bold flex items-center gap-1",children:[n.jsx(Gs,{className:"w-2 h-2"})," "]}):n.jsx(Gs,{className:"w-3.5 h-3.5"})})]})]})]},K.id)})})]},S)})})]}),Y>0&&n.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-[#1A1A1A] via-[#1A1A1A] to-transparent z-50 animate-slide-up",children:n.jsxs("button",{onClick:i,className:"w-full bg-red-600 hover:bg-red-700 text-white py-3.5 rounded-2xl shadow-xl shadow-red-600/30 flex items-center justify-between px-5 transition-all active:scale-[0.98] group border border-red-500/50 clickable",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"bg-white text-red-600 w-6 h-6 rounded-full flex items-center justify-center text-xs font-black shadow-sm",children:Y}),n.jsx("span",{className:"font-bold text-base",children:" "})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"font-black text-lg text-white",children:[C," ",n.jsx("span",{className:"text-[10px] font-medium opacity-80",children:"."})]}),n.jsx(kr,{className:"w-4 h-4 rotate-180 opacity-80 group-hover:translate-x-1 transition-transform"})]})]})}),y&&n.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-xl flex items-center justify-center p-4 animate-fadeIn",onClick:()=>v(null),children:[n.jsx("img",{src:y,className:"max-w-full max-h-full object-contain rounded-2xl shadow-2xl animate-pop-in border border-white/10",onClick:S=>S.stopPropagation()}),n.jsx("button",{onClick:()=>v(null),className:"absolute top-6 right-6 p-2 bg-gray-800 rounded-full text-white hover:bg-gray-700 transition-colors border border-white/10 clickable",children:n.jsx(rt,{className:"w-5 h-5"})})]}),I&&n.jsx(C$,{product:I,onClose:()=>T(null),onConfirm:D})]})},D$=({cart:s,onBack:e,onUpdateQuantity:t,onRemoveItem:r,onPlaceOrder:i,savedAddresses:l=[],appTheme:d,promoCodes:h,userPoints:f,pointsConfig:m,userPhone:b,onGoToStores:y})=>{const[v,N]=w.useState("all"),[E,I]=w.useState(!1),[T,L]=w.useState(""),[$,B]=w.useState(""),[Q,Z]=w.useState(!1),[Y,C]=w.useState(""),[P,U]=w.useState(null),[O,D]=w.useState(!1),[F,S]=w.useState(""),[ae,K]=w.useState(0),k=w.useRef(null),q=(m==null?void 0:m.isPointsEnabled)??!0;w.useEffect(()=>{const ye=k.current;if(!ye)return;const Pe=()=>{const Fe=ye.scrollTop,Re=Math.min(Fe/60,.95);K(Re)};return ye.addEventListener("scroll",Pe),()=>ye.removeEventListener("scroll",Pe)},[]),w.useEffect(()=>{l.length>0&&N(l[0])},[l]);const W=s.reduce((ye,Pe)=>ye+Pe.price*Pe.quantity,0),ne=f*m.currencyPerPoint,M=O&&q?Math.min(ne,W):0,R=O&&q?Math.ceil(M/m.currencyPerPoint):0;let V=0;P&&(P.type==="percentage"?V=W*P.value/100:V=P.value);const X=Math.min(M+V,W),H=W-X,se=()=>{if(S(""),!Y.trim())return;const ye=Y.trim().toUpperCase(),Pe=h.find(Fe=>Fe.code===ye&&Fe.isActive);if(!Pe){S("     ."),U(null);return}if(Pe.expiryDate&&new Date(Pe.expiryDate)<new Date){S("   ."),U(null);return}if(Pe.maxUsage&&Pe.usageCount>=Pe.maxUsage){S("      ."),U(null);return}U(Pe),C("")},J=()=>{U(null),S("")},oe=()=>{T.trim()&&(N(T),I(!1))},je=()=>{if(E&&T.trim())N(T),I(!1);else if(!v||v==="all"){I(!0);return}Z(!0);const ye=E&&T.trim()?T:v,Pe={discountAmount:X,promoCode:P==null?void 0:P.code,pointsUsed:O&&q?R:0,finalPrice:H};i($,ye,b,Pe)};return n.jsxs("div",{className:"bg-[#1A1A1A] h-full flex flex-col relative animate-page-enter font-sans overflow-hidden fixed inset-0",children:[n.jsxs("div",{className:"absolute top-0 left-0 right-0 z-40 pt-safe px-4 pb-2 flex items-center justify-between transition-all duration-300 pointer-events-none box-content h-12",style:{backgroundColor:`rgba(26, 26, 26, ${ae})`,backdropFilter:ae>.5?"blur(12px)":"none",borderBottom:ae>.5?"1px solid rgba(255,255,255,0.05)":"none"},children:[n.jsxs("div",{className:"flex items-center gap-3 pointer-events-auto",children:[n.jsx("button",{onClick:e,className:"bg-[#252525] hover:opacity-80 p-2 rounded-full text-white transition-colors border border-white/5 active:scale-95 shadow-sm",children:n.jsx(kr,{className:"w-5 h-5"})}),n.jsx("div",{style:{opacity:ae>.2?1:0,transition:"opacity 0.3s"},children:n.jsx("h1",{className:"text-lg font-black text-white leading-none",children:" "})})]}),n.jsxs("div",{className:"bg-red-600/10 text-red-400 px-2 py-1 rounded-lg text-xs font-bold border border-red-500/20 font-mono shadow-sm pointer-events-auto",children:[s.reduce((ye,Pe)=>ye+Pe.quantity,0)," "]})]}),n.jsxs("div",{ref:k,className:"flex-1 overflow-y-auto pt-20 px-4 space-y-5 pb-48",style:{overscrollBehavior:"none",WebkitOverflowScrolling:"touch"},onScroll:ye=>{const Pe=Math.min(ye.currentTarget.scrollTop/60,.95);K(Pe)},children:[!ae&&n.jsx("div",{className:"mb-2 transition-opacity duration-300",children:n.jsx("h1",{className:"text-2xl font-black text-white leading-none",children:" "})}),s.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center h-full min-h-[50vh] animate-fadeIn",children:[n.jsx("div",{className:"w-24 h-24 bg-[#252525] rounded-full flex items-center justify-center mb-4 border border-dashed border-gray-700 shadow-inner",children:n.jsx(xn,{className:"w-10 h-10 text-gray-600 opacity-50"})}),n.jsx("h2",{className:"text-xl font-bold text-white mb-1",children:" "}),n.jsx("p",{className:"text-gray-500 text-xs mb-6",children:"   ."}),n.jsx("button",{onClick:y||e,className:"bg-white text-black font-bold py-3 px-8 rounded-xl hover:bg-gray-200 transition-all shadow-lg active:scale-95 text-sm",children:" "})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"space-y-3",children:s.map((ye,Pe)=>{var Fe;return n.jsxs("div",{className:"flex gap-3 p-2 bg-[#252525] rounded-2xl border border-white/5 shadow-sm items-center",children:[n.jsx("div",{className:"w-16 h-16 bg-[#1A1A1A] rounded-xl overflow-hidden flex-shrink-0 border border-white/5",children:ye.image?n.jsx("img",{src:ye.image,className:"w-full h-full object-cover",alt:ye.name}):n.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:n.jsx(xn,{className:"w-6 h-6 opacity-20"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex justify-between items-start mb-1",children:[n.jsx("h4",{className:"font-bold text-white text-sm truncate pl-2",children:ye.name}),n.jsx("button",{onClick:()=>r(ye.id),className:"text-gray-500 hover:text-red-500 p-1",children:n.jsx(jt,{className:"w-3.5 h-3.5"})})]}),ye.selectedSize&&n.jsx("span",{className:"text-[9px] text-green-400 bg-green-900/20 px-1.5 py-0.5 rounded mb-1 inline-block",children:ye.selectedSize.name}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("span",{className:"font-bold text-red-400 text-xs",children:[ye.price.toLocaleString("en-US")," ."]}),n.jsxs("div",{className:"flex items-center bg-[#1A1A1A] rounded-lg p-0.5 border border-white/5 h-7",children:[n.jsx("button",{onClick:()=>t(ye.id,1),className:"w-7 h-full flex items-center justify-center text-white hover:bg-white/10 rounded",children:n.jsx(Gs,{className:"w-2.5 h-2.5"})}),n.jsx("span",{className:"w-6 text-center font-bold text-xs text-white",children:ye.quantity}),n.jsx("button",{onClick:()=>t(ye.id,-1),className:"w-7 h-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 rounded",children:n.jsx(oS,{className:"w-2.5 h-2.5"})})]})]})]})]},ye.id+(((Fe=ye.selectedSize)==null?void 0:Fe.name)||""))})}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between px-1",children:[n.jsx("h3",{className:"font-bold text-white text-xs",children:" "}),!E&&l.length>0&&n.jsx("button",{onClick:()=>{I(!0),L("")},className:"text-[10px] text-red-400 font-bold hover:text-red-300 transition-colors",children:"+ "})]}),E?n.jsxs("div",{className:"flex gap-2 items-center animate-fadeIn",children:[n.jsx("input",{type:"text",value:T,onChange:ye=>L(ye.target.value),placeholder:"    ( ...)",className:"flex-1 bg-[#252525] border border-white/10 rounded-xl px-4 py-3 text-xs text-white outline-none focus:border-red-500 transition-all placeholder-gray-500",autoFocus:!0}),n.jsx("button",{onClick:oe,className:"bg-red-600 hover:bg-red-700 text-white p-3 rounded-xl transition-all shadow-lg active:scale-95 flex-shrink-0",children:n.jsx(Xe,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>I(!1),className:"bg-gray-700 hover:bg-gray-600 text-gray-300 p-3 rounded-xl transition-all active:scale-95 flex-shrink-0",children:n.jsx(rt,{className:"w-5 h-5"})})]}):l.length>0?n.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-1 scrollbar-hide",children:[l.map((ye,Pe)=>n.jsx("button",{onClick:()=>N(ye),className:`flex-shrink-0 min-w-[200px] p-3 rounded-xl border text-right transition-all text-xs ${v===ye?"bg-red-900/20 border-red-500 text-white":"bg-[#252525] text-gray-400 border-white/5"}`,children:n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(pn,{className:`w-3.5 h-3.5 ${v===ye?"text-red-500":"text-gray-500"}`}),n.jsx("span",{className:"font-bold line-clamp-1",children:ye})]})},Pe)),v&&v!=="all"&&!l.includes(v)&&n.jsx("button",{onClick:()=>N(v),className:"flex-shrink-0 min-w-[200px] p-3 rounded-xl border text-right transition-all text-xs bg-red-900/20 border-red-500 text-white",children:n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(pn,{className:"w-3.5 h-3.5 text-red-500"}),n.jsx("span",{className:"font-bold line-clamp-1",children:v})]})})]}):n.jsxs("button",{onClick:()=>I(!0),className:"w-full p-4 rounded-xl border border-dashed border-gray-600 text-gray-400 text-xs flex items-center justify-center gap-2 hover:border-red-500/50 hover:text-red-400 transition-colors",children:[n.jsx(Gs,{className:"w-4 h-4"}),"  "]}),n.jsx("textarea",{value:$,onChange:ye=>B(ye.target.value),placeholder:" ()...",className:"w-full bg-[#252525] border border-white/5 rounded-xl p-3 text-white text-xs outline-none focus:border-red-500/50 resize-none h-16"})]}),n.jsxs("div",{className:"space-y-2",children:[q&&f>0&&ne>=1&&n.jsxs("div",{className:`p-3 rounded-xl border flex items-center justify-between transition-all ${O?"bg-yellow-900/20 border-yellow-500/30":"bg-[#252525] border-white/5"}`,children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(B0,{className:"w-4 h-4 text-yellow-500"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-bold text-white",children:" "}),n.jsxs("p",{className:"text-[10px] text-gray-400",children:[" ",n.jsx("span",{className:"text-yellow-400",children:f})," = ",ne.toLocaleString("en-US",{minimumFractionDigits:2})," ."]})]})]}),n.jsx("input",{type:"checkbox",checked:O,onChange:()=>D(!O),className:"w-4 h-4 accent-yellow-500 rounded"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:Y,onChange:ye=>C(ye.target.value),placeholder:" ",className:"flex-1 bg-[#252525] border border-white/5 rounded-xl px-3 py-2 text-xs text-white outline-none focus:border-white/20",disabled:!!P}),P?n.jsxs("button",{onClick:J,className:"bg-green-600/20 text-green-400 px-3 py-2 rounded-xl text-xs font-bold border border-green-500/20",children:[" (",P.code,")"]}):n.jsx("button",{onClick:se,className:"bg-[#252525] text-white px-4 py-2 rounded-xl text-xs font-bold border border-white/10 hover:bg-white/5",children:""})]}),F&&n.jsx("p",{className:"text-red-400 text-[10px] px-1",children:F})]}),n.jsxs("div",{className:"bg-[#eee] text-black rounded-xl p-4 shadow-lg font-mono text-xs space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:""}),n.jsxs("span",{className:"font-bold",children:[W.toLocaleString("en-US")," ."]})]}),X>0&&n.jsxs("div",{className:"flex justify-between text-green-700",children:[n.jsx("span",{children:""}),n.jsxs("span",{className:"font-bold",children:["-",X.toLocaleString("en-US",{minimumFractionDigits:2})]})]}),n.jsxs("div",{className:"border-t border-black/10 pt-2 flex justify-between items-end",children:[n.jsx("span",{className:"font-bold",children:""}),n.jsxs("span",{className:"font-black text-lg",children:[H.toLocaleString("en-US",{minimumFractionDigits:2})," ",n.jsx("span",{className:"text-[10px]",children:"."})]})]})]})]})]}),s.length>0&&n.jsx("div",{className:"fixed bottom-[74px] left-0 right-0 p-4 bg-[#1A1A1A] border-t border-white/5 z-30",children:n.jsxs("button",{onClick:je,disabled:Q,className:"w-full bg-white text-black hover:bg-gray-200 py-3.5 rounded-xl font-black text-sm transition-all flex justify-between items-center px-5 active:scale-[0.98]",children:[n.jsx("span",{children:Q?" ...":" "}),!Q&&n.jsxs("span",{className:"text-xs bg-black text-white px-2 py-0.5 rounded",children:[H.toLocaleString("en-US",{minimumFractionDigits:2})," ."]})]})})]})},eS=s=>{switch(s){case ce.WaitingMerchant:return{color:"text-purple-400",bg:"bg-purple-500/10",border:"border-purple-500/20",icon:xt,label:" ",progress:10};case ce.Preparing:return{color:"text-orange-400",bg:"bg-orange-500/10",border:"border-orange-500/20",icon:Lr,label:" ",progress:35};case ce.Pending:return{color:"text-yellow-400",bg:"bg-yellow-500/10",border:"border-yellow-500/20",icon:xn,label:" ",progress:15};case ce.InTransit:return{color:"text-blue-400",bg:"bg-blue-500/10",border:"border-blue-500/20",icon:Ut,label:" ",progress:65};case ce.Delivered:return{color:"text-teal-400",bg:"bg-teal-500/10",border:"border-teal-500/20",icon:Xe,label:" ",progress:100};case ce.Cancelled:return{color:"text-red-400",bg:"bg-red-500/10",border:"border-red-500/20",icon:rt,label:"",progress:0};default:return{color:"text-gray-400",bg:"bg-gray-500/10",border:"border-gray-500/20",icon:xt,label:s,progress:0}}},O$=({orders:s,onDeleteOrder:e,appTheme:t})=>{const[r,i]=w.useState("current"),[l,d]=w.useState(null),[h,f]=w.useState(0),m=w.useRef(null);w.useEffect(()=>{const I=m.current;if(!I)return;const T=()=>{const L=I.scrollTop,$=Math.min(L/60,.95);f($)};return I.addEventListener("scroll",T),()=>I.removeEventListener("scroll",T)},[]);const b={cardBg:"bg-[#1e1e1e]",border:"border-white/5",textMain:"text-white",textSub:"text-gray-400"},{currentOrders:y,historyOrders:v}=w.useMemo(()=>{const I=[],T=[];s.forEach($=>{$.status===ce.Delivered||$.status===ce.Cancelled?T.push($):I.push($)});const L=($,B)=>new Date(B.createdAt).getTime()-new Date($.createdAt).getTime();return{currentOrders:I.sort(L),historyOrders:T.sort(L)}},[s]),N=I=>{var Z,Y;const T=eS(I.status),L=(I.totalPrice||0)+(I.deliveryFee||0),$=I.type==="shopping_order",B=I.deliveryFee&&I.deliveryFee>0,Q=$?"bg-gradient-to-br from-[#2a1b36] to-[#1a1a1a] border-purple-500/30":`${b.cardBg} ${b.border}`;return n.jsxs("div",{className:"rounded-2xl p-0.5 relative overflow-hidden group shadow-lg transition-all duration-300 active:scale-[0.99] mb-3",children:[I.status===ce.InTransit&&n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-blue-500/20 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000 z-10 pointer-events-none"}),n.jsxs("div",{className:`${Q} rounded-[20px] p-4 relative z-0 flex flex-col border`,children:[n.jsxs("div",{className:"flex justify-between items-start mb-3",children:[n.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[n.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center shadow-inner flex-shrink-0 ${$?"bg-purple-500/20 text-purple-300":`${T.bg} ${T.color}`}`,children:$?n.jsx(Ft,{className:"w-5 h-5 animate-pulse"}):n.jsx(T.icon,{className:"w-5 h-5"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("h3",{className:`font-bold text-base truncate ${$?"text-purple-100":b.textMain}`,children:$?" ":I.merchantName}),n.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[n.jsxs("span",{className:`text-[10px] font-mono tracking-wider px-1.5 py-0.5 rounded ${$?"bg-purple-500/10 text-purple-300":"bg-white/5 text-gray-500"}`,children:["#",I.id]}),n.jsx("span",{className:"text-[10px] text-gray-500 font-medium",children:new Date(I.createdAt).toLocaleTimeString("ar-EG-u-nu-latn",{hour:"2-digit",minute:"2-digit"})})]})]})]}),n.jsxs("div",{className:`px-2.5 py-1 rounded-lg text-[10px] font-bold border backdrop-blur-md flex items-center gap-1 flex-shrink-0 ${$?"bg-purple-500/10 border-purple-500/30 text-purple-300":`${T.bg} ${T.border} ${T.color}`}`,children:[I.status===ce.InTransit&&n.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-current animate-ping"}),T.label]})]}),$?n.jsx("div",{className:"bg-purple-900/10 border border-purple-500/10 rounded-lg p-2.5 mb-3",children:n.jsxs("p",{className:"text-xs text-gray-300 leading-relaxed line-clamp-2 italic",children:['"',I.notes,'"']})}):n.jsxs("div",{className:"flex items-center gap-2 mb-3 px-1",children:[n.jsx(xn,{className:"w-3.5 h-3.5 text-gray-500"}),n.jsxs("span",{className:"text-xs text-gray-300",children:[((Z=I.items)==null?void 0:Z.length)||0," "]})]}),n.jsxs("div",{className:"flex justify-between items-end border-t border-white/5 pt-2 mt-auto",children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-[9px] text-gray-500 font-bold mb-0.5",children:" "}),B?n.jsxs("div",{className:"flex items-baseline gap-1",children:[n.jsx("span",{className:`text-lg font-black ${$?"text-purple-400":"text-white"}`,children:L>0?L.toLocaleString("en-US"):(Y=I.totalPrice)==null?void 0:Y.toLocaleString("en-US")}),n.jsx("span",{className:"text-[10px] text-gray-500 font-bold",children:"."})]}):n.jsxs("span",{className:"text-xs text-yellow-500 font-bold flex items-center gap-1",children:[n.jsx(xt,{className:"w-3 h-3"}),"  "]})]}),I.driverId&&I.status===ce.InTransit&&n.jsxs("div",{className:"flex items-center gap-1 bg-blue-500/10 px-2 py-1 rounded border border-blue-500/20 text-blue-400",children:[n.jsx(Ut,{className:"w-3.5 h-3.5"}),n.jsx("span",{className:"text-[10px] font-bold",children:"  "})]})]})]})]},I.id)},E=I=>{const T=eS(I.status),L=(I.totalPrice||0)+(I.deliveryFee||0),$=I.type==="shopping_order";return n.jsxs("div",{className:`${b.cardBg} rounded-xl p-3 border ${b.border} shadow-sm flex items-center justify-between gap-3 mb-2`,children:[n.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[n.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 ${$?"bg-purple-500/10 text-purple-400":I.status===ce.Cancelled?"bg-red-500/10 text-red-500":"bg-teal-500/10 text-teal-500"}`,children:$?n.jsx(Ft,{className:"w-5 h-5"}):I.status===ce.Cancelled?n.jsx(rt,{className:"w-5 h-5"}):n.jsx(Xe,{className:"w-5 h-5"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("h4",{className:`font-bold text-sm truncate ${b.textMain}`,children:$?" ":I.merchantName}),n.jsxs("div",{className:"flex items-center gap-2 text-[10px]",children:[n.jsx("span",{className:b.textSub,children:new Date(I.createdAt).toLocaleDateString("ar-EG-u-nu-latn")}),n.jsx("span",{className:`px-1.5 rounded border ${T.border} ${T.color} bg-transparent font-bold`,children:T.label})]})]})]}),n.jsxs("div",{className:"flex flex-col items-end gap-1 flex-shrink-0",children:[n.jsx("span",{className:`font-mono text-sm font-black ${b.textMain}`,children:L>0?`${L.toLocaleString("en-US")} .`:"--"}),n.jsx("button",{onClick:()=>d(I.id),className:"text-gray-600 hover:text-red-400 transition-colors p-1.5",children:n.jsx(jt,{className:"w-4 h-4"})})]})]},I.id)};return n.jsxs("div",{className:"bg-[#1A1A1A] h-[100dvh] flex flex-col font-sans overflow-hidden",children:[n.jsxs("div",{className:"absolute top-0 left-0 right-0 z-40 pt-safe px-4 pb-3 transition-all duration-300 box-content",style:{backgroundColor:`rgba(26, 26, 26, ${h})`,backdropFilter:h>.5?"blur(12px)":"none",borderBottom:h>.5?"1px solid rgba(255,255,255,0.05)":"none",boxShadow:h>.5?"0 4px 30px rgba(0,0,0,0.1)":"none"},children:[n.jsx("div",{className:"flex justify-between items-center mb-3 mt-1",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`p-2 ${b.cardBg} rounded-full border ${b.border} shadow-sm`,children:n.jsx(Mr,{className:"w-5 h-5 text-gray-200"})}),n.jsxs("div",{children:[n.jsx("h1",{className:`text-lg font-black ${b.textMain} leading-none`,children:""}),n.jsx("p",{className:`text-[10px] ${b.textSub} font-medium mt-0.5`,children:"  "})]})]})}),n.jsxs("div",{className:`flex ${b.cardBg} p-1 rounded-lg shadow-inner border ${b.border}`,children:[n.jsxs("button",{onClick:()=>i("current"),className:`flex-1 py-2 text-xs font-bold rounded-md transition-all ${r==="current"?"bg-[#333] text-white shadow-sm border border-white/10":"text-gray-500 hover:text-gray-400"}`,children:[" (",y.length,")"]}),n.jsxs("button",{onClick:()=>i("history"),className:`flex-1 py-2 text-xs font-bold rounded-md transition-all ${r==="history"?"bg-[#333] text-white shadow-sm border border-white/10":"text-gray-500 hover:text-gray-400"}`,children:[" (",v.length,")"]})]})]}),n.jsx("div",{ref:m,className:"flex-1 overflow-y-auto p-4 space-y-2 pb-24 pt-36 scroll-smooth overscroll-none",onScroll:I=>{const T=Math.min(I.currentTarget.scrollTop/60,.95);f(T)},children:r==="current"?y.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-600 min-h-[40vh]",children:[n.jsx(F0,{className:"w-16 h-16 mb-4 opacity-10"}),n.jsx("p",{className:"text-sm font-bold text-gray-500",children:"   "})]}):n.jsx("div",{className:"animate-fadeIn pb-4",children:y.map(I=>N(I))}):v.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-600 min-h-[40vh]",children:[n.jsx(xt,{className:"w-16 h-16 mb-4 opacity-10"}),n.jsx("p",{className:"text-sm font-bold text-gray-500",children:" "})]}):n.jsx("div",{className:"animate-fadeIn pb-4",children:v.map(I=>E(I))})}),l&&n.jsx(fs,{title:" ",message:"        ",onClose:()=>d(null),onConfirm:()=>{l&&(e(l),d(null))},confirmButtonText:"",confirmVariant:"danger"})]})},P$=({messages:s,onMarkAsSeen:e,hideMessage:t,appTheme:r})=>{var v;const[i,l]=w.useState(null),[d,h]=w.useState(0),f=w.useRef(null);w.useEffect(()=>{const N=f.current;if(!N)return;const E=()=>{const I=N.scrollTop,T=Math.min(I/60,.95);h(T)};return N.addEventListener("scroll",E),()=>N.removeEventListener("scroll",E)},[]);const m=((v=r==null?void 0:r.customer)==null?void 0:v.mode)!=="light",b={bg:m?"bg-[#0f172a]":"bg-gray-50",text:m?"text-white":"text-gray-900",subText:m?"text-gray-400":"text-gray-500",card:m?"bg-[#1e293b]":"bg-white",border:m?"border-white/5":"border-gray-200",footerBg:m?"bg-[#181818]":"bg-gray-50",footerBorder:m?"border-[#2a2a2a]":"border-gray-200"};w.useEffect(()=>{s.forEach(N=>{e(N.id)})},[s,e]);const y=()=>{i&&(t(i),l(null))};return n.jsxs("div",{className:`h-[100dvh] ${b.bg} flex flex-col animate-fadeIn overflow-hidden relative`,children:[n.jsx("div",{className:`absolute top-0 left-0 right-0 z-40 pt-safe px-4 pb-4 flex items-center justify-between transition-all duration-300 pointer-events-none border-b box-content h-14 ${d>.5?b.border:"border-transparent"}`,style:{backgroundColor:m?`rgba(15, 23, 42, ${d})`:`rgba(255, 255, 255, ${d})`,backdropFilter:d>.5?"blur(12px)":"none",boxShadow:d>.5?"0 4px 30px rgba(0,0,0,0.1)":"none"},children:n.jsxs("div",{className:"flex items-center gap-3 mt-2 pointer-events-auto",children:[n.jsx("div",{className:"p-2.5 bg-gradient-to-br from-red-600 to-red-800 rounded-2xl shadow-lg shadow-red-900/30",children:n.jsx(Dr,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{children:[n.jsx("h1",{className:`text-xl font-black ${b.text} leading-none`,children:" "}),n.jsx("p",{className:`text-xs ${b.subText} font-medium mt-1`,children:"   "})]})]})}),n.jsx("div",{ref:f,className:`flex-1 overflow-y-auto p-4 space-y-5 pb-24 pt-24 ${b.bg} overscroll-none`,onScroll:N=>{const E=Math.min(N.currentTarget.scrollTop/60,.95);h(E)},children:s.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 h-[70vh]",children:[n.jsx("div",{className:`w-24 h-24 ${m?"bg-[#1E1E1E]":"bg-white"} rounded-full flex items-center justify-center mb-6 border ${m?"border-[#333]":"border-gray-200"} shadow-xl`,children:n.jsx(Tn,{className:"w-10 h-10 text-gray-400"})}),n.jsx("h3",{className:`text-xl font-bold ${b.text} mb-2`,children:"   "}),n.jsx("p",{className:`text-sm ${b.subText} max-w-xs leading-relaxed`,children:"          ."})]}):s.map(N=>{const E=new Date(N.createdAt).toLocaleDateString("ar-EG-u-nu-latn",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return n.jsxs("div",{className:"flex flex-col gap-2",children:[n.jsx("div",{className:"self-center",children:n.jsx("span",{className:`text-[10px] ${b.subText} ${m?"bg-[#1E1E1E] border-[#333]":"bg-gray-200 border-gray-300"} px-2 py-0.5 rounded-full border`,children:E})}),n.jsxs("div",{className:`${b.card} rounded-2xl rounded-tr-sm border ${b.border} shadow-lg overflow-hidden relative group`,children:[n.jsxs("div",{className:"p-5",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx("div",{className:"w-6 h-6 rounded-full bg-red-600 flex items-center justify-center shadow-md",children:n.jsx(Tn,{className:"w-3 h-3 text-white"})}),n.jsx("span",{className:`text-xs font-bold ${m?"text-gray-300":"text-gray-600"}`,children:"  "})]}),N.image&&n.jsx("div",{className:`mb-4 rounded-xl overflow-hidden border ${m?"border-[#444]":"border-gray-200"} shadow-inner`,children:n.jsx("img",{src:N.image,alt:"",className:"w-full h-auto"})}),n.jsx("p",{className:`${b.text} text-sm leading-relaxed whitespace-pre-wrap font-medium`,children:N.text})]}),n.jsxs("div",{className:`${b.footerBg} p-2 flex justify-between items-center border-t ${b.footerBorder}`,children:[n.jsx("span",{className:`text-[10px] ${b.subText} px-2`,children:" "}),n.jsx("button",{onClick:()=>l(N.id),className:`p-2 text-gray-500 hover:text-red-500 ${m?"hover:bg-red-500/10":"hover:bg-red-100"} rounded-full transition-all`,title:"",children:n.jsx(jt,{className:"w-4 h-4"})})]})]})]},N.id)})}),i&&n.jsx(fs,{title:" ",message:"      ",onClose:()=>l(null),onConfirm:y,confirmButtonText:"",confirmVariant:"danger"})]})},M$=({user:s,onBack:e,onPlaceOrder:t,appTheme:r})=>{const[i,l]=w.useState(""),d=w.useMemo(()=>((s==null?void 0:s.addresses)||[]).filter(D=>!D.includes("")&&!D.includes("")&&!D.includes("Pickup")),[s==null?void 0:s.addresses]),h=d.length>0?d[0]:"",[f,m]=w.useState(h),[b,y]=w.useState(!h),v=(s==null?void 0:s.phone)||"",[N,E]=w.useState(v),[I,T]=w.useState(!v),[L,$]=w.useState(!1),[B,Q]=w.useState(0),Z=w.useRef(null);w.useEffect(()=>{const D=Z.current;if(!D)return;const F=()=>{const S=D.scrollTop,ae=Math.min(S/100,.95);Q(ae)};return D.addEventListener("scroll",F),()=>D.removeEventListener("scroll",F)},[]);const Y=()=>{if(!i.trim())return;if(!f.trim()){alert("   ");return}if(!N.trim()){alert("   ");return}if(N.length<11){alert("   ");return}$(!0);const D=i;setTimeout(()=>{t(D,f,N)},1500)},C=D=>{m(D),y(!1)},P=()=>{m(""),y(!0)},U=D=>{E(D),T(!1)},O=()=>{E(""),T(!0)};return n.jsxs("div",{className:"bg-[#0f0f13] h-[100dvh] flex flex-col relative animate-page-enter font-sans overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 inset-x-0 h-[500px] bg-gradient-to-b from-[#2D1B36] via-[#15101a] to-[#0f0f13] pointer-events-none"}),n.jsx("div",{className:"absolute -top-40 -right-20 w-96 h-96 bg-purple-600/20 rounded-full blur-[100px] pointer-events-none animate-pulse-slow"}),n.jsx("div",{className:"absolute top-20 -left-20 w-72 h-72 bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"}),n.jsxs("div",{className:"absolute top-0 left-0 right-0 z-40 pt-safe px-4 pb-4 flex items-center justify-between transition-all duration-500 pointer-events-none box-content h-14",style:{backgroundColor:`rgba(15, 15, 19, ${B})`,backdropFilter:B>.5?"blur(16px)":"none",borderBottom:B>.5?"1px solid rgba(255,255,255,0.05)":"none",boxShadow:B>.5?"0 10px 40px rgba(0,0,0,0.2)":"none"},children:[n.jsx("button",{onClick:e,className:"bg-white/5 hover:bg-white/10 backdrop-blur-md p-3 rounded-full text-white transition-all border border-white/10 active:scale-95 pointer-events-auto group",children:n.jsx(kr,{className:"w-5 h-5 group-hover:-translate-x-0.5 transition-transform"})}),n.jsxs("div",{className:`flex items-center gap-2 bg-white/5 backdrop-blur-xl px-4 py-2 rounded-full border border-white/10 pointer-events-auto transition-all duration-500 ${B>.5?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}`,children:[n.jsx(Ft,{className:"w-4 h-4 text-purple-400"}),n.jsx("span",{className:"text-sm font-bold text-white tracking-wide",children:" "})]}),n.jsx("div",{className:"w-10"})]}),n.jsxs("div",{ref:Z,className:"flex-1 overflow-y-auto pt-28 px-5 space-y-8 pb-44 scroll-smooth relative z-10 overscroll-none",onScroll:D=>{const F=Math.min(D.currentTarget.scrollTop/100,.95);Q(F)},children:[n.jsxs("div",{className:"text-center space-y-4 mt-2 mb-8 relative",style:{opacity:Math.max(0,1-B*2),transform:`translateY(${B*-20}px)`,transition:"all 0.1s"},children:[n.jsxs("div",{className:"inline-flex items-center justify-center p-4 bg-gradient-to-tr from-purple-500/20 to-blue-500/20 rounded-3xl border border-white/10 shadow-2xl shadow-purple-900/20 mb-2 relative group",children:[n.jsx("div",{className:"absolute inset-0 bg-white/5 blur-xl rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-1000"}),n.jsx(Ft,{className:"w-10 h-10 text-purple-300 animate-pulse"})]}),n.jsxs("h1",{className:"text-4xl font-black text-white leading-tight tracking-tight",children:[" ",n.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-purple-400 via-pink-400 to-orange-400",children:" "}),"",n.jsx("br",{})," ",n.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-300",children:" "}),"."]}),n.jsx("p",{className:"text-sm text-gray-400 max-w-[280px] mx-auto leading-relaxed font-medium",children:"     .     ."})]}),n.jsxs("div",{className:"group relative",children:[n.jsx("div",{className:"absolute -inset-0.5 bg-gradient-to-r from-purple-600 to-blue-600 rounded-[2.2rem] opacity-30 blur group-hover:opacity-60 transition duration-1000"}),n.jsx("div",{className:"relative bg-[#18181b] border border-white/10 rounded-[2rem] p-1 shadow-2xl",children:n.jsxs("div",{className:"bg-[#131316] rounded-[1.8rem] p-6 space-y-5",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-purple-600 to-indigo-600 flex items-center justify-center text-white shadow-lg shadow-purple-900/30",children:n.jsx(Jn,{className:"w-5 h-5"})}),n.jsx("h3",{className:"font-bold text-white text-lg tracking-wide",children:" "})]}),n.jsxs("div",{className:"relative",children:[n.jsx("textarea",{value:i,onChange:D=>l(D.target.value),placeholder:`   ...
: '     '  '      '...`,className:"w-full h-44 bg-[#0a0a0c] border border-white/5 rounded-2xl p-5 text-white placeholder-gray-600 focus:border-purple-500/50 focus:ring-1 focus:ring-purple-500/20 outline-none transition-all resize-none text-base leading-relaxed shadow-inner",autoFocus:!0}),n.jsx("div",{className:"absolute bottom-4 left-4 pointer-events-none",children:n.jsx(bd,{className:`w-5 h-5 text-purple-500 transition-opacity duration-500 ${i?"opacity-100":"opacity-0"}`})})]})]})})]}),n.jsxs("div",{className:"space-y-4 pt-2",children:[n.jsxs("h3",{className:"text-sm font-bold text-gray-400 px-4 flex items-center gap-2 uppercase tracking-wider",children:[n.jsx(pn,{className:"w-4 h-4 text-purple-500"})," "]}),n.jsxs("div",{className:"grid gap-3",children:[d.map((D,F)=>n.jsxs("button",{onClick:()=>C(D),className:`w-full text-right p-4 rounded-2xl border transition-all duration-300 flex items-center justify-between group relative overflow-hidden ${f===D&&!b?"bg-gradient-to-r from-purple-900/30 to-[#18181b] border-purple-500/50 shadow-lg shadow-purple-900/10 scale-[1.02]":"bg-[#18181b] border-white/5 hover:border-white/10 hover:bg-[#1f1f22]"}`,children:[n.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[n.jsx("div",{className:`p-2.5 rounded-full transition-colors ${f===D&&!b?"bg-purple-600 text-white shadow-md":"bg-[#27272a] text-gray-500"}`,children:n.jsx(pr,{className:"w-4 h-4"})}),n.jsx("span",{className:`text-sm font-bold line-clamp-1 ${f===D&&!b?"text-white":"text-gray-400 group-hover:text-gray-300"}`,children:D})]}),f===D&&!b&&n.jsx("div",{className:"bg-purple-500 rounded-full p-1",children:n.jsx(Xe,{className:"w-4 h-4 text-white"})})]},F)),n.jsxs("button",{onClick:P,className:`w-full text-right p-4 rounded-2xl border border-dashed transition-all duration-300 flex items-center gap-4 group ${b?"border-blue-500 bg-blue-900/10":"border-gray-700 bg-transparent hover:bg-white/5 hover:border-gray-500"}`,children:[n.jsx("div",{className:`p-2.5 rounded-full transition-colors ${b?"bg-blue-600 text-white shadow-md":"bg-[#27272a] text-gray-500 group-hover:text-white"}`,children:n.jsx(Gs,{className:"w-4 h-4"})}),b?n.jsx("input",{type:"text",value:f,onChange:D=>m(D.target.value),placeholder:"  ...",className:"bg-transparent text-white text-sm font-bold outline-none w-full placeholder-blue-300/50",autoFocus:!0}):n.jsx("span",{className:"text-sm font-bold text-gray-400 group-hover:text-gray-300",children:"  ..."})]})]})]}),n.jsxs("div",{className:"space-y-4 pt-2",children:[n.jsxs("h3",{className:"text-sm font-bold text-gray-400 px-4 flex items-center gap-2 uppercase tracking-wider",children:[n.jsx($s,{className:"w-4 h-4 text-green-500"})," "]}),n.jsxs("div",{className:"grid gap-3",children:[(s==null?void 0:s.phone)&&n.jsxs("button",{onClick:()=>U(s.phone||""),className:`w-full text-right p-4 rounded-2xl border transition-all duration-300 flex items-center justify-between group relative overflow-hidden ${N===s.phone&&!I?"bg-gradient-to-r from-green-900/30 to-[#18181b] border-green-500/50 shadow-lg shadow-green-900/10 scale-[1.02]":"bg-[#18181b] border-white/5 hover:border-white/10 hover:bg-[#1f1f22]"}`,children:[n.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[n.jsx("div",{className:`p-2.5 rounded-full transition-colors ${N===s.phone&&!I?"bg-green-600 text-white shadow-md":"bg-[#27272a] text-gray-500"}`,children:n.jsx($s,{className:"w-4 h-4"})}),n.jsxs("span",{className:`text-sm font-bold font-mono tracking-wide ${N===s.phone&&!I?"text-white":"text-gray-400 group-hover:text-gray-300"}`,children:[s.phone," ()"]})]}),N===s.phone&&!I&&n.jsx("div",{className:"bg-green-500 rounded-full p-1",children:n.jsx(Xe,{className:"w-4 h-4 text-white"})})]}),n.jsxs("button",{onClick:O,className:`w-full text-right p-4 rounded-2xl border border-dashed transition-all duration-300 flex items-center gap-4 group ${I?"border-green-500 bg-green-900/10":"border-gray-700 bg-transparent hover:bg-white/5 hover:border-gray-500"}`,children:[n.jsx("div",{className:`p-2.5 rounded-full transition-colors ${I?"bg-green-600 text-white shadow-md":"bg-[#27272a] text-gray-500 group-hover:text-white"}`,children:n.jsx(Gs,{className:"w-4 h-4"})}),I?n.jsx("input",{type:"tel",value:N,onChange:D=>E(D.target.value),placeholder:"  ...",className:"bg-transparent text-white text-sm font-bold outline-none w-full placeholder-green-300/50 font-mono",autoFocus:!0,dir:"ltr"}):n.jsx("span",{className:"text-sm font-bold text-gray-400 group-hover:text-gray-300",children:"  ..."})]})]})]})]}),n.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-6 pb-8 bg-gradient-to-t from-[#0f0f13] via-[#0f0f13] to-transparent z-30",children:n.jsxs("button",{onClick:Y,disabled:L||!i,className:"group relative w-full bg-white text-black hover:bg-gray-100 py-4 rounded-[2rem] font-black text-lg transition-all disabled:bg-gray-800 disabled:text-gray-600 disabled:cursor-not-allowed shadow-2xl shadow-white/10 active:scale-[0.98] overflow-hidden",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-gray-200/50 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000"}),n.jsxs("div",{className:"relative z-10 flex justify-between items-center px-6",children:[n.jsx("span",{className:"flex items-center gap-3",children:L?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-5 h-5 border-2 border-black/30 border-t-black rounded-full animate-spin"})," ..."]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"bg-black text-white p-1.5 rounded-full",children:n.jsx(Ft,{className:"w-4 h-4"})})," "]})}),!L&&n.jsx("span",{className:"text-xs font-bold bg-black/5 px-3 py-1 rounded-lg border border-black/10",children:"  "})]})]})})]})},L$=({merchants:s,favoriteIds:e,toggleFavorite:t,addToCart:r,onBack:i,appTheme:l})=>{const[d,h]=w.useState(0),f=w.useRef(null);w.useEffect(()=>{const y=f.current;if(!y)return;const v=()=>{const N=y.scrollTop,E=Math.min(N/60,.95);h(E)};return y.addEventListener("scroll",v),()=>y.removeEventListener("scroll",v)},[]);const m=w.useMemo(()=>{const y=[];return s.forEach(v=>{v.products&&v.products.forEach(N=>{e.includes(N.id)&&y.push({product:N,merchant:v})})}),y},[s,e]),b=y=>{r(y.product,y.merchant)};return n.jsxs("div",{className:"bg-[#1A1A1A] h-[100dvh] flex flex-col relative animate-page-enter font-sans overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 left-0 right-0 z-40 pt-safe px-4 pb-4 flex items-center justify-between transition-all duration-300 pointer-events-none box-content h-14",style:{backgroundColor:`rgba(26, 26, 26, ${d})`,backdropFilter:d>.5?"blur(12px)":"none",borderBottom:d>.5?"1px solid rgba(255,255,255,0.05)":"none",boxShadow:d>.5?"0 4px 30px rgba(0,0,0,0.1)":"none"},children:n.jsxs("div",{className:"flex items-center gap-3 pointer-events-auto",children:[n.jsx("button",{onClick:i,className:"bg-[#252525] hover:opacity-80 p-2.5 rounded-full text-white transition-colors border border-white/5 active:scale-95 shadow-sm",children:n.jsx(kr,{className:"w-5 h-5"})}),n.jsxs("div",{style:{opacity:d>.2?1:0,transition:"opacity 0.3s"},children:[n.jsxs("h1",{className:"text-xl font-black text-white leading-none flex items-center gap-2",children:["",n.jsx(Ih,{className:"w-5 h-5 text-red-500 fill-current animate-pulse"})]}),n.jsxs("p",{className:"text-xs text-gray-400 font-medium mt-1",children:["  (",m.length,")"]})]})]})}),n.jsxs("div",{ref:f,className:"flex-1 overflow-y-auto pt-24 px-4 pb-24 scroll-smooth overscroll-none",onScroll:y=>{const v=Math.min(y.currentTarget.scrollTop/60,.95);h(v)},children:[!d&&n.jsxs("div",{className:"mb-4 transition-opacity duration-300",children:[n.jsxs("h1",{className:"text-2xl font-black text-white leading-none flex items-center gap-2",children:["",n.jsx(Ih,{className:"w-6 h-6 text-red-500 fill-current"})]}),n.jsxs("p",{className:"text-sm text-gray-400 font-medium mt-2",children:["  (",m.length,")"]})]}),m.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center h-[60vh] text-center animate-fadeIn",children:[n.jsxs("div",{className:"relative mb-6",children:[n.jsx("div",{className:"absolute inset-0 bg-red-500/10 rounded-full blur-xl"}),n.jsx("div",{className:"w-24 h-24 bg-[#252525] rounded-full flex items-center justify-center relative z-10 shadow-inner border border-white/5",children:n.jsx(Ih,{className:"w-10 h-10 text-gray-500"})})]}),n.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),n.jsxs("p",{className:"text-sm text-gray-400 max-w-[200px] leading-relaxed",children:["    ",n.jsx(Ih,{className:"w-3 h-3 inline text-red-500"}),"      ."]})]}):n.jsx("div",{className:"grid grid-cols-2 gap-4",children:m.map(({product:y,merchant:v},N)=>n.jsxs("div",{className:"group bg-[#252525] rounded-[1.5rem] overflow-hidden border border-white/5 shadow-md hover:shadow-xl hover:border-gray-600 transition-all duration-300 flex flex-col animate-fade-slide-up",style:{animationDelay:`${N*50}ms`},children:[n.jsxs("div",{className:"relative aspect-square w-full bg-[#1A1A1A] overflow-hidden",children:[y.image?n.jsx("img",{src:y.image,alt:y.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:n.jsx(bn,{className:"w-8 h-8 opacity-20"})}),n.jsx("button",{onClick:()=>t(y.id),className:"absolute top-2 right-2 p-1.5 rounded-full bg-black/40 backdrop-blur-md text-white hover:bg-red-500 hover:text-white transition-all z-20 shadow-sm",children:n.jsx(rt,{className:"w-3 h-3"})}),n.jsxs("div",{className:"absolute bottom-2 left-2 bg-black/60 backdrop-blur-md px-2 py-1 rounded-lg flex items-center gap-1 max-w-[80%]",children:[n.jsx(Xn,{className:"w-3 h-3 text-gray-300"}),n.jsx("span",{className:"text-[9px] text-white font-bold truncate",children:v.name})]})]}),n.jsxs("div",{className:"p-3 flex-1 flex flex-col",children:[n.jsx("h3",{className:"font-bold text-white text-sm mb-1 line-clamp-1 leading-snug",children:y.name}),n.jsx("p",{className:"text-[10px] text-gray-400 line-clamp-2 leading-relaxed mb-3 flex-1 opacity-80",children:y.description}),n.jsxs("div",{className:"flex justify-between items-center mt-auto pt-2 border-t border-white/5",children:[n.jsxs("div",{className:"flex items-baseline gap-0.5",children:[n.jsx("span",{className:"text-white font-black text-sm",children:y.price}),n.jsx("span",{className:"text-red-500 text-[9px] font-bold",children:"."})]}),n.jsx("button",{onClick:()=>b({product:y,merchant:v}),className:"w-8 h-8 bg-white text-black rounded-full flex items-center justify-center hover:bg-gray-200 active:scale-90 transition-all shadow-lg",children:n.jsx(Gs,{className:"w-4 h-4"})})]})]})]},y.id))})]})]})},V$=({onBack:s,title:e,description:t})=>{const[r,i]=w.useState(!1);return w.useEffect(()=>{i(!0)},[]),n.jsxs("div",{className:"fixed inset-0 bg-[#1A1A1A] z-50 flex flex-col items-center justify-center p-6 text-white overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 right-0 w-[300px] h-[300px] bg-red-600/10 rounded-full blur-[100px] pointer-events-none"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-[300px] h-[300px] bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"}),n.jsx("button",{onClick:s,className:"absolute top-safe-offset right-5 p-3 bg-white/5 rounded-full text-white hover:bg-white/10 transition-colors z-20 backdrop-blur-md border border-white/10",style:{top:"calc(var(--safe-area-top) + 20px)"},children:n.jsx(kr,{className:"w-6 h-6"})}),n.jsxs("div",{className:`flex flex-col items-center text-center max-w-sm transition-all duration-700 transform ${r?"translate-y-0 opacity-100":"translate-y-10 opacity-0"}`,children:[n.jsxs("div",{className:"relative mb-10",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-red-500 to-orange-500 rounded-full blur-2xl opacity-40 animate-pulse"}),n.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-[#2a2a2a] to-[#1a1a1a] rounded-full flex items-center justify-center border-4 border-[#333] shadow-2xl relative z-10",children:n.jsx(Ft,{className:"w-16 h-16 text-red-500 animate-bounce"})}),n.jsx("div",{className:"absolute -top-2 -right-4 bg-[#252525] p-2 rounded-xl border border-white/5 shadow-lg animate-bounce delay-100",children:n.jsx(xt,{className:"w-6 h-6 text-blue-400"})})]}),n.jsx("h1",{className:"text-4xl font-black mb-4 bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-400",children:e}),n.jsxs("p",{className:"text-gray-400 text-lg leading-relaxed mb-8",children:[t,n.jsx("br",{}),n.jsx("span",{className:"text-red-400 text-sm font-bold mt-2 block",children:"   !"})]}),n.jsx("div",{className:"w-full h-1.5 bg-gray-800 rounded-full overflow-hidden mb-2",children:n.jsx("div",{className:"h-full bg-gradient-to-r from-red-600 to-orange-500 w-[75%] rounded-full animate-pulse"})}),n.jsx("p",{className:"text-xs text-gray-500 font-mono tracking-widest uppercase",children:"Work in progress"})]})]})},tS=["https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Grinning%20Face%20with%20Big%20Eyes.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Face%20with%20Tears%20of%20Joy.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Smiling%20Face%20with%20Heart-Eyes.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Smiling%20Face%20with%20Hearts.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Star-Struck.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Red%20Heart.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Hand%20gestures/Thumbs%20Up.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Thinking%20Face.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Winking%20Face.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Hand%20gestures/Waving%20Hand.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Face%20Screaming%20in%20Fear.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Pleading%20Face.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Angry%20Face.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Face%20Blowing%20a%20Kiss.png"],U$=({onClose:s,onOpenChat:e,onOpenWhatsapp:t,config:r})=>n.jsx("div",{className:"fixed inset-0 z-[80] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:s,children:n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-[2rem] border border-gray-700 shadow-2xl p-6 animate-pop-in",onClick:i=>i.stopPropagation(),children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsx("div",{className:"w-16 h-16 bg-blue-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-blue-500/20",children:n.jsx(Vr,{className:"w-8 h-8 text-blue-400"})}),n.jsx("h3",{className:"text-xl font-bold text-white",children:" "}),n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"   "})]}),n.jsxs("div",{className:"space-y-3",children:[(r==null?void 0:r.isChatEnabled)!==!1&&n.jsxs("button",{onClick:()=>{s(),e()},className:"w-full flex items-center gap-4 p-4 rounded-2xl bg-gray-800 hover:bg-gray-700 transition-colors border border-gray-700",children:[n.jsx("div",{className:"p-2 bg-blue-500/20 rounded-full text-blue-400",children:n.jsx(_v,{className:"w-6 h-6"})}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-bold text-white",children:" "}),n.jsx("p",{className:"text-xs text-gray-400",children:"    "})]})]}),(r==null?void 0:r.isWhatsappEnabled)!==!1&&n.jsxs("button",{onClick:()=>{s(),t()},className:"w-full flex items-center gap-4 p-4 rounded-2xl bg-green-900/20 hover:bg-green-900/30 transition-colors border border-green-500/20",children:[n.jsx("div",{className:"p-2 bg-green-500/20 rounded-full text-green-400",children:n.jsx(Vl,{className:"w-6 h-6"})}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-bold text-white",children:""}),n.jsx("p",{className:"text-xs text-gray-400",children:"   "})]})]}),(r==null?void 0:r.isChatEnabled)===!1&&(r==null?void 0:r.isWhatsappEnabled)===!1&&n.jsx("div",{className:"text-center text-gray-500 py-4 bg-gray-900/50 rounded-xl border border-dashed border-gray-700",children:n.jsx("p",{className:"text-sm",children:"     ."})})]}),n.jsx("button",{onClick:s,className:"mt-6 w-full py-3 text-gray-400 font-bold hover:text-white transition-colors",children:""})]})}),F$=({user:s,onClose:e,config:t})=>{const[r,i]=w.useState([]),[l,d]=w.useState(""),[h,f]=w.useState(null),m=w.useRef(null),b=w.useRef(null),y=w.useRef(null),[v,N]=w.useState(null),[E,I]=w.useState(null),[T,L]=w.useState(null),[$,B]=w.useState(!1),Q=w.useRef(null);Wt(()=>T?(L(null),!0):v?(N(null),!0):E?(I(null),!0):$?(B(!1),!0):(e(),!0),[T,v,E,$]),w.useEffect(()=>{const K=Hs("support_chats",q=>{const W=q.find(ne=>ne.id===s.id);W?W.messages&&i(W.messages):r.length>0&&(i([]),alert("     ."),e())});at("support_chats",s.id,{lastUpdated:new Date});const k=setInterval(()=>{at("support_chats",s.id,{lastUpdated:new Date})},6e4);return()=>{K(),clearInterval(k)}},[s.id]),w.useEffect(()=>{if(r.filter(k=>k.sender==="admin"&&!k.isRead).length>0){const k=r.map(q=>q.sender==="admin"?{...q,isRead:!0}:q);at("support_chats",s.id,{messages:k})}m.current&&(m.current.scrollTop=m.current.scrollHeight)},[r.length]);const Z=async()=>{if(!l.trim()&&!h)return;let K=l;E&&(K=`[ : ${E.text.substring(0,50)+(E.text.length>50?"...":"")}]
${l}`);const k=r.reduce((M,R)=>{const V=parseInt(R.id);return isNaN(V)?M:Math.max(M,V)},0),W={id:String(k+1),text:K,image:h||void 0,sender:"user",createdAt:new Date,isRead:!1},ne=[...r,W];i(ne),d(""),f(null),I(null),B(!1),await at("support_chats",s.id,{id:s.id,userId:s.id,userName:s.name,userPhone:s.phone,lastMessage:h?" ":W.text,lastUpdated:new Date,unreadCount:1,messages:ne}),qt("admin",{title:"  ",body:`${s.name}: ${h?" ":K}`,url:"/?target=support"})},Y=K=>{var q;const k=(q=K.target.files)==null?void 0:q[0];if(k){const W=new FileReader;W.onloadend=()=>{const ne=new Image;ne.src=W.result,ne.onload=()=>{const M=document.createElement("canvas"),R=600/ne.width;M.width=600,M.height=ne.height*R;const V=M.getContext("2d");V==null||V.drawImage(ne,0,0,M.width,M.height),f(M.toDataURL("image/jpeg",.7))}},W.readAsDataURL(k)}b.current&&(b.current.value="")},C=K=>{N(K)},P=K=>{Q.current=setTimeout(()=>C(K),500)},U=()=>{Q.current&&clearTimeout(Q.current)},O=async K=>{if(!v)return;const k=v.reactions||[],q=k.includes(K)?k.filter(ne=>ne!==K):[...k,K],W=r.map(ne=>ne.id===v.id?{...ne,reactions:q}:ne);i(W),N(null),await at("support_chats",s.id,{messages:W})},D=K=>{var q,W;const k=document.querySelectorAll(".message-text");for(let ne=0;ne<k.length;ne++)if((q=k[ne].textContent)!=null&&q.includes(K)){k[ne].scrollIntoView({behavior:"smooth",block:"center"}),(W=k[ne].parentElement)==null||W.classList.add("ring-2","ring-teal-400"),setTimeout(()=>{var M;return(M=k[ne].parentElement)==null?void 0:M.classList.remove("ring-2","ring-teal-400")},1500);break}},F=K=>{const k=K.match(/^\[ : (.*?)\]\n(.*)/s);if(k){const q=k[1],W=k[2];return n.jsxs(n.Fragment,{children:[" ",n.jsxs("div",{onClick:ne=>{ne.stopPropagation(),D(q)},className:"mb-1 pb-1 border-b border-white/10 cursor-pointer active:opacity-70",children:[" ",n.jsxs("p",{className:"text-[10px] text-white/50 line-clamp-1 italic flex items-center gap-1",children:[" ",n.jsx(yd,{className:"w-3 h-3"})," ",q," "]})," "]})," ",n.jsx("span",{className:"message-text",children:W})," "]})}return n.jsx("span",{className:"message-text",children:K})},S=K=>{K.currentTarget.style.display="none"},ae=K=>K.startsWith("http");return n.jsxs("div",{className:"fixed inset-0 z-[90] bg-[#0b141a] flex flex-col animate-slide-up select-none touch-callout-none font-sans",onContextMenu:K=>K.preventDefault(),children:[n.jsx("div",{className:"absolute inset-0 z-0 opacity-[0.06] pointer-events-none",style:{backgroundImage:"url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png')"}}),n.jsx("style",{children:".touch-callout-none { -webkit-touch-callout: none; } .select-none { -webkit-user-select: none; user-select: none; }"}),n.jsx("div",{className:"flex-none bg-[#202c33] border-b border-[#2f3b43] z-20 pt-safe shadow-sm",children:n.jsxs("div",{className:"flex items-center gap-2 px-2 py-2 h-14",children:[n.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-white/10 text-[#aebac1] transition-colors flex items-center justify-center",children:n.jsx(kr,{className:"w-6 h-6 rotate-180"})}),n.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[n.jsx("div",{className:"relative flex-shrink-0",children:n.jsx("div",{className:"w-10 h-10 bg-teal-600 rounded-full flex items-center justify-center text-white",children:n.jsx(Vr,{className:"w-6 h-6"})})}),n.jsxs("div",{className:"flex flex-col justify-center flex-1",children:[n.jsx("h3",{className:"font-bold text-[#e9edef] text-base leading-tight truncate",children:" "}),n.jsx("p",{className:"text-xs text-[#8696a0] truncate",children:"  "})]})]})]})}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-1 relative z-10 custom-scrollbar",ref:m,children:[r.length===0&&n.jsxs("div",{className:"text-center text-[#8696a0] py-4 bg-[#202c33]/80 rounded-lg mx-4 mt-4 shadow-sm text-xs border border-[#2f3b43]",children:[n.jsx("p",{className:"text-[#ffd279] mb-1 font-bold",children:"  "}),n.jsx("p",{children:" !    "})]}),r.map(K=>{const k=K.sender==="user",q=K.image&&ae(K.image);return n.jsxs("div",{className:`flex w-full relative z-10 ${k?"justify-end":"justify-start"} mb-1`,children:[" ",n.jsxs("div",{onTouchStart:()=>P(K),onTouchEnd:U,onMouseDown:()=>P(K),onMouseUp:U,className:`relative max-w-[80%] rounded-lg p-2 px-3 shadow-sm text-sm ${q?"bg-transparent shadow-none":k?"bg-[#005c4b] text-[#e9edef] rounded-tr-none":"bg-[#202c33] text-[#e9edef] rounded-tl-none"}`,children:[" ",K.image&&n.jsxs("div",{className:"mb-1.5 rounded-lg overflow-hidden relative group",children:[" ",n.jsx("img",{src:K.image,alt:"attached",className:q?"w-28 h-28 object-contain cursor-pointer drop-shadow-lg":"w-full h-auto object-cover max-h-64 pointer-events-auto cursor-pointer",onClick:W=>{W.stopPropagation(),L(K.image)}})," "]})," ",K.text&&n.jsx("div",{className:"leading-relaxed whitespace-pre-wrap dir-rtl pt-0.5",children:F(K.text)})," ",n.jsxs("div",{className:`flex items-end justify-between gap-4 mt-1 -mb-1 ml-[-4px] ${q?"text-gray-300":"text-[#8696a0]"}`,children:[" ",n.jsxs("button",{onClick:W=>{W.stopPropagation(),I(K)},className:"opacity-50 hover:opacity-100 transition-opacity p-0.5",children:[" ",n.jsx(yd,{className:"w-3.5 h-3.5"})," "]})," ",n.jsxs("div",{className:"flex items-center gap-1",children:[" ",n.jsx("span",{className:"text-[10px] min-w-fit",children:new Date(K.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})," ",k&&n.jsx("div",{className:"flex -space-x-1 space-x-reverse",children:n.jsx(Xe,{className:`w-3.5 h-3.5 ${K.isRead?"text-[#53bdeb]":"text-[#8696a0]"}`})})," "]})," "]})," ",K.reactions&&K.reactions.length>0&&n.jsxs("div",{className:`absolute -bottom-2.5 ${k?"left-0":"right-0"} flex items-center -space-x-1 space-x-reverse`,children:[" ",K.reactions.map((W,ne)=>n.jsx("div",{className:"w-5 h-5 rounded-full bg-[#202c33] border border-[#0b141a] shadow-sm flex items-center justify-center p-0.5 scale-110",children:n.jsx("img",{src:W,className:"w-full h-full object-contain"})},ne))," "]})," "]})," "]},K.id)})]}),T&&n.jsxs("div",{className:"fixed inset-0 z-[200] bg-black/95 backdrop-blur-md flex items-center justify-center p-4 animate-fadeIn",onClick:()=>L(null),children:[n.jsx("img",{src:T,className:"max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl animate-pop-in",onClick:K=>K.stopPropagation()}),n.jsx("button",{onClick:()=>L(null),className:"absolute top-4 right-4 bg-white/10 text-white p-3 rounded-full hover:bg-white/20 transition-colors",children:n.jsx(rt,{className:"w-6 h-6"})})]}),v&&n.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fadeIn",onClick:()=>N(null),children:[" ",n.jsxs("div",{className:"bg-[#202c33] w-full max-w-sm rounded-2xl border border-[#2f3b43] shadow-2xl p-6 animate-sheet-up",onClick:K=>K.stopPropagation(),children:[" ",n.jsxs("div",{className:"mb-4",children:[" ",n.jsx("p",{className:"text-xs font-bold text-[#8696a0] mb-3 text-center",children:"  "})," ",n.jsxs("div",{className:"flex justify-between gap-2 bg-[#111b21] p-3 rounded-xl border border-[#2f3b43]",children:[" ",tS.slice(0,5).map((K,k)=>n.jsx("button",{onClick:()=>O(K),className:"hover:scale-125 transition-transform p-1",children:n.jsx("img",{src:K,className:"w-8 h-8 object-contain drop-shadow-md"})},k))," "]})," "]})," ",n.jsxs("button",{onClick:()=>{I(v),N(null)},className:"w-full flex items-center gap-3 p-4 bg-[#111b21] hover:bg-[#2a3942] rounded-xl transition-colors border border-[#2f3b43]",children:[" ",n.jsx(yd,{className:"w-5 h-5 text-blue-400"})," ",n.jsx("span",{className:"font-bold text-sm text-[#e9edef]",children:"  "})," "]})," "]})," "]}),n.jsxs("div",{className:"bg-[#202c33] py-2 px-2 z-20 pb-safe relative border-t border-[#2f3b43]",children:[E&&n.jsxs("div",{className:"flex justify-between items-center bg-[#1e2a30] p-2 border-r-4 border-teal-500 mb-2 rounded-lg mx-1",children:[" ",n.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden pr-2",children:[" ",n.jsx("span",{className:"text-teal-500 text-xs font-bold mb-0.5",children:"  "})," ",n.jsx("p",{className:"text-[#aebac1] text-xs truncate",children:E.image?ae(E.image)?"":" ":E.text})," "]})," ",n.jsx("button",{onClick:()=>I(null),className:"p-1 text-[#8696a0] hover:text-white",children:n.jsx(rt,{className:"w-4 h-4"})})," "]}),n.jsxs("div",{className:"flex items-end gap-2 px-1",children:[n.jsxs("div",{className:"flex-1 bg-[#2a3942] rounded-3xl flex items-center px-3 py-1.5 min-h-[45px] border border-transparent focus-within:border-[#00a884] transition-colors",children:[n.jsx("button",{onClick:()=>B(!$),className:"text-[#8696a0] hover:text-[#e9edef] transition-colors p-1",children:n.jsx("span",{className:"text-xl grayscale opacity-70 hover:opacity-100 transition-all",children:""})}),n.jsx("textarea",{ref:y,value:l,onChange:K=>d(K.target.value),placeholder:"",rows:1,className:"flex-1 bg-transparent text-[#e9edef] text-base outline-none resize-none max-h-24 py-1.5 px-2 placeholder-[#8696a0] leading-relaxed",style:{minHeight:"24px"}}),(t==null?void 0:t.allowImageSending)!==!1&&n.jsx("button",{onClick:()=>{var K;return(K=b.current)==null?void 0:K.click()},className:"text-[#8696a0] hover:text-[#e9edef] p-1.5 -rotate-45 transform",children:n.jsx(Ao,{className:"w-6 h-6"})}),n.jsx("input",{ref:b,type:"file",accept:"image/*",className:"hidden",onChange:Y})]}),(l.trim()||h)&&n.jsxs("button",{onClick:()=>{(l.trim()||h)&&Z()},className:"w-12 h-12 rounded-full flex items-center justify-center shadow-lg active:scale-90 transition-all z-20 bg-[#00a884] hover:bg-[#008f6f] text-white",children:[" ",n.jsx(cS,{className:"w-5 h-5 ml-0.5"})," "]})]}),h&&n.jsx("div",{className:"absolute bottom-20 right-4 bg-[#202c33] p-2 rounded-xl border border-[#2f3b43] shadow-xl animate-pop-in",children:n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:h,className:"h-20 w-20 rounded-lg object-cover"}),n.jsx("button",{onClick:()=>f(null),className:"absolute -top-2 -right-2 bg-[#2a3942] text-[#e9edef] p-1 rounded-full border border-[#8696a0]",children:n.jsx(rt,{className:"w-3 h-3"})})]})}),$&&n.jsxs("div",{className:"mt-2 bg-[#202c33] border border-[#2f3b43] rounded-t-2xl p-3 shadow-2xl grid grid-cols-6 gap-2 h-60 overflow-y-auto custom-scrollbar",children:[" ",tS.map((K,k)=>n.jsx("button",{onClick:()=>{const q=r.reduce((R,V)=>{const X=parseInt(V.id);return isNaN(X)?R:Math.max(R,X)},0),ne={id:String(q+1),text:"",image:K,sender:"user",createdAt:new Date,isRead:!1},M=[...r,ne];i(M),B(!1),at("support_chats",s.id,{messages:M,lastMessage:"  ",lastUpdated:new Date,unreadCount:1}),qt("admin",{title:"  ",body:`${s.name}  `,url:"/?target=support"})},className:"hover:bg-white/5 p-1.5 rounded-xl transition-colors",children:n.jsx("img",{src:K,className:"w-8 h-8 object-contain",onError:S})},k))," "]})]})]})},dd=({icon:s,label:e,subLabel:t,onClick:r,danger:i,hasArrow:l=!0})=>n.jsxs("button",{onClick:r,className:`w-full flex items-center justify-between p-3 transition-all active:bg-black/5 group ${i?"text-red-500":"text-white"}`,children:[" ",n.jsxs("div",{className:"flex items-center gap-4",children:[" ",n.jsxs("div",{className:`p-2 rounded-xl ${i?"bg-red-500/10":"bg-gray-800 text-gray-400 group-hover:text-white transition-colors"}`,children:[" ",s," "]})," ",n.jsxs("div",{className:"text-right",children:[" ",n.jsx("p",{className:`font-bold text-sm ${i?"text-red-500":"text-gray-200"}`,children:e})," ",t&&n.jsx("p",{className:"text-[10px] text-gray-500 mt-0.5",children:t})," "]})," "]})," ",!i&&l&&n.jsx(zs,{className:"w-4 h-4 text-gray-600 group-hover:text-gray-400 group-hover:-translate-x-1 transition-all"})," "]}),B$=({title:s,content:e,onClose:t})=>n.jsxs("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:t,children:[" ",n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-3xl border border-gray-700 shadow-2xl overflow-hidden animate-pop-in flex flex-col max-h-[80vh]",onClick:r=>r.stopPropagation(),children:[" ",n.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[" ",n.jsx("h3",{className:"text-lg font-bold text-white",children:s})," ",n.jsx("button",{onClick:t,className:"p-2 rounded-full bg-gray-800 text-gray-400 hover:text-white transition-colors",children:n.jsx(rt,{className:"w-5 h-5"})})," "]})," ",n.jsxs("div",{className:"p-6 overflow-y-auto text-gray-300 text-sm leading-relaxed whitespace-pre-wrap",children:[" ",e," "]})," "]})," "]}),z$=({user:s,onClose:e,onUpdate:t})=>{const r=s.addresses&&s.addresses.length>0?s.addresses[0]:s.address||"",[i,l]=w.useState(r),[d,h]=w.useState(!1),[f,m]=w.useState(""),b=()=>{f.trim()&&(l(f),t([f]),h(!1))};return n.jsxs("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:[" ",n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-[2rem] border border-gray-700 shadow-2xl overflow-hidden animate-pop-in flex flex-col",onClick:y=>y.stopPropagation(),children:[" ",n.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[" ",n.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[n.jsx(pn,{className:"w-5 h-5 text-red-500"})," "]})," ",n.jsx("button",{onClick:e,className:"p-2 rounded-full bg-gray-800 text-gray-400 hover:text-white transition-colors",children:n.jsx(rt,{className:"w-5 h-5"})})," "]})," ",n.jsxs("div",{className:"p-6",children:[" ",n.jsx("p",{className:"text-xs text-gray-400 mb-3 font-medium",children:"  (  )"})," ",n.jsxs("div",{className:"bg-[#0f172a] rounded-xl p-4 border border-gray-700 group transition-all hover:border-gray-600 shadow-inner",children:[" ",d?n.jsxs("div",{className:"space-y-3 animate-fade-slide-up",children:[" ",n.jsx("textarea",{value:f,onChange:y=>m(y.target.value),className:"w-full bg-[#1e293b] border border-gray-600 rounded-lg p-3 text-white text-sm focus:border-red-500 outline-none resize-none h-28 leading-relaxed",placeholder:" ...",autoFocus:!0})," ",n.jsxs("div",{className:"flex gap-2",children:[" ",n.jsx("button",{onClick:b,className:"flex-1 bg-green-600 text-white py-2.5 rounded-lg text-xs font-bold hover:bg-green-700 transition-colors shadow-lg",children:" "})," ",n.jsx("button",{onClick:()=>h(!1),className:"flex-1 bg-gray-700 text-gray-300 py-2.5 rounded-lg text-xs font-bold hover:bg-gray-600 transition-colors",children:""})," "]})," "]}):n.jsxs("div",{className:"flex justify-between items-start gap-3",children:[" ",n.jsxs("div",{className:"flex-1",children:[" ",i?n.jsx("p",{className:"text-sm text-gray-200 leading-relaxed font-medium",children:i}):n.jsxs("p",{className:"text-sm text-red-400 italic font-medium flex items-center gap-2",children:[n.jsx(jv,{className:"w-4 h-4"}),"   "]})," "]})," ",n.jsx("button",{onClick:()=>{h(!0),m(i)},className:"p-2 bg-blue-500/10 text-blue-400 rounded-lg hover:bg-blue-500/20 transition-colors flex-shrink-0",title:" ",children:n.jsx(Jn,{className:"w-4 h-4"})})," "]})," "]})," "]})," "]})," "]})},$$=({onClose:s,onSave:e})=>{const[t,r]=w.useState(""),[i,l]=w.useState(""),[d,h]=w.useState(!1),[f,m]=w.useState(""),b=()=>{if(t.length<6){m("     6   ");return}if(t!==i){m("   ");return}e(t),s()};return n.jsxs("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:s,children:[" ",n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-3xl border border-gray-700 shadow-2xl p-6 animate-pop-in",onClick:y=>y.stopPropagation(),children:[" ",n.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"  "})," ",n.jsxs("div",{className:"space-y-3",children:[" ",n.jsxs("div",{className:"relative",children:[" ",n.jsx("input",{type:d?"text":"password",value:t,onChange:y=>r(y.target.value),placeholder:"  ",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3 text-white outline-none focus:border-red-500"})," ",n.jsx("button",{onClick:()=>h(!d),className:"absolute left-3 top-3.5 text-gray-500",children:d?n.jsx(wi,{className:"w-5 h-5"}):n.jsx(na,{className:"w-5 h-5"})})," "]})," ",n.jsx("input",{type:"password",value:i,onChange:y=>l(y.target.value),placeholder:"  ",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3 text-white outline-none focus:border-red-500"})," ",f&&n.jsx("p",{className:"text-red-400 text-xs font-bold",children:f})," ",n.jsx("button",{onClick:b,className:"w-full bg-red-600 text-white font-bold py-3 rounded-xl hover:bg-red-700 transition-colors",children:""})," "]})," "]})," "]})},q$=({user:s,onClose:e,onSave:t})=>{const[r,i]=w.useState(s.name),[l,d]=w.useState(s.phone||""),[h,f]=w.useState(s.storeImage||null),m=w.useRef(null),b=y=>{var N;const v=(N=y.target.files)==null?void 0:N[0];if(v){const E=new FileReader;E.onloadend=()=>{const I=new Image;I.src=E.result,I.onload=()=>{const T=document.createElement("canvas"),L=1024,$=L/I.width;T.width=L,T.height=I.height*$;const B=T.getContext("2d");B&&(B.imageSmoothingEnabled=!0,B.imageSmoothingQuality="high",B.drawImage(I,0,0,T.width,T.height),f(T.toDataURL("image/jpeg",.9)))}},E.readAsDataURL(v)}};return n.jsxs("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:[" ",n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-[2rem] border border-gray-700 shadow-2xl overflow-hidden animate-pop-in",onClick:y=>y.stopPropagation(),children:[" ",n.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[" ",n.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[n.jsx(hn,{className:"w-5 h-5 text-blue-500"})," "]})," ",n.jsx("button",{onClick:e,className:"p-1.5 rounded-full bg-gray-800 text-gray-400 hover:text-white transition-colors",children:n.jsx(rt,{className:"w-5 h-5"})})," "]})," ",n.jsxs("div",{className:"p-6 space-y-5",children:[" ",n.jsxs("div",{className:"flex flex-col items-center mb-2",children:[" ",n.jsxs("div",{className:"relative cursor-pointer group",onClick:()=>{var y;return(y=m.current)==null?void 0:y.click()},children:[" ",n.jsxs("div",{className:"w-24 h-24 rounded-full overflow-hidden border-4 border-[#0f172a] shadow-lg relative bg-gray-800 flex items-center justify-center",children:[" ",h?n.jsx("img",{src:h,alt:"Profile",className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-10 h-10 text-gray-500"})," ",n.jsxs("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:[" ",n.jsx(Jr,{className:"w-8 h-8 text-white"})," "]})," "]})," ",n.jsxs("div",{className:"absolute bottom-0 right-0 bg-blue-600 rounded-full p-1.5 border-2 border-[#1e293b] shadow-md",children:[" ",n.jsx(Jr,{className:"w-4 h-4 text-white"})," "]})," "]})," ",n.jsx("input",{ref:m,type:"file",accept:"image/*",className:"hidden",onChange:b})," ",n.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"  "})," "]})," ",n.jsxs("div",{children:[" ",n.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2",children:" "})," ",n.jsxs("div",{className:"relative",children:[" ",n.jsx("input",{type:"text",value:r,onChange:y=>i(y.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3 text-white outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all pl-10"})," ",n.jsx(dt,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500"})," "]})," "]})," ",n.jsxs("div",{children:[" ",n.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2",children:" "})," ",n.jsxs("div",{className:"relative",children:[" ",n.jsx("input",{type:"tel",value:l,onChange:y=>d(y.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3 text-white outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all pl-10 text-right placeholder:text-right font-mono",dir:"rtl"})," ",n.jsx($s,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500"})," "]})," ",n.jsx("p",{className:"text-[10px] text-yellow-500/80 mt-2 bg-yellow-500/10 p-2 rounded-lg border border-yellow-500/20",children:":         ."})," "]})," ",n.jsx("button",{onClick:()=>t(r,l,h||void 0),className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white font-bold py-3.5 rounded-xl shadow-lg active:scale-95 transition-all mt-2",children:" "})," "]})," "]})," "]})},H$=({type:s,onClose:e})=>n.jsxs("div",{className:"fixed inset-0 z-[80] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:[" ",n.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-[2rem] border border-gray-700 shadow-2xl p-8 text-center animate-pop-in",onClick:t=>t.stopPropagation(),children:[" ",n.jsxs("div",{className:`w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg ${s==="success"?"bg-green-500/20 text-green-500 ring-4 ring-green-500/10":"bg-yellow-500/20 text-yellow-500 ring-4 ring-yellow-500/10"}`,children:[" ",s==="success"?n.jsx(Xe,{className:"w-10 h-10 animate-pulse"}):n.jsx(xt,{className:"w-10 h-10 animate-pulse"})," "]})," ",n.jsx("h3",{className:"text-xl font-black text-white mb-2",children:s==="success"?"  ":"  "})," ",n.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-8",children:s==="success"?"      .":"        .      ."})," ",n.jsx("button",{onClick:e,className:`w-full font-bold py-3.5 rounded-xl shadow-lg active:scale-95 transition-all text-white ${s==="success"?"bg-green-600 hover:bg-green-500":"bg-gray-700 hover:bg-gray-600"}`,children:" "})," "]})," "]}),G$=({user:s,merchants:e,orders:t,onPlaceOrder:r,onLogout:i,onDeleteOrder:l,sliderImages:d,sliderConfig:h,messages:f,markMessageAsSeen:m,hideMessage:b,seenMessageIds:y,deletedMessageIds:v,onUpdateUser:N,adminUser:E,appTheme:I,onUpdateTheme:T,promoCodes:L,pointsConfig:$,initialRoute:B,appConfig:Q})=>{const[Z,Y]=w.useState("landing"),[C,P]=w.useState(null),[U,O]=w.useState([]),[D,F]=w.useState(()=>{try{return JSON.parse(localStorage.getItem("favoriteProductIds")||"[]")}catch{return[]}}),[S,ae]=w.useState(!1),[K,k]=w.useState(!1),[q,W]=w.useState({title:"",desc:""}),[ne,M]=w.useState(null),[R,V]=w.useState(!1),[X,H]=w.useState(null),[se,J]=w.useState(!1),oe=w.useRef(null),[je,ye]=w.useState(!1),[Pe,Fe]=w.useState(!1),[Re,lt]=w.useState(void 0),[We,it]=w.useState(void 0),[ke,et]=w.useState([]),ge=(Q==null?void 0:Q.appVersion)||"VERSION 1.0.5",ee=(Q==null?void 0:Q.appName)||"GOO NOW";w.useEffect(()=>{const pe=Hs("support_chats",qe=>{const Ze=qe.find(pt=>pt.id===s.id);if(Ze&&Ze.messages){const pt=Ze.messages.filter(mt=>mt.sender==="admin"&&!mt.isRead);et(pt)}}),Le=Hs("settings",qe=>{const Ze=qe.find(pt=>pt.id==="support_config");Ze&&lt(Ze)});return()=>{pe(),Le()}},[s.id]),w.useEffect(()=>{ys.reportContext(Z)},[Z]);const fe={bg:"bg-[#1A1A1A]",text:"text-white",navBg:"bg-[#1A1A1A]/90",navBorder:"border-white/10"};w.useEffect(()=>{If("user",s.id)},[s.id]),Wt(()=>Pe?(Fe(!1),!0):je?(ye(!1),!0):X?(H(null),!0):R?(V(!1),!0):se?(J(!1),!0):ne?(M(null),!0):S?(ae(!1),!0):K?(k(!1),!0):Z==="store"?(P(null),Y("store-list"),!0):Z==="cart"||Z==="favorites"||Z==="messages"||Z==="special-request"||Z==="coming-soon"||Z==="store-list"||Z==="profile"?(Y("landing"),!0):Z==="landing"?!1:(Y("landing"),!0),[Z,S,K,ne,R,se,X,Pe,je]);const _e=w.useMemo(()=>{if(!s.phone)return[];const pe=s.phone.trim();return t.filter(Le=>{var Ze,pt;return((pt=(Ze=Le.customer)==null?void 0:Ze.phone)==null?void 0:pt.trim())===pe})},[t,s.phone]),Me=(pe,Le)=>{P(pe),Le&&it(Le),Y("store")},st=(pe,Le)=>{const qe=Le?`${pe.id}-${Le.name}`:pe.id;O(Ze=>Ze.find(mt=>mt.id===qe)?Ze.map(mt=>mt.id===qe?{...mt,quantity:mt.quantity+1}:mt):[...Ze,{...pe,id:qe,quantity:1,merchantId:C==null?void 0:C.id,selectedSize:Le}])},tt=pe=>{F(Le=>{const qe=Le.includes(pe)?Le.filter(Ze=>Ze!==pe):[...Le,pe];return localStorage.setItem("favoriteProductIds",JSON.stringify(qe)),qe})},Ie=(pe,Le,qe,Ze)=>{var Ns;const pt=U.length===0,mt={id:Date.now().toString(),customer:{phone:qe||s.phone||"",address:Le,name:s.name},merchantId:pt?"delinow":U[0].merchantId||"",merchantName:pt?" ":((Ns=e.find(Dt=>Dt.id===U[0].merchantId))==null?void 0:Ns.name)||"",status:pt?ce.Pending:ce.WaitingMerchant,createdAt:new Date,notes:pe,type:"shopping_order"};pt||(mt.items=[...U],mt.totalPrice=U.reduce((Dt,Cs)=>Dt+Cs.price*Cs.quantity,0),Ze&&Object.assign(mt,Ze)),r(mt),O([]),Y("orders")},$e=(pe,Le)=>{pe==="ride"?(W({title:" ",desc:"           ."}),Y("coming-soon")):pe==="transport"?(W({title:" ",desc:"       ."}),Y("coming-soon")):Y(pe)},bt=pe=>{var qe;const Le=(qe=pe.target.files)==null?void 0:qe[0];if(Le){const Ze=new FileReader;Ze.onloadend=()=>{const pt=new Image;pt.src=Ze.result,pt.onload=()=>{const mt=document.createElement("canvas"),Ns=1024,Dt=Ns/pt.width;mt.width=Ns,mt.height=pt.height*Dt;const Cs=mt.getContext("2d");if(Cs){Cs.imageSmoothingEnabled=!0,Cs.imageSmoothingQuality="high",Cs.drawImage(pt,0,0,mt.width,mt.height);const Un=mt.toDataURL("image/jpeg",.9);N(s.id,{storeImage:Un})}}},Ze.readAsDataURL(Le)}},Lt=(pe,Le,qe)=>{if(Le!==s.phone)qt("admin",{title:"   ",body:` ${s.name}     ${s.phone}  ${Le}`,url:"/?target=users"}),qt("supervisor",{title:"   ",body:` ${s.name}     ${s.phone}  ${Le}`,url:"/?target=users"}),H("pending");else if(pe!==s.name||qe&&qe!==s.storeImage){const Ze={name:pe};qe&&(Ze.storeImage=qe),N(s.id,Ze),H("success")}ae(!1)},At=()=>{const pe=(Re==null?void 0:Re.whatsappNumber)||"201000000000";window.open(`https://wa.me/${pe}`,"_blank")},os=()=>n.jsx("nav",{className:`fixed left-4 right-4 ${fe.navBg} backdrop-blur-xl border ${fe.navBorder} rounded-[2rem] flex justify-between items-center h-[60px] z-50 shadow-2xl px-4`,style:{bottom:"calc(3rem + env(safe-area-inset-bottom))"},children:[{id:"landing",icon:wv,label:""},{id:"orders",icon:Mr,label:""},{id:"cart",icon:xn,label:"",badge:U.length},{id:"profile",icon:dt,label:""}].map(pe=>n.jsxs("button",{onClick:()=>Y(pe.id),className:`relative flex flex-col items-center transition-all ${Z===pe.id?"text-red-500 -translate-y-2":"text-gray-400"}`,children:[n.jsx("div",{className:`p-2 rounded-full ${Z===pe.id?"bg-[#1A1A1A] ring-4 ring-[#252525]":""}`,children:n.jsx(pe.icon,{className:"w-5 h-5"})}),pe.badge?n.jsx("span",{className:"absolute -top-1 -right-1 bg-red-600 text-white text-[8px] rounded-full w-3.5 h-3.5 flex items-center justify-center",children:pe.badge}):null]},pe.id))}),nn=pe=>{if(pe!=null&&pe.startsWith("data:")||pe!=null&&pe.startsWith("http"))return"p-0";switch(pe){case"gold":return"p-[4px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_15px_rgba(252,246,186,0.5)]";case"neon":return"p-[4px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_15px_rgba(34,211,238,0.6)]";case"royal":return"p-[4px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-xl border border-purple-500/30";case"fire":return"p-[4px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_15px_rgba(239,68,68,0.5)]";default:return"p-0"}},Te=pe=>{if(!pe||pe==="none")return null;if(pe!=null&&pe.startsWith("data:")||pe!=null&&pe.startsWith("http"))return n.jsx("div",{className:"w-8 h-8 min-w-[2rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:n.jsx("img",{src:pe,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let Le=null,qe="";switch(pe){case"verified":Le=Si,qe="text-blue-400 fill-blue-500/20";break;case"vip":Le=ra,qe="text-yellow-400 fill-yellow-500/20";break;case"star":Le=pr,qe="text-purple-400 fill-purple-500/20";break;case"popular":Le=Ft,qe="text-red-400 fill-red-500/20";break}return Le?n.jsx(Le,{className:`w-4 h-4 ml-1 ${qe}`}):null},we=pe=>(pe==null?void 0:pe.startsWith("data:"))||(pe==null?void 0:pe.startsWith("http")),De=w.useMemo(()=>f.filter(pe=>!v.includes(pe.id)&&!y.includes(pe.id)&&(pe.targetId==="all"||pe.targetId===s.id)).length,[f,y,v,s.id]);return n.jsxs("div",{className:`fixed inset-0 h-[100dvh] ${fe.bg} ${fe.text} flex flex-col transition-colors duration-300`,dir:"rtl",children:[n.jsx("div",{className:"flex-1 relative flex flex-col overflow-hidden bg-[#1A1A1A]",children:n.jsxs("div",{className:"flex-1 flex flex-col h-full animate-page-enter",children:[Z==="landing"&&n.jsx(S$,{user:s,onNavigate:$e,sliderImages:d,sliderConfig:h,adminUser:E,merchants:e,messageCount:De,onOpenMessages:()=>Y("messages"),onOpenSupport:()=>Fe(!0),unreadSupportCount:ke.length}),Z==="store-list"&&n.jsx(k$,{user:s,merchants:e,onSelectMerchant:Me,sliderImages:d,sliderConfig:h,onSpecialRequest:()=>Y("special-request"),onOpenFavorites:()=>Y("favorites"),adminUser:E,theme:I,messageCount:De,onOpenMessages:()=>Y("messages"),onOpenSupport:()=>Fe(!0),unreadSupportCount:ke.length}),Z==="store"&&C&&n.jsx(R$,{merchant:C,onBack:()=>Y("store-list"),addToCart:st,cart:U,onViewCart:()=>Y("cart"),toggleFavorite:tt,favoriteIds:D,appTheme:I,initialCategory:We}),Z==="cart"&&n.jsx(D$,{cart:U,onBack:()=>Y("landing"),onGoToStores:()=>Y("store-list"),onUpdateQuantity:(pe,Le)=>O(qe=>qe.map(Ze=>Ze.id===pe?{...Ze,quantity:Math.max(1,Ze.quantity+Le)}:Ze)),onRemoveItem:pe=>O(Le=>Le.filter(qe=>qe.id!==pe)),onPlaceOrder:Ie,userPhone:s.phone||"",savedAddresses:s.addresses,appTheme:I,promoCodes:L,userPoints:s.pointsBalance||0,pointsConfig:$}),Z==="profile"&&n.jsxs("div",{className:"h-full overflow-y-auto bg-[#121212] pb-24",children:[n.jsxs("div",{className:"relative h-36 bg-gradient-to-br from-[#1e1e1e] to-[#121212]",children:[n.jsx("div",{className:"absolute inset-0 bg-pattern opacity-10"}),n.jsx("div",{className:"absolute -bottom-10 left-1/2 -translate-x-1/2",children:n.jsx("div",{className:"relative",children:n.jsxs("div",{className:`relative w-24 h-24 flex items-center justify-center rounded-full ${we(s.specialFrame)?"":nn(s.specialFrame)}`,children:[we(s.specialFrame)&&n.jsx("img",{src:s.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.7] pointer-events-none",alt:"frame"}),n.jsxs("div",{className:`${we(s.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full overflow-hidden bg-[#252525] border-4 border-[#121212] flex items-center justify-center shadow-2xl relative z-0`,children:[s.storeImage?n.jsx("img",{src:s.storeImage,alt:s.name,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-8 h-8 text-gray-500"}),n.jsx("button",{onClick:()=>{var pe;return(pe=oe.current)==null?void 0:pe.click()},className:"absolute bottom-0 right-0 bg-[#252525] p-1 rounded-full border-2 border-[#121212] text-gray-400 active:scale-90 hover:text-white transition-all",children:n.jsx(Jr,{className:"w-3 h-3"})}),n.jsx("input",{ref:oe,type:"file",accept:"image/*",className:"hidden",onChange:bt})]})]})})})]}),n.jsxs("div",{className:"pt-12 px-5 text-center",children:[n.jsxs("div",{className:"flex items-center justify-center gap-2 mb-0.5",children:[n.jsx("h2",{className:"text-lg font-bold text-white",children:s.name}),Te(s.specialBadge)]}),n.jsx("p",{className:"text-gray-500 text-xs font-mono mb-4",children:s.phone}),n.jsxs("div",{className:"flex justify-center gap-2 mb-6",children:[n.jsxs("div",{className:`bg-[#1E1E1E] rounded-xl p-2 border border-white/5 shadow-sm ${($==null?void 0:$.isPointsEnabled)===!0?"flex-1":"w-full"}`,children:[n.jsx("p",{className:"text-[9px] text-gray-500 mb-0.5",children:""}),n.jsx("p",{className:"text-base font-black text-white",children:_e.filter(pe=>pe.status===ce.Delivered).length})]}),($==null?void 0:$.isPointsEnabled)===!0&&n.jsxs("div",{className:"flex-1 bg-[#1E1E1E] rounded-xl p-2 border border-white/5 shadow-sm",children:[n.jsx("p",{className:"text-[9px] text-gray-500 mb-0.5",children:""}),n.jsx("p",{className:"text-base font-black text-yellow-500",children:s.pointsBalance||0})]})]}),n.jsxs("div",{className:"space-y-3 text-right",children:[n.jsxs("button",{onClick:()=>ye(!0),className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white font-bold p-3 rounded-2xl shadow-lg shadow-blue-900/20 flex items-center justify-between mb-3 active:scale-[0.98] transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-1.5 rounded-lg bg-white/20 text-white",children:n.jsx(Vr,{className:"w-5 h-5"})}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-bold text-sm",children:" "}),n.jsx("p",{className:"text-[9px] text-blue-200",children:"  "})]})]}),n.jsx(zs,{className:"w-4 h-4 text-blue-200"})]}),n.jsxs("div",{className:"bg-[#1E1E1E] rounded-2xl overflow-hidden border border-white/5",children:[n.jsx(dd,{icon:n.jsx(hn,{className:"w-4 h-4"}),label:" ",onClick:()=>ae(!0)}),n.jsx("div",{className:"h-px bg-white/5 mx-4"}),n.jsx(dd,{icon:n.jsx(na,{className:"w-4 h-4"}),label:"  ",onClick:()=>J(!0)}),n.jsx("div",{className:"h-px bg-white/5 mx-4"}),n.jsx(dd,{icon:n.jsx(pn,{className:"w-4 h-4"}),label:" ",onClick:()=>k(!0)})]}),n.jsxs("div",{className:"bg-[#1E1E1E] rounded-2xl overflow-hidden border border-white/5",children:[n.jsx(dd,{icon:n.jsx(Or,{className:"w-4 h-4"}),label:" ",onClick:()=>M({title:" ",content:"..."})}),n.jsx("div",{className:"h-px bg-white/5 mx-4"}),n.jsx(dd,{icon:n.jsx(Mr,{className:"w-4 h-4"}),label:" ",onClick:()=>M({title:" ",content:"..."})})]}),n.jsx("div",{className:"bg-[#1E1E1E] rounded-2xl overflow-hidden border border-white/5 mt-4",children:n.jsx(dd,{icon:n.jsx(Sf,{className:"w-4 h-4"}),label:" ",danger:!0,onClick:()=>V(!0)})}),n.jsxs("p",{className:"text-center text-[9px] text-gray-700 mt-4 font-mono",children:[ee," ",ge]})]})]})]}),Z==="orders"&&n.jsx(O$,{orders:_e,onDeleteOrder:l,appTheme:I}),Z==="messages"&&n.jsx(P$,{messages:f.filter(pe=>!v.includes(pe.id)&&(pe.targetId==="all"||pe.targetId===s.id)),onMarkAsSeen:m,hideMessage:b,appTheme:I}),Z==="special-request"&&n.jsx(M$,{user:s,onBack:()=>Y("landing"),onPlaceOrder:Ie,appTheme:I}),Z==="favorites"&&n.jsx(L$,{merchants:e,favoriteIds:D,toggleFavorite:tt,addToCart:(pe,Le)=>{P(Le),st(pe)},onBack:()=>Y("store-list"),appTheme:I}),Z==="coming-soon"&&n.jsx(V$,{title:q.title,description:q.desc,onBack:()=>Y("landing")})]},Z)}),ne&&n.jsx(B$,{title:ne.title,content:ne.content,onClose:()=>M(null)}),S&&n.jsx(q$,{user:s,onClose:()=>ae(!1),onSave:Lt}),X&&n.jsx(H$,{type:X,onClose:()=>H(null)}),se&&n.jsx($$,{onClose:()=>J(!1),onSave:pe=>N(s.id,{password:pe})}),K&&n.jsx(z$,{user:s,onClose:()=>k(!1),onUpdate:pe=>N(s.id,{addresses:pe})}),je&&n.jsx(U$,{onClose:()=>ye(!1),onOpenChat:()=>Fe(!0),onOpenWhatsapp:At,config:Re}),Pe&&n.jsx(F$,{user:s,onClose:()=>Fe(!1),config:Re}),R&&n.jsx(fs,{title:" ",message:"      ",onClose:()=>V(!1),onConfirm:()=>{V(!1),i()},confirmButtonText:" ",cancelButtonText:"",confirmVariant:"danger"}),Z!=="store"&&Z!=="special-request"&&Z!=="coming-soon"&&os()]})},Ta=({icon:s,label:e,onClick:t,isActive:r,danger:i})=>n.jsxs("button",{onClick:t,className:`w-full flex items-center gap-4 p-4 rounded-2xl transition-all duration-300 group relative overflow-hidden active:scale-95 mb-2 ${i?"text-red-400 hover:bg-red-500/10":r?"bg-cyan-600/20 text-white border border-cyan-500/30 shadow-[0_0_15px_rgba(6,182,212,0.1)]":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[r&&n.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 bg-cyan-500 rounded-l-full"}),n.jsx("div",{className:`relative z-10 transition-transform group-hover:scale-110 duration-300 ${r?"text-cyan-400":""}`,children:s}),n.jsx("span",{className:`relative z-10 font-bold text-sm ${r?"translate-x-1":""} transition-transform duration-300`,children:e})]}),W$=s=>{var ne;const e=s.user.permissions||[],[t,r]=w.useState(!1),[i,l]=w.useState(null),[d,h]=w.useState(null),[f,m]=w.useState(null),[b,y]=w.useState(null),[v,N]=w.useState(null),E=w.useMemo(()=>s.users.filter(M=>M.role==="merchant"),[s.users]),I=w.useMemo(()=>s.users.filter(M=>M.role==="driver"),[s.users]),[T,L]=w.useState(!0),$=s.users.filter(M=>M.status==="pending"&&M.role!=="admin").length,B=s.orders.filter(M=>M.status===ce.Pending&&!M.driverId).length,Q=$+s.passwordResetRequests.length+B,Z=()=>e.includes("manage_orders")||e.includes("view_orders")?"orders":e.includes("view_reports")?"reports":e.includes("view_users")?"users":e.includes("send_messages")?"messages":e.includes("manage_support")?"support":e.includes("manage_decorations")?"customizer":"orders",[Y,C]=w.useState(Z());Wt(()=>t?(r(!1),!0):d?(h(null),!0):f?(m(null),!0):b?(y(null),!0):v?(N(null),!0):i?(l(null),!0):Y==="add_order"||Y==="notifications"||Y!=="orders"&&(e.includes("view_orders")||e.includes("manage_orders"))?(C("orders"),!0):!1,[Y,i,d,f,b,v,e,t]);const P=async(M,R)=>{if(!e.includes("manage_orders"))return;const V=s.orders.filter(H=>H.status===ce.Pending&&!H.driverId);if(V.length===0)return;const X=V.map(H=>({...H,driverId:M,deliveryFee:R,status:ce.InTransit}));await s.onBulkUpdate(X),s.showNotification(`  ${X.length}   `,"success")},U=async M=>{if(!e.includes("delete_orders"))return;const R=M==="all"?s.orders:s.orders.filter(V=>V.status===M);if(R.length!==0){for(const V of R)await s.deleteOrder(V.id);s.showNotification(`  ${R.length}  `,"success")}},O=()=>{switch(Y){case"orders":return e.includes("view_orders")||e.includes("manage_orders")?n.jsx($g,{...s,permissions:e,onNavigateToAdd:()=>C("add_order"),onOpenStatusModal:e.includes("manage_orders")?h:void 0,onBulkAssign:e.includes("manage_orders")?P:void 0,onBulkDelete:e.includes("delete_orders")?U:void 0}):null;case"reports":return e.includes("view_reports")?n.jsx(Ck,{orders:s.orders,users:s.users,payments:s.payments,currentUser:s.user}):null;case"add_order":return n.jsx(Dk,{merchants:E,onClose:()=>C("orders"),onSave:async R=>{await s.adminAddOrder(R)}});case"notifications":return n.jsx(mS,{users:s.users.filter(R=>R.role!=="admin"),updateUser:s.updateUser,onDeleteUser:s.deleteUser,passwordResetRequests:s.passwordResetRequests,resolvePasswordResetRequest:s.resolvePasswordResetRequest,setEditingUser:l,pendingOrders:s.orders.filter(R=>R.status===ce.Pending&&!R.driverId),onNavigateToOrders:()=>C("orders")});case"users":const M=s.users.filter(R=>R.role!=="admin");return e.includes("view_users")||e.includes("manage_users")?n.jsx(uS,{...s,users:M,onAdminAddUser:s.adminAddUser,onDeleteUser:s.deleteUser,permissions:e,setEditingUser:l,currentUser:s.user}):null;case"stores":return e.includes("manage_stores")?n.jsx(fS,{users:s.users,orders:s.orders,updateUser:s.updateUser}):null;case"slider":return e.includes("manage_slider")?n.jsx(Rk,{images:s.sliderImages,isEnabled:s.sliderConfig.isEnabled,onAddImage:s.onAddSliderImage,onDeleteImage:s.onDeleteSliderImage,onUpdateImage:s.onUpdateSliderImage,onToggleSlider:s.onToggleSlider,merchants:E,adminUser:void 0}):null;case"wallet":return e.includes("view_wallet")?n.jsx(gS,{...s}):null;case"logs":return e.includes("view_logs")?n.jsx(Lk,{logs:s.auditLogs,onClearLogs:()=>{}}):null;case"loyalty":return e.includes("manage_promo")?n.jsx(Vk,{promoCodes:s.promoCodes,pointsConfig:s.pointsConfig,onAddPromo:s.onAddPromo,onDeletePromo:s.onDeletePromo,onUpdatePointsConfig:s.onUpdatePointsConfig}):null;case"messages":return e.includes("send_messages")?n.jsx(pS,{users:s.users.filter(R=>R.role!=="admin"),onSendMessage:s.sendMessage,messages:s.messages,deleteMessage:s.deleteMessage}):null;case"support":return e.includes("manage_support")?n.jsx(Uk,{users:s.users,isRestricted:!0,currentUser:s.user}):null;case"customizer":return e.includes("manage_decorations")&&s.currentTheme&&s.onUpdateTheme?n.jsx(Mk,{onClose:()=>C("orders"),currentTheme:s.currentTheme,onUpdateTheme:s.onUpdateTheme,users:s.users,onUpdateUser:s.updateUser,sendNotification:qt,currentUser:s.user}):null;default:return null}},D=[{id:"orders",condition:e.includes("view_orders")||e.includes("manage_orders")},{id:"users",condition:e.includes("view_users")||e.includes("manage_users")},{id:"wallet",condition:e.includes("view_wallet")},{id:"stores",condition:e.includes("manage_stores")},{id:"slider",condition:e.includes("manage_slider")},{id:"messages",condition:e.includes("send_messages")},{id:"support",condition:e.includes("manage_support")},{id:"customizer",condition:e.includes("manage_decorations")}].filter(M=>M.condition).map(M=>M.id),F=((ne=s.appConfig)==null?void 0:ne.appName)||"GOO NOW",[S,...ae]=F.split(" "),K=ae.join(" "),k=M=>{if(M!=null&&M.startsWith("data:")||M!=null&&M.startsWith("http"))return"p-0";switch(M){case"gold":return"p-[3px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[3px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[3px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[3px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-[2px] bg-gradient-to-br from-cyan-500 to-blue-600"}},q=M=>(M==null?void 0:M.startsWith("data:"))||(M==null?void 0:M.startsWith("http")),W=M=>{if(!M||M==="none")return null;if(M!=null&&M.startsWith("data:")||M!=null&&M.startsWith("http"))return n.jsx("div",{className:"w-8 h-8 min-w-[2rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:n.jsx("img",{src:M,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let R=null,V="";switch(M){case"verified":R=Si,V="text-blue-400 fill-blue-500/20";break;case"vip":R=ra,V="text-yellow-400 fill-yellow-500/20";break;case"star":R=pr,V="text-purple-400 fill-purple-500/20";break;case"popular":R=Ft,V="text-red-400 fill-red-500/20";break;case"admin-badge":R=hn,V="text-red-500";break;case"mod-badge":R=Or,V="text-green-500";break}return R?n.jsx(R,{className:`w-5 h-5 ${V}`}):null};return n.jsxs("div",{className:"flex flex-col h-screen bg-gray-900 text-white overflow-hidden",children:[t&&n.jsxs("div",{className:"fixed inset-0 z-[60] flex justify-start animate-fadeIn",dir:"rtl",children:[n.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-md transition-all duration-500",onClick:()=>r(!1)}),n.jsxs("div",{className:"w-[290px] h-full bg-[#111827]/60 backdrop-blur-3xl border-l border-white/10 shadow-2xl relative flex flex-col z-10 pt-safe rounded-l-[40px] overflow-hidden transform animate-slide-in-right",children:[n.jsxs("div",{className:"p-8 border-b border-white/5 relative flex flex-col items-center",children:[n.jsx("button",{onClick:()=>r(!1),className:"absolute top-4 left-4 p-2 rounded-full bg-white/5 hover:bg-white/10 text-gray-400 active:scale-90",children:n.jsx(rt,{className:"w-5 h-5"})}),n.jsxs("button",{onClick:()=>{l(s.user),r(!1)},className:`w-24 h-24 rounded-full flex items-center justify-center shadow-2xl mb-4 relative group/avatar cursor-pointer transition-transform active:scale-95 ${q(s.user.specialFrame)?"":k(s.user.specialFrame)}`,children:[q(s.user.specialFrame)&&n.jsx("img",{src:s.user.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.65] pointer-events-none",alt:"frame"}),n.jsxs("div",{className:`${q(s.user.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-gray-900 overflow-hidden border-2 border-white/10 flex items-center justify-center relative z-0`,children:[s.user.storeImage?n.jsx("img",{src:s.user.storeImage,className:"w-full h-full object-cover"}):n.jsx(dt,{className:"w-10 h-10 text-gray-500"}),n.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover/avatar:opacity-100 transition-opacity",children:n.jsx(hn,{className:"w-6 h-6 text-white"})})]})]}),n.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[n.jsx("h3",{className:"font-black text-xl tracking-tight text-white",children:s.user.name}),W(s.user.specialBadge)]}),n.jsx("p",{className:"text-[10px] font-bold text-cyan-400 uppercase tracking-[0.2em] mt-1",children:"Supervisor"})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-1 custom-scrollbar",children:[e.includes("view_reports")&&n.jsx(Ta,{icon:n.jsx(Ef,{className:"w-5 h-5"}),label:" ",onClick:()=>{C("reports"),r(!1)},isActive:Y==="reports"}),e.includes("manage_support")&&n.jsx(Ta,{icon:n.jsx(Vr,{className:"w-5 h-5"}),label:" ",onClick:()=>{C("support"),r(!1)},isActive:Y==="support"}),e.includes("view_users")&&n.jsx(Ta,{icon:n.jsx(Zd,{className:"w-5 h-5"}),label:"",onClick:()=>{C("users"),r(!1)},isActive:Y==="users"}),e.includes("manage_stores")&&n.jsx(Ta,{icon:n.jsx(Xn,{className:"w-5 h-5"}),label:" ",onClick:()=>{C("stores"),r(!1)},isActive:Y==="stores"}),e.includes("manage_slider")&&n.jsx(Ta,{icon:n.jsx(fr,{className:"w-5 h-5"}),label:" ",onClick:()=>{C("slider"),r(!1)},isActive:Y==="slider"}),e.includes("send_messages")&&n.jsx(Ta,{icon:n.jsx(Dr,{className:"w-5 h-5"}),label:"",onClick:()=>{C("messages"),r(!1)},isActive:Y==="messages"}),e.includes("view_logs")&&n.jsx(Ta,{icon:n.jsx(Or,{className:"w-5 h-5"}),label:" ",onClick:()=>{C("logs"),r(!1)},isActive:Y==="logs"}),e.includes("manage_promo")&&n.jsx(Ta,{icon:n.jsx(B0,{className:"w-5 h-5"}),label:"",onClick:()=>{C("loyalty"),r(!1)},isActive:Y==="loyalty"}),e.includes("manage_decorations")&&n.jsx(Ta,{icon:n.jsx(Nv,{className:"w-5 h-5"}),label:" ",onClick:()=>{C("customizer"),r(!1)},isActive:Y==="customizer"})]}),n.jsx("div",{className:"p-6 border-t border-white/5 bg-black/20 pb-safe",children:n.jsx(Ta,{icon:n.jsx(Sf,{className:"w-5 h-5"}),label:" ",onClick:s.onLogout,danger:!0})})]})]}),Y!=="add_order"&&n.jsx("header",{className:"bg-gray-800/95 backdrop-blur-md border-b border-cyan-500/30 sticky top-0 z-30 shadow-lg transition-all duration-300 pt-safe rounded-b-[35px] mx-2 mt-1",children:n.jsxs("div",{className:"max-w-7xl mx-auto py-3 px-4 flex justify-between items-center relative h-14",children:[n.jsx("button",{onClick:()=>r(!0),className:"flex items-center gap-3 active:scale-90 transition-transform",children:n.jsxs("div",{className:`relative w-10 h-10 flex items-center justify-center rounded-full shadow-lg ${q(s.user.specialFrame)?"":k(s.user.specialFrame)}`,children:[q(s.user.specialFrame)&&n.jsx("img",{src:s.user.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.5] pointer-events-none",alt:"frame"}),n.jsx("div",{className:`${q(s.user.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-gray-900 flex items-center justify-center overflow-hidden relative z-0`,children:s.user.storeImage?n.jsx("img",{src:s.user.storeImage,className:"w-full h-full object-cover"}):n.jsx("div",{className:"text-cyan-500 font-bold text-sm",children:s.user.name.charAt(0)})})]})}),n.jsxs("h1",{className:"text-2xl font-black absolute left-1/2 -translate-x-1/2 select-none",children:[n.jsx("span",{className:"text-red-600",children:S}),n.jsx("span",{className:"text-white ml-1",children:K})]}),n.jsx("div",{className:"flex items-center gap-1",children:n.jsxs("button",{onClick:()=>C("notifications"),className:"relative p-2.5 rounded-xl bg-cyan-500/10 hover:bg-cyan-500/20 transition-colors",children:[n.jsx(Tn,{className:`w-6 h-6 ${Q>0?"text-yellow-500":"text-gray-400"}`}),Q>0&&n.jsx("span",{className:"absolute top-1.5 right-1.5 w-4 h-4 flex items-center justify-center bg-red-600 text-[9px] font-bold text-white rounded-full ring-2 ring-gray-800 animate-pulse",children:Q})]})})]})}),n.jsx("main",{className:Y==="add_order"?"flex-1 bg-[#111] h-full":"flex-1 overflow-y-auto p-4 sm:p-6 pb-24 relative",children:O()}),Y!=="add_order"&&D.length>0&&n.jsx(Ok,{activeView:Y,onNavigate:M=>C(M),availableViews:D,isVisible:T}),i&&n.jsx(Tv,{user:i,onClose:()=>l(null),onSave:(M,R)=>{s.updateUser(M,R),l(null)},isLastAdmin:!1,currentUser:s.user}),d&&n.jsx(Pk,{order:d,onClose:()=>h(null),onSelectStatus:(M,R)=>{h(null),setTimeout(()=>{R===ce.InTransit?m(M):N({order:M,newStatus:R})},150)},onTransferOrder:M=>{h(null),setTimeout(()=>{y(M)},100)}}),f&&n.jsx(V0,{order:f,drivers:I,targetStatus:ce.InTransit,onClose:()=>m(null),onSave:(M,R)=>{s.assignDriverAndSetStatus(f.id,M,R,ce.InTransit),m(null)}}),b&&n.jsx(V0,{order:b,drivers:I,targetStatus:ce.InTransit,onClose:()=>y(null),onSave:(M,R)=>{s.assignDriverAndSetStatus(b.id,M,R,ce.InTransit),y(null)}}),v&&n.jsx(fs,{title:"  ",message:"    ",onClose:()=>N(null),onConfirm:()=>{s.updateOrderStatus(v.order.id,v.newStatus),N(null)},confirmVariant:"primary"})]})},K$=({onClose:s,onRequestReset:e})=>{Wt(()=>(s(),!0));const[t,r]=w.useState(""),[i,l]=w.useState(""),[d,h]=w.useState(!1),[f,m]=w.useState(""),[b,y]=w.useState(!1),v=async N=>{if(N.preventDefault(),m(""),l(""),!t){m("   .");return}y(!0);const E=await e(t);y(!1),E.success?(h(!0),l(E.message)):m(E.message)};return n.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-md flex justify-center items-center z-[60] p-4 animate-fadeIn",onClick:s,children:n.jsxs("div",{className:"bg-[#1e293b] rounded-[2rem] shadow-2xl w-full max-w-sm text-white border border-white/10 overflow-hidden relative",onClick:N=>N.stopPropagation(),children:[n.jsxs("div",{className:"p-5 border-b border-white/5 flex justify-between items-center bg-[#151e2d]",children:[n.jsx("h3",{className:"text-lg font-bold text-white tracking-wide",children:"   "}),n.jsx("button",{onClick:s,className:"w-8 h-8 flex items-center justify-center rounded-full bg-white/5 text-gray-400 hover:text-white hover:bg-white/10 transition-colors",children:n.jsx(rt,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"p-6",children:d?n.jsxs("div",{className:"text-center py-6 animate-fade-slide-up",children:[n.jsx("div",{className:"w-20 h-20 bg-green-500/10 rounded-full flex items-center justify-center mx-auto mb-4 ring-1 ring-green-500/30",children:n.jsx($s,{className:"w-10 h-10 text-green-500"})}),n.jsx("h4",{className:"text-xl font-bold text-white mb-2",children:" "}),n.jsx("p",{className:"text-green-400 font-medium text-sm leading-relaxed",children:i}),n.jsx("button",{onClick:s,className:"mt-6 w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 rounded-xl transition-all",children:""})]}):n.jsxs("form",{onSubmit:v,className:"space-y-5 animate-fade-slide-up",children:[n.jsx("p",{className:"text-sm text-gray-400 leading-relaxed text-center px-2",children:"   .         ."}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{htmlFor:"reset-phone",className:"block text-xs font-bold text-gray-400 mr-1",children:" "}),n.jsxs("div",{className:"relative group",children:[n.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-4 text-gray-500 group-focus-within:text-red-500 transition-colors z-10 pointer-events-none",children:n.jsx($s,{className:"w-5 h-5"})}),n.jsx("input",{type:"tel",inputMode:"numeric",id:"reset-phone",value:t,onChange:N=>r(N.target.value.replace(/\D/g,"")),placeholder:"01xxxxxxxxx",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-4 pl-12 pr-4 text-white placeholder-gray-600 focus:border-red-500 focus:ring-1 focus:ring-red-500/50 outline-none transition-all text-right font-mono text-lg shadow-inner",required:!0,dir:"rtl",disabled:b})]})]}),f&&n.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-3 flex items-center justify-center animate-pulse",children:n.jsx("p",{className:"text-red-400 text-xs font-bold",children:f})}),n.jsx("button",{type:"submit",disabled:b,className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-red-900/20 active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed flex justify-center items-center",children:b?n.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):" "})]})})]})})},Q$=({onPasswordLogin:s,onGoToSignUp:e,onPasswordResetRequest:t,appConfig:r})=>{const[i,l]=w.useState(""),[d,h]=w.useState(""),[f,m]=w.useState(""),[b,y]=w.useState(!1),[v,N]=w.useState(!1),[E,I]=w.useState(!1),T=r||{appName:"GOO NOW",appVersion:"VERSION 1.0.5"},L=T.appName.split(" "),$=L[0],B=L.slice(1).join(" ");w.useEffect(()=>{ys.reportContext("login")},[]),Wt(()=>b?(y(!1),!0):!1,[b]);const Q=()=>{y(!0)},Z=()=>{y(!1)},Y=async C=>{if(C.preventDefault(),m(""),!i){m("   .");return}if(!d){m("   .");return}I(!0),await new Promise(U=>setTimeout(U,300));const P=await s(i,d);I(!1),P.success||m(P.message)};return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-black h-dvh flex flex-col items-center justify-center p-6 pt-safe text-white relative overflow-hidden",dir:"rtl",style:{fontFamily:T!=null&&T.customFont?"'AppCustomFont', 'Cairo', sans-serif":void 0},children:[n.jsx("div",{className:"absolute top-[-20%] left-[-20%] w-[70%] h-[50%] bg-red-600/10 rounded-full blur-[120px] pointer-events-none animate-pulse-slow"}),n.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[60%] h-[50%] bg-blue-600/5 rounded-full blur-[100px] pointer-events-none"}),n.jsxs("div",{className:"w-full max-w-sm relative z-10 flex flex-col justify-center h-full max-h-[800px]",children:[n.jsxs("div",{className:"text-center mb-10 transform transition-all duration-700 animate-slide-down",children:[n.jsxs("div",{className:"inline-block relative",children:[n.jsxs("h1",{className:"text-5xl md:text-6xl font-black tracking-tighter mb-2 drop-shadow-2xl relative z-10",children:[n.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-red-500 to-red-600",children:$}),B&&n.jsx("span",{className:"text-white ml-2",children:B})]}),n.jsx("div",{className:"absolute -bottom-2 left-1/2 -translate-x-1/2 w-1/2 h-1 bg-gradient-to-r from-transparent via-red-500 to-transparent opacity-50 rounded-full blur-[1px]"})]}),n.jsx("p",{className:"text-gray-400 text-sm font-medium tracking-widest uppercase opacity-80 mt-2",children:"   "})]}),n.jsxs("form",{onSubmit:Y,className:"space-y-6 w-full animate-fade-slide-up",style:{animationDelay:"0.1s"},children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{htmlFor:"identifier",className:"block text-xs font-bold text-gray-400 mr-1 transition-colors",children:" "}),n.jsxs("div",{className:"relative group",children:[n.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-4 text-gray-500 group-focus-within:text-red-500 transition-colors z-10 pointer-events-none",children:n.jsx($s,{className:"w-5 h-5"})}),n.jsx("input",{type:"tel",inputMode:"numeric",id:"identifier",value:i,onChange:C=>l(C.target.value.replace(/\D/g,"")),placeholder:"01xxxxxxxxx",className:"w-full bg-[#1e293b]/80 border border-gray-700 rounded-2xl py-4 pl-12 pr-5 text-white placeholder-gray-600 focus:border-red-500 focus:ring-1 focus:ring-red-500/50 focus:bg-[#1e293b] outline-none transition-all duration-300 shadow-sm text-right font-mono text-lg tracking-wide",required:!0,maxLength:11,dir:"rtl",disabled:E})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{htmlFor:"password",className:"block text-xs font-bold text-gray-400 mr-1 transition-colors",children:" "}),n.jsxs("div",{className:"relative group",children:[n.jsx("button",{type:"button",onClick:()=>N(!v),className:"absolute top-1/2 -translate-y-1/2 left-0 p-4 text-gray-500 hover:text-white transition-colors z-20 outline-none",tabIndex:-1,children:v?n.jsx(wi,{className:"w-5 h-5"}):n.jsx(na,{className:"w-5 h-5"})}),n.jsx("input",{type:v?"text":"password",id:"password",value:d,onChange:C=>h(C.target.value.replace(/[^a-zA-Z0-9]/g,"")),className:"w-full bg-[#1e293b]/80 border border-gray-700 rounded-2xl py-4 pl-12 pr-5 text-white placeholder-gray-600 focus:border-red-500 focus:ring-1 focus:ring-red-500/50 focus:bg-[#1e293b] outline-none transition-all duration-300 shadow-sm text-lg",required:!0,minLength:6,placeholder:"",disabled:E})]})]}),n.jsx("div",{className:"flex justify-end pt-1",children:n.jsx("button",{type:"button",onClick:Q,className:"text-xs font-bold text-gray-400 hover:text-red-400 transition-colors focus:outline-none",children:"   "})}),f&&n.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-3 flex items-center justify-center gap-2 animate-pulse",children:[n.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-red-500"}),n.jsx("p",{className:"text-red-400 text-xs font-bold",children:f})]}),n.jsx("button",{type:"submit",disabled:E,className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-bold py-4 rounded-2xl transition-all shadow-lg shadow-red-900/30 active:scale-[0.98] flex justify-center items-center text-lg mt-6 group relative overflow-hidden disabled:opacity-70 disabled:cursor-not-allowed",children:E?n.jsx("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"}):n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"relative z-10",children:" "}),n.jsx("div",{className:"absolute inset-0 bg-white/10 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"})]})})]}),n.jsx("div",{className:"text-center mt-10 animate-fade-slide-up",style:{animationDelay:"0.2s"},children:n.jsxs("p",{className:"text-sm text-gray-500 font-medium",children:["  ",n.jsx("button",{onClick:e,className:"text-white font-bold hover:text-red-500 transition-colors mr-2 hover:underline decoration-red-500 underline-offset-4",children:"  "})]})})]}),n.jsx("div",{className:"absolute bottom-6 left-0 right-0 text-center opacity-40",children:n.jsx("p",{className:"text-[10px] text-gray-500 font-mono tracking-widest",children:T.appVersion})})]}),b&&n.jsx(K$,{onClose:Z,onRequestReset:t})]})},Y$="modulepreload",X$=function(s,e){return new URL(s,e).href},sS={},nS=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let d=function(b){return Promise.all(b.map(y=>Promise.resolve(y).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};const h=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),m=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));i=d(t.map(b=>{if(b=X$(b,r),b in sS)return;sS[b]=!0;const y=b.endsWith(".css"),v=y?'[rel="stylesheet"]':"";if(!!r)for(let I=h.length-1;I>=0;I--){const T=h[I];if(T.href===b&&(!y||T.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${b}"]${v}`))return;const E=document.createElement("link");if(E.rel=y?"stylesheet":Y$,y||(E.as="script"),E.crossOrigin="",E.href=b,m&&E.setAttribute("nonce",m),document.head.appendChild(E),y)return new Promise((I,T)=>{E.addEventListener("load",I),E.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${b}`)))})}))}function l(d){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=d,window.dispatchEvent(h),!h.defaultPrevented)throw d}return i.then(d=>{for(const h of d||[])h.status==="rejected"&&l(h.reason);return e().catch(l)})},_y=[{id:"restaurant",label:"",icon:Lr,color:"text-orange-500",bg:"bg-orange-500/10",border:"border-orange-500/20"},{id:"market",label:" ",icon:xn,color:"text-green-500",bg:"bg-green-500/10",border:"border-green-500/20"},{id:"pharmacy",label:"",icon:Gs,color:"text-blue-500",bg:"bg-blue-500/10",border:"border-blue-500/20"},{id:"bakery",label:"/",icon:bn,color:"text-yellow-500",bg:"bg-yellow-500/10",border:"border-yellow-500/20"},{id:"electronics",label:"",icon:Ao,color:"text-cyan-500",bg:"bg-cyan-500/10",border:"border-cyan-500/20"},{id:"fashion",label:"",icon:L3,color:"text-purple-500",bg:"bg-purple-500/10",border:"border-purple-500/20"},{id:"logistics",label:" ",icon:Ut,color:"text-indigo-500",bg:"bg-indigo-500/10",border:"border-indigo-500/20"},{id:"other",label:"",icon:bn,color:"text-gray-400",bg:"bg-gray-800",border:"border-gray-700"}],Eh=({icon:s,iconColor:e,colSpan:t="col-span-1",...r})=>n.jsxs("div",{className:`relative group ${t}`,children:[n.jsx("div",{className:`absolute top-1/2 -translate-y-1/2 left-3 transition-colors pointer-events-none z-10 ${e||"text-gray-500"} group-focus-within:text-white`,children:n.jsx(s,{className:"w-5 h-5"})}),n.jsx("input",{...r,className:`w-full bg-[#1F2937]/50 border border-gray-700 rounded-xl py-3.5 pl-10 pr-4 text-sm text-white placeholder-gray-500 focus:border-red-500 focus:ring-1 focus:ring-red-500 focus:bg-[#1F2937] outline-none transition-all duration-300 ${r.className||""}`})]}),J$=({onSignUp:s,onBackToLogin:e})=>{const[t,r]=w.useState("role-selection"),[i,l]=w.useState(null),[d,h]=w.useState(""),[f,m]=w.useState(60),b=w.useRef(null);w.useEffect(()=>{ys.reportContext("signup")},[]),w.useEffect(()=>{let ee;return t==="otp"&&f>0&&(ee=setInterval(()=>m(fe=>fe-1),1e3)),()=>clearInterval(ee)},[t,f]),Wt(()=>ne?(M(!1),!0):t==="form"?(r("role-selection"),!0):(e(),!0),[t,e]);const[y,v]=w.useState(""),[N,E]=w.useState(""),[I,T]=w.useState(""),[L,$]=w.useState(""),[B,Q]=w.useState("customer"),[Z,Y]=w.useState(""),[C,P]=w.useState(""),[U,O]=w.useState(null),[D,F]=w.useState("restaurant"),[S,ae]=w.useState(""),[K,k]=w.useState("09:00"),[q,W]=w.useState("23:00"),[ne,M]=w.useState(!1),[R,V]=w.useState(!1),[X,H]=w.useState(""),[se,J]=w.useState(!1),[oe,je]=w.useState(!1),[ye,Pe]=w.useState(!1),Fe=w.useRef(null),Re=ee=>{Q(ee),r("form"),H("")},lt=ee=>new Promise((fe,_e)=>{const Me=new FileReader;Me.readAsDataURL(ee),Me.onload=st=>{var Ie;const tt=new Image;tt.src=(Ie=st.target)==null?void 0:Ie.result,tt.onload=()=>{const $e=document.createElement("canvas"),bt=1200,Lt=1200;let At=tt.width,os=tt.height;At>os?At>bt&&(os*=bt/At,At=bt):os>Lt&&(At*=Lt/os,os=Lt),$e.width=At,$e.height=os;const nn=$e.getContext("2d");nn?(nn.imageSmoothingEnabled=!0,nn.imageSmoothingQuality="high",nn.drawImage(tt,0,0,At,os),fe($e.toDataURL("image/jpeg",.9))):_e(new Error("Canvas context error"))},tt.onerror=$e=>_e($e)},Me.onerror=st=>_e(st)}),We=async ee=>{var _e;const fe=(_e=ee.target.files)==null?void 0:_e[0];if(fe){je(!0);try{const Me=await lt(fe);setTimeout(()=>{O(Me),je(!1)},800)}catch(Me){console.error("Error resizing image:",Me),je(!1),H("        .")}}},it=async()=>{H(""),J(!0);try{if(!b.current){const{setupRecaptcha:_e}=await nS(async()=>{const{setupRecaptcha:Me}=await Promise.resolve().then(()=>KT);return{setupRecaptcha:Me}},void 0,import.meta.url);b.current=_e("recaptcha-container")}const{signInWithPhone:ee}=await nS(async()=>{const{signInWithPhone:_e}=await Promise.resolve().then(()=>KT);return{signInWithPhone:_e}},void 0,import.meta.url),fe=await ee(N,b.current);fe.success?(l(fe.confirmationResult),r("otp"),m(60)):(H(fe.error||"   ."),b.current&&(b.current.clear(),b.current=null))}catch(ee){console.error("SignUp Error:",ee);const fe=ee.error||ee.message||JSON.stringify(ee);H(`: ${fe}`)}finally{J(!1)}},ke=async ee=>{if(H(""),!d||d.length<6){H("      6 .");return}J(!0);try{await i.confirm(d);const fe={name:y,phone:N,password:I,role:B,storeImage:U,email:Z||void 0,address:C||void 0};B==="merchant"&&(fe.storeCategory=D==="other"?S.trim():D,fe.storeName=y,fe.workingHours={start:K,end:q});const _e=await s(fe);_e.success?(Pe(!0),setTimeout(()=>e(),4e3)):H(_e.message)}catch(fe){console.error("OTP Error:",fe),H("      .")}finally{J(!1)}},et=async ee=>{if(ee.preventDefault(),H(""),!y||!N||!I||!L){H("    .");return}if(B!=="driver"&&!C.trim()){H("  .");return}if(!U){H(B==="merchant"?"  .":"  .");return}if(!/^\d{11}$/.test(N)){H("      11 .");return}if(I.length<6){H("     6   .");return}if(I!==L){H("   .");return}if(B==="merchant"&&D==="other"){if(!S.trim()){H("     .");return}S.trim()}J(!0),await it()},ge=_y.find(ee=>ee.id===D)||_y[0];return t==="role-selection"?n.jsxs("div",{className:"h-dvh flex flex-col items-center justify-center p-6 pt-safe bg-black relative overflow-hidden",dir:"rtl",children:[n.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-red-600/10 rounded-full blur-[100px] pointer-events-none"}),n.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"}),n.jsxs("div",{className:"w-full max-w-sm space-y-8 relative z-10",children:[n.jsxs("div",{className:"text-center space-y-2",children:[n.jsx("h1",{className:"text-3xl font-black text-white",children:"  "}),n.jsx("p",{className:"text-gray-400 text-sm",children:"   "})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("button",{onClick:()=>Re("customer"),className:"w-full group bg-[#1e293b] hover:bg-[#253347] border border-gray-700/50 hover:border-cyan-500/50 p-4 rounded-2xl flex items-center justify-between transition-all duration-300 shadow-lg hover:shadow-cyan-900/20 active:scale-95",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-cyan-500/10 flex items-center justify-center group-hover:bg-cyan-500/20 transition-colors",children:n.jsx(dt,{className:"w-6 h-6 text-cyan-400"})}),n.jsxs("div",{className:"text-right",children:[n.jsx("h3",{className:"font-bold text-white text-lg group-hover:text-cyan-400 transition-colors",children:""}),n.jsx("p",{className:"text-xs text-gray-500",children:" "})]})]}),n.jsx(kr,{className:"w-5 h-5 text-gray-600 group-hover:text-cyan-400 rotate-180 transition-colors"})]}),n.jsxs("button",{onClick:()=>Re("driver"),className:"w-full group bg-[#1e293b] hover:bg-[#253347] border border-gray-700/50 hover:border-red-500/50 p-4 rounded-2xl flex items-center justify-between transition-all duration-300 shadow-lg hover:shadow-red-900/20 active:scale-95",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-red-500/10 flex items-center justify-center group-hover:bg-red-500/20 transition-colors",children:n.jsx(Ut,{className:"w-6 h-6 text-red-500"})}),n.jsxs("div",{className:"text-right",children:[n.jsx("h3",{className:"font-bold text-white text-lg group-hover:text-red-500 transition-colors",children:" "}),n.jsx("p",{className:"text-xs text-gray-500",children:"  "})]})]}),n.jsx(kr,{className:"w-5 h-5 text-gray-600 group-hover:text-red-500 rotate-180 transition-colors"})]}),n.jsxs("button",{onClick:()=>Re("merchant"),className:"w-full group bg-[#1e293b] hover:bg-[#253347] border border-gray-700/50 hover:border-purple-500/50 p-4 rounded-2xl flex items-center justify-between transition-all duration-300 shadow-lg hover:shadow-purple-900/20 active:scale-95",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-500/10 flex items-center justify-center group-hover:bg-purple-500/20 transition-colors",children:n.jsx(Io,{className:"w-6 h-6 text-purple-400"})}),n.jsxs("div",{className:"text-right",children:[n.jsx("h3",{className:"font-bold text-white text-lg group-hover:text-purple-400 transition-colors",children:" / "}),n.jsx("p",{className:"text-xs text-gray-500",children:"  "})]})]}),n.jsx(kr,{className:"w-5 h-5 text-gray-600 group-hover:text-purple-400 rotate-180 transition-colors"})]})]}),n.jsx("div",{className:"text-center pt-6",children:n.jsxs("button",{onClick:e,className:"text-sm text-gray-500 hover:text-white transition-colors",children:["   ",n.jsx("span",{className:"text-red-500 font-bold hover:underline",children:" "})]})})]})]}):n.jsxs("div",{className:"h-dvh flex flex-col text-white relative bg-black overflow-hidden",dir:"rtl",children:[n.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[n.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-red-600/10 rounded-full blur-[100px]"}),n.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-blue-600/10 rounded-full blur-[100px]"})]}),ne&&n.jsx("div",{className:"fixed inset-0 z-[60] flex items-end sm:items-center justify-center bg-black/80 backdrop-blur-sm animate-fadeIn p-0 sm:p-4",onClick:()=>M(!1),children:n.jsxs("div",{className:"bg-[#1e293b] w-full sm:max-w-lg rounded-t-3xl sm:rounded-3xl border-t sm:border border-gray-700 shadow-2xl overflow-hidden flex flex-col max-h-[80vh]",onClick:ee=>ee.stopPropagation(),children:[n.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-[#0f172a]",children:[n.jsx("h3",{className:"text-lg font-bold text-white",children:"  "}),n.jsx("button",{onClick:()=>M(!1),className:"text-gray-400 hover:text-white p-1 rounded-full hover:bg-gray-800",children:n.jsx(rt,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"p-4 overflow-y-auto bg-[#0f172a]",children:n.jsx("div",{className:"grid grid-cols-2 gap-3",children:_y.map(ee=>n.jsxs("button",{type:"button",onClick:()=>{F(ee.id),M(!1)},className:`flex flex-col items-center justify-center p-3 rounded-xl border transition-all duration-200 ${D===ee.id?"bg-[#1e293b] border-red-500 shadow-lg shadow-red-900/20":"bg-[#1e293b]/50 border-gray-700 hover:bg-[#1e293b]"}`,children:[n.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center mb-2 ${D===ee.id?"bg-red-600 text-white":`${ee.bg} ${ee.color}`}`,children:n.jsx(ee.icon,{className:"w-5 h-5"})}),n.jsx("span",{className:`text-xs font-bold ${D===ee.id?"text-white":"text-gray-400"}`,children:ee.label})]},ee.id))})})]})}),ye&&n.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/90 backdrop-blur-md animate-fadeIn p-4",children:n.jsxs("div",{className:"bg-[#1e293b] p-8 rounded-3xl shadow-2xl flex flex-col items-center text-center max-w-sm border border-gray-700 w-full transform transition-all scale-100",children:[n.jsx("div",{className:"w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mb-6 ring-2 ring-green-500/50 shadow-lg shadow-green-900/20 animate-bounce",children:n.jsx(Xe,{className:"w-10 h-10 text-green-400"})}),n.jsx("h3",{className:"text-2xl font-black text-white mb-2",children:"   !"}),n.jsxs("div",{className:"space-y-3 mb-6 bg-yellow-500/10 p-4 rounded-xl border border-yellow-500/20",children:[n.jsxs("p",{className:"text-gray-300 text-sm font-medium",children:["  ",n.jsx("span",{className:"text-yellow-400 font-bold text-base",children:" "}),"   ."]}),n.jsx("p",{className:"text-gray-400 text-xs",children:"       .   ."})]}),n.jsx("div",{className:"w-full bg-gray-800 h-1.5 rounded-full overflow-hidden mb-2",children:n.jsx("div",{className:"h-full bg-green-500 rounded-full animate-progress",style:{animationDuration:"4s"}})}),n.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"   ..."})]})}),n.jsxs("div",{className:"px-5 pt-safe pb-2 flex-none relative",children:[n.jsx("button",{onClick:()=>r(t==="otp"?"form":"role-selection"),className:"absolute top-safe-offset right-5 p-1 bg-gray-800 rounded-full text-gray-400 hover:text-white transition-colors z-20",style:{top:"calc(var(--safe-area-top) + 1.25rem)"},children:n.jsx(kr,{className:"w-5 h-5"})}),n.jsx("div",{className:"text-center",children:n.jsxs("h1",{className:"text-2xl font-black text-white tracking-tight",children:[t==="otp"?" ":B==="driver"?" ":B==="merchant"?" ":" ",n.jsx("span",{className:"text-red-500",children:"."})]})})]}),n.jsx("div",{className:"flex-1 px-5 flex flex-col relative z-10 min-h-0 pt-2",children:t==="otp"?n.jsxs("div",{className:"flex-1 flex flex-col justify-center animate-fadeIn",children:[n.jsxs("div",{className:"text-center mb-8 space-y-3",children:[n.jsx("div",{className:"w-20 h-20 bg-emerald-500/10 rounded-full flex items-center justify-center mx-auto border border-emerald-500/20",children:n.jsx($s,{className:"w-10 h-10 text-emerald-500"})}),n.jsx("h2",{className:"text-xl font-bold text-white",children:"  "}),n.jsxs("p",{className:"text-gray-400 text-sm leading-relaxed",children:["    6    ",n.jsx("br",{}),n.jsx("span",{className:"text-white font-mono dir-ltr",children:N})]})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"relative group",children:[n.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-3 text-emerald-500",children:n.jsx(Xe,{className:"w-5 h-5"})}),n.jsx("input",{type:"tel",value:d,onChange:ee=>h(ee.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"w-full bg-[#1F2937]/50 border border-gray-700 rounded-xl py-4 pl-10 pr-4 text-center text-2xl font-black text-white tracking-[0.5em] placeholder-gray-600 focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500 outline-none transition-all",maxLength:6})]}),X&&n.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3 flex items-center justify-center",children:n.jsx("p",{className:"text-red-400 text-xs font-bold",children:X})}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("button",{onClick:()=>ke(),disabled:se||d.length<6,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-emerald-900/20 active:scale-95 disabled:opacity-50 flex items-center justify-center text-lg",children:se?n.jsx("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"}):" "}),n.jsx("div",{className:"text-center",children:f>0?n.jsxs("p",{className:"text-xs text-gray-500",children:["    ",n.jsx("span",{className:"text-emerald-500 font-bold",children:f})," "]}):n.jsx("button",{type:"button",onClick:it,className:"text-xs text-emerald-500 font-bold hover:underline",children:"   "})})]})]})]}):n.jsx("form",{onSubmit:et,className:"flex-1 flex flex-col h-full",children:n.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-hide",children:[n.jsxs("div",{className:"flex justify-center mb-6 mt-4",children:[B==="merchant"?n.jsxs("div",{onClick:()=>{var ee;return!oe&&((ee=Fe.current)==null?void 0:ee.click())},className:`relative w-full h-36 rounded-2xl border border-dashed cursor-pointer overflow-hidden group flex items-center justify-center shadow-lg transition-all ${U?"border-transparent":"border-gray-600 bg-[#1e293b] hover:border-red-500"}`,children:[oe&&n.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:n.jsxs("div",{className:"grid place-items-center",children:[n.jsx("div",{className:"col-start-1 row-start-1 w-20 h-20 border-4 border-blue-400/30 rounded-full animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"}),n.jsx("div",{className:"col-start-1 row-start-1 w-12 h-12 bg-blue-500 rounded-full opacity-75 animate-ping"}),n.jsx("div",{className:"col-start-1 row-start-1 w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center z-10 shadow-lg shadow-blue-500/50",children:n.jsx(gr,{className:"w-6 h-6 text-white animate-bounce"})})]})}),U?n.jsxs(n.Fragment,{children:[n.jsx("img",{src:U,alt:"Store",className:"w-full h-full object-cover opacity-70"}),n.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30",children:n.jsx(Jr,{className:"w-8 h-8 text-white p-1.5 bg-black/50 rounded-full"})})]}):n.jsxs("div",{className:"flex flex-col items-center text-gray-400 group-hover:text-white transition-colors",children:[n.jsx(Jr,{className:"w-8 h-8 mb-2"}),n.jsx("span",{className:"text-xs font-bold",children:"  "})]})]}):n.jsxs("div",{onClick:()=>{var ee;return!oe&&((ee=Fe.current)==null?void 0:ee.click())},className:`w-28 h-28 rounded-full border-2 border-dashed flex items-center justify-center cursor-pointer overflow-hidden relative shadow-lg group hover:border-red-500 transition-all ${U?"border-red-500":"border-gray-600 bg-[#1e293b]"}`,children:[oe&&n.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:n.jsxs("div",{className:"grid place-items-center",children:[n.jsx("div",{className:"col-start-1 row-start-1 w-14 h-14 border-4 border-blue-400/30 rounded-full animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"}),n.jsx("div",{className:"col-start-1 row-start-1 w-8 h-8 bg-blue-500 rounded-full opacity-75 animate-ping"}),n.jsx("div",{className:"col-start-1 row-start-1 w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center z-10 shadow-lg shadow-blue-500/50",children:n.jsx(gr,{className:"w-4 h-4 text-white animate-bounce"})})]})}),U?n.jsx("img",{src:U,className:"w-full h-full object-cover"}):n.jsxs("div",{className:"flex flex-col items-center text-gray-400 group-hover:text-white",children:[n.jsx(Jr,{className:"w-8 h-8 mb-1"}),n.jsx("span",{className:"text-[10px]",children:" "})]}),n.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsx(Jr,{className:"w-6 h-6 text-white"})})]}),n.jsx("input",{ref:Fe,type:"file",accept:"image/*",className:"hidden",onChange:We})]}),n.jsxs("div",{className:"flex flex-col gap-4",children:[n.jsx(Eh,{icon:dt,iconColor:"text-cyan-500",type:"text",value:y,onChange:ee=>v(ee.target.value),placeholder:B==="merchant"?" ":" "}),n.jsx(Eh,{icon:$s,iconColor:"text-emerald-500",type:"tel",value:N,onChange:ee=>E(ee.target.value),placeholder:"  (11 )",maxLength:11,className:"text-right placeholder:text-right",dir:"rtl"}),B!=="driver"&&n.jsxs(n.Fragment,{children:[n.jsx(Eh,{icon:pn,iconColor:"text-rose-500",type:"text",value:C,onChange:ee=>P(ee.target.value),placeholder:" "}),n.jsx(Eh,{icon:Ey,iconColor:"text-purple-500",type:"email",value:Z,onChange:ee=>Y(ee.target.value),placeholder:"  ()"})]}),B==="driver"&&n.jsx(Eh,{icon:Ey,iconColor:"text-purple-500",type:"email",value:Z,onChange:ee=>Y(ee.target.value),placeholder:"  ()"}),B==="merchant"&&n.jsxs("div",{className:"flex flex-col gap-3 bg-[#1e293b]/50 p-3 rounded-xl border border-gray-700/50",children:[n.jsxs("button",{type:"button",onClick:()=>M(!0),className:"bg-[#0f172a] border border-gray-700 rounded-xl py-3.5 px-4 text-white flex justify-between items-center text-sm hover:border-gray-500 transition-colors w-full",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(ge.icon,{className:`w-4 h-4 ${ge.color}`}),n.jsx("span",{children:ge.label})]}),n.jsx(U0,{className:"w-4 h-4 text-gray-500"})]}),D==="other"&&n.jsx("input",{type:"text",value:S,onChange:ee=>ae(ee.target.value),placeholder:"  ...",className:"bg-[#0f172a] border border-gray-700 rounded-xl py-3 px-4 text-sm text-white outline-none focus:border-red-500 w-full"}),n.jsxs("div",{className:"flex items-center gap-2 bg-[#0f172a] border border-gray-700 rounded-xl px-3 py-2",children:[n.jsx(xt,{className:"w-4 h-4 text-orange-500 flex-shrink-0"}),n.jsx("span",{className:"text-xs text-gray-400",children:" :"}),n.jsx("input",{type:"time",value:K,onChange:ee=>k(ee.target.value),className:"bg-transparent text-white text-xs flex-1 text-center outline-none"}),n.jsx("span",{className:"text-gray-500",children:"-"}),n.jsx("input",{type:"time",value:q,onChange:ee=>W(ee.target.value),className:"bg-transparent text-white text-xs flex-1 text-center outline-none"})]})]}),n.jsxs("div",{className:"relative group",children:[n.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-3 z-20 text-gray-500",children:n.jsx("button",{type:"button",onClick:()=>V(!R),children:R?n.jsx(wi,{className:"w-5 h-5"}):n.jsx(na,{className:"w-5 h-5"})})}),n.jsx("input",{type:R?"text":"password",value:I,onChange:ee=>T(ee.target.value),placeholder:"  (6   )",className:"w-full bg-[#1F2937]/50 border border-gray-700 rounded-xl py-3.5 pl-4 pr-4 text-sm text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all"})]}),n.jsxs("div",{className:"relative group",children:[n.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-3 z-20 text-gray-500",children:n.jsx("button",{type:"button",onClick:()=>V(!R),children:R?n.jsx(wi,{className:"w-5 h-5"}):n.jsx(na,{className:"w-5 h-5"})})}),n.jsx("input",{type:R?"text":"password",value:L,onChange:ee=>$(ee.target.value),placeholder:"  ",className:"w-full bg-[#1F2937]/50 border border-gray-700 rounded-xl py-3.5 pl-4 pr-4 text-sm text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all"})]}),X&&n.jsx("div",{className:"mt-2 text-center",children:n.jsx("p",{className:"text-red-500 text-xs font-bold",children:X})})]}),n.jsxs("div",{className:"pt-8 pb-10",children:[n.jsx("button",{type:"submit",disabled:se,className:"w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3.5 rounded-xl transition-all shadow-lg active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center text-base",children:se?n.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):" "}),n.jsx("div",{className:"text-center mt-4",children:n.jsxs("button",{type:"button",onClick:e,className:"text-xs text-gray-500 hover:text-white transition-colors",children:["   ",n.jsx("span",{className:"text-red-500 font-bold hover:underline",children:" "})]})})]})]})})}),n.jsx("div",{id:"recaptcha-container"})]})},Z$=({message:s,type:e,onClose:t})=>{const r=w.useRef(t);w.useEffect(()=>{r.current=t},[t]),w.useEffect(()=>{const d=setTimeout(()=>{r.current()},4e3);return()=>clearTimeout(d)},[]);const l=(()=>{const d=(s==null?void 0:s.toLowerCase())||"";return d.includes(" ")||d.includes("new order")||d.includes("")?{icon:n.jsx(xn,{className:"h-5 w-5 text-amber-900"}),bgClass:"bg-gradient-to-r from-amber-200 via-yellow-400 to-amber-500",textClass:"text-amber-950",borderClass:"border-amber-300/50",shadowClass:"shadow-[0_8px_30px_rgb(251,191,36,0.4)]",glowClass:"bg-yellow-400",title:" "}:d.includes(" ")||d.includes("preparing")?{icon:n.jsx(Lr,{className:"h-5 w-5 text-indigo-100"}),bgClass:"bg-gradient-to-r from-indigo-500 via-purple-500 to-purple-600",textClass:"text-white",borderClass:"border-indigo-400/50",shadowClass:"shadow-[0_8px_30px_rgb(99,102,241,0.4)]",glowClass:"bg-indigo-400",title:" "}:d.includes("")||d.includes("admin")||d.includes("")?{icon:n.jsx(Dr,{className:"h-5 w-5 text-rose-100"}),bgClass:"bg-gradient-to-r from-rose-500 via-red-500 to-red-600",textClass:"text-white",borderClass:"border-rose-400/50",shadowClass:"shadow-[0_8px_30px_rgb(244,63,94,0.4)]",glowClass:"bg-rose-400",title:" "}:d.includes("")||d.includes("")||d.includes("transit")?{icon:n.jsx(Ut,{className:"h-5 w-5 text-cyan-900"}),bgClass:"bg-gradient-to-r from-cyan-300 via-sky-400 to-blue-500",textClass:"text-cyan-950",borderClass:"border-cyan-300/50",shadowClass:"shadow-[0_8px_30px_rgb(34,211,238,0.4)]",glowClass:"bg-cyan-400",title:" "}:e==="success"?{icon:n.jsx(Xe,{className:"h-5 w-5 text-emerald-900"}),bgClass:"bg-gradient-to-r from-emerald-300 via-green-400 to-green-500",textClass:"text-emerald-950",borderClass:"border-emerald-300/50",shadowClass:"shadow-[0_8px_30px_rgb(52,211,153,0.4)]",glowClass:"bg-emerald-400",title:" "}:e==="error"?{icon:n.jsx(rt,{className:"h-5 w-5 text-white"}),bgClass:"bg-gradient-to-r from-red-500 to-red-700",textClass:"text-white",borderClass:"border-red-400/50",shadowClass:"shadow-[0_8px_30px_rgb(239,68,68,0.4)]",glowClass:"bg-red-500",title:""}:{icon:n.jsx(Tn,{className:"h-5 w-5 text-white"}),bgClass:"bg-[#1a1a1a]/90 backdrop-blur-xl",textClass:"text-white",borderClass:"border-white/10",shadowClass:"shadow-2xl",glowClass:"bg-white",title:""}})();return n.jsxs("div",{dir:"rtl",className:"fixed top-6 left-0 right-0 mx-auto z-[9999] w-fit max-w-[92%] min-w-[320px] sm:min-w-[350px] animate-fadeInDown",children:[n.jsx("style",{children:`
                @keyframes fadeInDown {
                    from { opacity: 0; transform: translateY(-20px); }
                    to { opacity: 1; transform: translateY(0); }
                }
                .animate-fadeInDown {
                    animation: fadeInDown 0.3s ease-out forwards;
                }
            `}),n.jsxs("div",{className:`
                relative flex items-center justify-between gap-4 p-1.5 pr-2 rounded-full 
                ${l.bgClass} ${l.borderClass} border ${l.shadowClass}
                shadow-2xl cursor-pointer
            `,onClick:t,children:[n.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[n.jsx("div",{className:"relative flex-shrink-0",children:n.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center bg-white/20 backdrop-blur-sm shadow-inner",children:l.icon})}),n.jsxs("div",{className:`flex flex-col ${l.textClass}`,children:[n.jsx("span",{className:"text-[10px] font-black uppercase tracking-wider opacity-80 leading-none mb-0.5",children:l.title}),n.jsx("span",{className:"text-sm font-bold leading-tight line-clamp-2",children:s})]})]}),n.jsx("button",{onClick:d=>{d.stopPropagation(),t()},className:`
                        w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0
                        bg-black/10 hover:bg-black/20 transition-colors backdrop-blur-sm
                        ${l.textClass}
                    `,children:n.jsx(rt,{className:"h-4 w-4"})})]}),n.jsx("div",{className:"absolute bottom-1 left-4 right-4 h-0.5 bg-white/20 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-white/80 animate-progress origin-left",style:{animationDuration:"4s"}})}),n.jsx("style",{children:`
                @keyframes progress {
                    from { transform: scaleX(1); }
                    to { transform: scaleX(0); }
                }
                .animate-progress {
                    animation: progress linear forwards;
                }
            `})]})},eq=()=>{w.useEffect(()=>{const e=setInterval(()=>{navigator.onLine&&(clearInterval(e),window.AndroidSplash&&window.AndroidSplash.showSplash&&window.AndroidSplash.showSplash(),setTimeout(()=>{window.location.reload()},500))},2e3),t=()=>{window.AndroidSplash&&window.AndroidSplash.showSplash&&window.AndroidSplash.showSplash(),setTimeout(()=>{window.location.reload()},300)};return window.addEventListener("online",t),()=>{clearInterval(e),window.removeEventListener("online",t)}},[]);const s=()=>{navigator.onLine&&(window.AndroidSplash&&window.AndroidSplash.showSplash&&window.AndroidSplash.showSplash(),window.location.reload())};return n.jsxs("div",{dir:"rtl",className:"fixed inset-0 z-[9999] bg-[#0f172a] flex flex-col items-center justify-center p-6 pt-safe text-white overflow-hidden font-sans",children:[n.jsx("style",{children:`
        @keyframes ripple {
          0% { transform: scale(0.8); opacity: 1; }
          100% { transform: scale(2.4); opacity: 0; }
        }
        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .ripple-container {
            position: relative;
            width: 140px;
            height: 140px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .ripple-circle {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 2px solid rgba(239, 68, 68, 0.5); /* Red-500 */
            animation: ripple 2s infinite cubic-bezier(0, 0.2, 0.8, 1);
        }
        .ripple-circle:nth-child(2) { animation-delay: -0.5s; }
        .ripple-circle:nth-child(3) { animation-delay: -1s; }
        
        .wifi-icon-container {
            animation: floating 3s ease-in-out infinite;
        }
      `}),n.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-[#0f172a] via-[#1e293b] to-[#0f172a] pointer-events-none"}),n.jsx("div",{className:"absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] pointer-events-none"}),n.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center max-w-sm w-full",children:[n.jsxs("div",{className:"mb-10 ripple-container",children:[n.jsx("div",{className:"ripple-circle"}),n.jsx("div",{className:"ripple-circle"}),n.jsx("div",{className:"ripple-circle"}),n.jsx("div",{className:"w-24 h-24 bg-[#1e293b] rounded-full flex items-center justify-center border-4 border-[#334155] shadow-2xl z-10 wifi-icon-container",children:n.jsx(M3,{className:"w-12 h-12 text-red-500 drop-shadow-[0_0_10px_rgba(239,68,68,0.5)]"})})]}),n.jsx("h1",{className:"text-4xl font-black mb-2 tracking-tight text-white drop-shadow-lg",children:" "}),n.jsx("p",{className:"text-red-400 font-bold text-lg mb-6 uppercase tracking-widest opacity-90",children:"No Internet Connection"}),n.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-10 max-w-[280px] mx-auto border-t border-gray-700/50 pt-6",children:"  .         .       ."}),n.jsxs("button",{onClick:s,className:"group relative w-full overflow-hidden rounded-2xl bg-red-600 p-[2px] focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-2 focus:ring-offset-slate-900",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600 via-orange-500 to-red-600 opacity-100 transition-opacity duration-500 group-hover:opacity-100"}),n.jsxs("div",{className:"relative flex items-center justify-center gap-3 rounded-2xl bg-[#0f172a] px-8 py-4 transition-all duration-200 group-hover:bg-transparent group-hover:text-white",children:[n.jsx(ef,{className:`w-5 h-5 ${navigator.onLine?"animate-spin":""} text-red-500 group-hover:text-white transition-colors`}),n.jsx("span",{className:"font-bold text-lg text-white",children:" "})]})]}),n.jsxs("div",{className:"mt-12 flex flex-col items-center gap-2 opacity-30 hover:opacity-100 transition-opacity duration-500",children:[n.jsx("div",{className:"h-1 w-12 bg-gray-500 rounded-full mb-2"}),n.jsx("p",{className:"text-[10px] uppercase font-mono tracking-[0.2em] text-gray-500",children:"System Offline Mode"})]})]})]})},rS=({config:s,onDismiss:e})=>{const[t,r]=w.useState(!1),[i,l]=w.useState(0),[d,h]=w.useState(""),[f,m]=w.useState(!1),[b,y]=w.useState([]),v=I=>{y(T=>[...T.slice(-4),I]),console.log(`[UpdateScreen] ${I}`)},N=async()=>{if(!s.url){v("Error: No URL provided"),h(":   ");return}r(!0),l(0),v("Starting update process...");try{let I=s.url;if(s.url.startsWith("FIRESTORE_FILE:")){h("   ..."),v("Fetching firestore chunks...");const $=s.url.split(":")[1];I=await Dp($),l(30),h(" !  ..."),v("Firestore file assembled.")}const T=window.Android,L=typeof T<"u"&&typeof T.downloadAndInstallApk=="function";if(L&&s.type==="apk"){v("Using Native Android Installer"),h("  ...");const $=setInterval(()=>{l(Q=>Q>=90?(clearInterval($),90):Q+10)},400),B=`GOO_NOW_v${s.version}.apk`;setTimeout(()=>{try{v(`Invoking native: ${B}`),T.downloadAndInstallApk(I,B),clearInterval($),l(100),h("   !"),v("Native intent sent.")}catch(Q){v(`Native Error: ${Q}`),console.error("Native Install Error",Q),E(I,B)}},500)}else v("Native bridge missing or not APK. Using Browser."),E(I,`GOO_NOW_v${s.version}.apk`);setTimeout(()=>{L||r(!1)},5e3)}catch(I){v(`Update Failed: ${I}`),console.error("Update failed:",I),h("  "),setTimeout(()=>r(!1),2e3)}},E=(I,T)=>{h("   ...");const L=document.createElement("a");L.href=I,L.target="_blank",L.download=T,document.body.appendChild(L),L.click(),document.body.removeChild(L),l(100),h("   !")};return n.jsxs("div",{className:"fixed inset-0 z-[200] bg-[#0f172a] flex flex-col items-center justify-center p-6 animate-fadeIn font-sans text-white overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-blue-600/10 rounded-full blur-[120px] pointer-events-none -translate-y-1/2 translate-x-1/2"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-[500px] h-[500px] bg-purple-600/10 rounded-full blur-[120px] pointer-events-none translate-y-1/2 -translate-x-1/2"}),n.jsxs("div",{className:"relative z-10 w-full max-w-sm text-center",children:[n.jsxs("div",{className:"relative mb-8 flex justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-blue-500 rounded-full blur-2xl opacity-20 animate-pulse"}),n.jsxs("div",{className:"w-24 h-24 bg-[#1e293b] rounded-[1.5rem] flex items-center justify-center border-4 border-gray-700 shadow-2xl relative z-10 animate-bounce-slow overflow-hidden",children:[f?n.jsx("div",{className:"flex flex-col items-center justify-center bg-gradient-to-br from-blue-900 to-slate-900 w-full h-full",children:n.jsx(Ft,{className:"w-10 h-10 text-blue-400 mb-1"})}):n.jsx("img",{src:"file:///android_asset/app-icon.png",alt:"GOO NOW",className:"w-full h-full object-cover",onError:I=>{const T=I.target;T.src.includes("file:///android_asset")?T.src="/app-icon.png":m(!0)}}),n.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 w-6 h-6 rounded-full flex items-center justify-center border-2 border-[#0f172a] animate-ping"}),n.jsx("div",{className:"absolute -top-1 -right-1 bg-red-600 w-6 h-6 rounded-full flex items-center justify-center border-2 border-[#0f172a] text-[10px] font-bold shadow-lg",children:"!"})]})]}),n.jsxs("div",{className:"bg-[#1e293b]/90 backdrop-blur-xl border border-white/10 rounded-2xl p-6 shadow-2xl animate-slide-up",children:[n.jsxs("div",{className:"inline-flex items-center gap-2 bg-blue-500/10 border border-blue-500/20 px-3 py-1 rounded-full mb-4",children:[n.jsx(tq,{className:"w-3 h-3 text-blue-400 animate-spin-slow"}),n.jsx("span",{className:"text-[10px] font-bold text-blue-300 tracking-wider uppercase",children:"Update Available"})]}),n.jsxs("h2",{className:"text-2xl font-black mb-2 text-white",children:[" ",s.version]}),n.jsx("p",{className:"text-gray-400 text-xs leading-relaxed mb-6",children:s.notes||"         ."}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("button",{onClick:N,disabled:t,className:`group relative w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-6 rounded-xl shadow-lg shadow-blue-600/20 active:scale-95 transition-all overflow-hidden ${t?"cursor-wait opacity-80":""}`,children:[n.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),n.jsx("div",{className:"relative flex flex-col items-center justify-center gap-1",children:t?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"w-full flex items-center justify-between text-xs mb-1 px-1",children:[n.jsx("span",{className:"text-blue-100 opacity-80",children:d}),n.jsxs("span",{className:"font-bold",children:[i,"%"]})]}),n.jsx("div",{className:"w-full bg-black/20 rounded-full h-1.5 overflow-hidden",children:n.jsx("div",{className:"bg-white h-full rounded-full transition-all duration-300 ease-out",style:{width:`${i}%`}})})]}):n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx(z3,{className:"w-5 h-5"}),n.jsx("span",{className:"text-sm",children:" "})]})})]}),!t&&n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:e,className:"flex-1 bg-transparent hover:bg-white/5 text-gray-500 hover:text-gray-300 font-medium py-3 rounded-xl transition-colors text-xs border border-white/5",children:" "}),n.jsx("a",{href:s.url,target:"_blank",className:"px-4 py-3 bg-white/5 hover:bg-white/10 text-gray-400 hover:text-white rounded-xl transition-colors border border-white/5 flex items-center justify-center",title:"  (  )",download:!0,children:n.jsx(a0,{className:"w-4 h-4"})})]})]})]}),b.length>0&&n.jsx("div",{className:"mt-4 p-2 bg-black/50 rounded text-[10px] text-left font-mono text-gray-400 w-full overflow-hidden",children:b.map((I,T)=>n.jsx("div",{children:I},T))}),n.jsx("div",{className:"mt-8 text-xs text-gray-600 font-mono",children:"GOO NOW UPDATE CENTER"})]})]})},tq=({className:s})=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:n.jsx("path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"})}),sq="GOO_NOW_DB",bo="app_data",nq=1;let zg=null;const Ty=()=>zg||(zg=new Promise((s,e)=>{const t=indexedDB.open(sq,nq);t.onupgradeneeded=r=>{const i=r.target.result;i.objectStoreNames.contains(bo)||i.createObjectStore(bo)},t.onsuccess=r=>{s(r.target.result)},t.onerror=r=>{console.error("IndexedDB Error:",r.target.error),e(r.target.error)}}),zg),cr={get:async(s,e)=>{try{const t=await Ty();return new Promise(r=>{const d=t.transaction(bo,"readonly").objectStore(bo).get(s);d.onsuccess=()=>{const h=d.result;r(h===void 0?e:h)},d.onerror=()=>{console.warn(`Failed to read ${s}, using default.`),r(e)}})}catch(t){return console.error("Storage Get Error:",t),e}},set:async(s,e)=>{try{const t=await Ty();return new Promise((r,i)=>{const h=t.transaction(bo,"readwrite").objectStore(bo).put(e,s);h.onsuccess=()=>r(),h.onerror=()=>i(h.error)})}catch(t){console.error("Storage Set Error:",t)}},remove:async s=>{try{const e=await Ty();return new Promise((t,r)=>{const d=e.transaction(bo,"readwrite").objectStore(bo).delete(s);d.onsuccess=()=>t(),d.onerror=()=>r(d.error)})}catch(e){console.error("Storage Remove Error:",e)}}},El={get:(s,e)=>{try{return JSON.parse(localStorage.getItem(s)||"null")||e}catch{return e}},set:(s,e)=>{try{localStorage.setItem(s,JSON.stringify(e))}catch{console.error("LocalStorage Quota Exceeded for "+s)}},remove:s=>localStorage.removeItem(s)},Bk={apiKey:"AIzaSyC4bv_RLpS-jxunMs7nWjux806bYk6XnVY",authDomain:"goo-now-1ce44.firebaseapp.com",databaseURL:"https://goo-now-1ce44-default-rtdb.firebaseio.com",projectId:"goo-now-1ce44",storageBucket:"goo-now-1ce44.firebasestorage.app",messagingSenderId:"742306376566",appId:"1:742306376566:android:9298a84980b239e528a857"},rq=()=>{try{const s=localStorage.getItem("firebase_config");if(s){const e=JSON.parse(s);if(e&&e.apiKey&&e.projectId)return e}}catch(s){console.warn("Failed to load custom firebase config, using default.",s)}return Bk};typeof document<"u"&&document.addEventListener("visibilitychange",()=>{if(document.visibilityState==="visible"){const s=new Date().toISOString();console.log(`[InstantSync] App Resumed at ${s} - Forcing Sync...`)}});Ik(rq());const aq=s=>{const[e,t]=w.useState([]),[r,i]=w.useState([]),[l,d]=w.useState([]),[h,f]=w.useState([]),[m,b]=w.useState([]),[y,v]=w.useState([]),[N,E]=w.useState([]),[I,T]=w.useState({isEnabled:!0}),[L,$]=w.useState({pointsPerCurrency:1,currencyPerPoint:.1,isPointsEnabled:!0}),[B,Q]=w.useState(()=>El.get("app_config_cache",{appName:"GOO NOW",appVersion:"VERSION 1.0.5"})),[Z,Y]=w.useState(null),[C,P]=w.useState(!1),[U,O]=w.useState(!0),D=w.useRef(0),[F,S]=w.useState(()=>El.get("currentUser",null)),[ae,K]=w.useState(()=>El.get("app_theme",{driver:{icons:{}},merchant:{icons:{}},admin:{mode:"dark"},customer:{icons:{},mode:"dark"}})),[k,q]=w.useState(!1);return w.useEffect(()=>{(async()=>{const[ne,M,R,V]=await Promise.all([cr.get("cache_users",[]),cr.get("cache_orders",[]),cr.get("cache_messages",[]),cr.get("cache_slider",[])]);ne.length&&t(ne),M.length&&(i(M),q(!0)),R.length&&d(R),V.length&&f(V),ne.length>0&&O(!1)})()},[]),w.useEffect(()=>{const W="custom-app-font";let ne=document.getElementById(W);B.customFont?(ne||(ne=document.createElement("style"),ne.id=W,document.head.appendChild(ne)),ne.innerHTML=`
                @font-face {
                    font-family: 'AppCustomFont';
                    src: url('${B.customFont}') format('truetype');
                    font-weight: normal;
                    font-style: normal;
                }
                :root, body, html, * {
                    font-family: 'AppCustomFont', 'Cairo', sans-serif !important;
                }
                input, textarea, select, button, h1, h2, h3, h4, h5, h6, span, p, div, a {
                    font-family: 'AppCustomFont', 'Cairo', sans-serif !important;
                }
            `):ne&&ne.remove()},[B.customFont]),w.useEffect(()=>{const W=Hs("users",J=>{if(t(J),cr.set("cache_users",J),O(!1),F){const oe=J.find(je=>je.id===F.id);if(oe&&oe.status==="blocked"){S(null),El.remove("currentUser"),ud(),s("      .     .","error");return}oe&&i0(oe)!==i0(F)&&(S(oe),El.set("currentUser",Ha(oe)))}});let ne=()=>{};if(!F)ne=Hs("orders",J=>{i(J),cr.set("cache_orders",J),q(!0)});else if(F.role==="admin"||F.role==="supervisor")ne=Hs("orders",J=>{i(J),cr.set("cache_orders",J),q(!0)});else if(F.role==="merchant")ne=Lh("orders",[{field:"merchantId",op:"==",value:F.id}],J=>{i(J),cr.set("cache_orders",J),q(!0)});else if(F.role==="user"||F.role==="customer")ne=Lh("orders",[{field:"customer.phone",op:"==",value:F.phone}],J=>{i(J),cr.set("cache_orders",J),q(!0)});else if(F.role==="driver"){i([]),cr.set("cache_orders",[]);const J=new Map,oe=new Map,je=()=>{const Fe=[...Array.from(J.values()),...Array.from(oe.values())],Re=Array.from(new Map(Fe.map(lt=>[lt.id,lt])).values());i(Re),cr.set("cache_orders",Re),q(!0),Re.length>D.current&&D.current!==0&&console.log("[InstantSync]  New Order Detected!"),D.current=Re.length},ye=Lh("orders",[{field:"status",op:"==",value:ce.Pending}],Fe=>{J.clear(),Fe.forEach(Re=>J.set(Re.id,Re)),je()}),Pe=Lh("orders",[{field:"driverId",op:"==",value:F.id}],Fe=>{oe.clear(),Fe.forEach(Re=>oe.set(Re.id,Re)),je()});ne=()=>{ye(),Pe()}}else i([]),q(!0);const M=Hs("messages",J=>{d(J),cr.set("cache_messages",J)}),R=Hs("payments",J=>v(J)),V=Hs("reset_requests",J=>b(J)),X=Hs("slider_images",J=>{f(J),cr.set("cache_slider",J)}),H=Hs("audit_logs",J=>E(J)),se=Hs("settings",J=>{var Fe;const oe=J.find(Re=>Re.id==="slider_config");T(oe||{isEnabled:!0});const je=J.find(Re=>Re.id==="points_config");je&&$(Re=>({pointsPerCurrency:je.pointsPerCurrency??1,currencyPerPoint:je.currencyPerPoint??.1,isPointsEnabled:je.isPointsEnabled??!0}));const ye=J.find(Re=>Re.id==="app_config");if(ye){const Re={appName:ye.appName||"GOO NOW",appVersion:ye.appVersion||"VERSION 1.0.5",customFont:ye.customFont,games:ye.games||[],isGamesEnabled:ye.isGamesEnabled};Q(Re),El.set("app_config_cache",Re)}const Pe=J.find(Re=>Re.id==="app_update");if(Pe){const Re=Pe;Y(Re);const lt="2.0.0",We=`
  :

  : ${lt}
  : ${Re.version}

  : ${Re.isActive?"":""}
  : ${Re.forceUpdate?"":""}

  : ${((Fe=Re.target_roles)==null?void 0:Fe.join(", "))||""}
  : ${(F==null?void 0:F.role)||" "}
                `.trim();if(console.log("[UPDATE CHECK]",We),Re.isActive&&Re.version!==lt){if(Re.target_roles&&Array.isArray(Re.target_roles)&&Re.target_roles.length>0){const _e=F==null?void 0:F.role;if(!_e||!Re.target_roles.includes(_e)){console.log("[UPDATE CHECK]  User role not in target roles. Skipping update.");return}}const it=Re.version.toLowerCase().replace(/[^0-9.]/g,""),ke=lt.toLowerCase().replace(/[^0-9.]/g,""),et=it.split(".").map(Number),ge=ke.split(".").map(Number);let ee=!1;const fe=Math.max(et.length,ge.length);for(let _e=0;_e<fe;_e++){const Me=et[_e]||0,st=ge[_e]||0;if(Me>st){ee=!0;break}if(Me<st){ee=!1;break}}if(ee||Re.forceUpdate&&Re.version===lt){const _e=localStorage.getItem("skipped_update_version");console.log("[UPDATE CHECK] Skipped version in storage:",_e),Re.forceUpdate||_e!==Re.version?(console.log("[UPDATE CHECK]  SHOWING UPDATE SCREEN"),P(!0)):console.log("[UPDATE CHECK]  User already skipped this version")}else console.log("[UPDATE CHECK]  Remote version is not newer")}else Re.isActive&&Re.forceUpdate&&Re.version===lt?(console.log("[UPDATE CHECK]  Force update for same version - SHOWING UPDATE SCREEN"),P(!0)):console.log("[UPDATE CHECK]  Update not active or version matches")}});return()=>{W(),ne(),M(),R(),V(),X(),se(),H()}},[F==null?void 0:F.id,F==null?void 0:F.role,B.appVersion]),w.useEffect(()=>{F&&If(F.role,F.id)},[F==null?void 0:F.id]),w.useEffect(()=>{const W=setTimeout(()=>{U&&(console.warn("Loading timeout reached."),O(!1))},3e4);return()=>clearTimeout(W)},[U]),{users:e,orders:r,messages:l,payments:y,sliderImages:h,auditLogs:N,passwordResetRequests:m,sliderConfig:I,pointsConfig:L,appConfig:B,updateConfig:Z,showUpdate:C,setShowUpdate:P,isLoading:U,setIsLoading:O,isOrdersLoaded:k,currentUser:F,setCurrentUser:S,appTheme:ae,setAppTheme:K,setOrders:i,setUsers:t}},iq=({users:s,orders:e,messages:t,currentUser:r,showNotify:i})=>{const l=v=>{const N=v.reduce((E,I)=>{const T=parseInt(I.id);return isNaN(T)?E:Math.max(E,T)},0);return String(N+1)},d=(v,N,E)=>{if(!r)return;const I={id:`LOG-${Date.now()}-${Math.floor(Math.random()*1e3)}`,actorId:r.id,actorName:r.name,actionType:v,target:N,details:E,createdAt:new Date};at("audit_logs",I.id,I)};return{logAction:d,handleDriverPayment:async v=>{const N=s.find(O=>O.id===v);if(!N)return;const E=e.filter(O=>String(O.driverId)===String(v)&&O.status===ce.Delivered&&!O.reconciled);if(E.length===0){i("   ","info");return}const I=O=>Math.round((O+Number.EPSILON)*100)/100,T=O=>typeof O=="number"?O:typeof O=="string"&&parseFloat(O)||0,L=E.reduce((O,D)=>O+T(D.deliveryFee),0);let $=0;const B=T(N.commissionRate);N.commissionType==="fixed"?$=E.length*B:$=L*(B/100);const Q=I($),Z=I(L);let Y=new Date;const C=[...E].sort((O,D)=>{const F=O.deliveredAt?new Date(O.deliveredAt).getTime():0;return(D.deliveredAt?new Date(D.deliveredAt).getTime():0)-F});if(C.length>0&&C[0].deliveredAt){const O=new Date(C[0].deliveredAt),D=new Date,F=D.getDate()!==O.getDate()||D.getMonth()!==O.getMonth(),S=D.getHours()<6;F&&S&&(Y=new Date(O.getFullYear(),O.getMonth(),O.getDate(),23,59,59))}const P=`PAY-${Date.now()}`,U={id:P,driverId:v,amount:Q,totalCollected:Z,ordersCount:E.length,createdAt:Y,reconciledOrderIds:E.map(O=>O.id)};try{const O=E.map(D=>({...D,reconciled:!0}));await Ia("orders",O),await at("payments",P,U),d("financial"," ",`    ${N.name}. : ${Q} .  ${E.length} .`),i(`  ${E.length}  `,"success"),qt("driver",{title:"  ",body:`   .     ${E.length} .`,targetId:v,url:"/?target=wallet"})}catch(O){console.error("Payment Error",O),i("   ","error")}},handleSignUp:async v=>{if(s.find(T=>T.phone===v.phone))return{success:!1,message:"   ."};const E=l(s),I={...v,id:E,status:"pending",createdAt:new Date,pointsBalance:0};I.role==="driver"&&(I.commissionRate=25,I.commissionType="percentage",I.dailyLogMode="always_open");try{await at("users",E,I);const T=`LOG-${Date.now()}`;at("audit_logs",T,{id:T,actorId:E,actorName:I.name,actionType:"create",target:" ",details:`  : ${I.name} (${I.role})`,createdAt:new Date});const L=I.role==="driver"?"":I.role==="merchant"?"":"",$={title:"  ",body:`   : ${I.name} (${L}).  .`,url:"/?target=users"};return await qt("admin",$),{success:!0,message:"   "}}catch{return{success:!1,message:"    "}}},handleHideMessage:async(v,N,E)=>{const I=[...N,v];if(E(I),localStorage.setItem("deleted_msgs",JSON.stringify(I)),r){const T=t.find(L=>L.id===v);if(T){const L=T.deletedBy||[];if(!L.includes(r.id)){const $=[...L,r.id];await at("messages",v,{deletedBy:$})}}}i("  ","success",!0)},handleClearAuditLogs:async v=>{try{const N=v.map(E=>Js("audit_logs",E.id));await Promise.all(N),d("delete","","      "),i("    ","success")}catch(N){console.error("Failed to clear logs:",N),i("   ","error")}},generateNextUserId:l,deletePayment:v=>{Js("payments",v),d("financial","",`     ${v}`)}}},oq=()=>{const[s,e]=w.useState(navigator.onLine),[t,r]=w.useState(!1),[i,l]=w.useState(null),[d,h]=w.useState(()=>{try{const M=localStorage.getItem("deleted_msgs");return M?JSON.parse(M):[]}catch{return[]}}),f=(M,R="info",V=!1)=>{l({message:M,type:R,id:Date.now()}),V||(ys.showNotification("",M),ys.playSound())},{users:m,orders:b,messages:y,payments:v,sliderImages:N,auditLogs:E,passwordResetRequests:I,sliderConfig:T,pointsConfig:L,appConfig:$,updateConfig:B,showUpdate:Q,setShowUpdate:Z,isLoading:Y,currentUser:C,setCurrentUser:P,appTheme:U,setAppTheme:O,setOrders:D,isOrdersLoaded:F}=aq(f),{logAction:S,handleDriverPayment:ae,handleSignUp:K,handleHideMessage:k,handleClearAuditLogs:q,generateNextUserId:W}=iq({users:m,orders:b,messages:y,currentUser:C,showNotify:f});w.useEffect(()=>{window.handleDeepLink=M=>{try{const R=new URL(M,window.location.origin),V=new URLSearchParams(R.search),X=V.get("target"),H=V.get("id");X&&window.dispatchEvent(new CustomEvent("app-navigation",{detail:{target:X,id:H}}))}catch(R){console.error(R)}}},[]),w.useEffect(()=>{const M=()=>e(navigator.onLine);return window.addEventListener("online",M),window.addEventListener("offline",M),()=>{window.removeEventListener("online",M),window.removeEventListener("offline",M)}},[]),w.useEffect(()=>{const M=()=>{const R=document.getElementById("keep-alive-audio");R&&R.play().catch(()=>{console.log("Audio keep-alive waiting for interaction")})};C&&(M(),window.addEventListener("click",M,{once:!0}))},[C]);const ne=(M,R)=>{const V=R?"S-":"ORD-",H=M.filter(se=>se.id.startsWith(V)&&!se.isArchived).reduce((se,J)=>{const oe=J.id.replace(V,""),je=parseInt(oe||"0");return Math.max(se,je)},0);return`${V}${H+1}`};return w.useEffect(()=>{const R=Date.now();return Y?setTimeout(()=>{ys.hideSplashScreen()},4e3):(()=>{const X=Date.now()-R;if(X>=4e3)console.log("[SplashStrategy] 4 seconds elapsed, hiding splash."),ys.hideSplashScreen();else{const H=4e3-X;console.log(`[SplashStrategy] Waiting ${H}ms more before hiding.`),setTimeout(()=>{ys.hideSplashScreen()},H)}})(),()=>{}},[Y]),w.useEffect(()=>{if(C)if(ys.isAndroid())If(C.role,C.id);else{window.Notification&&Notification.permission!=="granted"&&Notification.requestPermission();const M=C.role==="customer"?"user":C.role;let R=`${M}s_v2`;M==="admin"&&(R="admin_v2"),bv(R),C.id&&bv(`${M}_${C.id}_v2`)}},[C]),s?C?n.jsxs("div",{className:"h-full w-full hardware-accelerated relative",children:[Y&&C&&n.jsx("div",{className:"absolute top-4 left-4 z-50 pointer-events-none fade-in",children:n.jsxs("div",{className:"bg-black/80 backdrop-blur-md text-white text-xs px-3 py-1.5 rounded-full flex items-center gap-2 shadow-lg border border-white/10",children:[n.jsx("div",{className:"w-3 h-3 border-2 border-red-500 border-t-transparent rounded-full animate-spin"}),n.jsx("span",{children:" ..."})]})}),i&&n.jsx(Z$,{...i,onClose:()=>l(null)},i.id),Q&&B&&n.jsx(rS,{config:B,onDismiss:()=>{Z(!1)}}),C.role==="admin"&&n.jsx(n$,{user:C,users:m,orders:b,messages:y,payments:v,passwordResetRequests:I,resolvePasswordResetRequest:M=>{Js("reset_requests",M),S("update"," ",`       ${M}`)},updateUser:(M,R)=>{var X,H;at("users",M,R);const V=((X=m.find(se=>se.id===M))==null?void 0:X.name)||M;R.status==="blocked"?S("update","",`   : ${V}`):R.status==="active"&&((H=m.find(se=>se.id===M))==null?void 0:H.status)==="blocked"?S("update","",`    : ${V}`):S("update","",`   : ${V}`)},deleteUser:M=>{var V;const R=((V=m.find(X=>X.id===M))==null?void 0:V.name)||M;Js("users",M),S("delete","",`  : ${R}`)},deleteOrder:M=>{Js("orders",M),S("delete","",`    ${M}`)},updateOrderStatus:(M,R)=>{const V=b.find(H=>H.id===M),X={status:R};R===ce.Delivered&&(X.deliveredAt=new Date),R===ce.Pending&&(X.driverId=null,X.deliveryFee=null),at("orders",M,X),V&&V.driverId&&R!==ce.Pending&&qt("driver",{title:" ",body:` ${M}  ${R}`,targetId:V.driverId,url:`/?target=order&id=${M}`})},editOrder:(M,R)=>{at("orders",M,R),S("update","",`     ${M}`)},assignDriverAndSetStatus:(M,R,V,X)=>{var se;at("orders",M,{driverId:R,deliveryFee:V,status:X});const H=((se=m.find(J=>J.id===R))==null?void 0:se.name)||R;S("update","",`   ${H}  ${M}  ${V}`),qt("driver",{title:"   ",body:`   ${M}   ${V} .`,targetId:R,url:`/?target=order&id=${M}`})},adminAddOrder:async M=>{const R=Array.isArray(M)?M:[M],V=[];R.forEach(H=>{const oe=`ORD-${[...b,...V].filter(je=>je.id.startsWith("ORD-")&&!je.isArchived).reduce((je,ye)=>Math.max(je,parseInt(ye.id.replace("ORD-","")||"0")),0)+1}`;V.push({...H,id:oe,status:ce.Pending,createdAt:new Date,type:"delivery_request"})}),D(H=>[...H,...V]),await Ia("orders",V);const X=V.map(H=>qt("driver",{title:"  ",body:`    #${H.id}   `,url:`/?target=order&id=${H.id}`}));await Promise.all(X),S("create","",`  ${V.length}  `)},adminAddUser:async M=>{const R=W(m);await at("users",R,{...M,id:R,status:"active",createdAt:new Date}),S("create","",`   : ${M.name} (${M.role}) ID: ${R}`)},onLogout:()=>{ud(C.id,C.role),P(null),localStorage.removeItem("currentUser")},sendMessage:M=>{let R=y.reduce((X,H)=>{const se=parseInt(H.id);return isNaN(se)?X:Math.max(X,se)},0);const V=M.targetIds.map((X,H)=>(R++,{...M,id:String(R),targetId:X,createdAt:new Date,readBy:[]}));Ia("messages",V),M.targetIds.forEach((X,H)=>{setTimeout(()=>{const se=X!=="all"&&X!=="multiple";qt(M.targetRole,{title:"  ",body:M.text.length>50?M.text.substring(0,50)+"...":M.text,targetId:se?X:void 0,url:"/?target=messages"})},H*50)}),S("create","",`    ${M.targetIds.length}    ${M.targetRole}`)},deleteMessage:M=>Js("messages",M),handleDriverPayment:ae,sliderImages:N,sliderConfig:T,onAddSliderImage:M=>{at("slider_images",M.id,M),S("create","","    ")},onDeleteSliderImage:M=>Js("slider_images",M),onUpdateSliderImage:(M,R)=>at("slider_images",M,R),onToggleSlider:M=>at("settings","slider_config",{id:"slider_config",isEnabled:M}),onBulkUpdate:async M=>Ia("orders",M),auditLogs:E,onClearLogs:()=>q(E),promoCodes:[],pointsConfig:L,onUpdatePointsConfig:M=>{at("settings","points_config",{id:"points_config",...M}),S("update","","    ")},onAddPromo:()=>{},onDeletePromo:()=>{},currentTheme:U,onUpdateTheme:(M,R)=>{O(V=>({...V,[M]:R})),El.set("app_theme",{...U,[M]:R})},showNotification:f,appConfig:$,onUpdateAppConfig:M=>{at("settings","app_config",{id:"app_config",...M}),S("update"," ","    ")}}),C.role==="supervisor"&&n.jsx(W$,{user:C,users:m,orders:b,payments:v,passwordResetRequests:I,resolvePasswordResetRequest:M=>{Js("reset_requests",M),S("update"," ",`       ${M}`)},updateUser:(M,R)=>{var X,H;at("users",M,R);const V=((X=m.find(se=>se.id===M))==null?void 0:X.name)||M;R.status==="blocked"?S("update","",`   : ${V}`):R.status==="active"&&((H=m.find(se=>se.id===M))==null?void 0:H.status)==="blocked"?S("update","",`    : ${V}`):S("update","",`    : ${V}`)},deleteUser:M=>{var V;const R=((V=m.find(X=>X.id===M))==null?void 0:V.name)||M;Js("users",M),S("delete","",`   : ${R}`)},deleteOrder:M=>{Js("orders",M),S("delete","",`     ${M}`)},updateOrderStatus:(M,R)=>{const V=b.find(H=>H.id===M),X={status:R};R===ce.Delivered&&(X.deliveredAt=new Date),R===ce.Pending&&(X.driverId=null,X.deliveryFee=null),at("orders",M,X),V&&V.driverId&&R!==ce.Pending&&qt("driver",{title:" ",body:` ${M}  ${R}`,targetId:V.driverId,url:`/?target=order&id=${M}`})},editOrder:(M,R)=>{at("orders",M,R),S("update","",`      ${M}`)},assignDriverAndSetStatus:(M,R,V,X)=>{var se;at("orders",M,{driverId:R,deliveryFee:V,status:X});const H=((se=m.find(J=>J.id===R))==null?void 0:se.name)||R;S("update","",`    ${H}  ${M}  ${V}`),qt("driver",{title:"   ",body:`   ${M}   ${V} .`,targetId:R,url:`/?target=order&id=${M}`})},adminAddOrder:M=>{const R=Array.isArray(M)?M:[M],V=[];R.forEach(X=>{const J=`ORD-${[...b,...V].filter(oe=>oe.id.startsWith("ORD-")&&!oe.isArchived).reduce((oe,je)=>Math.max(oe,parseInt(je.id.replace("ORD-","")||"0")),0)+1}`;V.push({...X,id:J,status:ce.Pending,createdAt:new Date,type:"delivery_request"}),qt("driver",{title:"  ",body:`    #${J}   `,url:`/?target=order&id=${J}`})}),Ia("orders",V),S("create","",`   ${V.length}  `)},adminAddUser:async M=>{const R=W(m);await at("users",R,{...M,id:R,status:"active",createdAt:new Date}),S("create","",`    : ${M.name} (${M.role}) ID: ${R}`)},onLogout:()=>{ud(C.id,C.role),P(null),localStorage.removeItem("currentUser")},onBulkUpdate:async M=>Ia("orders",M),auditLogs:E,promoCodes:[],pointsConfig:L,onUpdatePointsConfig:M=>{at("settings","points_config",{id:"points_config",...M}),S("update","","     ")},onAddPromo:()=>{},onDeletePromo:()=>{},showNotification:f,handleDriverPayment:ae,sliderImages:N,sliderConfig:T,onAddSliderImage:M=>{at("slider_images",M.id,M),S("create","","     ")},onDeleteSliderImage:M=>Js("slider_images",M),onUpdateSliderImage:(M,R)=>at("slider_images",M,R),onToggleSlider:M=>at("settings","slider_config",{id:"slider_config",isEnabled:M}),messages:y,sendMessage:M=>{let R=y.reduce((X,H)=>{const se=parseInt(H.id);return isNaN(se)?X:Math.max(X,se)},0);const V=M.targetIds.map((X,H)=>(R++,{...M,id:String(R),targetId:X,createdAt:new Date,readBy:[]}));Ia("messages",V),M.targetIds.forEach((X,H)=>{setTimeout(()=>{const se=X!=="all"&&X!=="multiple";qt(M.targetRole,{title:"   ",body:M.text.length>50?M.text.substring(0,50)+"...":M.text,targetId:se?X:void 0,url:"/?target=messages"})},H*50)}),S("create","",`     ${M.targetIds.length} `)},deleteMessage:M=>Js("messages",M),appConfig:$}),C.role==="driver"&&n.jsx(_$,{driver:C,users:m,orders:b,messages:y,isLoading:!F,onUpdateOrderStatus:(M,R)=>{const V={status:R};R===ce.Delivered&&(V.deliveredAt=new Date),R===ce.Pending&&(V.driverId=null,V.deliveryFee=null),at("orders",M,V)},onAcceptOrder:(M,R,V)=>{var H;const X=b.find(se=>se.id===M);if(at("orders",M,{driverId:R,deliveryFee:V,status:ce.InTransit}),(X==null?void 0:X.type)==="shopping_order"&&((H=X.customer)!=null&&H.phone)){const se=m.find(J=>J.phone===X.customer.phone&&J.role==="customer");se&&qt("customer",{title:"  ! ",body:`  ${C.name}      `,targetId:se.id,url:"/?target=orders"})}},onUpdateUser:(M,R)=>at("users",M,R),onLogout:()=>{ud(C.id,C.role),P(null),localStorage.removeItem("currentUser")},showNotification:f,seenMessageIds:[],markMessageAsSeen:()=>{},hideMessage:M=>k(M,d,h),deletedMessageIds:d,appTheme:U,appConfig:$}),C.role==="merchant"&&n.jsx(h$,{merchant:C,users:m,orders:b,messages:y,addOrder:async M=>{const R=ne(b,!1),V={...M,id:R,merchantId:C.id,merchantName:C.name,status:ce.Pending,createdAt:new Date,type:"delivery_request"};D(X=>[...X,V]),S("create","",`(Optimistic) adding order ${R}`),await at("orders",R,V),await qt("admin",{title:"   ",body:` ${C.name}    #${R}`,url:"/?target=orders"}),await qt("supervisor",{title:"   ",body:` ${C.name}    #${R}`,url:"/?target=orders"}),await qt("driver",{title:"  ",body:`:   #${R}  `,url:`/?target=order&id=${R}`})},onLogout:()=>{ud(C.id,C.role),P(null),localStorage.removeItem("currentUser")},seenMessageIds:[],markMessageAsSeen:M=>{},hideMessage:M=>{},deletedMessageIds:[],appTheme:U,onUpdateUser:(M,R)=>at("users",M,R),appConfig:$}),C.role==="customer"&&n.jsx(G$,{user:C,merchants:m.filter(M=>M.role==="merchant"),orders:b,messages:y,onPlaceOrder:async M=>{const R=M.type==="shopping_order",V=ne(b,R);await at("orders",V,{...M,id:V}),await qt("admin",{title:R?"   ":"  ",body:`  #${V}  ${M.customer.name}`,url:"/?target=orders"}),await qt("supervisor",{title:R?"   ":"  ",body:`  #${V}  ${M.customer.name}`,url:"/?target=orders"}),await qt("driver",{title:"  ",body:`   #${V}  `,url:`/?target=order&id=${V}`}),!R&&M.merchantId&&M.merchantId},onLogout:()=>{ud(C.id,C.role),P(null),localStorage.removeItem("currentUser")},onDeleteOrder:M=>Js("orders",M),markMessageAsSeen:()=>{},hideMessage:()=>{},seenMessageIds:[],deletedMessageIds:[],onUpdateUser:(M,R)=>at("users",M,R),appTheme:U,promoCodes:[],pointsConfig:L,sliderImages:N,sliderConfig:T,adminUser:m.find(M=>M.role==="admin"),appConfig:$})]}):t?n.jsx(J$,{onSignUp:K,onBackToLogin:()=>r(!1)}):n.jsxs(n.Fragment,{children:[n.jsx(Q$,{appConfig:$,onPasswordLogin:async(M,R)=>{let V=m.find(X=>(X.phone===M||X.id===M)&&X.password===R);if(!V){const X=await Ak(M);if(X.success&&X.data){const H=X.data;if(H.password===R)V=H;else return{success:!1,message:"   "}}else if(X.error==="network_error")return{success:!1,message:"   .    ."}}if(!V&&M==="5"&&R==="5"&&(V={id:"5",name:" ",role:"admin",phone:"5",password:"5",status:"active",createdAt:new Date,specialBadge:"verified",specialFrame:"gold"},at("users","5",V)),V){if(V.status==="blocked")return{success:!1,message:"      .     ."};if(V.status==="pending")return{success:!1,message:"      .     ."};const X=Ha(V);P(X),localStorage.setItem("currentUser",i0(X)),ys.loginSuccess(X);const H=`LOGIN-${Date.now()}`;return at("audit_logs",H,{id:H,actorId:V.id,actorName:V.name,actionType:"login",target:"",details:`    ${V.name} (${V.role})`,createdAt:new Date}),{success:!0,message:""}}return{success:!1,message:"    (   )"}},onGoToSignUp:()=>r(!0),onPasswordResetRequest:async M=>(await at("reset_requests",M,{phone:M,requestedAt:new Date}),await qt("admin",{title:"   ",body:`       ${M}`,url:"/?target=notifications"}),await qt("supervisor",{title:"   ",body:`       ${M}`,url:"/?target=notifications"}),{success:!0,message:"  "})}),Q&&B&&n.jsx(rS,{config:B,onDismiss:()=>{Z(!1)}})]}):n.jsx(eq,{})},zk=()=>ys.handleBackPress();window.handleAndroidBack=zk;window.onBackPressed=zk;document.addEventListener("click",s=>{const e=s.target;(e.closest("button")||e.closest("a")||e.closest(".clickable"))&&navigator.vibrate&&navigator.vibrate(5)},{passive:!0});const $k=document.getElementById("root");if(!$k)throw new Error("Could not find root element to mount to");"serviceWorker"in navigator&&window.addEventListener("load",()=>{window.location.protocol==="blob:"||window.location.protocol==="file:"||navigator.serviceWorker.register("/service-worker.js").then(s=>{const t=(()=>{try{const r=localStorage.getItem("firebase_config");if(r)return JSON.parse(r)}catch{}return Bk})();s.active?s.active.postMessage({type:"FIREBASE_CONFIG",config:t}):s.installing&&s.installing.addEventListener("statechange",r=>{r.target.state==="activated"&&s.active&&s.active.postMessage({type:"FIREBASE_CONFIG",config:t})})}).catch(s=>console.log("[SW] Error:",s))});window.onerror=function(s,e,t,r,i){const l=document.createElement("div");return l.style.position="fixed",l.style.top="0",l.style.left="0",l.style.width="100%",l.style.height="100%",l.style.backgroundColor="#990000",l.style.color="#ffffff",l.style.zIndex="999999",l.style.padding="20px",l.style.overflow="scroll",l.style.fontFamily="monospace",l.style.fontSize="14px",l.style.direction="ltr",l.style.textAlign="left",l.innerHTML=`
        <h2 style="border-bottom: 2px solid white; padding-bottom: 10px;"> APP CRASH </h2>
        <p><strong>Error:</strong> ${s}</p>
        <p><strong>Source:</strong> ${e}</p>
        <p><strong>Line:</strong> ${t}:${r}</p>
        <pre style="background: rgba(0,0,0,0.3); padding: 10px; white-space: pre-wrap;">${(i==null?void 0:i.stack)||"No stack trace"}</pre>
    `,document.body.appendChild(l),!1};window.addEventListener("unhandledrejection",function(s){const e=document.createElement("div");e.style.position="fixed",e.style.bottom="0",e.style.left="0",e.style.width="100%",e.style.height="50%",e.style.backgroundColor="#990000",e.style.color="#ffffff",e.style.zIndex="999999",e.style.padding="20px",e.style.borderTop="2px solid white",e.style.overflow="scroll",e.innerHTML=`
        <h3> UNHANDLED PROMISE </h3>
        <p>${s.reason}</p>
    `,document.body.appendChild(e)});const lq=A3.createRoot($k);lq.render(n.jsx(Is.StrictMode,{children:n.jsx(oq,{})}));
