(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function j4(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Tw={exports:{}},Xf={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _T;function yL(){if(_T)return Xf;_T=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,i,o){var c=null;if(o!==void 0&&(c=""+o),i.key!==void 0&&(c=""+i.key),"key"in i){o={};for(var u in i)u!=="key"&&(o[u]=i[u])}else o=i;return i=o.ref,{$$typeof:n,type:r,key:c,ref:i!==void 0?i:null,props:o}}return Xf.Fragment=e,Xf.jsx=t,Xf.jsxs=t,Xf}var NT;function vL(){return NT||(NT=1,Tw.exports=yL()),Tw.exports}var s=vL(),Iw={exports:{}},Et={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jT;function wL(){if(jT)return Et;jT=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),v=Symbol.iterator;function _(B){return B===null||typeof B!="object"?null:(B=v&&B[v]||B["@@iterator"],typeof B=="function"?B:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,E={};function S(B,Y,ge){this.props=B,this.context=Y,this.refs=E,this.updater=ge||T}S.prototype.isReactComponent={},S.prototype.setState=function(B,Y){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,Y,"setState")},S.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function L(){}L.prototype=S.prototype;function $(B,Y,ge){this.props=B,this.context=Y,this.refs=E,this.updater=ge||T}var H=$.prototype=new L;H.constructor=$,k(H,S.prototype),H.isPureReactComponent=!0;var G=Array.isArray;function z(){}var P={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function O(B,Y,ge){var Z=ge.ref;return{$$typeof:n,type:B,key:Y,ref:Z!==void 0?Z:null,props:ge}}function I(B,Y){return O(B.type,Y,B.props)}function R(B){return typeof B=="object"&&B!==null&&B.$$typeof===n}function F(B){var Y={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(ge){return Y[ge]})}var M=/\/+/g;function ne(B,Y){return typeof B=="object"&&B!==null&&B.key!=null?F(""+B.key):Y.toString(36)}function U(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(z,z):(B.status="pending",B.then(function(Y){B.status==="pending"&&(B.status="fulfilled",B.value=Y)},function(Y){B.status==="pending"&&(B.status="rejected",B.reason=Y)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function A(B,Y,ge,Z,te){var me=typeof B;(me==="undefined"||me==="boolean")&&(B=null);var re=!1;if(B===null)re=!0;else switch(me){case"bigint":case"string":case"number":re=!0;break;case"object":switch(B.$$typeof){case n:case e:re=!0;break;case p:return re=B._init,A(re(B._payload),Y,ge,Z,te)}}if(re)return te=te(B),re=Z===""?"."+ne(B,0):Z,G(te)?(ge="",re!=null&&(ge=re.replace(M,"$&/")+"/"),A(te,Y,ge,"",function(Oe){return Oe})):te!=null&&(R(te)&&(te=I(te,ge+(te.key==null||B&&B.key===te.key?"":(""+te.key).replace(M,"$&/")+"/")+re)),Y.push(te)),1;re=0;var ce=Z===""?".":Z+":";if(G(B))for(var he=0;he<B.length;he++)Z=B[he],me=ce+ne(Z,he),re+=A(Z,Y,ge,me,te);else if(he=_(B),typeof he=="function")for(B=he.call(B),he=0;!(Z=B.next()).done;)Z=Z.value,me=ce+ne(Z,he++),re+=A(Z,Y,ge,me,te);else if(me==="object"){if(typeof B.then=="function")return A(U(B),Y,ge,Z,te);throw Y=String(B),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.")}return re}function V(B,Y,ge){if(B==null)return B;var Z=[],te=0;return A(B,Z,"","",function(me){return Y.call(ge,me,te++)}),Z}function Q(B){if(B._status===-1){var Y=B._result;Y=Y(),Y.then(function(ge){(B._status===0||B._status===-1)&&(B._status=1,B._result=ge)},function(ge){(B._status===0||B._status===-1)&&(B._status=2,B._result=ge)}),B._status===-1&&(B._status=0,B._result=Y)}if(B._status===1)return B._result.default;throw B._result}var ae=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(Y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)},X={map:V,forEach:function(B,Y,ge){V(B,function(){Y.apply(this,arguments)},ge)},count:function(B){var Y=0;return V(B,function(){Y++}),Y},toArray:function(B){return V(B,function(Y){return Y})||[]},only:function(B){if(!R(B))throw Error("React.Children.only expected to receive a single React element child.");return B}};return Et.Activity=b,Et.Children=X,Et.Component=S,Et.Fragment=t,Et.Profiler=i,Et.PureComponent=$,Et.StrictMode=r,Et.Suspense=h,Et.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,Et.__COMPILER_RUNTIME={__proto__:null,c:function(B){return P.H.useMemoCache(B)}},Et.cache=function(B){return function(){return B.apply(null,arguments)}},Et.cacheSignal=function(){return null},Et.cloneElement=function(B,Y,ge){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var Z=k({},B.props),te=B.key;if(Y!=null)for(me in Y.key!==void 0&&(te=""+Y.key),Y)!j.call(Y,me)||me==="key"||me==="__self"||me==="__source"||me==="ref"&&Y.ref===void 0||(Z[me]=Y[me]);var me=arguments.length-2;if(me===1)Z.children=ge;else if(1<me){for(var re=Array(me),ce=0;ce<me;ce++)re[ce]=arguments[ce+2];Z.children=re}return O(B.type,te,Z)},Et.createContext=function(B){return B={$$typeof:c,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:o,_context:B},B},Et.createElement=function(B,Y,ge){var Z,te={},me=null;if(Y!=null)for(Z in Y.key!==void 0&&(me=""+Y.key),Y)j.call(Y,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(te[Z]=Y[Z]);var re=arguments.length-2;if(re===1)te.children=ge;else if(1<re){for(var ce=Array(re),he=0;he<re;he++)ce[he]=arguments[he+2];te.children=ce}if(B&&B.defaultProps)for(Z in re=B.defaultProps,re)te[Z]===void 0&&(te[Z]=re[Z]);return O(B,me,te)},Et.createRef=function(){return{current:null}},Et.forwardRef=function(B){return{$$typeof:u,render:B}},Et.isValidElement=R,Et.lazy=function(B){return{$$typeof:p,_payload:{_status:-1,_result:B},_init:Q}},Et.memo=function(B,Y){return{$$typeof:m,type:B,compare:Y===void 0?null:Y}},Et.startTransition=function(B){var Y=P.T,ge={};P.T=ge;try{var Z=B(),te=P.S;te!==null&&te(ge,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(z,ae)}catch(me){ae(me)}finally{Y!==null&&ge.types!==null&&(Y.types=ge.types),P.T=Y}},Et.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},Et.use=function(B){return P.H.use(B)},Et.useActionState=function(B,Y,ge){return P.H.useActionState(B,Y,ge)},Et.useCallback=function(B,Y){return P.H.useCallback(B,Y)},Et.useContext=function(B){return P.H.useContext(B)},Et.useDebugValue=function(){},Et.useDeferredValue=function(B,Y){return P.H.useDeferredValue(B,Y)},Et.useEffect=function(B,Y){return P.H.useEffect(B,Y)},Et.useEffectEvent=function(B){return P.H.useEffectEvent(B)},Et.useId=function(){return P.H.useId()},Et.useImperativeHandle=function(B,Y,ge){return P.H.useImperativeHandle(B,Y,ge)},Et.useInsertionEffect=function(B,Y){return P.H.useInsertionEffect(B,Y)},Et.useLayoutEffect=function(B,Y){return P.H.useLayoutEffect(B,Y)},Et.useMemo=function(B,Y){return P.H.useMemo(B,Y)},Et.useOptimistic=function(B,Y){return P.H.useOptimistic(B,Y)},Et.useReducer=function(B,Y,ge){return P.H.useReducer(B,Y,ge)},Et.useRef=function(B){return P.H.useRef(B)},Et.useState=function(B){return P.H.useState(B)},Et.useSyncExternalStore=function(B,Y,ge){return P.H.useSyncExternalStore(B,Y,ge)},Et.useTransition=function(){return P.H.useTransition()},Et.version="19.2.3",Et}var ST;function tN(){return ST||(ST=1,Iw.exports=wL()),Iw.exports}var w=tN();const Rn=j4(w);var Cw={exports:{}},Jf={},Aw={exports:{}},kw={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ET;function _L(){return ET||(ET=1,(function(n){function e(A,V){var Q=A.length;A.push(V);e:for(;0<Q;){var ae=Q-1>>>1,X=A[ae];if(0<i(X,V))A[ae]=V,A[Q]=X,Q=ae;else break e}}function t(A){return A.length===0?null:A[0]}function r(A){if(A.length===0)return null;var V=A[0],Q=A.pop();if(Q!==V){A[0]=Q;e:for(var ae=0,X=A.length,B=X>>>1;ae<B;){var Y=2*(ae+1)-1,ge=A[Y],Z=Y+1,te=A[Z];if(0>i(ge,Q))Z<X&&0>i(te,ge)?(A[ae]=te,A[Z]=Q,ae=Z):(A[ae]=ge,A[Y]=Q,ae=Y);else if(Z<X&&0>i(te,Q))A[ae]=te,A[Z]=Q,ae=Z;else break e}}return V}function i(A,V){var Q=A.sortIndex-V.sortIndex;return Q!==0?Q:A.id-V.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();n.unstable_now=function(){return c.now()-u}}var h=[],m=[],p=1,b=null,v=3,_=!1,T=!1,k=!1,E=!1,S=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;function H(A){for(var V=t(m);V!==null;){if(V.callback===null)r(m);else if(V.startTime<=A)r(m),V.sortIndex=V.expirationTime,e(h,V);else break;V=t(m)}}function G(A){if(k=!1,H(A),!T)if(t(h)!==null)T=!0,z||(z=!0,F());else{var V=t(m);V!==null&&U(G,V.startTime-A)}}var z=!1,P=-1,j=5,O=-1;function I(){return E?!0:!(n.unstable_now()-O<j)}function R(){if(E=!1,z){var A=n.unstable_now();O=A;var V=!0;try{e:{T=!1,k&&(k=!1,L(P),P=-1),_=!0;var Q=v;try{t:{for(H(A),b=t(h);b!==null&&!(b.expirationTime>A&&I());){var ae=b.callback;if(typeof ae=="function"){b.callback=null,v=b.priorityLevel;var X=ae(b.expirationTime<=A);if(A=n.unstable_now(),typeof X=="function"){b.callback=X,H(A),V=!0;break t}b===t(h)&&r(h),H(A)}else r(h);b=t(h)}if(b!==null)V=!0;else{var B=t(m);B!==null&&U(G,B.startTime-A),V=!1}}break e}finally{b=null,v=Q,_=!1}V=void 0}}finally{V?F():z=!1}}}var F;if(typeof $=="function")F=function(){$(R)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,ne=M.port2;M.port1.onmessage=R,F=function(){ne.postMessage(null)}}else F=function(){S(R,0)};function U(A,V){P=S(function(){A(n.unstable_now())},V)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(A){A.callback=null},n.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<A?Math.floor(1e3/A):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_next=function(A){switch(v){case 1:case 2:case 3:var V=3;break;default:V=v}var Q=v;v=V;try{return A()}finally{v=Q}},n.unstable_requestPaint=function(){E=!0},n.unstable_runWithPriority=function(A,V){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var Q=v;v=A;try{return V()}finally{v=Q}},n.unstable_scheduleCallback=function(A,V,Q){var ae=n.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?ae+Q:ae):Q=ae,A){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=Q+X,A={id:p++,callback:V,priorityLevel:A,startTime:Q,expirationTime:X,sortIndex:-1},Q>ae?(A.sortIndex=Q,e(m,A),t(h)===null&&A===t(m)&&(k?(L(P),P=-1):k=!0,U(G,Q-ae))):(A.sortIndex=X,e(h,A),T||_||(T=!0,z||(z=!0,F()))),A},n.unstable_shouldYield=I,n.unstable_wrapCallback=function(A){var V=v;return function(){var Q=v;v=V;try{return A.apply(this,arguments)}finally{v=Q}}}})(kw)),kw}var TT;function NL(){return TT||(TT=1,Aw.exports=_L()),Aw.exports}var Rw={exports:{}},Hs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IT;function jL(){if(IT)return Hs;IT=1;var n=tN();function e(h){var m="https://react.dev/errors/"+h;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)m+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function o(h,m,p){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:b==null?null:""+b,children:h,containerInfo:m,implementation:p}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,m){if(h==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Hs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Hs.createPortal=function(h,m){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return o(h,m,null,p)},Hs.flushSync=function(h){var m=c.T,p=r.p;try{if(c.T=null,r.p=2,h)return h()}finally{c.T=m,r.p=p,r.d.f()}},Hs.preconnect=function(h,m){typeof h=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,r.d.C(h,m))},Hs.prefetchDNS=function(h){typeof h=="string"&&r.d.D(h)},Hs.preinit=function(h,m){if(typeof h=="string"&&m&&typeof m.as=="string"){var p=m.as,b=u(p,m.crossOrigin),v=typeof m.integrity=="string"?m.integrity:void 0,_=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;p==="style"?r.d.S(h,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:b,integrity:v,fetchPriority:_}):p==="script"&&r.d.X(h,{crossOrigin:b,integrity:v,fetchPriority:_,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Hs.preinitModule=function(h,m){if(typeof h=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var p=u(m.as,m.crossOrigin);r.d.M(h,{crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&r.d.M(h)},Hs.preload=function(h,m){if(typeof h=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var p=m.as,b=u(p,m.crossOrigin);r.d.L(h,p,{crossOrigin:b,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Hs.preloadModule=function(h,m){if(typeof h=="string")if(m){var p=u(m.as,m.crossOrigin);r.d.m(h,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else r.d.m(h)},Hs.requestFormReset=function(h){r.d.r(h)},Hs.unstable_batchedUpdates=function(h,m){return h(m)},Hs.useFormState=function(h,m,p){return c.H.useFormState(h,m,p)},Hs.useFormStatus=function(){return c.H.useHostTransitionStatus()},Hs.version="19.2.3",Hs}var CT;function S4(){if(CT)return Rw.exports;CT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Rw.exports=jL(),Rw.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AT;function SL(){if(AT)return Jf;AT=1;var n=NL(),e=tN(),t=S4();function r(a){var l="https://react.dev/errors/"+a;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)l+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function o(a){var l=a,d=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(d=l.return),a=l.return;while(a)}return l.tag===3?d:null}function c(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function u(a){if(a.tag===31){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function h(a){if(o(a)!==a)throw Error(r(188))}function m(a){var l=a.alternate;if(!l){if(l=o(a),l===null)throw Error(r(188));return l!==a?null:a}for(var d=a,f=l;;){var x=d.return;if(x===null)break;var y=x.alternate;if(y===null){if(f=x.return,f!==null){d=f;continue}break}if(x.child===y.child){for(y=x.child;y;){if(y===d)return h(x),a;if(y===f)return h(x),l;y=y.sibling}throw Error(r(188))}if(d.return!==f.return)d=x,f=y;else{for(var C=!1,q=x.child;q;){if(q===d){C=!0,d=x,f=y;break}if(q===f){C=!0,f=x,d=y;break}q=q.sibling}if(!C){for(q=y.child;q;){if(q===d){C=!0,d=y,f=x;break}if(q===f){C=!0,f=y,d=x;break}q=q.sibling}if(!C)throw Error(r(189))}}if(d.alternate!==f)throw Error(r(190))}if(d.tag!==3)throw Error(r(188));return d.stateNode.current===d?a:l}function p(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a;for(a=a.child;a!==null;){if(l=p(a),l!==null)return l;a=a.sibling}return null}var b=Object.assign,v=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),L=Symbol.for("react.consumer"),$=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),R=Symbol.iterator;function F(a){return a===null||typeof a!="object"?null:(a=R&&a[R]||a["@@iterator"],typeof a=="function"?a:null)}var M=Symbol.for("react.client.reference");function ne(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===M?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case k:return"Fragment";case S:return"Profiler";case E:return"StrictMode";case G:return"Suspense";case z:return"SuspenseList";case O:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case T:return"Portal";case $:return a.displayName||"Context";case L:return(a._context.displayName||"Context")+".Consumer";case H:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case P:return l=a.displayName||null,l!==null?l:ne(a.type)||"Memo";case j:l=a._payload,a=a._init;try{return ne(a(l))}catch{}}return null}var U=Array.isArray,A=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q={pending:!1,data:null,method:null,action:null},ae=[],X=-1;function B(a){return{current:a}}function Y(a){0>X||(a.current=ae[X],ae[X]=null,X--)}function ge(a,l){X++,ae[X]=a.current,a.current=l}var Z=B(null),te=B(null),me=B(null),re=B(null);function ce(a,l){switch(ge(me,l),ge(te,a),ge(Z,null),l.nodeType){case 9:case 11:a=(a=l.documentElement)&&(a=a.namespaceURI)?HE(a):0;break;default:if(a=l.tagName,l=l.namespaceURI)l=HE(l),a=GE(l,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}Y(Z),ge(Z,a)}function he(){Y(Z),Y(te),Y(me)}function Oe(a){a.memoizedState!==null&&ge(re,a);var l=Z.current,d=GE(l,a.type);l!==d&&(ge(te,a),ge(Z,d))}function Ue(a){te.current===a&&(Y(Z),Y(te)),re.current===a&&(Y(re),Wf._currentValue=Q)}var st,fe;function K(a){if(st===void 0)try{throw Error()}catch(d){var l=d.stack.trim().match(/\n( *(at )?)/);st=l&&l[1]||"",fe=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+st+a+fe}var ie=!1;function J(a,l){if(!a||ie)return"";ie=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(l){var De=function(){throw Error()};if(Object.defineProperty(De.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(De,[])}catch(Ce){var Se=Ce}Reflect.construct(a,[],De)}else{try{De.call()}catch(Ce){Se=Ce}a.call(De.prototype)}}else{try{throw Error()}catch(Ce){Se=Ce}(De=a())&&typeof De.catch=="function"&&De.catch(function(){})}}catch(Ce){if(Ce&&Se&&typeof Ce.stack=="string")return[Ce.stack,Se.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=f.DetermineComponentFrameRoot(),C=y[0],q=y[1];if(C&&q){var se=C.split(`
`),je=q.split(`
`);for(x=f=0;f<se.length&&!se[f].includes("DetermineComponentFrameRoot");)f++;for(;x<je.length&&!je[x].includes("DetermineComponentFrameRoot");)x++;if(f===se.length||x===je.length)for(f=se.length-1,x=je.length-1;1<=f&&0<=x&&se[f]!==je[x];)x--;for(;1<=f&&0<=x;f--,x--)if(se[f]!==je[x]){if(f!==1||x!==1)do if(f--,x--,0>x||se[f]!==je[x]){var ke=`
`+se[f].replace(" at new "," at ");return a.displayName&&ke.includes("<anonymous>")&&(ke=ke.replace("<anonymous>",a.displayName)),ke}while(1<=f&&0<=x);break}}}finally{ie=!1,Error.prepareStackTrace=d}return(d=a?a.displayName||a.name:"")?K(d):""}function le(a,l){switch(a.tag){case 26:case 27:case 5:return K(a.type);case 16:return K("Lazy");case 13:return a.child!==l&&l!==null?K("Suspense Fallback"):K("Suspense");case 19:return K("SuspenseList");case 0:case 15:return J(a.type,!1);case 11:return J(a.type.render,!1);case 1:return J(a.type,!0);case 31:return K("Activity");default:return""}}function ee(a){try{var l="",d=null;do l+=le(a,d),d=a,a=a.return;while(a);return l}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var we=Object.prototype.hasOwnProperty,pe=n.unstable_scheduleCallback,ye=n.unstable_cancelCallback,Ae=n.unstable_shouldYield,xe=n.unstable_requestPaint,Pe=n.unstable_now,gt=n.unstable_getCurrentPriorityLevel,Ee=n.unstable_ImmediatePriority,Be=n.unstable_UserBlockingPriority,ht=n.unstable_NormalPriority,Me=n.unstable_LowPriority,Ze=n.unstable_IdlePriority,at=n.log,yt=n.unstable_setDisableYieldValue,St=null,ve=null;function Ge(a){if(typeof at=="function"&&yt(a),ve&&typeof ve.setStrictMode=="function")try{ve.setStrictMode(St,a)}catch{}}var We=Math.clz32?Math.clz32:$e,dt=Math.log,Ve=Math.LN2;function $e(a){return a>>>=0,a===0?32:31-(dt(a)/Ve|0)|0}var tt=256,rt=262144,ft=4194304;function $t(a){var l=a&42;if(l!==0)return l;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Dn(a,l,d){var f=a.pendingLanes;if(f===0)return 0;var x=0,y=a.suspendedLanes,C=a.pingedLanes;a=a.warmLanes;var q=f&134217727;return q!==0?(f=q&~y,f!==0?x=$t(f):(C&=q,C!==0?x=$t(C):d||(d=q&~a,d!==0&&(x=$t(d))))):(q=f&~y,q!==0?x=$t(q):C!==0?x=$t(C):d||(d=f&~a,d!==0&&(x=$t(d)))),x===0?0:l!==0&&l!==x&&(l&y)===0&&(y=x&-x,d=l&-l,y>=d||y===32&&(d&4194048)!==0)?l:x}function Zn(a,l){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&l)===0}function Ii(a,l){switch(a){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oc(){var a=ft;return ft<<=1,(ft&62914560)===0&&(ft=4194304),a}function Pr(a){for(var l=[],d=0;31>d;d++)l.push(a);return l}function ea(a,l){a.pendingLanes|=l,l!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function He(a,l,d,f,x,y){var C=a.pendingLanes;a.pendingLanes=d,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=d,a.entangledLanes&=d,a.errorRecoveryDisabledLanes&=d,a.shellSuspendCounter=0;var q=a.entanglements,se=a.expirationTimes,je=a.hiddenUpdates;for(d=C&~d;0<d;){var ke=31-We(d),De=1<<ke;q[ke]=0,se[ke]=-1;var Se=je[ke];if(Se!==null)for(je[ke]=null,ke=0;ke<Se.length;ke++){var Ce=Se[ke];Ce!==null&&(Ce.lane&=-536870913)}d&=~De}f!==0&&wt(a,f,0),y!==0&&x===0&&a.tag!==0&&(a.suspendedLanes|=y&~(C&~l))}function wt(a,l,d){a.pendingLanes|=l,a.suspendedLanes&=~l;var f=31-We(l);a.entangledLanes|=l,a.entanglements[f]=a.entanglements[f]|1073741824|d&261930}function es(a,l){var d=a.entangledLanes|=l;for(a=a.entanglements;d;){var f=31-We(d),x=1<<f;x&l|a[f]&l&&(a[f]|=l),d&=~x}}function ni(a,l){var d=l&-l;return d=(d&42)!==0?1:lc(d),(d&(a.suspendedLanes|l))!==0?0:d}function lc(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function qa(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function f0(){var a=V.p;return a!==0?a:(a=window.event,a===void 0?32:gT(a.type))}function Ci(a,l){var d=V.p;try{return V.p=a,l()}finally{V.p=d}}var Ai=Math.random().toString(36).slice(2),ts="__reactFiber$"+Ai,ys="__reactProps$"+Ai,ta="__reactContainer$"+Ai,Ld="__reactEvents$"+Ai,Dy="__reactListeners$"+Ai,m0="__reactHandles$"+Ai,g0="__reactResources$"+Ai,na="__reactMarker$"+Ai;function Vd(a){delete a[ts],delete a[ys],delete a[Ld],delete a[Dy],delete a[m0]}function sa(a){var l=a[ts];if(l)return l;for(var d=a.parentNode;d;){if(l=d[ta]||d[ts]){if(d=l.alternate,l.child!==null||d!==null&&d.child!==null)for(a=ZE(a);a!==null;){if(d=a[ts])return d;a=ZE(a)}return l}a=d,d=a.parentNode}return null}function si(a){if(a=a[ts]||a[ta]){var l=a.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return a}return null}function Or(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a.stateNode;throw Error(r(33))}function ra(a){var l=a[g0];return l||(l=a[g0]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function ns(a){a[na]=!0}var Zh=new Set,ef={};function ia(a,l){aa(a,l),aa(a+"Capture",l)}function aa(a,l){for(ef[a]=l,a=0;a<l.length;a++)Zh.add(l[a])}var tf=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),nf={},sf={};function p0(a){return we.call(sf,a)?!0:we.call(nf,a)?!1:tf.test(a)?sf[a]=!0:(nf[a]=!0,!1)}function Fd(a,l,d){if(p0(l))if(d===null)a.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":a.removeAttribute(l);return;case"boolean":var f=l.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){a.removeAttribute(l);return}}a.setAttribute(l,""+d)}}function Mr(a,l,d){if(d===null)a.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttribute(l,""+d)}}function ss(a,l,d,f){if(f===null)a.removeAttribute(d);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(d);return}a.setAttributeNS(l,d,""+f)}}function vs(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Lo(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function rf(a,l,d){var f=Object.getOwnPropertyDescriptor(a.constructor.prototype,l);if(!a.hasOwnProperty(l)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var x=f.get,y=f.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return x.call(this)},set:function(C){d=""+C,y.call(this,C)}}),Object.defineProperty(a,l,{enumerable:f.enumerable}),{getValue:function(){return d},setValue:function(C){d=""+C},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function rn(a){if(!a._valueTracker){var l=Lo(a)?"checked":"value";a._valueTracker=rf(a,l,""+a[l])}}function cc(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var d=l.getValue(),f="";return a&&(f=Lo(a)?a.checked?"true":"false":a.value),a=f,a!==d?(l.setValue(a),!0):!1}function oa(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var dc=/[\n"\\]/g;function gr(a){return a.replace(dc,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Ud(a,l,d,f,x,y,C,q){a.name="",C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?a.type=C:a.removeAttribute("type"),l!=null?C==="number"?(l===0&&a.value===""||a.value!=l)&&(a.value=""+vs(l)):a.value!==""+vs(l)&&(a.value=""+vs(l)):C!=="submit"&&C!=="reset"||a.removeAttribute("value"),l!=null?af(a,C,vs(l)):d!=null?af(a,C,vs(d)):f!=null&&a.removeAttribute("value"),x==null&&y!=null&&(a.defaultChecked=!!y),x!=null&&(a.checked=x&&typeof x!="function"&&typeof x!="symbol"),q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?a.name=""+vs(q):a.removeAttribute("name")}function x0(a,l,d,f,x,y,C,q){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(a.type=y),l!=null||d!=null){if(!(y!=="submit"&&y!=="reset"||l!=null)){rn(a);return}d=d!=null?""+vs(d):"",l=l!=null?""+vs(l):d,q||l===a.value||(a.value=l),a.defaultValue=l}f=f??x,f=typeof f!="function"&&typeof f!="symbol"&&!!f,a.checked=q?a.checked:!!f,a.defaultChecked=!!f,C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(a.name=C),rn(a)}function af(a,l,d){l==="number"&&oa(a.ownerDocument)===a||a.defaultValue===""+d||(a.defaultValue=""+d)}function Vo(a,l,d,f){if(a=a.options,l){l={};for(var x=0;x<d.length;x++)l["$"+d[x]]=!0;for(d=0;d<a.length;d++)x=l.hasOwnProperty("$"+a[d].value),a[d].selected!==x&&(a[d].selected=x),x&&f&&(a[d].defaultSelected=!0)}else{for(d=""+vs(d),l=null,x=0;x<a.length;x++){if(a[x].value===d){a[x].selected=!0,f&&(a[x].defaultSelected=!0);return}l!==null||a[x].disabled||(l=a[x])}l!==null&&(l.selected=!0)}}function b0(a,l,d){if(l!=null&&(l=""+vs(l),l!==a.value&&(a.value=l),d==null)){a.defaultValue!==l&&(a.defaultValue=l);return}a.defaultValue=d!=null?""+vs(d):""}function Fo(a,l,d,f){if(l==null){if(f!=null){if(d!=null)throw Error(r(92));if(U(f)){if(1<f.length)throw Error(r(93));f=f[0]}d=f}d==null&&(d=""),l=d}d=vs(l),a.defaultValue=d,f=a.textContent,f===d&&f!==""&&f!==null&&(a.value=f),rn(a)}function pr(a,l){if(l){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=l;return}}a.textContent=l}var y0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function of(a,l,d){var f=l.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?f?a.setProperty(l,""):l==="float"?a.cssFloat="":a[l]="":f?a.setProperty(l,d):typeof d!="number"||d===0||y0.has(l)?l==="float"?a.cssFloat=d:a[l]=(""+d).trim():a[l]=d+"px"}function lf(a,l,d){if(l!=null&&typeof l!="object")throw Error(r(62));if(a=a.style,d!=null){for(var f in d)!d.hasOwnProperty(f)||l!=null&&l.hasOwnProperty(f)||(f.indexOf("--")===0?a.setProperty(f,""):f==="float"?a.cssFloat="":a[f]="");for(var x in l)f=l[x],l.hasOwnProperty(x)&&d[x]!==f&&of(a,x,f)}else for(var y in l)l.hasOwnProperty(y)&&of(a,y,l[y])}function Bd(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var v0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Uo=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function zd(a){return Uo.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function ki(){}var cf=null;function ri(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Bo=null,la=null;function uc(a){var l=si(a);if(l&&(a=l.stateNode)){var d=a[ys]||null;e:switch(a=l.stateNode,l.type){case"input":if(Ud(a,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),l=d.name,d.type==="radio"&&l!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+gr(""+l)+'"][type="radio"]'),l=0;l<d.length;l++){var f=d[l];if(f!==a&&f.form===a.form){var x=f[ys]||null;if(!x)throw Error(r(90));Ud(f,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(l=0;l<d.length;l++)f=d[l],f.form===a.form&&cc(f)}break e;case"textarea":b0(a,d.value,d.defaultValue);break e;case"select":l=d.value,l!=null&&Vo(a,!!d.multiple,l,!1)}}}var $d=!1;function zo(a,l,d){if($d)return a(l,d);$d=!0;try{var f=a(l);return f}finally{if($d=!1,(Bo!==null||la!==null)&&(fp(),Bo&&(l=Bo,a=la,la=Bo=null,uc(l),a)))for(l=0;l<a.length;l++)uc(a[l])}}function Ri(a,l){var d=a.stateNode;if(d===null)return null;var f=d[ys]||null;if(f===null)return null;d=f[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(a=a.type,f=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!f;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(r(231,l,typeof d));return d}var ii=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hc=!1;if(ii)try{var un={};Object.defineProperty(un,"passive",{get:function(){hc=!0}}),window.addEventListener("test",un,un),window.removeEventListener("test",un,un)}catch{hc=!1}var ca=null,df=null,fc=null;function uf(){if(fc)return fc;var a,l=df,d=l.length,f,x="value"in ca?ca.value:ca.textContent,y=x.length;for(a=0;a<d&&l[a]===x[a];a++);var C=d-a;for(f=1;f<=C&&l[d-f]===x[y-f];f++);return fc=x.slice(a,1<f?1-f:void 0)}function mc(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function Ha(){return!0}function Di(){return!1}function Rs(a){function l(d,f,x,y,C){this._reactName=d,this._targetInst=x,this.type=f,this.nativeEvent=y,this.target=C,this.currentTarget=null;for(var q in a)a.hasOwnProperty(q)&&(d=a[q],this[q]=d?d(y):y[q]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Ha:Di,this.isPropagationStopped=Di,this}return b(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Ha)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Ha)},persist:function(){},isPersistent:Ha}),l}var Ga={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},da=Rs(Ga),$o=b({},Ga,{view:0,detail:0}),hf=Rs($o),qo,qd,ua,Hd=b({},$o,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ho,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==ua&&(ua&&a.type==="mousemove"?(qo=a.screenX-ua.screenX,qd=a.screenY-ua.screenY):qd=qo=0,ua=a),qo)},movementY:function(a){return"movementY"in a?a.movementY:qd}}),ff=Rs(Hd),gc=b({},Hd,{dataTransfer:0}),w0=Rs(gc),_0=b({},$o,{relatedTarget:0}),pc=Rs(_0),mf=b({},Ga,{animationName:0,elapsedTime:0,pseudoElement:0}),N0=Rs(mf),Gd=b({},Ga,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),j0=Rs(Gd),S0=b({},Ga,{data:0}),ha=Rs(S0),E0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},T0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},I0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function C0(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=I0[a])?!!l[a]:!1}function Ho(){return C0}var er=b({},$o,{key:function(a){if(a.key){var l=E0[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=mc(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?T0[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ho,charCode:function(a){return a.type==="keypress"?mc(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?mc(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),A0=Rs(er),k0=b({},Hd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wa=Rs(k0),g=b({},$o,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ho}),N=Rs(g),D=b({},Ga,{propertyName:0,elapsedTime:0,pseudoElement:0}),W=Rs(D),_e=b({},Hd,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Ie=Rs(_e),Ke=b({},Ga,{newState:0,oldState:0}),Ct=Rs(Ke),Wn=[9,13,27,32],Xt=ii&&"CompositionEvent"in window,En=null;ii&&"documentMode"in document&&(En=document.documentMode);var ai=ii&&"TextEvent"in window&&!En,fa=ii&&(!Xt||En&&8<En&&11>=En),Pi=" ",Oi=!1;function xc(a,l){switch(a){case"keyup":return Wn.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wd(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Kd=!1;function $O(a,l){switch(a){case"compositionend":return Wd(l);case"keypress":return l.which!==32?null:(Oi=!0,Pi);case"textInput":return a=l.data,a===Pi&&Oi?null:a;default:return null}}function qO(a,l){if(Kd)return a==="compositionend"||!Xt&&xc(a,l)?(a=uf(),fc=df=ca=null,Kd=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return fa&&l.locale!=="ko"?null:l.data;default:return null}}var HO={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function n5(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!HO[a.type]:l==="textarea"}function s5(a,l,d,f){Bo?la?la.push(f):la=[f]:Bo=f,l=vp(l,"onChange"),0<l.length&&(d=new da("onChange","change",null,d,f),a.push({event:d,listeners:l}))}var gf=null,pf=null;function GO(a){FE(a,0)}function R0(a){var l=Or(a);if(cc(l))return a}function r5(a,l){if(a==="change")return l}var i5=!1;if(ii){var Py;if(ii){var Oy="oninput"in document;if(!Oy){var a5=document.createElement("div");a5.setAttribute("oninput","return;"),Oy=typeof a5.oninput=="function"}Py=Oy}else Py=!1;i5=Py&&(!document.documentMode||9<document.documentMode)}function o5(){gf&&(gf.detachEvent("onpropertychange",l5),pf=gf=null)}function l5(a){if(a.propertyName==="value"&&R0(pf)){var l=[];s5(l,pf,a,ri(a)),zo(GO,l)}}function WO(a,l,d){a==="focusin"?(o5(),gf=l,pf=d,gf.attachEvent("onpropertychange",l5)):a==="focusout"&&o5()}function KO(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return R0(pf)}function QO(a,l){if(a==="click")return R0(l)}function YO(a,l){if(a==="input"||a==="change")return R0(l)}function XO(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var Lr=typeof Object.is=="function"?Object.is:XO;function xf(a,l){if(Lr(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var d=Object.keys(a),f=Object.keys(l);if(d.length!==f.length)return!1;for(f=0;f<d.length;f++){var x=d[f];if(!we.call(l,x)||!Lr(a[x],l[x]))return!1}return!0}function c5(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function d5(a,l){var d=c5(a);a=0;for(var f;d;){if(d.nodeType===3){if(f=a+d.textContent.length,a<=l&&f>=l)return{node:d,offset:l-a};a=f}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=c5(d)}}function u5(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?u5(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function h5(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var l=oa(a.document);l instanceof a.HTMLIFrameElement;){try{var d=typeof l.contentWindow.location.href=="string"}catch{d=!1}if(d)a=l.contentWindow;else break;l=oa(a.document)}return l}function My(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}var JO=ii&&"documentMode"in document&&11>=document.documentMode,Qd=null,Ly=null,bf=null,Vy=!1;function f5(a,l,d){var f=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Vy||Qd==null||Qd!==oa(f)||(f=Qd,"selectionStart"in f&&My(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),bf&&xf(bf,f)||(bf=f,f=vp(Ly,"onSelect"),0<f.length&&(l=new da("onSelect","select",null,l,d),a.push({event:l,listeners:f}),l.target=Qd)))}function bc(a,l){var d={};return d[a.toLowerCase()]=l.toLowerCase(),d["Webkit"+a]="webkit"+l,d["Moz"+a]="moz"+l,d}var Yd={animationend:bc("Animation","AnimationEnd"),animationiteration:bc("Animation","AnimationIteration"),animationstart:bc("Animation","AnimationStart"),transitionrun:bc("Transition","TransitionRun"),transitionstart:bc("Transition","TransitionStart"),transitioncancel:bc("Transition","TransitionCancel"),transitionend:bc("Transition","TransitionEnd")},Fy={},m5={};ii&&(m5=document.createElement("div").style,"AnimationEvent"in window||(delete Yd.animationend.animation,delete Yd.animationiteration.animation,delete Yd.animationstart.animation),"TransitionEvent"in window||delete Yd.transitionend.transition);function yc(a){if(Fy[a])return Fy[a];if(!Yd[a])return a;var l=Yd[a],d;for(d in l)if(l.hasOwnProperty(d)&&d in m5)return Fy[a]=l[d];return a}var g5=yc("animationend"),p5=yc("animationiteration"),x5=yc("animationstart"),ZO=yc("transitionrun"),eM=yc("transitionstart"),tM=yc("transitioncancel"),b5=yc("transitionend"),y5=new Map,Uy="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Uy.push("scrollEnd");function Mi(a,l){y5.set(a,l),ia(l,[a])}var D0=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},oi=[],Xd=0,By=0;function P0(){for(var a=Xd,l=By=Xd=0;l<a;){var d=oi[l];oi[l++]=null;var f=oi[l];oi[l++]=null;var x=oi[l];oi[l++]=null;var y=oi[l];if(oi[l++]=null,f!==null&&x!==null){var C=f.pending;C===null?x.next=x:(x.next=C.next,C.next=x),f.pending=x}y!==0&&v5(d,x,y)}}function O0(a,l,d,f){oi[Xd++]=a,oi[Xd++]=l,oi[Xd++]=d,oi[Xd++]=f,By|=f,a.lanes|=f,a=a.alternate,a!==null&&(a.lanes|=f)}function zy(a,l,d,f){return O0(a,l,d,f),M0(a)}function vc(a,l){return O0(a,null,null,l),M0(a)}function v5(a,l,d){a.lanes|=d;var f=a.alternate;f!==null&&(f.lanes|=d);for(var x=!1,y=a.return;y!==null;)y.childLanes|=d,f=y.alternate,f!==null&&(f.childLanes|=d),y.tag===22&&(a=y.stateNode,a===null||a._visibility&1||(x=!0)),a=y,y=y.return;return a.tag===3?(y=a.stateNode,x&&l!==null&&(x=31-We(d),a=y.hiddenUpdates,f=a[x],f===null?a[x]=[l]:f.push(l),l.lane=d|536870912),y):null}function M0(a){if(50<Uf)throw Uf=0,Xv=null,Error(r(185));for(var l=a.return;l!==null;)a=l,l=a.return;return a.tag===3?a.stateNode:null}var Jd={};function nM(a,l,d,f){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vr(a,l,d,f){return new nM(a,l,d,f)}function $y(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Ka(a,l){var d=a.alternate;return d===null?(d=Vr(a.tag,l,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=l,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&65011712,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,l=a.dependencies,d.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d.refCleanup=a.refCleanup,d}function w5(a,l){a.flags&=65011714;var d=a.alternate;return d===null?(a.childLanes=0,a.lanes=l,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=d.childLanes,a.lanes=d.lanes,a.child=d.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=d.memoizedProps,a.memoizedState=d.memoizedState,a.updateQueue=d.updateQueue,a.type=d.type,l=d.dependencies,a.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),a}function L0(a,l,d,f,x,y){var C=0;if(f=a,typeof a=="function")$y(a)&&(C=1);else if(typeof a=="string")C=oL(a,d,Z.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case O:return a=Vr(31,d,l,x),a.elementType=O,a.lanes=y,a;case k:return wc(d.children,x,y,l);case E:C=8,x|=24;break;case S:return a=Vr(12,d,l,x|2),a.elementType=S,a.lanes=y,a;case G:return a=Vr(13,d,l,x),a.elementType=G,a.lanes=y,a;case z:return a=Vr(19,d,l,x),a.elementType=z,a.lanes=y,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case $:C=10;break e;case L:C=9;break e;case H:C=11;break e;case P:C=14;break e;case j:C=16,f=null;break e}C=29,d=Error(r(130,a===null?"null":typeof a,"")),f=null}return l=Vr(C,d,l,x),l.elementType=a,l.type=f,l.lanes=y,l}function wc(a,l,d,f){return a=Vr(7,a,f,l),a.lanes=d,a}function qy(a,l,d){return a=Vr(6,a,null,l),a.lanes=d,a}function _5(a){var l=Vr(18,null,null,0);return l.stateNode=a,l}function Hy(a,l,d){return l=Vr(4,a.children!==null?a.children:[],a.key,l),l.lanes=d,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}var N5=new WeakMap;function li(a,l){if(typeof a=="object"&&a!==null){var d=N5.get(a);return d!==void 0?d:(l={value:a,source:l,stack:ee(l)},N5.set(a,l),l)}return{value:a,source:l,stack:ee(l)}}var Zd=[],eu=0,V0=null,yf=0,ci=[],di=0,Go=null,ma=1,ga="";function Qa(a,l){Zd[eu++]=yf,Zd[eu++]=V0,V0=a,yf=l}function j5(a,l,d){ci[di++]=ma,ci[di++]=ga,ci[di++]=Go,Go=a;var f=ma;a=ga;var x=32-We(f)-1;f&=~(1<<x),d+=1;var y=32-We(l)+x;if(30<y){var C=x-x%5;y=(f&(1<<C)-1).toString(32),f>>=C,x-=C,ma=1<<32-We(l)+x|d<<x|f,ga=y+a}else ma=1<<y|d<<x|f,ga=a}function Gy(a){a.return!==null&&(Qa(a,1),j5(a,1,0))}function Wy(a){for(;a===V0;)V0=Zd[--eu],Zd[eu]=null,yf=Zd[--eu],Zd[eu]=null;for(;a===Go;)Go=ci[--di],ci[di]=null,ga=ci[--di],ci[di]=null,ma=ci[--di],ci[di]=null}function S5(a,l){ci[di++]=ma,ci[di++]=ga,ci[di++]=Go,ma=l.id,ga=l.overflow,Go=a}var Ds=null,wn=null,qt=!1,Wo=null,ui=!1,Ky=Error(r(519));function Ko(a){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw vf(li(l,a)),Ky}function E5(a){var l=a.stateNode,d=a.type,f=a.memoizedProps;switch(l[ts]=a,l[ys]=f,d){case"dialog":Vt("cancel",l),Vt("close",l);break;case"iframe":case"object":case"embed":Vt("load",l);break;case"video":case"audio":for(d=0;d<zf.length;d++)Vt(zf[d],l);break;case"source":Vt("error",l);break;case"img":case"image":case"link":Vt("error",l),Vt("load",l);break;case"details":Vt("toggle",l);break;case"input":Vt("invalid",l),x0(l,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":Vt("invalid",l);break;case"textarea":Vt("invalid",l),Fo(l,f.value,f.defaultValue,f.children)}d=f.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||l.textContent===""+d||f.suppressHydrationWarning===!0||$E(l.textContent,d)?(f.popover!=null&&(Vt("beforetoggle",l),Vt("toggle",l)),f.onScroll!=null&&Vt("scroll",l),f.onScrollEnd!=null&&Vt("scrollend",l),f.onClick!=null&&(l.onclick=ki),l=!0):l=!1,l||Ko(a,!0)}function T5(a){for(Ds=a.return;Ds;)switch(Ds.tag){case 5:case 31:case 13:ui=!1;return;case 27:case 3:ui=!0;return;default:Ds=Ds.return}}function tu(a){if(a!==Ds)return!1;if(!qt)return T5(a),qt=!0,!1;var l=a.tag,d;if((d=l!==3&&l!==27)&&((d=l===5)&&(d=a.type,d=!(d!=="form"&&d!=="button")||hw(a.type,a.memoizedProps)),d=!d),d&&wn&&Ko(a),T5(a),l===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));wn=JE(a)}else if(l===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));wn=JE(a)}else l===27?(l=wn,ll(a.type)?(a=xw,xw=null,wn=a):wn=l):wn=Ds?fi(a.stateNode.nextSibling):null;return!0}function _c(){wn=Ds=null,qt=!1}function Qy(){var a=Wo;return a!==null&&(vr===null?vr=a:vr.push.apply(vr,a),Wo=null),a}function vf(a){Wo===null?Wo=[a]:Wo.push(a)}var Yy=B(null),Nc=null,Ya=null;function Qo(a,l,d){ge(Yy,l._currentValue),l._currentValue=d}function Xa(a){a._currentValue=Yy.current,Y(Yy)}function Xy(a,l,d){for(;a!==null;){var f=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,f!==null&&(f.childLanes|=l)):f!==null&&(f.childLanes&l)!==l&&(f.childLanes|=l),a===d)break;a=a.return}}function Jy(a,l,d,f){var x=a.child;for(x!==null&&(x.return=a);x!==null;){var y=x.dependencies;if(y!==null){var C=x.child;y=y.firstContext;e:for(;y!==null;){var q=y;y=x;for(var se=0;se<l.length;se++)if(q.context===l[se]){y.lanes|=d,q=y.alternate,q!==null&&(q.lanes|=d),Xy(y.return,d,a),f||(C=null);break e}y=q.next}}else if(x.tag===18){if(C=x.return,C===null)throw Error(r(341));C.lanes|=d,y=C.alternate,y!==null&&(y.lanes|=d),Xy(C,d,a),C=null}else C=x.child;if(C!==null)C.return=x;else for(C=x;C!==null;){if(C===a){C=null;break}if(x=C.sibling,x!==null){x.return=C.return,C=x;break}C=C.return}x=C}}function nu(a,l,d,f){a=null;for(var x=l,y=!1;x!==null;){if(!y){if((x.flags&524288)!==0)y=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var C=x.alternate;if(C===null)throw Error(r(387));if(C=C.memoizedProps,C!==null){var q=x.type;Lr(x.pendingProps.value,C.value)||(a!==null?a.push(q):a=[q])}}else if(x===re.current){if(C=x.alternate,C===null)throw Error(r(387));C.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(a!==null?a.push(Wf):a=[Wf])}x=x.return}a!==null&&Jy(l,a,d,f),l.flags|=262144}function F0(a){for(a=a.firstContext;a!==null;){if(!Lr(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function jc(a){Nc=a,Ya=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Ps(a){return I5(Nc,a)}function U0(a,l){return Nc===null&&jc(a),I5(a,l)}function I5(a,l){var d=l._currentValue;if(l={context:l,memoizedValue:d,next:null},Ya===null){if(a===null)throw Error(r(308));Ya=l,a.dependencies={lanes:0,firstContext:l},a.flags|=524288}else Ya=Ya.next=l;return d}var sM=typeof AbortController<"u"?AbortController:function(){var a=[],l=this.signal={aborted:!1,addEventListener:function(d,f){a.push(f)}};this.abort=function(){l.aborted=!0,a.forEach(function(d){return d()})}},rM=n.unstable_scheduleCallback,iM=n.unstable_NormalPriority,rs={$$typeof:$,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Zy(){return{controller:new sM,data:new Map,refCount:0}}function wf(a){a.refCount--,a.refCount===0&&rM(iM,function(){a.controller.abort()})}var _f=null,ev=0,su=0,ru=null;function aM(a,l){if(_f===null){var d=_f=[];ev=0,su=sw(),ru={status:"pending",value:void 0,then:function(f){d.push(f)}}}return ev++,l.then(C5,C5),l}function C5(){if(--ev===0&&_f!==null){ru!==null&&(ru.status="fulfilled");var a=_f;_f=null,su=0,ru=null;for(var l=0;l<a.length;l++)(0,a[l])()}}function oM(a,l){var d=[],f={status:"pending",value:null,reason:null,then:function(x){d.push(x)}};return a.then(function(){f.status="fulfilled",f.value=l;for(var x=0;x<d.length;x++)(0,d[x])(l)},function(x){for(f.status="rejected",f.reason=x,x=0;x<d.length;x++)(0,d[x])(void 0)}),f}var A5=A.S;A.S=function(a,l){fE=Pe(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&aM(a,l),A5!==null&&A5(a,l)};var Sc=B(null);function tv(){var a=Sc.current;return a!==null?a:gn.pooledCache}function B0(a,l){l===null?ge(Sc,Sc.current):ge(Sc,l.pool)}function k5(){var a=tv();return a===null?null:{parent:rs._currentValue,pool:a}}var iu=Error(r(460)),nv=Error(r(474)),z0=Error(r(542)),$0={then:function(){}};function R5(a){return a=a.status,a==="fulfilled"||a==="rejected"}function D5(a,l,d){switch(d=a[d],d===void 0?a.push(l):d!==l&&(l.then(ki,ki),l=d),l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,O5(a),a;default:if(typeof l.status=="string")l.then(ki,ki);else{if(a=gn,a!==null&&100<a.shellSuspendCounter)throw Error(r(482));a=l,a.status="pending",a.then(function(f){if(l.status==="pending"){var x=l;x.status="fulfilled",x.value=f}},function(f){if(l.status==="pending"){var x=l;x.status="rejected",x.reason=f}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,O5(a),a}throw Tc=l,iu}}function Ec(a){try{var l=a._init;return l(a._payload)}catch(d){throw d!==null&&typeof d=="object"&&typeof d.then=="function"?(Tc=d,iu):d}}var Tc=null;function P5(){if(Tc===null)throw Error(r(459));var a=Tc;return Tc=null,a}function O5(a){if(a===iu||a===z0)throw Error(r(483))}var au=null,Nf=0;function q0(a){var l=Nf;return Nf+=1,au===null&&(au=[]),D5(au,a,l)}function jf(a,l){l=l.props.ref,a.ref=l!==void 0?l:null}function H0(a,l){throw l.$$typeof===v?Error(r(525)):(a=Object.prototype.toString.call(l),Error(r(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a)))}function M5(a){function l(de,oe){if(a){var Ne=de.deletions;Ne===null?(de.deletions=[oe],de.flags|=16):Ne.push(oe)}}function d(de,oe){if(!a)return null;for(;oe!==null;)l(de,oe),oe=oe.sibling;return null}function f(de){for(var oe=new Map;de!==null;)de.key!==null?oe.set(de.key,de):oe.set(de.index,de),de=de.sibling;return oe}function x(de,oe){return de=Ka(de,oe),de.index=0,de.sibling=null,de}function y(de,oe,Ne){return de.index=Ne,a?(Ne=de.alternate,Ne!==null?(Ne=Ne.index,Ne<oe?(de.flags|=67108866,oe):Ne):(de.flags|=67108866,oe)):(de.flags|=1048576,oe)}function C(de){return a&&de.alternate===null&&(de.flags|=67108866),de}function q(de,oe,Ne,Re){return oe===null||oe.tag!==6?(oe=qy(Ne,de.mode,Re),oe.return=de,oe):(oe=x(oe,Ne),oe.return=de,oe)}function se(de,oe,Ne,Re){var mt=Ne.type;return mt===k?ke(de,oe,Ne.props.children,Re,Ne.key):oe!==null&&(oe.elementType===mt||typeof mt=="object"&&mt!==null&&mt.$$typeof===j&&Ec(mt)===oe.type)?(oe=x(oe,Ne.props),jf(oe,Ne),oe.return=de,oe):(oe=L0(Ne.type,Ne.key,Ne.props,null,de.mode,Re),jf(oe,Ne),oe.return=de,oe)}function je(de,oe,Ne,Re){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==Ne.containerInfo||oe.stateNode.implementation!==Ne.implementation?(oe=Hy(Ne,de.mode,Re),oe.return=de,oe):(oe=x(oe,Ne.children||[]),oe.return=de,oe)}function ke(de,oe,Ne,Re,mt){return oe===null||oe.tag!==7?(oe=wc(Ne,de.mode,Re,mt),oe.return=de,oe):(oe=x(oe,Ne),oe.return=de,oe)}function De(de,oe,Ne){if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return oe=qy(""+oe,de.mode,Ne),oe.return=de,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case _:return Ne=L0(oe.type,oe.key,oe.props,null,de.mode,Ne),jf(Ne,oe),Ne.return=de,Ne;case T:return oe=Hy(oe,de.mode,Ne),oe.return=de,oe;case j:return oe=Ec(oe),De(de,oe,Ne)}if(U(oe)||F(oe))return oe=wc(oe,de.mode,Ne,null),oe.return=de,oe;if(typeof oe.then=="function")return De(de,q0(oe),Ne);if(oe.$$typeof===$)return De(de,U0(de,oe),Ne);H0(de,oe)}return null}function Se(de,oe,Ne,Re){var mt=oe!==null?oe.key:null;if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return mt!==null?null:q(de,oe,""+Ne,Re);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case _:return Ne.key===mt?se(de,oe,Ne,Re):null;case T:return Ne.key===mt?je(de,oe,Ne,Re):null;case j:return Ne=Ec(Ne),Se(de,oe,Ne,Re)}if(U(Ne)||F(Ne))return mt!==null?null:ke(de,oe,Ne,Re,null);if(typeof Ne.then=="function")return Se(de,oe,q0(Ne),Re);if(Ne.$$typeof===$)return Se(de,oe,U0(de,Ne),Re);H0(de,Ne)}return null}function Ce(de,oe,Ne,Re,mt){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return de=de.get(Ne)||null,q(oe,de,""+Re,mt);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case _:return de=de.get(Re.key===null?Ne:Re.key)||null,se(oe,de,Re,mt);case T:return de=de.get(Re.key===null?Ne:Re.key)||null,je(oe,de,Re,mt);case j:return Re=Ec(Re),Ce(de,oe,Ne,Re,mt)}if(U(Re)||F(Re))return de=de.get(Ne)||null,ke(oe,de,Re,mt,null);if(typeof Re.then=="function")return Ce(de,oe,Ne,q0(Re),mt);if(Re.$$typeof===$)return Ce(de,oe,Ne,U0(oe,Re),mt);H0(oe,Re)}return null}function nt(de,oe,Ne,Re){for(var mt=null,Gt=null,ot=oe,Rt=oe=0,Bt=null;ot!==null&&Rt<Ne.length;Rt++){ot.index>Rt?(Bt=ot,ot=null):Bt=ot.sibling;var Wt=Se(de,ot,Ne[Rt],Re);if(Wt===null){ot===null&&(ot=Bt);break}a&&ot&&Wt.alternate===null&&l(de,ot),oe=y(Wt,oe,Rt),Gt===null?mt=Wt:Gt.sibling=Wt,Gt=Wt,ot=Bt}if(Rt===Ne.length)return d(de,ot),qt&&Qa(de,Rt),mt;if(ot===null){for(;Rt<Ne.length;Rt++)ot=De(de,Ne[Rt],Re),ot!==null&&(oe=y(ot,oe,Rt),Gt===null?mt=ot:Gt.sibling=ot,Gt=ot);return qt&&Qa(de,Rt),mt}for(ot=f(ot);Rt<Ne.length;Rt++)Bt=Ce(ot,de,Rt,Ne[Rt],Re),Bt!==null&&(a&&Bt.alternate!==null&&ot.delete(Bt.key===null?Rt:Bt.key),oe=y(Bt,oe,Rt),Gt===null?mt=Bt:Gt.sibling=Bt,Gt=Bt);return a&&ot.forEach(function(fl){return l(de,fl)}),qt&&Qa(de,Rt),mt}function pt(de,oe,Ne,Re){if(Ne==null)throw Error(r(151));for(var mt=null,Gt=null,ot=oe,Rt=oe=0,Bt=null,Wt=Ne.next();ot!==null&&!Wt.done;Rt++,Wt=Ne.next()){ot.index>Rt?(Bt=ot,ot=null):Bt=ot.sibling;var fl=Se(de,ot,Wt.value,Re);if(fl===null){ot===null&&(ot=Bt);break}a&&ot&&fl.alternate===null&&l(de,ot),oe=y(fl,oe,Rt),Gt===null?mt=fl:Gt.sibling=fl,Gt=fl,ot=Bt}if(Wt.done)return d(de,ot),qt&&Qa(de,Rt),mt;if(ot===null){for(;!Wt.done;Rt++,Wt=Ne.next())Wt=De(de,Wt.value,Re),Wt!==null&&(oe=y(Wt,oe,Rt),Gt===null?mt=Wt:Gt.sibling=Wt,Gt=Wt);return qt&&Qa(de,Rt),mt}for(ot=f(ot);!Wt.done;Rt++,Wt=Ne.next())Wt=Ce(ot,de,Rt,Wt.value,Re),Wt!==null&&(a&&Wt.alternate!==null&&ot.delete(Wt.key===null?Rt:Wt.key),oe=y(Wt,oe,Rt),Gt===null?mt=Wt:Gt.sibling=Wt,Gt=Wt);return a&&ot.forEach(function(bL){return l(de,bL)}),qt&&Qa(de,Rt),mt}function mn(de,oe,Ne,Re){if(typeof Ne=="object"&&Ne!==null&&Ne.type===k&&Ne.key===null&&(Ne=Ne.props.children),typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case _:e:{for(var mt=Ne.key;oe!==null;){if(oe.key===mt){if(mt=Ne.type,mt===k){if(oe.tag===7){d(de,oe.sibling),Re=x(oe,Ne.props.children),Re.return=de,de=Re;break e}}else if(oe.elementType===mt||typeof mt=="object"&&mt!==null&&mt.$$typeof===j&&Ec(mt)===oe.type){d(de,oe.sibling),Re=x(oe,Ne.props),jf(Re,Ne),Re.return=de,de=Re;break e}d(de,oe);break}else l(de,oe);oe=oe.sibling}Ne.type===k?(Re=wc(Ne.props.children,de.mode,Re,Ne.key),Re.return=de,de=Re):(Re=L0(Ne.type,Ne.key,Ne.props,null,de.mode,Re),jf(Re,Ne),Re.return=de,de=Re)}return C(de);case T:e:{for(mt=Ne.key;oe!==null;){if(oe.key===mt)if(oe.tag===4&&oe.stateNode.containerInfo===Ne.containerInfo&&oe.stateNode.implementation===Ne.implementation){d(de,oe.sibling),Re=x(oe,Ne.children||[]),Re.return=de,de=Re;break e}else{d(de,oe);break}else l(de,oe);oe=oe.sibling}Re=Hy(Ne,de.mode,Re),Re.return=de,de=Re}return C(de);case j:return Ne=Ec(Ne),mn(de,oe,Ne,Re)}if(U(Ne))return nt(de,oe,Ne,Re);if(F(Ne)){if(mt=F(Ne),typeof mt!="function")throw Error(r(150));return Ne=mt.call(Ne),pt(de,oe,Ne,Re)}if(typeof Ne.then=="function")return mn(de,oe,q0(Ne),Re);if(Ne.$$typeof===$)return mn(de,oe,U0(de,Ne),Re);H0(de,Ne)}return typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint"?(Ne=""+Ne,oe!==null&&oe.tag===6?(d(de,oe.sibling),Re=x(oe,Ne),Re.return=de,de=Re):(d(de,oe),Re=qy(Ne,de.mode,Re),Re.return=de,de=Re),C(de)):d(de,oe)}return function(de,oe,Ne,Re){try{Nf=0;var mt=mn(de,oe,Ne,Re);return au=null,mt}catch(ot){if(ot===iu||ot===z0)throw ot;var Gt=Vr(29,ot,null,de.mode);return Gt.lanes=Re,Gt.return=de,Gt}finally{}}}var Ic=M5(!0),L5=M5(!1),Yo=!1;function sv(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rv(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Xo(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Jo(a,l,d){var f=a.updateQueue;if(f===null)return null;if(f=f.shared,(Jt&2)!==0){var x=f.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),f.pending=l,l=M0(a),v5(a,null,d),l}return O0(a,f,l,d),M0(a)}function Sf(a,l,d){if(l=l.updateQueue,l!==null&&(l=l.shared,(d&4194048)!==0)){var f=l.lanes;f&=a.pendingLanes,d|=f,l.lanes=d,es(a,d)}}function iv(a,l){var d=a.updateQueue,f=a.alternate;if(f!==null&&(f=f.updateQueue,d===f)){var x=null,y=null;if(d=d.firstBaseUpdate,d!==null){do{var C={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};y===null?x=y=C:y=y.next=C,d=d.next}while(d!==null);y===null?x=y=l:y=y.next=l}else x=y=l;d={baseState:f.baseState,firstBaseUpdate:x,lastBaseUpdate:y,shared:f.shared,callbacks:f.callbacks},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=l:a.next=l,d.lastBaseUpdate=l}var av=!1;function Ef(){if(av){var a=ru;if(a!==null)throw a}}function Tf(a,l,d,f){av=!1;var x=a.updateQueue;Yo=!1;var y=x.firstBaseUpdate,C=x.lastBaseUpdate,q=x.shared.pending;if(q!==null){x.shared.pending=null;var se=q,je=se.next;se.next=null,C===null?y=je:C.next=je,C=se;var ke=a.alternate;ke!==null&&(ke=ke.updateQueue,q=ke.lastBaseUpdate,q!==C&&(q===null?ke.firstBaseUpdate=je:q.next=je,ke.lastBaseUpdate=se))}if(y!==null){var De=x.baseState;C=0,ke=je=se=null,q=y;do{var Se=q.lane&-536870913,Ce=Se!==q.lane;if(Ce?(Ut&Se)===Se:(f&Se)===Se){Se!==0&&Se===su&&(av=!0),ke!==null&&(ke=ke.next={lane:0,tag:q.tag,payload:q.payload,callback:null,next:null});e:{var nt=a,pt=q;Se=l;var mn=d;switch(pt.tag){case 1:if(nt=pt.payload,typeof nt=="function"){De=nt.call(mn,De,Se);break e}De=nt;break e;case 3:nt.flags=nt.flags&-65537|128;case 0:if(nt=pt.payload,Se=typeof nt=="function"?nt.call(mn,De,Se):nt,Se==null)break e;De=b({},De,Se);break e;case 2:Yo=!0}}Se=q.callback,Se!==null&&(a.flags|=64,Ce&&(a.flags|=8192),Ce=x.callbacks,Ce===null?x.callbacks=[Se]:Ce.push(Se))}else Ce={lane:Se,tag:q.tag,payload:q.payload,callback:q.callback,next:null},ke===null?(je=ke=Ce,se=De):ke=ke.next=Ce,C|=Se;if(q=q.next,q===null){if(q=x.shared.pending,q===null)break;Ce=q,q=Ce.next,Ce.next=null,x.lastBaseUpdate=Ce,x.shared.pending=null}}while(!0);ke===null&&(se=De),x.baseState=se,x.firstBaseUpdate=je,x.lastBaseUpdate=ke,y===null&&(x.shared.lanes=0),sl|=C,a.lanes=C,a.memoizedState=De}}function V5(a,l){if(typeof a!="function")throw Error(r(191,a));a.call(l)}function F5(a,l){var d=a.callbacks;if(d!==null)for(a.callbacks=null,a=0;a<d.length;a++)V5(d[a],l)}var ou=B(null),G0=B(0);function U5(a,l){a=ao,ge(G0,a),ge(ou,l),ao=a|l.baseLanes}function ov(){ge(G0,ao),ge(ou,ou.current)}function lv(){ao=G0.current,Y(ou),Y(G0)}var Fr=B(null),hi=null;function Zo(a){var l=a.alternate;ge(Kn,Kn.current&1),ge(Fr,a),hi===null&&(l===null||ou.current!==null||l.memoizedState!==null)&&(hi=a)}function cv(a){ge(Kn,Kn.current),ge(Fr,a),hi===null&&(hi=a)}function B5(a){a.tag===22?(ge(Kn,Kn.current),ge(Fr,a),hi===null&&(hi=a)):el()}function el(){ge(Kn,Kn.current),ge(Fr,Fr.current)}function Ur(a){Y(Fr),hi===a&&(hi=null),Y(Kn)}var Kn=B(0);function W0(a){for(var l=a;l!==null;){if(l.tag===13){var d=l.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||gw(d)||pw(d)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Ja=0,At=null,hn=null,is=null,K0=!1,lu=!1,Cc=!1,Q0=0,If=0,cu=null,lM=0;function Un(){throw Error(r(321))}function dv(a,l){if(l===null)return!1;for(var d=0;d<l.length&&d<a.length;d++)if(!Lr(a[d],l[d]))return!1;return!0}function uv(a,l,d,f,x,y){return Ja=y,At=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,A.H=a===null||a.memoizedState===null?jS:Ev,Cc=!1,y=d(f,x),Cc=!1,lu&&(y=$5(l,d,f,x)),z5(a),y}function z5(a){A.H=kf;var l=hn!==null&&hn.next!==null;if(Ja=0,is=hn=At=null,K0=!1,If=0,cu=null,l)throw Error(r(300));a===null||as||(a=a.dependencies,a!==null&&F0(a)&&(as=!0))}function $5(a,l,d,f){At=a;var x=0;do{if(lu&&(cu=null),If=0,lu=!1,25<=x)throw Error(r(301));if(x+=1,is=hn=null,a.updateQueue!=null){var y=a.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}A.H=SS,y=l(d,f)}while(lu);return y}function cM(){var a=A.H,l=a.useState()[0];return l=typeof l.then=="function"?Cf(l):l,a=a.useState()[0],(hn!==null?hn.memoizedState:null)!==a&&(At.flags|=1024),l}function hv(){var a=Q0!==0;return Q0=0,a}function fv(a,l,d){l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~d}function mv(a){if(K0){for(a=a.memoizedState;a!==null;){var l=a.queue;l!==null&&(l.pending=null),a=a.next}K0=!1}Ja=0,is=hn=At=null,lu=!1,If=Q0=0,cu=null}function tr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return is===null?At.memoizedState=is=a:is=is.next=a,is}function Qn(){if(hn===null){var a=At.alternate;a=a!==null?a.memoizedState:null}else a=hn.next;var l=is===null?At.memoizedState:is.next;if(l!==null)is=l,hn=a;else{if(a===null)throw At.alternate===null?Error(r(467)):Error(r(310));hn=a,a={memoizedState:hn.memoizedState,baseState:hn.baseState,baseQueue:hn.baseQueue,queue:hn.queue,next:null},is===null?At.memoizedState=is=a:is=is.next=a}return is}function Y0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Cf(a){var l=If;return If+=1,cu===null&&(cu=[]),a=D5(cu,a,l),l=At,(is===null?l.memoizedState:is.next)===null&&(l=l.alternate,A.H=l===null||l.memoizedState===null?jS:Ev),a}function X0(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Cf(a);if(a.$$typeof===$)return Ps(a)}throw Error(r(438,String(a)))}function gv(a){var l=null,d=At.updateQueue;if(d!==null&&(l=d.memoCache),l==null){var f=At.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(l={data:f.data.map(function(x){return x.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),d===null&&(d=Y0(),At.updateQueue=d),d.memoCache=l,d=l.data[l.index],d===void 0)for(d=l.data[l.index]=Array(a),f=0;f<a;f++)d[f]=I;return l.index++,d}function Za(a,l){return typeof l=="function"?l(a):l}function J0(a){var l=Qn();return pv(l,hn,a)}function pv(a,l,d){var f=a.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=d;var x=a.baseQueue,y=f.pending;if(y!==null){if(x!==null){var C=x.next;x.next=y.next,y.next=C}l.baseQueue=x=y,f.pending=null}if(y=a.baseState,x===null)a.memoizedState=y;else{l=x.next;var q=C=null,se=null,je=l,ke=!1;do{var De=je.lane&-536870913;if(De!==je.lane?(Ut&De)===De:(Ja&De)===De){var Se=je.revertLane;if(Se===0)se!==null&&(se=se.next={lane:0,revertLane:0,gesture:null,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null}),De===su&&(ke=!0);else if((Ja&Se)===Se){je=je.next,Se===su&&(ke=!0);continue}else De={lane:0,revertLane:je.revertLane,gesture:null,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null},se===null?(q=se=De,C=y):se=se.next=De,At.lanes|=Se,sl|=Se;De=je.action,Cc&&d(y,De),y=je.hasEagerState?je.eagerState:d(y,De)}else Se={lane:De,revertLane:je.revertLane,gesture:je.gesture,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null},se===null?(q=se=Se,C=y):se=se.next=Se,At.lanes|=De,sl|=De;je=je.next}while(je!==null&&je!==l);if(se===null?C=y:se.next=q,!Lr(y,a.memoizedState)&&(as=!0,ke&&(d=ru,d!==null)))throw d;a.memoizedState=y,a.baseState=C,a.baseQueue=se,f.lastRenderedState=y}return x===null&&(f.lanes=0),[a.memoizedState,f.dispatch]}function xv(a){var l=Qn(),d=l.queue;if(d===null)throw Error(r(311));d.lastRenderedReducer=a;var f=d.dispatch,x=d.pending,y=l.memoizedState;if(x!==null){d.pending=null;var C=x=x.next;do y=a(y,C.action),C=C.next;while(C!==x);Lr(y,l.memoizedState)||(as=!0),l.memoizedState=y,l.baseQueue===null&&(l.baseState=y),d.lastRenderedState=y}return[y,f]}function q5(a,l,d){var f=At,x=Qn(),y=qt;if(y){if(d===void 0)throw Error(r(407));d=d()}else d=l();var C=!Lr((hn||x).memoizedState,d);if(C&&(x.memoizedState=d,as=!0),x=x.queue,vv(W5.bind(null,f,x,a),[a]),x.getSnapshot!==l||C||is!==null&&is.memoizedState.tag&1){if(f.flags|=2048,du(9,{destroy:void 0},G5.bind(null,f,x,d,l),null),gn===null)throw Error(r(349));y||(Ja&127)!==0||H5(f,l,d)}return d}function H5(a,l,d){a.flags|=16384,a={getSnapshot:l,value:d},l=At.updateQueue,l===null?(l=Y0(),At.updateQueue=l,l.stores=[a]):(d=l.stores,d===null?l.stores=[a]:d.push(a))}function G5(a,l,d,f){l.value=d,l.getSnapshot=f,K5(l)&&Q5(a)}function W5(a,l,d){return d(function(){K5(l)&&Q5(a)})}function K5(a){var l=a.getSnapshot;a=a.value;try{var d=l();return!Lr(a,d)}catch{return!0}}function Q5(a){var l=vc(a,2);l!==null&&wr(l,a,2)}function bv(a){var l=tr();if(typeof a=="function"){var d=a;if(a=d(),Cc){Ge(!0);try{d()}finally{Ge(!1)}}}return l.memoizedState=l.baseState=a,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:a},l}function Y5(a,l,d,f){return a.baseState=d,pv(a,hn,typeof f=="function"?f:Za)}function dM(a,l,d,f,x){if(tp(a))throw Error(r(485));if(a=l.action,a!==null){var y={payload:x,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(C){y.listeners.push(C)}};A.T!==null?d(!0):y.isTransition=!1,f(y),d=l.pending,d===null?(y.next=l.pending=y,X5(l,y)):(y.next=d.next,l.pending=d.next=y)}}function X5(a,l){var d=l.action,f=l.payload,x=a.state;if(l.isTransition){var y=A.T,C={};A.T=C;try{var q=d(x,f),se=A.S;se!==null&&se(C,q),J5(a,l,q)}catch(je){yv(a,l,je)}finally{y!==null&&C.types!==null&&(y.types=C.types),A.T=y}}else try{y=d(x,f),J5(a,l,y)}catch(je){yv(a,l,je)}}function J5(a,l,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(f){Z5(a,l,f)},function(f){return yv(a,l,f)}):Z5(a,l,d)}function Z5(a,l,d){l.status="fulfilled",l.value=d,eS(l),a.state=d,l=a.pending,l!==null&&(d=l.next,d===l?a.pending=null:(d=d.next,l.next=d,X5(a,d)))}function yv(a,l,d){var f=a.pending;if(a.pending=null,f!==null){f=f.next;do l.status="rejected",l.reason=d,eS(l),l=l.next;while(l!==f)}a.action=null}function eS(a){a=a.listeners;for(var l=0;l<a.length;l++)(0,a[l])()}function tS(a,l){return l}function nS(a,l){if(qt){var d=gn.formState;if(d!==null){e:{var f=At;if(qt){if(wn){t:{for(var x=wn,y=ui;x.nodeType!==8;){if(!y){x=null;break t}if(x=fi(x.nextSibling),x===null){x=null;break t}}y=x.data,x=y==="F!"||y==="F"?x:null}if(x){wn=fi(x.nextSibling),f=x.data==="F!";break e}}Ko(f)}f=!1}f&&(l=d[0])}}return d=tr(),d.memoizedState=d.baseState=l,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:tS,lastRenderedState:l},d.queue=f,d=wS.bind(null,At,f),f.dispatch=d,f=bv(!1),y=Sv.bind(null,At,!1,f.queue),f=tr(),x={state:l,dispatch:null,action:a,pending:null},f.queue=x,d=dM.bind(null,At,x,y,d),x.dispatch=d,f.memoizedState=a,[l,d,!1]}function sS(a){var l=Qn();return rS(l,hn,a)}function rS(a,l,d){if(l=pv(a,l,tS)[0],a=J0(Za)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var f=Cf(l)}catch(C){throw C===iu?z0:C}else f=l;l=Qn();var x=l.queue,y=x.dispatch;return d!==l.memoizedState&&(At.flags|=2048,du(9,{destroy:void 0},uM.bind(null,x,d),null)),[f,y,a]}function uM(a,l){a.action=l}function iS(a){var l=Qn(),d=hn;if(d!==null)return rS(l,d,a);Qn(),l=l.memoizedState,d=Qn();var f=d.queue.dispatch;return d.memoizedState=a,[l,f,!1]}function du(a,l,d,f){return a={tag:a,create:d,deps:f,inst:l,next:null},l=At.updateQueue,l===null&&(l=Y0(),At.updateQueue=l),d=l.lastEffect,d===null?l.lastEffect=a.next=a:(f=d.next,d.next=a,a.next=f,l.lastEffect=a),a}function aS(){return Qn().memoizedState}function Z0(a,l,d,f){var x=tr();At.flags|=a,x.memoizedState=du(1|l,{destroy:void 0},d,f===void 0?null:f)}function ep(a,l,d,f){var x=Qn();f=f===void 0?null:f;var y=x.memoizedState.inst;hn!==null&&f!==null&&dv(f,hn.memoizedState.deps)?x.memoizedState=du(l,y,d,f):(At.flags|=a,x.memoizedState=du(1|l,y,d,f))}function oS(a,l){Z0(8390656,8,a,l)}function vv(a,l){ep(2048,8,a,l)}function hM(a){At.flags|=4;var l=At.updateQueue;if(l===null)l=Y0(),At.updateQueue=l,l.events=[a];else{var d=l.events;d===null?l.events=[a]:d.push(a)}}function lS(a){var l=Qn().memoizedState;return hM({ref:l,nextImpl:a}),function(){if((Jt&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function cS(a,l){return ep(4,2,a,l)}function dS(a,l){return ep(4,4,a,l)}function uS(a,l){if(typeof l=="function"){a=a();var d=l(a);return function(){typeof d=="function"?d():l(null)}}if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function hS(a,l,d){d=d!=null?d.concat([a]):null,ep(4,4,uS.bind(null,l,a),d)}function wv(){}function fS(a,l){var d=Qn();l=l===void 0?null:l;var f=d.memoizedState;return l!==null&&dv(l,f[1])?f[0]:(d.memoizedState=[a,l],a)}function mS(a,l){var d=Qn();l=l===void 0?null:l;var f=d.memoizedState;if(l!==null&&dv(l,f[1]))return f[0];if(f=a(),Cc){Ge(!0);try{a()}finally{Ge(!1)}}return d.memoizedState=[f,l],f}function _v(a,l,d){return d===void 0||(Ja&1073741824)!==0&&(Ut&261930)===0?a.memoizedState=l:(a.memoizedState=d,a=gE(),At.lanes|=a,sl|=a,d)}function gS(a,l,d,f){return Lr(d,l)?d:ou.current!==null?(a=_v(a,d,f),Lr(a,l)||(as=!0),a):(Ja&42)===0||(Ja&1073741824)!==0&&(Ut&261930)===0?(as=!0,a.memoizedState=d):(a=gE(),At.lanes|=a,sl|=a,l)}function pS(a,l,d,f,x){var y=V.p;V.p=y!==0&&8>y?y:8;var C=A.T,q={};A.T=q,Sv(a,!1,l,d);try{var se=x(),je=A.S;if(je!==null&&je(q,se),se!==null&&typeof se=="object"&&typeof se.then=="function"){var ke=oM(se,f);Af(a,l,ke,$r(a))}else Af(a,l,f,$r(a))}catch(De){Af(a,l,{then:function(){},status:"rejected",reason:De},$r())}finally{V.p=y,C!==null&&q.types!==null&&(C.types=q.types),A.T=C}}function fM(){}function Nv(a,l,d,f){if(a.tag!==5)throw Error(r(476));var x=xS(a).queue;pS(a,x,l,Q,d===null?fM:function(){return bS(a),d(f)})}function xS(a){var l=a.memoizedState;if(l!==null)return l;l={memoizedState:Q,baseState:Q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:Q},next:null};var d={};return l.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:d},next:null},a.memoizedState=l,a=a.alternate,a!==null&&(a.memoizedState=l),l}function bS(a){var l=xS(a);l.next===null&&(l=a.alternate.memoizedState),Af(a,l.next.queue,{},$r())}function jv(){return Ps(Wf)}function yS(){return Qn().memoizedState}function vS(){return Qn().memoizedState}function mM(a){for(var l=a.return;l!==null;){switch(l.tag){case 24:case 3:var d=$r();a=Xo(d);var f=Jo(l,a,d);f!==null&&(wr(f,l,d),Sf(f,l,d)),l={cache:Zy()},a.payload=l;return}l=l.return}}function gM(a,l,d){var f=$r();d={lane:f,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},tp(a)?_S(l,d):(d=zy(a,l,d,f),d!==null&&(wr(d,a,f),NS(d,l,f)))}function wS(a,l,d){var f=$r();Af(a,l,d,f)}function Af(a,l,d,f){var x={lane:f,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null};if(tp(a))_S(l,x);else{var y=a.alternate;if(a.lanes===0&&(y===null||y.lanes===0)&&(y=l.lastRenderedReducer,y!==null))try{var C=l.lastRenderedState,q=y(C,d);if(x.hasEagerState=!0,x.eagerState=q,Lr(q,C))return O0(a,l,x,0),gn===null&&P0(),!1}catch{}finally{}if(d=zy(a,l,x,f),d!==null)return wr(d,a,f),NS(d,l,f),!0}return!1}function Sv(a,l,d,f){if(f={lane:2,revertLane:sw(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},tp(a)){if(l)throw Error(r(479))}else l=zy(a,d,f,2),l!==null&&wr(l,a,2)}function tp(a){var l=a.alternate;return a===At||l!==null&&l===At}function _S(a,l){lu=K0=!0;var d=a.pending;d===null?l.next=l:(l.next=d.next,d.next=l),a.pending=l}function NS(a,l,d){if((d&4194048)!==0){var f=l.lanes;f&=a.pendingLanes,d|=f,l.lanes=d,es(a,d)}}var kf={readContext:Ps,use:X0,useCallback:Un,useContext:Un,useEffect:Un,useImperativeHandle:Un,useLayoutEffect:Un,useInsertionEffect:Un,useMemo:Un,useReducer:Un,useRef:Un,useState:Un,useDebugValue:Un,useDeferredValue:Un,useTransition:Un,useSyncExternalStore:Un,useId:Un,useHostTransitionStatus:Un,useFormState:Un,useActionState:Un,useOptimistic:Un,useMemoCache:Un,useCacheRefresh:Un};kf.useEffectEvent=Un;var jS={readContext:Ps,use:X0,useCallback:function(a,l){return tr().memoizedState=[a,l===void 0?null:l],a},useContext:Ps,useEffect:oS,useImperativeHandle:function(a,l,d){d=d!=null?d.concat([a]):null,Z0(4194308,4,uS.bind(null,l,a),d)},useLayoutEffect:function(a,l){return Z0(4194308,4,a,l)},useInsertionEffect:function(a,l){Z0(4,2,a,l)},useMemo:function(a,l){var d=tr();l=l===void 0?null:l;var f=a();if(Cc){Ge(!0);try{a()}finally{Ge(!1)}}return d.memoizedState=[f,l],f},useReducer:function(a,l,d){var f=tr();if(d!==void 0){var x=d(l);if(Cc){Ge(!0);try{d(l)}finally{Ge(!1)}}}else x=l;return f.memoizedState=f.baseState=x,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:x},f.queue=a,a=a.dispatch=gM.bind(null,At,a),[f.memoizedState,a]},useRef:function(a){var l=tr();return a={current:a},l.memoizedState=a},useState:function(a){a=bv(a);var l=a.queue,d=wS.bind(null,At,l);return l.dispatch=d,[a.memoizedState,d]},useDebugValue:wv,useDeferredValue:function(a,l){var d=tr();return _v(d,a,l)},useTransition:function(){var a=bv(!1);return a=pS.bind(null,At,a.queue,!0,!1),tr().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,l,d){var f=At,x=tr();if(qt){if(d===void 0)throw Error(r(407));d=d()}else{if(d=l(),gn===null)throw Error(r(349));(Ut&127)!==0||H5(f,l,d)}x.memoizedState=d;var y={value:d,getSnapshot:l};return x.queue=y,oS(W5.bind(null,f,y,a),[a]),f.flags|=2048,du(9,{destroy:void 0},G5.bind(null,f,y,d,l),null),d},useId:function(){var a=tr(),l=gn.identifierPrefix;if(qt){var d=ga,f=ma;d=(f&~(1<<32-We(f)-1)).toString(32)+d,l="_"+l+"R_"+d,d=Q0++,0<d&&(l+="H"+d.toString(32)),l+="_"}else d=lM++,l="_"+l+"r_"+d.toString(32)+"_";return a.memoizedState=l},useHostTransitionStatus:jv,useFormState:nS,useActionState:nS,useOptimistic:function(a){var l=tr();l.memoizedState=l.baseState=a;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=d,l=Sv.bind(null,At,!0,d),d.dispatch=l,[a,l]},useMemoCache:gv,useCacheRefresh:function(){return tr().memoizedState=mM.bind(null,At)},useEffectEvent:function(a){var l=tr(),d={impl:a};return l.memoizedState=d,function(){if((Jt&2)!==0)throw Error(r(440));return d.impl.apply(void 0,arguments)}}},Ev={readContext:Ps,use:X0,useCallback:fS,useContext:Ps,useEffect:vv,useImperativeHandle:hS,useInsertionEffect:cS,useLayoutEffect:dS,useMemo:mS,useReducer:J0,useRef:aS,useState:function(){return J0(Za)},useDebugValue:wv,useDeferredValue:function(a,l){var d=Qn();return gS(d,hn.memoizedState,a,l)},useTransition:function(){var a=J0(Za)[0],l=Qn().memoizedState;return[typeof a=="boolean"?a:Cf(a),l]},useSyncExternalStore:q5,useId:yS,useHostTransitionStatus:jv,useFormState:sS,useActionState:sS,useOptimistic:function(a,l){var d=Qn();return Y5(d,hn,a,l)},useMemoCache:gv,useCacheRefresh:vS};Ev.useEffectEvent=lS;var SS={readContext:Ps,use:X0,useCallback:fS,useContext:Ps,useEffect:vv,useImperativeHandle:hS,useInsertionEffect:cS,useLayoutEffect:dS,useMemo:mS,useReducer:xv,useRef:aS,useState:function(){return xv(Za)},useDebugValue:wv,useDeferredValue:function(a,l){var d=Qn();return hn===null?_v(d,a,l):gS(d,hn.memoizedState,a,l)},useTransition:function(){var a=xv(Za)[0],l=Qn().memoizedState;return[typeof a=="boolean"?a:Cf(a),l]},useSyncExternalStore:q5,useId:yS,useHostTransitionStatus:jv,useFormState:iS,useActionState:iS,useOptimistic:function(a,l){var d=Qn();return hn!==null?Y5(d,hn,a,l):(d.baseState=a,[a,d.queue.dispatch])},useMemoCache:gv,useCacheRefresh:vS};SS.useEffectEvent=lS;function Tv(a,l,d,f){l=a.memoizedState,d=d(f,l),d=d==null?l:b({},l,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var Iv={enqueueSetState:function(a,l,d){a=a._reactInternals;var f=$r(),x=Xo(f);x.payload=l,d!=null&&(x.callback=d),l=Jo(a,x,f),l!==null&&(wr(l,a,f),Sf(l,a,f))},enqueueReplaceState:function(a,l,d){a=a._reactInternals;var f=$r(),x=Xo(f);x.tag=1,x.payload=l,d!=null&&(x.callback=d),l=Jo(a,x,f),l!==null&&(wr(l,a,f),Sf(l,a,f))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var d=$r(),f=Xo(d);f.tag=2,l!=null&&(f.callback=l),l=Jo(a,f,d),l!==null&&(wr(l,a,d),Sf(l,a,d))}};function ES(a,l,d,f,x,y,C){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(f,y,C):l.prototype&&l.prototype.isPureReactComponent?!xf(d,f)||!xf(x,y):!0}function TS(a,l,d,f){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(d,f),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(d,f),l.state!==a&&Iv.enqueueReplaceState(l,l.state,null)}function Ac(a,l){var d=l;if("ref"in l){d={};for(var f in l)f!=="ref"&&(d[f]=l[f])}if(a=a.defaultProps){d===l&&(d=b({},d));for(var x in a)d[x]===void 0&&(d[x]=a[x])}return d}function IS(a){D0(a)}function CS(a){console.error(a)}function AS(a){D0(a)}function np(a,l){try{var d=a.onUncaughtError;d(l.value,{componentStack:l.stack})}catch(f){setTimeout(function(){throw f})}}function kS(a,l,d){try{var f=a.onCaughtError;f(d.value,{componentStack:d.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Cv(a,l,d){return d=Xo(d),d.tag=3,d.payload={element:null},d.callback=function(){np(a,l)},d}function RS(a){return a=Xo(a),a.tag=3,a}function DS(a,l,d,f){var x=d.type.getDerivedStateFromError;if(typeof x=="function"){var y=f.value;a.payload=function(){return x(y)},a.callback=function(){kS(l,d,f)}}var C=d.stateNode;C!==null&&typeof C.componentDidCatch=="function"&&(a.callback=function(){kS(l,d,f),typeof x!="function"&&(rl===null?rl=new Set([this]):rl.add(this));var q=f.stack;this.componentDidCatch(f.value,{componentStack:q!==null?q:""})})}function pM(a,l,d,f,x){if(d.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(l=d.alternate,l!==null&&nu(l,d,x,!0),d=Fr.current,d!==null){switch(d.tag){case 31:case 13:return hi===null?mp():d.alternate===null&&Bn===0&&(Bn=3),d.flags&=-257,d.flags|=65536,d.lanes=x,f===$0?d.flags|=16384:(l=d.updateQueue,l===null?d.updateQueue=new Set([f]):l.add(f),ew(a,f,x)),!1;case 22:return d.flags|=65536,f===$0?d.flags|=16384:(l=d.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([f])},d.updateQueue=l):(d=l.retryQueue,d===null?l.retryQueue=new Set([f]):d.add(f)),ew(a,f,x)),!1}throw Error(r(435,d.tag))}return ew(a,f,x),mp(),!1}if(qt)return l=Fr.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=x,f!==Ky&&(a=Error(r(422),{cause:f}),vf(li(a,d)))):(f!==Ky&&(l=Error(r(423),{cause:f}),vf(li(l,d))),a=a.current.alternate,a.flags|=65536,x&=-x,a.lanes|=x,f=li(f,d),x=Cv(a.stateNode,f,x),iv(a,x),Bn!==4&&(Bn=2)),!1;var y=Error(r(520),{cause:f});if(y=li(y,d),Ff===null?Ff=[y]:Ff.push(y),Bn!==4&&(Bn=2),l===null)return!0;f=li(f,d),d=l;do{switch(d.tag){case 3:return d.flags|=65536,a=x&-x,d.lanes|=a,a=Cv(d.stateNode,f,a),iv(d,a),!1;case 1:if(l=d.type,y=d.stateNode,(d.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(rl===null||!rl.has(y))))return d.flags|=65536,x&=-x,d.lanes|=x,x=RS(x),DS(x,a,d,f),iv(d,x),!1}d=d.return}while(d!==null);return!1}var Av=Error(r(461)),as=!1;function Os(a,l,d,f){l.child=a===null?L5(l,null,d,f):Ic(l,a.child,d,f)}function PS(a,l,d,f,x){d=d.render;var y=l.ref;if("ref"in f){var C={};for(var q in f)q!=="ref"&&(C[q]=f[q])}else C=f;return jc(l),f=uv(a,l,d,C,y,x),q=hv(),a!==null&&!as?(fv(a,l,x),eo(a,l,x)):(qt&&q&&Gy(l),l.flags|=1,Os(a,l,f,x),l.child)}function OS(a,l,d,f,x){if(a===null){var y=d.type;return typeof y=="function"&&!$y(y)&&y.defaultProps===void 0&&d.compare===null?(l.tag=15,l.type=y,MS(a,l,y,f,x)):(a=L0(d.type,null,f,l,l.mode,x),a.ref=l.ref,a.return=l,l.child=a)}if(y=a.child,!Vv(a,x)){var C=y.memoizedProps;if(d=d.compare,d=d!==null?d:xf,d(C,f)&&a.ref===l.ref)return eo(a,l,x)}return l.flags|=1,a=Ka(y,f),a.ref=l.ref,a.return=l,l.child=a}function MS(a,l,d,f,x){if(a!==null){var y=a.memoizedProps;if(xf(y,f)&&a.ref===l.ref)if(as=!1,l.pendingProps=f=y,Vv(a,x))(a.flags&131072)!==0&&(as=!0);else return l.lanes=a.lanes,eo(a,l,x)}return kv(a,l,d,f,x)}function LS(a,l,d,f){var x=f.children,y=a!==null?a.memoizedState:null;if(a===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((l.flags&128)!==0){if(y=y!==null?y.baseLanes|d:d,a!==null){for(f=l.child=a.child,x=0;f!==null;)x=x|f.lanes|f.childLanes,f=f.sibling;f=x&~y}else f=0,l.child=null;return VS(a,l,y,d,f)}if((d&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},a!==null&&B0(l,y!==null?y.cachePool:null),y!==null?U5(l,y):ov(),B5(l);else return f=l.lanes=536870912,VS(a,l,y!==null?y.baseLanes|d:d,d,f)}else y!==null?(B0(l,y.cachePool),U5(l,y),el(),l.memoizedState=null):(a!==null&&B0(l,null),ov(),el());return Os(a,l,x,d),l.child}function Rf(a,l){return a!==null&&a.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function VS(a,l,d,f,x){var y=tv();return y=y===null?null:{parent:rs._currentValue,pool:y},l.memoizedState={baseLanes:d,cachePool:y},a!==null&&B0(l,null),ov(),B5(l),a!==null&&nu(a,l,f,!0),l.childLanes=x,null}function sp(a,l){return l=ip({mode:l.mode,children:l.children},a.mode),l.ref=a.ref,a.child=l,l.return=a,l}function FS(a,l,d){return Ic(l,a.child,null,d),a=sp(l,l.pendingProps),a.flags|=2,Ur(l),l.memoizedState=null,a}function xM(a,l,d){var f=l.pendingProps,x=(l.flags&128)!==0;if(l.flags&=-129,a===null){if(qt){if(f.mode==="hidden")return a=sp(l,f),l.lanes=536870912,Rf(null,a);if(cv(l),(a=wn)?(a=XE(a,ui),a=a!==null&&a.data==="&"?a:null,a!==null&&(l.memoizedState={dehydrated:a,treeContext:Go!==null?{id:ma,overflow:ga}:null,retryLane:536870912,hydrationErrors:null},d=_5(a),d.return=l,l.child=d,Ds=l,wn=null)):a=null,a===null)throw Ko(l);return l.lanes=536870912,null}return sp(l,f)}var y=a.memoizedState;if(y!==null){var C=y.dehydrated;if(cv(l),x)if(l.flags&256)l.flags&=-257,l=FS(a,l,d);else if(l.memoizedState!==null)l.child=a.child,l.flags|=128,l=null;else throw Error(r(558));else if(as||nu(a,l,d,!1),x=(d&a.childLanes)!==0,as||x){if(f=gn,f!==null&&(C=ni(f,d),C!==0&&C!==y.retryLane))throw y.retryLane=C,vc(a,C),wr(f,a,C),Av;mp(),l=FS(a,l,d)}else a=y.treeContext,wn=fi(C.nextSibling),Ds=l,qt=!0,Wo=null,ui=!1,a!==null&&S5(l,a),l=sp(l,f),l.flags|=4096;return l}return a=Ka(a.child,{mode:f.mode,children:f.children}),a.ref=l.ref,l.child=a,a.return=l,a}function rp(a,l){var d=l.ref;if(d===null)a!==null&&a.ref!==null&&(l.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(r(284));(a===null||a.ref!==d)&&(l.flags|=4194816)}}function kv(a,l,d,f,x){return jc(l),d=uv(a,l,d,f,void 0,x),f=hv(),a!==null&&!as?(fv(a,l,x),eo(a,l,x)):(qt&&f&&Gy(l),l.flags|=1,Os(a,l,d,x),l.child)}function US(a,l,d,f,x,y){return jc(l),l.updateQueue=null,d=$5(l,f,d,x),z5(a),f=hv(),a!==null&&!as?(fv(a,l,y),eo(a,l,y)):(qt&&f&&Gy(l),l.flags|=1,Os(a,l,d,y),l.child)}function BS(a,l,d,f,x){if(jc(l),l.stateNode===null){var y=Jd,C=d.contextType;typeof C=="object"&&C!==null&&(y=Ps(C)),y=new d(f,y),l.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Iv,l.stateNode=y,y._reactInternals=l,y=l.stateNode,y.props=f,y.state=l.memoizedState,y.refs={},sv(l),C=d.contextType,y.context=typeof C=="object"&&C!==null?Ps(C):Jd,y.state=l.memoizedState,C=d.getDerivedStateFromProps,typeof C=="function"&&(Tv(l,d,C,f),y.state=l.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(C=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),C!==y.state&&Iv.enqueueReplaceState(y,y.state,null),Tf(l,f,y,x),Ef(),y.state=l.memoizedState),typeof y.componentDidMount=="function"&&(l.flags|=4194308),f=!0}else if(a===null){y=l.stateNode;var q=l.memoizedProps,se=Ac(d,q);y.props=se;var je=y.context,ke=d.contextType;C=Jd,typeof ke=="object"&&ke!==null&&(C=Ps(ke));var De=d.getDerivedStateFromProps;ke=typeof De=="function"||typeof y.getSnapshotBeforeUpdate=="function",q=l.pendingProps!==q,ke||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(q||je!==C)&&TS(l,y,f,C),Yo=!1;var Se=l.memoizedState;y.state=Se,Tf(l,f,y,x),Ef(),je=l.memoizedState,q||Se!==je||Yo?(typeof De=="function"&&(Tv(l,d,De,f),je=l.memoizedState),(se=Yo||ES(l,d,se,f,Se,je,C))?(ke||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(l.flags|=4194308)):(typeof y.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=f,l.memoizedState=je),y.props=f,y.state=je,y.context=C,f=se):(typeof y.componentDidMount=="function"&&(l.flags|=4194308),f=!1)}else{y=l.stateNode,rv(a,l),C=l.memoizedProps,ke=Ac(d,C),y.props=ke,De=l.pendingProps,Se=y.context,je=d.contextType,se=Jd,typeof je=="object"&&je!==null&&(se=Ps(je)),q=d.getDerivedStateFromProps,(je=typeof q=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(C!==De||Se!==se)&&TS(l,y,f,se),Yo=!1,Se=l.memoizedState,y.state=Se,Tf(l,f,y,x),Ef();var Ce=l.memoizedState;C!==De||Se!==Ce||Yo||a!==null&&a.dependencies!==null&&F0(a.dependencies)?(typeof q=="function"&&(Tv(l,d,q,f),Ce=l.memoizedState),(ke=Yo||ES(l,d,ke,f,Se,Ce,se)||a!==null&&a.dependencies!==null&&F0(a.dependencies))?(je||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(f,Ce,se),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(f,Ce,se)),typeof y.componentDidUpdate=="function"&&(l.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof y.componentDidUpdate!="function"||C===a.memoizedProps&&Se===a.memoizedState||(l.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||C===a.memoizedProps&&Se===a.memoizedState||(l.flags|=1024),l.memoizedProps=f,l.memoizedState=Ce),y.props=f,y.state=Ce,y.context=se,f=ke):(typeof y.componentDidUpdate!="function"||C===a.memoizedProps&&Se===a.memoizedState||(l.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||C===a.memoizedProps&&Se===a.memoizedState||(l.flags|=1024),f=!1)}return y=f,rp(a,l),f=(l.flags&128)!==0,y||f?(y=l.stateNode,d=f&&typeof d.getDerivedStateFromError!="function"?null:y.render(),l.flags|=1,a!==null&&f?(l.child=Ic(l,a.child,null,x),l.child=Ic(l,null,d,x)):Os(a,l,d,x),l.memoizedState=y.state,a=l.child):a=eo(a,l,x),a}function zS(a,l,d,f){return _c(),l.flags|=256,Os(a,l,d,f),l.child}var Rv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Dv(a){return{baseLanes:a,cachePool:k5()}}function Pv(a,l,d){return a=a!==null?a.childLanes&~d:0,l&&(a|=zr),a}function $S(a,l,d){var f=l.pendingProps,x=!1,y=(l.flags&128)!==0,C;if((C=y)||(C=a!==null&&a.memoizedState===null?!1:(Kn.current&2)!==0),C&&(x=!0,l.flags&=-129),C=(l.flags&32)!==0,l.flags&=-33,a===null){if(qt){if(x?Zo(l):el(),(a=wn)?(a=XE(a,ui),a=a!==null&&a.data!=="&"?a:null,a!==null&&(l.memoizedState={dehydrated:a,treeContext:Go!==null?{id:ma,overflow:ga}:null,retryLane:536870912,hydrationErrors:null},d=_5(a),d.return=l,l.child=d,Ds=l,wn=null)):a=null,a===null)throw Ko(l);return pw(a)?l.lanes=32:l.lanes=536870912,null}var q=f.children;return f=f.fallback,x?(el(),x=l.mode,q=ip({mode:"hidden",children:q},x),f=wc(f,x,d,null),q.return=l,f.return=l,q.sibling=f,l.child=q,f=l.child,f.memoizedState=Dv(d),f.childLanes=Pv(a,C,d),l.memoizedState=Rv,Rf(null,f)):(Zo(l),Ov(l,q))}var se=a.memoizedState;if(se!==null&&(q=se.dehydrated,q!==null)){if(y)l.flags&256?(Zo(l),l.flags&=-257,l=Mv(a,l,d)):l.memoizedState!==null?(el(),l.child=a.child,l.flags|=128,l=null):(el(),q=f.fallback,x=l.mode,f=ip({mode:"visible",children:f.children},x),q=wc(q,x,d,null),q.flags|=2,f.return=l,q.return=l,f.sibling=q,l.child=f,Ic(l,a.child,null,d),f=l.child,f.memoizedState=Dv(d),f.childLanes=Pv(a,C,d),l.memoizedState=Rv,l=Rf(null,f));else if(Zo(l),pw(q)){if(C=q.nextSibling&&q.nextSibling.dataset,C)var je=C.dgst;C=je,f=Error(r(419)),f.stack="",f.digest=C,vf({value:f,source:null,stack:null}),l=Mv(a,l,d)}else if(as||nu(a,l,d,!1),C=(d&a.childLanes)!==0,as||C){if(C=gn,C!==null&&(f=ni(C,d),f!==0&&f!==se.retryLane))throw se.retryLane=f,vc(a,f),wr(C,a,f),Av;gw(q)||mp(),l=Mv(a,l,d)}else gw(q)?(l.flags|=192,l.child=a.child,l=null):(a=se.treeContext,wn=fi(q.nextSibling),Ds=l,qt=!0,Wo=null,ui=!1,a!==null&&S5(l,a),l=Ov(l,f.children),l.flags|=4096);return l}return x?(el(),q=f.fallback,x=l.mode,se=a.child,je=se.sibling,f=Ka(se,{mode:"hidden",children:f.children}),f.subtreeFlags=se.subtreeFlags&65011712,je!==null?q=Ka(je,q):(q=wc(q,x,d,null),q.flags|=2),q.return=l,f.return=l,f.sibling=q,l.child=f,Rf(null,f),f=l.child,q=a.child.memoizedState,q===null?q=Dv(d):(x=q.cachePool,x!==null?(se=rs._currentValue,x=x.parent!==se?{parent:se,pool:se}:x):x=k5(),q={baseLanes:q.baseLanes|d,cachePool:x}),f.memoizedState=q,f.childLanes=Pv(a,C,d),l.memoizedState=Rv,Rf(a.child,f)):(Zo(l),d=a.child,a=d.sibling,d=Ka(d,{mode:"visible",children:f.children}),d.return=l,d.sibling=null,a!==null&&(C=l.deletions,C===null?(l.deletions=[a],l.flags|=16):C.push(a)),l.child=d,l.memoizedState=null,d)}function Ov(a,l){return l=ip({mode:"visible",children:l},a.mode),l.return=a,a.child=l}function ip(a,l){return a=Vr(22,a,null,l),a.lanes=0,a}function Mv(a,l,d){return Ic(l,a.child,null,d),a=Ov(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function qS(a,l,d){a.lanes|=l;var f=a.alternate;f!==null&&(f.lanes|=l),Xy(a.return,l,d)}function Lv(a,l,d,f,x,y){var C=a.memoizedState;C===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:f,tail:d,tailMode:x,treeForkCount:y}:(C.isBackwards=l,C.rendering=null,C.renderingStartTime=0,C.last=f,C.tail=d,C.tailMode=x,C.treeForkCount=y)}function HS(a,l,d){var f=l.pendingProps,x=f.revealOrder,y=f.tail;f=f.children;var C=Kn.current,q=(C&2)!==0;if(q?(C=C&1|2,l.flags|=128):C&=1,ge(Kn,C),Os(a,l,f,d),f=qt?yf:0,!q&&a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&qS(a,d,l);else if(a.tag===19)qS(a,d,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(x){case"forwards":for(d=l.child,x=null;d!==null;)a=d.alternate,a!==null&&W0(a)===null&&(x=d),d=d.sibling;d=x,d===null?(x=l.child,l.child=null):(x=d.sibling,d.sibling=null),Lv(l,!1,x,d,y,f);break;case"backwards":case"unstable_legacy-backwards":for(d=null,x=l.child,l.child=null;x!==null;){if(a=x.alternate,a!==null&&W0(a)===null){l.child=x;break}a=x.sibling,x.sibling=d,d=x,x=a}Lv(l,!0,d,null,y,f);break;case"together":Lv(l,!1,null,null,void 0,f);break;default:l.memoizedState=null}return l.child}function eo(a,l,d){if(a!==null&&(l.dependencies=a.dependencies),sl|=l.lanes,(d&l.childLanes)===0)if(a!==null){if(nu(a,l,d,!1),(d&l.childLanes)===0)return null}else return null;if(a!==null&&l.child!==a.child)throw Error(r(153));if(l.child!==null){for(a=l.child,d=Ka(a,a.pendingProps),l.child=d,d.return=l;a.sibling!==null;)a=a.sibling,d=d.sibling=Ka(a,a.pendingProps),d.return=l;d.sibling=null}return l.child}function Vv(a,l){return(a.lanes&l)!==0?!0:(a=a.dependencies,!!(a!==null&&F0(a)))}function bM(a,l,d){switch(l.tag){case 3:ce(l,l.stateNode.containerInfo),Qo(l,rs,a.memoizedState.cache),_c();break;case 27:case 5:Oe(l);break;case 4:ce(l,l.stateNode.containerInfo);break;case 10:Qo(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,cv(l),null;break;case 13:var f=l.memoizedState;if(f!==null)return f.dehydrated!==null?(Zo(l),l.flags|=128,null):(d&l.child.childLanes)!==0?$S(a,l,d):(Zo(l),a=eo(a,l,d),a!==null?a.sibling:null);Zo(l);break;case 19:var x=(a.flags&128)!==0;if(f=(d&l.childLanes)!==0,f||(nu(a,l,d,!1),f=(d&l.childLanes)!==0),x){if(f)return HS(a,l,d);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),ge(Kn,Kn.current),f)break;return null;case 22:return l.lanes=0,LS(a,l,d,l.pendingProps);case 24:Qo(l,rs,a.memoizedState.cache)}return eo(a,l,d)}function GS(a,l,d){if(a!==null)if(a.memoizedProps!==l.pendingProps)as=!0;else{if(!Vv(a,d)&&(l.flags&128)===0)return as=!1,bM(a,l,d);as=(a.flags&131072)!==0}else as=!1,qt&&(l.flags&1048576)!==0&&j5(l,yf,l.index);switch(l.lanes=0,l.tag){case 16:e:{var f=l.pendingProps;if(a=Ec(l.elementType),l.type=a,typeof a=="function")$y(a)?(f=Ac(a,f),l.tag=1,l=BS(null,l,a,f,d)):(l.tag=0,l=kv(null,l,a,f,d));else{if(a!=null){var x=a.$$typeof;if(x===H){l.tag=11,l=PS(null,l,a,f,d);break e}else if(x===P){l.tag=14,l=OS(null,l,a,f,d);break e}}throw l=ne(a)||a,Error(r(306,l,""))}}return l;case 0:return kv(a,l,l.type,l.pendingProps,d);case 1:return f=l.type,x=Ac(f,l.pendingProps),BS(a,l,f,x,d);case 3:e:{if(ce(l,l.stateNode.containerInfo),a===null)throw Error(r(387));f=l.pendingProps;var y=l.memoizedState;x=y.element,rv(a,l),Tf(l,f,null,d);var C=l.memoizedState;if(f=C.cache,Qo(l,rs,f),f!==y.cache&&Jy(l,[rs],d,!0),Ef(),f=C.element,y.isDehydrated)if(y={element:f,isDehydrated:!1,cache:C.cache},l.updateQueue.baseState=y,l.memoizedState=y,l.flags&256){l=zS(a,l,f,d);break e}else if(f!==x){x=li(Error(r(424)),l),vf(x),l=zS(a,l,f,d);break e}else{switch(a=l.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(wn=fi(a.firstChild),Ds=l,qt=!0,Wo=null,ui=!0,d=L5(l,null,f,d),l.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling}else{if(_c(),f===x){l=eo(a,l,d);break e}Os(a,l,f,d)}l=l.child}return l;case 26:return rp(a,l),a===null?(d=sT(l.type,null,l.pendingProps,null))?l.memoizedState=d:qt||(d=l.type,a=l.pendingProps,f=wp(me.current).createElement(d),f[ts]=l,f[ys]=a,Ms(f,d,a),ns(f),l.stateNode=f):l.memoizedState=sT(l.type,a.memoizedProps,l.pendingProps,a.memoizedState),null;case 27:return Oe(l),a===null&&qt&&(f=l.stateNode=eT(l.type,l.pendingProps,me.current),Ds=l,ui=!0,x=wn,ll(l.type)?(xw=x,wn=fi(f.firstChild)):wn=x),Os(a,l,l.pendingProps.children,d),rp(a,l),a===null&&(l.flags|=4194304),l.child;case 5:return a===null&&qt&&((x=f=wn)&&(f=KM(f,l.type,l.pendingProps,ui),f!==null?(l.stateNode=f,Ds=l,wn=fi(f.firstChild),ui=!1,x=!0):x=!1),x||Ko(l)),Oe(l),x=l.type,y=l.pendingProps,C=a!==null?a.memoizedProps:null,f=y.children,hw(x,y)?f=null:C!==null&&hw(x,C)&&(l.flags|=32),l.memoizedState!==null&&(x=uv(a,l,cM,null,null,d),Wf._currentValue=x),rp(a,l),Os(a,l,f,d),l.child;case 6:return a===null&&qt&&((a=d=wn)&&(d=QM(d,l.pendingProps,ui),d!==null?(l.stateNode=d,Ds=l,wn=null,a=!0):a=!1),a||Ko(l)),null;case 13:return $S(a,l,d);case 4:return ce(l,l.stateNode.containerInfo),f=l.pendingProps,a===null?l.child=Ic(l,null,f,d):Os(a,l,f,d),l.child;case 11:return PS(a,l,l.type,l.pendingProps,d);case 7:return Os(a,l,l.pendingProps,d),l.child;case 8:return Os(a,l,l.pendingProps.children,d),l.child;case 12:return Os(a,l,l.pendingProps.children,d),l.child;case 10:return f=l.pendingProps,Qo(l,l.type,f.value),Os(a,l,f.children,d),l.child;case 9:return x=l.type._context,f=l.pendingProps.children,jc(l),x=Ps(x),f=f(x),l.flags|=1,Os(a,l,f,d),l.child;case 14:return OS(a,l,l.type,l.pendingProps,d);case 15:return MS(a,l,l.type,l.pendingProps,d);case 19:return HS(a,l,d);case 31:return xM(a,l,d);case 22:return LS(a,l,d,l.pendingProps);case 24:return jc(l),f=Ps(rs),a===null?(x=tv(),x===null&&(x=gn,y=Zy(),x.pooledCache=y,y.refCount++,y!==null&&(x.pooledCacheLanes|=d),x=y),l.memoizedState={parent:f,cache:x},sv(l),Qo(l,rs,x)):((a.lanes&d)!==0&&(rv(a,l),Tf(l,null,null,d),Ef()),x=a.memoizedState,y=l.memoizedState,x.parent!==f?(x={parent:f,cache:f},l.memoizedState=x,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=x),Qo(l,rs,f)):(f=y.cache,Qo(l,rs,f),f!==x.cache&&Jy(l,[rs],d,!0))),Os(a,l,l.pendingProps.children,d),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function to(a){a.flags|=4}function Fv(a,l,d,f,x){if((l=(a.mode&32)!==0)&&(l=!1),l){if(a.flags|=16777216,(x&335544128)===x)if(a.stateNode.complete)a.flags|=8192;else if(yE())a.flags|=8192;else throw Tc=$0,nv}else a.flags&=-16777217}function WS(a,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!lT(l))if(yE())a.flags|=8192;else throw Tc=$0,nv}function ap(a,l){l!==null&&(a.flags|=4),a.flags&16384&&(l=a.tag!==22?oc():536870912,a.lanes|=l,mu|=l)}function Df(a,l){if(!qt)switch(a.tailMode){case"hidden":l=a.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var f=null;d!==null;)d.alternate!==null&&(f=d),d=d.sibling;f===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:f.sibling=null}}function _n(a){var l=a.alternate!==null&&a.alternate.child===a.child,d=0,f=0;if(l)for(var x=a.child;x!==null;)d|=x.lanes|x.childLanes,f|=x.subtreeFlags&65011712,f|=x.flags&65011712,x.return=a,x=x.sibling;else for(x=a.child;x!==null;)d|=x.lanes|x.childLanes,f|=x.subtreeFlags,f|=x.flags,x.return=a,x=x.sibling;return a.subtreeFlags|=f,a.childLanes=d,l}function yM(a,l,d){var f=l.pendingProps;switch(Wy(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _n(l),null;case 1:return _n(l),null;case 3:return d=l.stateNode,f=null,a!==null&&(f=a.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),Xa(rs),he(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(a===null||a.child===null)&&(tu(l)?to(l):a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Qy())),_n(l),null;case 26:var x=l.type,y=l.memoizedState;return a===null?(to(l),y!==null?(_n(l),WS(l,y)):(_n(l),Fv(l,x,null,f,d))):y?y!==a.memoizedState?(to(l),_n(l),WS(l,y)):(_n(l),l.flags&=-16777217):(a=a.memoizedProps,a!==f&&to(l),_n(l),Fv(l,x,a,f,d)),null;case 27:if(Ue(l),d=me.current,x=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==f&&to(l);else{if(!f){if(l.stateNode===null)throw Error(r(166));return _n(l),null}a=Z.current,tu(l)?E5(l):(a=eT(x,f,d),l.stateNode=a,to(l))}return _n(l),null;case 5:if(Ue(l),x=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==f&&to(l);else{if(!f){if(l.stateNode===null)throw Error(r(166));return _n(l),null}if(y=Z.current,tu(l))E5(l);else{var C=wp(me.current);switch(y){case 1:y=C.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:y=C.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":y=C.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":y=C.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":y=C.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof f.is=="string"?C.createElement("select",{is:f.is}):C.createElement("select"),f.multiple?y.multiple=!0:f.size&&(y.size=f.size);break;default:y=typeof f.is=="string"?C.createElement(x,{is:f.is}):C.createElement(x)}}y[ts]=l,y[ys]=f;e:for(C=l.child;C!==null;){if(C.tag===5||C.tag===6)y.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===l)break e;for(;C.sibling===null;){if(C.return===null||C.return===l)break e;C=C.return}C.sibling.return=C.return,C=C.sibling}l.stateNode=y;e:switch(Ms(y,x,f),x){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&to(l)}}return _n(l),Fv(l,l.type,a===null?null:a.memoizedProps,l.pendingProps,d),null;case 6:if(a&&l.stateNode!=null)a.memoizedProps!==f&&to(l);else{if(typeof f!="string"&&l.stateNode===null)throw Error(r(166));if(a=me.current,tu(l)){if(a=l.stateNode,d=l.memoizedProps,f=null,x=Ds,x!==null)switch(x.tag){case 27:case 5:f=x.memoizedProps}a[ts]=l,a=!!(a.nodeValue===d||f!==null&&f.suppressHydrationWarning===!0||$E(a.nodeValue,d)),a||Ko(l,!0)}else a=wp(a).createTextNode(f),a[ts]=l,l.stateNode=a}return _n(l),null;case 31:if(d=l.memoizedState,a===null||a.memoizedState!==null){if(f=tu(l),d!==null){if(a===null){if(!f)throw Error(r(318));if(a=l.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(557));a[ts]=l}else _c(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;_n(l),a=!1}else d=Qy(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=d),a=!0;if(!a)return l.flags&256?(Ur(l),l):(Ur(l),null);if((l.flags&128)!==0)throw Error(r(558))}return _n(l),null;case 13:if(f=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(x=tu(l),f!==null&&f.dehydrated!==null){if(a===null){if(!x)throw Error(r(318));if(x=l.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[ts]=l}else _c(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;_n(l),x=!1}else x=Qy(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=x),x=!0;if(!x)return l.flags&256?(Ur(l),l):(Ur(l),null)}return Ur(l),(l.flags&128)!==0?(l.lanes=d,l):(d=f!==null,a=a!==null&&a.memoizedState!==null,d&&(f=l.child,x=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(x=f.alternate.memoizedState.cachePool.pool),y=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(y=f.memoizedState.cachePool.pool),y!==x&&(f.flags|=2048)),d!==a&&d&&(l.child.flags|=8192),ap(l,l.updateQueue),_n(l),null);case 4:return he(),a===null&&ow(l.stateNode.containerInfo),_n(l),null;case 10:return Xa(l.type),_n(l),null;case 19:if(Y(Kn),f=l.memoizedState,f===null)return _n(l),null;if(x=(l.flags&128)!==0,y=f.rendering,y===null)if(x)Df(f,!1);else{if(Bn!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(y=W0(a),y!==null){for(l.flags|=128,Df(f,!1),a=y.updateQueue,l.updateQueue=a,ap(l,a),l.subtreeFlags=0,a=d,d=l.child;d!==null;)w5(d,a),d=d.sibling;return ge(Kn,Kn.current&1|2),qt&&Qa(l,f.treeForkCount),l.child}a=a.sibling}f.tail!==null&&Pe()>up&&(l.flags|=128,x=!0,Df(f,!1),l.lanes=4194304)}else{if(!x)if(a=W0(y),a!==null){if(l.flags|=128,x=!0,a=a.updateQueue,l.updateQueue=a,ap(l,a),Df(f,!0),f.tail===null&&f.tailMode==="hidden"&&!y.alternate&&!qt)return _n(l),null}else 2*Pe()-f.renderingStartTime>up&&d!==536870912&&(l.flags|=128,x=!0,Df(f,!1),l.lanes=4194304);f.isBackwards?(y.sibling=l.child,l.child=y):(a=f.last,a!==null?a.sibling=y:l.child=y,f.last=y)}return f.tail!==null?(a=f.tail,f.rendering=a,f.tail=a.sibling,f.renderingStartTime=Pe(),a.sibling=null,d=Kn.current,ge(Kn,x?d&1|2:d&1),qt&&Qa(l,f.treeForkCount),a):(_n(l),null);case 22:case 23:return Ur(l),lv(),f=l.memoizedState!==null,a!==null?a.memoizedState!==null!==f&&(l.flags|=8192):f&&(l.flags|=8192),f?(d&536870912)!==0&&(l.flags&128)===0&&(_n(l),l.subtreeFlags&6&&(l.flags|=8192)):_n(l),d=l.updateQueue,d!==null&&ap(l,d.retryQueue),d=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),f=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),f!==d&&(l.flags|=2048),a!==null&&Y(Sc),null;case 24:return d=null,a!==null&&(d=a.memoizedState.cache),l.memoizedState.cache!==d&&(l.flags|=2048),Xa(rs),_n(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function vM(a,l){switch(Wy(l),l.tag){case 1:return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return Xa(rs),he(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 26:case 27:case 5:return Ue(l),null;case 31:if(l.memoizedState!==null){if(Ur(l),l.alternate===null)throw Error(r(340));_c()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 13:if(Ur(l),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(r(340));_c()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return Y(Kn),null;case 4:return he(),null;case 10:return Xa(l.type),null;case 22:case 23:return Ur(l),lv(),a!==null&&Y(Sc),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 24:return Xa(rs),null;case 25:return null;default:return null}}function KS(a,l){switch(Wy(l),l.tag){case 3:Xa(rs),he();break;case 26:case 27:case 5:Ue(l);break;case 4:he();break;case 31:l.memoizedState!==null&&Ur(l);break;case 13:Ur(l);break;case 19:Y(Kn);break;case 10:Xa(l.type);break;case 22:case 23:Ur(l),lv(),a!==null&&Y(Sc);break;case 24:Xa(rs)}}function Pf(a,l){try{var d=l.updateQueue,f=d!==null?d.lastEffect:null;if(f!==null){var x=f.next;d=x;do{if((d.tag&a)===a){f=void 0;var y=d.create,C=d.inst;f=y(),C.destroy=f}d=d.next}while(d!==x)}}catch(q){on(l,l.return,q)}}function tl(a,l,d){try{var f=l.updateQueue,x=f!==null?f.lastEffect:null;if(x!==null){var y=x.next;f=y;do{if((f.tag&a)===a){var C=f.inst,q=C.destroy;if(q!==void 0){C.destroy=void 0,x=l;var se=d,je=q;try{je()}catch(ke){on(x,se,ke)}}}f=f.next}while(f!==y)}}catch(ke){on(l,l.return,ke)}}function QS(a){var l=a.updateQueue;if(l!==null){var d=a.stateNode;try{F5(l,d)}catch(f){on(a,a.return,f)}}}function YS(a,l,d){d.props=Ac(a.type,a.memoizedProps),d.state=a.memoizedState;try{d.componentWillUnmount()}catch(f){on(a,l,f)}}function Of(a,l){try{var d=a.ref;if(d!==null){switch(a.tag){case 26:case 27:case 5:var f=a.stateNode;break;case 30:f=a.stateNode;break;default:f=a.stateNode}typeof d=="function"?a.refCleanup=d(f):d.current=f}}catch(x){on(a,l,x)}}function pa(a,l){var d=a.ref,f=a.refCleanup;if(d!==null)if(typeof f=="function")try{f()}catch(x){on(a,l,x)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(x){on(a,l,x)}else d.current=null}function XS(a){var l=a.type,d=a.memoizedProps,f=a.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":d.autoFocus&&f.focus();break e;case"img":d.src?f.src=d.src:d.srcSet&&(f.srcset=d.srcSet)}}catch(x){on(a,a.return,x)}}function Uv(a,l,d){try{var f=a.stateNode;zM(f,a.type,d,l),f[ys]=l}catch(x){on(a,a.return,x)}}function JS(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&ll(a.type)||a.tag===4}function Bv(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||JS(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&ll(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function zv(a,l,d){var f=a.tag;if(f===5||f===6)a=a.stateNode,l?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(a,l):(l=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,l.appendChild(a),d=d._reactRootContainer,d!=null||l.onclick!==null||(l.onclick=ki));else if(f!==4&&(f===27&&ll(a.type)&&(d=a.stateNode,l=null),a=a.child,a!==null))for(zv(a,l,d),a=a.sibling;a!==null;)zv(a,l,d),a=a.sibling}function op(a,l,d){var f=a.tag;if(f===5||f===6)a=a.stateNode,l?d.insertBefore(a,l):d.appendChild(a);else if(f!==4&&(f===27&&ll(a.type)&&(d=a.stateNode),a=a.child,a!==null))for(op(a,l,d),a=a.sibling;a!==null;)op(a,l,d),a=a.sibling}function ZS(a){var l=a.stateNode,d=a.memoizedProps;try{for(var f=a.type,x=l.attributes;x.length;)l.removeAttributeNode(x[0]);Ms(l,f,d),l[ts]=a,l[ys]=d}catch(y){on(a,a.return,y)}}var no=!1,os=!1,$v=!1,eE=typeof WeakSet=="function"?WeakSet:Set,ws=null;function wM(a,l){if(a=a.containerInfo,dw=Ip,a=h5(a),My(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var f=d.getSelection&&d.getSelection();if(f&&f.rangeCount!==0){d=f.anchorNode;var x=f.anchorOffset,y=f.focusNode;f=f.focusOffset;try{d.nodeType,y.nodeType}catch{d=null;break e}var C=0,q=-1,se=-1,je=0,ke=0,De=a,Se=null;t:for(;;){for(var Ce;De!==d||x!==0&&De.nodeType!==3||(q=C+x),De!==y||f!==0&&De.nodeType!==3||(se=C+f),De.nodeType===3&&(C+=De.nodeValue.length),(Ce=De.firstChild)!==null;)Se=De,De=Ce;for(;;){if(De===a)break t;if(Se===d&&++je===x&&(q=C),Se===y&&++ke===f&&(se=C),(Ce=De.nextSibling)!==null)break;De=Se,Se=De.parentNode}De=Ce}d=q===-1||se===-1?null:{start:q,end:se}}else d=null}d=d||{start:0,end:0}}else d=null;for(uw={focusedElem:a,selectionRange:d},Ip=!1,ws=l;ws!==null;)if(l=ws,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,ws=a;else for(;ws!==null;){switch(l=ws,y=l.alternate,a=l.flags,l.tag){case 0:if((a&4)!==0&&(a=l.updateQueue,a=a!==null?a.events:null,a!==null))for(d=0;d<a.length;d++)x=a[d],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&y!==null){a=void 0,d=l,x=y.memoizedProps,y=y.memoizedState,f=d.stateNode;try{var nt=Ac(d.type,x);a=f.getSnapshotBeforeUpdate(nt,y),f.__reactInternalSnapshotBeforeUpdate=a}catch(pt){on(d,d.return,pt)}}break;case 3:if((a&1024)!==0){if(a=l.stateNode.containerInfo,d=a.nodeType,d===9)mw(a);else if(d===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":mw(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(r(163))}if(a=l.sibling,a!==null){a.return=l.return,ws=a;break}ws=l.return}}function tE(a,l,d){var f=d.flags;switch(d.tag){case 0:case 11:case 15:ro(a,d),f&4&&Pf(5,d);break;case 1:if(ro(a,d),f&4)if(a=d.stateNode,l===null)try{a.componentDidMount()}catch(C){on(d,d.return,C)}else{var x=Ac(d.type,l.memoizedProps);l=l.memoizedState;try{a.componentDidUpdate(x,l,a.__reactInternalSnapshotBeforeUpdate)}catch(C){on(d,d.return,C)}}f&64&&QS(d),f&512&&Of(d,d.return);break;case 3:if(ro(a,d),f&64&&(a=d.updateQueue,a!==null)){if(l=null,d.child!==null)switch(d.child.tag){case 27:case 5:l=d.child.stateNode;break;case 1:l=d.child.stateNode}try{F5(a,l)}catch(C){on(d,d.return,C)}}break;case 27:l===null&&f&4&&ZS(d);case 26:case 5:ro(a,d),l===null&&f&4&&XS(d),f&512&&Of(d,d.return);break;case 12:ro(a,d);break;case 31:ro(a,d),f&4&&rE(a,d);break;case 13:ro(a,d),f&4&&iE(a,d),f&64&&(a=d.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(d=AM.bind(null,d),YM(a,d))));break;case 22:if(f=d.memoizedState!==null||no,!f){l=l!==null&&l.memoizedState!==null||os,x=no;var y=os;no=f,(os=l)&&!y?io(a,d,(d.subtreeFlags&8772)!==0):ro(a,d),no=x,os=y}break;case 30:break;default:ro(a,d)}}function nE(a){var l=a.alternate;l!==null&&(a.alternate=null,nE(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&Vd(l)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Tn=null,xr=!1;function so(a,l,d){for(d=d.child;d!==null;)sE(a,l,d),d=d.sibling}function sE(a,l,d){if(ve&&typeof ve.onCommitFiberUnmount=="function")try{ve.onCommitFiberUnmount(St,d)}catch{}switch(d.tag){case 26:os||pa(d,l),so(a,l,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:os||pa(d,l);var f=Tn,x=xr;ll(d.type)&&(Tn=d.stateNode,xr=!1),so(a,l,d),qf(d.stateNode),Tn=f,xr=x;break;case 5:os||pa(d,l);case 6:if(f=Tn,x=xr,Tn=null,so(a,l,d),Tn=f,xr=x,Tn!==null)if(xr)try{(Tn.nodeType===9?Tn.body:Tn.nodeName==="HTML"?Tn.ownerDocument.body:Tn).removeChild(d.stateNode)}catch(y){on(d,l,y)}else try{Tn.removeChild(d.stateNode)}catch(y){on(d,l,y)}break;case 18:Tn!==null&&(xr?(a=Tn,QE(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,d.stateNode),_u(a)):QE(Tn,d.stateNode));break;case 4:f=Tn,x=xr,Tn=d.stateNode.containerInfo,xr=!0,so(a,l,d),Tn=f,xr=x;break;case 0:case 11:case 14:case 15:tl(2,d,l),os||tl(4,d,l),so(a,l,d);break;case 1:os||(pa(d,l),f=d.stateNode,typeof f.componentWillUnmount=="function"&&YS(d,l,f)),so(a,l,d);break;case 21:so(a,l,d);break;case 22:os=(f=os)||d.memoizedState!==null,so(a,l,d),os=f;break;default:so(a,l,d)}}function rE(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{_u(a)}catch(d){on(l,l.return,d)}}}function iE(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{_u(a)}catch(d){on(l,l.return,d)}}function _M(a){switch(a.tag){case 31:case 13:case 19:var l=a.stateNode;return l===null&&(l=a.stateNode=new eE),l;case 22:return a=a.stateNode,l=a._retryCache,l===null&&(l=a._retryCache=new eE),l;default:throw Error(r(435,a.tag))}}function lp(a,l){var d=_M(a);l.forEach(function(f){if(!d.has(f)){d.add(f);var x=kM.bind(null,a,f);f.then(x,x)}})}function br(a,l){var d=l.deletions;if(d!==null)for(var f=0;f<d.length;f++){var x=d[f],y=a,C=l,q=C;e:for(;q!==null;){switch(q.tag){case 27:if(ll(q.type)){Tn=q.stateNode,xr=!1;break e}break;case 5:Tn=q.stateNode,xr=!1;break e;case 3:case 4:Tn=q.stateNode.containerInfo,xr=!0;break e}q=q.return}if(Tn===null)throw Error(r(160));sE(y,C,x),Tn=null,xr=!1,y=x.alternate,y!==null&&(y.return=null),x.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)aE(l,a),l=l.sibling}var Li=null;function aE(a,l){var d=a.alternate,f=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:br(l,a),yr(a),f&4&&(tl(3,a,a.return),Pf(3,a),tl(5,a,a.return));break;case 1:br(l,a),yr(a),f&512&&(os||d===null||pa(d,d.return)),f&64&&no&&(a=a.updateQueue,a!==null&&(f=a.callbacks,f!==null&&(d=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=d===null?f:d.concat(f))));break;case 26:var x=Li;if(br(l,a),yr(a),f&512&&(os||d===null||pa(d,d.return)),f&4){var y=d!==null?d.memoizedState:null;if(f=a.memoizedState,d===null)if(f===null)if(a.stateNode===null){e:{f=a.type,d=a.memoizedProps,x=x.ownerDocument||x;t:switch(f){case"title":y=x.getElementsByTagName("title")[0],(!y||y[na]||y[ts]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=x.createElement(f),x.head.insertBefore(y,x.querySelector("head > title"))),Ms(y,f,d),y[ts]=a,ns(y),f=y;break e;case"link":var C=aT("link","href",x).get(f+(d.href||""));if(C){for(var q=0;q<C.length;q++)if(y=C[q],y.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&y.getAttribute("rel")===(d.rel==null?null:d.rel)&&y.getAttribute("title")===(d.title==null?null:d.title)&&y.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){C.splice(q,1);break t}}y=x.createElement(f),Ms(y,f,d),x.head.appendChild(y);break;case"meta":if(C=aT("meta","content",x).get(f+(d.content||""))){for(q=0;q<C.length;q++)if(y=C[q],y.getAttribute("content")===(d.content==null?null:""+d.content)&&y.getAttribute("name")===(d.name==null?null:d.name)&&y.getAttribute("property")===(d.property==null?null:d.property)&&y.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&y.getAttribute("charset")===(d.charSet==null?null:d.charSet)){C.splice(q,1);break t}}y=x.createElement(f),Ms(y,f,d),x.head.appendChild(y);break;default:throw Error(r(468,f))}y[ts]=a,ns(y),f=y}a.stateNode=f}else oT(x,a.type,a.stateNode);else a.stateNode=iT(x,f,a.memoizedProps);else y!==f?(y===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):y.count--,f===null?oT(x,a.type,a.stateNode):iT(x,f,a.memoizedProps)):f===null&&a.stateNode!==null&&Uv(a,a.memoizedProps,d.memoizedProps)}break;case 27:br(l,a),yr(a),f&512&&(os||d===null||pa(d,d.return)),d!==null&&f&4&&Uv(a,a.memoizedProps,d.memoizedProps);break;case 5:if(br(l,a),yr(a),f&512&&(os||d===null||pa(d,d.return)),a.flags&32){x=a.stateNode;try{pr(x,"")}catch(nt){on(a,a.return,nt)}}f&4&&a.stateNode!=null&&(x=a.memoizedProps,Uv(a,x,d!==null?d.memoizedProps:x)),f&1024&&($v=!0);break;case 6:if(br(l,a),yr(a),f&4){if(a.stateNode===null)throw Error(r(162));f=a.memoizedProps,d=a.stateNode;try{d.nodeValue=f}catch(nt){on(a,a.return,nt)}}break;case 3:if(jp=null,x=Li,Li=_p(l.containerInfo),br(l,a),Li=x,yr(a),f&4&&d!==null&&d.memoizedState.isDehydrated)try{_u(l.containerInfo)}catch(nt){on(a,a.return,nt)}$v&&($v=!1,oE(a));break;case 4:f=Li,Li=_p(a.stateNode.containerInfo),br(l,a),yr(a),Li=f;break;case 12:br(l,a),yr(a);break;case 31:br(l,a),yr(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,lp(a,f)));break;case 13:br(l,a),yr(a),a.child.flags&8192&&a.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(dp=Pe()),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,lp(a,f)));break;case 22:x=a.memoizedState!==null;var se=d!==null&&d.memoizedState!==null,je=no,ke=os;if(no=je||x,os=ke||se,br(l,a),os=ke,no=je,yr(a),f&8192)e:for(l=a.stateNode,l._visibility=x?l._visibility&-2:l._visibility|1,x&&(d===null||se||no||os||kc(a)),d=null,l=a;;){if(l.tag===5||l.tag===26){if(d===null){se=d=l;try{if(y=se.stateNode,x)C=y.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{q=se.stateNode;var De=se.memoizedProps.style,Se=De!=null&&De.hasOwnProperty("display")?De.display:null;q.style.display=Se==null||typeof Se=="boolean"?"":(""+Se).trim()}}catch(nt){on(se,se.return,nt)}}}else if(l.tag===6){if(d===null){se=l;try{se.stateNode.nodeValue=x?"":se.memoizedProps}catch(nt){on(se,se.return,nt)}}}else if(l.tag===18){if(d===null){se=l;try{var Ce=se.stateNode;x?YE(Ce,!0):YE(se.stateNode,!1)}catch(nt){on(se,se.return,nt)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===a)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break e;for(;l.sibling===null;){if(l.return===null||l.return===a)break e;d===l&&(d=null),l=l.return}d===l&&(d=null),l.sibling.return=l.return,l=l.sibling}f&4&&(f=a.updateQueue,f!==null&&(d=f.retryQueue,d!==null&&(f.retryQueue=null,lp(a,d))));break;case 19:br(l,a),yr(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,lp(a,f)));break;case 30:break;case 21:break;default:br(l,a),yr(a)}}function yr(a){var l=a.flags;if(l&2){try{for(var d,f=a.return;f!==null;){if(JS(f)){d=f;break}f=f.return}if(d==null)throw Error(r(160));switch(d.tag){case 27:var x=d.stateNode,y=Bv(a);op(a,y,x);break;case 5:var C=d.stateNode;d.flags&32&&(pr(C,""),d.flags&=-33);var q=Bv(a);op(a,q,C);break;case 3:case 4:var se=d.stateNode.containerInfo,je=Bv(a);zv(a,je,se);break;default:throw Error(r(161))}}catch(ke){on(a,a.return,ke)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function oE(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var l=a;oE(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),a=a.sibling}}function ro(a,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)tE(a,l.alternate,l),l=l.sibling}function kc(a){for(a=a.child;a!==null;){var l=a;switch(l.tag){case 0:case 11:case 14:case 15:tl(4,l,l.return),kc(l);break;case 1:pa(l,l.return);var d=l.stateNode;typeof d.componentWillUnmount=="function"&&YS(l,l.return,d),kc(l);break;case 27:qf(l.stateNode);case 26:case 5:pa(l,l.return),kc(l);break;case 22:l.memoizedState===null&&kc(l);break;case 30:kc(l);break;default:kc(l)}a=a.sibling}}function io(a,l,d){for(d=d&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var f=l.alternate,x=a,y=l,C=y.flags;switch(y.tag){case 0:case 11:case 15:io(x,y,d),Pf(4,y);break;case 1:if(io(x,y,d),f=y,x=f.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(je){on(f,f.return,je)}if(f=y,x=f.updateQueue,x!==null){var q=f.stateNode;try{var se=x.shared.hiddenCallbacks;if(se!==null)for(x.shared.hiddenCallbacks=null,x=0;x<se.length;x++)V5(se[x],q)}catch(je){on(f,f.return,je)}}d&&C&64&&QS(y),Of(y,y.return);break;case 27:ZS(y);case 26:case 5:io(x,y,d),d&&f===null&&C&4&&XS(y),Of(y,y.return);break;case 12:io(x,y,d);break;case 31:io(x,y,d),d&&C&4&&rE(x,y);break;case 13:io(x,y,d),d&&C&4&&iE(x,y);break;case 22:y.memoizedState===null&&io(x,y,d),Of(y,y.return);break;case 30:break;default:io(x,y,d)}l=l.sibling}}function qv(a,l){var d=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),a=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(a=l.memoizedState.cachePool.pool),a!==d&&(a!=null&&a.refCount++,d!=null&&wf(d))}function Hv(a,l){a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&wf(a))}function Vi(a,l,d,f){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)lE(a,l,d,f),l=l.sibling}function lE(a,l,d,f){var x=l.flags;switch(l.tag){case 0:case 11:case 15:Vi(a,l,d,f),x&2048&&Pf(9,l);break;case 1:Vi(a,l,d,f);break;case 3:Vi(a,l,d,f),x&2048&&(a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&wf(a)));break;case 12:if(x&2048){Vi(a,l,d,f),a=l.stateNode;try{var y=l.memoizedProps,C=y.id,q=y.onPostCommit;typeof q=="function"&&q(C,l.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(se){on(l,l.return,se)}}else Vi(a,l,d,f);break;case 31:Vi(a,l,d,f);break;case 13:Vi(a,l,d,f);break;case 23:break;case 22:y=l.stateNode,C=l.alternate,l.memoizedState!==null?y._visibility&2?Vi(a,l,d,f):Mf(a,l):y._visibility&2?Vi(a,l,d,f):(y._visibility|=2,uu(a,l,d,f,(l.subtreeFlags&10256)!==0||!1)),x&2048&&qv(C,l);break;case 24:Vi(a,l,d,f),x&2048&&Hv(l.alternate,l);break;default:Vi(a,l,d,f)}}function uu(a,l,d,f,x){for(x=x&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var y=a,C=l,q=d,se=f,je=C.flags;switch(C.tag){case 0:case 11:case 15:uu(y,C,q,se,x),Pf(8,C);break;case 23:break;case 22:var ke=C.stateNode;C.memoizedState!==null?ke._visibility&2?uu(y,C,q,se,x):Mf(y,C):(ke._visibility|=2,uu(y,C,q,se,x)),x&&je&2048&&qv(C.alternate,C);break;case 24:uu(y,C,q,se,x),x&&je&2048&&Hv(C.alternate,C);break;default:uu(y,C,q,se,x)}l=l.sibling}}function Mf(a,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var d=a,f=l,x=f.flags;switch(f.tag){case 22:Mf(d,f),x&2048&&qv(f.alternate,f);break;case 24:Mf(d,f),x&2048&&Hv(f.alternate,f);break;default:Mf(d,f)}l=l.sibling}}var Lf=8192;function hu(a,l,d){if(a.subtreeFlags&Lf)for(a=a.child;a!==null;)cE(a,l,d),a=a.sibling}function cE(a,l,d){switch(a.tag){case 26:hu(a,l,d),a.flags&Lf&&a.memoizedState!==null&&lL(d,Li,a.memoizedState,a.memoizedProps);break;case 5:hu(a,l,d);break;case 3:case 4:var f=Li;Li=_p(a.stateNode.containerInfo),hu(a,l,d),Li=f;break;case 22:a.memoizedState===null&&(f=a.alternate,f!==null&&f.memoizedState!==null?(f=Lf,Lf=16777216,hu(a,l,d),Lf=f):hu(a,l,d));break;default:hu(a,l,d)}}function dE(a){var l=a.alternate;if(l!==null&&(a=l.child,a!==null)){l.child=null;do l=a.sibling,a.sibling=null,a=l;while(a!==null)}}function Vf(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var d=0;d<l.length;d++){var f=l[d];ws=f,hE(f,a)}dE(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)uE(a),a=a.sibling}function uE(a){switch(a.tag){case 0:case 11:case 15:Vf(a),a.flags&2048&&tl(9,a,a.return);break;case 3:Vf(a);break;case 12:Vf(a);break;case 22:var l=a.stateNode;a.memoizedState!==null&&l._visibility&2&&(a.return===null||a.return.tag!==13)?(l._visibility&=-3,cp(a)):Vf(a);break;default:Vf(a)}}function cp(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var d=0;d<l.length;d++){var f=l[d];ws=f,hE(f,a)}dE(a)}for(a=a.child;a!==null;){switch(l=a,l.tag){case 0:case 11:case 15:tl(8,l,l.return),cp(l);break;case 22:d=l.stateNode,d._visibility&2&&(d._visibility&=-3,cp(l));break;default:cp(l)}a=a.sibling}}function hE(a,l){for(;ws!==null;){var d=ws;switch(d.tag){case 0:case 11:case 15:tl(8,d,l);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var f=d.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:wf(d.memoizedState.cache)}if(f=d.child,f!==null)f.return=d,ws=f;else e:for(d=a;ws!==null;){f=ws;var x=f.sibling,y=f.return;if(nE(f),f===d){ws=null;break e}if(x!==null){x.return=y,ws=x;break e}ws=y}}}var NM={getCacheForType:function(a){var l=Ps(rs),d=l.data.get(a);return d===void 0&&(d=a(),l.data.set(a,d)),d},cacheSignal:function(){return Ps(rs).controller.signal}},jM=typeof WeakMap=="function"?WeakMap:Map,Jt=0,gn=null,Lt=null,Ut=0,an=0,Br=null,nl=!1,fu=!1,Gv=!1,ao=0,Bn=0,sl=0,Rc=0,Wv=0,zr=0,mu=0,Ff=null,vr=null,Kv=!1,dp=0,fE=0,up=1/0,hp=null,rl=null,ms=0,il=null,gu=null,oo=0,Qv=0,Yv=null,mE=null,Uf=0,Xv=null;function $r(){return(Jt&2)!==0&&Ut!==0?Ut&-Ut:A.T!==null?sw():f0()}function gE(){if(zr===0)if((Ut&536870912)===0||qt){var a=rt;rt<<=1,(rt&3932160)===0&&(rt=262144),zr=a}else zr=536870912;return a=Fr.current,a!==null&&(a.flags|=32),zr}function wr(a,l,d){(a===gn&&(an===2||an===9)||a.cancelPendingCommit!==null)&&(pu(a,0),al(a,Ut,zr,!1)),ea(a,d),((Jt&2)===0||a!==gn)&&(a===gn&&((Jt&2)===0&&(Rc|=d),Bn===4&&al(a,Ut,zr,!1)),xa(a))}function pE(a,l,d){if((Jt&6)!==0)throw Error(r(327));var f=!d&&(l&127)===0&&(l&a.expiredLanes)===0||Zn(a,l),x=f?TM(a,l):Zv(a,l,!0),y=f;do{if(x===0){fu&&!f&&al(a,l,0,!1);break}else{if(d=a.current.alternate,y&&!SM(d)){x=Zv(a,l,!1),y=!1;continue}if(x===2){if(y=l,a.errorRecoveryDisabledLanes&y)var C=0;else C=a.pendingLanes&-536870913,C=C!==0?C:C&536870912?536870912:0;if(C!==0){l=C;e:{var q=a;x=Ff;var se=q.current.memoizedState.isDehydrated;if(se&&(pu(q,C).flags|=256),C=Zv(q,C,!1),C!==2){if(Gv&&!se){q.errorRecoveryDisabledLanes|=y,Rc|=y,x=4;break e}y=vr,vr=x,y!==null&&(vr===null?vr=y:vr.push.apply(vr,y))}x=C}if(y=!1,x!==2)continue}}if(x===1){pu(a,0),al(a,l,0,!0);break}e:{switch(f=a,y=x,y){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:al(f,l,zr,!nl);break e;case 2:vr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(x=dp+300-Pe(),10<x)){if(al(f,l,zr,!nl),Dn(f,0,!0)!==0)break e;oo=l,f.timeoutHandle=WE(xE.bind(null,f,d,vr,hp,Kv,l,zr,Rc,mu,nl,y,"Throttled",-0,0),x);break e}xE(f,d,vr,hp,Kv,l,zr,Rc,mu,nl,y,null,-0,0)}}break}while(!0);xa(a)}function xE(a,l,d,f,x,y,C,q,se,je,ke,De,Se,Ce){if(a.timeoutHandle=-1,De=l.subtreeFlags,De&8192||(De&16785408)===16785408){De={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ki},cE(l,y,De);var nt=(y&62914560)===y?dp-Pe():(y&4194048)===y?fE-Pe():0;if(nt=cL(De,nt),nt!==null){oo=y,a.cancelPendingCommit=nt(SE.bind(null,a,l,y,d,f,x,C,q,se,ke,De,null,Se,Ce)),al(a,y,C,!je);return}}SE(a,l,y,d,f,x,C,q,se)}function SM(a){for(var l=a;;){var d=l.tag;if((d===0||d===11||d===15)&&l.flags&16384&&(d=l.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var f=0;f<d.length;f++){var x=d[f],y=x.getSnapshot;x=x.value;try{if(!Lr(y(),x))return!1}catch{return!1}}if(d=l.child,l.subtreeFlags&16384&&d!==null)d.return=l,l=d;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function al(a,l,d,f){l&=~Wv,l&=~Rc,a.suspendedLanes|=l,a.pingedLanes&=~l,f&&(a.warmLanes|=l),f=a.expirationTimes;for(var x=l;0<x;){var y=31-We(x),C=1<<y;f[y]=-1,x&=~C}d!==0&&wt(a,d,l)}function fp(){return(Jt&6)===0?(Bf(0),!1):!0}function Jv(){if(Lt!==null){if(an===0)var a=Lt.return;else a=Lt,Ya=Nc=null,mv(a),au=null,Nf=0,a=Lt;for(;a!==null;)KS(a.alternate,a),a=a.return;Lt=null}}function pu(a,l){var d=a.timeoutHandle;d!==-1&&(a.timeoutHandle=-1,HM(d)),d=a.cancelPendingCommit,d!==null&&(a.cancelPendingCommit=null,d()),oo=0,Jv(),gn=a,Lt=d=Ka(a.current,null),Ut=l,an=0,Br=null,nl=!1,fu=Zn(a,l),Gv=!1,mu=zr=Wv=Rc=sl=Bn=0,vr=Ff=null,Kv=!1,(l&8)!==0&&(l|=l&32);var f=a.entangledLanes;if(f!==0)for(a=a.entanglements,f&=l;0<f;){var x=31-We(f),y=1<<x;l|=a[x],f&=~y}return ao=l,P0(),d}function bE(a,l){At=null,A.H=kf,l===iu||l===z0?(l=P5(),an=3):l===nv?(l=P5(),an=4):an=l===Av?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Br=l,Lt===null&&(Bn=1,np(a,li(l,a.current)))}function yE(){var a=Fr.current;return a===null?!0:(Ut&4194048)===Ut?hi===null:(Ut&62914560)===Ut||(Ut&536870912)!==0?a===hi:!1}function vE(){var a=A.H;return A.H=kf,a===null?kf:a}function wE(){var a=A.A;return A.A=NM,a}function mp(){Bn=4,nl||(Ut&4194048)!==Ut&&Fr.current!==null||(fu=!0),(sl&134217727)===0&&(Rc&134217727)===0||gn===null||al(gn,Ut,zr,!1)}function Zv(a,l,d){var f=Jt;Jt|=2;var x=vE(),y=wE();(gn!==a||Ut!==l)&&(hp=null,pu(a,l)),l=!1;var C=Bn;e:do try{if(an!==0&&Lt!==null){var q=Lt,se=Br;switch(an){case 8:Jv(),C=6;break e;case 3:case 2:case 9:case 6:Fr.current===null&&(l=!0);var je=an;if(an=0,Br=null,xu(a,q,se,je),d&&fu){C=0;break e}break;default:je=an,an=0,Br=null,xu(a,q,se,je)}}EM(),C=Bn;break}catch(ke){bE(a,ke)}while(!0);return l&&a.shellSuspendCounter++,Ya=Nc=null,Jt=f,A.H=x,A.A=y,Lt===null&&(gn=null,Ut=0,P0()),C}function EM(){for(;Lt!==null;)_E(Lt)}function TM(a,l){var d=Jt;Jt|=2;var f=vE(),x=wE();gn!==a||Ut!==l?(hp=null,up=Pe()+500,pu(a,l)):fu=Zn(a,l);e:do try{if(an!==0&&Lt!==null){l=Lt;var y=Br;t:switch(an){case 1:an=0,Br=null,xu(a,l,y,1);break;case 2:case 9:if(R5(y)){an=0,Br=null,NE(l);break}l=function(){an!==2&&an!==9||gn!==a||(an=7),xa(a)},y.then(l,l);break e;case 3:an=7;break e;case 4:an=5;break e;case 7:R5(y)?(an=0,Br=null,NE(l)):(an=0,Br=null,xu(a,l,y,7));break;case 5:var C=null;switch(Lt.tag){case 26:C=Lt.memoizedState;case 5:case 27:var q=Lt;if(C?lT(C):q.stateNode.complete){an=0,Br=null;var se=q.sibling;if(se!==null)Lt=se;else{var je=q.return;je!==null?(Lt=je,gp(je)):Lt=null}break t}}an=0,Br=null,xu(a,l,y,5);break;case 6:an=0,Br=null,xu(a,l,y,6);break;case 8:Jv(),Bn=6;break e;default:throw Error(r(462))}}IM();break}catch(ke){bE(a,ke)}while(!0);return Ya=Nc=null,A.H=f,A.A=x,Jt=d,Lt!==null?0:(gn=null,Ut=0,P0(),Bn)}function IM(){for(;Lt!==null&&!Ae();)_E(Lt)}function _E(a){var l=GS(a.alternate,a,ao);a.memoizedProps=a.pendingProps,l===null?gp(a):Lt=l}function NE(a){var l=a,d=l.alternate;switch(l.tag){case 15:case 0:l=US(d,l,l.pendingProps,l.type,void 0,Ut);break;case 11:l=US(d,l,l.pendingProps,l.type.render,l.ref,Ut);break;case 5:mv(l);default:KS(d,l),l=Lt=w5(l,ao),l=GS(d,l,ao)}a.memoizedProps=a.pendingProps,l===null?gp(a):Lt=l}function xu(a,l,d,f){Ya=Nc=null,mv(l),au=null,Nf=0;var x=l.return;try{if(pM(a,x,l,d,Ut)){Bn=1,np(a,li(d,a.current)),Lt=null;return}}catch(y){if(x!==null)throw Lt=x,y;Bn=1,np(a,li(d,a.current)),Lt=null;return}l.flags&32768?(qt||f===1?a=!0:fu||(Ut&536870912)!==0?a=!1:(nl=a=!0,(f===2||f===9||f===3||f===6)&&(f=Fr.current,f!==null&&f.tag===13&&(f.flags|=16384))),jE(l,a)):gp(l)}function gp(a){var l=a;do{if((l.flags&32768)!==0){jE(l,nl);return}a=l.return;var d=yM(l.alternate,l,ao);if(d!==null){Lt=d;return}if(l=l.sibling,l!==null){Lt=l;return}Lt=l=a}while(l!==null);Bn===0&&(Bn=5)}function jE(a,l){do{var d=vM(a.alternate,a);if(d!==null){d.flags&=32767,Lt=d;return}if(d=a.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!l&&(a=a.sibling,a!==null)){Lt=a;return}Lt=a=d}while(a!==null);Bn=6,Lt=null}function SE(a,l,d,f,x,y,C,q,se){a.cancelPendingCommit=null;do pp();while(ms!==0);if((Jt&6)!==0)throw Error(r(327));if(l!==null){if(l===a.current)throw Error(r(177));if(y=l.lanes|l.childLanes,y|=By,He(a,d,y,C,q,se),a===gn&&(Lt=gn=null,Ut=0),gu=l,il=a,oo=d,Qv=y,Yv=x,mE=f,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,RM(ht,function(){return AE(),null})):(a.callbackNode=null,a.callbackPriority=0),f=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||f){f=A.T,A.T=null,x=V.p,V.p=2,C=Jt,Jt|=4;try{wM(a,l,d)}finally{Jt=C,V.p=x,A.T=f}}ms=1,EE(),TE(),IE()}}function EE(){if(ms===1){ms=0;var a=il,l=gu,d=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||d){d=A.T,A.T=null;var f=V.p;V.p=2;var x=Jt;Jt|=4;try{aE(l,a);var y=uw,C=h5(a.containerInfo),q=y.focusedElem,se=y.selectionRange;if(C!==q&&q&&q.ownerDocument&&u5(q.ownerDocument.documentElement,q)){if(se!==null&&My(q)){var je=se.start,ke=se.end;if(ke===void 0&&(ke=je),"selectionStart"in q)q.selectionStart=je,q.selectionEnd=Math.min(ke,q.value.length);else{var De=q.ownerDocument||document,Se=De&&De.defaultView||window;if(Se.getSelection){var Ce=Se.getSelection(),nt=q.textContent.length,pt=Math.min(se.start,nt),mn=se.end===void 0?pt:Math.min(se.end,nt);!Ce.extend&&pt>mn&&(C=mn,mn=pt,pt=C);var de=d5(q,pt),oe=d5(q,mn);if(de&&oe&&(Ce.rangeCount!==1||Ce.anchorNode!==de.node||Ce.anchorOffset!==de.offset||Ce.focusNode!==oe.node||Ce.focusOffset!==oe.offset)){var Ne=De.createRange();Ne.setStart(de.node,de.offset),Ce.removeAllRanges(),pt>mn?(Ce.addRange(Ne),Ce.extend(oe.node,oe.offset)):(Ne.setEnd(oe.node,oe.offset),Ce.addRange(Ne))}}}}for(De=[],Ce=q;Ce=Ce.parentNode;)Ce.nodeType===1&&De.push({element:Ce,left:Ce.scrollLeft,top:Ce.scrollTop});for(typeof q.focus=="function"&&q.focus(),q=0;q<De.length;q++){var Re=De[q];Re.element.scrollLeft=Re.left,Re.element.scrollTop=Re.top}}Ip=!!dw,uw=dw=null}finally{Jt=x,V.p=f,A.T=d}}a.current=l,ms=2}}function TE(){if(ms===2){ms=0;var a=il,l=gu,d=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||d){d=A.T,A.T=null;var f=V.p;V.p=2;var x=Jt;Jt|=4;try{tE(a,l.alternate,l)}finally{Jt=x,V.p=f,A.T=d}}ms=3}}function IE(){if(ms===4||ms===3){ms=0,xe();var a=il,l=gu,d=oo,f=mE;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?ms=5:(ms=0,gu=il=null,CE(a,a.pendingLanes));var x=a.pendingLanes;if(x===0&&(rl=null),qa(d),l=l.stateNode,ve&&typeof ve.onCommitFiberRoot=="function")try{ve.onCommitFiberRoot(St,l,void 0,(l.current.flags&128)===128)}catch{}if(f!==null){l=A.T,x=V.p,V.p=2,A.T=null;try{for(var y=a.onRecoverableError,C=0;C<f.length;C++){var q=f[C];y(q.value,{componentStack:q.stack})}}finally{A.T=l,V.p=x}}(oo&3)!==0&&pp(),xa(a),x=a.pendingLanes,(d&261930)!==0&&(x&42)!==0?a===Xv?Uf++:(Uf=0,Xv=a):Uf=0,Bf(0)}}function CE(a,l){(a.pooledCacheLanes&=l)===0&&(l=a.pooledCache,l!=null&&(a.pooledCache=null,wf(l)))}function pp(){return EE(),TE(),IE(),AE()}function AE(){if(ms!==5)return!1;var a=il,l=Qv;Qv=0;var d=qa(oo),f=A.T,x=V.p;try{V.p=32>d?32:d,A.T=null,d=Yv,Yv=null;var y=il,C=oo;if(ms=0,gu=il=null,oo=0,(Jt&6)!==0)throw Error(r(331));var q=Jt;if(Jt|=4,uE(y.current),lE(y,y.current,C,d),Jt=q,Bf(0,!1),ve&&typeof ve.onPostCommitFiberRoot=="function")try{ve.onPostCommitFiberRoot(St,y)}catch{}return!0}finally{V.p=x,A.T=f,CE(a,l)}}function kE(a,l,d){l=li(d,l),l=Cv(a.stateNode,l,2),a=Jo(a,l,2),a!==null&&(ea(a,2),xa(a))}function on(a,l,d){if(a.tag===3)kE(a,a,d);else for(;l!==null;){if(l.tag===3){kE(l,a,d);break}else if(l.tag===1){var f=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(rl===null||!rl.has(f))){a=li(d,a),d=RS(2),f=Jo(l,d,2),f!==null&&(DS(d,f,l,a),ea(f,2),xa(f));break}}l=l.return}}function ew(a,l,d){var f=a.pingCache;if(f===null){f=a.pingCache=new jM;var x=new Set;f.set(l,x)}else x=f.get(l),x===void 0&&(x=new Set,f.set(l,x));x.has(d)||(Gv=!0,x.add(d),a=CM.bind(null,a,l,d),l.then(a,a))}function CM(a,l,d){var f=a.pingCache;f!==null&&f.delete(l),a.pingedLanes|=a.suspendedLanes&d,a.warmLanes&=~d,gn===a&&(Ut&d)===d&&(Bn===4||Bn===3&&(Ut&62914560)===Ut&&300>Pe()-dp?(Jt&2)===0&&pu(a,0):Wv|=d,mu===Ut&&(mu=0)),xa(a)}function RE(a,l){l===0&&(l=oc()),a=vc(a,l),a!==null&&(ea(a,l),xa(a))}function AM(a){var l=a.memoizedState,d=0;l!==null&&(d=l.retryLane),RE(a,d)}function kM(a,l){var d=0;switch(a.tag){case 31:case 13:var f=a.stateNode,x=a.memoizedState;x!==null&&(d=x.retryLane);break;case 19:f=a.stateNode;break;case 22:f=a.stateNode._retryCache;break;default:throw Error(r(314))}f!==null&&f.delete(l),RE(a,d)}function RM(a,l){return pe(a,l)}var xp=null,bu=null,tw=!1,bp=!1,nw=!1,ol=0;function xa(a){a!==bu&&a.next===null&&(bu===null?xp=bu=a:bu=bu.next=a),bp=!0,tw||(tw=!0,PM())}function Bf(a,l){if(!nw&&bp){nw=!0;do for(var d=!1,f=xp;f!==null;){if(a!==0){var x=f.pendingLanes;if(x===0)var y=0;else{var C=f.suspendedLanes,q=f.pingedLanes;y=(1<<31-We(42|a)+1)-1,y&=x&~(C&~q),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(d=!0,ME(f,y))}else y=Ut,y=Dn(f,f===gn?y:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(y&3)===0||Zn(f,y)||(d=!0,ME(f,y));f=f.next}while(d);nw=!1}}function DM(){DE()}function DE(){bp=tw=!1;var a=0;ol!==0&&qM()&&(a=ol);for(var l=Pe(),d=null,f=xp;f!==null;){var x=f.next,y=PE(f,l);y===0?(f.next=null,d===null?xp=x:d.next=x,x===null&&(bu=d)):(d=f,(a!==0||(y&3)!==0)&&(bp=!0)),f=x}ms!==0&&ms!==5||Bf(a),ol!==0&&(ol=0)}function PE(a,l){for(var d=a.suspendedLanes,f=a.pingedLanes,x=a.expirationTimes,y=a.pendingLanes&-62914561;0<y;){var C=31-We(y),q=1<<C,se=x[C];se===-1?((q&d)===0||(q&f)!==0)&&(x[C]=Ii(q,l)):se<=l&&(a.expiredLanes|=q),y&=~q}if(l=gn,d=Ut,d=Dn(a,a===l?d:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f=a.callbackNode,d===0||a===l&&(an===2||an===9)||a.cancelPendingCommit!==null)return f!==null&&f!==null&&ye(f),a.callbackNode=null,a.callbackPriority=0;if((d&3)===0||Zn(a,d)){if(l=d&-d,l===a.callbackPriority)return l;switch(f!==null&&ye(f),qa(d)){case 2:case 8:d=Be;break;case 32:d=ht;break;case 268435456:d=Ze;break;default:d=ht}return f=OE.bind(null,a),d=pe(d,f),a.callbackPriority=l,a.callbackNode=d,l}return f!==null&&f!==null&&ye(f),a.callbackPriority=2,a.callbackNode=null,2}function OE(a,l){if(ms!==0&&ms!==5)return a.callbackNode=null,a.callbackPriority=0,null;var d=a.callbackNode;if(pp()&&a.callbackNode!==d)return null;var f=Ut;return f=Dn(a,a===gn?f:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f===0?null:(pE(a,f,l),PE(a,Pe()),a.callbackNode!=null&&a.callbackNode===d?OE.bind(null,a):null)}function ME(a,l){if(pp())return null;pE(a,l,!0)}function PM(){GM(function(){(Jt&6)!==0?pe(Ee,DM):DE()})}function sw(){if(ol===0){var a=su;a===0&&(a=tt,tt<<=1,(tt&261888)===0&&(tt=256)),ol=a}return ol}function LE(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:zd(""+a)}function VE(a,l){var d=l.ownerDocument.createElement("input");return d.name=l.name,d.value=l.value,a.id&&d.setAttribute("form",a.id),l.parentNode.insertBefore(d,l),a=new FormData(a),d.parentNode.removeChild(d),a}function OM(a,l,d,f,x){if(l==="submit"&&d&&d.stateNode===x){var y=LE((x[ys]||null).action),C=f.submitter;C&&(l=(l=C[ys]||null)?LE(l.formAction):C.getAttribute("formAction"),l!==null&&(y=l,C=null));var q=new da("action","action",null,f,x);a.push({event:q,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(ol!==0){var se=C?VE(x,C):new FormData(x);Nv(d,{pending:!0,data:se,method:x.method,action:y},null,se)}}else typeof y=="function"&&(q.preventDefault(),se=C?VE(x,C):new FormData(x),Nv(d,{pending:!0,data:se,method:x.method,action:y},y,se))},currentTarget:x}]})}}for(var rw=0;rw<Uy.length;rw++){var iw=Uy[rw],MM=iw.toLowerCase(),LM=iw[0].toUpperCase()+iw.slice(1);Mi(MM,"on"+LM)}Mi(g5,"onAnimationEnd"),Mi(p5,"onAnimationIteration"),Mi(x5,"onAnimationStart"),Mi("dblclick","onDoubleClick"),Mi("focusin","onFocus"),Mi("focusout","onBlur"),Mi(ZO,"onTransitionRun"),Mi(eM,"onTransitionStart"),Mi(tM,"onTransitionCancel"),Mi(b5,"onTransitionEnd"),aa("onMouseEnter",["mouseout","mouseover"]),aa("onMouseLeave",["mouseout","mouseover"]),aa("onPointerEnter",["pointerout","pointerover"]),aa("onPointerLeave",["pointerout","pointerover"]),ia("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ia("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ia("onBeforeInput",["compositionend","keypress","textInput","paste"]),ia("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ia("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ia("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VM=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(zf));function FE(a,l){l=(l&4)!==0;for(var d=0;d<a.length;d++){var f=a[d],x=f.event;f=f.listeners;e:{var y=void 0;if(l)for(var C=f.length-1;0<=C;C--){var q=f[C],se=q.instance,je=q.currentTarget;if(q=q.listener,se!==y&&x.isPropagationStopped())break e;y=q,x.currentTarget=je;try{y(x)}catch(ke){D0(ke)}x.currentTarget=null,y=se}else for(C=0;C<f.length;C++){if(q=f[C],se=q.instance,je=q.currentTarget,q=q.listener,se!==y&&x.isPropagationStopped())break e;y=q,x.currentTarget=je;try{y(x)}catch(ke){D0(ke)}x.currentTarget=null,y=se}}}}function Vt(a,l){var d=l[Ld];d===void 0&&(d=l[Ld]=new Set);var f=a+"__bubble";d.has(f)||(UE(l,a,2,!1),d.add(f))}function aw(a,l,d){var f=0;l&&(f|=4),UE(d,a,f,l)}var yp="_reactListening"+Math.random().toString(36).slice(2);function ow(a){if(!a[yp]){a[yp]=!0,Zh.forEach(function(d){d!=="selectionchange"&&(VM.has(d)||aw(d,!1,a),aw(d,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[yp]||(l[yp]=!0,aw("selectionchange",!1,l))}}function UE(a,l,d,f){switch(gT(l)){case 2:var x=hL;break;case 8:x=fL;break;default:x=_w}d=x.bind(null,l,d,a),x=void 0,!hc||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),f?x!==void 0?a.addEventListener(l,d,{capture:!0,passive:x}):a.addEventListener(l,d,!0):x!==void 0?a.addEventListener(l,d,{passive:x}):a.addEventListener(l,d,!1)}function lw(a,l,d,f,x){var y=f;if((l&1)===0&&(l&2)===0&&f!==null)e:for(;;){if(f===null)return;var C=f.tag;if(C===3||C===4){var q=f.stateNode.containerInfo;if(q===x)break;if(C===4)for(C=f.return;C!==null;){var se=C.tag;if((se===3||se===4)&&C.stateNode.containerInfo===x)return;C=C.return}for(;q!==null;){if(C=sa(q),C===null)return;if(se=C.tag,se===5||se===6||se===26||se===27){f=y=C;continue e}q=q.parentNode}}f=f.return}zo(function(){var je=y,ke=ri(d),De=[];e:{var Se=y5.get(a);if(Se!==void 0){var Ce=da,nt=a;switch(a){case"keypress":if(mc(d)===0)break e;case"keydown":case"keyup":Ce=A0;break;case"focusin":nt="focus",Ce=pc;break;case"focusout":nt="blur",Ce=pc;break;case"beforeblur":case"afterblur":Ce=pc;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ce=ff;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ce=w0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ce=N;break;case g5:case p5:case x5:Ce=N0;break;case b5:Ce=W;break;case"scroll":case"scrollend":Ce=hf;break;case"wheel":Ce=Ie;break;case"copy":case"cut":case"paste":Ce=j0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ce=Wa;break;case"toggle":case"beforetoggle":Ce=Ct}var pt=(l&4)!==0,mn=!pt&&(a==="scroll"||a==="scrollend"),de=pt?Se!==null?Se+"Capture":null:Se;pt=[];for(var oe=je,Ne;oe!==null;){var Re=oe;if(Ne=Re.stateNode,Re=Re.tag,Re!==5&&Re!==26&&Re!==27||Ne===null||de===null||(Re=Ri(oe,de),Re!=null&&pt.push($f(oe,Re,Ne))),mn)break;oe=oe.return}0<pt.length&&(Se=new Ce(Se,nt,null,d,ke),De.push({event:Se,listeners:pt}))}}if((l&7)===0){e:{if(Se=a==="mouseover"||a==="pointerover",Ce=a==="mouseout"||a==="pointerout",Se&&d!==cf&&(nt=d.relatedTarget||d.fromElement)&&(sa(nt)||nt[ta]))break e;if((Ce||Se)&&(Se=ke.window===ke?ke:(Se=ke.ownerDocument)?Se.defaultView||Se.parentWindow:window,Ce?(nt=d.relatedTarget||d.toElement,Ce=je,nt=nt?sa(nt):null,nt!==null&&(mn=o(nt),pt=nt.tag,nt!==mn||pt!==5&&pt!==27&&pt!==6)&&(nt=null)):(Ce=null,nt=je),Ce!==nt)){if(pt=ff,Re="onMouseLeave",de="onMouseEnter",oe="mouse",(a==="pointerout"||a==="pointerover")&&(pt=Wa,Re="onPointerLeave",de="onPointerEnter",oe="pointer"),mn=Ce==null?Se:Or(Ce),Ne=nt==null?Se:Or(nt),Se=new pt(Re,oe+"leave",Ce,d,ke),Se.target=mn,Se.relatedTarget=Ne,Re=null,sa(ke)===je&&(pt=new pt(de,oe+"enter",nt,d,ke),pt.target=Ne,pt.relatedTarget=mn,Re=pt),mn=Re,Ce&&nt)t:{for(pt=FM,de=Ce,oe=nt,Ne=0,Re=de;Re;Re=pt(Re))Ne++;Re=0;for(var mt=oe;mt;mt=pt(mt))Re++;for(;0<Ne-Re;)de=pt(de),Ne--;for(;0<Re-Ne;)oe=pt(oe),Re--;for(;Ne--;){if(de===oe||oe!==null&&de===oe.alternate){pt=de;break t}de=pt(de),oe=pt(oe)}pt=null}else pt=null;Ce!==null&&BE(De,Se,Ce,pt,!1),nt!==null&&mn!==null&&BE(De,mn,nt,pt,!0)}}e:{if(Se=je?Or(je):window,Ce=Se.nodeName&&Se.nodeName.toLowerCase(),Ce==="select"||Ce==="input"&&Se.type==="file")var Gt=r5;else if(n5(Se))if(i5)Gt=YO;else{Gt=KO;var ot=WO}else Ce=Se.nodeName,!Ce||Ce.toLowerCase()!=="input"||Se.type!=="checkbox"&&Se.type!=="radio"?je&&Bd(je.elementType)&&(Gt=r5):Gt=QO;if(Gt&&(Gt=Gt(a,je))){s5(De,Gt,d,ke);break e}ot&&ot(a,Se,je),a==="focusout"&&je&&Se.type==="number"&&je.memoizedProps.value!=null&&af(Se,"number",Se.value)}switch(ot=je?Or(je):window,a){case"focusin":(n5(ot)||ot.contentEditable==="true")&&(Qd=ot,Ly=je,bf=null);break;case"focusout":bf=Ly=Qd=null;break;case"mousedown":Vy=!0;break;case"contextmenu":case"mouseup":case"dragend":Vy=!1,f5(De,d,ke);break;case"selectionchange":if(JO)break;case"keydown":case"keyup":f5(De,d,ke)}var Rt;if(Xt)e:{switch(a){case"compositionstart":var Bt="onCompositionStart";break e;case"compositionend":Bt="onCompositionEnd";break e;case"compositionupdate":Bt="onCompositionUpdate";break e}Bt=void 0}else Kd?xc(a,d)&&(Bt="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(Bt="onCompositionStart");Bt&&(fa&&d.locale!=="ko"&&(Kd||Bt!=="onCompositionStart"?Bt==="onCompositionEnd"&&Kd&&(Rt=uf()):(ca=ke,df="value"in ca?ca.value:ca.textContent,Kd=!0)),ot=vp(je,Bt),0<ot.length&&(Bt=new ha(Bt,a,null,d,ke),De.push({event:Bt,listeners:ot}),Rt?Bt.data=Rt:(Rt=Wd(d),Rt!==null&&(Bt.data=Rt)))),(Rt=ai?$O(a,d):qO(a,d))&&(Bt=vp(je,"onBeforeInput"),0<Bt.length&&(ot=new ha("onBeforeInput","beforeinput",null,d,ke),De.push({event:ot,listeners:Bt}),ot.data=Rt)),OM(De,a,je,d,ke)}FE(De,l)})}function $f(a,l,d){return{instance:a,listener:l,currentTarget:d}}function vp(a,l){for(var d=l+"Capture",f=[];a!==null;){var x=a,y=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||y===null||(x=Ri(a,d),x!=null&&f.unshift($f(a,x,y)),x=Ri(a,l),x!=null&&f.push($f(a,x,y))),a.tag===3)return f;a=a.return}return[]}function FM(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function BE(a,l,d,f,x){for(var y=l._reactName,C=[];d!==null&&d!==f;){var q=d,se=q.alternate,je=q.stateNode;if(q=q.tag,se!==null&&se===f)break;q!==5&&q!==26&&q!==27||je===null||(se=je,x?(je=Ri(d,y),je!=null&&C.unshift($f(d,je,se))):x||(je=Ri(d,y),je!=null&&C.push($f(d,je,se)))),d=d.return}C.length!==0&&a.push({event:l,listeners:C})}var UM=/\r\n?/g,BM=/\u0000|\uFFFD/g;function zE(a){return(typeof a=="string"?a:""+a).replace(UM,`
`).replace(BM,"")}function $E(a,l){return l=zE(l),zE(a)===l}function fn(a,l,d,f,x,y){switch(d){case"children":typeof f=="string"?l==="body"||l==="textarea"&&f===""||pr(a,f):(typeof f=="number"||typeof f=="bigint")&&l!=="body"&&pr(a,""+f);break;case"className":Mr(a,"class",f);break;case"tabIndex":Mr(a,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Mr(a,d,f);break;case"style":lf(a,f,y);break;case"data":if(l!=="object"){Mr(a,"data",f);break}case"src":case"href":if(f===""&&(l!=="a"||d!=="href")){a.removeAttribute(d);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(d);break}f=zd(""+f),a.setAttribute(d,f);break;case"action":case"formAction":if(typeof f=="function"){a.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(d==="formAction"?(l!=="input"&&fn(a,l,"name",x.name,x,null),fn(a,l,"formEncType",x.formEncType,x,null),fn(a,l,"formMethod",x.formMethod,x,null),fn(a,l,"formTarget",x.formTarget,x,null)):(fn(a,l,"encType",x.encType,x,null),fn(a,l,"method",x.method,x,null),fn(a,l,"target",x.target,x,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(d);break}f=zd(""+f),a.setAttribute(d,f);break;case"onClick":f!=null&&(a.onclick=ki);break;case"onScroll":f!=null&&Vt("scroll",a);break;case"onScrollEnd":f!=null&&Vt("scrollend",a);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(d=f.__html,d!=null){if(x.children!=null)throw Error(r(60));a.innerHTML=d}}break;case"multiple":a.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":a.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){a.removeAttribute("xlink:href");break}d=zd(""+f),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(d,""+f):a.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(d,""):a.removeAttribute(d);break;case"capture":case"download":f===!0?a.setAttribute(d,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(d,f):a.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?a.setAttribute(d,f):a.removeAttribute(d);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?a.removeAttribute(d):a.setAttribute(d,f);break;case"popover":Vt("beforetoggle",a),Vt("toggle",a),Fd(a,"popover",f);break;case"xlinkActuate":ss(a,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":ss(a,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":ss(a,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":ss(a,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":ss(a,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":ss(a,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":ss(a,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":ss(a,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":ss(a,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Fd(a,"is",f);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=v0.get(d)||d,Fd(a,d,f))}}function cw(a,l,d,f,x,y){switch(d){case"style":lf(a,f,y);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(d=f.__html,d!=null){if(x.children!=null)throw Error(r(60));a.innerHTML=d}}break;case"children":typeof f=="string"?pr(a,f):(typeof f=="number"||typeof f=="bigint")&&pr(a,""+f);break;case"onScroll":f!=null&&Vt("scroll",a);break;case"onScrollEnd":f!=null&&Vt("scrollend",a);break;case"onClick":f!=null&&(a.onclick=ki);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ef.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(x=d.endsWith("Capture"),l=d.slice(2,x?d.length-7:void 0),y=a[ys]||null,y=y!=null?y[d]:null,typeof y=="function"&&a.removeEventListener(l,y,x),typeof f=="function")){typeof y!="function"&&y!==null&&(d in a?a[d]=null:a.hasAttribute(d)&&a.removeAttribute(d)),a.addEventListener(l,f,x);break e}d in a?a[d]=f:f===!0?a.setAttribute(d,""):Fd(a,d,f)}}}function Ms(a,l,d){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Vt("error",a),Vt("load",a);var f=!1,x=!1,y;for(y in d)if(d.hasOwnProperty(y)){var C=d[y];if(C!=null)switch(y){case"src":f=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:fn(a,l,y,C,d,null)}}x&&fn(a,l,"srcSet",d.srcSet,d,null),f&&fn(a,l,"src",d.src,d,null);return;case"input":Vt("invalid",a);var q=y=C=x=null,se=null,je=null;for(f in d)if(d.hasOwnProperty(f)){var ke=d[f];if(ke!=null)switch(f){case"name":x=ke;break;case"type":C=ke;break;case"checked":se=ke;break;case"defaultChecked":je=ke;break;case"value":y=ke;break;case"defaultValue":q=ke;break;case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(r(137,l));break;default:fn(a,l,f,ke,d,null)}}x0(a,y,q,se,je,C,x,!1);return;case"select":Vt("invalid",a),f=C=y=null;for(x in d)if(d.hasOwnProperty(x)&&(q=d[x],q!=null))switch(x){case"value":y=q;break;case"defaultValue":C=q;break;case"multiple":f=q;default:fn(a,l,x,q,d,null)}l=y,d=C,a.multiple=!!f,l!=null?Vo(a,!!f,l,!1):d!=null&&Vo(a,!!f,d,!0);return;case"textarea":Vt("invalid",a),y=x=f=null;for(C in d)if(d.hasOwnProperty(C)&&(q=d[C],q!=null))switch(C){case"value":f=q;break;case"defaultValue":x=q;break;case"children":y=q;break;case"dangerouslySetInnerHTML":if(q!=null)throw Error(r(91));break;default:fn(a,l,C,q,d,null)}Fo(a,f,x,y);return;case"option":for(se in d)if(d.hasOwnProperty(se)&&(f=d[se],f!=null))switch(se){case"selected":a.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:fn(a,l,se,f,d,null)}return;case"dialog":Vt("beforetoggle",a),Vt("toggle",a),Vt("cancel",a),Vt("close",a);break;case"iframe":case"object":Vt("load",a);break;case"video":case"audio":for(f=0;f<zf.length;f++)Vt(zf[f],a);break;case"image":Vt("error",a),Vt("load",a);break;case"details":Vt("toggle",a);break;case"embed":case"source":case"link":Vt("error",a),Vt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(je in d)if(d.hasOwnProperty(je)&&(f=d[je],f!=null))switch(je){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:fn(a,l,je,f,d,null)}return;default:if(Bd(l)){for(ke in d)d.hasOwnProperty(ke)&&(f=d[ke],f!==void 0&&cw(a,l,ke,f,d,void 0));return}}for(q in d)d.hasOwnProperty(q)&&(f=d[q],f!=null&&fn(a,l,q,f,d,null))}function zM(a,l,d,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,y=null,C=null,q=null,se=null,je=null,ke=null;for(Ce in d){var De=d[Ce];if(d.hasOwnProperty(Ce)&&De!=null)switch(Ce){case"checked":break;case"value":break;case"defaultValue":se=De;default:f.hasOwnProperty(Ce)||fn(a,l,Ce,null,f,De)}}for(var Se in f){var Ce=f[Se];if(De=d[Se],f.hasOwnProperty(Se)&&(Ce!=null||De!=null))switch(Se){case"type":y=Ce;break;case"name":x=Ce;break;case"checked":je=Ce;break;case"defaultChecked":ke=Ce;break;case"value":C=Ce;break;case"defaultValue":q=Ce;break;case"children":case"dangerouslySetInnerHTML":if(Ce!=null)throw Error(r(137,l));break;default:Ce!==De&&fn(a,l,Se,Ce,f,De)}}Ud(a,C,q,se,je,ke,y,x);return;case"select":Ce=C=q=Se=null;for(y in d)if(se=d[y],d.hasOwnProperty(y)&&se!=null)switch(y){case"value":break;case"multiple":Ce=se;default:f.hasOwnProperty(y)||fn(a,l,y,null,f,se)}for(x in f)if(y=f[x],se=d[x],f.hasOwnProperty(x)&&(y!=null||se!=null))switch(x){case"value":Se=y;break;case"defaultValue":q=y;break;case"multiple":C=y;default:y!==se&&fn(a,l,x,y,f,se)}l=q,d=C,f=Ce,Se!=null?Vo(a,!!d,Se,!1):!!f!=!!d&&(l!=null?Vo(a,!!d,l,!0):Vo(a,!!d,d?[]:"",!1));return;case"textarea":Ce=Se=null;for(q in d)if(x=d[q],d.hasOwnProperty(q)&&x!=null&&!f.hasOwnProperty(q))switch(q){case"value":break;case"children":break;default:fn(a,l,q,null,f,x)}for(C in f)if(x=f[C],y=d[C],f.hasOwnProperty(C)&&(x!=null||y!=null))switch(C){case"value":Se=x;break;case"defaultValue":Ce=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==y&&fn(a,l,C,x,f,y)}b0(a,Se,Ce);return;case"option":for(var nt in d)if(Se=d[nt],d.hasOwnProperty(nt)&&Se!=null&&!f.hasOwnProperty(nt))switch(nt){case"selected":a.selected=!1;break;default:fn(a,l,nt,null,f,Se)}for(se in f)if(Se=f[se],Ce=d[se],f.hasOwnProperty(se)&&Se!==Ce&&(Se!=null||Ce!=null))switch(se){case"selected":a.selected=Se&&typeof Se!="function"&&typeof Se!="symbol";break;default:fn(a,l,se,Se,f,Ce)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var pt in d)Se=d[pt],d.hasOwnProperty(pt)&&Se!=null&&!f.hasOwnProperty(pt)&&fn(a,l,pt,null,f,Se);for(je in f)if(Se=f[je],Ce=d[je],f.hasOwnProperty(je)&&Se!==Ce&&(Se!=null||Ce!=null))switch(je){case"children":case"dangerouslySetInnerHTML":if(Se!=null)throw Error(r(137,l));break;default:fn(a,l,je,Se,f,Ce)}return;default:if(Bd(l)){for(var mn in d)Se=d[mn],d.hasOwnProperty(mn)&&Se!==void 0&&!f.hasOwnProperty(mn)&&cw(a,l,mn,void 0,f,Se);for(ke in f)Se=f[ke],Ce=d[ke],!f.hasOwnProperty(ke)||Se===Ce||Se===void 0&&Ce===void 0||cw(a,l,ke,Se,f,Ce);return}}for(var de in d)Se=d[de],d.hasOwnProperty(de)&&Se!=null&&!f.hasOwnProperty(de)&&fn(a,l,de,null,f,Se);for(De in f)Se=f[De],Ce=d[De],!f.hasOwnProperty(De)||Se===Ce||Se==null&&Ce==null||fn(a,l,De,Se,f,Ce)}function qE(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function $M(){if(typeof performance.getEntriesByType=="function"){for(var a=0,l=0,d=performance.getEntriesByType("resource"),f=0;f<d.length;f++){var x=d[f],y=x.transferSize,C=x.initiatorType,q=x.duration;if(y&&q&&qE(C)){for(C=0,q=x.responseEnd,f+=1;f<d.length;f++){var se=d[f],je=se.startTime;if(je>q)break;var ke=se.transferSize,De=se.initiatorType;ke&&qE(De)&&(se=se.responseEnd,C+=ke*(se<q?1:(q-je)/(se-je)))}if(--f,l+=8*(y+C)/(x.duration/1e3),a++,10<a)break}}if(0<a)return l/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var dw=null,uw=null;function wp(a){return a.nodeType===9?a:a.ownerDocument}function HE(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function GE(a,l){if(a===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&l==="foreignObject"?0:a}function hw(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var fw=null;function qM(){var a=window.event;return a&&a.type==="popstate"?a===fw?!1:(fw=a,!0):(fw=null,!1)}var WE=typeof setTimeout=="function"?setTimeout:void 0,HM=typeof clearTimeout=="function"?clearTimeout:void 0,KE=typeof Promise=="function"?Promise:void 0,GM=typeof queueMicrotask=="function"?queueMicrotask:typeof KE<"u"?function(a){return KE.resolve(null).then(a).catch(WM)}:WE;function WM(a){setTimeout(function(){throw a})}function ll(a){return a==="head"}function QE(a,l){var d=l,f=0;do{var x=d.nextSibling;if(a.removeChild(d),x&&x.nodeType===8)if(d=x.data,d==="/$"||d==="/&"){if(f===0){a.removeChild(x),_u(l);return}f--}else if(d==="$"||d==="$?"||d==="$~"||d==="$!"||d==="&")f++;else if(d==="html")qf(a.ownerDocument.documentElement);else if(d==="head"){d=a.ownerDocument.head,qf(d);for(var y=d.firstChild;y;){var C=y.nextSibling,q=y.nodeName;y[na]||q==="SCRIPT"||q==="STYLE"||q==="LINK"&&y.rel.toLowerCase()==="stylesheet"||d.removeChild(y),y=C}}else d==="body"&&qf(a.ownerDocument.body);d=x}while(d);_u(l)}function YE(a,l){var d=a;a=0;do{var f=d.nextSibling;if(d.nodeType===1?l?(d._stashedDisplay=d.style.display,d.style.display="none"):(d.style.display=d._stashedDisplay||"",d.getAttribute("style")===""&&d.removeAttribute("style")):d.nodeType===3&&(l?(d._stashedText=d.nodeValue,d.nodeValue=""):d.nodeValue=d._stashedText||""),f&&f.nodeType===8)if(d=f.data,d==="/$"){if(a===0)break;a--}else d!=="$"&&d!=="$?"&&d!=="$~"&&d!=="$!"||a++;d=f}while(d)}function mw(a){var l=a.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var d=l;switch(l=l.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":mw(d),Vd(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}a.removeChild(d)}}function KM(a,l,d,f){for(;a.nodeType===1;){var x=d;if(a.nodeName.toLowerCase()!==l.toLowerCase()){if(!f&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(f){if(!a[na])switch(l){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(y=a.getAttribute("rel"),y==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(y!==x.rel||a.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||a.getAttribute("title")!==(x.title==null?null:x.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(y=a.getAttribute("src"),(y!==(x.src==null?null:x.src)||a.getAttribute("type")!==(x.type==null?null:x.type)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&y&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(l==="input"&&a.type==="hidden"){var y=x.name==null?null:""+x.name;if(x.type==="hidden"&&a.getAttribute("name")===y)return a}else return a;if(a=fi(a.nextSibling),a===null)break}return null}function QM(a,l,d){if(l==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!d||(a=fi(a.nextSibling),a===null))return null;return a}function XE(a,l){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!l||(a=fi(a.nextSibling),a===null))return null;return a}function gw(a){return a.data==="$?"||a.data==="$~"}function pw(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function YM(a,l){var d=a.ownerDocument;if(a.data==="$~")a._reactRetry=l;else if(a.data!=="$?"||d.readyState!=="loading")l();else{var f=function(){l(),d.removeEventListener("DOMContentLoaded",f)};d.addEventListener("DOMContentLoaded",f),a._reactRetry=f}}function fi(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return a}var xw=null;function JE(a){a=a.nextSibling;for(var l=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"||d==="/&"){if(l===0)return fi(a.nextSibling);l--}else d!=="$"&&d!=="$!"&&d!=="$?"&&d!=="$~"&&d!=="&"||l++}a=a.nextSibling}return null}function ZE(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"||d==="$~"||d==="&"){if(l===0)return a;l--}else d!=="/$"&&d!=="/&"||l++}a=a.previousSibling}return null}function eT(a,l,d){switch(l=wp(d),a){case"html":if(a=l.documentElement,!a)throw Error(r(452));return a;case"head":if(a=l.head,!a)throw Error(r(453));return a;case"body":if(a=l.body,!a)throw Error(r(454));return a;default:throw Error(r(451))}}function qf(a){for(var l=a.attributes;l.length;)a.removeAttributeNode(l[0]);Vd(a)}var mi=new Map,tT=new Set;function _p(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var lo=V.d;V.d={f:XM,r:JM,D:ZM,C:eL,L:tL,m:nL,X:rL,S:sL,M:iL};function XM(){var a=lo.f(),l=fp();return a||l}function JM(a){var l=si(a);l!==null&&l.tag===5&&l.type==="form"?bS(l):lo.r(a)}var yu=typeof document>"u"?null:document;function nT(a,l,d){var f=yu;if(f&&typeof l=="string"&&l){var x=gr(l);x='link[rel="'+a+'"][href="'+x+'"]',typeof d=="string"&&(x+='[crossorigin="'+d+'"]'),tT.has(x)||(tT.add(x),a={rel:a,crossOrigin:d,href:l},f.querySelector(x)===null&&(l=f.createElement("link"),Ms(l,"link",a),ns(l),f.head.appendChild(l)))}}function ZM(a){lo.D(a),nT("dns-prefetch",a,null)}function eL(a,l){lo.C(a,l),nT("preconnect",a,l)}function tL(a,l,d){lo.L(a,l,d);var f=yu;if(f&&a&&l){var x='link[rel="preload"][as="'+gr(l)+'"]';l==="image"&&d&&d.imageSrcSet?(x+='[imagesrcset="'+gr(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(x+='[imagesizes="'+gr(d.imageSizes)+'"]')):x+='[href="'+gr(a)+'"]';var y=x;switch(l){case"style":y=vu(a);break;case"script":y=wu(a)}mi.has(y)||(a=b({rel:"preload",href:l==="image"&&d&&d.imageSrcSet?void 0:a,as:l},d),mi.set(y,a),f.querySelector(x)!==null||l==="style"&&f.querySelector(Hf(y))||l==="script"&&f.querySelector(Gf(y))||(l=f.createElement("link"),Ms(l,"link",a),ns(l),f.head.appendChild(l)))}}function nL(a,l){lo.m(a,l);var d=yu;if(d&&a){var f=l&&typeof l.as=="string"?l.as:"script",x='link[rel="modulepreload"][as="'+gr(f)+'"][href="'+gr(a)+'"]',y=x;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=wu(a)}if(!mi.has(y)&&(a=b({rel:"modulepreload",href:a},l),mi.set(y,a),d.querySelector(x)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(Gf(y)))return}f=d.createElement("link"),Ms(f,"link",a),ns(f),d.head.appendChild(f)}}}function sL(a,l,d){lo.S(a,l,d);var f=yu;if(f&&a){var x=ra(f).hoistableStyles,y=vu(a);l=l||"default";var C=x.get(y);if(!C){var q={loading:0,preload:null};if(C=f.querySelector(Hf(y)))q.loading=5;else{a=b({rel:"stylesheet",href:a,"data-precedence":l},d),(d=mi.get(y))&&bw(a,d);var se=C=f.createElement("link");ns(se),Ms(se,"link",a),se._p=new Promise(function(je,ke){se.onload=je,se.onerror=ke}),se.addEventListener("load",function(){q.loading|=1}),se.addEventListener("error",function(){q.loading|=2}),q.loading|=4,Np(C,l,f)}C={type:"stylesheet",instance:C,count:1,state:q},x.set(y,C)}}}function rL(a,l){lo.X(a,l);var d=yu;if(d&&a){var f=ra(d).hoistableScripts,x=wu(a),y=f.get(x);y||(y=d.querySelector(Gf(x)),y||(a=b({src:a,async:!0},l),(l=mi.get(x))&&yw(a,l),y=d.createElement("script"),ns(y),Ms(y,"link",a),d.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(x,y))}}function iL(a,l){lo.M(a,l);var d=yu;if(d&&a){var f=ra(d).hoistableScripts,x=wu(a),y=f.get(x);y||(y=d.querySelector(Gf(x)),y||(a=b({src:a,async:!0,type:"module"},l),(l=mi.get(x))&&yw(a,l),y=d.createElement("script"),ns(y),Ms(y,"link",a),d.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(x,y))}}function sT(a,l,d,f){var x=(x=me.current)?_p(x):null;if(!x)throw Error(r(446));switch(a){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(l=vu(d.href),d=ra(x).hoistableStyles,f=d.get(l),f||(f={type:"style",instance:null,count:0,state:null},d.set(l,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){a=vu(d.href);var y=ra(x).hoistableStyles,C=y.get(a);if(C||(x=x.ownerDocument||x,C={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(a,C),(y=x.querySelector(Hf(a)))&&!y._p&&(C.instance=y,C.state.loading=5),mi.has(a)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},mi.set(a,d),y||aL(x,a,d,C.state))),l&&f===null)throw Error(r(528,""));return C}if(l&&f!==null)throw Error(r(529,""));return null;case"script":return l=d.async,d=d.src,typeof d=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=wu(d),d=ra(x).hoistableScripts,f=d.get(l),f||(f={type:"script",instance:null,count:0,state:null},d.set(l,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,a))}}function vu(a){return'href="'+gr(a)+'"'}function Hf(a){return'link[rel="stylesheet"]['+a+"]"}function rT(a){return b({},a,{"data-precedence":a.precedence,precedence:null})}function aL(a,l,d,f){a.querySelector('link[rel="preload"][as="style"]['+l+"]")?f.loading=1:(l=a.createElement("link"),f.preload=l,l.addEventListener("load",function(){return f.loading|=1}),l.addEventListener("error",function(){return f.loading|=2}),Ms(l,"link",d),ns(l),a.head.appendChild(l))}function wu(a){return'[src="'+gr(a)+'"]'}function Gf(a){return"script[async]"+a}function iT(a,l,d){if(l.count++,l.instance===null)switch(l.type){case"style":var f=a.querySelector('style[data-href~="'+gr(d.href)+'"]');if(f)return l.instance=f,ns(f),f;var x=b({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return f=(a.ownerDocument||a).createElement("style"),ns(f),Ms(f,"style",x),Np(f,d.precedence,a),l.instance=f;case"stylesheet":x=vu(d.href);var y=a.querySelector(Hf(x));if(y)return l.state.loading|=4,l.instance=y,ns(y),y;f=rT(d),(x=mi.get(x))&&bw(f,x),y=(a.ownerDocument||a).createElement("link"),ns(y);var C=y;return C._p=new Promise(function(q,se){C.onload=q,C.onerror=se}),Ms(y,"link",f),l.state.loading|=4,Np(y,d.precedence,a),l.instance=y;case"script":return y=wu(d.src),(x=a.querySelector(Gf(y)))?(l.instance=x,ns(x),x):(f=d,(x=mi.get(y))&&(f=b({},d),yw(f,x)),a=a.ownerDocument||a,x=a.createElement("script"),ns(x),Ms(x,"link",f),a.head.appendChild(x),l.instance=x);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(f=l.instance,l.state.loading|=4,Np(f,d.precedence,a));return l.instance}function Np(a,l,d){for(var f=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=f.length?f[f.length-1]:null,y=x,C=0;C<f.length;C++){var q=f[C];if(q.dataset.precedence===l)y=q;else if(y!==x)break}y?y.parentNode.insertBefore(a,y.nextSibling):(l=d.nodeType===9?d.head:d,l.insertBefore(a,l.firstChild))}function bw(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.title==null&&(a.title=l.title)}function yw(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.integrity==null&&(a.integrity=l.integrity)}var jp=null;function aT(a,l,d){if(jp===null){var f=new Map,x=jp=new Map;x.set(d,f)}else x=jp,f=x.get(d),f||(f=new Map,x.set(d,f));if(f.has(a))return f;for(f.set(a,null),d=d.getElementsByTagName(a),x=0;x<d.length;x++){var y=d[x];if(!(y[na]||y[ts]||a==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var C=y.getAttribute(l)||"";C=a+C;var q=f.get(C);q?q.push(y):f.set(C,[y])}}return f}function oT(a,l,d){a=a.ownerDocument||a,a.head.insertBefore(d,l==="title"?a.querySelector("head > title"):null)}function oL(a,l,d){if(d===1||l.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return a=l.disabled,typeof l.precedence=="string"&&a==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function lT(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function lL(a,l,d,f){if(d.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(d.state.loading&4)===0){if(d.instance===null){var x=vu(f.href),y=l.querySelector(Hf(x));if(y){l=y._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(a.count++,a=Sp.bind(a),l.then(a,a)),d.state.loading|=4,d.instance=y,ns(y);return}y=l.ownerDocument||l,f=rT(f),(x=mi.get(x))&&bw(f,x),y=y.createElement("link"),ns(y);var C=y;C._p=new Promise(function(q,se){C.onload=q,C.onerror=se}),Ms(y,"link",f),d.instance=y}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(d,l),(l=d.state.preload)&&(d.state.loading&3)===0&&(a.count++,d=Sp.bind(a),l.addEventListener("load",d),l.addEventListener("error",d))}}var vw=0;function cL(a,l){return a.stylesheets&&a.count===0&&Tp(a,a.stylesheets),0<a.count||0<a.imgCount?function(d){var f=setTimeout(function(){if(a.stylesheets&&Tp(a,a.stylesheets),a.unsuspend){var y=a.unsuspend;a.unsuspend=null,y()}},6e4+l);0<a.imgBytes&&vw===0&&(vw=62500*$M());var x=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&Tp(a,a.stylesheets),a.unsuspend)){var y=a.unsuspend;a.unsuspend=null,y()}},(a.imgBytes>vw?50:800)+l);return a.unsuspend=d,function(){a.unsuspend=null,clearTimeout(f),clearTimeout(x)}}:null}function Sp(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Tp(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var Ep=null;function Tp(a,l){a.stylesheets=null,a.unsuspend!==null&&(a.count++,Ep=new Map,l.forEach(dL,a),Ep=null,Sp.call(a))}function dL(a,l){if(!(l.state.loading&4)){var d=Ep.get(a);if(d)var f=d.get(null);else{d=new Map,Ep.set(a,d);for(var x=a.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<x.length;y++){var C=x[y];(C.nodeName==="LINK"||C.getAttribute("media")!=="not all")&&(d.set(C.dataset.precedence,C),f=C)}f&&d.set(null,f)}x=l.instance,C=x.getAttribute("data-precedence"),y=d.get(C)||f,y===f&&d.set(null,x),d.set(C,x),this.count++,f=Sp.bind(this),x.addEventListener("load",f),x.addEventListener("error",f),y?y.parentNode.insertBefore(x,y.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(x,a.firstChild)),l.state.loading|=4}}var Wf={$$typeof:$,Provider:null,Consumer:null,_currentValue:Q,_currentValue2:Q,_threadCount:0};function uL(a,l,d,f,x,y,C,q,se){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pr(0),this.hiddenUpdates=Pr(null),this.identifierPrefix=f,this.onUncaughtError=x,this.onCaughtError=y,this.onRecoverableError=C,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=se,this.incompleteTransitions=new Map}function cT(a,l,d,f,x,y,C,q,se,je,ke,De){return a=new uL(a,l,d,C,se,je,ke,De,q),l=1,y===!0&&(l|=24),y=Vr(3,null,null,l),a.current=y,y.stateNode=a,l=Zy(),l.refCount++,a.pooledCache=l,l.refCount++,y.memoizedState={element:f,isDehydrated:d,cache:l},sv(y),a}function dT(a){return a?(a=Jd,a):Jd}function uT(a,l,d,f,x,y){x=dT(x),f.context===null?f.context=x:f.pendingContext=x,f=Xo(l),f.payload={element:d},y=y===void 0?null:y,y!==null&&(f.callback=y),d=Jo(a,f,l),d!==null&&(wr(d,a,l),Sf(d,a,l))}function hT(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<l?d:l}}function ww(a,l){hT(a,l),(a=a.alternate)&&hT(a,l)}function fT(a){if(a.tag===13||a.tag===31){var l=vc(a,67108864);l!==null&&wr(l,a,67108864),ww(a,67108864)}}function mT(a){if(a.tag===13||a.tag===31){var l=$r();l=lc(l);var d=vc(a,l);d!==null&&wr(d,a,l),ww(a,l)}}var Ip=!0;function hL(a,l,d,f){var x=A.T;A.T=null;var y=V.p;try{V.p=2,_w(a,l,d,f)}finally{V.p=y,A.T=x}}function fL(a,l,d,f){var x=A.T;A.T=null;var y=V.p;try{V.p=8,_w(a,l,d,f)}finally{V.p=y,A.T=x}}function _w(a,l,d,f){if(Ip){var x=Nw(f);if(x===null)lw(a,l,f,Cp,d),pT(a,f);else if(gL(x,a,l,d,f))f.stopPropagation();else if(pT(a,f),l&4&&-1<mL.indexOf(a)){for(;x!==null;){var y=si(x);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var C=$t(y.pendingLanes);if(C!==0){var q=y;for(q.pendingLanes|=2,q.entangledLanes|=2;C;){var se=1<<31-We(C);q.entanglements[1]|=se,C&=~se}xa(y),(Jt&6)===0&&(up=Pe()+500,Bf(0))}}break;case 31:case 13:q=vc(y,2),q!==null&&wr(q,y,2),fp(),ww(y,2)}if(y=Nw(f),y===null&&lw(a,l,f,Cp,d),y===x)break;x=y}x!==null&&f.stopPropagation()}else lw(a,l,f,null,d)}}function Nw(a){return a=ri(a),jw(a)}var Cp=null;function jw(a){if(Cp=null,a=sa(a),a!==null){var l=o(a);if(l===null)a=null;else{var d=l.tag;if(d===13){if(a=c(l),a!==null)return a;a=null}else if(d===31){if(a=u(l),a!==null)return a;a=null}else if(d===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null)}}return Cp=a,null}function gT(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(gt()){case Ee:return 2;case Be:return 8;case ht:case Me:return 32;case Ze:return 268435456;default:return 32}default:return 32}}var Sw=!1,cl=null,dl=null,ul=null,Kf=new Map,Qf=new Map,hl=[],mL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function pT(a,l){switch(a){case"focusin":case"focusout":cl=null;break;case"dragenter":case"dragleave":dl=null;break;case"mouseover":case"mouseout":ul=null;break;case"pointerover":case"pointerout":Kf.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qf.delete(l.pointerId)}}function Yf(a,l,d,f,x,y){return a===null||a.nativeEvent!==y?(a={blockedOn:l,domEventName:d,eventSystemFlags:f,nativeEvent:y,targetContainers:[x]},l!==null&&(l=si(l),l!==null&&fT(l)),a):(a.eventSystemFlags|=f,l=a.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),a)}function gL(a,l,d,f,x){switch(l){case"focusin":return cl=Yf(cl,a,l,d,f,x),!0;case"dragenter":return dl=Yf(dl,a,l,d,f,x),!0;case"mouseover":return ul=Yf(ul,a,l,d,f,x),!0;case"pointerover":var y=x.pointerId;return Kf.set(y,Yf(Kf.get(y)||null,a,l,d,f,x)),!0;case"gotpointercapture":return y=x.pointerId,Qf.set(y,Yf(Qf.get(y)||null,a,l,d,f,x)),!0}return!1}function xT(a){var l=sa(a.target);if(l!==null){var d=o(l);if(d!==null){if(l=d.tag,l===13){if(l=c(d),l!==null){a.blockedOn=l,Ci(a.priority,function(){mT(d)});return}}else if(l===31){if(l=u(d),l!==null){a.blockedOn=l,Ci(a.priority,function(){mT(d)});return}}else if(l===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Ap(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var d=Nw(a.nativeEvent);if(d===null){d=a.nativeEvent;var f=new d.constructor(d.type,d);cf=f,d.target.dispatchEvent(f),cf=null}else return l=si(d),l!==null&&fT(l),a.blockedOn=d,!1;l.shift()}return!0}function bT(a,l,d){Ap(a)&&d.delete(l)}function pL(){Sw=!1,cl!==null&&Ap(cl)&&(cl=null),dl!==null&&Ap(dl)&&(dl=null),ul!==null&&Ap(ul)&&(ul=null),Kf.forEach(bT),Qf.forEach(bT)}function kp(a,l){a.blockedOn===l&&(a.blockedOn=null,Sw||(Sw=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,pL)))}var Rp=null;function yT(a){Rp!==a&&(Rp=a,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Rp===a&&(Rp=null);for(var l=0;l<a.length;l+=3){var d=a[l],f=a[l+1],x=a[l+2];if(typeof f!="function"){if(jw(f||d)===null)continue;break}var y=si(d);y!==null&&(a.splice(l,3),l-=3,Nv(y,{pending:!0,data:x,method:d.method,action:f},f,x))}}))}function _u(a){function l(se){return kp(se,a)}cl!==null&&kp(cl,a),dl!==null&&kp(dl,a),ul!==null&&kp(ul,a),Kf.forEach(l),Qf.forEach(l);for(var d=0;d<hl.length;d++){var f=hl[d];f.blockedOn===a&&(f.blockedOn=null)}for(;0<hl.length&&(d=hl[0],d.blockedOn===null);)xT(d),d.blockedOn===null&&hl.shift();if(d=(a.ownerDocument||a).$$reactFormReplay,d!=null)for(f=0;f<d.length;f+=3){var x=d[f],y=d[f+1],C=x[ys]||null;if(typeof y=="function")C||yT(d);else if(C){var q=null;if(y&&y.hasAttribute("formAction")){if(x=y,C=y[ys]||null)q=C.formAction;else if(jw(x)!==null)continue}else q=C.action;typeof q=="function"?d[f+1]=q:(d.splice(f,3),f-=3),yT(d)}}}function vT(){function a(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(C){return x=C})},focusReset:"manual",scroll:"manual"})}function l(){x!==null&&(x(),x=null),f||setTimeout(d,20)}function d(){if(!f&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,x=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(d,100),function(){f=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),x!==null&&(x(),x=null)}}}function Ew(a){this._internalRoot=a}Dp.prototype.render=Ew.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(r(409));var d=l.current,f=$r();uT(d,f,a,l,null,null)},Dp.prototype.unmount=Ew.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;uT(a.current,2,null,a,null,null),fp(),l[ta]=null}};function Dp(a){this._internalRoot=a}Dp.prototype.unstable_scheduleHydration=function(a){if(a){var l=f0();a={blockedOn:null,target:a,priority:l};for(var d=0;d<hl.length&&l!==0&&l<hl[d].priority;d++);hl.splice(d,0,a),d===0&&xT(a)}};var wT=e.version;if(wT!=="19.2.3")throw Error(r(527,wT,"19.2.3"));V.findDOMNode=function(a){var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(r(188)):(a=Object.keys(a).join(","),Error(r(268,a)));return a=m(l),a=a!==null?p(a):null,a=a===null?null:a.stateNode,a};var xL={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:A,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pp.isDisabled&&Pp.supportsFiber)try{St=Pp.inject(xL),ve=Pp}catch{}}return Jf.createRoot=function(a,l){if(!i(a))throw Error(r(299));var d=!1,f="",x=IS,y=CS,C=AS;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(y=l.onCaughtError),l.onRecoverableError!==void 0&&(C=l.onRecoverableError)),l=cT(a,1,!1,null,null,d,f,null,x,y,C,vT),a[ta]=l.current,ow(a),new Ew(l)},Jf.hydrateRoot=function(a,l,d){if(!i(a))throw Error(r(299));var f=!1,x="",y=IS,C=CS,q=AS,se=null;return d!=null&&(d.unstable_strictMode===!0&&(f=!0),d.identifierPrefix!==void 0&&(x=d.identifierPrefix),d.onUncaughtError!==void 0&&(y=d.onUncaughtError),d.onCaughtError!==void 0&&(C=d.onCaughtError),d.onRecoverableError!==void 0&&(q=d.onRecoverableError),d.formState!==void 0&&(se=d.formState)),l=cT(a,1,!0,l,d??null,f,x,se,y,C,q,vT),l.context=dT(null),d=l.current,f=$r(),f=lc(f),x=Xo(f),x.callback=null,Jo(d,x,f),d=f,l.current.lanes=d,ea(l,d),xa(l),a[ta]=l.current,ow(a),new Dp(l)},Jf.version="19.2.3",Jf}var kT;function EL(){if(kT)return Cw.exports;kT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Cw.exports=SL(),Cw.exports}var TL=EL(),ue=(n=>(n.WaitingMerchant=" ",n.Preparing=" ",n.Ready=" ",n.Pending=" ",n.InTransit=" ",n.Delivered=" ",n.Cancelled=" /",n))(ue||{});const IL=()=>{};var RT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E4={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qe=function(n,e){if(!n)throw Dh(e)},Dh=function(n){return new Error("Firebase Database ("+E4.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T4=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},CL=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=n[t++],c=n[t++],u=n[t++],h=((i&7)<<18|(o&63)<<12|(c&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const o=n[t++],c=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|c&63)}}return e.join("")},nN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const o=n[i],c=i+1<n.length,u=c?n[i+1]:0,h=i+2<n.length,m=h?n[i+2]:0,p=o>>2,b=(o&3)<<4|u>>4;let v=(u&15)<<2|m>>6,_=m&63;h||(_=64,c||(v=64)),r.push(t[p],t[b],t[v],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(T4(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):CL(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const o=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;const m=i<n.length?t[n.charAt(i)]:64;++i;const b=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||u==null||m==null||b==null)throw new AL;const v=o<<2|u>>4;if(r.push(v),m!==64){const _=u<<4&240|m>>2;if(r.push(_),b!==64){const T=m<<6&192|b;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class AL extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const I4=function(n){const e=T4(n);return nN.encodeByteArray(e,!0)},_x=function(n){return I4(n).replace(/\./g,"")},Wm=function(n){try{return nN.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kL(n){return Km(void 0,n)}function Km(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!RL(t)||(n[t]=Km(n[t],e[t]));return n}function RL(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DL=()=>sN().__FIREBASE_DEFAULTS__,PL=()=>{if(typeof process>"u"||typeof RT>"u")return;const n=RT.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},OL=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Wm(n[1]);return e&&JSON.parse(e)},rN=()=>{try{return IL()||DL()||PL()||OL()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},iN=()=>{var n;return(n=rN())==null?void 0:n.config},ML=n=>{var e;return(e=rN())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ba(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function gb(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aN(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...n};return[_x(JSON.stringify(t)),_x(JSON.stringify(c)),""].join(".")}const Em={};function LL(){const n={prod:[],emulator:[]};for(const e of Object.keys(Em))Em[e]?n.emulator.push(e):n.prod.push(e);return n}function VL(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let DT=!1;function pb(n,e){if(typeof window>"u"||typeof document>"u"||!Ba(window.location.host)||Em[n]===e||Em[n]||DT)return;Em[n]=e;function t(v){return`__firebase__banner__${v}`}const r="__firebase__banner",o=LL().prod.length>0;function c(){const v=document.getElementById(r);v&&v.remove()}function u(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function h(v,_){v.setAttribute("width","24"),v.setAttribute("id",_),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function m(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{DT=!0,c()},v}function p(v,_){v.setAttribute("id",_),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function b(){const v=VL(r),_=t("text"),T=document.getElementById(_)||document.createElement("span"),k=t("learnmore"),E=document.getElementById(k)||document.createElement("a"),S=t("preprendIcon"),L=document.getElementById(S)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const $=v.element;u($),p(E,k);const H=m();h(L,S),$.append(L,T,E,H),document.body.appendChild($)}o?(T.innerText="Preview backend disconnected.",L.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(L.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function oN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Mn())}function xb(){var e;const n=(e=rN())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function FL(){return typeof window<"u"||C4()}function C4(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function UL(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function A4(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function bb(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function k4(){const n=Mn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function BL(){return E4.NODE_ADMIN===!0}function R4(){return!xb()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function D4(){return!xb()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function sd(){try{return typeof indexedDB=="object"}catch{return!1}}function zL(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)==null?void 0:o.message)||"")}}catch(t){e(t)}})}function $L(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL="FirebaseError";class Us extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=qL,Object.setPrototypeOf(this,Us.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,za.prototype.create)}}class za{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],c=o?HL(o,r):"Error",u=`${this.serviceName}: ${c} (${i}).`;return new Us(i,u,r)}}function HL(n,e){return n.replace(GL,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const GL=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qm(n){return JSON.parse(n)}function gs(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P4=function(n){let e={},t={},r={},i="";try{const o=n.split(".");e=Qm(Wm(o[0])||""),t=Qm(Wm(o[1])||""),i=o[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}},WL=function(n){const e=P4(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},KL=function(n){const e=P4(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yr(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function rd(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Nx(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function jx(n,e,t){const r={};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function _o(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const o=n[i],c=e[i];if(PT(o)&&PT(c)){if(!_o(o,c))return!1}else if(o!==c)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function PT(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Td(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Fu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function pm(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QL{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const r=this.W_;if(typeof e=="string")for(let b=0;b<16;b++)r[b]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let b=0;b<16;b++)r[b]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let b=16;b<80;b++){const v=r[b-3]^r[b-8]^r[b-14]^r[b-16];r[b]=(v<<1|v>>>31)&4294967295}let i=this.chain_[0],o=this.chain_[1],c=this.chain_[2],u=this.chain_[3],h=this.chain_[4],m,p;for(let b=0;b<80;b++){b<40?b<20?(m=u^o&(c^u),p=1518500249):(m=o^c^u,p=1859775393):b<60?(m=o&c|u&(o|c),p=2400959708):(m=o^c^u,p=3395469782);const v=(i<<5|i>>>27)+m+h+p+r[b]&4294967295;h=u,u=c,c=(o<<30|o>>>2)&4294967295,o=i,i=v}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const r=t-this.blockSize;let i=0;const o=this.buf_;let c=this.inbuf_;for(;i<t;){if(c===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(o[c]=e.charCodeAt(i),++c,++i,c===this.blockSize){this.compress_(o),c=0;break}}else for(;i<t;)if(o[c]=e[i],++c,++i,c===this.blockSize){this.compress_(o),c=0;break}}this.inbuf_=c,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let o=24;o>=0;o-=8)e[r]=this.chain_[i]>>o&255,++r;return e}}function O4(n,e){const t=new YL(n,e);return t.subscribe.bind(t)}class YL{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");XL(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Dw),i.error===void 0&&(i.error=Dw),i.complete===void 0&&(i.complete=Dw);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function XL(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Dw(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vt=function(n,e,t,r){let i;if(r<e?i="at least "+e:r>t&&(i=t===0?"none":"no more than "+t),i){const o=n+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(o)}};function Cr(n,e){return`${n} failed: ${e} argument `}function Ss(n,e,t,r){if(!(r&&!t)&&typeof t!="function")throw new Error(Cr(n,e)+"must be a valid function.")}function OT(n,e,t,r){if(t&&(typeof t!="object"||t===null))throw new Error(Cr(n,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JL=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){const o=i-55296;r++,qe(r<n.length,"Surrogate pair missing trail surrogate.");const c=n.charCodeAt(r)-56320;i=65536+(o<<10)+c}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},yb=function(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xe(n){return n&&n._delegate?n._delegate:n}class $n{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oc="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D_{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Nr;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(eV(e))try{this.getOrInitializeService({instanceIdentifier:Oc})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Oc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Oc){return this.instances.has(e)}getOptions(e=Oc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[o,c]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);r===u&&c.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:ZL(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Oc){return this.component?this.component.multipleInstances?e:Oc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ZL(n){return n===Oc?void 0:n}function eV(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new D_(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cN=[];var Ot;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ot||(Ot={}));const M4={debug:Ot.DEBUG,verbose:Ot.VERBOSE,info:Ot.INFO,warn:Ot.WARN,error:Ot.ERROR,silent:Ot.SILENT},tV=Ot.INFO,nV={[Ot.DEBUG]:"log",[Ot.VERBOSE]:"log",[Ot.INFO]:"info",[Ot.WARN]:"warn",[Ot.ERROR]:"error"},sV=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=nV[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ph{constructor(e){this.name=e,this._logLevel=tV,this._logHandler=sV,this._userLogHandler=null,cN.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ot))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?M4[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ot.DEBUG,...e),this._logHandler(this,Ot.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ot.VERBOSE,...e),this._logHandler(this,Ot.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ot.INFO,...e),this._logHandler(this,Ot.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ot.WARN,...e),this._logHandler(this,Ot.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ot.ERROR,...e),this._logHandler(this,Ot.ERROR,...e)}}function rV(n){cN.forEach(e=>{e.setLogLevel(n)})}function iV(n,e){for(const t of cN){let r=null;e&&e.level&&(r=M4[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,o,...c)=>{const u=c.map(h=>{if(h==null)return null;if(typeof h=="string")return h;if(typeof h=="number"||typeof h=="boolean")return h.toString();if(h instanceof Error)return h.message;try{return JSON.stringify(h)}catch{return null}}).filter(h=>h).join(" ");o>=(r??i.logLevel)&&n({level:Ot[o].toLowerCase(),message:u,args:c,type:i.name})}}}const aV=(n,e)=>e.some(t=>n instanceof t);let MT,LT;function oV(){return MT||(MT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function lV(){return LT||(LT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const L4=new WeakMap,P_=new WeakMap,V4=new WeakMap,Pw=new WeakMap,dN=new WeakMap;function cV(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",c)},o=()=>{t(bo(n.result)),i()},c=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&L4.set(t,n)}).catch(()=>{}),dN.set(e,n),e}function dV(n){if(P_.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",c),n.removeEventListener("abort",c)},o=()=>{t(),i()},c=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",c),n.addEventListener("abort",c)});P_.set(n,e)}let O_={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return P_.get(n);if(e==="objectStoreNames")return n.objectStoreNames||V4.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return bo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function uV(n){O_=n(O_)}function hV(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Ow(this),e,...t);return V4.set(r,e.sort?e.sort():[e]),bo(r)}:lV().includes(n)?function(...e){return n.apply(Ow(this),e),bo(L4.get(this))}:function(...e){return bo(n.apply(Ow(this),e))}}function fV(n){return typeof n=="function"?hV(n):(n instanceof IDBTransaction&&dV(n),aV(n,oV())?new Proxy(n,O_):n)}function bo(n){if(n instanceof IDBRequest)return cV(n);if(Pw.has(n))return Pw.get(n);const e=fV(n);return e!==n&&(Pw.set(n,e),dN.set(e,n)),e}const Ow=n=>dN.get(n);function Oh(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){const c=indexedDB.open(n,e),u=bo(c);return r&&c.addEventListener("upgradeneeded",h=>{r(bo(c.result),h.oldVersion,h.newVersion,bo(c.transaction),h)}),t&&c.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",m=>i(m.oldVersion,m.newVersion,m))}).catch(()=>{}),u}function Uu(n,{blocked:e}={}){const t=indexedDB.deleteDatabase(n);return e&&t.addEventListener("blocked",r=>e(r.oldVersion,r)),bo(t).then(()=>{})}const mV=["get","getKey","getAll","getAllKeys","count"],gV=["put","add","delete","clear"],Mw=new Map;function VT(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Mw.get(e))return Mw.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=gV.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||mV.includes(t)))return;const o=async function(c,...u){const h=this.transaction(c,i?"readwrite":"readonly");let m=h.store;return r&&(m=m.index(u.shift())),(await Promise.all([m[t](...u),i&&h.done]))[0]};return Mw.set(e,o),o}uV(n=>({...n,get:(e,t,r)=>VT(e,t)||n.get(e,t,r),has:(e,t)=>!!VT(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(xV(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function xV(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Sx="@firebase/app",M_="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const No=new Ph("@firebase/app"),bV="@firebase/app-compat",yV="@firebase/analytics-compat",vV="@firebase/analytics",wV="@firebase/app-check-compat",_V="@firebase/app-check",NV="@firebase/auth",jV="@firebase/auth-compat",SV="@firebase/database",EV="@firebase/data-connect",TV="@firebase/database-compat",IV="@firebase/functions",CV="@firebase/functions-compat",AV="@firebase/installations",kV="@firebase/installations-compat",RV="@firebase/messaging",DV="@firebase/messaging-compat",PV="@firebase/performance",OV="@firebase/performance-compat",MV="@firebase/remote-config",LV="@firebase/remote-config-compat",VV="@firebase/storage",FV="@firebase/storage-compat",UV="@firebase/firestore",BV="@firebase/ai",zV="@firebase/firestore-compat",$V="firebase",qV="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ll="[DEFAULT]",HV={[Sx]:"fire-core",[bV]:"fire-core-compat",[vV]:"fire-analytics",[yV]:"fire-analytics-compat",[_V]:"fire-app-check",[wV]:"fire-app-check-compat",[NV]:"fire-auth",[jV]:"fire-auth-compat",[SV]:"fire-rtdb",[EV]:"fire-data-connect",[TV]:"fire-rtdb-compat",[IV]:"fire-fn",[CV]:"fire-fn-compat",[AV]:"fire-iid",[kV]:"fire-iid-compat",[RV]:"fire-fcm",[DV]:"fire-fcm-compat",[PV]:"fire-perf",[OV]:"fire-perf-compat",[MV]:"fire-rc",[LV]:"fire-rc-compat",[VV]:"fire-gcs",[FV]:"fire-gcs-compat",[UV]:"fire-fst",[zV]:"fire-fst-compat",[BV]:"fire-vertex","fire-js":"fire-js",[$V]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vl=new Map,nh=new Map,sh=new Map;function Ym(n,e){try{n.container.addComponent(e)}catch(t){No.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function F4(n,e){n.container.addOrOverwriteComponent(e)}function hr(n){const e=n.name;if(sh.has(e))return No.debug(`There were multiple attempts to register component ${e}.`),!1;sh.set(e,n);for(const t of Vl.values())Ym(t,n);for(const t of nh.values())Ym(t,n);return!0}function vb(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function GV(n,e,t=Ll){vb(n,e).clearInstance(t)}function uN(n){return n.options!==void 0}function U4(n){return uN(n)?!1:"authIdToken"in n||"appCheckToken"in n||"releaseOnDeref"in n||"automaticDataCollectionEnabled"in n}function bn(n){return n==null?!1:n.settings!==void 0}function WV(){sh.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Kr=new za("app","Firebase",KV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let B4=class{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new $n("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Kr.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FT(n,e){const t=Wm(n.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const i=JSON.parse(t).exp*1e3,o=new Date().getTime();i-o<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class QV extends B4{constructor(e,t,r,i){const o=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,c={name:r,automaticDataCollectionEnabled:o};if(e.apiKey!==void 0)super(e,c,i);else{const u=e;super(u.options,c,i)}this._serverConfig={automaticDataCollectionEnabled:o,...t},this._serverConfig.authIdToken&&FT(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&FT(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,ps(Sx,M_,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){fN(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Kr.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $a=qV;function hN(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Ll,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Kr.create("bad-app-name",{appName:String(i)});if(t||(t=iN()),!t)throw Kr.create("no-options");const o=Vl.get(i);if(o){if(_o(t,o.options)&&_o(r,o.config))return o;throw Kr.create("duplicate-app",{appName:i})}const c=new lN(i);for(const h of sh.values())c.addComponent(h);const u=new B4(t,r,c);return Vl.set(i,u),u}function YV(n,e={}){if(FL()&&!C4())throw Kr.create("invalid-server-app-environment");let t,r=e||{};if(n&&(uN(n)?t=n.options:U4(n)?r=n:t=n),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),t||(t=iN()),!t)throw Kr.create("no-options");const i={...r,...t};i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;const o=p=>[...p].reduce((b,v)=>Math.imul(31,b)+v.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Kr.create("finalization-registry-not-supported",{});const c=""+o(JSON.stringify(i)),u=nh.get(c);if(u)return u.incRefCount(r.releaseOnDeref),u;const h=new lN(c);for(const p of sh.values())h.addComponent(p);const m=new QV(t,r,c,h);return nh.set(c,m),m}function XV(n=Ll){const e=Vl.get(n);if(!e&&n===Ll&&iN())return hN();if(!e)throw Kr.create("no-app",{appName:n});return e}function JV(){return Array.from(Vl.values())}async function fN(n){let e=!1;const t=n.name;Vl.has(t)?(e=!0,Vl.delete(t)):nh.has(t)&&n.decRefCount()<=0&&(nh.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)}function ps(n,e,t){let r=HV[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const c=[`Unable to register library "${r}" with version "${e}":`];i&&c.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),No.warn(c.join(" "));return}hr(new $n(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function z4(n,e){if(n!==null&&typeof n!="function")throw Kr.create("invalid-log-argument");iV(n,e)}function $4(n){rV(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZV="firebase-heartbeat-database",e9=1,Xm="firebase-heartbeat-store";let Lw=null;function q4(){return Lw||(Lw=Oh(ZV,e9,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Xm)}catch(t){console.warn(t)}}}}).catch(n=>{throw Kr.create("idb-open",{originalErrorMessage:n.message})})),Lw}async function t9(n){try{const t=(await q4()).transaction(Xm),r=await t.objectStore(Xm).get(H4(n));return await t.done,r}catch(e){if(e instanceof Us)No.warn(e.message);else{const t=Kr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});No.warn(t.message)}}}async function UT(n,e){try{const r=(await q4()).transaction(Xm,"readwrite");await r.objectStore(Xm).put(e,H4(n)),await r.done}catch(t){if(t instanceof Us)No.warn(t.message);else{const r=Kr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});No.warn(r.message)}}}function H4(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n9=1024,s9=30;class r9{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new a9(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=BT();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(c=>c.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats.length>s9){const c=o9(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){No.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=BT(),{heartbeatsToSend:r,unsentEntries:i}=i9(this._heartbeatsCache.heartbeats),o=_x(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return No.warn(t),""}}}function BT(){return new Date().toISOString().substring(0,10)}function i9(n,e=n9){const t=[];let r=n.slice();for(const i of n){const o=t.find(c=>c.agent===i.agent);if(o){if(o.dates.push(i.date),zT(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),zT(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class a9{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return sd()?zL().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await t9(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return UT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return UT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function zT(n){return _x(JSON.stringify({version:2,heartbeats:n})).length}function o9(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l9(n){hr(new $n("platform-logger",e=>new pV(e),"PRIVATE")),hr(new $n("heartbeat",e=>new r9(e),"PRIVATE")),ps(Sx,M_,n),ps(Sx,M_,"esm2020"),ps("fire-js","")}l9("");const c9=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Us,SDK_VERSION:$a,_DEFAULT_ENTRY_NAME:Ll,_addComponent:Ym,_addOrOverwriteComponent:F4,_apps:Vl,_clearComponents:WV,_components:sh,_getProvider:vb,_isFirebaseApp:uN,_isFirebaseServerApp:bn,_isFirebaseServerAppSettings:U4,_registerComponent:hr,_removeServiceInstance:GV,_serverApps:nh,deleteApp:fN,getApp:XV,getApps:JV,initializeApp:hN,initializeServerApp:YV,onLog:z4,registerVersion:ps,setLogLevel:$4},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d9{constructor(e,t){this._delegate=e,this.firebase=t,Ym(e,new $n("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),fN(this._delegate)))}_getService(e,t=Ll){var i;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((i=r.getComponent())==null?void 0:i.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=Ll){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Ym(this._delegate,e)}_addOrOverwriteComponent(e){F4(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u9={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},$T=new za("app-compat","Firebase",u9);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h9(n){const e={},t={__esModule:!0,initializeApp:o,app:i,registerVersion:ps,setLogLevel:$4,onLog:z4,apps:null,SDK_VERSION:$a,INTERNAL:{registerComponent:u,removeApp:r,useAsService:h,modularAPIs:c9}};t.default=t,Object.defineProperty(t,"apps",{get:c});function r(m){delete e[m]}function i(m){if(m=m||Ll,!Yr(e,m))throw $T.create("no-app",{appName:m});return e[m]}i.App=n;function o(m,p={}){const b=hN(m,p);if(Yr(e,b.name))return e[b.name];const v=new n(b,t);return e[b.name]=v,v}function c(){return Object.keys(e).map(m=>e[m])}function u(m){const p=m.name,b=p.replace("-compat","");if(hr(m)&&m.type==="PUBLIC"){const v=(_=i())=>{if(typeof _[b]!="function")throw $T.create("invalid-app-argument",{appName:p});return _[b]()};m.serviceProps!==void 0&&Km(v,m.serviceProps),t[b]=v,n.prototype[b]=function(..._){return this._getService.bind(this,p).apply(this,m.multipleInstances?_:[])}}return m.type==="PUBLIC"?t[b]:null}function h(m,p){return p==="serverAuth"?null:p}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G4(){const n=h9(d9);n.INTERNAL={...n.INTERNAL,createFirebaseNamespace:G4,extendNamespace:e,createSubscribe:O4,ErrorFactory:za,deepExtend:Km};function e(t){Km(n,t)}return n}const f9=G4();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qT=new Ph("@firebase/app-compat"),m9="@firebase/app-compat",g9="0.5.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p9(n){ps(m9,g9,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=sN();if(n.firebase!==void 0){qT.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&qT.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const Nt=f9;p9();var x9="firebase",b9="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nt.registerVersion(x9,b9,"app-compat");var HT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Il,W4;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(P,j){function O(){}O.prototype=j.prototype,P.F=j.prototype,P.prototype=new O,P.prototype.constructor=P,P.D=function(I,R,F){for(var M=Array(arguments.length-2),ne=2;ne<arguments.length;ne++)M[ne-2]=arguments[ne];return j.prototype[R].apply(I,M)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(P,j,O){O||(O=0);const I=Array(16);if(typeof j=="string")for(var R=0;R<16;++R)I[R]=j.charCodeAt(O++)|j.charCodeAt(O++)<<8|j.charCodeAt(O++)<<16|j.charCodeAt(O++)<<24;else for(R=0;R<16;++R)I[R]=j[O++]|j[O++]<<8|j[O++]<<16|j[O++]<<24;j=P.g[0],O=P.g[1],R=P.g[2];let F=P.g[3],M;M=j+(F^O&(R^F))+I[0]+3614090360&4294967295,j=O+(M<<7&4294967295|M>>>25),M=F+(R^j&(O^R))+I[1]+3905402710&4294967295,F=j+(M<<12&4294967295|M>>>20),M=R+(O^F&(j^O))+I[2]+606105819&4294967295,R=F+(M<<17&4294967295|M>>>15),M=O+(j^R&(F^j))+I[3]+3250441966&4294967295,O=R+(M<<22&4294967295|M>>>10),M=j+(F^O&(R^F))+I[4]+4118548399&4294967295,j=O+(M<<7&4294967295|M>>>25),M=F+(R^j&(O^R))+I[5]+1200080426&4294967295,F=j+(M<<12&4294967295|M>>>20),M=R+(O^F&(j^O))+I[6]+2821735955&4294967295,R=F+(M<<17&4294967295|M>>>15),M=O+(j^R&(F^j))+I[7]+4249261313&4294967295,O=R+(M<<22&4294967295|M>>>10),M=j+(F^O&(R^F))+I[8]+1770035416&4294967295,j=O+(M<<7&4294967295|M>>>25),M=F+(R^j&(O^R))+I[9]+2336552879&4294967295,F=j+(M<<12&4294967295|M>>>20),M=R+(O^F&(j^O))+I[10]+4294925233&4294967295,R=F+(M<<17&4294967295|M>>>15),M=O+(j^R&(F^j))+I[11]+2304563134&4294967295,O=R+(M<<22&4294967295|M>>>10),M=j+(F^O&(R^F))+I[12]+1804603682&4294967295,j=O+(M<<7&4294967295|M>>>25),M=F+(R^j&(O^R))+I[13]+4254626195&4294967295,F=j+(M<<12&4294967295|M>>>20),M=R+(O^F&(j^O))+I[14]+2792965006&4294967295,R=F+(M<<17&4294967295|M>>>15),M=O+(j^R&(F^j))+I[15]+1236535329&4294967295,O=R+(M<<22&4294967295|M>>>10),M=j+(R^F&(O^R))+I[1]+4129170786&4294967295,j=O+(M<<5&4294967295|M>>>27),M=F+(O^R&(j^O))+I[6]+3225465664&4294967295,F=j+(M<<9&4294967295|M>>>23),M=R+(j^O&(F^j))+I[11]+643717713&4294967295,R=F+(M<<14&4294967295|M>>>18),M=O+(F^j&(R^F))+I[0]+3921069994&4294967295,O=R+(M<<20&4294967295|M>>>12),M=j+(R^F&(O^R))+I[5]+3593408605&4294967295,j=O+(M<<5&4294967295|M>>>27),M=F+(O^R&(j^O))+I[10]+38016083&4294967295,F=j+(M<<9&4294967295|M>>>23),M=R+(j^O&(F^j))+I[15]+3634488961&4294967295,R=F+(M<<14&4294967295|M>>>18),M=O+(F^j&(R^F))+I[4]+3889429448&4294967295,O=R+(M<<20&4294967295|M>>>12),M=j+(R^F&(O^R))+I[9]+568446438&4294967295,j=O+(M<<5&4294967295|M>>>27),M=F+(O^R&(j^O))+I[14]+3275163606&4294967295,F=j+(M<<9&4294967295|M>>>23),M=R+(j^O&(F^j))+I[3]+4107603335&4294967295,R=F+(M<<14&4294967295|M>>>18),M=O+(F^j&(R^F))+I[8]+1163531501&4294967295,O=R+(M<<20&4294967295|M>>>12),M=j+(R^F&(O^R))+I[13]+2850285829&4294967295,j=O+(M<<5&4294967295|M>>>27),M=F+(O^R&(j^O))+I[2]+4243563512&4294967295,F=j+(M<<9&4294967295|M>>>23),M=R+(j^O&(F^j))+I[7]+1735328473&4294967295,R=F+(M<<14&4294967295|M>>>18),M=O+(F^j&(R^F))+I[12]+2368359562&4294967295,O=R+(M<<20&4294967295|M>>>12),M=j+(O^R^F)+I[5]+4294588738&4294967295,j=O+(M<<4&4294967295|M>>>28),M=F+(j^O^R)+I[8]+2272392833&4294967295,F=j+(M<<11&4294967295|M>>>21),M=R+(F^j^O)+I[11]+1839030562&4294967295,R=F+(M<<16&4294967295|M>>>16),M=O+(R^F^j)+I[14]+4259657740&4294967295,O=R+(M<<23&4294967295|M>>>9),M=j+(O^R^F)+I[1]+2763975236&4294967295,j=O+(M<<4&4294967295|M>>>28),M=F+(j^O^R)+I[4]+1272893353&4294967295,F=j+(M<<11&4294967295|M>>>21),M=R+(F^j^O)+I[7]+4139469664&4294967295,R=F+(M<<16&4294967295|M>>>16),M=O+(R^F^j)+I[10]+3200236656&4294967295,O=R+(M<<23&4294967295|M>>>9),M=j+(O^R^F)+I[13]+681279174&4294967295,j=O+(M<<4&4294967295|M>>>28),M=F+(j^O^R)+I[0]+3936430074&4294967295,F=j+(M<<11&4294967295|M>>>21),M=R+(F^j^O)+I[3]+3572445317&4294967295,R=F+(M<<16&4294967295|M>>>16),M=O+(R^F^j)+I[6]+76029189&4294967295,O=R+(M<<23&4294967295|M>>>9),M=j+(O^R^F)+I[9]+3654602809&4294967295,j=O+(M<<4&4294967295|M>>>28),M=F+(j^O^R)+I[12]+3873151461&4294967295,F=j+(M<<11&4294967295|M>>>21),M=R+(F^j^O)+I[15]+530742520&4294967295,R=F+(M<<16&4294967295|M>>>16),M=O+(R^F^j)+I[2]+3299628645&4294967295,O=R+(M<<23&4294967295|M>>>9),M=j+(R^(O|~F))+I[0]+4096336452&4294967295,j=O+(M<<6&4294967295|M>>>26),M=F+(O^(j|~R))+I[7]+1126891415&4294967295,F=j+(M<<10&4294967295|M>>>22),M=R+(j^(F|~O))+I[14]+2878612391&4294967295,R=F+(M<<15&4294967295|M>>>17),M=O+(F^(R|~j))+I[5]+4237533241&4294967295,O=R+(M<<21&4294967295|M>>>11),M=j+(R^(O|~F))+I[12]+1700485571&4294967295,j=O+(M<<6&4294967295|M>>>26),M=F+(O^(j|~R))+I[3]+2399980690&4294967295,F=j+(M<<10&4294967295|M>>>22),M=R+(j^(F|~O))+I[10]+4293915773&4294967295,R=F+(M<<15&4294967295|M>>>17),M=O+(F^(R|~j))+I[1]+2240044497&4294967295,O=R+(M<<21&4294967295|M>>>11),M=j+(R^(O|~F))+I[8]+1873313359&4294967295,j=O+(M<<6&4294967295|M>>>26),M=F+(O^(j|~R))+I[15]+4264355552&4294967295,F=j+(M<<10&4294967295|M>>>22),M=R+(j^(F|~O))+I[6]+2734768916&4294967295,R=F+(M<<15&4294967295|M>>>17),M=O+(F^(R|~j))+I[13]+1309151649&4294967295,O=R+(M<<21&4294967295|M>>>11),M=j+(R^(O|~F))+I[4]+4149444226&4294967295,j=O+(M<<6&4294967295|M>>>26),M=F+(O^(j|~R))+I[11]+3174756917&4294967295,F=j+(M<<10&4294967295|M>>>22),M=R+(j^(F|~O))+I[2]+718787259&4294967295,R=F+(M<<15&4294967295|M>>>17),M=O+(F^(R|~j))+I[9]+3951481745&4294967295,P.g[0]=P.g[0]+j&4294967295,P.g[1]=P.g[1]+(R+(M<<21&4294967295|M>>>11))&4294967295,P.g[2]=P.g[2]+R&4294967295,P.g[3]=P.g[3]+F&4294967295}r.prototype.v=function(P,j){j===void 0&&(j=P.length);const O=j-this.blockSize,I=this.C;let R=this.h,F=0;for(;F<j;){if(R==0)for(;F<=O;)i(this,P,F),F+=this.blockSize;if(typeof P=="string"){for(;F<j;)if(I[R++]=P.charCodeAt(F++),R==this.blockSize){i(this,I),R=0;break}}else for(;F<j;)if(I[R++]=P[F++],R==this.blockSize){i(this,I),R=0;break}}this.h=R,this.o+=j},r.prototype.A=function(){var P=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);P[0]=128;for(var j=1;j<P.length-8;++j)P[j]=0;j=this.o*8;for(var O=P.length-8;O<P.length;++O)P[O]=j&255,j/=256;for(this.v(P),P=Array(16),j=0,O=0;O<4;++O)for(let I=0;I<32;I+=8)P[j++]=this.g[O]>>>I&255;return P};function o(P,j){var O=u;return Object.prototype.hasOwnProperty.call(O,P)?O[P]:O[P]=j(P)}function c(P,j){this.h=j;const O=[];let I=!0;for(let R=P.length-1;R>=0;R--){const F=P[R]|0;I&&F==j||(O[R]=F,I=!1)}this.g=O}var u={};function h(P){return-128<=P&&P<128?o(P,function(j){return new c([j|0],j<0?-1:0)}):new c([P|0],P<0?-1:0)}function m(P){if(isNaN(P)||!isFinite(P))return b;if(P<0)return E(m(-P));const j=[];let O=1;for(let I=0;P>=O;I++)j[I]=P/O|0,O*=4294967296;return new c(j,0)}function p(P,j){if(P.length==0)throw Error("number format error: empty string");if(j=j||10,j<2||36<j)throw Error("radix out of range: "+j);if(P.charAt(0)=="-")return E(p(P.substring(1),j));if(P.indexOf("-")>=0)throw Error('number format error: interior "-" character');const O=m(Math.pow(j,8));let I=b;for(let F=0;F<P.length;F+=8){var R=Math.min(8,P.length-F);const M=parseInt(P.substring(F,F+R),j);R<8?(R=m(Math.pow(j,R)),I=I.j(R).add(m(M))):(I=I.j(O),I=I.add(m(M)))}return I}var b=h(0),v=h(1),_=h(16777216);n=c.prototype,n.m=function(){if(k(this))return-E(this).m();let P=0,j=1;for(let O=0;O<this.g.length;O++){const I=this.i(O);P+=(I>=0?I:4294967296+I)*j,j*=4294967296}return P},n.toString=function(P){if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(T(this))return"0";if(k(this))return"-"+E(this).toString(P);const j=m(Math.pow(P,6));var O=this;let I="";for(;;){const R=H(O,j).g;O=S(O,R.j(j));let F=((O.g.length>0?O.g[0]:O.h)>>>0).toString(P);if(O=R,T(O))return F+I;for(;F.length<6;)F="0"+F;I=F+I}},n.i=function(P){return P<0?0:P<this.g.length?this.g[P]:this.h};function T(P){if(P.h!=0)return!1;for(let j=0;j<P.g.length;j++)if(P.g[j]!=0)return!1;return!0}function k(P){return P.h==-1}n.l=function(P){return P=S(this,P),k(P)?-1:T(P)?0:1};function E(P){const j=P.g.length,O=[];for(let I=0;I<j;I++)O[I]=~P.g[I];return new c(O,~P.h).add(v)}n.abs=function(){return k(this)?E(this):this},n.add=function(P){const j=Math.max(this.g.length,P.g.length),O=[];let I=0;for(let R=0;R<=j;R++){let F=I+(this.i(R)&65535)+(P.i(R)&65535),M=(F>>>16)+(this.i(R)>>>16)+(P.i(R)>>>16);I=M>>>16,F&=65535,M&=65535,O[R]=M<<16|F}return new c(O,O[O.length-1]&-2147483648?-1:0)};function S(P,j){return P.add(E(j))}n.j=function(P){if(T(this)||T(P))return b;if(k(this))return k(P)?E(this).j(E(P)):E(E(this).j(P));if(k(P))return E(this.j(E(P)));if(this.l(_)<0&&P.l(_)<0)return m(this.m()*P.m());const j=this.g.length+P.g.length,O=[];for(var I=0;I<2*j;I++)O[I]=0;for(I=0;I<this.g.length;I++)for(let R=0;R<P.g.length;R++){const F=this.i(I)>>>16,M=this.i(I)&65535,ne=P.i(R)>>>16,U=P.i(R)&65535;O[2*I+2*R]+=M*U,L(O,2*I+2*R),O[2*I+2*R+1]+=F*U,L(O,2*I+2*R+1),O[2*I+2*R+1]+=M*ne,L(O,2*I+2*R+1),O[2*I+2*R+2]+=F*ne,L(O,2*I+2*R+2)}for(P=0;P<j;P++)O[P]=O[2*P+1]<<16|O[2*P];for(P=j;P<2*j;P++)O[P]=0;return new c(O,0)};function L(P,j){for(;(P[j]&65535)!=P[j];)P[j+1]+=P[j]>>>16,P[j]&=65535,j++}function $(P,j){this.g=P,this.h=j}function H(P,j){if(T(j))throw Error("division by zero");if(T(P))return new $(b,b);if(k(P))return j=H(E(P),j),new $(E(j.g),E(j.h));if(k(j))return j=H(P,E(j)),new $(E(j.g),j.h);if(P.g.length>30){if(k(P)||k(j))throw Error("slowDivide_ only works with positive integers.");for(var O=v,I=j;I.l(P)<=0;)O=G(O),I=G(I);var R=z(O,1),F=z(I,1);for(I=z(I,2),O=z(O,2);!T(I);){var M=F.add(I);M.l(P)<=0&&(R=R.add(O),F=M),I=z(I,1),O=z(O,1)}return j=S(P,R.j(j)),new $(R,j)}for(R=b;P.l(j)>=0;){for(O=Math.max(1,Math.floor(P.m()/j.m())),I=Math.ceil(Math.log(O)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),F=m(O),M=F.j(j);k(M)||M.l(P)>0;)O-=I,F=m(O),M=F.j(j);T(F)&&(F=v),R=R.add(F),P=S(P,M)}return new $(R,P)}n.B=function(P){return H(this,P).h},n.and=function(P){const j=Math.max(this.g.length,P.g.length),O=[];for(let I=0;I<j;I++)O[I]=this.i(I)&P.i(I);return new c(O,this.h&P.h)},n.or=function(P){const j=Math.max(this.g.length,P.g.length),O=[];for(let I=0;I<j;I++)O[I]=this.i(I)|P.i(I);return new c(O,this.h|P.h)},n.xor=function(P){const j=Math.max(this.g.length,P.g.length),O=[];for(let I=0;I<j;I++)O[I]=this.i(I)^P.i(I);return new c(O,this.h^P.h)};function G(P){const j=P.g.length+1,O=[];for(let I=0;I<j;I++)O[I]=P.i(I)<<1|P.i(I-1)>>>31;return new c(O,P.h)}function z(P,j){const O=j>>5;j%=32;const I=P.g.length-O,R=[];for(let F=0;F<I;F++)R[F]=j>0?P.i(F+O)>>>j|P.i(F+O+1)<<32-j:P.i(F+O);return new c(R,P.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,W4=r,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=m,c.fromString=p,Il=c}).apply(typeof HT<"u"?HT:typeof self<"u"?self:typeof window<"u"?window:{});var Op=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var K4,xm,Q4,ox,L_,Y4,X4,J4;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Op=="object"&&Op];for(var N=0;N<g.length;++N){var D=g[N];if(D&&D.Math==Math)return D}throw Error("Cannot find global object")}var r=t(this);function i(g,N){if(N)e:{var D=r;g=g.split(".");for(var W=0;W<g.length-1;W++){var _e=g[W];if(!(_e in D))break e;D=D[_e]}g=g[g.length-1],W=D[g],N=N(W),N!=W&&N!=null&&e(D,g,{configurable:!0,writable:!0,value:N})}}i("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(g){return g||function(N){var D=[],W;for(W in N)Object.prototype.hasOwnProperty.call(N,W)&&D.push([W,N[W]]);return D}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function u(g){var N=typeof g;return N=="object"&&g!=null||N=="function"}function h(g,N,D){return g.call.apply(g.bind,arguments)}function m(g,N,D){return m=h,m.apply(null,arguments)}function p(g,N){var D=Array.prototype.slice.call(arguments,1);return function(){var W=D.slice();return W.push.apply(W,arguments),g.apply(this,W)}}function b(g,N){function D(){}D.prototype=N.prototype,g.Z=N.prototype,g.prototype=new D,g.prototype.constructor=g,g.Ob=function(W,_e,Ie){for(var Ke=Array(arguments.length-2),Ct=2;Ct<arguments.length;Ct++)Ke[Ct-2]=arguments[Ct];return N.prototype[_e].apply(W,Ke)}}var v=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function _(g){const N=g.length;if(N>0){const D=Array(N);for(let W=0;W<N;W++)D[W]=g[W];return D}return[]}function T(g,N){for(let W=1;W<arguments.length;W++){const _e=arguments[W];var D=typeof _e;if(D=D!="object"?D:_e?Array.isArray(_e)?"array":D:"null",D=="array"||D=="object"&&typeof _e.length=="number"){D=g.length||0;const Ie=_e.length||0;g.length=D+Ie;for(let Ke=0;Ke<Ie;Ke++)g[D+Ke]=_e[Ke]}else g.push(_e)}}class k{constructor(N,D){this.i=N,this.j=D,this.h=0,this.g=null}get(){let N;return this.h>0?(this.h--,N=this.g,this.g=N.next,N.next=null):N=this.i(),N}}function E(g){c.setTimeout(()=>{throw g},0)}function S(){var g=P;let N=null;return g.g&&(N=g.g,g.g=g.g.next,g.g||(g.h=null),N.next=null),N}class L{constructor(){this.h=this.g=null}add(N,D){const W=$.get();W.set(N,D),this.h?this.h.next=W:this.g=W,this.h=W}}var $=new k(()=>new H,g=>g.reset());class H{constructor(){this.next=this.g=this.h=null}set(N,D){this.h=N,this.g=D,this.next=null}reset(){this.next=this.g=this.h=null}}let G,z=!1,P=new L,j=()=>{const g=Promise.resolve(void 0);G=()=>{g.then(O)}};function O(){for(var g;g=S();){try{g.h.call(g.g)}catch(D){E(D)}var N=$;N.j(g),N.h<100&&(N.h++,g.next=N.g,N.g=g)}z=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function R(g,N){this.type=g,this.g=this.target=N,this.defaultPrevented=!1}R.prototype.h=function(){this.defaultPrevented=!0};var F=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var g=!1,N=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const D=()=>{};c.addEventListener("test",D,N),c.removeEventListener("test",D,N)}catch{}return g})();function M(g){return/^[\s\xa0]*$/.test(g)}function ne(g,N){R.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,N)}b(ne,R),ne.prototype.init=function(g,N){const D=this.type=g.type,W=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=N,N=g.relatedTarget,N||(D=="mouseover"?N=g.fromElement:D=="mouseout"&&(N=g.toElement)),this.relatedTarget=N,W?(this.clientX=W.clientX!==void 0?W.clientX:W.pageX,this.clientY=W.clientY!==void 0?W.clientY:W.pageY,this.screenX=W.screenX||0,this.screenY=W.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&ne.Z.h.call(this)},ne.prototype.h=function(){ne.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var U="closure_listenable_"+(Math.random()*1e6|0),A=0;function V(g,N,D,W,_e){this.listener=g,this.proxy=null,this.src=N,this.type=D,this.capture=!!W,this.ha=_e,this.key=++A,this.da=this.fa=!1}function Q(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function ae(g,N,D){for(const W in g)N.call(D,g[W],W,g)}function X(g,N){for(const D in g)N.call(void 0,g[D],D,g)}function B(g){const N={};for(const D in g)N[D]=g[D];return N}const Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ge(g,N){let D,W;for(let _e=1;_e<arguments.length;_e++){W=arguments[_e];for(D in W)g[D]=W[D];for(let Ie=0;Ie<Y.length;Ie++)D=Y[Ie],Object.prototype.hasOwnProperty.call(W,D)&&(g[D]=W[D])}}function Z(g){this.src=g,this.g={},this.h=0}Z.prototype.add=function(g,N,D,W,_e){const Ie=g.toString();g=this.g[Ie],g||(g=this.g[Ie]=[],this.h++);const Ke=me(g,N,W,_e);return Ke>-1?(N=g[Ke],D||(N.fa=!1)):(N=new V(N,this.src,Ie,!!W,_e),N.fa=D,g.push(N)),N};function te(g,N){const D=N.type;if(D in g.g){var W=g.g[D],_e=Array.prototype.indexOf.call(W,N,void 0),Ie;(Ie=_e>=0)&&Array.prototype.splice.call(W,_e,1),Ie&&(Q(N),g.g[D].length==0&&(delete g.g[D],g.h--))}}function me(g,N,D,W){for(let _e=0;_e<g.length;++_e){const Ie=g[_e];if(!Ie.da&&Ie.listener==N&&Ie.capture==!!D&&Ie.ha==W)return _e}return-1}var re="closure_lm_"+(Math.random()*1e6|0),ce={};function he(g,N,D,W,_e){if(Array.isArray(N)){for(let Ie=0;Ie<N.length;Ie++)he(g,N[Ie],D,W,_e);return null}return D=ee(D),g&&g[U]?g.J(N,D,u(W)?!!W.capture:!1,_e):Oe(g,N,D,!1,W,_e)}function Oe(g,N,D,W,_e,Ie){if(!N)throw Error("Invalid event type");const Ke=u(_e)?!!_e.capture:!!_e;let Ct=J(g);if(Ct||(g[re]=Ct=new Z(g)),D=Ct.add(N,D,W,Ke,Ie),D.proxy)return D;if(W=Ue(),D.proxy=W,W.src=g,W.listener=D,g.addEventListener)F||(_e=Ke),_e===void 0&&(_e=!1),g.addEventListener(N.toString(),W,_e);else if(g.attachEvent)g.attachEvent(K(N.toString()),W);else if(g.addListener&&g.removeListener)g.addListener(W);else throw Error("addEventListener and attachEvent are unavailable.");return D}function Ue(){function g(D){return N.call(g.src,g.listener,D)}const N=ie;return g}function st(g,N,D,W,_e){if(Array.isArray(N))for(var Ie=0;Ie<N.length;Ie++)st(g,N[Ie],D,W,_e);else W=u(W)?!!W.capture:!!W,D=ee(D),g&&g[U]?(g=g.i,Ie=String(N).toString(),Ie in g.g&&(N=g.g[Ie],D=me(N,D,W,_e),D>-1&&(Q(N[D]),Array.prototype.splice.call(N,D,1),N.length==0&&(delete g.g[Ie],g.h--)))):g&&(g=J(g))&&(N=g.g[N.toString()],g=-1,N&&(g=me(N,D,W,_e)),(D=g>-1?N[g]:null)&&fe(D))}function fe(g){if(typeof g!="number"&&g&&!g.da){var N=g.src;if(N&&N[U])te(N.i,g);else{var D=g.type,W=g.proxy;N.removeEventListener?N.removeEventListener(D,W,g.capture):N.detachEvent?N.detachEvent(K(D),W):N.addListener&&N.removeListener&&N.removeListener(W),(D=J(N))?(te(D,g),D.h==0&&(D.src=null,N[re]=null)):Q(g)}}}function K(g){return g in ce?ce[g]:ce[g]="on"+g}function ie(g,N){if(g.da)g=!0;else{N=new ne(N,this);const D=g.listener,W=g.ha||g.src;g.fa&&fe(g),g=D.call(W,N)}return g}function J(g){return g=g[re],g instanceof Z?g:null}var le="__closure_events_fn_"+(Math.random()*1e9>>>0);function ee(g){return typeof g=="function"?g:(g[le]||(g[le]=function(N){return g.handleEvent(N)}),g[le])}function we(){I.call(this),this.i=new Z(this),this.M=this,this.G=null}b(we,I),we.prototype[U]=!0,we.prototype.removeEventListener=function(g,N,D,W){st(this,g,N,D,W)};function pe(g,N){var D,W=g.G;if(W)for(D=[];W;W=W.G)D.push(W);if(g=g.M,W=N.type||N,typeof N=="string")N=new R(N,g);else if(N instanceof R)N.target=N.target||g;else{var _e=N;N=new R(W,g),ge(N,_e)}_e=!0;let Ie,Ke;if(D)for(Ke=D.length-1;Ke>=0;Ke--)Ie=N.g=D[Ke],_e=ye(Ie,W,!0,N)&&_e;if(Ie=N.g=g,_e=ye(Ie,W,!0,N)&&_e,_e=ye(Ie,W,!1,N)&&_e,D)for(Ke=0;Ke<D.length;Ke++)Ie=N.g=D[Ke],_e=ye(Ie,W,!1,N)&&_e}we.prototype.N=function(){if(we.Z.N.call(this),this.i){var g=this.i;for(const N in g.g){const D=g.g[N];for(let W=0;W<D.length;W++)Q(D[W]);delete g.g[N],g.h--}}this.G=null},we.prototype.J=function(g,N,D,W){return this.i.add(String(g),N,!1,D,W)},we.prototype.K=function(g,N,D,W){return this.i.add(String(g),N,!0,D,W)};function ye(g,N,D,W){if(N=g.i.g[String(N)],!N)return!0;N=N.concat();let _e=!0;for(let Ie=0;Ie<N.length;++Ie){const Ke=N[Ie];if(Ke&&!Ke.da&&Ke.capture==D){const Ct=Ke.listener,Wn=Ke.ha||Ke.src;Ke.fa&&te(g.i,Ke),_e=Ct.call(Wn,W)!==!1&&_e}}return _e&&!W.defaultPrevented}function Ae(g,N){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=m(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(N)>2147483647?-1:c.setTimeout(g,N||0)}function xe(g){g.g=Ae(()=>{g.g=null,g.i&&(g.i=!1,xe(g))},g.l);const N=g.h;g.h=null,g.m.apply(null,N)}class Pe extends I{constructor(N,D){super(),this.m=N,this.l=D,this.h=null,this.i=!1,this.g=null}j(N){this.h=arguments,this.g?this.i=!0:xe(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function gt(g){I.call(this),this.h=g,this.g={}}b(gt,I);var Ee=[];function Be(g){ae(g.g,function(N,D){this.g.hasOwnProperty(D)&&fe(N)},g),g.g={}}gt.prototype.N=function(){gt.Z.N.call(this),Be(this)},gt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ht=c.JSON.stringify,Me=c.JSON.parse,Ze=class{stringify(g){return c.JSON.stringify(g,void 0)}parse(g){return c.JSON.parse(g,void 0)}};function at(){}function yt(){}var St={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ve(){R.call(this,"d")}b(ve,R);function Ge(){R.call(this,"c")}b(Ge,R);var We={},dt=null;function Ve(){return dt=dt||new we}We.Ia="serverreachability";function $e(g){R.call(this,We.Ia,g)}b($e,R);function tt(g){const N=Ve();pe(N,new $e(N))}We.STAT_EVENT="statevent";function rt(g,N){R.call(this,We.STAT_EVENT,g),this.stat=N}b(rt,R);function ft(g){const N=Ve();pe(N,new rt(N,g))}We.Ja="timingevent";function $t(g,N){R.call(this,We.Ja,g),this.size=N}b($t,R);function Dn(g,N){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){g()},N)}function Zn(){this.g=!0}Zn.prototype.ua=function(){this.g=!1};function Ii(g,N,D,W,_e,Ie){g.info(function(){if(g.g)if(Ie){var Ke="",Ct=Ie.split("&");for(let Xt=0;Xt<Ct.length;Xt++){var Wn=Ct[Xt].split("=");if(Wn.length>1){const En=Wn[0];Wn=Wn[1];const ai=En.split("_");Ke=ai.length>=2&&ai[1]=="type"?Ke+(En+"="+Wn+"&"):Ke+(En+"=redacted&")}}}else Ke=null;else Ke=Ie;return"XMLHTTP REQ ("+W+") [attempt "+_e+"]: "+N+`
`+D+`
`+Ke})}function oc(g,N,D,W,_e,Ie,Ke){g.info(function(){return"XMLHTTP RESP ("+W+") [ attempt "+_e+"]: "+N+`
`+D+`
`+Ie+" "+Ke})}function Pr(g,N,D,W){g.info(function(){return"XMLHTTP TEXT ("+N+"): "+He(g,D)+(W?" "+W:"")})}function ea(g,N){g.info(function(){return"TIMEOUT: "+N})}Zn.prototype.info=function(){};function He(g,N){if(!g.g)return N;if(!N)return null;try{const Ie=JSON.parse(N);if(Ie){for(g=0;g<Ie.length;g++)if(Array.isArray(Ie[g])){var D=Ie[g];if(!(D.length<2)){var W=D[1];if(Array.isArray(W)&&!(W.length<1)){var _e=W[0];if(_e!="noop"&&_e!="stop"&&_e!="close")for(let Ke=1;Ke<W.length;Ke++)W[Ke]=""}}}}return ht(Ie)}catch{return N}}var wt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},es={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ni;function lc(){}b(lc,at),lc.prototype.g=function(){return new XMLHttpRequest},ni=new lc;function qa(g){return encodeURIComponent(String(g))}function f0(g){var N=1;g=g.split(":");const D=[];for(;N>0&&g.length;)D.push(g.shift()),N--;return g.length&&D.push(g.join(":")),D}function Ci(g,N,D,W){this.j=g,this.i=N,this.l=D,this.S=W||1,this.V=new gt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ai}function Ai(){this.i=null,this.g="",this.h=!1}var ts={},ys={};function ta(g,N,D){g.M=1,g.A=cc(ss(N)),g.u=D,g.R=!0,Ld(g,null)}function Ld(g,N){g.F=Date.now(),na(g),g.B=ss(g.A);var D=g.B,W=g.S;Array.isArray(W)||(W=[String(W)]),Bd(D.i,"t",W),g.C=0,D=g.j.L,g.h=new Ai,g.g=I0(g.j,D?N:null,!g.u),g.P>0&&(g.O=new Pe(m(g.Y,g,g.g),g.P)),N=g.V,D=g.g,W=g.ba;var _e="readystatechange";Array.isArray(_e)||(_e&&(Ee[0]=_e.toString()),_e=Ee);for(let Ie=0;Ie<_e.length;Ie++){const Ke=he(D,_e[Ie],W||N.handleEvent,!1,N.h||N);if(!Ke)break;N.g[Ke.key]=Ke}N=g.J?B(g.J):{},g.u?(g.v||(g.v="POST"),N["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,N)):(g.v="GET",g.g.ea(g.B,g.v,null,N)),tt(),Ii(g.i,g.v,g.B,g.l,g.S,g.u)}Ci.prototype.ba=function(g){g=g.target;const N=this.O;N&&Di(g)==3?N.j():this.Y(g)},Ci.prototype.Y=function(g){try{if(g==this.g)e:{const Ct=Di(this.g),Wn=this.g.ya(),Xt=this.g.ca();if(!(Ct<3)&&(Ct!=3||this.g&&(this.h.h||this.g.la()||Rs(this.g)))){this.K||Ct!=4||Wn==7||(Wn==8||Xt<=0?tt(3):tt(2)),sa(this);var N=this.g.ca();this.X=N;var D=Dy(this);if(this.o=N==200,oc(this.i,this.v,this.B,this.l,this.S,Ct,N),this.o){if(this.U&&!this.L){t:{if(this.g){var W,_e=this.g;if((W=_e.g?_e.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(W)){var Ie=W;break t}}Ie=null}if(g=Ie)Pr(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ra(this,g);else{this.o=!1,this.m=3,ft(12),Or(this),si(this);break e}}if(this.R){g=!0;let En;for(;!this.K&&this.C<D.length;)if(En=g0(this,D),En==ys){Ct==4&&(this.m=4,ft(14),g=!1),Pr(this.i,this.l,null,"[Incomplete Response]");break}else if(En==ts){this.m=4,ft(15),Pr(this.i,this.l,D,"[Invalid Chunk]"),g=!1;break}else Pr(this.i,this.l,En,null),ra(this,En);if(m0(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ct!=4||D.length!=0||this.h.h||(this.m=1,ft(16),g=!1),this.o=this.o&&g,!g)Pr(this.i,this.l,D,"[Invalid Chunked Response]"),Or(this),si(this);else if(D.length>0&&!this.W){this.W=!0;var Ke=this.j;Ke.g==this&&Ke.aa&&!Ke.P&&(Ke.j.info("Great, no buffering proxy detected. Bytes received: "+D.length),mf(Ke),Ke.P=!0,ft(11))}}else Pr(this.i,this.l,D,null),ra(this,D);Ct==4&&Or(this),this.o&&!this.K&&(Ct==4?j0(this.j,this):(this.o=!1,na(this)))}else Ga(this.g),N==400&&D.indexOf("Unknown SID")>0?(this.m=3,ft(12)):(this.m=0,ft(13)),Or(this),si(this)}}}catch{}finally{}};function Dy(g){if(!m0(g))return g.g.la();const N=Rs(g.g);if(N==="")return"";let D="";const W=N.length,_e=Di(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return Or(g),si(g),"";g.h.i=new c.TextDecoder}for(let Ie=0;Ie<W;Ie++)g.h.h=!0,D+=g.h.i.decode(N[Ie],{stream:!(_e&&Ie==W-1)});return N.length=0,g.h.g+=D,g.C=0,g.h.g}function m0(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function g0(g,N){var D=g.C,W=N.indexOf(`
`,D);return W==-1?ys:(D=Number(N.substring(D,W)),isNaN(D)?ts:(W+=1,W+D>N.length?ys:(N=N.slice(W,W+D),g.C=W+D,N)))}Ci.prototype.cancel=function(){this.K=!0,Or(this)};function na(g){g.T=Date.now()+g.H,Vd(g,g.H)}function Vd(g,N){if(g.D!=null)throw Error("WatchDog timer not null");g.D=Dn(m(g.aa,g),N)}function sa(g){g.D&&(c.clearTimeout(g.D),g.D=null)}Ci.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(ea(this.i,this.B),this.M!=2&&(tt(),ft(17)),Or(this),this.m=2,si(this)):Vd(this,this.T-g)};function si(g){g.j.I==0||g.K||j0(g.j,g)}function Or(g){sa(g);var N=g.O;N&&typeof N.dispose=="function"&&N.dispose(),g.O=null,Be(g.V),g.g&&(N=g.g,g.g=null,N.abort(),N.dispose())}function ra(g,N){try{var D=g.j;if(D.I!=0&&(D.g==g||aa(D.h,g))){if(!g.L&&aa(D.h,g)&&D.I==3){try{var W=D.Ba.g.parse(N)}catch{W=null}if(Array.isArray(W)&&W.length==3){var _e=W;if(_e[0]==0){e:if(!D.v){if(D.g)if(D.g.F+3e3<g.F)Gd(D),qo(D);else break e;pc(D),ft(18)}}else D.xa=_e[1],0<D.xa-D.K&&_e[2]<37500&&D.F&&D.A==0&&!D.C&&(D.C=Dn(m(D.Va,D),6e3));ia(D.h)<=1&&D.ta&&(D.ta=void 0)}else ha(D,11)}else if((g.L||D.g==g)&&Gd(D),!M(N))for(_e=D.Ba.g.parse(N),N=0;N<_e.length;N++){let Xt=_e[N];const En=Xt[0];if(!(En<=D.K))if(D.K=En,Xt=Xt[1],D.I==2)if(Xt[0]=="c"){D.M=Xt[1],D.ba=Xt[2];const ai=Xt[3];ai!=null&&(D.ka=ai,D.j.info("VER="+D.ka));const fa=Xt[4];fa!=null&&(D.za=fa,D.j.info("SVER="+D.za));const Pi=Xt[5];Pi!=null&&typeof Pi=="number"&&Pi>0&&(W=1.5*Pi,D.O=W,D.j.info("backChannelRequestTimeoutMs_="+W)),W=D;const Oi=g.g;if(Oi){const xc=Oi.g?Oi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xc){var Ie=W.h;Ie.g||xc.indexOf("spdy")==-1&&xc.indexOf("quic")==-1&&xc.indexOf("h2")==-1||(Ie.j=Ie.l,Ie.g=new Set,Ie.h&&(tf(Ie,Ie.h),Ie.h=null))}if(W.G){const Wd=Oi.g?Oi.g.getResponseHeader("X-HTTP-Session-Id"):null;Wd&&(W.wa=Wd,rn(W.J,W.G,Wd))}}D.I=3,D.l&&D.l.ra(),D.aa&&(D.T=Date.now()-g.F,D.j.info("Handshake RTT: "+D.T+"ms")),W=D;var Ke=g;if(W.na=T0(W,W.L?W.ba:null,W.W),Ke.L){nf(W.h,Ke);var Ct=Ke,Wn=W.O;Wn&&(Ct.H=Wn),Ct.D&&(sa(Ct),na(Ct)),W.g=Ke}else _0(W);D.i.length>0&&ua(D)}else Xt[0]!="stop"&&Xt[0]!="close"||ha(D,7);else D.I==3&&(Xt[0]=="stop"||Xt[0]=="close"?Xt[0]=="stop"?ha(D,7):hf(D):Xt[0]!="noop"&&D.l&&D.l.qa(Xt),D.A=0)}}tt(4)}catch{}}var ns=class{constructor(g,N){this.g=g,this.map=N}};function Zh(g){this.l=g||10,c.PerformanceNavigationTiming?(g=c.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ef(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function ia(g){return g.h?1:g.g?g.g.size:0}function aa(g,N){return g.h?g.h==N:g.g?g.g.has(N):!1}function tf(g,N){g.g?g.g.add(N):g.h=N}function nf(g,N){g.h&&g.h==N?g.h=null:g.g&&g.g.has(N)&&g.g.delete(N)}Zh.prototype.cancel=function(){if(this.i=sf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function sf(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let N=g.i;for(const D of g.g.values())N=N.concat(D.G);return N}return _(g.i)}var p0=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Fd(g,N){if(g){g=g.split("&");for(let D=0;D<g.length;D++){const W=g[D].indexOf("=");let _e,Ie=null;W>=0?(_e=g[D].substring(0,W),Ie=g[D].substring(W+1)):_e=g[D],N(_e,Ie?decodeURIComponent(Ie.replace(/\+/g," ")):"")}}}function Mr(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let N;g instanceof Mr?(this.l=g.l,vs(this,g.j),this.o=g.o,this.g=g.g,Lo(this,g.u),this.h=g.h,rf(this,v0(g.i)),this.m=g.m):g&&(N=String(g).match(p0))?(this.l=!1,vs(this,N[1]||"",!0),this.o=oa(N[2]||""),this.g=oa(N[3]||"",!0),Lo(this,N[4]),this.h=oa(N[5]||"",!0),rf(this,N[6]||"",!0),this.m=oa(N[7]||"")):(this.l=!1,this.i=new Fo(null,this.l))}Mr.prototype.toString=function(){const g=[];var N=this.j;N&&g.push(dc(N,Ud,!0),":");var D=this.g;return(D||N=="file")&&(g.push("//"),(N=this.o)&&g.push(dc(N,Ud,!0),"@"),g.push(qa(D).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),D=this.u,D!=null&&g.push(":",String(D))),(D=this.h)&&(this.g&&D.charAt(0)!="/"&&g.push("/"),g.push(dc(D,D.charAt(0)=="/"?af:x0,!0))),(D=this.i.toString())&&g.push("?",D),(D=this.m)&&g.push("#",dc(D,b0)),g.join("")},Mr.prototype.resolve=function(g){const N=ss(this);let D=!!g.j;D?vs(N,g.j):D=!!g.o,D?N.o=g.o:D=!!g.g,D?N.g=g.g:D=g.u!=null;var W=g.h;if(D)Lo(N,g.u);else if(D=!!g.h){if(W.charAt(0)!="/")if(this.g&&!this.h)W="/"+W;else{var _e=N.h.lastIndexOf("/");_e!=-1&&(W=N.h.slice(0,_e+1)+W)}if(_e=W,_e==".."||_e==".")W="";else if(_e.indexOf("./")!=-1||_e.indexOf("/.")!=-1){W=_e.lastIndexOf("/",0)==0,_e=_e.split("/");const Ie=[];for(let Ke=0;Ke<_e.length;){const Ct=_e[Ke++];Ct=="."?W&&Ke==_e.length&&Ie.push(""):Ct==".."?((Ie.length>1||Ie.length==1&&Ie[0]!="")&&Ie.pop(),W&&Ke==_e.length&&Ie.push("")):(Ie.push(Ct),W=!0)}W=Ie.join("/")}else W=_e}return D?N.h=W:D=g.i.toString()!=="",D?rf(N,v0(g.i)):D=!!g.m,D&&(N.m=g.m),N};function ss(g){return new Mr(g)}function vs(g,N,D){g.j=D?oa(N,!0):N,g.j&&(g.j=g.j.replace(/:$/,""))}function Lo(g,N){if(N){if(N=Number(N),isNaN(N)||N<0)throw Error("Bad port number "+N);g.u=N}else g.u=null}function rf(g,N,D){N instanceof Fo?(g.i=N,zd(g.i,g.l)):(D||(N=dc(N,Vo)),g.i=new Fo(N,g.l))}function rn(g,N,D){g.i.set(N,D)}function cc(g){return rn(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function oa(g,N){return g?N?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function dc(g,N,D){return typeof g=="string"?(g=encodeURI(g).replace(N,gr),D&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function gr(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var Ud=/[#\/\?@]/g,x0=/[#\?:]/g,af=/[#\?]/g,Vo=/[#\?@]/g,b0=/#/g;function Fo(g,N){this.h=this.g=null,this.i=g||null,this.j=!!N}function pr(g){g.g||(g.g=new Map,g.h=0,g.i&&Fd(g.i,function(N,D){g.add(decodeURIComponent(N.replace(/\+/g," ")),D)}))}n=Fo.prototype,n.add=function(g,N){pr(this),this.i=null,g=Uo(this,g);let D=this.g.get(g);return D||this.g.set(g,D=[]),D.push(N),this.h+=1,this};function y0(g,N){pr(g),N=Uo(g,N),g.g.has(N)&&(g.i=null,g.h-=g.g.get(N).length,g.g.delete(N))}function of(g,N){return pr(g),N=Uo(g,N),g.g.has(N)}n.forEach=function(g,N){pr(this),this.g.forEach(function(D,W){D.forEach(function(_e){g.call(N,_e,W,this)},this)},this)};function lf(g,N){pr(g);let D=[];if(typeof N=="string")of(g,N)&&(D=D.concat(g.g.get(Uo(g,N))));else for(g=Array.from(g.g.values()),N=0;N<g.length;N++)D=D.concat(g[N]);return D}n.set=function(g,N){return pr(this),this.i=null,g=Uo(this,g),of(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[N]),this.h+=1,this},n.get=function(g,N){return g?(g=lf(this,g),g.length>0?String(g[0]):N):N};function Bd(g,N,D){y0(g,N),D.length>0&&(g.i=null,g.g.set(Uo(g,N),_(D)),g.h+=D.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],N=Array.from(this.g.keys());for(let W=0;W<N.length;W++){var D=N[W];const _e=qa(D);D=lf(this,D);for(let Ie=0;Ie<D.length;Ie++){let Ke=_e;D[Ie]!==""&&(Ke+="="+qa(D[Ie])),g.push(Ke)}}return this.i=g.join("&")};function v0(g){const N=new Fo;return N.i=g.i,g.g&&(N.g=new Map(g.g),N.h=g.h),N}function Uo(g,N){return N=String(N),g.j&&(N=N.toLowerCase()),N}function zd(g,N){N&&!g.j&&(pr(g),g.i=null,g.g.forEach(function(D,W){const _e=W.toLowerCase();W!=_e&&(y0(this,W),Bd(this,_e,D))},g)),g.j=N}function ki(g,N){const D=new Zn;if(c.Image){const W=new Image;W.onload=p(ri,D,"TestLoadImage: loaded",!0,N,W),W.onerror=p(ri,D,"TestLoadImage: error",!1,N,W),W.onabort=p(ri,D,"TestLoadImage: abort",!1,N,W),W.ontimeout=p(ri,D,"TestLoadImage: timeout",!1,N,W),c.setTimeout(function(){W.ontimeout&&W.ontimeout()},1e4),W.src=g}else N(!1)}function cf(g,N){const D=new Zn,W=new AbortController,_e=setTimeout(()=>{W.abort(),ri(D,"TestPingServer: timeout",!1,N)},1e4);fetch(g,{signal:W.signal}).then(Ie=>{clearTimeout(_e),Ie.ok?ri(D,"TestPingServer: ok",!0,N):ri(D,"TestPingServer: server error",!1,N)}).catch(()=>{clearTimeout(_e),ri(D,"TestPingServer: error",!1,N)})}function ri(g,N,D,W,_e){try{_e&&(_e.onload=null,_e.onerror=null,_e.onabort=null,_e.ontimeout=null),W(D)}catch{}}function Bo(){this.g=new Ze}function la(g){this.i=g.Sb||null,this.h=g.ab||!1}b(la,at),la.prototype.g=function(){return new uc(this.i,this.h)};function uc(g,N){we.call(this),this.H=g,this.o=N,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}b(uc,we),n=uc.prototype,n.open=function(g,N){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=N,this.readyState=1,Ri(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const N={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(N.body=g),(this.H||c).fetch(new Request(this.D,N)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,zo(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,Ri(this)),this.g&&(this.readyState=3,Ri(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;$d(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function $d(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var N=g.value?g.value:new Uint8Array(0);(N=this.B.decode(N,{stream:!g.done}))&&(this.response=this.responseText+=N)}g.done?zo(this):Ri(this),this.readyState==3&&$d(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,zo(this))},n.Na=function(g){this.g&&(this.response=g,zo(this))},n.ga=function(){this.g&&zo(this)};function zo(g){g.readyState=4,g.l=null,g.j=null,g.B=null,Ri(g)}n.setRequestHeader=function(g,N){this.A.append(g,N)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],N=this.h.entries();for(var D=N.next();!D.done;)D=D.value,g.push(D[0]+": "+D[1]),D=N.next();return g.join(`\r
`)};function Ri(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(uc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function ii(g){let N="";return ae(g,function(D,W){N+=W,N+=":",N+=D,N+=`\r
`}),N}function hc(g,N,D){e:{for(W in D){var W=!1;break e}W=!0}W||(D=ii(D),typeof g=="string"?D!=null&&qa(D):rn(g,N,D))}function un(g){we.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}b(un,we);var ca=/^https?$/i,df=["POST","PUT"];n=un.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,N,D,W){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);N=N?N.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ni.g(),this.g.onreadystatechange=v(m(this.Ca,this));try{this.B=!0,this.g.open(N,String(g),!0),this.B=!1}catch(Ie){fc(this,Ie);return}if(g=D||"",D=new Map(this.headers),W)if(Object.getPrototypeOf(W)===Object.prototype)for(var _e in W)D.set(_e,W[_e]);else if(typeof W.keys=="function"&&typeof W.get=="function")for(const Ie of W.keys())D.set(Ie,W.get(Ie));else throw Error("Unknown input type for opt_headers: "+String(W));W=Array.from(D.keys()).find(Ie=>Ie.toLowerCase()=="content-type"),_e=c.FormData&&g instanceof c.FormData,!(Array.prototype.indexOf.call(df,N,void 0)>=0)||W||_e||D.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ie,Ke]of D)this.g.setRequestHeader(Ie,Ke);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(Ie){fc(this,Ie)}};function fc(g,N){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=N,g.o=5,uf(g),Ha(g)}function uf(g){g.A||(g.A=!0,pe(g,"complete"),pe(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,pe(this,"complete"),pe(this,"abort"),Ha(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ha(this,!0)),un.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?mc(this):this.Xa())},n.Xa=function(){mc(this)};function mc(g){if(g.h&&typeof o<"u"){if(g.v&&Di(g)==4)setTimeout(g.Ca.bind(g),0);else if(pe(g,"readystatechange"),Di(g)==4){g.h=!1;try{const Ie=g.ca();e:switch(Ie){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var N=!0;break e;default:N=!1}var D;if(!(D=N)){var W;if(W=Ie===0){let Ke=String(g.D).match(p0)[1]||null;!Ke&&c.self&&c.self.location&&(Ke=c.self.location.protocol.slice(0,-1)),W=!ca.test(Ke?Ke.toLowerCase():"")}D=W}if(D)pe(g,"complete"),pe(g,"success");else{g.o=6;try{var _e=Di(g)>2?g.g.statusText:""}catch{_e=""}g.l=_e+" ["+g.ca()+"]",uf(g)}}finally{Ha(g)}}}}function Ha(g,N){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const D=g.g;g.g=null,N||pe(g,"ready");try{D.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Di(g){return g.g?g.g.readyState:0}n.ca=function(){try{return Di(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var N=this.g.responseText;return g&&N.indexOf(g)==0&&(N=N.substring(g.length)),Me(N)}};function Rs(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function Ga(g){const N={};g=(g.g&&Di(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let W=0;W<g.length;W++){if(M(g[W]))continue;var D=f0(g[W]);const _e=D[0];if(D=D[1],typeof D!="string")continue;D=D.trim();const Ie=N[_e]||[];N[_e]=Ie,Ie.push(D)}X(N,function(W){return W.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function da(g,N,D){return D&&D.internalChannelParams&&D.internalChannelParams[g]||N}function $o(g){this.za=0,this.i=[],this.j=new Zn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=da("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=da("baseRetryDelayMs",5e3,g),this.Za=da("retryDelaySeedMs",1e4,g),this.Ta=da("forwardChannelMaxRetries",2,g),this.va=da("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new Zh(g&&g.concurrentRequestLimit),this.Ba=new Bo,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=$o.prototype,n.ka=8,n.I=1,n.connect=function(g,N,D,W){ft(0),this.W=g,this.H=N||{},D&&W!==void 0&&(this.H.OSID=D,this.H.OAID=W),this.F=this.X,this.J=T0(this,null,this.W),ua(this)};function hf(g){if(qd(g),g.I==3){var N=g.V++,D=ss(g.J);if(rn(D,"SID",g.M),rn(D,"RID",N),rn(D,"TYPE","terminate"),gc(g,D),N=new Ci(g,g.j,N),N.M=2,N.A=cc(ss(D)),D=!1,c.navigator&&c.navigator.sendBeacon)try{D=c.navigator.sendBeacon(N.A.toString(),"")}catch{}!D&&c.Image&&(new Image().src=N.A,D=!0),D||(N.g=I0(N.j,null),N.g.ea(N.A)),N.F=Date.now(),na(N)}E0(g)}function qo(g){g.g&&(mf(g),g.g.cancel(),g.g=null)}function qd(g){qo(g),g.v&&(c.clearTimeout(g.v),g.v=null),Gd(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&c.clearTimeout(g.m),g.m=null)}function ua(g){if(!ef(g.h)&&!g.m){g.m=!0;var N=g.Ea;G||j(),z||(G(),z=!0),P.add(N,g),g.D=0}}function Hd(g,N){return ia(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=N.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=Dn(m(g.Ea,g,N),S0(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const _e=new Ci(this,this.j,g);let Ie=this.o;if(this.U&&(Ie?(Ie=B(Ie),ge(Ie,this.U)):Ie=this.U),this.u!==null||this.R||(_e.J=Ie,Ie=null),this.S)e:{for(var N=0,D=0;D<this.i.length;D++){t:{var W=this.i[D];if("__data__"in W.map&&(W=W.map.__data__,typeof W=="string")){W=W.length;break t}W=void 0}if(W===void 0)break;if(N+=W,N>4096){N=D;break e}if(N===4096||D===this.i.length-1){N=D+1;break e}}N=1e3}else N=1e3;N=w0(this,_e,N),D=ss(this.J),rn(D,"RID",g),rn(D,"CVER",22),this.G&&rn(D,"X-HTTP-Session-Id",this.G),gc(this,D),Ie&&(this.R?N="headers="+qa(ii(Ie))+"&"+N:this.u&&hc(D,this.u,Ie)),tf(this.h,_e),this.Ra&&rn(D,"TYPE","init"),this.S?(rn(D,"$req",N),rn(D,"SID","null"),_e.U=!0,ta(_e,D,null)):ta(_e,D,N),this.I=2}}else this.I==3&&(g?ff(this,g):this.i.length==0||ef(this.h)||ff(this))};function ff(g,N){var D;N?D=N.l:D=g.V++;const W=ss(g.J);rn(W,"SID",g.M),rn(W,"RID",D),rn(W,"AID",g.K),gc(g,W),g.u&&g.o&&hc(W,g.u,g.o),D=new Ci(g,g.j,D,g.D+1),g.u===null&&(D.J=g.o),N&&(g.i=N.G.concat(g.i)),N=w0(g,D,1e3),D.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),tf(g.h,D),ta(D,W,N)}function gc(g,N){g.H&&ae(g.H,function(D,W){rn(N,W,D)}),g.l&&ae({},function(D,W){rn(N,W,D)})}function w0(g,N,D){D=Math.min(g.i.length,D);const W=g.l?m(g.l.Ka,g.l,g):null;e:{var _e=g.i;let Ct=-1;for(;;){const Wn=["count="+D];Ct==-1?D>0?(Ct=_e[0].g,Wn.push("ofs="+Ct)):Ct=0:Wn.push("ofs="+Ct);let Xt=!0;for(let En=0;En<D;En++){var Ie=_e[En].g;const ai=_e[En].map;if(Ie-=Ct,Ie<0)Ct=Math.max(0,_e[En].g-100),Xt=!1;else try{Ie="req"+Ie+"_"||"";try{var Ke=ai instanceof Map?ai:Object.entries(ai);for(const[fa,Pi]of Ke){let Oi=Pi;u(Pi)&&(Oi=ht(Pi)),Wn.push(Ie+fa+"="+encodeURIComponent(Oi))}}catch(fa){throw Wn.push(Ie+"type="+encodeURIComponent("_badmap")),fa}}catch{W&&W(ai)}}if(Xt){Ke=Wn.join("&");break e}}Ke=void 0}return g=g.i.splice(0,D),N.G=g,Ke}function _0(g){if(!g.g&&!g.v){g.Y=1;var N=g.Da;G||j(),z||(G(),z=!0),P.add(N,g),g.A=0}}function pc(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=Dn(m(g.Da,g),S0(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,N0(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=Dn(m(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ft(10),qo(this),N0(this))};function mf(g){g.B!=null&&(c.clearTimeout(g.B),g.B=null)}function N0(g){g.g=new Ci(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var N=ss(g.na);rn(N,"RID","rpc"),rn(N,"SID",g.M),rn(N,"AID",g.K),rn(N,"CI",g.F?"0":"1"),!g.F&&g.ia&&rn(N,"TO",g.ia),rn(N,"TYPE","xmlhttp"),gc(g,N),g.u&&g.o&&hc(N,g.u,g.o),g.O&&(g.g.H=g.O);var D=g.g;g=g.ba,D.M=1,D.A=cc(ss(N)),D.u=null,D.R=!0,Ld(D,g)}n.Va=function(){this.C!=null&&(this.C=null,qo(this),pc(this),ft(19))};function Gd(g){g.C!=null&&(c.clearTimeout(g.C),g.C=null)}function j0(g,N){var D=null;if(g.g==N){Gd(g),mf(g),g.g=null;var W=2}else if(aa(g.h,N))D=N.G,nf(g.h,N),W=1;else return;if(g.I!=0){if(N.o)if(W==1){D=N.u?N.u.length:0,N=Date.now()-N.F;var _e=g.D;W=Ve(),pe(W,new $t(W,D)),ua(g)}else _0(g);else if(_e=N.m,_e==3||_e==0&&N.X>0||!(W==1&&Hd(g,N)||W==2&&pc(g)))switch(D&&D.length>0&&(N=g.h,N.i=N.i.concat(D)),_e){case 1:ha(g,5);break;case 4:ha(g,10);break;case 3:ha(g,6);break;default:ha(g,2)}}}function S0(g,N){let D=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(D*=2),D*N}function ha(g,N){if(g.j.info("Error code "+N),N==2){var D=m(g.bb,g),W=g.Ua;const _e=!W;W=new Mr(W||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||vs(W,"https"),cc(W),_e?ki(W.toString(),D):cf(W.toString(),D)}else ft(2);g.I=0,g.l&&g.l.pa(N),E0(g),qd(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),ft(2)):(this.j.info("Failed to ping google.com"),ft(1))};function E0(g){if(g.I=0,g.ja=[],g.l){const N=sf(g.h);(N.length!=0||g.i.length!=0)&&(T(g.ja,N),T(g.ja,g.i),g.h.i.length=0,_(g.i),g.i.length=0),g.l.oa()}}function T0(g,N,D){var W=D instanceof Mr?ss(D):new Mr(D);if(W.g!="")N&&(W.g=N+"."+W.g),Lo(W,W.u);else{var _e=c.location;W=_e.protocol,N=N?N+"."+_e.hostname:_e.hostname,_e=+_e.port;const Ie=new Mr(null);W&&vs(Ie,W),N&&(Ie.g=N),_e&&Lo(Ie,_e),D&&(Ie.h=D),W=Ie}return D=g.G,N=g.wa,D&&N&&rn(W,D,N),rn(W,"VER",g.ka),gc(g,W),W}function I0(g,N,D){if(N&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return N=g.Aa&&!g.ma?new un(new la({ab:D})):new un(g.ma),N.Fa(g.L),N}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function C0(){}n=C0.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ho(){}Ho.prototype.g=function(g,N){return new er(g,N)};function er(g,N){we.call(this),this.g=new $o(N),this.l=g,this.h=N&&N.messageUrlParams||null,g=N&&N.messageHeaders||null,N&&N.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=N&&N.initMessageHeaders||null,N&&N.messageContentType&&(g?g["X-WebChannel-Content-Type"]=N.messageContentType:g={"X-WebChannel-Content-Type":N.messageContentType}),N&&N.sa&&(g?g["X-WebChannel-Client-Profile"]=N.sa:g={"X-WebChannel-Client-Profile":N.sa}),this.g.U=g,(g=N&&N.Qb)&&!M(g)&&(this.g.u=g),this.A=N&&N.supportsCrossDomainXhr||!1,this.v=N&&N.sendRawJson||!1,(N=N&&N.httpSessionIdParam)&&!M(N)&&(this.g.G=N,g=this.h,g!==null&&N in g&&(g=this.h,N in g&&delete g[N])),this.j=new Wa(this)}b(er,we),er.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},er.prototype.close=function(){hf(this.g)},er.prototype.o=function(g){var N=this.g;if(typeof g=="string"){var D={};D.__data__=g,g=D}else this.v&&(D={},D.__data__=ht(g),g=D);N.i.push(new ns(N.Ya++,g)),N.I==3&&ua(N)},er.prototype.N=function(){this.g.l=null,delete this.j,hf(this.g),delete this.g,er.Z.N.call(this)};function A0(g){ve.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var N=g.__sm__;if(N){e:{for(const D in N){g=D;break e}g=void 0}(this.i=g)&&(g=this.i,N=N!==null&&g in N?N[g]:void 0),this.data=N}else this.data=g}b(A0,ve);function k0(){Ge.call(this),this.status=1}b(k0,Ge);function Wa(g){this.g=g}b(Wa,C0),Wa.prototype.ra=function(){pe(this.g,"a")},Wa.prototype.qa=function(g){pe(this.g,new A0(g))},Wa.prototype.pa=function(g){pe(this.g,new k0)},Wa.prototype.oa=function(){pe(this.g,"b")},Ho.prototype.createWebChannel=Ho.prototype.g,er.prototype.send=er.prototype.o,er.prototype.open=er.prototype.m,er.prototype.close=er.prototype.close,J4=function(){return new Ho},X4=function(){return Ve()},Y4=We,L_={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},wt.NO_ERROR=0,wt.TIMEOUT=8,wt.HTTP_ERROR=6,ox=wt,es.COMPLETE="complete",Q4=es,yt.EventType=St,St.OPEN="a",St.CLOSE="b",St.ERROR="c",St.MESSAGE="d",we.prototype.listen=we.prototype.J,xm=yt,un.prototype.listenOnce=un.prototype.K,un.prototype.getLastError=un.prototype.Ha,un.prototype.getLastErrorCode=un.prototype.ya,un.prototype.getStatus=un.prototype.ca,un.prototype.getResponseJson=un.prototype.La,un.prototype.getResponseText=un.prototype.la,un.prototype.send=un.prototype.ea,un.prototype.setWithCredentials=un.prototype.Fa,K4=un}).apply(typeof Op<"u"?Op:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Es=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Es.UNAUTHENTICATED=new Es(null),Es.GOOGLE_CREDENTIALS=new Es("google-credentials-uid"),Es.FIRST_PARTY=new Es("first-party-uid"),Es.MOCK_USER=new Es("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mh="12.8.0";function y9(n){Mh=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fl=new Ph("@firebase/firestore");function Pu(){return Fl.logLevel}function v9(n){Fl.setLogLevel(n)}function Fe(n,...e){if(Fl.logLevel<=Ot.DEBUG){const t=e.map(mN);Fl.debug(`Firestore (${Mh}): ${n}`,...t)}}function Yn(n,...e){if(Fl.logLevel<=Ot.ERROR){const t=e.map(mN);Fl.error(`Firestore (${Mh}): ${n}`,...t)}}function Ma(n,...e){if(Fl.logLevel<=Ot.WARN){const t=e.map(mN);Fl.warn(`Firestore (${Mh}): ${n}`,...t)}}function mN(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function et(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Z4(n,r,t)}function Z4(n,e,t){let r=`FIRESTORE (${Mh}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Yn(r),new Error(r)}function it(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||Z4(e,i,r)}function w9(n,e){n||et(57014,e)}function Ye(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Le extends Us{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class _9{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Es.UNAUTHENTICATED)))}shutdown(){}}class N9{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class j9{constructor(e){this.t=e,this.currentUser=Es.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){it(this.o===void 0,42304);let r=this.i;const i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve();let o=new Bs;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Bs,e.enqueueRetryable((()=>i(this.currentUser)))};const c=()=>{const h=o;e.enqueueRetryable((async()=>{await h.promise,await i(this.currentUser)}))},u=h=>{Fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((h=>u(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(Fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Bs)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(it(typeof r.accessToken=="string",31837,{l:r}),new ek(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return it(e===null||typeof e=="string",2055,{h:e}),new Es(e)}}class S9{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Es.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class E9{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new S9(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Es.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class GT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class T9{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,bn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){it(this.o===void 0,3512);const r=o=>{o.error!=null&&Fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const c=o.token!==this.m;return this.m=o.token,Fe("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>r(o)))};const i=o=>{Fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>i(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):Fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new GT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(it(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new GT(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I9(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gN{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=I9(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}}function jt(n,e){return n<e?-1:n>e?1:0}function V_(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),o=e.charAt(r);if(i!==o)return Vw(i)===Vw(o)?jt(i,o):Vw(i)?1:-1}return jt(n.length,e.length)}const C9=55296,A9=57343;function Vw(n){const e=n.charCodeAt(0);return e>=C9&&e<=A9}function rh(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function tk(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT="__name__";class wa{constructor(e,t,r){t===void 0?t=0:t>e.length&&et(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&et(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return wa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof wa?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const o=wa.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return jt(e.length,t.length)}static compareSegments(e,t){const r=wa.isNumericId(e),i=wa.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?wa.extractNumericId(e).compare(wa.extractNumericId(t)):V_(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Il.fromString(e.substring(4,e.length-2))}}class Ft extends wa{construct(e,t,r){return new Ft(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Le(Te.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Ft(t)}static emptyPath(){return new Ft([])}}const k9=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Cn extends wa{construct(e,t,r){return new Cn(e,t,r)}static isValidIdentifier(e){return k9.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Cn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===WT}static keyField(){return new Cn([WT])}static fromServerFormat(e){const t=[];let r="",i=0;const o=()=>{if(r.length===0)throw new Le(Te.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let c=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new Le(Te.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new Le(Te.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(c=!c,i++):u!=="."||c?(r+=u,i++):(o(),i++)}if(o(),c)throw new Le(Te.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Cn(t)}static emptyPath(){return new Cn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e){this.path=e}static fromPath(e){return new Qe(Ft.fromString(e))}static fromName(e){return new Qe(Ft.fromString(e).popFirst(5))}static empty(){return new Qe(Ft.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ft.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ft.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Qe(new Ft(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pN(n,e,t){if(!t)throw new Le(Te.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function nk(n,e,t,r){if(e===!0&&r===!0)throw new Le(Te.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function KT(n){if(!Qe.isDocumentKey(n))throw new Le(Te.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function QT(n){if(Qe.isDocumentKey(n))throw new Le(Te.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function sk(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function wb(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":et(12329,{type:typeof n})}function Yt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Le(Te.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=wb(n);throw new Le(Te.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function rk(n,e){if(e<=0)throw new Le(Te.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ds(n,e){const t={typeString:n};return e&&(t.value=e),t}function kg(n,e){if(!sk(n))throw new Le(Te.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const c=n[r];if(i&&typeof c!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(o!==void 0&&c!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new Le(Te.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YT=-62135596800,XT=1e6;class tn{static now(){return tn.fromMillis(Date.now())}static fromDate(e){return tn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*XT);return new tn(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Le(Te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Le(Te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<YT)throw new Le(Te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Le(Te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/XT}_compareTo(e){return this.seconds===e.seconds?jt(this.nanoseconds,e.nanoseconds):jt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:tn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(kg(e,tn._jsonSchema))return new tn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-YT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}tn._jsonSchemaVersion="firestore/timestamp/1.0",tn._jsonSchema={type:ds("string",tn._jsonSchemaVersion),seconds:ds("number"),nanoseconds:ds("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{static fromTimestamp(e){return new lt(e)}static min(){return new lt(new tn(0,0))}static max(){return new lt(new tn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ih=-1;class Ex{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function F_(n){return n.fields.find((e=>e.kind===2))}function Mc(n){return n.fields.filter((e=>e.kind!==2))}Ex.UNKNOWN_ID=-1;class lx{constructor(e,t){this.fieldPath=e,this.kind=t}}class Jm{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Jm(0,Xr.min())}}function ik(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=lt.fromTimestamp(r===1e9?new tn(t+1,0):new tn(t,r));return new Xr(i,Qe.empty(),e)}function ak(n){return new Xr(n.readTime,n.key,ih)}class Xr{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Xr(lt.min(),Qe.empty(),ih)}static max(){return new Xr(lt.max(),Qe.empty(),ih)}}function xN(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Qe.comparator(n.documentKey,e.documentKey),t!==0?t:jt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ok="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class lk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zl(n){if(n.code!==Te.FAILED_PRECONDITION||n.message!==ok)throw n;Fe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&et(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new be(((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof be?t:be.resolve(t)}catch(t){return be.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):be.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):be.reject(t)}static resolve(e){return new be(((t,r)=>{t(e)}))}static reject(e){return new be(((t,r)=>{r(e)}))}static waitFor(e){return new be(((t,r)=>{let i=0,o=0,c=!1;e.forEach((u=>{++i,u.next((()=>{++o,c&&o===i&&t()}),(h=>r(h)))})),c=!0,o===i&&t()}))}static or(e){let t=be.resolve(!1);for(const r of e)t=t.next((i=>i?be.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,o)=>{r.push(t.call(this,i,o))})),this.waitFor(r)}static mapArray(e,t){return new be(((r,i)=>{const o=e.length,c=new Array(o);let u=0;for(let h=0;h<o;h++){const m=h;t(e[m]).next((p=>{c[m]=p,++u,u===o&&r(c)}),(p=>i(p)))}}))}static doWhile(e,t){return new be(((r,i)=>{const o=()=>{e()===!0?t().next((()=>{o()}),i):r()};o()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qr="SimpleDb";class _b{static open(e,t,r,i){try{return new _b(t,e.transaction(i,r))}catch(o){throw new Tm(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Bs,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Tm(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=bN(r.target.error);this.S.reject(new Tm(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Fe(qr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new D9(t)}}class ka{static delete(e){return Fe(qr,"Removing database:",e),Uc(sN().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!sd())return!1;if(ka.F())return!0;const e=Mn(),t=ka.M(e),r=0<t&&t<10,i=ck(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,ka.M(Mn())===12.2&&Yn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Fe(qr,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{const c=o.target.result;t(c)},i.onblocked=()=>{r(new Tm(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{const c=o.target.error;c.name==="VersionError"?r(new Le(Te.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):c.name==="InvalidStateError"?r(new Le(Te.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c)):r(new Tm(e,c))},i.onupgradeneeded=o=>{Fe(qr,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const c=o.target.result;this.N.k(c,i.transaction,o.oldVersion,this.version).next((()=>{Fe(qr,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const o=t==="readonly";let c=0;for(;;){++c;try{this.db=await this.L(e);const u=_b.open(this.db,e,o?"readonly":"readwrite",r),h=i(u).next((m=>(u.C(),m))).catch((m=>(u.abort(m),be.reject(m)))).toPromise();return h.catch((()=>{})),await u.D,h}catch(u){const h=u,m=h.name!=="FirebaseError"&&c<3;if(Fe(qr,"Transaction failed with error:",h.message,"Retrying:",m),this.close(),!m)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}function ck(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class R9{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return Uc(this.U.delete())}}class Tm extends Le{constructor(e,t){super(Te.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ec(n){return n.name==="IndexedDbTransactionError"}class D9{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Fe(qr,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Fe(qr,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Uc(r)}add(e){return Fe(qr,"ADD",this.store.name,e,e),Uc(this.store.add(e))}get(e){return Uc(this.store.get(e)).next((t=>(t===void 0&&(t=null),Fe(qr,"GET",this.store.name,e,t),t)))}delete(e){return Fe(qr,"DELETE",this.store.name,e),Uc(this.store.delete(e))}count(){return Fe(qr,"COUNT",this.store.name),Uc(this.store.count())}H(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const o=i.getAll(r.range);return new be(((c,u)=>{o.onerror=h=>{u(h.target.error)},o.onsuccess=h=>{c(h.target.result)}}))}{const o=this.cursor(r),c=[];return this.J(o,((u,h)=>{c.push(h)})).next((()=>c))}}Z(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new be(((i,o)=>{r.onerror=c=>{o(c.target.error)},r.onsuccess=c=>{i(c.target.result)}}))}X(e,t){Fe(qr,"DELETE ALL",this.store.name);const r=this.options(e,t);r.Y=!1;const i=this.cursor(r);return this.J(i,((o,c,u)=>u.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.J(i,t)}te(e){const t=this.cursor({});return new be(((r,i)=>{t.onerror=o=>{const c=bN(o.target.error);i(c)},t.onsuccess=o=>{const c=o.target.result;c?e(c.primaryKey,c.value).next((u=>{u?c.continue():r()})):r()}}))}J(e,t){const r=[];return new be(((i,o)=>{e.onerror=c=>{o(c.target.error)},e.onsuccess=c=>{const u=c.target.result;if(!u)return void i();const h=new R9(u),m=t(u.primaryKey,u.value,h);if(m instanceof be){const p=m.catch((b=>(h.done(),be.reject(b))));r.push(p)}h.isDone?i():h.G===null?u.continue():u.continue(h.G)}})).next((()=>be.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Uc(n){return new be(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=bN(r.target.error);t(i)}}))}let JT=!1;function bN(n){const e=ka.M(Mn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Le("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return JT||(JT=!0,setTimeout((()=>{throw r}),0)),r}}return n}const Im="IndexBackfiller";class P9{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Fe(Im,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Fe(Im,`Documents written: ${t}`)}catch(t){ec(t)?Fe(Im,"Ignoring IndexedDB error during index backfill: ",t):await Zl(t)}await this.re(6e4)}))}}class O9{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,o=!0;return be.doWhile((()=>o===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((c=>{if(c!==null&&!r.has(c))return Fe(Im,`Processing collection: ${c}`),this.oe(e,c,i).next((u=>{i-=u,r.add(c)}));o=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((o=>{const c=o.changes;return this.localStore.indexManager.updateIndexEntries(e,c).next((()=>this._e(i,o))).next((u=>(Fe(Im,`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,t,u)))).next((()=>c.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,o)=>{const c=ak(o);xN(c,r)>0&&(r=c)})),new Xr(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}jr.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cl=-1;function Rg(n){return n==null}function Zm(n){return n===0&&1/n==-1/0}function dk(n){return typeof n=="number"&&Number.isInteger(n)&&!Zm(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tx="";function Ys(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=ZT(e)),e=M9(n.get(t),e);return ZT(e)}function M9(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const o=n.charAt(i);switch(o){case"\0":t+="";break;case Tx:t+="";break;default:t+=o}}return t}function ZT(n){return n+Tx+""}function Ia(n){const e=n.length;if(it(e>=2,64408,{path:n}),e===2)return it(n.charAt(0)===Tx&&n.charAt(1)==="",56145,{path:n}),Ft.emptyPath();const t=e-2,r=[];let i="";for(let o=0;o<e;){const c=n.indexOf(Tx,o);switch((c<0||c>t)&&et(50515,{path:n}),n.charAt(c+1)){case"":const u=n.substring(o,c);let h;i.length===0?h=u:(i+=u,h=i,i=""),r.push(h);break;case"":i+=n.substring(o,c),i+="\0";break;case"":i+=n.substring(o,c+1);break;default:et(61167,{path:n})}o=c+2}return new Ft(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lc="remoteDocuments",Dg="owner",Nu="owner",eg="mutationQueues",L9="userId",Bi="mutations",eI="batchId",Hc="userMutationsIndex",tI=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cx(n,e){return[n,Ys(e)]}function uk(n,e,t){return[n,Ys(e),t]}const V9={},ah="documentMutations",Ix="remoteDocumentsV14",F9=["prefixPath","collectionGroup","readTime","documentId"],dx="documentKeyIndex",U9=["prefixPath","collectionGroup","documentId"],hk="collectionGroupIndex",B9=["collectionGroup","readTime","prefixPath","documentId"],tg="remoteDocumentGlobal",U_="remoteDocumentGlobalKey",oh="targets",fk="queryTargetsIndex",z9=["canonicalId","targetId"],lh="targetDocuments",$9=["targetId","path"],yN="documentTargetsIndex",q9=["path","targetId"],Cx="targetGlobalKey",Xc="targetGlobal",ng="collectionParents",H9=["collectionId","parent"],ch="clientMetadata",G9="clientId",Nb="bundles",W9="bundleId",jb="namedQueries",K9="name",vN="indexConfiguration",Q9="indexId",B_="collectionGroupIndex",Y9="collectionGroup",Cm="indexState",X9=["indexId","uid"],mk="sequenceNumberIndex",J9=["uid","sequenceNumber"],Am="indexEntries",Z9=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],gk="documentKeyIndex",e8=["indexId","uid","orderedDocumentKey"],Sb="documentOverlays",t8=["userId","collectionPath","documentId"],z_="collectionPathOverlayIndex",n8=["userId","collectionPath","largestBatchId"],pk="collectionGroupOverlayIndex",s8=["userId","collectionGroup","largestBatchId"],wN="globals",r8="name",xk=[eg,Bi,ah,Lc,oh,Dg,Xc,lh,ch,tg,ng,Nb,jb],i8=[...xk,Sb],bk=[eg,Bi,ah,Ix,oh,Dg,Xc,lh,ch,tg,ng,Nb,jb,Sb],yk=bk,_N=[...yk,vN,Cm,Am],a8=_N,vk=[..._N,wN],o8=vk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_ extends lk{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function bs(n,e){const t=Ye(n);return ka.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nI(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function tc(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function wk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ln=class q_{constructor(e,t){this.comparator=e,this.root=t||Al.EMPTY}insert(e,t){return new q_(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Al.BLACK,null,null))}remove(e){return new q_(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Al.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Mp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Mp(this.root,e,this.comparator,!1)}getReverseIterator(){return new Mp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Mp(this.root,e,this.comparator,!0)}},Mp=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Al=class co{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??co.RED,this.left=i??co.EMPTY,this.right=o??co.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new co(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return co.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return co.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,co.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,co.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw et(43730,{key:this.key,value:this.value});if(this.right.isRed())throw et(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw et(27949);return e+(this.isRed()?0:1)}};Al.EMPTY=null,Al.RED=!0,Al.BLACK=!1;Al.EMPTY=new class{constructor(){this.size=0}get key(){throw et(57766)}get value(){throw et(16141)}get color(){throw et(16727)}get left(){throw et(29726)}get right(){throw et(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new Al(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this.comparator=e,this.data=new Ln(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new sI(this.data.getIterator())}getIteratorFrom(e){return new sI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof dn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new dn(this.comparator);return t.data=e,t}}class sI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ju(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.fields=e,e.sort(Cn.comparator)}static empty(){return new Sr([])}unionWith(e){let t=new dn(Cn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Sr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return rh(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _k extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l8(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new _k("Invalid base64 string: "+o):o}})(e);return new qn(t)}static fromUint8Array(e){const t=(function(i){let o="";for(let c=0;c<i.length;++c)o+=String.fromCharCode(i[c]);return o})(e);return new qn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return jt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}qn.EMPTY_BYTE_STRING=new qn("");const c8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function jo(n){if(it(!!n,39018),typeof n=="string"){let e=0;const t=c8.exec(n);if(it(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:In(n.seconds),nanos:In(n.nanos)}}function In(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function So(n){return typeof n=="string"?qn.fromBase64String(n):qn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nk="server_timestamp",jk="__type__",Sk="__previous_value__",Ek="__local_write_time__";function Eb(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[jk])==null?void 0:r.stringValue)===Nk}function Tb(n){const e=n.mapValue.fields[Sk];return Eb(e)?Tb(e):e}function sg(n){const e=jo(n.mapValue.fields[Ek].timestampValue);return new tn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d8{constructor(e,t,r,i,o,c,u,h,m,p,b){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=c,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=m,this.isUsingEmulator=p,this.apiKey=b}}const H_="(default)";class Ul{constructor(e,t){this.projectId=e,this.database=t||H_}static empty(){return new Ul("","")}get isDefaultDatabase(){return this.database===H_}isEqual(e){return e instanceof Ul&&e.projectId===this.projectId&&e.database===this.database}}function u8(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new Le(Te.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ul(n.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NN="__type__",Tk="__max__",_l={mapValue:{fields:{__type__:{stringValue:Tk}}}},jN="__vector__",dh="value",ux={nullValue:"NULL_VALUE"};function Bl(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Eb(n)?4:Ik(n)?9007199254740991:Ib(n)?10:11:et(28295,{value:n})}function La(n,e){if(n===e)return!0;const t=Bl(n);if(t!==Bl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return sg(n).isEqual(sg(e));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const c=jo(i.timestampValue),u=jo(o.timestampValue);return c.seconds===u.seconds&&c.nanos===u.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,o){return So(i.bytesValue).isEqual(So(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,o){return In(i.geoPointValue.latitude)===In(o.geoPointValue.latitude)&&In(i.geoPointValue.longitude)===In(o.geoPointValue.longitude)})(n,e);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return In(i.integerValue)===In(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const c=In(i.doubleValue),u=In(o.doubleValue);return c===u?Zm(c)===Zm(u):isNaN(c)&&isNaN(u)}return!1})(n,e);case 9:return rh(n.arrayValue.values||[],e.arrayValue.values||[],La);case 10:case 11:return(function(i,o){const c=i.mapValue.fields||{},u=o.mapValue.fields||{};if(nI(c)!==nI(u))return!1;for(const h in c)if(c.hasOwnProperty(h)&&(u[h]===void 0||!La(c[h],u[h])))return!1;return!0})(n,e);default:return et(52216,{left:n})}}function rg(n,e){return(n.values||[]).find((t=>La(t,e)))!==void 0}function zl(n,e){if(n===e)return 0;const t=Bl(n),r=Bl(e);if(t!==r)return jt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return jt(n.booleanValue,e.booleanValue);case 2:return(function(o,c){const u=In(o.integerValue||o.doubleValue),h=In(c.integerValue||c.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1})(n,e);case 3:return rI(n.timestampValue,e.timestampValue);case 4:return rI(sg(n),sg(e));case 5:return V_(n.stringValue,e.stringValue);case 6:return(function(o,c){const u=So(o),h=So(c);return u.compareTo(h)})(n.bytesValue,e.bytesValue);case 7:return(function(o,c){const u=o.split("/"),h=c.split("/");for(let m=0;m<u.length&&m<h.length;m++){const p=jt(u[m],h[m]);if(p!==0)return p}return jt(u.length,h.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,c){const u=jt(In(o.latitude),In(c.latitude));return u!==0?u:jt(In(o.longitude),In(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return iI(n.arrayValue,e.arrayValue);case 10:return(function(o,c){var v,_,T,k;const u=o.fields||{},h=c.fields||{},m=(v=u[dh])==null?void 0:v.arrayValue,p=(_=h[dh])==null?void 0:_.arrayValue,b=jt(((T=m==null?void 0:m.values)==null?void 0:T.length)||0,((k=p==null?void 0:p.values)==null?void 0:k.length)||0);return b!==0?b:iI(m,p)})(n.mapValue,e.mapValue);case 11:return(function(o,c){if(o===_l.mapValue&&c===_l.mapValue)return 0;if(o===_l.mapValue)return 1;if(c===_l.mapValue)return-1;const u=o.fields||{},h=Object.keys(u),m=c.fields||{},p=Object.keys(m);h.sort(),p.sort();for(let b=0;b<h.length&&b<p.length;++b){const v=V_(h[b],p[b]);if(v!==0)return v;const _=zl(u[h[b]],m[p[b]]);if(_!==0)return _}return jt(h.length,p.length)})(n.mapValue,e.mapValue);default:throw et(23264,{he:t})}}function rI(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return jt(n,e);const t=jo(n),r=jo(e),i=jt(t.seconds,r.seconds);return i!==0?i:jt(t.nanos,r.nanos)}function iI(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const o=zl(t[i],r[i]);if(o)return o}return jt(t.length,r.length)}function uh(n){return G_(n)}function G_(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=jo(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return So(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Qe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const o of t.values||[])i?i=!1:r+=",",r+=G_(o);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",o=!0;for(const c of r)o?o=!1:i+=",",i+=`${c}:${G_(t.fields[c])}`;return i+"}"})(n.mapValue):et(61005,{value:n})}function hx(n){switch(Bl(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Tb(n);return e?16+hx(e):16;case 5:return 2*n.stringValue.length;case 6:return So(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,o)=>i+hx(o)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return tc(r.fields,((o,c)=>{i+=o.length+hx(c)})),i})(n.mapValue);default:throw et(13486,{value:n})}}function id(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function W_(n){return!!n&&"integerValue"in n}function ig(n){return!!n&&"arrayValue"in n}function aI(n){return!!n&&"nullValue"in n}function oI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function fx(n){return!!n&&"mapValue"in n}function Ib(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[NN])==null?void 0:r.stringValue)===jN}function km(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return tc(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=km(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=km(n.arrayValue.values[t]);return e}return{...n}}function Ik(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Tk}const Ck={mapValue:{fields:{[NN]:{stringValue:jN},[dh]:{arrayValue:{}}}}};function h8(n){return"nullValue"in n?ux:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?id(Ul.empty(),Qe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Ib(n)?Ck:{mapValue:{}}:et(35942,{value:n})}function f8(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?id(Ul.empty(),Qe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Ck:"mapValue"in n?Ib(n)?{mapValue:{}}:_l:et(61959,{value:n})}function lI(n,e){const t=zl(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function cI(n,e){const t=zl(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e){this.value=e}static empty(){return new Fs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!fx(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=km(t)}setAll(e){let t=Cn.emptyPath(),r={},i=[];e.forEach(((c,u)=>{if(!t.isImmediateParentOf(u)){const h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=u.popLast()}c?r[u.lastSegment()]=km(c):i.push(u.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){const t=this.field(e.popLast());fx(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return La(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];fx(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){tc(t,((i,o)=>e[i]=o));for(const i of r)delete e[i]}clone(){return new Fs(km(this.value))}}function Ak(n){const e=[];return tc(n.fields,((t,r)=>{const i=new Cn([t]);if(fx(r)){const o=Ak(r.mapValue).fields;if(o.length===0)e.push(i);else for(const c of o)e.push(i.child(c))}else e.push(i)})),new Sr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e,t,r,i,o,c,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=c,this.documentState=u}static newInvalidDocument(e){return new Nn(e,0,lt.min(),lt.min(),lt.min(),Fs.empty(),0)}static newFoundDocument(e,t,r,i){return new Nn(e,1,t,lt.min(),r,i,0)}static newNoDocument(e,t){return new Nn(e,2,t,lt.min(),lt.min(),Fs.empty(),0)}static newUnknownDocument(e,t){return new Nn(e,3,t,lt.min(),lt.min(),Fs.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Fs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Fs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=lt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Nn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Nn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e,t){this.position=e,this.inclusive=t}}function dI(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const o=e[i],c=n.position[i];if(o.field.isKeyField()?r=Qe.comparator(Qe.fromName(c.referenceValue),t.key):r=zl(c,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function uI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!La(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{constructor(e,t="asc"){this.field=e,this.dir=t}}function m8(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kk{}class zt extends kk{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new g8(e,t,r):t==="array-contains"?new b8(e,r):t==="in"?new Lk(e,r):t==="not-in"?new y8(e,r):t==="array-contains-any"?new v8(e,r):new zt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new p8(e,r):new x8(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(zl(t,this.value)):t!==null&&Bl(this.value)===Bl(t)&&this.matchesComparison(zl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return et(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class cn extends kk{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new cn(e,t)}matches(e){return hh(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function hh(n){return n.op==="and"}function K_(n){return n.op==="or"}function SN(n){return Rk(n)&&hh(n)}function Rk(n){for(const e of n.filters)if(e instanceof cn)return!1;return!0}function Q_(n){if(n instanceof zt)return n.field.canonicalString()+n.op.toString()+uh(n.value);if(SN(n))return n.filters.map((e=>Q_(e))).join(",");{const e=n.filters.map((t=>Q_(t))).join(",");return`${n.op}(${e})`}}function Dk(n,e){return n instanceof zt?(function(r,i){return i instanceof zt&&r.op===i.op&&r.field.isEqual(i.field)&&La(r.value,i.value)})(n,e):n instanceof cn?(function(r,i){return i instanceof cn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((o,c,u)=>o&&Dk(c,i.filters[u])),!0):!1})(n,e):void et(19439)}function Pk(n,e){const t=n.filters.concat(e);return cn.create(t,n.op)}function Ok(n){return n instanceof zt?(function(t){return`${t.field.canonicalString()} ${t.op} ${uh(t.value)}`})(n):n instanceof cn?(function(t){return t.op.toString()+" {"+t.getFilters().map(Ok).join(" ,")+"}"})(n):"Filter"}class g8 extends zt{constructor(e,t,r){super(e,t,r),this.key=Qe.fromName(r.referenceValue)}matches(e){const t=Qe.comparator(e.key,this.key);return this.matchesComparison(t)}}class p8 extends zt{constructor(e,t){super(e,"in",t),this.keys=Mk("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class x8 extends zt{constructor(e,t){super(e,"not-in",t),this.keys=Mk("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Mk(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((r=>Qe.fromName(r.referenceValue)))}class b8 extends zt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ig(t)&&rg(t.arrayValue,this.value)}}class Lk extends zt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&rg(this.value.arrayValue,t)}}class y8 extends zt{constructor(e,t){super(e,"not-in",t)}matches(e){if(rg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!rg(this.value.arrayValue,t)}}class v8 extends zt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ig(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>rg(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w8{constructor(e,t=null,r=[],i=[],o=null,c=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=c,this.endAt=u,this.Te=null}}function Y_(n,e=null,t=[],r=[],i=null,o=null,c=null){return new w8(n,e,t,r,i,o,c)}function ad(n){const e=Ye(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Q_(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(o){return o.field.canonicalString()+o.dir})(r))).join(","),Rg(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>uh(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>uh(r))).join(",")),e.Te=t}return e.Te}function Pg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!m8(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Dk(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!uI(n.startAt,e.startAt)&&uI(n.endAt,e.endAt)}function Ax(n){return Qe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function kx(n,e){return n.filters.filter((t=>t instanceof zt&&t.field.isEqual(e)))}function hI(n,e,t){let r=ux,i=!0;for(const o of kx(n,e)){let c=ux,u=!0;switch(o.op){case"<":case"<=":c=h8(o.value);break;case"==":case"in":case">=":c=o.value;break;case">":c=o.value,u=!1;break;case"!=":case"not-in":c=ux}lI({value:r,inclusive:i},{value:c,inclusive:u})<0&&(r=c,i=u)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const c=t.position[o];lI({value:r,inclusive:i},{value:c,inclusive:t.inclusive})<0&&(r=c,i=t.inclusive);break}}return{value:r,inclusive:i}}function fI(n,e,t){let r=_l,i=!0;for(const o of kx(n,e)){let c=_l,u=!0;switch(o.op){case">=":case">":c=f8(o.value),u=!1;break;case"==":case"in":case"<=":c=o.value;break;case"<":c=o.value,u=!1;break;case"!=":case"not-in":c=_l}cI({value:r,inclusive:i},{value:c,inclusive:u})>0&&(r=c,i=u)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const c=t.position[o];cI({value:r,inclusive:i},{value:c,inclusive:t.inclusive})>0&&(r=c,i=t.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,t=null,r=[],i=[],o=null,c="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=c,this.startAt=u,this.endAt=h,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function Vk(n,e,t,r,i,o,c,u){return new Co(n,e,t,r,i,o,c,u)}function Lh(n){return new Co(n)}function mI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function _8(n){return Qe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function EN(n){return n.collectionGroup!==null}function Bu(n){const e=Ye(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let u=new dn(Cn.comparator);return c.filters.forEach((h=>{h.getFlattenedFilters().forEach((m=>{m.isInequality()&&(u=u.add(m.field))}))})),u})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new ag(o,r))})),t.has(Cn.keyField().canonicalString())||e.Ie.push(new ag(Cn.keyField(),r))}return e.Ie}function lr(n){const e=Ye(n);return e.Ee||(e.Ee=N8(e,Bu(n))),e.Ee}function N8(n,e){if(n.limitType==="F")return Y_(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const o=i.dir==="desc"?"asc":"desc";return new ag(i.field,o)}));const t=n.endAt?new $l(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new $l(n.startAt.position,n.startAt.inclusive):null;return Y_(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function X_(n,e){const t=n.filters.concat([e]);return new Co(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function j8(n,e){const t=n.explicitOrderBy.concat([e]);return new Co(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Rx(n,e,t){return new Co(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function S8(n,e){return new Co(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function E8(n,e){return new Co(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,e)}function Og(n,e){return Pg(lr(n),lr(e))&&n.limitType===e.limitType}function Fk(n){return`${ad(lr(n))}|lt:${n.limitType}`}function Ou(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>Ok(i))).join(", ")}]`),Rg(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>uh(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>uh(i))).join(",")),`Target(${r})`})(lr(n))}; limitType=${n.limitType})`}function Mg(n,e){return e.isFoundDocument()&&(function(r,i){const o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):Qe.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(n,e)&&(function(r,i){for(const o of Bu(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const o of r.filters)if(!o.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(c,u,h){const m=dI(c,u,h);return c.inclusive?m<=0:m<0})(r.startAt,Bu(r),i)||r.endAt&&!(function(c,u,h){const m=dI(c,u,h);return c.inclusive?m>=0:m>0})(r.endAt,Bu(r),i))})(n,e)}function Uk(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Bk(n){return(e,t)=>{let r=!1;for(const i of Bu(n)){const o=T8(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function T8(n,e,t){const r=n.field.isKeyField()?Qe.comparator(e.key,t.key):(function(o,c,u){const h=c.data.field(o),m=u.data.field(o);return h!==null&&m!==null?zl(h,m):et(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return et(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){tc(this.inner,((t,r)=>{for(const[i,o]of r)e(i,o)}))}isEmpty(){return wk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I8=new Ln(Qe.comparator);function Er(){return I8}const zk=new Ln(Qe.comparator);function bm(...n){let e=zk;for(const t of n)e=e.insert(t.key,t);return e}function $k(n){let e=zk;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Ca(){return Rm()}function qk(){return Rm()}function Rm(){return new Ao((n=>n.toString()),((n,e)=>n.isEqual(e)))}const C8=new Ln(Qe.comparator),A8=new dn(Qe.comparator);function kt(...n){let e=A8;for(const t of n)e=e.add(t);return e}const k8=new dn(jt);function TN(){return k8}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IN(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Zm(e)?"-0":e}}function Hk(n){return{integerValue:""+n}}function Gk(n,e){return dk(e)?Hk(e):IN(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{constructor(){this._=void 0}}function R8(n,e,t){return n instanceof fh?(function(i,o){const c={fields:{[jk]:{stringValue:Nk},[Ek]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Eb(o)&&(o=Tb(o)),o&&(c.fields[Sk]=o),{mapValue:c}})(t,e):n instanceof od?Kk(n,e):n instanceof ld?Qk(n,e):(function(i,o){const c=Wk(i,o),u=gI(c)+gI(i.Ae);return W_(c)&&W_(i.Ae)?Hk(u):IN(i.serializer,u)})(n,e)}function D8(n,e,t){return n instanceof od?Kk(n,e):n instanceof ld?Qk(n,e):t}function Wk(n,e){return n instanceof mh?(function(r){return W_(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}class fh extends Cb{}class od extends Cb{constructor(e){super(),this.elements=e}}function Kk(n,e){const t=Yk(e);for(const r of n.elements)t.some((i=>La(i,r)))||t.push(r);return{arrayValue:{values:t}}}class ld extends Cb{constructor(e){super(),this.elements=e}}function Qk(n,e){let t=Yk(e);for(const r of n.elements)t=t.filter((i=>!La(i,r)));return{arrayValue:{values:t}}}class mh extends Cb{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function gI(n){return In(n.integerValue||n.doubleValue)}function Yk(n){return ig(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lg{constructor(e,t){this.field=e,this.transform=t}}function P8(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof od&&i instanceof od||r instanceof ld&&i instanceof ld?rh(r.elements,i.elements,La):r instanceof mh&&i instanceof mh?La(r.Ae,i.Ae):r instanceof fh&&i instanceof fh})(n.transform,e.transform)}class O8{constructor(e,t){this.version=e,this.transformResults=t}}class An{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new An}static exists(e){return new An(void 0,e)}static updateTime(e){return new An(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function mx(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Ab{}function Xk(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Fh(n.key,An.none()):new Vh(n.key,n.data,An.none());{const t=n.data,r=Fs.empty();let i=new dn(Cn.comparator);for(let o of e.fields)if(!i.has(o)){let c=t.field(o);c===null&&o.length>1&&(o=o.popLast(),c=t.field(o)),c===null?r.delete(o):r.set(o,c),i=i.add(o)}return new ko(n.key,r,new Sr(i.toArray()),An.none())}}function M8(n,e,t){n instanceof Vh?(function(i,o,c){const u=i.value.clone(),h=xI(i.fieldTransforms,o,c.transformResults);u.setAll(h),o.convertToFoundDocument(c.version,u).setHasCommittedMutations()})(n,e,t):n instanceof ko?(function(i,o,c){if(!mx(i.precondition,o))return void o.convertToUnknownDocument(c.version);const u=xI(i.fieldTransforms,o,c.transformResults),h=o.data;h.setAll(Jk(i)),h.setAll(u),o.convertToFoundDocument(c.version,h).setHasCommittedMutations()})(n,e,t):(function(i,o,c){o.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function Dm(n,e,t,r){return n instanceof Vh?(function(o,c,u,h){if(!mx(o.precondition,c))return u;const m=o.value.clone(),p=bI(o.fieldTransforms,h,c);return m.setAll(p),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),null})(n,e,t,r):n instanceof ko?(function(o,c,u,h){if(!mx(o.precondition,c))return u;const m=bI(o.fieldTransforms,h,c),p=c.data;return p.setAll(Jk(o)),p.setAll(m),c.convertToFoundDocument(c.version,p).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((b=>b.field)))})(n,e,t,r):(function(o,c,u){return mx(o.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):u})(n,e,t)}function L8(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),o=Wk(r.transform,i||null);o!=null&&(t===null&&(t=Fs.empty()),t.set(r.field,o))}return t||null}function pI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&rh(r,i,((o,c)=>P8(o,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Vh extends Ab{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ko extends Ab{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function Jk(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function xI(n,e,t){const r=new Map;it(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let i=0;i<t.length;i++){const o=n[i],c=o.transform,u=e.data.field(o.field);r.set(o.field,D8(c,u,t[i]))}return r}function bI(n,e,t){const r=new Map;for(const i of n){const o=i.transform,c=t.data.field(i.field);r.set(i.field,R8(o,c,e))}return r}class Fh extends Ab{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class CN extends Ab{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AN{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&M8(o,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Dm(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Dm(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=qk();return this.mutations.forEach((i=>{const o=e.get(i.key),c=o.overlayedDocument;let u=this.applyToLocalView(c,o.mutatedFields);u=t.has(i.key)?null:u;const h=Xk(c,u);h!==null&&r.set(i.key,h),c.isValidDocument()||c.convertToNoDocument(lt.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),kt())}isEqual(e){return this.batchId===e.batchId&&rh(this.mutations,e.mutations,((t,r)=>pI(t,r)))&&rh(this.baseMutations,e.baseMutations,((t,r)=>pI(t,r)))}}class kN{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){it(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return C8})();const o=e.mutations;for(let c=0;c<o.length;c++)i=i.insert(o[c].key,r[c].version);return new kN(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RN{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V8{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ls,Ht;function Zk(n){switch(n){case Te.OK:return et(64938);case Te.CANCELLED:case Te.UNKNOWN:case Te.DEADLINE_EXCEEDED:case Te.RESOURCE_EXHAUSTED:case Te.INTERNAL:case Te.UNAVAILABLE:case Te.UNAUTHENTICATED:return!1;case Te.INVALID_ARGUMENT:case Te.NOT_FOUND:case Te.ALREADY_EXISTS:case Te.PERMISSION_DENIED:case Te.FAILED_PRECONDITION:case Te.ABORTED:case Te.OUT_OF_RANGE:case Te.UNIMPLEMENTED:case Te.DATA_LOSS:return!0;default:return et(15467,{code:n})}}function eR(n){if(n===void 0)return Yn("GRPC error has no .code"),Te.UNKNOWN;switch(n){case ls.OK:return Te.OK;case ls.CANCELLED:return Te.CANCELLED;case ls.UNKNOWN:return Te.UNKNOWN;case ls.DEADLINE_EXCEEDED:return Te.DEADLINE_EXCEEDED;case ls.RESOURCE_EXHAUSTED:return Te.RESOURCE_EXHAUSTED;case ls.INTERNAL:return Te.INTERNAL;case ls.UNAVAILABLE:return Te.UNAVAILABLE;case ls.UNAUTHENTICATED:return Te.UNAUTHENTICATED;case ls.INVALID_ARGUMENT:return Te.INVALID_ARGUMENT;case ls.NOT_FOUND:return Te.NOT_FOUND;case ls.ALREADY_EXISTS:return Te.ALREADY_EXISTS;case ls.PERMISSION_DENIED:return Te.PERMISSION_DENIED;case ls.FAILED_PRECONDITION:return Te.FAILED_PRECONDITION;case ls.ABORTED:return Te.ABORTED;case ls.OUT_OF_RANGE:return Te.OUT_OF_RANGE;case ls.UNIMPLEMENTED:return Te.UNIMPLEMENTED;case ls.DATA_LOSS:return Te.DATA_LOSS;default:return et(39323,{code:n})}}(Ht=ls||(ls={}))[Ht.OK=0]="OK",Ht[Ht.CANCELLED=1]="CANCELLED",Ht[Ht.UNKNOWN=2]="UNKNOWN",Ht[Ht.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ht[Ht.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ht[Ht.NOT_FOUND=5]="NOT_FOUND",Ht[Ht.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ht[Ht.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ht[Ht.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ht[Ht.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ht[Ht.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ht[Ht.ABORTED=10]="ABORTED",Ht[Ht.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ht[Ht.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ht[Ht.INTERNAL=13]="INTERNAL",Ht[Ht.UNAVAILABLE=14]="UNAVAILABLE",Ht[Ht.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tR(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F8=new Il([4294967295,4294967295],0);function yI(n){const e=tR().encode(n),t=new W4;return t.update(e),new Uint8Array(t.digest())}function vI(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Il([t,r],0),new Il([i,o],0)]}class DN{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ym(`Invalid padding: ${t}`);if(r<0)throw new ym(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ym(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ym(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Il.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Il.fromNumber(r)));return i.compare(F8)===1&&(i=new Il([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=yI(e),[r,i]=vI(t);for(let o=0;o<this.hashCount;o++){const c=this.ye(r,i,o);if(!this.we(c))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),c=new DN(o,i,t);return r.forEach((u=>c.insert(u))),c}insert(e){if(this.ge===0)return;const t=yI(e),[r,i]=vI(t);for(let o=0;o<this.hashCount;o++){const c=this.ye(r,i,o);this.be(c)}}be(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class ym extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Fg.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Vg(lt.min(),i,new Ln(jt),Er(),kt())}}class Fg{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Fg(r,t,kt(),kt(),kt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.De=i}}class nR{constructor(e,t){this.targetId=e,this.Ce=t}}class sR{constructor(e,t,r=qn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class wI{constructor(){this.ve=0,this.Fe=_I(),this.Me=qn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=kt(),t=kt(),r=kt();return this.Fe.forEach(((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:et(38017,{changeType:o})}})),new Fg(this.Me,this.xe,e,t,r)}Ke(){this.Oe=!1,this.Fe=_I()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,it(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class U8{constructor(e){this.Ge=e,this.ze=new Map,this.je=Er(),this.He=Lp(),this.Je=Lp(),this.Ze=new Ln(jt)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:et(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const o=i.target;if(Ax(o))if(r===0){const c=new Qe(o.path);this.et(t,c,Nn.newNoDocument(c,lt.min()))}else it(r===1,20013,{expectedCount:r});else{const c=this._t(t);if(c!==r){const u=this.ut(e),h=u?this.ct(u,e,c):1;if(h!==0){this.it(t);const m=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t;let c,u;try{c=So(r).toUint8Array()}catch(h){if(h instanceof _k)return Ma("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new DN(c,i,o)}catch(h){return Ma(h instanceof ym?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.ge===0?null:u}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((o=>{const c=this.Ge.ht(),u=`projects/${c.projectId}/databases/${c.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.et(t,o,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((o,c)=>{const u=this.ot(c);if(u){if(o.current&&Ax(u.target)){const h=new Qe(u.target.path);this.It(h).has(c)||this.Et(c,h)||this.et(c,h,Nn.newNoDocument(h,e))}o.Be&&(t.set(c,o.ke()),o.Ke())}}));let r=kt();this.Je.forEach(((o,c)=>{let u=!0;c.forEachWhile((h=>{const m=this.ot(h);return!m||m.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(r=r.add(o))})),this.je.forEach(((o,c)=>c.setReadTime(e)));const i=new Vg(e,t,this.Ze,this.je,r);return this.je=Er(),this.He=Lp(),this.Je=Lp(),this.Ze=new Ln(jt),i}Ye(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,r),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.qe(t,1):i.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new wI,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new dn(jt),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new dn(jt),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Fe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new wI),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Lp(){return new Ln(Qe.comparator)}function _I(){return new Ln(Qe.comparator)}const B8={asc:"ASCENDING",desc:"DESCENDING"},z8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$8={and:"AND",or:"OR"};class q8{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function J_(n,e){return n.useProto3Json||Rg(e)?e:{value:e}}function gh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function rR(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function H8(n,e){return gh(n,e.toTimestamp())}function Xn(n){return it(!!n,49232),lt.fromTimestamp((function(t){const r=jo(t);return new tn(r.seconds,r.nanos)})(n))}function PN(n,e){return Z_(n,e).canonicalString()}function Z_(n,e){const t=(function(i){return new Ft(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function iR(n){const e=Ft.fromString(n);return it(gR(e),10190,{key:e.toString()}),e}function og(n,e){return PN(n.databaseId,e.path)}function Ra(n,e){const t=iR(e);if(t.get(1)!==n.databaseId.projectId)throw new Le(Te.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Le(Te.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Qe(lR(t))}function aR(n,e){return PN(n.databaseId,e)}function oR(n){const e=iR(n);return e.length===4?Ft.emptyPath():lR(e)}function e1(n){return new Ft(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function lR(n){return it(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function NI(n,e,t){return{name:og(n,e),fields:t.value.mapValue.fields}}function cR(n,e,t){const r=Ra(n,e.name),i=Xn(e.updateTime),o=e.createTime?Xn(e.createTime):lt.min(),c=new Fs({mapValue:{fields:e.fields}}),u=Nn.newFoundDocument(r,i,o,c);return t&&u.setHasCommittedMutations(),t?u.setHasCommittedMutations():u}function G8(n,e){return"found"in e?(function(r,i){it(!!i.found,43571),i.found.name,i.found.updateTime;const o=Ra(r,i.found.name),c=Xn(i.found.updateTime),u=i.found.createTime?Xn(i.found.createTime):lt.min(),h=new Fs({mapValue:{fields:i.found.fields}});return Nn.newFoundDocument(o,c,u,h)})(n,e):"missing"in e?(function(r,i){it(!!i.missing,3894),it(!!i.readTime,22933);const o=Ra(r,i.missing),c=Xn(i.readTime);return Nn.newNoDocument(o,c)})(n,e):et(7234,{result:e})}function W8(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:et(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=(function(m,p){return m.useProto3Json?(it(p===void 0||typeof p=="string",58123),qn.fromBase64String(p||"")):(it(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),qn.fromUint8Array(p||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,u=c&&(function(m){const p=m.code===void 0?Te.UNKNOWN:eR(m.code);return new Le(p,m.message||"")})(c);t=new sR(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ra(n,r.document.name),o=Xn(r.document.updateTime),c=r.document.createTime?Xn(r.document.createTime):lt.min(),u=new Fs({mapValue:{fields:r.document.fields}}),h=Nn.newFoundDocument(i,o,c,u),m=r.targetIds||[],p=r.removedTargetIds||[];t=new gx(m,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Ra(n,r.document),o=r.readTime?Xn(r.readTime):lt.min(),c=Nn.newNoDocument(i,o),u=r.removedTargetIds||[];t=new gx([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Ra(n,r.document),o=r.removedTargetIds||[];t=new gx([],o,i,null)}else{if(!("filter"in e))return et(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:o}=r,c=new V8(i,o),u=r.targetId;t=new nR(u,c)}}return t}function lg(n,e){let t;if(e instanceof Vh)t={update:NI(n,e.key,e.value)};else if(e instanceof Fh)t={delete:og(n,e.key)};else if(e instanceof ko)t={update:NI(n,e.key,e.data),updateMask:Z8(e.fieldMask)};else{if(!(e instanceof CN))return et(16599,{dt:e.type});t={verify:og(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(o,c){const u=c.transform;if(u instanceof fh)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof od)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof ld)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof mh)return{fieldPath:c.field.canonicalString(),increment:u.Ae};throw et(20930,{transform:c.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,o){return o.updateTime!==void 0?{updateTime:H8(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:et(27497)})(n,e.precondition)),t}function t1(n,e){const t=e.currentDocument?(function(o){return o.updateTime!==void 0?An.updateTime(Xn(o.updateTime)):o.exists!==void 0?An.exists(o.exists):An.none()})(e.currentDocument):An.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(c,u){let h=null;if("setToServerValue"in u)it(u.setToServerValue==="REQUEST_TIME",16630,{proto:u}),h=new fh;else if("appendMissingElements"in u){const p=u.appendMissingElements.values||[];h=new od(p)}else if("removeAllFromArray"in u){const p=u.removeAllFromArray.values||[];h=new ld(p)}else"increment"in u?h=new mh(c,u.increment):et(16584,{proto:u});const m=Cn.fromServerFormat(u.fieldPath);return new Lg(m,h)})(n,i))):[];if(e.update){e.update.name;const i=Ra(n,e.update.name),o=new Fs({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=(function(h){const m=h.fieldPaths||[];return new Sr(m.map((p=>Cn.fromServerFormat(p))))})(e.updateMask);return new ko(i,o,c,t,r)}return new Vh(i,o,t,r)}if(e.delete){const i=Ra(n,e.delete);return new Fh(i,t)}if(e.verify){const i=Ra(n,e.verify);return new CN(i,t)}return et(1463,{proto:e})}function K8(n,e){return n&&n.length>0?(it(e!==void 0,14353),n.map((t=>(function(i,o){let c=i.updateTime?Xn(i.updateTime):Xn(o);return c.isEqual(lt.min())&&(c=Xn(o)),new O8(c,i.transformResults||[])})(t,e)))):[]}function dR(n,e){return{documents:[aR(n,e.path)]}}function uR(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=aR(n,i);const o=(function(m){if(m.length!==0)return mR(cn.create(m,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const c=(function(m){if(m.length!==0)return m.map((p=>(function(v){return{field:Mu(v.field),direction:Y8(v.dir)}})(p)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const u=J_(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:t,parent:i}}function hR(n){let e=oR(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){it(r===1,65062);const p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let o=[];t.where&&(o=(function(b){const v=fR(b);return v instanceof cn&&SN(v)?v.getFilters():[v]})(t.where));let c=[];t.orderBy&&(c=(function(b){return b.map((v=>(function(T){return new ag(Lu(T.field),(function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(T.direction))})(v)))})(t.orderBy));let u=null;t.limit&&(u=(function(b){let v;return v=typeof b=="object"?b.value:b,Rg(v)?null:v})(t.limit));let h=null;t.startAt&&(h=(function(b){const v=!!b.before,_=b.values||[];return new $l(_,v)})(t.startAt));let m=null;return t.endAt&&(m=(function(b){const v=!b.before,_=b.values||[];return new $l(_,v)})(t.endAt)),Vk(e,i,c,o,u,"F",h,m)}function Q8(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return et(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function fR(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Lu(t.unaryFilter.field);return zt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Lu(t.unaryFilter.field);return zt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Lu(t.unaryFilter.field);return zt.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Lu(t.unaryFilter.field);return zt.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return et(61313);default:return et(60726)}})(n):n.fieldFilter!==void 0?(function(t){return zt.create(Lu(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return et(58110);default:return et(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return cn.create(t.compositeFilter.filters.map((r=>fR(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return et(1026)}})(t.compositeFilter.op))})(n):et(30097,{filter:n})}function Y8(n){return B8[n]}function X8(n){return z8[n]}function J8(n){return $8[n]}function Mu(n){return{fieldPath:n.canonicalString()}}function Lu(n){return Cn.fromServerFormat(n.fieldPath)}function mR(n){return n instanceof zt?(function(t){if(t.op==="=="){if(oI(t.value))return{unaryFilter:{field:Mu(t.field),op:"IS_NAN"}};if(aI(t.value))return{unaryFilter:{field:Mu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(oI(t.value))return{unaryFilter:{field:Mu(t.field),op:"IS_NOT_NAN"}};if(aI(t.value))return{unaryFilter:{field:Mu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mu(t.field),op:X8(t.op),value:t.value}}})(n):n instanceof cn?(function(t){const r=t.getFilters().map((i=>mR(i)));return r.length===1?r[0]:{compositeFilter:{op:J8(t.op),filters:r}}})(n):et(54877,{filter:n})}function Z8(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function gR(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function pR(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(e,t,r,i,o=lt.min(),c=lt.min(),u=qn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new mo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new mo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new mo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new mo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR{constructor(e){this.yt=e}}function eF(n,e){let t;if(e.document)t=cR(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Qe.fromSegments(e.noDocument.path),i=dd(e.noDocument.readTime);t=Nn.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return et(56709);{const r=Qe.fromSegments(e.unknownDocument.path),i=dd(e.unknownDocument.version);t=Nn.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const o=new tn(i[0],i[1]);return lt.fromTimestamp(o)})(e.readTime)),t}function jI(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Dx(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(o,c){return{name:og(o,c.key),fields:c.data.value.mapValue.fields,updateTime:gh(o,c.version.toTimestamp()),createTime:gh(o,c.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:cd(e.version)};else{if(!e.isUnknownDocument())return et(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:cd(e.version)}}return r}function Dx(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function cd(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function dd(n){const e=new tn(n.seconds,n.nanoseconds);return lt.fromTimestamp(e)}function Bc(n,e){const t=(e.baseMutations||[]).map((o=>t1(n.yt,o)));for(let o=0;o<e.mutations.length-1;++o){const c=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const u=e.mutations[o+1];c.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const r=e.mutations.map((o=>t1(n.yt,o))),i=tn.fromMillis(e.localWriteTimeMs);return new AN(e.batchId,i,t,r)}function vm(n){const e=dd(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?dd(n.lastLimboFreeSnapshotVersion):lt.min();let r;return r=(function(o){return o.documents!==void 0})(n.query)?(function(o){const c=o.documents.length;return it(c===1,1966,{count:c}),lr(Lh(oR(o.documents[0])))})(n.query):(function(o){return lr(hR(o))})(n.query),new mo(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,qn.fromBase64String(n.resumeToken))}function bR(n,e){const t=cd(e.snapshotVersion),r=cd(e.lastLimboFreeSnapshotVersion);let i;i=Ax(e.target)?dR(n.yt,e.target):uR(n.yt,e.target).ft;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ad(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function ON(n){const e=hR({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Rx(e,e.limit,"L"):e}function Fw(n,e){return new RN(e.largestBatchId,t1(n.yt,e.overlayMutation))}function SI(n,e){const t=e.path.lastSegment();return[n,Ys(e.path.popLast()),t]}function EI(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:cd(r.readTime),documentKey:Ys(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tF{getBundleMetadata(e,t){return TI(e).get(t).next((r=>{if(r)return(function(o){return{id:o.bundleId,createTime:dd(o.createTime),version:o.version}})(r)}))}saveBundleMetadata(e,t){return TI(e).put((function(i){return{bundleId:i.id,createTime:cd(Xn(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return II(e).get(t).next((r=>{if(r)return(function(o){return{name:o.name,query:ON(o.bundledQuery),readTime:dd(o.readTime)}})(r)}))}saveNamedQuery(e,t){return II(e).put((function(i){return{name:i.name,readTime:cd(Xn(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function TI(n){return bs(n,Nb)}function II(n){return bs(n,jb)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kb{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new kb(e,r)}getOverlay(e,t){return Zf(e).get(SI(this.userId,t)).next((r=>r?Fw(this.serializer,r):null))}getOverlays(e,t){const r=Ca();return be.forEach(t,(i=>this.getOverlay(e,i).next((o=>{o!==null&&r.set(i,o)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((o,c)=>{const u=new RN(t,c);i.push(this.bt(e,u))})),be.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((c=>i.add(Ys(c.getCollectionPath()))));const o=[];return i.forEach((c=>{const u=IDBKeyRange.bound([this.userId,c,r],[this.userId,c,r+1],!1,!0);o.push(Zf(e).X(z_,u))})),be.waitFor(o)}getOverlaysForCollection(e,t,r){const i=Ca(),o=Ys(t),c=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Zf(e).H(z_,c).next((u=>{for(const h of u){const m=Fw(this.serializer,h);i.set(m.getKey(),m)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const o=Ca();let c;const u=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Zf(e).ee({index:pk,range:u},((h,m,p)=>{const b=Fw(this.serializer,m);o.size()<i||b.largestBatchId===c?(o.set(b.getKey(),b),c=b.largestBatchId):p.done()})).next((()=>o))}bt(e,t){return Zf(e).put((function(i,o,c){const[u,h,m]=SI(o,c.mutation.key);return{userId:o,collectionPath:h,documentId:m,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:lg(i.yt,c.mutation)}})(this.serializer,this.userId,t))}}function Zf(n){return bs(n,Sb)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nF{St(e){return bs(e,wN)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const r=t==null?void 0:t.value;return r?qn.fromUint8Array(r):qn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(In(e.integerValue));else if("doubleValue"in e){const r=In(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Zm(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=jo(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(So(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?Ik(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Ib(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):et(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){var c,u;const r=e.fields||{};this.Ft(t,53);const i=dh,o=((u=(c=r[i].arrayValue)==null?void 0:c.values)==null?void 0:u.length)||0;this.Ft(t,15),t.Mt(In(o)),this.Ot(i,t),this.Ct(r[i],t)}qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),Qe.fromName(e).path.forEach((r=>{this.Ft(t,60),this.$t(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}zc.Wt=new zc;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Su=255;function sF(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function CI(n){const e=64-(function(r){let i=0;for(let o=0;o<8;++o){const c=sF(255&r[o]);if(i+=c,c!==8)break}return i})(n);return Math.ceil(e/8)}class rF{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ht(r.value),r=t.next();this.Jt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ht(r);else if(r<2048)this.Ht(960|r>>>6),this.Ht(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|r>>>12),this.Ht(128|63&r>>>6),this.Ht(128|63&r);else{const i=t.codePointAt(0);this.Ht(240|i>>>18),this.Ht(128|63&i>>>12),this.Ht(128|63&i>>>6),this.Ht(128|63&i)}}this.Jt()}Yt(e){const t=this.en(e),r=CI(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=CI(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Su),this.sn(255)}_n(){this.an(Su),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(o){const c=new DataView(new ArrayBuffer(8));return c.setFloat64(0,o,!1),new Uint8Array(c.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Su?(this.sn(Su),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Su?(this.an(Su),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class iF{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class aF{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class em{constructor(){this.cn=new rF,this.ascending=new iF(this.cn),this.descending=new aF(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e,t,r,i){this.hn=e,this.Pn=t,this.Tn=r,this.In=i}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.In,0),t!==e?r.set([0],this.In.length):++r[r.length-1],new $c(this.hn,this.Pn,this.Tn,r)}Rn(e,t,r){return{indexId:this.hn,uid:e,arrayValue:px(this.Tn),directionalValue:px(this.In),orderedDocumentKey:px(t),documentKey:r.path.toArray()}}An(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function ml(n,e){let t=n.hn-e.hn;return t!==0?t:(t=AI(n.Tn,e.Tn),t!==0?t:(t=AI(n.In,e.In),t!==0?t:Qe.comparator(n.Pn,e.Pn)))}function AI(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function px(n){return D4()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function kI(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class RI{constructor(e){this.Vn=new dn(((t,r)=>Cn.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Vn=this.Vn.add(r):this.mn.push(r)}}get fn(){return this.Vn.size>1}gn(e){if(it(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=F_(e);if(t!==void 0&&!this.pn(t))return!1;const r=Mc(e);let i=new Set,o=0,c=0;for(;o<r.length&&this.pn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Vn.size>0){const u=this.Vn.getIterator().getNext();if(!i.has(u.field.canonicalString())){const h=r[o];if(!this.yn(u,h)||!this.wn(this.dn[c++],h))return!1}++o}for(;o<r.length;++o){const u=r[o];if(c>=this.dn.length||!this.wn(this.dn[c++],u))return!1}return!0}bn(){if(this.fn)return null;let e=new dn(Cn.comparator);const t=[];for(const r of this.mn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new lx(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new lx(r.field,0))}for(const r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new lx(r.field,r.dir==="asc"?0:1)));return new Ex(Ex.UNKNOWN_ID,this.collectionId,t,Jm.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yR(n){var t,r;if(it(n instanceof zt||n instanceof cn,20012),n instanceof zt){if(n instanceof Lk){const i=((r=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:r.map((o=>zt.create(n.field,"==",o))))||[];return cn.create(i,"or")}return n}const e=n.filters.map((i=>yR(i)));return cn.create(e,n.op)}function oF(n){if(n.getFilters().length===0)return[];const e=r1(yR(n));return it(vR(e),7391),n1(e)||s1(e)?[e]:e.getFilters()}function n1(n){return n instanceof zt}function s1(n){return n instanceof cn&&SN(n)}function vR(n){return n1(n)||s1(n)||(function(t){if(t instanceof cn&&K_(t)){for(const r of t.getFilters())if(!n1(r)&&!s1(r))return!1;return!0}return!1})(n)}function r1(n){if(it(n instanceof zt||n instanceof cn,34018),n instanceof zt)return n;if(n.filters.length===1)return r1(n.filters[0]);const e=n.filters.map((r=>r1(r)));let t=cn.create(e,n.op);return t=Px(t),vR(t)?t:(it(t instanceof cn,64498),it(hh(t),40251),it(t.filters.length>1,57927),t.filters.reduce(((r,i)=>MN(r,i))))}function MN(n,e){let t;return it(n instanceof zt||n instanceof cn,38388),it(e instanceof zt||e instanceof cn,25473),t=n instanceof zt?e instanceof zt?(function(i,o){return cn.create([i,o],"and")})(n,e):DI(n,e):e instanceof zt?DI(e,n):(function(i,o){if(it(i.filters.length>0&&o.filters.length>0,48005),hh(i)&&hh(o))return Pk(i,o.getFilters());const c=K_(i)?i:o,u=K_(i)?o:i,h=c.filters.map((m=>MN(m,u)));return cn.create(h,"or")})(n,e),Px(t)}function DI(n,e){if(hh(e))return Pk(e,n.getFilters());{const t=e.filters.map((r=>MN(n,r)));return cn.create(t,"or")}}function Px(n){if(it(n instanceof zt||n instanceof cn,11850),n instanceof zt)return n;const e=n.getFilters();if(e.length===1)return Px(e[0]);if(Rk(n))return n;const t=e.map((i=>Px(i))),r=[];return t.forEach((i=>{i instanceof zt?r.push(i):i instanceof cn&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:cn.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lF{constructor(){this.Sn=new LN}addToCollectionParentIndex(e,t){return this.Sn.add(t),be.resolve()}getCollectionParents(e,t){return be.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return be.resolve()}deleteFieldIndex(e,t){return be.resolve()}deleteAllFieldIndexes(e){return be.resolve()}createTargetIndexes(e,t){return be.resolve()}getDocumentsMatchingTarget(e,t){return be.resolve(null)}getIndexType(e,t){return be.resolve(0)}getFieldIndexes(e,t){return be.resolve([])}getNextCollectionGroupToUpdate(e){return be.resolve(null)}getMinOffset(e,t){return be.resolve(Xr.min())}getMinOffsetFromCollectionGroup(e,t){return be.resolve(Xr.min())}updateCollectionGroup(e,t,r){return be.resolve()}updateIndexEntries(e,t){return be.resolve()}}class LN{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new dn(Ft.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new dn(Ft.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PI="IndexedDbIndexManager",Vp=new Uint8Array(0);class cF{constructor(e,t){this.databaseId=t,this.Dn=new LN,this.Cn=new Ao((r=>ad(r)),((r,i)=>Pg(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const o={collectionId:r,parent:Ys(i)};return OI(e).put(o)}return be.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[tk(t),""],!1,!0);return OI(e).H(i).next((o=>{for(const c of o){if(c.collectionId!==t)break;r.push(Ia(c.parent))}return r}))}addFieldIndex(e,t){const r=tm(e),i=(function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map((h=>[h.fieldPath.canonicalString(),h.kind]))}})(t);delete i.indexId;const o=r.add(i);if(t.indexState){const c=Tu(e);return o.next((u=>{c.put(EI(u,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return o.next()}deleteFieldIndex(e,t){const r=tm(e),i=Tu(e),o=Eu(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=tm(e),r=Eu(e),i=Tu(e);return t.X().next((()=>r.X())).next((()=>i.X()))}createTargetIndexes(e,t){return be.forEach(this.vn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const o=new RI(r).bn();if(o!=null)return this.addFieldIndex(e,o)}}))))}getDocumentsMatchingTarget(e,t){const r=Eu(e);let i=!0;const o=new Map;return be.forEach(this.vn(t),(c=>this.Fn(e,c).next((u=>{i&&(i=!!u),o.set(c,u)})))).next((()=>{if(i){let c=kt();const u=[];return be.forEach(o,((h,m)=>{Fe(PI,`Using index ${(function($){return`id=${$.indexId}|cg=${$.collectionGroup}|f=${$.fields.map((H=>`${H.fieldPath}:${H.kind}`)).join(",")}`})(h)} to execute ${ad(t)}`);const p=(function($,H){const G=F_(H);if(G===void 0)return null;for(const z of kx($,G.fieldPath))switch(z.op){case"array-contains-any":return z.value.arrayValue.values||[];case"array-contains":return[z.value]}return null})(m,h),b=(function($,H){const G=new Map;for(const z of Mc(H))for(const P of kx($,z.fieldPath))switch(P.op){case"==":case"in":G.set(z.fieldPath.canonicalString(),P.value);break;case"not-in":case"!=":return G.set(z.fieldPath.canonicalString(),P.value),Array.from(G.values())}return null})(m,h),v=(function($,H){const G=[];let z=!0;for(const P of Mc(H)){const j=P.kind===0?hI($,P.fieldPath,$.startAt):fI($,P.fieldPath,$.startAt);G.push(j.value),z&&(z=j.inclusive)}return new $l(G,z)})(m,h),_=(function($,H){const G=[];let z=!0;for(const P of Mc(H)){const j=P.kind===0?fI($,P.fieldPath,$.endAt):hI($,P.fieldPath,$.endAt);G.push(j.value),z&&(z=j.inclusive)}return new $l(G,z)})(m,h),T=this.Mn(h,m,v),k=this.Mn(h,m,_),E=this.xn(h,m,b),S=this.On(h.indexId,p,T,v.inclusive,k,_.inclusive,E);return be.forEach(S,(L=>r.Z(L,t.limit).next(($=>{$.forEach((H=>{const G=Qe.fromSegments(H.documentKey);c.has(G)||(c=c.add(G),u.push(G))}))}))))})).next((()=>u))}return be.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=oF(cn.create(e.filters,"and")).map((r=>Y_(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,r,i,o,c,u){const h=(t!=null?t.length:1)*Math.max(r.length,o.length),m=h/(t!=null?t.length:1),p=[];for(let b=0;b<h;++b){const v=t?this.Nn(t[b/m]):Vp,_=this.Bn(e,v,r[b%m],i),T=this.Ln(e,v,o[b%m],c),k=u.map((E=>this.Bn(e,v,E,!0)));p.push(...this.createRange(_,T,k))}return p}Bn(e,t,r,i){const o=new $c(e,Qe.empty(),t,r);return i?o:o.En()}Ln(e,t,r,i){const o=new $c(e,Qe.empty(),t,r);return i?o.En():o}Fn(e,t){const r=new RI(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((o=>{let c=null;for(const u of o)r.gn(u)&&(!c||u.fields.length>c.fields.length)&&(c=u);return c}))}getIndexType(e,t){let r=2;const i=this.vn(t);return be.forEach(i,(o=>this.Fn(e,o).next((c=>{c?r!==0&&c.fields.length<(function(h){let m=new dn(Cn.comparator),p=!1;for(const b of h.filters)for(const v of b.getFlattenedFilters())v.field.isKeyField()||(v.op==="array-contains"||v.op==="array-contains-any"?p=!0:m=m.add(v.field));for(const b of h.orderBy)b.field.isKeyField()||(m=m.add(b.field));return m.size+(p?1:0)})(o)&&(r=1):r=0})))).next((()=>(function(c){return c.limit!==null})(t)&&i.length>1&&r===2?1:r))}kn(e,t){const r=new em;for(const i of Mc(e)){const o=t.data.field(i.fieldPath);if(o==null)return null;const c=r.ln(i.kind);zc.Wt.Dt(o,c)}return r.un()}Nn(e){const t=new em;return zc.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const r=new em;return zc.Wt.Dt(id(this.databaseId,t),r.ln((function(o){const c=Mc(o);return c.length===0?0:c[c.length-1].kind})(e))),r.un()}xn(e,t,r){if(r===null)return[];let i=[];i.push(new em);let o=0;for(const c of Mc(e)){const u=r[o++];for(const h of i)if(this.qn(t,c.fieldPath)&&ig(u))i=this.Un(i,c,u);else{const m=h.ln(c.kind);zc.Wt.Dt(u,m)}}return this.$n(i)}Mn(e,t,r){return this.xn(e,t,r.position)}$n(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Un(e,t,r){const i=[...e],o=[];for(const c of r.arrayValue.values||[])for(const u of i){const h=new em;h.seed(u.un()),zc.Wt.Dt(c,h.ln(t.kind)),o.push(h)}return o}qn(e,t){return!!e.filters.find((r=>r instanceof zt&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=tm(e),i=Tu(e);return(t?r.H(B_,IDBKeyRange.bound(t,t)):r.H()).next((o=>{const c=[];return be.forEach(o,(u=>i.get([u.indexId,this.uid]).next((h=>{c.push((function(p,b){const v=b?new Jm(b.sequenceNumber,new Xr(dd(b.readTime),new Qe(Ia(b.documentKey)),b.largestBatchId)):Jm.empty(),_=p.fields.map((([T,k])=>new lx(Cn.fromServerFormat(T),k)));return new Ex(p.indexId,p.collectionGroup,_,v)})(u,h))})))).next((()=>c))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:jt(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=tm(e),o=Tu(e);return this.Wn(e).next((c=>i.H(B_,IDBKeyRange.bound(t,t)).next((u=>be.forEach(u,(h=>o.put(EI(h.indexId,this.uid,c,r))))))))}updateIndexEntries(e,t){const r=new Map;return be.forEach(t,((i,o)=>{const c=r.get(i.collectionGroup);return(c?be.resolve(c):this.getFieldIndexes(e,i.collectionGroup)).next((u=>(r.set(i.collectionGroup,u),be.forEach(u,(h=>this.Qn(e,i,h).next((m=>{const p=this.Gn(o,h);return m.isEqual(p)?be.resolve():this.zn(e,o,h,m,p)})))))))}))}jn(e,t,r,i){return Eu(e).put(i.Rn(this.uid,this.Kn(r,t.key),t.key))}Hn(e,t,r,i){return Eu(e).delete(i.An(this.uid,this.Kn(r,t.key),t.key))}Qn(e,t,r){const i=Eu(e);let o=new dn(ml);return i.ee({index:gk,range:IDBKeyRange.only([r.indexId,this.uid,px(this.Kn(r,t))])},((c,u)=>{o=o.add(new $c(r.indexId,t,kI(u.arrayValue),kI(u.directionalValue)))})).next((()=>o))}Gn(e,t){let r=new dn(ml);const i=this.kn(t,e);if(i==null)return r;const o=F_(t);if(o!=null){const c=e.data.field(o.fieldPath);if(ig(c))for(const u of c.arrayValue.values||[])r=r.add(new $c(t.indexId,e.key,this.Nn(u),i))}else r=r.add(new $c(t.indexId,e.key,Vp,i));return r}zn(e,t,r,i,o){Fe(PI,"Updating index entries for document '%s'",t.key);const c=[];return(function(h,m,p,b,v){const _=h.getIterator(),T=m.getIterator();let k=ju(_),E=ju(T);for(;k||E;){let S=!1,L=!1;if(k&&E){const $=p(k,E);$<0?L=!0:$>0&&(S=!0)}else k!=null?L=!0:S=!0;S?(b(E),E=ju(T)):L?(v(k),k=ju(_)):(k=ju(_),E=ju(T))}})(i,o,ml,(u=>{c.push(this.jn(e,t,r,u))}),(u=>{c.push(this.Hn(e,t,r,u))})),be.waitFor(c)}Wn(e){let t=1;return Tu(e).ee({index:mk,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,o)=>{o.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((c,u)=>ml(c,u))).filter(((c,u,h)=>!u||ml(c,h[u-1])!==0));const i=[];i.push(e);for(const c of r){const u=ml(c,e),h=ml(c,t);if(u===0)i[0]=e.En();else if(u>0&&h<0)i.push(c),i.push(c.En());else if(h>0)break}i.push(t);const o=[];for(let c=0;c<i.length;c+=2){if(this.Jn(i[c],i[c+1]))return[];const u=i[c].An(this.uid,Vp,Qe.empty()),h=i[c+1].An(this.uid,Vp,Qe.empty());o.push(IDBKeyRange.bound(u,h))}return o}Jn(e,t){return ml(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(MI)}getMinOffset(e,t){return be.mapArray(this.vn(t),(r=>this.Fn(e,r).next((i=>i||et(44426))))).next(MI)}}function OI(n){return bs(n,ng)}function Eu(n){return bs(n,Am)}function tm(n){return bs(n,vN)}function Tu(n){return bs(n,Cm)}function MI(n){it(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;xN(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Xr(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},wR=41943040;class Ws{static withCacheSize(e){return new Ws(e,Ws.DEFAULT_COLLECTION_PERCENTILE,Ws.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _R(n,e,t){const r=n.store(Bi),i=n.store(ah),o=[],c=IDBKeyRange.only(t.batchId);let u=0;const h=r.ee({range:c},((p,b,v)=>(u++,v.delete())));o.push(h.next((()=>{it(u===1,47070,{batchId:t.batchId})})));const m=[];for(const p of t.mutations){const b=uk(e,p.key.path,t.batchId);o.push(i.delete(b)),m.push(p.key)}return be.waitFor(o).next((()=>m))}function Ox(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw et(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ws.DEFAULT_COLLECTION_PERCENTILE=10,Ws.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ws.DEFAULT=new Ws(wR,Ws.DEFAULT_COLLECTION_PERCENTILE,Ws.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ws.DISABLED=new Ws(-1,0,0);class Rb{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Zn={}}static wt(e,t,r,i){it(e.uid!=="",64387);const o=e.isAuthenticated()?e.uid:"";return new Rb(o,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return gl(e).ee({index:Hc,range:r},((i,o,c)=>{t=!1,c.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const o=Vu(e),c=gl(e);return c.add({}).next((u=>{it(typeof u=="number",49019);const h=new AN(u,t,r,i),m=(function(_,T,k){const E=k.baseMutations.map((L=>lg(_.yt,L))),S=k.mutations.map((L=>lg(_.yt,L)));return{userId:T,batchId:k.batchId,localWriteTimeMs:k.localWriteTime.toMillis(),baseMutations:E,mutations:S}})(this.serializer,this.userId,h),p=[];let b=new dn(((v,_)=>jt(v.canonicalString(),_.canonicalString())));for(const v of i){const _=uk(this.userId,v.key.path,u);b=b.add(v.key.path.popLast()),p.push(c.put(m)),p.push(o.put(_,V9))}return b.forEach((v=>{p.push(this.indexManager.addToCollectionParentIndex(e,v))})),e.addOnCommittedListener((()=>{this.Zn[u]=h.keys()})),be.waitFor(p).next((()=>h))}))}lookupMutationBatch(e,t){return gl(e).get(t).next((r=>r?(it(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Bc(this.serializer,r)):null))}Xn(e,t){return this.Zn[t]?be.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Zn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let o=null;return gl(e).ee({index:Hc,range:i},((c,u,h)=>{u.userId===this.userId&&(it(u.batchId>=r,47524,{Yn:r}),o=Bc(this.serializer,u)),h.done()})).next((()=>o))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Cl;return gl(e).ee({index:Hc,range:t,reverse:!0},((i,o,c)=>{r=o.batchId,c.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Cl],[this.userId,Number.POSITIVE_INFINITY]);return gl(e).H(Hc,t).next((r=>r.map((i=>Bc(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=cx(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return Vu(e).ee({range:i},((c,u,h)=>{const[m,p,b]=c,v=Ia(p);if(m===this.userId&&t.path.isEqual(v))return gl(e).get(b).next((_=>{if(!_)throw et(61480,{er:c,batchId:b});it(_.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:_.userId,batchId:b}),o.push(Bc(this.serializer,_))}));h.done()})).next((()=>o))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new dn(jt);const i=[];return t.forEach((o=>{const c=cx(this.userId,o.path),u=IDBKeyRange.lowerBound(c),h=Vu(e).ee({range:u},((m,p,b)=>{const[v,_,T]=m,k=Ia(_);v===this.userId&&o.path.isEqual(k)?r=r.add(T):b.done()}));i.push(h)})),be.waitFor(i).next((()=>this.tr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,o=cx(this.userId,r),c=IDBKeyRange.lowerBound(o);let u=new dn(jt);return Vu(e).ee({range:c},((h,m,p)=>{const[b,v,_]=h,T=Ia(v);b===this.userId&&r.isPrefixOf(T)?T.length===i&&(u=u.add(_)):p.done()})).next((()=>this.tr(e,u)))}tr(e,t){const r=[],i=[];return t.forEach((o=>{i.push(gl(e).get(o).next((c=>{if(c===null)throw et(35274,{batchId:o});it(c.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:c.userId,batchId:o}),r.push(Bc(this.serializer,c))})))})),be.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return _R(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),be.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return be.resolve();const r=IDBKeyRange.lowerBound((function(c){return[c]})(this.userId)),i=[];return Vu(e).ee({range:r},((o,c,u)=>{if(o[0]===this.userId){const h=Ia(o[1]);i.push(h)}else u.done()})).next((()=>{it(i.length===0,56720,{rr:i.map((o=>o.canonicalString()))})}))}))}containsKey(e,t){return NR(e,this.userId,t)}ir(e){return jR(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Cl,lastStreamToken:""}))}}function NR(n,e,t){const r=cx(e,t.path),i=r[1],o=IDBKeyRange.lowerBound(r);let c=!1;return Vu(n).ee({range:o,Y:!0},((u,h,m)=>{const[p,b,v]=u;p===e&&b===i&&(c=!0),m.done()})).next((()=>c))}function gl(n){return bs(n,Bi)}function Vu(n){return bs(n,ah)}function jR(n){return bs(n,eg)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new ud(0)}static ar(){return new ud(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dF{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const r=new ud(t.highestTargetId);return t.highestTargetId=r.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>lt.fromTimestamp(new tn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.ur(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.cr(e,i))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((r=>(r.targetCount+=1,this.hr(t,r),this.cr(e,r))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Iu(e).delete(t.targetId))).next((()=>this.ur(e))).next((r=>(it(r.targetCount>0,8065),r.targetCount-=1,this.cr(e,r))))}removeTargets(e,t,r){let i=0;const o=[];return Iu(e).ee(((c,u)=>{const h=vm(u);h.sequenceNumber<=t&&r.get(h.targetId)===null&&(i++,o.push(this.removeTargetData(e,h)))})).next((()=>be.waitFor(o))).next((()=>i))}forEachTarget(e,t){return Iu(e).ee(((r,i)=>{const o=vm(i);t(o)}))}ur(e){return VI(e).get(Cx).next((t=>(it(t!==null,2888),t)))}cr(e,t){return VI(e).put(Cx,t)}lr(e,t){return Iu(e).put(bR(this.serializer,t))}hr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const r=ad(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let o=null;return Iu(e).ee({range:i,index:fk},((c,u,h)=>{const m=vm(u);Pg(t,m.target)&&(o=m,h.done())})).next((()=>o))}addMatchingKeys(e,t,r){const i=[],o=wl(e);return t.forEach((c=>{const u=Ys(c.path);i.push(o.put({targetId:r,path:u})),i.push(this.referenceDelegate.addReference(e,r,c))})),be.waitFor(i)}removeMatchingKeys(e,t,r){const i=wl(e);return be.forEach(t,(o=>{const c=Ys(o.path);return be.waitFor([i.delete([r,c]),this.referenceDelegate.removeReference(e,r,o)])}))}removeMatchingKeysForTargetId(e,t){const r=wl(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=wl(e);let o=kt();return i.ee({range:r,Y:!0},((c,u,h)=>{const m=Ia(c[1]),p=new Qe(m);o=o.add(p)})).next((()=>o))}containsKey(e,t){const r=Ys(t.path),i=IDBKeyRange.bound([r],[tk(r)],!1,!0);let o=0;return wl(e).ee({index:yN,Y:!0,range:i},(([c,u],h,m)=>{c!==0&&(o++,m.done())})).next((()=>o>0))}At(e,t){return Iu(e).get(t).next((r=>r?vm(r):null))}}function Iu(n){return bs(n,oh)}function VI(n){return bs(n,Xc)}function wl(n){return bs(n,lh)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI="LruGarbageCollector",uF=1048576;function UI([n,e],[t,r]){const i=jt(n,t);return i===0?jt(e,r):i}class hF{constructor(e){this.Pr=e,this.buffer=new dn(UI),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();UI(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class SR{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Fe(FI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ec(t)?Fe(FI,"Ignoring IndexedDB error during garbage collection: ",t):await Zl(t)}await this.Ar(3e5)}))}}class fF{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return be.resolve(jr.ce);const r=new hF(t);return this.Vr.forEachTarget(e,(i=>r.Er(i.sequenceNumber))).next((()=>this.Vr.mr(e,(i=>r.Er(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Fe("LruGarbageCollector","Garbage collection skipped; disabled"),be.resolve(LI)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),LI):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let r,i,o,c,u,h,m;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((b=>(b>this.params.maximumSequenceNumbersToCollect?(Fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),i=this.params.maximumSequenceNumbersToCollect):i=b,c=Date.now(),this.nthSequenceNumber(e,i)))).next((b=>(r=b,u=Date.now(),this.removeTargets(e,r,t)))).next((b=>(o=b,h=Date.now(),this.removeOrphanedDocuments(e,r)))).next((b=>(m=Date.now(),Pu()<=Ot.DEBUG&&Fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-p}ms
	Determined least recently used ${i} in `+(u-c)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${b} documents in `+(m-h)+`ms
Total Duration: ${m-p}ms`),be.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:b}))))}}function ER(n,e){return new fF(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mF{constructor(e,t){this.db=e,this.garbageCollector=ER(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}pr(e){let t=0;return this.mr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((r,i)=>t(i)))}addReference(e,t,r){return Fp(e,r)}removeReference(e,t,r){return Fp(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Fp(e,t)}wr(e,t){return(function(i,o){let c=!1;return jR(i).te((u=>NR(i,u,o).next((h=>(h&&(c=!0),be.resolve(!h)))))).next((()=>c))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let o=0;return this.yr(e,((c,u)=>{if(u<=t){const h=this.wr(e,c).next((m=>{if(!m)return o++,r.getEntry(e,c).next((()=>(r.removeEntry(c,lt.min()),wl(e).delete((function(b){return[0,Ys(b.path)]})(c)))))}));i.push(h)}})).next((()=>be.waitFor(i))).next((()=>r.apply(e))).next((()=>o))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Fp(e,t)}yr(e,t){const r=wl(e);let i,o=jr.ce;return r.ee({index:yN},(([c,u],{path:h,sequenceNumber:m})=>{c===0?(o!==jr.ce&&t(new Qe(Ia(i)),o),o=m,i=h):o=jr.ce})).next((()=>{o!==jr.ce&&t(new Qe(Ia(i)),o)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Fp(n,e){return wl(n).put((function(r,i){return{targetId:0,path:Ys(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(){this.changes=new Ao((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Nn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?be.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gF{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Dc(e).put(r)}removeEntry(e,t,r){return Dc(e).delete((function(o,c){const u=o.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],Dx(c),u[u.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.br(e,r))))}getEntry(e,t){let r=Nn.newInvalidDocument(t);return Dc(e).ee({index:dx,range:IDBKeyRange.only(nm(t))},((i,o)=>{r=this.Sr(t,o)})).next((()=>r))}Dr(e,t){let r={size:0,document:Nn.newInvalidDocument(t)};return Dc(e).ee({index:dx,range:IDBKeyRange.only(nm(t))},((i,o)=>{r={document:this.Sr(t,o),size:Ox(o)}})).next((()=>r))}getEntries(e,t){let r=Er();return this.Cr(e,t,((i,o)=>{const c=this.Sr(i,o);r=r.insert(i,c)})).next((()=>r))}vr(e,t){let r=Er(),i=new Ln(Qe.comparator);return this.Cr(e,t,((o,c)=>{const u=this.Sr(o,c);r=r.insert(o,u),i=i.insert(o,Ox(c))})).next((()=>({documents:r,Fr:i})))}Cr(e,t,r){if(t.isEmpty())return be.resolve();let i=new dn($I);t.forEach((h=>i=i.add(h)));const o=IDBKeyRange.bound(nm(i.first()),nm(i.last())),c=i.getIterator();let u=c.getNext();return Dc(e).ee({index:dx,range:o},((h,m,p)=>{const b=Qe.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;u&&$I(u,b)<0;)r(u,null),u=c.getNext();u&&u.isEqual(b)&&(r(u,m),u=c.hasNext()?c.getNext():null),u?p.j(nm(u)):p.done()})).next((()=>{for(;u;)r(u,null),u=c.hasNext()?c.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,o){const c=t.path,u=[c.popLast().toArray(),c.lastSegment(),Dx(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[c.popLast().toArray(),c.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Dc(e).H(IDBKeyRange.bound(u,h,!0)).next((m=>{o==null||o.incrementDocumentReadCount(m.length);let p=Er();for(const b of m){const v=this.Sr(Qe.fromSegments(b.prefixPath.concat(b.collectionGroup,b.documentId)),b);v.isFoundDocument()&&(Mg(t,v)||i.has(v.key))&&(p=p.insert(v.key,v))}return p}))}getAllFromCollectionGroup(e,t,r,i){let o=Er();const c=zI(t,r),u=zI(t,Xr.max());return Dc(e).ee({index:hk,range:IDBKeyRange.bound(c,u,!0)},((h,m,p)=>{const b=this.Sr(Qe.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);o=o.insert(b.key,b),o.size===i&&p.done()})).next((()=>o))}newChangeBuffer(e){return new pF(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return BI(e).get(U_).next((t=>(it(!!t,20021),t)))}br(e,t){return BI(e).put(U_,t)}Sr(e,t){if(t){const r=eF(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(lt.min())))return r}return Nn.newInvalidDocument(e)}}function IR(n){return new gF(n)}class pF extends TR{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new Ao((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new dn(((o,c)=>jt(o.canonicalString(),c.canonicalString())));return this.changes.forEach(((o,c)=>{const u=this.Or.get(o);if(t.push(this.Mr.removeEntry(e,o,u.readTime)),c.isValidDocument()){const h=jI(this.Mr.serializer,c);i=i.add(o.path.popLast());const m=Ox(h);r+=m-u.size,t.push(this.Mr.addEntry(e,o,h))}else if(r-=u.size,this.trackRemovals){const h=jI(this.Mr.serializer,c.convertToNoDocument(lt.min()));t.push(this.Mr.addEntry(e,o,h))}})),i.forEach((o=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,o))})),t.push(this.Mr.updateMetadata(e,r)),be.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((r=>(this.Or.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:r,Fr:i})=>(i.forEach(((o,c)=>{this.Or.set(o,{size:c,readTime:r.get(o).readTime})})),r)))}}function BI(n){return bs(n,tg)}function Dc(n){return bs(n,Ix)}function nm(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function zI(n,e){const t=e.documentKey.path.toArray();return[n,Dx(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function $I(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(i=jt(t[o],r[o]),i)return i;return i=jt(t.length,r.length),i||(i=jt(t[t.length-2],r[r.length-2]),i||jt(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xF{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Dm(r.mutation,i,Sr.empty(),tn.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,kt()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=kt()){const i=Ca();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((o=>{let c=bm();return o.forEach(((u,h)=>{c=c.insert(u,h.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const r=Ca();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,kt())))}populateOverlays(e,t,r){const i=[];return r.forEach((o=>{t.has(o)||i.push(o)})),this.documentOverlayCache.getOverlays(e,i).next((o=>{o.forEach(((c,u)=>{t.set(c,u)}))}))}computeViews(e,t,r,i){let o=Er();const c=Rm(),u=(function(){return Rm()})();return t.forEach(((h,m)=>{const p=r.get(m.key);i.has(m.key)&&(p===void 0||p.mutation instanceof ko)?o=o.insert(m.key,m):p!==void 0?(c.set(m.key,p.mutation.getFieldMask()),Dm(p.mutation,m,p.mutation.getFieldMask(),tn.now())):c.set(m.key,Sr.empty())})),this.recalculateAndSaveOverlays(e,o).next((h=>(h.forEach(((m,p)=>c.set(m,p))),t.forEach(((m,p)=>u.set(m,new xF(p,c.get(m)??null)))),u)))}recalculateAndSaveOverlays(e,t){const r=Rm();let i=new Ln(((c,u)=>c-u)),o=kt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const u of c)u.keys().forEach((h=>{const m=t.get(h);if(m===null)return;let p=r.get(h)||Sr.empty();p=u.applyToLocalView(m,p),r.set(h,p);const b=(i.get(u.batchId)||kt()).add(h);i=i.insert(u.batchId,b)}))})).next((()=>{const c=[],u=i.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),m=h.key,p=h.value,b=qk();p.forEach((v=>{if(!o.has(v)){const _=Xk(t.get(v),r.get(v));_!==null&&b.set(v,_),o=o.add(v)}})),c.push(this.documentOverlayCache.saveOverlays(e,m,b))}return be.waitFor(c)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return _8(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):EN(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((o=>{const c=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):be.resolve(Ca());let u=ih,h=o;return c.next((m=>be.forEach(m,((p,b)=>(u<b.largestBatchId&&(u=b.largestBatchId),o.get(p)?be.resolve():this.remoteDocumentCache.getEntry(e,p).next((v=>{h=h.insert(p,v)}))))).next((()=>this.populateOverlays(e,m,o))).next((()=>this.computeViews(e,h,m,kt()))).next((p=>({batchId:u,changes:$k(p)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Qe(t)).next((r=>{let i=bm();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const o=t.collectionGroup;let c=bm();return this.indexManager.getCollectionParents(e,o).next((u=>be.forEach(u,(h=>{const m=(function(b,v){return new Co(v,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)})(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,m,r,i).next((p=>{p.forEach(((b,v)=>{c=c.insert(b,v)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((c=>(o=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i)))).next((c=>{o.forEach(((h,m)=>{const p=m.getKey();c.get(p)===null&&(c=c.insert(p,Nn.newInvalidDocument(p)))}));let u=bm();return c.forEach(((h,m)=>{const p=o.get(h);p!==void 0&&Dm(p.mutation,m,Sr.empty(),tn.now()),Mg(t,m)&&(u=u.insert(h,m))})),u}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bF{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return be.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Xn(i.createTime)}})(t)),be.resolve()}getNamedQuery(e,t){return be.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(i){return{name:i.name,query:ON(i.bundledQuery),readTime:Xn(i.readTime)}})(t)),be.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yF{constructor(){this.overlays=new Ln(Qe.comparator),this.Lr=new Map}getOverlay(e,t){return be.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ca();return be.forEach(t,(i=>this.getOverlay(e,i).next((o=>{o!==null&&r.set(i,o)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,o)=>{this.bt(e,t,o)})),be.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Lr.get(r);return i!==void 0&&(i.forEach((o=>this.overlays=this.overlays.remove(o))),this.Lr.delete(r)),be.resolve()}getOverlaysForCollection(e,t,r){const i=Ca(),o=t.length+1,c=new Qe(t.child("")),u=this.overlays.getIteratorFrom(c);for(;u.hasNext();){const h=u.getNext().value,m=h.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return be.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new Ln(((m,p)=>m-p));const c=this.overlays.getIterator();for(;c.hasNext();){const m=c.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>r){let p=o.get(m.largestBatchId);p===null&&(p=Ca(),o=o.insert(m.largestBatchId,p)),p.set(m.getKey(),m)}}const u=Ca(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((m,p)=>u.set(m,p))),!(u.size()>=i)););return be.resolve(u)}bt(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const c=this.Lr.get(i.largestBatchId).delete(r.key);this.Lr.set(i.largestBatchId,c)}this.overlays=this.overlays.insert(r.key,new RN(t,r));let o=this.Lr.get(t);o===void 0&&(o=kt(),this.Lr.set(t,o)),this.Lr.set(t,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vF{constructor(){this.sessionToken=qn.EMPTY_BYTE_STRING}getSessionToken(e){return be.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,be.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VN{constructor(){this.kr=new dn(js.Kr),this.qr=new dn(js.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const r=new js(e,t);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Wr(new js(e,t))}Qr(e,t){e.forEach((r=>this.removeReference(r,t)))}Gr(e){const t=new Qe(new Ft([])),r=new js(t,e),i=new js(t,e+1),o=[];return this.qr.forEachInRange([r,i],(c=>{this.Wr(c),o.push(c.key)})),o}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Qe(new Ft([])),r=new js(t,e),i=new js(t,e+1);let o=kt();return this.qr.forEachInRange([r,i],(c=>{o=o.add(c.key)})),o}containsKey(e){const t=new js(e,0),r=this.kr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class js{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Qe.comparator(e.key,t.key)||jt(e.Hr,t.Hr)}static Ur(e,t){return jt(e.Hr,t.Hr)||Qe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wF{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new dn(js.Kr)}checkEmpty(e){return be.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const o=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new AN(o,t,r,i);this.mutationQueue.push(c);for(const u of i)this.Jr=this.Jr.add(new js(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return be.resolve(c)}lookupMutationBatch(e,t){return be.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.Xr(r),o=i<0?0:i;return be.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return be.resolve(this.mutationQueue.length===0?Cl:this.Yn-1)}getAllMutationBatches(e){return be.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new js(t,0),i=new js(t,Number.POSITIVE_INFINITY),o=[];return this.Jr.forEachInRange([r,i],(c=>{const u=this.Zr(c.Hr);o.push(u)})),be.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new dn(jt);return t.forEach((i=>{const o=new js(i,0),c=new js(i,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([o,c],(u=>{r=r.add(u.Hr)}))})),be.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let o=r;Qe.isDocumentKey(o)||(o=o.child(""));const c=new js(new Qe(o),0);let u=new dn(jt);return this.Jr.forEachWhile((h=>{const m=h.key.path;return!!r.isPrefixOf(m)&&(m.length===i&&(u=u.add(h.Hr)),!0)}),c),be.resolve(this.Yr(u))}Yr(e){const t=[];return e.forEach((r=>{const i=this.Zr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){it(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return be.forEach(t.mutations,(i=>{const o=new js(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Jr=r}))}nr(e){}containsKey(e,t){const r=new js(t,0),i=this.Jr.firstAfterOrEqual(r);return be.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,be.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _F{constructor(e){this.ti=e,this.docs=(function(){return new Ln(Qe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),o=i?i.size:0,c=this.ti(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:c}),this.size+=c-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return be.resolve(r?r.document.mutableCopy():Nn.newInvalidDocument(t))}getEntries(e,t){let r=Er();return t.forEach((i=>{const o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Nn.newInvalidDocument(i))})),be.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Er();const c=t.path,u=new Qe(c.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:m,value:{document:p}}=h.getNext();if(!c.isPrefixOf(m.path))break;m.path.length>c.length+1||xN(ak(p),r)<=0||(i.has(p.key)||Mg(t,p))&&(o=o.insert(p.key,p.mutableCopy()))}return be.resolve(o)}getAllFromCollectionGroup(e,t,r,i){et(9500)}ni(e,t){return be.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new NF(this)}getSize(e){return be.resolve(this.size)}}class NF extends TR{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Mr.addEntry(e,i)):this.Mr.removeEntry(r)})),be.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jF{constructor(e){this.persistence=e,this.ri=new Ao((t=>ad(t)),Pg),this.lastRemoteSnapshotVersion=lt.min(),this.highestTargetId=0,this.ii=0,this.si=new VN,this.targetCount=0,this.oi=ud._r()}forEachTarget(e,t){return this.ri.forEach(((r,i)=>t(i))),be.resolve()}getLastRemoteSnapshotVersion(e){return be.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return be.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),be.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ii&&(this.ii=t),be.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new ud(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,be.resolve()}updateTargetData(e,t){return this.lr(t),be.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,be.resolve()}removeTargets(e,t,r){let i=0;const o=[];return this.ri.forEach(((c,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.ri.delete(c),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)})),be.waitFor(o).next((()=>i))}getTargetCount(e){return be.resolve(this.targetCount)}getTargetData(e,t){const r=this.ri.get(t)||null;return be.resolve(r)}addMatchingKeys(e,t,r){return this.si.$r(t,r),be.resolve()}removeMatchingKeys(e,t,r){this.si.Qr(t,r);const i=this.persistence.referenceDelegate,o=[];return i&&t.forEach((c=>{o.push(i.markPotentiallyOrphaned(e,c))})),be.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),be.resolve()}getMatchingKeysForTargetId(e,t){const r=this.si.jr(t);return be.resolve(r)}containsKey(e,t){return be.resolve(this.si.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FN{constructor(e,t){this._i={},this.overlays={},this.ai=new jr(0),this.ui=!1,this.ui=!0,this.ci=new vF,this.referenceDelegate=e(this),this.li=new jF(this),this.indexManager=new lF,this.remoteDocumentCache=(function(i){return new _F(i)})((r=>this.referenceDelegate.hi(r))),this.serializer=new xR(t),this.Pi=new bF(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new yF,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this._i[e.toKey()];return r||(r=new wF(t,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,r){Fe("MemoryPersistence","Starting transaction:",e);const i=new SF(this.ai.next());return this.referenceDelegate.Ti(),r(i).next((o=>this.referenceDelegate.Ii(i).next((()=>o)))).toPromise().then((o=>(i.raiseOnCommittedEvent(),o)))}Ei(e,t){return be.or(Object.values(this._i).map((r=>()=>r.containsKey(e,t))))}}class SF extends lk{constructor(e){super(),this.currentSequenceNumber=e}}class Db{constructor(e){this.persistence=e,this.Ri=new VN,this.Ai=null}static Vi(e){return new Db(e)}get di(){if(this.Ai)return this.Ai;throw et(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.di.delete(r.toString()),be.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.di.add(r.toString()),be.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),be.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((i=>this.di.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((o=>this.di.add(o.toString())))})).next((()=>r.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return be.forEach(this.di,(r=>{const i=Qe.fromPath(r);return this.mi(e,i).next((o=>{o||t.removeEntry(i,lt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return be.or([()=>be.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Mx{constructor(e,t){this.persistence=e,this.fi=new Ao((r=>Ys(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=ER(this,t)}static Vi(e,t){return new Mx(e,t)}Ti(){}Ii(e){return be.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}pr(e){let t=0;return this.mr(e,(r=>{t++})).next((()=>t))}mr(e,t){return be.forEach(this.fi,((r,i)=>this.wr(e,r,i).next((o=>o?be.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ni(e,(c=>this.wr(e,c,t).next((u=>{u||(r++,o.removeEntry(c,lt.min()))})))).next((()=>o.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),be.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),be.resolve()}removeReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),be.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),be.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=hx(e.data.value)),t}wr(e,t,r){return be.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.fi.get(t);return be.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EF{constructor(e){this.serializer=e}k(e,t,r,i){const o=new _b("createOrUpgrade",t);r<1&&i>=1&&((function(h){h.createObjectStore(Dg)})(e),(function(h){h.createObjectStore(eg,{keyPath:L9}),h.createObjectStore(Bi,{keyPath:eI,autoIncrement:!0}).createIndex(Hc,tI,{unique:!0}),h.createObjectStore(ah)})(e),qI(e),(function(h){h.createObjectStore(Lc)})(e));let c=be.resolve();return r<3&&i>=3&&(r!==0&&((function(h){h.deleteObjectStore(lh),h.deleteObjectStore(oh),h.deleteObjectStore(Xc)})(e),qI(e)),c=c.next((()=>(function(h){const m=h.store(Xc),p={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:lt.min().toTimestamp(),targetCount:0};return m.put(Cx,p)})(o)))),r<4&&i>=4&&(r!==0&&(c=c.next((()=>(function(h,m){return m.store(Bi).H().next((b=>{h.deleteObjectStore(Bi),h.createObjectStore(Bi,{keyPath:eI,autoIncrement:!0}).createIndex(Hc,tI,{unique:!0});const v=m.store(Bi),_=b.map((T=>v.put(T)));return be.waitFor(_)}))})(e,o)))),c=c.next((()=>{(function(h){h.createObjectStore(ch,{keyPath:G9})})(e)}))),r<5&&i>=5&&(c=c.next((()=>this.gi(o)))),r<6&&i>=6&&(c=c.next((()=>((function(h){h.createObjectStore(tg)})(e),this.pi(o))))),r<7&&i>=7&&(c=c.next((()=>this.yi(o)))),r<8&&i>=8&&(c=c.next((()=>this.wi(e,o)))),r<9&&i>=9&&(c=c.next((()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(c=c.next((()=>this.bi(o)))),r<11&&i>=11&&(c=c.next((()=>{(function(h){h.createObjectStore(Nb,{keyPath:W9})})(e),(function(h){h.createObjectStore(jb,{keyPath:K9})})(e)}))),r<12&&i>=12&&(c=c.next((()=>{(function(h){const m=h.createObjectStore(Sb,{keyPath:t8});m.createIndex(z_,n8,{unique:!1}),m.createIndex(pk,s8,{unique:!1})})(e)}))),r<13&&i>=13&&(c=c.next((()=>(function(h){const m=h.createObjectStore(Ix,{keyPath:F9});m.createIndex(dx,U9),m.createIndex(hk,B9)})(e))).next((()=>this.Si(e,o))).next((()=>e.deleteObjectStore(Lc)))),r<14&&i>=14&&(c=c.next((()=>this.Di(e,o)))),r<15&&i>=15&&(c=c.next((()=>(function(h){h.createObjectStore(vN,{keyPath:Q9,autoIncrement:!0}).createIndex(B_,Y9,{unique:!1}),h.createObjectStore(Cm,{keyPath:X9}).createIndex(mk,J9,{unique:!1}),h.createObjectStore(Am,{keyPath:Z9}).createIndex(gk,e8,{unique:!1})})(e)))),r<16&&i>=16&&(c=c.next((()=>{t.objectStore(Cm).clear()})).next((()=>{t.objectStore(Am).clear()}))),r<17&&i>=17&&(c=c.next((()=>{(function(h){h.createObjectStore(wN,{keyPath:r8})})(e)}))),r<18&&i>=18&&D4()&&(c=c.next((()=>{t.objectStore(Cm).clear()})).next((()=>{t.objectStore(Am).clear()}))),c}pi(e){let t=0;return e.store(Lc).ee(((r,i)=>{t+=Ox(i)})).next((()=>{const r={byteSize:t};return e.store(tg).put(U_,r)}))}gi(e){const t=e.store(eg),r=e.store(Bi);return t.H().next((i=>be.forEach(i,(o=>{const c=IDBKeyRange.bound([o.userId,Cl],[o.userId,o.lastAcknowledgedBatchId]);return r.H(Hc,c).next((u=>be.forEach(u,(h=>{it(h.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:h.batchId});const m=Bc(this.serializer,h);return _R(e,o.userId,m).next((()=>{}))}))))}))))}yi(e){const t=e.store(lh),r=e.store(Lc);return e.store(Xc).get(Cx).next((i=>{const o=[];return r.ee(((c,u)=>{const h=new Ft(c),m=(function(b){return[0,Ys(b)]})(h);o.push(t.get(m).next((p=>p?be.resolve():(b=>t.put({targetId:0,path:Ys(b),sequenceNumber:i.highestListenSequenceNumber}))(h))))})).next((()=>be.waitFor(o)))}))}wi(e,t){e.createObjectStore(ng,{keyPath:H9});const r=t.store(ng),i=new LN,o=c=>{if(i.add(c)){const u=c.lastSegment(),h=c.popLast();return r.put({collectionId:u,parent:Ys(h)})}};return t.store(Lc).ee({Y:!0},((c,u)=>{const h=new Ft(c);return o(h.popLast())})).next((()=>t.store(ah).ee({Y:!0},(([c,u,h],m)=>{const p=Ia(u);return o(p.popLast())}))))}bi(e){const t=e.store(oh);return t.ee(((r,i)=>{const o=vm(i),c=bR(this.serializer,o);return t.put(c)}))}Si(e,t){const r=t.store(Lc),i=[];return r.ee(((o,c)=>{const u=t.store(Ix),h=(function(b){return b.document?new Qe(Ft.fromString(b.document.name).popFirst(5)):b.noDocument?Qe.fromSegments(b.noDocument.path):b.unknownDocument?Qe.fromSegments(b.unknownDocument.path):et(36783)})(c).path.toArray(),m={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};i.push(u.put(m))})).next((()=>be.waitFor(i)))}Di(e,t){const r=t.store(Bi),i=IR(this.serializer),o=new FN(Db.Vi,this.serializer.yt);return r.H().next((c=>{const u=new Map;return c.forEach((h=>{let m=u.get(h.userId)??kt();Bc(this.serializer,h).keys().forEach((p=>m=m.add(p))),u.set(h.userId,m)})),be.forEach(u,((h,m)=>{const p=new Es(m),b=kb.wt(this.serializer,p),v=o.getIndexManager(p),_=Rb.wt(p,this.serializer,v,o.referenceDelegate);return new CR(i,_,b,v).recalculateAndSaveOverlaysForDocumentKeys(new $_(t,jr.ce),h).next()}))}))}}function qI(n){n.createObjectStore(lh,{keyPath:$9}).createIndex(yN,q9,{unique:!0}),n.createObjectStore(oh,{keyPath:"targetId"}).createIndex(fk,z9,{unique:!0}),n.createObjectStore(Xc)}const pl="IndexedDbPersistence",Uw=18e5,Bw=5e3,zw="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",AR="main";class UN{constructor(e,t,r,i,o,c,u,h,m,p,b=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Ci=o,this.window=c,this.document=u,this.Fi=m,this.Mi=p,this.xi=b,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=v=>Promise.resolve(),!UN.v())throw new Le(Te.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new mF(this,i),this.Ki=t+AR,this.serializer=new xR(h),this.qi=new ka(this.Ki,this.xi,new EF(this.serializer)),this.ci=new nF,this.li=new dF(this.referenceDelegate,this.serializer),this.remoteDocumentCache=IR(this.serializer),this.Pi=new tF,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,p===!1&&Yn(pl,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Le(Te.FAILED_PRECONDITION,zw);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new jr(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Up(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(ec(e))return Fe(pl,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Fe(pl,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return sm(e).get(Nu).next((t=>be.resolve(this.Xi(t))))}Yi(e){return Up(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,Uw)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=bs(t,ch);return r.H().next((i=>{const o=this.ns(i,Uw),c=i.filter((u=>o.indexOf(u)===-1));return be.forEach(c,(u=>r.delete(u.clientId))).next((()=>c))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?be.resolve(!0):sm(e).get(Nu).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Bw)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new Le(Te.FAILED_PRECONDITION,zw);return!1}}return!(!this.networkEnabled||!this.inForeground)||Up(e).H().next((r=>this.ns(r,Bw).find((i=>{if(this.clientId!==i.clientId){const o=!this.networkEnabled&&i.networkEnabled,c=!this.inForeground&&i.inForeground,u=this.networkEnabled===i.networkEnabled;if(o||c&&u)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Fe(pl,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[Dg,ch],(e=>{const t=new $_(e,jr.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((r=>this.ts(r.updateTimeMs,t)&&!this.ss(r.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>Up(e).H().next((t=>this.ns(t,Uw).map((r=>r.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return Rb.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new cF(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return kb.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,r){Fe(pl,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",o=(function(h){return h===18?o8:h===17?vk:h===16?a8:h===15?_N:h===14?yk:h===13?bk:h===12?i8:h===11?xk:void et(60245)})(this.xi);let c;return this.qi.runTransaction(e,i,o,(u=>(c=new $_(u,this.ai?this.ai.next():jr.ce),t==="readwrite-primary"?this.ji(c).next((h=>!!h||this.Hi(c))).next((h=>{if(!h)throw Yn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new Le(Te.FAILED_PRECONDITION,ok);return r(c)})).next((h=>this.Zi(c).next((()=>h)))):this.Ps(c).next((()=>r(c)))))).then((u=>(c.raiseOnCommittedEvent(),u)))}Ps(e){return sm(e).get(Nu).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Bw)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Le(Te.FAILED_PRECONDITION,zw)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return sm(e).put(Nu,t)}static v(){return ka.v()}Ji(e){const t=sm(e);return t.get(Nu).next((r=>this.Xi(r)?(Fe(pl,"Releasing primary lease."),t.delete(Nu)):be.resolve()))}ts(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Yn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Oi=()=>{this._s();const t=/(?:Version|Mobile)\/1[456]/;R4()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){var t;try{const r=((t=this.Ui)==null?void 0:t.getItem(this.rs(e)))!==null;return Fe(pl,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Yn(pl,"Failed to get zombied client id.",r),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){Yn("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function sm(n){return bs(n,Dg)}function Up(n){return bs(n,ch)}function BN(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zN{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Ts=r,this.Is=i}static Es(e,t){let r=kt(),i=kt();for(const o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new zN(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TF{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return R4()?8:ck(Mn())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const o={result:null};return this.gs(e,t).next((c=>{o.result=c})).next((()=>{if(!o.result)return this.ps(e,t,i,r).next((c=>{o.result=c}))})).next((()=>{if(o.result)return;const c=new TF;return this.ys(e,t,c).next((u=>{if(o.result=u,this.As)return this.ws(e,t,c,u.size)}))})).next((()=>o.result))}ws(e,t,r,i){return r.documentReadCount<this.Vs?(Pu()<=Ot.DEBUG&&Fe("QueryEngine","SDK will not create cache indexes for query:",Ou(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),be.resolve()):(Pu()<=Ot.DEBUG&&Fe("QueryEngine","Query:",Ou(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(Pu()<=Ot.DEBUG&&Fe("QueryEngine","The SDK decides to create cache indexes for query:",Ou(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,lr(t))):be.resolve())}gs(e,t){if(mI(t))return be.resolve(null);let r=lr(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=Rx(t,null,"F"),r=lr(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((o=>{const c=kt(...o);return this.fs.getDocuments(e,c).next((u=>this.indexManager.getMinOffset(e,r).next((h=>{const m=this.bs(t,u);return this.Ss(t,m,c,h.readTime)?this.gs(e,Rx(t,null,"F")):this.Ds(e,m,t,h)}))))})))))}ps(e,t,r,i){return mI(t)||i.isEqual(lt.min())?be.resolve(null):this.fs.getDocuments(e,r).next((o=>{const c=this.bs(t,o);return this.Ss(t,c,r,i)?be.resolve(null):(Pu()<=Ot.DEBUG&&Fe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ou(t)),this.Ds(e,c,t,ik(i,ih)).next((u=>u)))}))}bs(e,t){let r=new dn(Bk(e));return t.forEach(((i,o)=>{Mg(e,o)&&(r=r.add(o))})),r}Ss(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ys(e,t,r){return Pu()<=Ot.DEBUG&&Fe("QueryEngine","Using full collection scan to execute query:",Ou(t)),this.fs.getDocumentsMatchingQuery(e,t,Xr.min(),r)}Ds(e,t,r,i){return this.fs.getDocumentsMatchingQuery(e,r,i).next((o=>(t.forEach((c=>{o=o.insert(c.key,c)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $N="LocalStore",IF=3e8;class CF{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.vs=new Ln(jt),this.Fs=new Ao((o=>ad(o)),Pg),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new CR(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function RR(n,e,t,r){return new CF(n,e,t,r)}async function DR(n,e){const t=Ye(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((o=>(i=o,t.Os(e),t.mutationQueue.getAllMutationBatches(r)))).next((o=>{const c=[],u=[];let h=kt();for(const m of i){c.push(m.batchId);for(const p of m.mutations)h=h.add(p.key)}for(const m of o){u.push(m.batchId);for(const p of m.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next((m=>({Ns:m,removedBatchIds:c,addedBatchIds:u})))}))}))}function AF(n,e){const t=Ye(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),o=t.xs.newChangeBuffer({trackRemovals:!0});return(function(u,h,m,p){const b=m.batch,v=b.keys();let _=be.resolve();return v.forEach((T=>{_=_.next((()=>p.getEntry(h,T))).next((k=>{const E=m.docVersions.get(T);it(E!==null,48541),k.version.compareTo(E)<0&&(b.applyToRemoteDocument(k,m),k.isValidDocument()&&(k.setReadTime(m.commitVersion),p.addEntry(k)))}))})),_.next((()=>u.mutationQueue.removeMutationBatch(h,b)))})(t,r,e,o).next((()=>o.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(u){let h=kt();for(let m=0;m<u.mutationResults.length;++m)u.mutationResults[m].transformResults.length>0&&(h=h.add(u.batch.mutations[m].key));return h})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function PR(n){const e=Ye(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function kF(n,e){const t=Ye(n),r=e.snapshotVersion;let i=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const c=t.xs.newChangeBuffer({trackRemovals:!0});i=t.vs;const u=[];e.targetChanges.forEach(((p,b)=>{const v=i.get(b);if(!v)return;u.push(t.li.removeMatchingKeys(o,p.removedDocuments,b).next((()=>t.li.addMatchingKeys(o,p.addedDocuments,b))));let _=v.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(b)!==null?_=_.withResumeToken(qn.EMPTY_BYTE_STRING,lt.min()).withLastLimboFreeSnapshotVersion(lt.min()):p.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(p.resumeToken,r)),i=i.insert(b,_),(function(k,E,S){return k.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=IF?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0})(v,_,p)&&u.push(t.li.updateTargetData(o,_))}));let h=Er(),m=kt();if(e.documentUpdates.forEach((p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(o,p))})),u.push(OR(o,c,e.documentUpdates).next((p=>{h=p.Bs,m=p.Ls}))),!r.isEqual(lt.min())){const p=t.li.getLastRemoteSnapshotVersion(o).next((b=>t.li.setTargetsMetadata(o,o.currentSequenceNumber,r)));u.push(p)}return be.waitFor(u).next((()=>c.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,h,m))).next((()=>h))})).then((o=>(t.vs=i,o)))}function OR(n,e,t){let r=kt(),i=kt();return t.forEach((o=>r=r.add(o))),e.getEntries(n,r).next((o=>{let c=Er();return t.forEach(((u,h)=>{const m=o.get(u);h.isFoundDocument()!==m.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(lt.min())?(e.removeEntry(u,h.readTime),c=c.insert(u,h)):!m.isValidDocument()||h.version.compareTo(m.version)>0||h.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(h),c=c.insert(u,h)):Fe($N,"Ignoring outdated watch update for ",u,". Current version:",m.version," Watch version:",h.version)})),{Bs:c,Ls:i}}))}function RF(n,e){const t=Ye(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Cl),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function ph(n,e){const t=Ye(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.li.getTargetData(r,e).next((o=>o?(i=o,be.resolve(i)):t.li.allocateTargetId(r).next((c=>(i=new mo(e,c,"TargetPurposeListen",r.currentSequenceNumber),t.li.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.vs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.vs=t.vs.insert(r.targetId,r),t.Fs.set(e,r.targetId)),r}))}async function xh(n,e,t){const r=Ye(n),i=r.vs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",o,(c=>r.persistence.referenceDelegate.removeTarget(c,i)))}catch(c){if(!ec(c))throw c;Fe($N,`Failed to update sequence numbers for target ${e}: ${c}`)}r.vs=r.vs.remove(e),r.Fs.delete(i.target)}function Lx(n,e,t){const r=Ye(n);let i=lt.min(),o=kt();return r.persistence.runTransaction("Execute query","readwrite",(c=>(function(h,m,p){const b=Ye(h),v=b.Fs.get(p);return v!==void 0?be.resolve(b.vs.get(v)):b.li.getTargetData(m,p)})(r,c,lr(e)).next((u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(c,u.targetId).next((h=>{o=h}))})).next((()=>r.Cs.getDocumentsMatchingQuery(c,e,t?i:lt.min(),t?o:kt()))).next((u=>(VR(r,Uk(e),u),{documents:u,ks:o})))))}function MR(n,e){const t=Ye(n),r=Ye(t.li),i=t.vs.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",(o=>r.At(o,e).next((c=>c?c.target:null))))}function LR(n,e){const t=Ye(n),r=t.Ms.get(e)||lt.min();return t.persistence.runTransaction("Get new document changes","readonly",(i=>t.xs.getAllFromCollectionGroup(i,e,ik(r,ih),Number.MAX_SAFE_INTEGER))).then((i=>(VR(t,e,i),i)))}function VR(n,e,t){let r=n.Ms.get(e)||lt.min();t.forEach(((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)})),n.Ms.set(e,r)}async function DF(n,e,t,r){const i=Ye(n);let o=kt(),c=Er();for(const m of t){const p=e.Ks(m.metadata.name);m.document&&(o=o.add(p));const b=e.qs(m);b.setReadTime(e.Us(m.metadata.readTime)),c=c.insert(p,b)}const u=i.xs.newChangeBuffer({trackRemovals:!0}),h=await ph(i,(function(p){return lr(Lh(Ft.fromString(`__bundle__/docs/${p}`)))})(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(m=>OR(m,u,c).next((p=>(u.apply(m),p))).next((p=>i.li.removeMatchingKeysForTargetId(m,h.targetId).next((()=>i.li.addMatchingKeys(m,o,h.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(m,p.Bs,p.Ls))).next((()=>p.Bs))))))}async function PF(n,e,t=kt()){const r=await ph(n,lr(ON(e.bundledQuery))),i=Ye(n);return i.persistence.runTransaction("Save named query","readwrite",(o=>{const c=Xn(e.readTime);if(r.snapshotVersion.compareTo(c)>=0)return i.Pi.saveNamedQuery(o,e);const u=r.withResumeToken(qn.EMPTY_BYTE_STRING,c);return i.vs=i.vs.insert(u.targetId,u),i.li.updateTargetData(o,u).next((()=>i.li.removeMatchingKeysForTargetId(o,r.targetId))).next((()=>i.li.addMatchingKeys(o,t,r.targetId))).next((()=>i.Pi.saveNamedQuery(o,e)))}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FR="firestore_clients";function HI(n,e){return`${FR}_${n}_${e}`}const UR="firestore_mutations";function GI(n,e,t){let r=`${UR}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const BR="firestore_targets";function $w(n,e){return`${BR}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a="SharedClientState";class Vx{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static $s(e,t,r){const i=JSON.parse(r);let o,c=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return c&&i.error&&(c=typeof i.error.message=="string"&&typeof i.error.code=="string",c&&(o=new Le(i.error.code,i.error.message))),c?new Vx(e,t,i.state,o):(Yn(_a,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Pm{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static $s(e,t){const r=JSON.parse(t);let i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new Le(r.error.code,r.error.message))),o?new Pm(e,r.state,i):(Yn(_a,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Fx{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const r=JSON.parse(t);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=TN();for(let c=0;i&&c<r.activeTargetIds.length;++c)i=dk(r.activeTargetIds[c]),o=o.add(r.activeTargetIds[c]);return i?new Fx(e,o):(Yn(_a,`Failed to parse client data for instance '${e}': ${t}`),null)}}class qN{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new qN(t.clientId,t.onlineState):(Yn(_a,`Failed to parse online state: ${e}`),null)}}class i1{constructor(){this.activeTargetIds=TN()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class qw{constructor(e,t,r,i,o){this.window=e,this.Ci=t,this.persistenceKey=r,this.zs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new Ln(jt),this.started=!1,this.Zs=[];const c=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Xs=HI(this.persistenceKey,this.zs),this.Ys=(function(h){return`firestore_sequence_number_${h}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new i1),this.eo=new RegExp(`^${FR}_${c}_([^_]*)$`),this.no=new RegExp(`^${UR}_${c}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${BR}_${c}_(\\d+)$`),this.io=(function(h){return`firestore_online_state_${h}`})(this.persistenceKey),this.so=(function(h){return`firestore_bundle_loaded_v2_${h}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const r of e){if(r===this.zs)continue;const i=this.getItem(HI(this.persistenceKey,r));if(i){const o=Fx.$s(r,i);o&&(this.Js=this.Js.insert(o.clientId,o))}}this.oo();const t=this.storage.getItem(this.io);if(t){const r=this._o(t);r&&this.ao(r)}for(const r of this.Zs)this.Hs(r);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,r){this.co(e,t,r),this.lo(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem($w(this.persistenceKey,e));if(i){const o=Pm.$s(e,i);o&&(r=o.state)}}return t&&this.ho.Qs(e),this.oo(),r}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem($w(this.persistenceKey,e))}updateQueryState(e,t,r){this.Po(e,t,r)}handleUserChange(e,t,r){t.forEach((i=>{this.lo(i)})),this.currentUser=e,r.forEach((i=>{this.addPendingMutation(i)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Fe(_a,"READ",e,t),t}setItem(e,t){Fe(_a,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Fe(_a,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(Fe(_a,"EVENT",t.key,t.newValue),t.key===this.Xs)return void Yn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const r=this.Eo(t.key);return this.Ro(r,null)}{const r=this.Ao(t.key,t.newValue);if(r)return this.Ro(r.clientId,r)}}else if(this.no.test(t.key)){if(t.newValue!==null){const r=this.Vo(t.key,t.newValue);if(r)return this.mo(r)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const r=this.fo(t.key,t.newValue);if(r)return this.po(r)}}else if(t.key===this.io){if(t.newValue!==null){const r=this._o(t.newValue);if(r)return this.ao(r)}}else if(t.key===this.Ys){const r=(function(o){let c=jr.ce;if(o!=null)try{const u=JSON.parse(o);it(typeof u=="number",30636,{yo:o}),c=u}catch(u){Yn(_a,"Failed to read sequence number from WebStorage",u)}return c})(t.newValue);r!==jr.ce&&this.sequenceNumberHandler(r)}else if(t.key===this.so){const r=this.wo(t.newValue);await Promise.all(r.map((i=>this.syncEngine.bo(i))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,r){const i=new Vx(this.currentUser,e,t,r),o=GI(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Ws())}lo(e){const t=GI(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,r){const i=$w(this.persistenceKey,e),o=new Pm(e,t,r);this.setItem(i,o.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const r=this.Eo(e);return Fx.$s(r,t)}Vo(e,t){const r=this.no.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return Vx.$s(new Es(o),i,t)}fo(e,t){const r=this.ro.exec(e),i=Number(r[1]);return Pm.$s(i,t)}_o(e){return qN.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);Fe(_a,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const r=t?this.Js.insert(e,t):this.Js.remove(e),i=this.uo(this.Js),o=this.uo(r),c=[],u=[];return o.forEach((h=>{i.has(h)||c.push(h)})),i.forEach((h=>{o.has(h)||u.push(h)})),this.syncEngine.Co(c,u).then((()=>{this.Js=r}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=TN();return e.forEach(((r,i)=>{t=t.unionWith(i.activeTargetIds)})),t}}class zR{constructor(){this.vo=new i1,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,r){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new i1,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OF{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI="ConnectivityMonitor";class KI{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Fe(WI,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Fe(WI,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bp=null;function a1(){return Bp===null?Bp=(function(){return 268435456+Math.round(2147483648*Math.random())})():Bp++,"0x"+Bp.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw="RestConnection",MF={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class LF{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.$o=this.databaseId.database===H_?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,o){const c=a1(),u=this.Qo(e,t.toUriEncodedString());Fe(Hw,`Sending RPC '${e}' ${c}:`,u,r);const h={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(h,i,o);const{host:m}=new URL(u),p=Ba(m);return this.zo(e,u,h,r,p).then((b=>(Fe(Hw,`Received RPC '${e}' ${c}: `,b),b)),(b=>{throw Ma(Hw,`RPC '${e}' ${c} failed with error: `,b,"url: ",u,"request:",r),b}))}jo(e,t,r,i,o,c){return this.Wo(e,t,r,i,o)}Go(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Mh})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,o)=>e[o]=i)),r&&r.headers.forEach(((i,o)=>e[o]=i))}Qo(e,t){const r=MF[e];let i=`${this.qo}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VF{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gs="WebChannelConnection",rm=(n,e,t)=>{n.listen(e,(r=>{try{t(r)}catch(i){setTimeout((()=>{throw i}),0)}}))};class zu extends LF{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!zu.c_){const e=X4();rm(e,Y4.STAT_EVENT,(t=>{t.stat===L_.PROXY?Fe(Gs,"STAT_EVENT: detected buffering proxy"):t.stat===L_.NOPROXY&&Fe(Gs,"STAT_EVENT: detected no buffering proxy")})),zu.c_=!0}}zo(e,t,r,i,o){const c=a1();return new Promise(((u,h)=>{const m=new K4;m.setWithCredentials(!0),m.listenOnce(Q4.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case ox.NO_ERROR:const b=m.getResponseJson();Fe(Gs,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(b)),u(b);break;case ox.TIMEOUT:Fe(Gs,`RPC '${e}' ${c} timed out`),h(new Le(Te.DEADLINE_EXCEEDED,"Request time out"));break;case ox.HTTP_ERROR:const v=m.getStatus();if(Fe(Gs,`RPC '${e}' ${c} failed with status:`,v,"response text:",m.getResponseText()),v>0){let _=m.getResponseJson();Array.isArray(_)&&(_=_[0]);const T=_==null?void 0:_.error;if(T&&T.status&&T.message){const k=(function(S){const L=S.toLowerCase().replace(/_/g,"-");return Object.values(Te).indexOf(L)>=0?L:Te.UNKNOWN})(T.status);h(new Le(k,T.message))}else h(new Le(Te.UNKNOWN,"Server responded with status "+m.getStatus()))}else h(new Le(Te.UNAVAILABLE,"Connection failed."));break;default:et(9055,{l_:e,streamId:c,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{Fe(Gs,`RPC '${e}' ${c} completed.`)}}));const p=JSON.stringify(i);Fe(Gs,`RPC '${e}' ${c} sending request:`,i),m.send(t,"POST",p,r,15)}))}T_(e,t,r){const i=a1(),o=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=this.createWebChannelTransport(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Go(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const m=o.join("");Fe(Gs,`Creating RPC '${e}' stream ${i}: ${m}`,u);const p=c.createWebChannel(m,u);this.I_(p);let b=!1,v=!1;const _=new VF({Ho:T=>{v?Fe(Gs,`Not sending because RPC '${e}' stream ${i} is closed:`,T):(b||(Fe(Gs,`Opening RPC '${e}' stream ${i} transport.`),p.open(),b=!0),Fe(Gs,`RPC '${e}' stream ${i} sending:`,T),p.send(T))},Jo:()=>p.close()});return rm(p,xm.EventType.OPEN,(()=>{v||(Fe(Gs,`RPC '${e}' stream ${i} transport opened.`),_.i_())})),rm(p,xm.EventType.CLOSE,(()=>{v||(v=!0,Fe(Gs,`RPC '${e}' stream ${i} transport closed`),_.o_(),this.E_(p))})),rm(p,xm.EventType.ERROR,(T=>{v||(v=!0,Ma(Gs,`RPC '${e}' stream ${i} transport errored. Name:`,T.name,"Message:",T.message),_.o_(new Le(Te.UNAVAILABLE,"The operation could not be completed")))})),rm(p,xm.EventType.MESSAGE,(T=>{var k;if(!v){const E=T.data[0];it(!!E,16349);const S=E,L=(S==null?void 0:S.error)||((k=S[0])==null?void 0:k.error);if(L){Fe(Gs,`RPC '${e}' stream ${i} received error:`,L);const $=L.status;let H=(function(P){const j=ls[P];if(j!==void 0)return eR(j)})($),G=L.message;H===void 0&&(H=Te.INTERNAL,G="Unknown error status: "+$+" with message "+L.message),v=!0,_.o_(new Le(H,G)),p.close()}else Fe(Gs,`RPC '${e}' stream ${i} received:`,E),_.__(E)}})),zu.u_(),setTimeout((()=>{_.s_()}),0),_}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,r){super.Go(e,t,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return J4()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FF(n){return new zu(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $R(){return typeof window<"u"?window:null}function xx(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(n){return new q8(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zu.c_=!1;class HN{constructor(e,t,r=1e3,i=1.5,o=6e4){this.Ci=e,this.timerId=t,this.R_=r,this.A_=i,this.V_=o,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Fe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QI="PersistentStream";class qR{constructor(e,t,r,i,o,c,u,h){this.Ci=e,this.b_=r,this.S_=i,this.connection=o,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new HN(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Te.RESOURCE_EXHAUSTED?(Yn(t.toString()),Yn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Te.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new Le(Te.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.Yo((()=>{r((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.H_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Fe(QI,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Fe(QI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class UF extends qR{constructor(e,t,r,i,o,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,c),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=W8(this.serializer,e),r=(function(o){if(!("targetChange"in o))return lt.min();const c=o.targetChange;return c.targetIds&&c.targetIds.length?lt.min():c.readTime?Xn(c.readTime):lt.min()})(e);return this.listener.J_(t,r)}Z_(e){const t={};t.database=e1(this.serializer),t.addTarget=(function(o,c){let u;const h=c.target;if(u=Ax(h)?{documents:dR(o,h)}:{query:uR(o,h).ft},u.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){u.resumeToken=rR(o,c.resumeToken);const m=J_(o,c.expectedCount);m!==null&&(u.expectedCount=m)}else if(c.snapshotVersion.compareTo(lt.min())>0){u.readTime=gh(o,c.snapshotVersion.toTimestamp());const m=J_(o,c.expectedCount);m!==null&&(u.expectedCount=m)}return u})(this.serializer,e);const r=Q8(this.serializer,e);r&&(t.labels=r),this.K_(t)}X_(e){const t={};t.database=e1(this.serializer),t.removeTarget=e,this.K_(t)}}class BF extends qR{constructor(e,t,r,i,o,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,c),this.serializer=o}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return it(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,it(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){it(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=K8(e.writeResults,e.commitTime),r=Xn(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=e1(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>lg(this.serializer,r)))};this.K_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF{}class $F extends zF{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Le(Te.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Wo(e,Z_(t,r),i,o,c))).catch((o=>{throw o.name==="FirebaseError"?(o.code===Te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Le(Te.UNKNOWN,o.toString())}))}jo(e,t,r,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,u])=>this.connection.jo(e,Z_(t,r),i,c,u,o))).catch((c=>{throw c.name==="FirebaseError"?(c.code===Te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Le(Te.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function qF(n,e,t,r){return new $F(n,e,t,r)}class HF{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Yn(t),this.aa=!1):Fe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hd="RemoteStore";class GF{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=o,this.Aa.Mo((c=>{r.enqueueAndForget((async()=>{nc(this)&&(Fe(hd,"Restarting streams for network reachability change."),await(async function(h){const m=Ye(h);m.Ea.add(4),await Uh(m),m.Va.set("Unknown"),m.Ea.delete(4),await Bg(m)})(this))}))})),this.Va=new HF(r,i)}}async function Bg(n){if(nc(n))for(const e of n.Ra)await e(!0)}async function Uh(n){for(const e of n.Ra)await e(!1)}function Pb(n,e){const t=Ye(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),KN(t)?WN(t):zh(t).O_()&&GN(t,e))}function bh(n,e){const t=Ye(n),r=zh(t);t.Ia.delete(e),r.O_()&&HR(t,e),t.Ia.size===0&&(r.O_()?r.L_():nc(t)&&t.Va.set("Unknown"))}function GN(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(lt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}zh(n).Z_(e)}function HR(n,e){n.da.$e(e),zh(n).X_(e)}function WN(n){n.da=new U8({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),zh(n).start(),n.Va.ua()}function KN(n){return nc(n)&&!zh(n).x_()&&n.Ia.size>0}function nc(n){return Ye(n).Ea.size===0}function GR(n){n.da=void 0}async function WF(n){n.Va.set("Online")}async function KF(n){n.Ia.forEach(((e,t)=>{GN(n,e)}))}async function QF(n,e){GR(n),KN(n)?(n.Va.ha(e),WN(n)):n.Va.set("Unknown")}async function YF(n,e,t){if(n.Va.set("Online"),e instanceof sR&&e.state===2&&e.cause)try{await(async function(i,o){const c=o.cause;for(const u of o.targetIds)i.Ia.has(u)&&(await i.remoteSyncer.rejectListen(u,c),i.Ia.delete(u),i.da.removeTarget(u))})(n,e)}catch(r){Fe(hd,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ux(n,r)}else if(e instanceof gx?n.da.Xe(e):e instanceof nR?n.da.st(e):n.da.tt(e),!t.isEqual(lt.min()))try{const r=await PR(n.localStore);t.compareTo(r)>=0&&await(function(o,c){const u=o.da.Tt(c);return u.targetChanges.forEach(((h,m)=>{if(h.resumeToken.approximateByteSize()>0){const p=o.Ia.get(m);p&&o.Ia.set(m,p.withResumeToken(h.resumeToken,c))}})),u.targetMismatches.forEach(((h,m)=>{const p=o.Ia.get(h);if(!p)return;o.Ia.set(h,p.withResumeToken(qn.EMPTY_BYTE_STRING,p.snapshotVersion)),HR(o,h);const b=new mo(p.target,h,m,p.sequenceNumber);GN(o,b)})),o.remoteSyncer.applyRemoteEvent(u)})(n,t)}catch(r){Fe(hd,"Failed to raise snapshot:",r),await Ux(n,r)}}async function Ux(n,e,t){if(!ec(e))throw e;n.Ea.add(1),await Uh(n),n.Va.set("Offline"),t||(t=()=>PR(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Fe(hd,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Bg(n)}))}function WR(n,e){return e().catch((t=>Ux(n,t,e)))}async function Bh(n){const e=Ye(n),t=ql(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Cl;for(;XF(e);)try{const i=await RF(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,JF(e,i)}catch(i){await Ux(e,i)}KR(e)&&QR(e)}function XF(n){return nc(n)&&n.Ta.length<10}function JF(n,e){n.Ta.push(e);const t=ql(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function KR(n){return nc(n)&&!ql(n).x_()&&n.Ta.length>0}function QR(n){ql(n).start()}async function ZF(n){ql(n).ra()}async function e7(n){const e=ql(n);for(const t of n.Ta)e.ea(t.mutations)}async function t7(n,e,t){const r=n.Ta.shift(),i=kN.from(r,e,t);await WR(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await Bh(n)}async function n7(n,e){e&&ql(n).Y_&&await(async function(r,i){if((function(c){return Zk(c)&&c!==Te.ABORTED})(i.code)){const o=r.Ta.shift();ql(r).B_(),await WR(r,(()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i))),await Bh(r)}})(n,e),KR(n)&&QR(n)}async function YI(n,e){const t=Ye(n);t.asyncQueue.verifyOperationInProgress(),Fe(hd,"RemoteStore received new credentials");const r=nc(t);t.Ea.add(3),await Uh(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Bg(t)}async function o1(n,e){const t=Ye(n);e?(t.Ea.delete(2),await Bg(t)):e||(t.Ea.add(2),await Uh(t),t.Va.set("Unknown"))}function zh(n){return n.ma||(n.ma=(function(t,r,i){const o=Ye(t);return o.sa(),new UF(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Zo:WF.bind(null,n),Yo:KF.bind(null,n),t_:QF.bind(null,n),J_:YF.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),KN(n)?WN(n):n.Va.set("Unknown")):(await n.ma.stop(),GR(n))}))),n.ma}function ql(n){return n.fa||(n.fa=(function(t,r,i){const o=Ye(t);return o.sa(),new BF(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:ZF.bind(null,n),t_:n7.bind(null,n),ta:e7.bind(null,n),na:t7.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await Bh(n)):(await n.fa.stop(),n.Ta.length>0&&(Fe(hd,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Bs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){const c=Date.now()+r,u=new QN(e,t,c,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Le(Te.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function $h(n,e){if(Yn("AsyncQueue",`${e}: ${n}`),ec(n))return new Le(Te.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{static emptySet(e){return new $u(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Qe.comparator(t.key,r.key):(t,r)=>Qe.comparator(t.key,r.key),this.keyedMap=bm(),this.sortedSet=new Ln(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof $u)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new $u;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(){this.ga=new Ln(Qe.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):et(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class yh{constructor(e,t,r,i,o,c,u,h,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=c,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=m}static fromInitialDocuments(e,t,r,i,o){const c=[];return t.forEach((u=>{c.push({type:0,doc:u})})),new yh(e,t,$u.emptySet(t),c,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Og(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s7{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class r7{constructor(){this.queries=JI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=Ye(t),o=i.queries;i.queries=JI(),o.forEach(((c,u)=>{for(const h of u.ba)h.onError(r)}))})(this,new Le(Te.ABORTED,"Firestore shutting down"))}}function JI(){return new Ao((n=>Fk(n)),Og)}async function YN(n,e){const t=Ye(n);let r=3;const i=e.query;let o=t.queries.get(i);o?!o.Sa()&&e.Da()&&(r=2):(o=new s7,r=e.Da()?0:1);try{switch(r){case 0:o.wa=await t.onListen(i,!0);break;case 1:o.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(c){const u=$h(c,`Initialization of query '${Ou(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,o),o.ba.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&JN(t)}async function XN(n,e){const t=Ye(n),r=e.query;let i=3;const o=t.queries.get(r);if(o){const c=o.ba.indexOf(e);c>=0&&(o.ba.splice(c,1),o.ba.length===0?i=e.Da()?0:1:!o.Sa()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function i7(n,e){const t=Ye(n);let r=!1;for(const i of e){const o=i.query,c=t.queries.get(o);if(c){for(const u of c.ba)u.Fa(i)&&(r=!0);c.wa=i}}r&&JN(t)}function a7(n,e,t){const r=Ye(n),i=r.queries.get(e);if(i)for(const o of i.ba)o.onError(t);r.queries.delete(e)}function JN(n){n.Ca.forEach((e=>{e.next()}))}var l1,ZI;(ZI=l1||(l1={})).Ma="default",ZI.Cache="cache";class ZN{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new yh(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=yh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==l1.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o7{constructor(e,t){this.qa=e,this.byteLength=t}Ua(){return"metadata"in this.qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e){this.serializer=e}Ks(e){return Ra(this.serializer,e)}qs(e){return e.metadata.exists?cR(this.serializer,e.document,!1):Nn.newNoDocument(this.Ks(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return Xn(e)}}class l7{constructor(e,t){this.$a=e,this.serializer=t,this.Wa=[],this.Qa=[],this.collectionGroups=new Set,this.progress=YR(e)}get queries(){return this.Wa}get documents(){return this.Qa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Wa.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Qa.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;const r=Ft.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.qa.document&&(this.Qa[this.Qa.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,r=new eC(this.serializer);for(const i of e)if(i.metadata.queries){const o=r.Ks(i.metadata.name);for(const c of i.metadata.queries){const u=(t.get(c)||kt()).add(o);t.set(c,u)}}return t}async ja(e){const t=await DF(e,new eC(this.serializer),this.Qa,this.$a.id),r=this.za(this.documents);for(const i of this.Wa)await PF(e,i,r.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Ha:this.collectionGroups,Ja:t}}}function YR(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(e){this.key=e}}class JR{constructor(e){this.key=e}}class ZR{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=kt(),this.mutatedKeys=kt(),this.eu=Bk(e),this.tu=new $u(this.eu)}get nu(){return this.Za}ru(e,t){const r=t?t.iu:new XI,i=t?t.tu:this.tu;let o=t?t.mutatedKeys:this.mutatedKeys,c=i,u=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,m=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((p,b)=>{const v=i.get(p),_=Mg(this.query,b)?b:null,T=!!v&&this.mutatedKeys.has(v.key),k=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let E=!1;v&&_?v.data.isEqual(_.data)?T!==k&&(r.track({type:3,doc:_}),E=!0):this.su(v,_)||(r.track({type:2,doc:_}),E=!0,(h&&this.eu(_,h)>0||m&&this.eu(_,m)<0)&&(u=!0)):!v&&_?(r.track({type:0,doc:_}),E=!0):v&&!_&&(r.track({type:1,doc:v}),E=!0,(h||m)&&(u=!0)),E&&(_?(c=c.add(_),o=k?o.add(p):o.delete(p)):(c=c.delete(p),o=o.delete(p)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const p=this.query.limitType==="F"?c.last():c.first();c=c.delete(p.key),o=o.delete(p.key),r.track({type:1,doc:p})}return{tu:c,iu:r,Ss:u,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((p,b)=>(function(_,T){const k=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return et(20277,{Vt:E})}};return k(_)-k(T)})(p.type,b.type)||this.eu(p.doc,b.doc))),this.ou(r),i=i??!1;const u=t&&!i?this._u():[],h=this.Ya.size===0&&this.current&&!i?1:0,m=h!==this.Xa;return this.Xa=h,c.length!==0||m?{snapshot:new yh(this.query,e.tu,o,c,e.mutatedKeys,h===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new XI,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=kt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))}));const t=[];return e.forEach((r=>{this.Ya.has(r)||t.push(new JR(r))})),this.Ya.forEach((r=>{e.has(r)||t.push(new XR(r))})),t}cu(e){this.Za=e.ks,this.Ya=kt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return yh.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const sc="SyncEngine";class c7{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class d7{constructor(e){this.key=e,this.hu=!1}}class u7{constructor(e,t,r,i,o,c){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new Ao((u=>Fk(u)),Og),this.Iu=new Map,this.Eu=new Set,this.Ru=new Ln(Qe.comparator),this.Au=new Map,this.Vu=new VN,this.du={},this.mu=new Map,this.fu=ud.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function h7(n,e,t=!0){const r=Ob(n);let i;const o=r.Tu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await e3(r,e,t,!0),i}async function f7(n,e){const t=Ob(n);await e3(t,e,!0,!1)}async function e3(n,e,t,r){const i=await ph(n.localStore,lr(e)),o=i.targetId,c=n.sharedClientState.addLocalQueryTarget(o,t);let u;return r&&(u=await e2(n,e,o,c==="current",i.resumeToken)),n.isPrimaryClient&&t&&Pb(n.remoteStore,i),u}async function e2(n,e,t,r,i){n.pu=(b,v,_)=>(async function(k,E,S,L){let $=E.view.ru(S);$.Ss&&($=await Lx(k.localStore,E.query,!1).then((({documents:P})=>E.view.ru(P,$))));const H=L&&L.targetChanges.get(E.targetId),G=L&&L.targetMismatches.get(E.targetId)!=null,z=E.view.applyChanges($,k.isPrimaryClient,H,G);return c1(k,E.targetId,z.au),z.snapshot})(n,b,v,_);const o=await Lx(n.localStore,e,!0),c=new ZR(e,o.ks),u=c.ru(o.documents),h=Fg.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),m=c.applyChanges(u,n.isPrimaryClient,h);c1(n,t,m.au);const p=new c7(e,t,c);return n.Tu.set(e,p),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),m.snapshot}async function m7(n,e,t){const r=Ye(n),i=r.Tu.get(e),o=r.Iu.get(i.targetId);if(o.length>1)return r.Iu.set(i.targetId,o.filter((c=>!Og(c,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await xh(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&bh(r.remoteStore,i.targetId),vh(r,i.targetId)})).catch(Zl)):(vh(r,i.targetId),await xh(r.localStore,i.targetId,!0))}async function g7(n,e){const t=Ye(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),bh(t.remoteStore,r.targetId))}async function p7(n,e,t){const r=r2(n);try{const i=await(function(c,u){const h=Ye(c),m=tn.now(),p=u.reduce(((_,T)=>_.add(T.key)),kt());let b,v;return h.persistence.runTransaction("Locally write mutations","readwrite",(_=>{let T=Er(),k=kt();return h.xs.getEntries(_,p).next((E=>{T=E,T.forEach(((S,L)=>{L.isValidDocument()||(k=k.add(S))}))})).next((()=>h.localDocuments.getOverlayedDocuments(_,T))).next((E=>{b=E;const S=[];for(const L of u){const $=L8(L,b.get(L.key).overlayedDocument);$!=null&&S.push(new ko(L.key,$,Ak($.value.mapValue),An.exists(!0)))}return h.mutationQueue.addMutationBatch(_,m,S,u)})).next((E=>{v=E;const S=E.applyToLocalDocumentSet(b,k);return h.documentOverlayCache.saveOverlays(_,E.batchId,S)}))})).then((()=>({batchId:v.batchId,changes:$k(b)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(c,u,h){let m=c.du[c.currentUser.toKey()];m||(m=new Ln(jt)),m=m.insert(u,h),c.du[c.currentUser.toKey()]=m})(r,i.batchId,t),await Ro(r,i.changes),await Bh(r.remoteStore)}catch(i){const o=$h(i,"Failed to persist write");t.reject(o)}}async function t3(n,e){const t=Ye(n);try{const r=await kF(t.localStore,e);e.targetChanges.forEach(((i,o)=>{const c=t.Au.get(o);c&&(it(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?c.hu=!0:i.modifiedDocuments.size>0?it(c.hu,14607):i.removedDocuments.size>0&&(it(c.hu,42227),c.hu=!1))})),await Ro(t,r,e)}catch(r){await Zl(r)}}function tC(n,e,t){const r=Ye(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((o,c)=>{const u=c.view.va(e);u.snapshot&&i.push(u.snapshot)})),(function(c,u){const h=Ye(c);h.onlineState=u;let m=!1;h.queries.forEach(((p,b)=>{for(const v of b.ba)v.va(u)&&(m=!0)})),m&&JN(h)})(r.eventManager,e),i.length&&r.Pu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function x7(n,e,t){const r=Ye(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),o=i&&i.key;if(o){let c=new Ln(Qe.comparator);c=c.insert(o,Nn.newNoDocument(o,lt.min()));const u=kt().add(o),h=new Vg(lt.min(),new Map,new Ln(jt),c,u);await t3(r,h),r.Ru=r.Ru.remove(o),r.Au.delete(e),s2(r)}else await xh(r.localStore,e,!1).then((()=>vh(r,e,t))).catch(Zl)}async function b7(n,e){const t=Ye(n),r=e.batch.batchId;try{const i=await AF(t.localStore,e);n2(t,r,null),t2(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Ro(t,i)}catch(i){await Zl(i)}}async function y7(n,e,t){const r=Ye(n);try{const i=await(function(c,u){const h=Ye(c);return h.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let p;return h.mutationQueue.lookupMutationBatch(m,u).next((b=>(it(b!==null,37113),p=b.keys(),h.mutationQueue.removeMutationBatch(m,b)))).next((()=>h.mutationQueue.performConsistencyCheck(m))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(m,p,u))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,p))).next((()=>h.localDocuments.getDocuments(m,p)))}))})(r.localStore,e);n2(r,e,t),t2(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Ro(r,i)}catch(i){await Zl(i)}}async function v7(n,e){const t=Ye(n);nc(t.remoteStore)||Fe(sc,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await(function(c){const u=Ye(c);return u.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(h=>u.mutationQueue.getHighestUnacknowledgedBatchId(h)))})(t.localStore);if(r===Cl)return void e.resolve();const i=t.mu.get(r)||[];i.push(e),t.mu.set(r,i)}catch(r){const i=$h(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function t2(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function n2(n,e,t){const r=Ye(n);let i=r.du[r.currentUser.toKey()];if(i){const o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.du[r.currentUser.toKey()]=i}}function vh(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((r=>{n.Vu.containsKey(r)||n3(n,r)}))}function n3(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(bh(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),s2(n))}function c1(n,e,t){for(const r of t)r instanceof XR?(n.Vu.addReference(r.key,e),w7(n,r)):r instanceof JR?(Fe(sc,"Document no longer in limbo: "+r.key),n.Vu.removeReference(r.key,e),n.Vu.containsKey(r.key)||n3(n,r.key)):et(19791,{wu:r})}function w7(n,e){const t=e.key,r=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(r)||(Fe(sc,"New document in limbo: "+t),n.Eu.add(r),s2(n))}function s2(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Qe(Ft.fromString(e)),r=n.fu.next();n.Au.set(r,new d7(t)),n.Ru=n.Ru.insert(t,r),Pb(n.remoteStore,new mo(lr(Lh(t.path)),r,"TargetPurposeLimboResolution",jr.ce))}}async function Ro(n,e,t){const r=Ye(n),i=[],o=[],c=[];r.Tu.isEmpty()||(r.Tu.forEach(((u,h)=>{c.push(r.pu(h,e,t).then((m=>{var p;if((m||t)&&r.isPrimaryClient){const b=m?!m.fromCache:(p=t==null?void 0:t.targetChanges.get(h.targetId))==null?void 0:p.current;r.sharedClientState.updateQueryState(h.targetId,b?"current":"not-current")}if(m){i.push(m);const b=zN.Es(h.targetId,m);o.push(b)}})))})),await Promise.all(c),r.Pu.J_(i),await(async function(h,m){const p=Ye(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(b=>be.forEach(m,(v=>be.forEach(v.Ts,(_=>p.persistence.referenceDelegate.addReference(b,v.targetId,_))).next((()=>be.forEach(v.Is,(_=>p.persistence.referenceDelegate.removeReference(b,v.targetId,_)))))))))}catch(b){if(!ec(b))throw b;Fe($N,"Failed to update sequence numbers: "+b)}for(const b of m){const v=b.targetId;if(!b.fromCache){const _=p.vs.get(v),T=_.snapshotVersion,k=_.withLastLimboFreeSnapshotVersion(T);p.vs=p.vs.insert(v,k)}}})(r.localStore,o))}async function _7(n,e){const t=Ye(n);if(!t.currentUser.isEqual(e)){Fe(sc,"User change. New user:",e.toKey());const r=await DR(t.localStore,e);t.currentUser=e,(function(o,c){o.mu.forEach((u=>{u.forEach((h=>{h.reject(new Le(Te.CANCELLED,c))}))})),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ro(t,r.Ns)}}function N7(n,e){const t=Ye(n),r=t.Au.get(e);if(r&&r.hu)return kt().add(r.key);{let i=kt();const o=t.Iu.get(e);if(!o)return i;for(const c of o){const u=t.Tu.get(c);i=i.unionWith(u.view.nu)}return i}}async function j7(n,e){const t=Ye(n),r=await Lx(t.localStore,e.query,!0),i=e.view.cu(r);return t.isPrimaryClient&&c1(t,e.targetId,i.au),i}async function S7(n,e){const t=Ye(n);return LR(t.localStore,e).then((r=>Ro(t,r)))}async function E7(n,e,t,r){const i=Ye(n),o=await(function(u,h){const m=Ye(u),p=Ye(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",(b=>p.Xn(b,h).next((v=>v?m.localDocuments.getDocuments(b,v):be.resolve(null)))))})(i.localStore,e);o!==null?(t==="pending"?await Bh(i.remoteStore):t==="acknowledged"||t==="rejected"?(n2(i,e,r||null),t2(i,e),(function(u,h){Ye(Ye(u).mutationQueue).nr(h)})(i.localStore,e)):et(6720,"Unknown batchState",{bu:t}),await Ro(i,o)):Fe(sc,"Cannot apply mutation batch with id: "+e)}async function T7(n,e){const t=Ye(n);if(Ob(t),r2(t),e===!0&&t.gu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),i=await nC(t,r.toArray());t.gu=!0,await o1(t.remoteStore,!0);for(const o of i)Pb(t.remoteStore,o)}else if(e===!1&&t.gu!==!1){const r=[];let i=Promise.resolve();t.Iu.forEach(((o,c)=>{t.sharedClientState.isLocalQueryTarget(c)?r.push(c):i=i.then((()=>(vh(t,c),xh(t.localStore,c,!0)))),bh(t.remoteStore,c)})),await i,await nC(t,r),(function(c){const u=Ye(c);u.Au.forEach(((h,m)=>{bh(u.remoteStore,m)})),u.Vu.zr(),u.Au=new Map,u.Ru=new Ln(Qe.comparator)})(t),t.gu=!1,await o1(t.remoteStore,!1)}}async function nC(n,e,t){const r=Ye(n),i=[],o=[];for(const c of e){let u;const h=r.Iu.get(c);if(h&&h.length!==0){u=await ph(r.localStore,lr(h[0]));for(const m of h){const p=r.Tu.get(m),b=await j7(r,p);b.snapshot&&o.push(b.snapshot)}}else{const m=await MR(r.localStore,c);u=await ph(r.localStore,m),await e2(r,s3(m),c,!1,u.resumeToken)}i.push(u)}return r.Pu.J_(o),i}function s3(n){return Vk(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function I7(n){return(function(t){return Ye(Ye(t).persistence).hs()})(Ye(n).localStore)}async function C7(n,e,t,r){const i=Ye(n);if(i.gu)return void Fe(sc,"Ignoring unexpected query state notification.");const o=i.Iu.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{const c=await LR(i.localStore,Uk(o[0])),u=Vg.createSynthesizedRemoteEventForCurrentChange(e,t==="current",qn.EMPTY_BYTE_STRING);await Ro(i,c,u);break}case"rejected":await xh(i.localStore,e,!0),vh(i,e,r);break;default:et(64155,t)}}async function A7(n,e,t){const r=Ob(n);if(r.gu){for(const i of e){if(r.Iu.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){Fe(sc,"Adding an already active target "+i);continue}const o=await MR(r.localStore,i),c=await ph(r.localStore,o);await e2(r,s3(o),c.targetId,!1,c.resumeToken),Pb(r.remoteStore,c)}for(const i of t)r.Iu.has(i)&&await xh(r.localStore,i,!1).then((()=>{bh(r.remoteStore,i),vh(r,i)})).catch(Zl)}}function Ob(n){const e=Ye(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=t3.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=N7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=x7.bind(null,e),e.Pu.J_=i7.bind(null,e.eventManager),e.Pu.yu=a7.bind(null,e.eventManager),e}function r2(n){const e=Ye(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=b7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=y7.bind(null,e),e}function k7(n,e,t){const r=Ye(n);(async function(o,c,u){try{const h=await c.getMetadata();if(await(function(_,T){const k=Ye(_),E=Xn(T.createTime);return k.persistence.runTransaction("hasNewerBundle","readonly",(S=>k.Pi.getBundleMetadata(S,T.id))).then((S=>!!S&&S.createTime.compareTo(E)>=0))})(o.localStore,h))return await c.close(),u._completeWith((function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}})(h)),Promise.resolve(new Set);u._updateProgress(YR(h));const m=new l7(h,c.serializer);let p=await c.Su();for(;p;){const v=await m.Ga(p);v&&u._updateProgress(v),p=await c.Su()}const b=await m.ja(o.localStore);return await Ro(o,b.Ja,void 0),await(function(_,T){const k=Ye(_);return k.persistence.runTransaction("Save bundle","readwrite",(E=>k.Pi.saveBundleMetadata(E,T)))})(o.localStore,h),u._completeWith(b.progress),Promise.resolve(b.Ha)}catch(h){return Ma(sc,`Loading bundle failed with ${h}`),u._failWith(h),Promise.resolve(new Set)}})(r,e,t).then((i=>{r.sharedClientState.notifyBundleLoaded(i)}))}class cg{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ug(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return RR(this.persistence,new kR,e.initialUser,this.serializer)}Cu(e){return new FN(Db.Vi,this.serializer)}Du(e){return new zR}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}cg.provider={build:()=>new cg};class R7 extends cg{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){it(this.persistence.referenceDelegate instanceof Mx,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new SR(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Ws.withCacheSize(this.cacheSizeBytes):Ws.DEFAULT;return new FN((r=>Mx.Vi(r,t)),this.serializer)}}class r3 extends cg{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await r2(this.xu.syncEngine),await Bh(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return RR(this.persistence,new kR,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new SR(r,e.asyncQueue,t)}Mu(e,t){const r=new O9(t,this.persistence);return new P9(e.asyncQueue,r)}Cu(e){const t=BN(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Ws.withCacheSize(this.cacheSizeBytes):Ws.DEFAULT;return new UN(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,$R(),xx(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new zR}}class D7 extends r3{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof qw&&(this.sharedClientState.syncEngine={So:E7.bind(null,t),Do:C7.bind(null,t),Co:A7.bind(null,t),hs:I7.bind(null,t),bo:S7.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async r=>{await T7(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Du(e){const t=$R();if(!qw.v(t))throw new Le(Te.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=BN(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new qw(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class dg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>tC(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=_7.bind(null,this.syncEngine),await o1(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new r7})()}createDatastore(e){const t=Ug(e.databaseInfo.databaseId),r=FF(e.databaseInfo);return qF(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,o,c,u){return new GF(r,i,o,c,u)})(this.localStore,this.datastore,e.asyncQueue,(t=>tC(this.syncEngine,t,0)),(function(){return KI.v()?new KI:new OF})())}createSyncEngine(e,t){return(function(i,o,c,u,h,m,p){const b=new u7(i,o,c,u,h,m);return p&&(b.gu=!0),b})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(i){const o=Ye(i);Fe(hd,"RemoteStore shutting down."),o.Ea.add(5),await Uh(o),o.Aa.shutdown(),o.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}dg.provider={build:()=>new dg};function sC(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Yn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P7{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new Bs,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((r=>{r&&r.Ua()?this.metadata.resolve(r.qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.qa)}`))}),(r=>this.metadata.reject(r)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.Ku();if(e===null)return null;const t=this.Lu.decode(e),r=Number(t);isNaN(r)&&this.qu(`length string (${t}) is not valid number`);const i=await this.Uu(r);return new o7(JSON.parse(i),e.length+r)}$u(){return this.buffer.findIndex((e=>e===123))}async Ku(){for(;this.$u()<0&&!await this.Wu(););if(this.buffer.length===0)return null;const e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Uu(e){for(;this.buffer.length<e;)await this.Wu()&&this.qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Wu(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let O7=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Le(Te.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(i,o){const c=Ye(i),u={documents:o.map((b=>og(c.serializer,b)))},h=await c.jo("BatchGetDocuments",c.serializer.databaseId,Ft.emptyPath(),u,o.length),m=new Map;h.forEach((b=>{const v=G8(c.serializer,b);m.set(v.key.toString(),v)}));const p=[];return o.forEach((b=>{const v=m.get(b.toString());it(!!v,55234,{key:b}),p.push(v)})),p})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Fh(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{const i=Qe.fromPath(r);this.mutations.push(new CN(i,this.precondition(i)))})),await(async function(r,i){const o=Ye(r),c={writes:i.map((u=>lg(o.serializer,u)))};await o.Wo("Commit",o.serializer.databaseId,Ft.emptyPath(),c)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw et(50498,{Gu:e.constructor.name});t=lt.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Le(Te.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(lt.min())?An.exists(!1):An.updateTime(t):An.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(lt.min()))throw new Le(Te.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return An.updateTime(t)}return An.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M7{constructor(e,t,r,i,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=o,this.zu=r.maxAttempts,this.M_=new HN(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_((async()=>{const e=new O7(this.datastore),t=this.Ju(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((i=>{this.Zu(i)}))))})).catch((r=>{this.Zu(r)}))}))}Ju(e){try{const t=this.updateFunction(e);return!Rg(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Hu(),Promise.resolve())))):this.deferred.reject(e)}Xu(e){if((e==null?void 0:e.name)==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Zk(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hl="FirestoreClient";class L7{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this._databaseInfo=i,this.user=Es.UNAUTHENTICATED,this.clientId=gN.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,(async c=>{Fe(Hl,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(r,(c=>(Fe(Hl,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Bs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=$h(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Gw(n,e){n.asyncQueue.verifyOperationInProgress(),Fe(Hl,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await DR(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function rC(n,e){n.asyncQueue.verifyOperationInProgress();const t=await i2(n);Fe(Hl,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>YI(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>YI(e.remoteStore,i))),n._onlineComponents=e}async function i2(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Fe(Hl,"Using user provided OfflineComponentProvider");try{await Gw(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===Te.FAILED_PRECONDITION||i.code===Te.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Ma("Error using user provided cache. Falling back to memory cache: "+t),await Gw(n,new cg)}}else Fe(Hl,"Using default OfflineComponentProvider"),await Gw(n,new R7(void 0));return n._offlineComponents}async function Lb(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Fe(Hl,"Using user provided OnlineComponentProvider"),await rC(n,n._uninitializedComponentsProvider._online)):(Fe(Hl,"Using default OnlineComponentProvider"),await rC(n,new dg))),n._onlineComponents}function i3(n){return i2(n).then((e=>e.persistence))}function a2(n){return i2(n).then((e=>e.localStore))}function a3(n){return Lb(n).then((e=>e.remoteStore))}function o2(n){return Lb(n).then((e=>e.syncEngine))}function V7(n){return Lb(n).then((e=>e.datastore))}async function wh(n){const e=await Lb(n),t=e.eventManager;return t.onListen=h7.bind(null,e.syncEngine),t.onUnlisten=m7.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=f7.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=g7.bind(null,e.syncEngine),t}function F7(n){return n.asyncQueue.enqueue((async()=>{const e=await i3(n),t=await a3(n);return e.setNetworkEnabled(!0),(function(i){const o=Ye(i);return o.Ea.delete(0),Bg(o)})(t)}))}function U7(n){return n.asyncQueue.enqueue((async()=>{const e=await i3(n),t=await a3(n);return e.setNetworkEnabled(!1),(async function(i){const o=Ye(i);o.Ea.add(0),await Uh(o),o.Va.set("Offline")})(t)}))}function B7(n,e,t,r){const i=new Mb(r),o=new ZN(e,i,t);return n.asyncQueue.enqueueAndForget((async()=>YN(await wh(n),o))),()=>{i.Nu(),n.asyncQueue.enqueueAndForget((async()=>XN(await wh(n),o)))}}function z7(n,e){const t=new Bs;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,o,c){try{const u=await(function(m,p){const b=Ye(m);return b.persistence.runTransaction("read document","readonly",(v=>b.localDocuments.getDocument(v,p)))})(i,o);u.isFoundDocument()?c.resolve(u):u.isNoDocument()?c.resolve(null):c.reject(new Le(Te.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){const h=$h(u,`Failed to get document '${o} from cache`);c.reject(h)}})(await a2(n),e,t))),t.promise}function o3(n,e,t={}){const r=new Bs;return n.asyncQueue.enqueueAndForget((async()=>(function(o,c,u,h,m){const p=new Mb({next:v=>{p.Nu(),c.enqueueAndForget((()=>XN(o,b)));const _=v.docs.has(u);!_&&v.fromCache?m.reject(new Le(Te.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&v.fromCache&&h&&h.source==="server"?m.reject(new Le(Te.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(v)},error:v=>m.reject(v)}),b=new ZN(Lh(u.path),p,{includeMetadataChanges:!0,Ka:!0});return YN(o,b)})(await wh(n),n.asyncQueue,e,t,r))),r.promise}function $7(n,e){const t=new Bs;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,o,c){try{const u=await Lx(i,o,!0),h=new ZR(o,u.ks),m=h.ru(u.documents),p=h.applyChanges(m,!1);c.resolve(p.snapshot)}catch(u){const h=$h(u,`Failed to execute query '${o} against cache`);c.reject(h)}})(await a2(n),e,t))),t.promise}function l3(n,e,t={}){const r=new Bs;return n.asyncQueue.enqueueAndForget((async()=>(function(o,c,u,h,m){const p=new Mb({next:v=>{p.Nu(),c.enqueueAndForget((()=>XN(o,b))),v.fromCache&&h.source==="server"?m.reject(new Le(Te.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(v)},error:v=>m.reject(v)}),b=new ZN(u,p,{includeMetadataChanges:!0,Ka:!0});return YN(o,b)})(await wh(n),n.asyncQueue,e,t,r))),r.promise}function q7(n,e){const t=new Bs;return n.asyncQueue.enqueueAndForget((async()=>p7(await o2(n),e,t))),t.promise}function H7(n,e){const t=new Mb(e);return n.asyncQueue.enqueueAndForget((async()=>(function(i,o){Ye(i).Ca.add(o),o.next()})(await wh(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(i,o){Ye(i).Ca.delete(o)})(await wh(n),t)))}}function G7(n,e,t){const r=new Bs;return n.asyncQueue.enqueueAndForget((async()=>{const i=await V7(n);new M7(n.asyncQueue,i,t,e,r).ju()})),r.promise}function W7(n,e,t,r){const i=(function(c,u){let h;return h=typeof c=="string"?tR().encode(c):c,(function(p,b){return new P7(p,b)})((function(p,b){if(p instanceof Uint8Array)return sC(p,b);if(p instanceof ArrayBuffer)return sC(new Uint8Array(p),b);if(p instanceof ReadableStream)return p.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(h),u)})(t,Ug(e));n.asyncQueue.enqueueAndForget((async()=>{k7(await o2(n),i,r)}))}function K7(n,e){return n.asyncQueue.enqueue((async()=>(function(r,i){const o=Ye(r);return o.persistence.runTransaction("Get named query","readonly",(c=>o.Pi.getNamedQuery(c,i)))})(await a2(n),e)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c3(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q7="ComponentProvider",iC=new Map;function Y7(n,e,t,r,i){return new d8(n,e,t,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,c3(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d3="firestore.googleapis.com",aC=!0;class oC{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Le(Te.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=d3,this.ssl=aC}else this.host=e.host,this.ssl=e.ssl??aC;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=wR;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<uF)throw new Le(Te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}nk("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=c3(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Le(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Le(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Le(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class zg{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new oC({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Le(Te.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Le(Te.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new oC(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new _9;switch(r.type){case"firstParty":return new E9(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Le(Te.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=iC.get(t);r&&(Fe(Q7,"Removing Datastore"),iC.delete(t),r.terminate())})(this),Promise.resolve()}}function X7(n,e,t,r={}){var m;n=Yt(n,zg);const i=Ba(e),o=n._getSettings(),c={...o,emulatorOptions:n._getEmulatorOptions()},u=`${e}:${t}`;i&&(gb(`https://${u}`),pb("Firestore",!0)),o.host!==d3&&o.host!==u&&Ma("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...o,host:u,ssl:i,emulatorOptions:r};if(!_o(h,c)&&(n._setSettings(h),r.mockUserToken)){let p,b;if(typeof r.mockUserToken=="string")p=r.mockUserToken,b=Es.MOCK_USER;else{p=aN(r.mockUserToken,(m=n._app)==null?void 0:m.options.projectId);const v=r.mockUserToken.sub||r.mockUserToken.user_id;if(!v)throw new Le(Te.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new Es(v)}n._authCredentials=new N9(new ek(p,b))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fr=class u3{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new u3(this.firestore,e,this._query)}},vn=class wm{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new kl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new wm(this.firestore,e,this._key)}toJSON(){return{type:wm._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(kg(t,wm._jsonSchema))return new wm(e,r||null,new Qe(Ft.fromString(t.referencePath)))}};vn._jsonSchemaVersion="firestore/documentReference/1.0",vn._jsonSchema={type:ds("string",vn._jsonSchemaVersion),referencePath:ds("string")};let kl=class h3 extends fr{constructor(e,t,r){super(e,t,Lh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vn(this.firestore,null,new Qe(e))}withConverter(e){return new h3(this.firestore,e,this._path)}};function f3(n,e,...t){if(n=Xe(n),pN("collection","path",e),n instanceof zg){const r=Ft.fromString(e,...t);return QT(r),new kl(n,null,r)}{if(!(n instanceof vn||n instanceof kl))throw new Le(Te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ft.fromString(e,...t));return QT(r),new kl(n.firestore,null,r)}}function J7(n,e){if(n=Yt(n,zg),pN("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Le(Te.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new fr(n,null,(function(r){return new Co(Ft.emptyPath(),r)})(e))}function Bx(n,e,...t){if(n=Xe(n),arguments.length===1&&(e=gN.newId()),pN("doc","path",e),n instanceof zg){const r=Ft.fromString(e,...t);return KT(r),new vn(n,null,new Qe(r))}{if(!(n instanceof vn||n instanceof kl))throw new Le(Te.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ft.fromString(e,...t));return KT(r),new vn(n.firestore,n instanceof kl?n.converter:null,new Qe(r))}}function m3(n,e){return n=Xe(n),e=Xe(e),(n instanceof vn||n instanceof kl)&&(e instanceof vn||e instanceof kl)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function g3(n,e){return n=Xe(n),e=Xe(e),n instanceof fr&&e instanceof fr&&n.firestore===e.firestore&&Og(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lC="AsyncQueue";class cC{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new HN(this,"async_queue_retry"),this._c=()=>{const r=xx();r&&Fe(lC,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=xx();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=xx();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Bs;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!ec(e))throw e;Fe(lC,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Yn("INTERNAL UNHANDLED ERROR: ",dC(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=QN.createAndSchedule(this,e,t,r,(o=>this.hc(o)));return this.tc.push(i),i}uc(){this.nc&&et(47125,{Pc:dC(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function dC(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z7{constructor(){this._progressObserver={},this._taskCompletionResolver=new Bs,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eU=-1;let Jn=class extends zg{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new cC,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new cC(e),this._firestoreClient=void 0,await e}}};function Zs(n){if(n._terminated)throw new Le(Te.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||p3(n),n._firestoreClient}function p3(n){var r,i,o,c;const e=n._freezeSettings(),t=Y7(n._databaseId,((r=n._app)==null?void 0:r.options.appId)||"",n._persistenceKey,(i=n._app)==null?void 0:i.options.apiKey,e);n._componentsProvider||(o=e.localCache)!=null&&o._offlineComponentProvider&&((c=e.localCache)!=null&&c._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new L7(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(h){const m=h==null?void 0:h._online.build();return{_offline:h==null?void 0:h._offline.build(m),_online:m}})(n._componentsProvider))}function tU(n,e){Ma("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return x3(n,dg.provider,{build:r=>new r3(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function nU(n){Ma("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();x3(n,dg.provider,{build:t=>new D7(t,e.cacheSizeBytes)})}function x3(n,e,t){if((n=Yt(n,Jn))._firestoreClient||n._terminated)throw new Le(Te.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Le(Te.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},p3(n)}function sU(n){if(n._initialized&&!n._terminated)throw new Le(Te.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Bs;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(r){if(!ka.v())return Promise.resolve();const i=r+AR;await ka.delete(i)})(BN(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function rU(n){return(function(t){const r=new Bs;return t.asyncQueue.enqueueAndForget((async()=>v7(await o2(t),r))),r.promise})(Zs(n=Yt(n,Jn)))}function iU(n){return F7(Zs(n=Yt(n,Jn)))}function aU(n){return U7(Zs(n=Yt(n,Jn)))}function oU(n,e){const t=Zs(n=Yt(n,Jn)),r=new Z7;return W7(t,n._databaseId,e,r),r}function lU(n,e){return K7(Zs(n=Yt(n,Jn)),e).then((t=>t?new fr(n,null,t.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ks(qn.fromBase64String(e))}catch(t){throw new Le(Te.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ks(qn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ks._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(kg(e,Ks._jsonSchema))return Ks.fromBase64String(e.bytes)}}Ks._jsonSchemaVersion="firestore/bytes/1.0",Ks._jsonSchema={type:ds("string",Ks._jsonSchemaVersion),bytes:ds("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fd=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Le(Te.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Cn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Id=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Le(Te.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Le(Te.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return jt(this._lat,e._lat)||jt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Hi._jsonSchemaVersion}}static fromJSON(e){if(kg(e,Hi._jsonSchema))return new Hi(e.latitude,e.longitude)}}Hi._jsonSchemaVersion="firestore/geoPoint/1.0",Hi._jsonSchema={type:ds("string",Hi._jsonSchemaVersion),latitude:ds("number"),longitude:ds("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Gi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(kg(e,Gi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Gi(e.vectorValues);throw new Le(Te.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Gi._jsonSchemaVersion="firestore/vectorValue/1.0",Gi._jsonSchema={type:ds("string",Gi._jsonSchemaVersion),vectorValues:ds("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cU=/^__.*__$/;class dU{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ko(e,this.data,this.fieldMask,t,this.fieldTransforms):new Vh(e,this.data,t,this.fieldTransforms)}}class b3{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ko(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function y3(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw et(40011,{dataSource:n})}}class Vb{constructor(e,t,r,i,o,c){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.validatePath(),this.fieldTransforms=o||[],this.fieldMask=c||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Vb({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var i;const t=(i=this.path)==null?void 0:i.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var i;const t=(i=this.path)==null?void 0:i.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return zx(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(y3(this.dataSource)&&cU.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class uU{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ug(e)}createContext(e,t,r,i=!1){return new Vb({dataSource:e,methodName:t,targetDoc:r,path:Cn.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Cd(n){const e=n._freezeSettings(),t=Ug(n._databaseId);return new uU(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Fb(n,e,t,r,i,o={}){const c=n.createContext(o.merge||o.mergeFields?2:0,e,t,i);m2("Data must be an object, but it was:",c,r);const u=_3(r,c);let h,m;if(o.merge)h=new Sr(c.fieldMask),m=c.fieldTransforms;else if(o.mergeFields){const p=[];for(const b of o.mergeFields){const v=md(e,b,t);if(!c.contains(v))throw new Le(Te.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);S3(p,v)||p.push(v)}h=new Sr(p),m=c.fieldTransforms.filter((b=>h.covers(b.field)))}else h=null,m=c.fieldTransforms;return new dU(new Fs(u),h,m)}class $g extends Id{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof $g}}function v3(n,e,t){return new Vb({dataSource:3,targetDoc:e.settings.targetDoc,methodName:n._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class l2 extends Id{_toFieldTransform(e){return new Lg(e.path,new fh)}isEqual(e){return e instanceof l2}}class c2 extends Id{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=v3(this,e,!0),r=this.Ac.map((o=>Ad(o,t))),i=new od(r);return new Lg(e.path,i)}isEqual(e){return e instanceof c2&&_o(this.Ac,e.Ac)}}class d2 extends Id{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=v3(this,e,!0),r=this.Ac.map((o=>Ad(o,t))),i=new ld(r);return new Lg(e.path,i)}isEqual(e){return e instanceof d2&&_o(this.Ac,e.Ac)}}class u2 extends Id{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new mh(e.serializer,Gk(e.serializer,this.Vc));return new Lg(e.path,t)}isEqual(e){return e instanceof u2&&this.Vc===e.Vc}}function h2(n,e,t,r){const i=n.createContext(1,e,t);m2("Data must be an object, but it was:",i,r);const o=[],c=Fs.empty();tc(r,((h,m)=>{const p=j3(e,h,t);m=Xe(m);const b=i.childContextForFieldPath(p);if(m instanceof $g)o.push(p);else{const v=Ad(m,b);v!=null&&(o.push(p),c.set(p,v))}}));const u=new Sr(o);return new b3(c,u,i.fieldTransforms)}function f2(n,e,t,r,i,o){const c=n.createContext(1,e,t),u=[md(e,r,t)],h=[i];if(o.length%2!=0)throw new Le(Te.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<o.length;v+=2)u.push(md(e,o[v])),h.push(o[v+1]);const m=[],p=Fs.empty();for(let v=u.length-1;v>=0;--v)if(!S3(m,u[v])){const _=u[v];let T=h[v];T=Xe(T);const k=c.childContextForFieldPath(_);if(T instanceof $g)m.push(_);else{const E=Ad(T,k);E!=null&&(m.push(_),p.set(_,E))}}const b=new Sr(m);return new b3(p,b,c.fieldTransforms)}function w3(n,e,t,r=!1){return Ad(t,n.createContext(r?4:3,e))}function Ad(n,e){if(N3(n=Xe(n)))return m2("Unsupported field value:",e,n),_3(n,e);if(n instanceof Id)return(function(r,i){if(!y3(i.dataSource))throw i.createError(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.createError(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(r,i){const o=[];let c=0;for(const u of r){let h=Ad(u,i.childContextForArray(c));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),c++}return{arrayValue:{values:o}}})(n,e)}return(function(r,i){if((r=Xe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Gk(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=tn.fromDate(r);return{timestampValue:gh(i.serializer,o)}}if(r instanceof tn){const o=new tn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:gh(i.serializer,o)}}if(r instanceof Hi)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ks)return{bytesValue:rR(i.serializer,r._byteString)};if(r instanceof vn){const o=i.databaseId,c=r.firestore._databaseId;if(!c.isEqual(o))throw i.createError(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:PN(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Gi)return(function(c,u){const h=c instanceof Gi?c.toArray():c;return{mapValue:{fields:{[NN]:{stringValue:jN},[dh]:{arrayValue:{values:h.map((p=>{if(typeof p!="number")throw u.createError("VectorValues must only contain numeric values.");return IN(u.serializer,p)}))}}}}}})(r,i);if(pR(r))return r._toProto(i.serializer);throw i.createError(`Unsupported field value: ${wb(r)}`)})(n,e)}function _3(n,e){const t={};return wk(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):tc(n,((r,i)=>{const o=Ad(i,e.childContextForField(r));o!=null&&(t[r]=o)})),{mapValue:{fields:t}}}function N3(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof tn||n instanceof Hi||n instanceof Ks||n instanceof vn||n instanceof Id||n instanceof Gi||pR(n))}function m2(n,e,t){if(!N3(t)||!sk(t)){const r=wb(t);throw r==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+r)}}function md(n,e,t){if((e=Xe(e))instanceof fd)return e._internalPath;if(typeof e=="string")return j3(n,e);throw zx("Field path arguments must be of type string or ",n,!1,void 0,t)}const hU=new RegExp("[~\\*/\\[\\]]");function j3(n,e,t){if(e.search(hU)>=0)throw zx(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new fd(...e.split("."))._internalPath}catch{throw zx(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function zx(n,e,t,r,i){const o=r&&!r.isEmpty(),c=i!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||c)&&(h+=" (found",o&&(h+=` in field ${r}`),c&&(h+=` in document ${i}`),h+=")"),new Le(Te.INVALID_ARGUMENT,u+n+h)}function S3(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g2{convertValue(e,t="none"){switch(Bl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return In(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(So(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw et(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return tc(e,((i,o)=>{r[i]=this.convertValue(o,t)})),r}convertVectorValue(e){var r,i,o;const t=(o=(i=(r=e.fields)==null?void 0:r[dh].arrayValue)==null?void 0:i.values)==null?void 0:o.map((c=>In(c.doubleValue)));return new Gi(t)}convertGeoPoint(e){return new Hi(In(e.latitude),In(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Tb(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(sg(e));default:return null}}convertTimestamp(e){const t=jo(e);return new tn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ft.fromString(e);it(gR(r),9688,{name:e});const i=new Ul(r.get(1),r.get(3)),o=new Qe(r.popFirst(5));return i.isEqual(t)||Yn(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd extends g2{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ks(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vn(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fU(){return new $g("deleteField")}function mU(){return new l2("serverTimestamp")}function gU(...n){return new c2("arrayUnion",n)}function pU(...n){return new d2("arrayRemove",n)}function xU(n){return new u2("increment",n)}const uC="@firebase/firestore",hC="4.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d1(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const o of r)if(o in i&&typeof i[o]=="function")return!0;return!1})(n,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new vn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new bU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const t=this._document.data.field(md("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class bU extends ug{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E3(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Le(Te.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class p2{}let qg=class extends p2{};function xl(n,e,...t){let r=[];e instanceof p2&&r.push(e),r=r.concat(t),(function(o){const c=o.filter((h=>h instanceof x2)).length,u=o.filter((h=>h instanceof Ub)).length;if(c>1||c>0&&u>0)throw new Le(Te.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class Ub extends qg{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Ub(e,t,r)}_apply(e){const t=this._parse(e);return R3(e._query,t),new fr(e.firestore,e.converter,X_(e._query,t))}_parse(e){const t=Cd(e.firestore);return(function(o,c,u,h,m,p,b){let v;if(m.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new Le(Te.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){mC(b,p);const T=[];for(const k of b)T.push(fC(h,o,k));v={arrayValue:{values:T}}}else v=fC(h,o,b)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||mC(b,p),v=w3(u,c,b,p==="in"||p==="not-in");return zt.create(m,p,v)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function yU(n,e,t){const r=e,i=md("where",n);return Ub._create(i,r,t)}class x2 extends p2{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new x2(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:cn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,o){let c=i;const u=o.getFlattenedFilters();for(const h of u)R3(c,h),c=X_(c,h)})(e._query,t),new fr(e.firestore,e.converter,X_(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class b2 extends qg{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new b2(e,t)}_apply(e){const t=(function(i,o,c){if(i.startAt!==null)throw new Le(Te.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Le(Te.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ag(o,c)})(e._query,this._field,this._direction);return new fr(e.firestore,e.converter,j8(e._query,t))}}function vU(n,e="asc"){const t=e,r=md("orderBy",n);return b2._create(r,t)}class Bb extends qg{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Bb(e,t,r)}_apply(e){return new fr(e.firestore,e.converter,Rx(e._query,this._limit,this._limitType))}}function wU(n){return rk("limit",n),Bb._create("limit",n,"F")}function _U(n){return rk("limitToLast",n),Bb._create("limitToLast",n,"L")}let T3=class I3 extends qg{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new I3(e,t,r)}_apply(e){const t=k3(e,this.type,this._docOrFields,this._inclusive);return new fr(e.firestore,e.converter,S8(e._query,t))}};function NU(...n){return T3._create("startAt",n,!0)}function jU(...n){return T3._create("startAfter",n,!1)}let C3=class A3 extends qg{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new A3(e,t,r)}_apply(e){const t=k3(e,this.type,this._docOrFields,this._inclusive);return new fr(e.firestore,e.converter,E8(e._query,t))}};function SU(...n){return C3._create("endBefore",n,!1)}function EU(...n){return C3._create("endAt",n,!0)}function k3(n,e,t,r){if(t[0]=Xe(t[0]),t[0]instanceof ug)return(function(o,c,u,h,m){if(!h)throw new Le(Te.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${u}().`);const p=[];for(const b of Bu(o))if(b.field.isKeyField())p.push(id(c,h.key));else{const v=h.data.field(b.field);if(Eb(v))throw new Le(Te.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+b.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(v===null){const _=b.field.canonicalString();throw new Le(Te.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}p.push(v)}return new $l(p,m)})(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Cd(n.firestore);return(function(c,u,h,m,p,b){const v=c.explicitOrderBy;if(p.length>v.length)throw new Le(Te.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const _=[];for(let T=0;T<p.length;T++){const k=p[T];if(v[T].field.isKeyField()){if(typeof k!="string")throw new Le(Te.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof k}`);if(!EN(c)&&k.indexOf("/")!==-1)throw new Le(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${k}' contains a slash.`);const E=c.path.child(Ft.fromString(k));if(!Qe.isDocumentKey(E))throw new Le(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${E}' is not because it contains an odd number of segments.`);const S=new Qe(E);_.push(id(u,S))}else{const E=w3(h,m,k);_.push(E)}}return new $l(_,b)})(n._query,n.firestore._databaseId,i,e,t,r)}}function fC(n,e,t){if(typeof(t=Xe(t))=="string"){if(t==="")throw new Le(Te.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!EN(e)&&t.indexOf("/")!==-1)throw new Le(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Ft.fromString(t));if(!Qe.isDocumentKey(r))throw new Le(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return id(n,new Qe(r))}if(t instanceof vn)return id(n,t._key);throw new Le(Te.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${wb(t)}.`)}function mC(n,e){if(!Array.isArray(n)||n.length===0)throw new Le(Te.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function R3(n,e){const t=(function(i,o){for(const c of i)for(const u of c.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Le(Te.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Le(Te.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function zb(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class TU extends g2{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ks(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vn(this.firestore,null,t)}}class Gc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let _i=class D3 extends ug{constructor(e,t,r,i,o,c){super(e,t,r,i,c),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Om(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(md("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Le(Te.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=D3._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};_i._jsonSchemaVersion="firestore/documentSnapshot/1.0",_i._jsonSchema={type:ds("string",_i._jsonSchemaVersion),bundleSource:ds("string","DocumentSnapshot"),bundleName:ds("string"),bundle:ds("string")};let Om=class extends _i{data(e={}){return super.data(e)}},Wi=class P3{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Gc(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Om(this._firestore,this._userDataWriter,r.key,r,new Gc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Le(Te.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let c=0;return i._snapshot.docChanges.map((u=>{const h=new Om(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Gc(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:c++}}))}{let c=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((u=>o||u.type!==3)).map((u=>{const h=new Om(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Gc(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let m=-1,p=-1;return u.type!==0&&(m=c.indexOf(u.doc.key),c=c.delete(u.doc.key)),u.type!==1&&(c=c.add(u.doc),p=c.indexOf(u.doc.key)),{type:IU(u.type),doc:h,oldIndex:m,newIndex:p}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Le(Te.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=P3._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=gN.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function IU(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return et(61501,{type:n})}}function O3(n,e){return n instanceof _i&&e instanceof _i?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Wi&&e instanceof Wi&&n._firestore===e._firestore&&g3(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Wi._jsonSchemaVersion="firestore/querySnapshot/1.0",Wi._jsonSchema={type:ds("string",Wi._jsonSchemaVersion),bundleSource:ds("string","QuerySnapshot"),bundleName:ds("string"),bundle:ds("string")};const CU={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AU=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Cd(e)}set(e,t,r){this._verifyNotCommitted();const i=Nl(e,this._firestore),o=zb(i.converter,t,r),c=Fb(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,r);return this._mutations.push(c.toMutation(i._key,An.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const o=Nl(e,this._firestore);let c;return c=typeof(t=Xe(t))=="string"||t instanceof fd?f2(this._dataReader,"WriteBatch.update",o._key,t,r,i):h2(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(c.toMutation(o._key,An.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Nl(e,this._firestore);return this._mutations=this._mutations.concat(new Fh(t._key,An.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Le(Te.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Nl(n,e){if((n=Xe(n)).firestore!==e)throw new Le(Te.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kU{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Cd(e)}get(e){const t=Nl(e,this._firestore),r=new TU(this._firestore);return this._transaction.lookup([t._key]).then((i=>{if(!i||i.length!==1)return et(24041);const o=i[0];if(o.isFoundDocument())return new ug(this._firestore,r,o.key,o,t.converter);if(o.isNoDocument())return new ug(this._firestore,r,t._key,null,t.converter);throw et(18433,{doc:o})}))}set(e,t,r){const i=Nl(e,this._firestore),o=zb(i.converter,t,r),c=Fb(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,r);return this._transaction.set(i._key,c),this}update(e,t,r,...i){const o=Nl(e,this._firestore);let c;return c=typeof(t=Xe(t))=="string"||t instanceof fd?f2(this._dataReader,"Transaction.update",o._key,t,r,i):h2(this._dataReader,"Transaction.update",o._key,t),this._transaction.update(o._key,c),this}delete(e){const t=Nl(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let RU=class extends kU{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Nl(e,this._firestore),r=new kd(this._firestore);return super.get(e).then((i=>new _i(this._firestore,r,t._key,i._document,new Gc(!1,!1),t.converter)))}};function DU(n,e,t){n=Yt(n,Jn);const r={...CU,...t};(function(c){if(c.maxAttempts<1)throw new Le(Te.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r);const i=Zs(n);return G7(i,(o=>e(new RU(n,o))),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PU(n){n=Yt(n,vn);const e=Yt(n.firestore,Jn),t=Zs(e);return o3(t,n._key).then((r=>y2(e,n,r)))}function OU(n){n=Yt(n,vn);const e=Yt(n.firestore,Jn),t=Zs(e),r=new kd(e);return z7(t,n._key).then((i=>new _i(e,r,n._key,i,new Gc(i!==null&&i.hasLocalMutations,!0),n.converter)))}function MU(n){n=Yt(n,vn);const e=Yt(n.firestore,Jn),t=Zs(e);return o3(t,n._key,{source:"server"}).then((r=>y2(e,n,r)))}function LU(n){n=Yt(n,fr);const e=Yt(n.firestore,Jn),t=Zs(e),r=new kd(e);return E3(n._query),l3(t,n._query).then((i=>new Wi(e,r,n,i)))}function VU(n){n=Yt(n,fr);const e=Yt(n.firestore,Jn),t=Zs(e),r=new kd(e);return $7(t,n._query).then((i=>new Wi(e,r,n,i)))}function FU(n){n=Yt(n,fr);const e=Yt(n.firestore,Jn),t=Zs(e),r=new kd(e);return l3(t,n._query,{source:"server"}).then((i=>new Wi(e,r,n,i)))}function gC(n,e,t){n=Yt(n,vn);const r=Yt(n.firestore,Jn),i=zb(n.converter,e,t),o=Cd(r);return Hg(r,[Fb(o,"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,An.none())])}function pC(n,e,t,...r){n=Yt(n,vn);const i=Yt(n.firestore,Jn),o=Cd(i);let c;return c=typeof(e=Xe(e))=="string"||e instanceof fd?f2(o,"updateDoc",n._key,e,t,r):h2(o,"updateDoc",n._key,e),Hg(i,[c.toMutation(n._key,An.exists(!0))])}function UU(n){return Hg(Yt(n.firestore,Jn),[new Fh(n._key,An.none())])}function BU(n,e){const t=Yt(n.firestore,Jn),r=Bx(n),i=zb(n.converter,e),o=Cd(n.firestore);return Hg(t,[Fb(o,"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,An.exists(!1))]).then((()=>r))}function M3(n,...e){var m,p,b;n=Xe(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||d1(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(d1(e[r])){const v=e[r];e[r]=(m=v.next)==null?void 0:m.bind(v),e[r+1]=(p=v.error)==null?void 0:p.bind(v),e[r+2]=(b=v.complete)==null?void 0:b.bind(v)}let o,c,u;if(n instanceof vn)c=Yt(n.firestore,Jn),u=Lh(n._key.path),o={next:v=>{e[r]&&e[r](y2(c,n,v))},error:e[r+1],complete:e[r+2]};else{const v=Yt(n,fr);c=Yt(v.firestore,Jn),u=v._query;const _=new kd(c);o={next:T=>{e[r]&&e[r](new Wi(c,_,v,T))},error:e[r+1],complete:e[r+2]},E3(n._query)}const h=Zs(c);return B7(h,u,i,o)}function zU(n,e){n=Yt(n,Jn);const t=Zs(n),r=d1(e)?e:{next:e};return H7(t,r)}function Hg(n,e){const t=Zs(n);return q7(t,e)}function y2(n,e,t){const r=t.docs.get(e._key),i=new kd(n);return new _i(n,i,e._key,r,new Gc(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){y9($a),hr(new $n("firestore",((r,{instanceIdentifier:i,options:o})=>{const c=r.getProvider("app").getImmediate(),u=new Jn(new j9(r.getProvider("auth-internal")),new T9(c,r.getProvider("app-check-internal")),u8(c,i),c);return o={useFetchStreams:t,...o},u._setSettings(o),u}),"PUBLIC").setMultipleInstances(!0)),ps(uC,hC,e),ps(uC,hC,"esm2020")})();const $U="@firebase/firestore-compat",qU="0.4.4";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v2(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new Le("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xC(){if(typeof Uint8Array>"u")throw new Le("unimplemented","Uint8Arrays are not available in this environment.")}function bC(){if(!l8())throw new Le("unimplemented","Blobs are unavailable in Firestore in this environment.")}let L3=class u1{constructor(e){this._delegate=e}static fromBase64String(e){return bC(),new u1(Ks.fromBase64String(e))}static fromUint8Array(e){return xC(),new u1(Ks.fromUint8Array(e))}toBase64(){return bC(),this._delegate.toBase64()}toUint8Array(){return xC(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h1(n){return HU(n,["next","error","complete"])}function HU(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GU{enableIndexedDbPersistence(e,t){return tU(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return nU(e._delegate)}clearIndexedDbPersistence(e){return sU(e._delegate)}}class V3{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Ul||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Ma("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){X7(this._delegate,e,t,r)}enableNetwork(){return iU(this._delegate)}disableNetwork(){return aU(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,nk("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return rU(this._delegate)}onSnapshotsInSync(e){return zU(this._delegate,e)}get app(){if(!this._appCompat)throw new Le("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new _h(this,f3(this._delegate,e))}catch(t){throw ir(t,"collection()","Firestore.collection()")}}doc(e){try{return new xi(this,Bx(this._delegate,e))}catch(t){throw ir(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new mg(this,J7(this._delegate,e))}catch(t){throw ir(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return DU(this._delegate,t=>e(new F3(this,t)))}batch(){return Zs(this._delegate),new U3(new AU(this._delegate,e=>Hg(this._delegate,e)))}loadBundle(e){return oU(this._delegate,e)}namedQuery(e){return lU(this._delegate,e).then(t=>t?new mg(this,t):null)}}class $b extends g2{constructor(e){super(),this.firestore=e}convertBytes(e){return new L3(new Ks(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return xi.forKey(t,this.firestore,null)}}function WU(n){v9(n)}class F3{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new $b(e)}get(e){const t=Wc(e);return this._delegate.get(t).then(r=>new hg(this._firestore,new _i(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=Wc(e);return r?(v2("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const o=Wc(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){const t=Wc(e);return this._delegate.delete(t),this}}class U3{constructor(e){this._delegate=e}set(e,t,r){const i=Wc(e);return r?(v2("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const o=Wc(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){const t=Wc(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class gd{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new Om(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new fg(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=gd.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let o=i.get(t);return o||(o=new gd(e,new $b(e),t),i.set(t,o)),o}}gd.INSTANCES=new WeakMap;class xi{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new $b(e)}static forPath(e,t,r){if(e.length%2!==0)throw new Le("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new xi(t,new vn(t._delegate,r,new Qe(e)))}static forKey(e,t,r){return new xi(t,new vn(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new _h(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new _h(this.firestore,f3(this._delegate,e))}catch(t){throw ir(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Xe(e),e instanceof vn?m3(this._delegate,e):!1}set(e,t){t=v2("DocumentReference.set",t);try{return t?gC(this._delegate,e,t):gC(this._delegate,e)}catch(r){throw ir(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?pC(this._delegate,e):pC(this._delegate,e,t,...r)}catch(i){throw ir(i,"updateDoc()","DocumentReference.update()")}}delete(){return UU(this._delegate)}onSnapshot(...e){const t=B3(e),r=z3(e,i=>new hg(this.firestore,new _i(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return M3(this._delegate,t,r)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=OU(this._delegate):(e==null?void 0:e.source)==="server"?t=MU(this._delegate):t=PU(this._delegate),t.then(r=>new hg(this.firestore,new _i(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new xi(this.firestore,e?this._delegate.withConverter(gd.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function ir(n,e,t){return n.message=n.message.replace(e,t),n}function B3(n){for(const e of n)if(typeof e=="object"&&!h1(e))return e;return{}}function z3(n,e){var r,i;let t;return h1(n[0])?t=n[0]:h1(n[1])?t=n[1]:typeof n[0]=="function"?t={next:n[0],error:n[1],complete:n[2]}:t={next:n[1],error:n[2],complete:n[3]},{next:o=>{t.next&&t.next(e(o))},error:(r=t.error)==null?void 0:r.bind(t),complete:(i=t.complete)==null?void 0:i.bind(t)}}class hg{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new xi(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return O3(this._delegate,e._delegate)}}class fg extends hg{data(e){const t=this._delegate.data(e);return this._delegate._converter||w9(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}let mg=class va{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new $b(e)}where(e,t,r){try{return new va(this.firestore,xl(this._delegate,yU(e,t,r)))}catch(i){throw ir(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new va(this.firestore,xl(this._delegate,vU(e,t)))}catch(r){throw ir(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new va(this.firestore,xl(this._delegate,wU(e)))}catch(t){throw ir(t,"limit()","Query.limit()")}}limitToLast(e){try{return new va(this.firestore,xl(this._delegate,_U(e)))}catch(t){throw ir(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new va(this.firestore,xl(this._delegate,NU(...e)))}catch(t){throw ir(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new va(this.firestore,xl(this._delegate,jU(...e)))}catch(t){throw ir(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new va(this.firestore,xl(this._delegate,SU(...e)))}catch(t){throw ir(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new va(this.firestore,xl(this._delegate,EU(...e)))}catch(t){throw ir(t,"endAt()","Query.endAt()")}}isEqual(e){return g3(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=VU(this._delegate):(e==null?void 0:e.source)==="server"?t=FU(this._delegate):t=LU(this._delegate),t.then(r=>new f1(this.firestore,new Wi(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=B3(e),r=z3(e,i=>new f1(this.firestore,new Wi(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return M3(this._delegate,t,r)}withConverter(e){return new va(this.firestore,e?this._delegate.withConverter(gd.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};class KU{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new fg(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class f1{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new mg(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new fg(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new KU(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new fg(this._firestore,r))})}isEqual(e){return O3(this._delegate,e._delegate)}}class _h extends mg{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new xi(this.firestore,e):null}doc(e){try{return e===void 0?new xi(this.firestore,Bx(this._delegate)):new xi(this.firestore,Bx(this._delegate,e))}catch(t){throw ir(t,"doc()","CollectionReference.doc()")}}add(e){return BU(this._delegate,e).then(t=>new xi(this.firestore,t))}isEqual(e){return m3(this._delegate,e._delegate)}withConverter(e){return new _h(this.firestore,e?this._delegate.withConverter(gd.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Wc(n){return Yt(n,vn)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{constructor(...e){this._delegate=new fd(...e)}static documentId(){return new w2(Cn.keyField().canonicalString())}isEqual(e){return e=Xe(e),e instanceof fd?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{static serverTimestamp(){const e=mU();return e._methodName="FieldValue.serverTimestamp",new qc(e)}static delete(){const e=fU();return e._methodName="FieldValue.delete",new qc(e)}static arrayUnion(...e){const t=gU(...e);return t._methodName="FieldValue.arrayUnion",new qc(t)}static arrayRemove(...e){const t=pU(...e);return t._methodName="FieldValue.arrayRemove",new qc(t)}static increment(e){const t=xU(e);return t._methodName="FieldValue.increment",new qc(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QU={Firestore:V3,GeoPoint:Hi,Timestamp:tn,Blob:L3,Transaction:F3,WriteBatch:U3,DocumentReference:xi,DocumentSnapshot:hg,Query:mg,QueryDocumentSnapshot:fg,QuerySnapshot:f1,CollectionReference:_h,FieldPath:w2,FieldValue:qc,setLogLevel:WU,CACHE_SIZE_UNLIMITED:eU};function YU(n,e){n.INTERNAL.registerComponent(new $n("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps({...QU}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XU(n){YU(n,(e,t)=>new V3(e,t,new GU)),n.registerVersion($U,qU)}XU(Nt);const $3="@firebase/installations",_2="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q3=1e4,H3=`w:${_2}`,G3="FIS_v2",JU="https://firebaseinstallations.googleapis.com/v1",ZU=3600*1e3,eB="installations",tB="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nB={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},pd=new za(eB,tB,nB);function W3(n){return n instanceof Us&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K3({projectId:n}){return`${JU}/projects/${n}/installations`}function Q3(n){return{token:n.token,requestStatus:2,expiresIn:rB(n.expiresIn),creationTime:Date.now()}}async function Y3(n,e){const r=(await e.json()).error;return pd.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function X3({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function sB(n,{refreshToken:e}){const t=X3(n);return t.append("Authorization",iB(e)),t}async function J3(n){const e=await n();return e.status>=500&&e.status<600?n():e}function rB(n){return Number(n.replace("s","000"))}function iB(n){return`${G3} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aB({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const r=K3(n),i=X3(n),o=e.getImmediate({optional:!0});if(o){const m=await o.getHeartbeatsHeader();m&&i.append("x-firebase-client",m)}const c={fid:t,authVersion:G3,appId:n.appId,sdkVersion:H3},u={method:"POST",headers:i,body:JSON.stringify(c)},h=await J3(()=>fetch(r,u));if(h.ok){const m=await h.json();return{fid:m.fid||t,registrationStatus:2,refreshToken:m.refreshToken,authToken:Q3(m.authToken)}}else throw await Y3("Create Installation",h)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z3(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oB(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lB=/^[cdef][\w-]{21}$/,m1="";function cB(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=dB(n);return lB.test(t)?t:m1}catch{return m1}}function dB(n){return oB(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qb(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eD=new Map;function tD(n,e){const t=qb(n);nD(t,e),uB(t,e)}function nD(n,e){const t=eD.get(n);if(t)for(const r of t)r(e)}function uB(n,e){const t=hB();t&&t.postMessage({key:n,fid:e}),fB()}let Kc=null;function hB(){return!Kc&&"BroadcastChannel"in self&&(Kc=new BroadcastChannel("[Firebase] FID Change"),Kc.onmessage=n=>{nD(n.data.key,n.data.fid)}),Kc}function fB(){eD.size===0&&Kc&&(Kc.close(),Kc=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mB="firebase-installations-database",gB=1,xd="firebase-installations-store";let Ww=null;function N2(){return Ww||(Ww=Oh(mB,gB,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(xd)}}})),Ww}async function $x(n,e){const t=qb(n),i=(await N2()).transaction(xd,"readwrite"),o=i.objectStore(xd),c=await o.get(t);return await o.put(e,t),await i.done,(!c||c.fid!==e.fid)&&tD(n,e.fid),e}async function sD(n){const e=qb(n),r=(await N2()).transaction(xd,"readwrite");await r.objectStore(xd).delete(e),await r.done}async function Hb(n,e){const t=qb(n),i=(await N2()).transaction(xd,"readwrite"),o=i.objectStore(xd),c=await o.get(t),u=e(c);return u===void 0?await o.delete(t):await o.put(u,t),await i.done,u&&(!c||c.fid!==u.fid)&&tD(n,u.fid),u}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j2(n){let e;const t=await Hb(n.appConfig,r=>{const i=pB(r),o=xB(n,i);return e=o.registrationPromise,o.installationEntry});return t.fid===m1?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function pB(n){const e=n||{fid:cB(),registrationStatus:0};return rD(e)}function xB(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(pd.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=bB(n,t);return{installationEntry:t,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:yB(n)}:{installationEntry:e}}async function bB(n,e){try{const t=await aB(n,e);return $x(n.appConfig,t)}catch(t){throw W3(t)&&t.customData.serverCode===409?await sD(n.appConfig):await $x(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function yB(n){let e=await yC(n.appConfig);for(;e.registrationStatus===1;)await Z3(100),e=await yC(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:r}=await j2(n);return r||t}return e}function yC(n){return Hb(n,e=>{if(!e)throw pd.create("installation-not-found");return rD(e)})}function rD(n){return vB(n)?{fid:n.fid,registrationStatus:0}:n}function vB(n){return n.registrationStatus===1&&n.registrationTime+q3<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wB({appConfig:n,heartbeatServiceProvider:e},t){const r=_B(n,t),i=sB(n,t),o=e.getImmediate({optional:!0});if(o){const m=await o.getHeartbeatsHeader();m&&i.append("x-firebase-client",m)}const c={installation:{sdkVersion:H3,appId:n.appId}},u={method:"POST",headers:i,body:JSON.stringify(c)},h=await J3(()=>fetch(r,u));if(h.ok){const m=await h.json();return Q3(m)}else throw await Y3("Generate Auth Token",h)}function _B(n,{fid:e}){return`${K3(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S2(n,e=!1){let t;const r=await Hb(n.appConfig,o=>{if(!iD(o))throw pd.create("not-registered");const c=o.authToken;if(!e&&SB(c))return o;if(c.requestStatus===1)return t=NB(n,e),o;{if(!navigator.onLine)throw pd.create("app-offline");const u=TB(o);return t=jB(n,u),u}});return t?await t:r.authToken}async function NB(n,e){let t=await vC(n.appConfig);for(;t.authToken.requestStatus===1;)await Z3(100),t=await vC(n.appConfig);const r=t.authToken;return r.requestStatus===0?S2(n,e):r}function vC(n){return Hb(n,e=>{if(!iD(e))throw pd.create("not-registered");const t=e.authToken;return IB(t)?{...e,authToken:{requestStatus:0}}:e})}async function jB(n,e){try{const t=await wB(n,e),r={...e,authToken:t};return await $x(n.appConfig,r),t}catch(t){if(W3(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await sD(n.appConfig);else{const r={...e,authToken:{requestStatus:0}};await $x(n.appConfig,r)}throw t}}function iD(n){return n!==void 0&&n.registrationStatus===2}function SB(n){return n.requestStatus===2&&!EB(n)}function EB(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+ZU}function TB(n){const e={requestStatus:1,requestTime:Date.now()};return{...n,authToken:e}}function IB(n){return n.requestStatus===1&&n.requestTime+q3<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CB(n){const e=n,{installationEntry:t,registrationPromise:r}=await j2(e);return r?r.catch(console.error):S2(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AB(n,e=!1){const t=n;return await kB(t),(await S2(t,e)).token}async function kB(n){const{registrationPromise:e}=await j2(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RB(n){if(!n||!n.options)throw Kw("App Configuration");if(!n.name)throw Kw("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Kw(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Kw(n){return pd.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aD="installations",DB="installations-internal",PB=n=>{const e=n.getProvider("app").getImmediate(),t=RB(e),r=vb(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},OB=n=>{const e=n.getProvider("app").getImmediate(),t=vb(e,aD).getImmediate();return{getId:()=>CB(t),getToken:i=>AB(t,i)}};function MB(){hr(new $n(aD,PB,"PUBLIC")),hr(new $n(DB,OB,"PRIVATE"))}MB();ps($3,_2);ps($3,_2,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LB="/firebase-messaging-sw.js",VB="/firebase-cloud-messaging-push-scope",oD="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",FB="https://fcmregistrations.googleapis.com/v1",lD="google.c.a.c_id",UB="google.c.a.c_l",BB="google.c.a.ts",zB="google.c.a.e",wC=1e4;var _C;(function(n){n[n.DATA_MESSAGE=1]="DATA_MESSAGE",n[n.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(_C||(_C={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var gg;(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"})(gg||(gg={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uo(n){const e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function $B(n){const e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),i=new Uint8Array(r.length);for(let o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qw="fcm_token_details_db",qB=5,NC="fcm_token_object_Store";async function HB(n){if("databases"in indexedDB&&!(await indexedDB.databases()).map(o=>o.name).includes(Qw))return null;let e=null;return(await Oh(Qw,qB,{upgrade:async(r,i,o,c)=>{if(i<2||!r.objectStoreNames.contains(NC))return;const u=c.objectStore(NC),h=await u.index("fcmSenderId").get(n);if(await u.clear(),!!h){if(i===2){const m=h;if(!m.auth||!m.p256dh||!m.endpoint)return;e={token:m.fcmToken,createTime:m.createTime??Date.now(),subscriptionOptions:{auth:m.auth,p256dh:m.p256dh,endpoint:m.endpoint,swScope:m.swScope,vapidKey:typeof m.vapidKey=="string"?m.vapidKey:uo(m.vapidKey)}}}else if(i===3){const m=h;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:uo(m.auth),p256dh:uo(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:uo(m.vapidKey)}}}else if(i===4){const m=h;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:uo(m.auth),p256dh:uo(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:uo(m.vapidKey)}}}}}})).close(),await Uu(Qw),await Uu("fcm_vapid_details_db"),await Uu("undefined"),GB(e)?e:null}function GB(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:e}=n;return typeof n.createTime=="number"&&n.createTime>0&&typeof n.token=="string"&&n.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WB="firebase-messaging-database",KB=1,bd="firebase-messaging-store";let Yw=null;function E2(){return Yw||(Yw=Oh(WB,KB,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(bd)}}})),Yw}async function cD(n){const e=I2(n),r=await(await E2()).transaction(bd).objectStore(bd).get(e);if(r)return r;{const i=await HB(n.appConfig.senderId);if(i)return await T2(n,i),i}}async function T2(n,e){const t=I2(n),i=(await E2()).transaction(bd,"readwrite");return await i.objectStore(bd).put(e,t),await i.done,e}async function QB(n){const e=I2(n),r=(await E2()).transaction(bd,"readwrite");await r.objectStore(bd).delete(e),await r.done}function I2({appConfig:n}){return n.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YB={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},cr=new za("messaging","Messaging",YB);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XB(n,e){const t=await A2(n),r=uD(e),i={method:"POST",headers:t,body:JSON.stringify(r)};let o;try{o=await(await fetch(C2(n.appConfig),i)).json()}catch(c){throw cr.create("token-subscribe-failed",{errorInfo:c==null?void 0:c.toString()})}if(o.error){const c=o.error.message;throw cr.create("token-subscribe-failed",{errorInfo:c})}if(!o.token)throw cr.create("token-subscribe-no-token");return o.token}async function JB(n,e){const t=await A2(n),r=uD(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(r)};let o;try{o=await(await fetch(`${C2(n.appConfig)}/${e.token}`,i)).json()}catch(c){throw cr.create("token-update-failed",{errorInfo:c==null?void 0:c.toString()})}if(o.error){const c=o.error.message;throw cr.create("token-update-failed",{errorInfo:c})}if(!o.token)throw cr.create("token-update-no-token");return o.token}async function dD(n,e){const r={method:"DELETE",headers:await A2(n)};try{const o=await(await fetch(`${C2(n.appConfig)}/${e}`,r)).json();if(o.error){const c=o.error.message;throw cr.create("token-unsubscribe-failed",{errorInfo:c})}}catch(i){throw cr.create("token-unsubscribe-failed",{errorInfo:i==null?void 0:i.toString()})}}function C2({projectId:n}){return`${FB}/projects/${n}/registrations`}async function A2({appConfig:n,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function uD({p256dh:n,auth:e,endpoint:t,vapidKey:r}){const i={web:{endpoint:t,auth:e,p256dh:n}};return r!==oD&&(i.web.applicationPubKey=r),i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZB=10080*60*1e3;async function ez(n){const e=await sz(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:uo(e.getKey("auth")),p256dh:uo(e.getKey("p256dh"))},r=await cD(n.firebaseDependencies);if(r){if(rz(r.subscriptionOptions,t))return Date.now()>=r.createTime+ZB?nz(n,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{await dD(n.firebaseDependencies,r.token)}catch(i){console.warn(i)}return jC(n.firebaseDependencies,t)}else return jC(n.firebaseDependencies,t)}async function tz(n){const e=await cD(n.firebaseDependencies);e&&(await dD(n.firebaseDependencies,e.token),await QB(n.firebaseDependencies));const t=await n.swRegistration.pushManager.getSubscription();return t?t.unsubscribe():!0}async function nz(n,e){try{const t=await JB(n.firebaseDependencies,e),r={...e,token:t,createTime:Date.now()};return await T2(n.firebaseDependencies,r),t}catch(t){throw t}}async function jC(n,e){const r={token:await XB(n,e),createTime:Date.now(),subscriptionOptions:e};return await T2(n,r),r.token}async function sz(n,e){const t=await n.pushManager.getSubscription();return t||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:$B(e)})}function rz(n,e){const t=e.vapidKey===n.vapidKey,r=e.endpoint===n.endpoint,i=e.auth===n.auth,o=e.p256dh===n.p256dh;return t&&r&&i&&o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SC(n){const e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return iz(e,n),az(e,n),oz(e,n),e}function iz(n,e){if(!e.notification)return;n.notification={};const t=e.notification.title;t&&(n.notification.title=t);const r=e.notification.body;r&&(n.notification.body=r);const i=e.notification.image;i&&(n.notification.image=i);const o=e.notification.icon;o&&(n.notification.icon=o)}function az(n,e){e.data&&(n.data=e.data)}function oz(n,e){var i,o,c,u;if(!e.fcmOptions&&!((i=e.notification)!=null&&i.click_action))return;n.fcmOptions={};const t=((o=e.fcmOptions)==null?void 0:o.link)??((c=e.notification)==null?void 0:c.click_action);t&&(n.fcmOptions.link=t);const r=(u=e.fcmOptions)==null?void 0:u.analytics_label;r&&(n.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lz(n){return typeof n=="object"&&!!n&&lD in n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cz(n){if(!n||!n.options)throw Xw("App Configuration Object");if(!n.name)throw Xw("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(const r of e)if(!t[r])throw Xw(r);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function Xw(n){return cr.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dz=class{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=cz(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hD(n){try{n.swRegistration=await navigator.serviceWorker.register(LB,{scope:VB}),n.swRegistration.update().catch(()=>{}),await uz(n.swRegistration)}catch(e){throw cr.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function uz(n){return new Promise((e,t)=>{const r=setTimeout(()=>t(new Error(`Service worker not registered after ${wC} ms`)),wC),i=n.installing||n.waiting;n.active?(clearTimeout(r),e()):i?i.onstatechange=o=>{var c;((c=o.target)==null?void 0:c.state)==="activated"&&(i.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),t(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hz(n,e){if(!e&&!n.swRegistration&&await hD(n),!(!e&&n.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw cr.create("invalid-sw-registration");n.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fz(n,e){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=oD)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fD(n,e){if(!navigator)throw cr.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw cr.create("permission-blocked");return await fz(n,e==null?void 0:e.vapidKey),await hz(n,e==null?void 0:e.serviceWorkerRegistration),ez(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mz(n,e,t){const r=gz(e);(await n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:t[lD],message_name:t[UB],message_time:t[BB],message_device_time:Math.floor(Date.now()/1e3)})}function gz(n){switch(n){case gg.NOTIFICATION_CLICKED:return"notification_open";case gg.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pz(n,e){const t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===gg.PUSH_RECEIVED&&(typeof n.onMessageHandler=="function"?n.onMessageHandler(SC(t)):n.onMessageHandler.next(SC(t)));const r=t.data;lz(r)&&r[zB]==="1"&&await mz(n,t.messageType,r)}const EC="@firebase/messaging",TC="0.12.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xz=n=>{const e=new dz(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>pz(e,t)),e},bz=n=>{const e=n.getProvider("messaging").getImmediate();return{getToken:r=>fD(e,r)}};function yz(){hr(new $n("messaging",xz,"PUBLIC")),hr(new $n("messaging-internal",bz,"PRIVATE")),ps(EC,TC),ps(EC,TC,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vz(n){if(!navigator)throw cr.create("only-available-in-window");return n.swRegistration||await hD(n),tz(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wz(n,e){if(!navigator)throw cr.create("only-available-in-window");return n.onMessageHandler=e,()=>{n.onMessageHandler=null}}async function _z(n,e){return n=Xe(n),fD(n,e)}function Nz(n){return n=Xe(n),vz(n)}function jz(n,e){return n=Xe(n),wz(n,e)}yz();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mD="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Sz="https://fcmregistrations.googleapis.com/v1",gD="FCM_MSG",Ez="google.c.a.c_id",Tz=3,Iz=1;var qx;(function(n){n[n.DATA_MESSAGE=1]="DATA_MESSAGE",n[n.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(qx||(qx={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var Hx;(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"})(Hx||(Hx={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ho(n){const e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Cz(n){const e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),i=new Uint8Array(r.length);for(let o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw="fcm_token_details_db",Az=5,IC="fcm_token_object_Store";async function kz(n){if("databases"in indexedDB&&!(await indexedDB.databases()).map(o=>o.name).includes(Jw))return null;let e=null;return(await Oh(Jw,Az,{upgrade:async(r,i,o,c)=>{if(i<2||!r.objectStoreNames.contains(IC))return;const u=c.objectStore(IC),h=await u.index("fcmSenderId").get(n);if(await u.clear(),!!h){if(i===2){const m=h;if(!m.auth||!m.p256dh||!m.endpoint)return;e={token:m.fcmToken,createTime:m.createTime??Date.now(),subscriptionOptions:{auth:m.auth,p256dh:m.p256dh,endpoint:m.endpoint,swScope:m.swScope,vapidKey:typeof m.vapidKey=="string"?m.vapidKey:ho(m.vapidKey)}}}else if(i===3){const m=h;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:ho(m.auth),p256dh:ho(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:ho(m.vapidKey)}}}else if(i===4){const m=h;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:ho(m.auth),p256dh:ho(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:ho(m.vapidKey)}}}}}})).close(),await Uu(Jw),await Uu("fcm_vapid_details_db"),await Uu("undefined"),Rz(e)?e:null}function Rz(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:e}=n;return typeof n.createTime=="number"&&n.createTime>0&&typeof n.token=="string"&&n.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dz="firebase-messaging-database",Pz=1,yd="firebase-messaging-store";let Zw=null;function k2(){return Zw||(Zw=Oh(Dz,Pz,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(yd)}}})),Zw}async function R2(n){const e=P2(n),r=await(await k2()).transaction(yd).objectStore(yd).get(e);if(r)return r;{const i=await kz(n.appConfig.senderId);if(i)return await D2(n,i),i}}async function D2(n,e){const t=P2(n),i=(await k2()).transaction(yd,"readwrite");return await i.objectStore(yd).put(e,t),await i.done,e}async function Oz(n){const e=P2(n),r=(await k2()).transaction(yd,"readwrite");await r.objectStore(yd).delete(e),await r.done}function P2({appConfig:n}){return n.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mz={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Da=new za("messaging","Messaging",Mz);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lz(n,e){const t=await M2(n),r=xD(e),i={method:"POST",headers:t,body:JSON.stringify(r)};let o;try{o=await(await fetch(O2(n.appConfig),i)).json()}catch(c){throw Da.create("token-subscribe-failed",{errorInfo:c==null?void 0:c.toString()})}if(o.error){const c=o.error.message;throw Da.create("token-subscribe-failed",{errorInfo:c})}if(!o.token)throw Da.create("token-subscribe-no-token");return o.token}async function Vz(n,e){const t=await M2(n),r=xD(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(r)};let o;try{o=await(await fetch(`${O2(n.appConfig)}/${e.token}`,i)).json()}catch(c){throw Da.create("token-update-failed",{errorInfo:c==null?void 0:c.toString()})}if(o.error){const c=o.error.message;throw Da.create("token-update-failed",{errorInfo:c})}if(!o.token)throw Da.create("token-update-no-token");return o.token}async function pD(n,e){const r={method:"DELETE",headers:await M2(n)};try{const o=await(await fetch(`${O2(n.appConfig)}/${e}`,r)).json();if(o.error){const c=o.error.message;throw Da.create("token-unsubscribe-failed",{errorInfo:c})}}catch(i){throw Da.create("token-unsubscribe-failed",{errorInfo:i==null?void 0:i.toString()})}}function O2({projectId:n}){return`${Sz}/projects/${n}/registrations`}async function M2({appConfig:n,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function xD({p256dh:n,auth:e,endpoint:t,vapidKey:r}){const i={web:{endpoint:t,auth:e,p256dh:n}};return r!==mD&&(i.web.applicationPubKey=r),i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fz=10080*60*1e3;async function Uz(n){const e=await zz(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:ho(e.getKey("auth")),p256dh:ho(e.getKey("p256dh"))},r=await R2(n.firebaseDependencies);if(r){if($z(r.subscriptionOptions,t))return Date.now()>=r.createTime+Fz?Bz(n,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{await pD(n.firebaseDependencies,r.token)}catch(i){console.warn(i)}return AC(n.firebaseDependencies,t)}else return AC(n.firebaseDependencies,t)}async function CC(n){const e=await R2(n.firebaseDependencies);e&&(await pD(n.firebaseDependencies,e.token),await Oz(n.firebaseDependencies));const t=await n.swRegistration.pushManager.getSubscription();return t?t.unsubscribe():!0}async function Bz(n,e){try{const t=await Vz(n.firebaseDependencies,e),r={...e,token:t,createTime:Date.now()};return await D2(n.firebaseDependencies,r),t}catch(t){throw t}}async function AC(n,e){const r={token:await Lz(n,e),createTime:Date.now(),subscriptionOptions:e};return await D2(n,r),r.token}async function zz(n,e){const t=await n.pushManager.getSubscription();return t||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Cz(e)})}function $z(n,e){const t=e.vapidKey===n.vapidKey,r=e.endpoint===n.endpoint,i=e.auth===n.auth,o=e.p256dh===n.p256dh;return t&&r&&i&&o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qz(n){const e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return Hz(e,n),Gz(e,n),Wz(e,n),e}function Hz(n,e){if(!e.notification)return;n.notification={};const t=e.notification.title;t&&(n.notification.title=t);const r=e.notification.body;r&&(n.notification.body=r);const i=e.notification.image;i&&(n.notification.image=i);const o=e.notification.icon;o&&(n.notification.icon=o)}function Gz(n,e){e.data&&(n.data=e.data)}function Wz(n,e){var i,o,c,u;if(!e.fcmOptions&&!((i=e.notification)!=null&&i.click_action))return;n.fcmOptions={};const t=((o=e.fcmOptions)==null?void 0:o.link)??((c=e.notification)==null?void 0:c.click_action);t&&(n.fcmOptions.link=t);const r=(u=e.fcmOptions)==null?void 0:u.analytics_label;r&&(n.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kz(n){return typeof n=="object"&&!!n&&Ez in n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qz(n){return new Promise(e=>{setTimeout(e,n)})}async function Yz(n,e){const t=Xz(e,await n.firebaseDependencies.installations.getId());Jz(n,t,e.productId)}function Xz(n,e){var r,i;const t={};return n.from&&(t.project_number=n.from),n.fcmMessageId&&(t.message_id=n.fcmMessageId),t.instance_id=e,n.notification?t.message_type=qx.DISPLAY_NOTIFICATION.toString():t.message_type=qx.DATA_MESSAGE.toString(),t.sdk_platform=Tz.toString(),t.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),n.collapse_key&&(t.collapse_key=n.collapse_key),t.event=Iz.toString(),(r=n.fcmOptions)!=null&&r.analytics_label&&(t.analytics_label=(i=n.fcmOptions)==null?void 0:i.analytics_label),t}function Jz(n,e,t){const r={};r.event_time_ms=Math.floor(Date.now()).toString(),r.source_extension_json_proto3=JSON.stringify({messaging_client_event:e}),t&&(r.compliance_data=Zz(t)),n.logEvents.push(r)}function Zz(n){return{privacy_context:{prequest:{origin_associated_product_id:n}}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e$(n,e){var i;const{newSubscription:t}=n;if(!t){await CC(e);return}const r=await R2(e.firebaseDependencies);await CC(e),e.vapidKey=((i=r==null?void 0:r.subscriptionOptions)==null?void 0:i.vapidKey)??mD,await Uz(e)}async function t$(n,e){const t=r$(n);if(!t)return;e.deliveryMetricsExportedToBigQueryEnabled&&await Yz(e,t);const r=await bD();if(a$(r))return o$(r,t);if(t.notification&&await l$(s$(t)),!!e&&e.onBackgroundMessageHandler){const i=qz(t);typeof e.onBackgroundMessageHandler=="function"?await e.onBackgroundMessageHandler(i):e.onBackgroundMessageHandler.next(i)}}async function n$(n){var c,u;const e=(u=(c=n.notification)==null?void 0:c.data)==null?void 0:u[gD];if(e){if(n.action)return}else return;n.stopImmediatePropagation(),n.notification.close();const t=c$(e);if(!t)return;const r=new URL(t,self.location.href),i=new URL(self.location.origin);if(r.host!==i.host)return;let o=await i$(r);if(o?o=await o.focus():(o=await self.clients.openWindow(t),await Qz(3e3)),!!o)return e.messageType=Hx.NOTIFICATION_CLICKED,e.isFirebaseMessaging=!0,o.postMessage(e)}function s$(n){const e={...n.notification};return e.data={[gD]:n},e}function r$({data:n}){if(!n)return null;try{return n.json()}catch{return null}}async function i$(n){const e=await bD();for(const t of e){const r=new URL(t.url,self.location.href);if(n.host===r.host)return t}return null}function a$(n){return n.some(e=>e.visibilityState==="visible"&&!e.url.startsWith("chrome-extension://"))}function o$(n,e){e.isFirebaseMessaging=!0,e.messageType=Hx.PUSH_RECEIVED;for(const t of n)t.postMessage(e)}function bD(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function l$(n){const{actions:e}=n,{maxActions:t}=Notification;return e&&t&&e.length>t&&console.warn(`This browser only supports ${t} actions. The remaining actions will not be displayed.`),self.registration.showNotification(n.title??"",n)}function c$(n){var t,r;const e=((t=n.fcmOptions)==null?void 0:t.link)??((r=n.notification)==null?void 0:r.click_action);return e||(Kz(n.data)?self.location.origin:null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d$(n){if(!n||!n.options)throw e_("App Configuration Object");if(!n.name)throw e_("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(const r of e)if(!t[r])throw e_(r);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function e_(n){return Da.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u${constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=d$(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h$=n=>{const e=new u$(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return self.addEventListener("push",t=>{t.waitUntil(t$(t,e))}),self.addEventListener("pushsubscriptionchange",t=>{t.waitUntil(e$(t,e))}),self.addEventListener("notificationclick",t=>{t.waitUntil(n$(t))}),e};function f$(){hr(new $n("messaging-sw",h$,"PUBLIC"))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m$(n,e){if(self.document!==void 0)throw Da.create("only-available-in-sw");return n.onBackgroundMessageHandler=e,()=>{n.onBackgroundMessageHandler=null}}function g$(n,e){return n=Xe(n),m$(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */f$();const p$="@firebase/messaging-compat",x$="0.2.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b$(){return self&&"ServiceWorkerGlobalScope"in self?v$():y$()}function y$(){return typeof window<"u"&&sd()&&$L()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function v$(){return sd()&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}class kC{constructor(e,t){this.app=e,this._delegate=t,this.app=e,this._delegate=t}async getToken(e){return _z(this._delegate,e)}async deleteToken(){return Nz(this._delegate)}onMessage(e){return jz(this._delegate,e)}onBackgroundMessage(e){return g$(this._delegate,e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w$=n=>self&&"ServiceWorkerGlobalScope"in self?new kC(n.getProvider("app-compat").getImmediate(),n.getProvider("messaging-sw").getImmediate()):new kC(n.getProvider("app-compat").getImmediate(),n.getProvider("messaging").getImmediate()),_$={isSupported:b$};function N$(){Nt.INTERNAL.registerComponent(new $n("messaging-compat",w$,"PUBLIC").setServiceProps(_$))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */N$();Nt.registerVersion(p$,x$);const im={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},Cu={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j$(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function yD(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const S$=j$,E$=yD,vD=new za("auth","Firebase",yD());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gx=new Ph("@firebase/auth");function T$(n,...e){Gx.logLevel<=Ot.WARN&&Gx.warn(`Auth (${$a}): ${n}`,...e)}function bx(n,...e){Gx.logLevel<=Ot.ERROR&&Gx.error(`Auth (${$a}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qs(n,...e){throw V2(n,...e)}function xs(n,...e){return V2(n,...e)}function L2(n,e,t){const r={...E$(),[e]:t};return new za("auth","Firebase",r).create(e,{appName:n.name})}function Cs(n){return L2(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qh(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&qs(n,"argument-error"),L2(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function V2(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return vD.create(n,...e)}function ze(n,e,...t){if(!n)throw V2(e,...t)}function Aa(n){const e="INTERNAL ASSERTION FAILED: "+n;throw bx(e),new Error(e)}function Qi(n,e){n||Aa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pg(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function F2(){return RC()==="http:"||RC()==="https:"}function RC(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I$(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(F2()||A4()||"connection"in navigator)?navigator.onLine:!0}function C$(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e,t){this.shortDelay=e,this.longDelay=t,Qi(t>e,"Short delay should be less than long delay!"),this.isMobile=oN()||bb()}get(){return I$()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U2(n,e){Qi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Aa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Aa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Aa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A$={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k$=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],R$=new Gg(3e4,6e4);function Hn(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Gn(n,e,t,r,i={}){return _D(n,i,async()=>{let o={},c={};r&&(e==="GET"?c=r:o={body:JSON.stringify(r)});const u=Td({key:n.config.apiKey,...c}).slice(1),h=await n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);const m={method:e,headers:h,...o};return UL()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&Ba(n.emulatorConfig.host)&&(m.credentials="include"),wD.fetch()(await ND(n,n.config.apiHost,t,u),m)})}async function _D(n,e,t){n._canInitEmulator=!1;const r={...A$,...e};try{const i=new P$(n),o=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const c=await o.json();if("needConfirmation"in c)throw _m(n,"account-exists-with-different-credential",c);if(o.ok&&!("errorMessage"in c))return c;{const u=o.ok?c.errorMessage:c.error.message,[h,m]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw _m(n,"credential-already-in-use",c);if(h==="EMAIL_EXISTS")throw _m(n,"email-already-in-use",c);if(h==="USER_DISABLED")throw _m(n,"user-disabled",c);const p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw L2(n,p,m);qs(n,p)}}catch(i){if(i instanceof Us)throw i;qs(n,"network-request-failed",{message:String(i)})}}async function Do(n,e,t,r,i={}){const o=await Gn(n,e,t,r,i);return"mfaPendingCredential"in o&&qs(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function ND(n,e,t,r){const i=`${e}${t}?${r}`,o=n,c=o.config.emulator?U2(n.config,i):`${n.config.apiScheme}://${i}`;return k$.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(c).toString():c}function D$(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class P${clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(xs(this.auth,"network-request-failed")),R$.get())})}}function _m(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=xs(n,e,r);return i.customData._tokenResponse=t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DC(n){return n!==void 0&&n.getResponse!==void 0}function PC(n){return n!==void 0&&n.enterprise!==void 0}class jD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return D$(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O$(n){return(await Gn(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function SD(n,e){return Gn(n,"GET","/v2/recaptchaConfig",Hn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M$(n,e){return Gn(n,"POST","/v1/accounts:delete",e)}async function L$(n,e){return Gn(n,"POST","/v1/accounts:update",e)}async function Wx(n,e){return Gn(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mm(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function V$(n,e=!1){const t=Xe(n),r=await t.getIdToken(e),i=Gb(r);ze(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,c=o==null?void 0:o.sign_in_provider;return{claims:i,token:r,authTime:Mm(t_(i.auth_time)),issuedAtTime:Mm(t_(i.iat)),expirationTime:Mm(t_(i.exp)),signInProvider:c||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function t_(n){return Number(n)*1e3}function Gb(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return bx("JWT malformed, contained fewer than 3 sections"),null;try{const i=Wm(t);return i?JSON.parse(i):(bx("Failed to decode base64 JWT payload"),null)}catch(i){return bx("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function OC(n){const e=Gb(n);return ze(e,"internal-error"),ze(typeof e.exp<"u","internal-error"),ze(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eo(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Us&&F$(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function F$({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U${constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Mm(this.lastLoginAt),this.creationTime=Mm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xg(n){var b;const e=n.auth,t=await n.getIdToken(),r=await Eo(n,Wx(e,{idToken:t}));ze(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const o=(b=i.providerUserInfo)!=null&&b.length?ED(i.providerUserInfo):[],c=z$(n.providerData,o),u=n.isAnonymous,h=!(n.email&&i.passwordHash)&&!(c!=null&&c.length),m=u?h:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new g1(i.createdAt,i.lastLoginAt),isAnonymous:m};Object.assign(n,p)}async function B$(n){const e=Xe(n);await xg(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function z$(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function ED(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $$(n,e){const t=await _D(n,{},async()=>{const r=Td({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,c=await ND(n,i,"/v1/token",`key=${o}`),u=await n._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:u,body:r};return n.emulatorConfig&&Ba(n.emulatorConfig.host)&&(h.credentials="include"),wD.fetch()(c,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function q$(n,e){return Gn(n,"POST","/v2/accounts:revokeToken",Hn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ze(e.idToken,"internal-error"),ze(typeof e.idToken<"u","internal-error"),ze(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):OC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ze(e.length!==0,"internal-error");const t=OC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ze(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:o}=await $$(e,t);this.updateTokensAndExpiration(r,i,Number(o))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:o}=t,c=new qu;return r&&(ze(typeof r=="string","internal-error",{appName:e}),c.refreshToken=r),i&&(ze(typeof i=="string","internal-error",{appName:e}),c.accessToken=i),o&&(ze(typeof o=="number","internal-error",{appName:e}),c.expirationTime=o),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new qu,this.toJSON())}_performRefresh(){return Aa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bl(n,e){ze(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class zi{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new U$(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new g1(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Eo(this,this.stsTokenManager.getToken(this.auth,e));return ze(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return V$(this,e)}reload(){return B$(this)}_assign(e){this!==e&&(ze(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new zi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ze(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await xg(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(bn(this.auth.app))return Promise.reject(Cs(this.auth));const e=await this.getIdToken();return await Eo(this,M$(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,o=t.phoneNumber??void 0,c=t.photoURL??void 0,u=t.tenantId??void 0,h=t._redirectEventId??void 0,m=t.createdAt??void 0,p=t.lastLoginAt??void 0,{uid:b,emailVerified:v,isAnonymous:_,providerData:T,stsTokenManager:k}=t;ze(b&&k,e,"internal-error");const E=qu.fromJSON(this.name,k);ze(typeof b=="string",e,"internal-error"),bl(r,e.name),bl(i,e.name),ze(typeof v=="boolean",e,"internal-error"),ze(typeof _=="boolean",e,"internal-error"),bl(o,e.name),bl(c,e.name),bl(u,e.name),bl(h,e.name),bl(m,e.name),bl(p,e.name);const S=new zi({uid:b,auth:e,email:i,emailVerified:v,displayName:r,isAnonymous:_,photoURL:c,phoneNumber:o,tenantId:u,stsTokenManager:E,createdAt:m,lastLoginAt:p});return T&&Array.isArray(T)&&(S.providerData=T.map(L=>({...L}))),h&&(S._redirectEventId=h),S}static async _fromIdTokenResponse(e,t,r=!1){const i=new qu;i.updateFromServerResponse(t);const o=new zi({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await xg(o),o}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];ze(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?ED(i.providerUserInfo):[],c=!(i.email&&i.passwordHash)&&!(o!=null&&o.length),u=new qu;u.updateFromIdToken(r);const h=new zi({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:c}),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new g1(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(o!=null&&o.length)};return Object.assign(h,m),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MC=new Map;function Wr(n){Qi(n instanceof Function,"Expected a class definition");let e=MC.get(n);return e?(Qi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,MC.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}TD.type="NONE";const Nh=TD;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jc(n,e,t){return`firebase:${n}:${e}:${t}`}class Hu{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:o}=this.auth;this.fullUserKey=Jc(this.userKey,i.apiKey,o),this.fullPersistenceKey=Jc("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Wx(this.auth,{idToken:e}).catch(()=>{});return t?zi._fromGetAccountInfoResponse(this.auth,t,e):null}return zi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Hu(Wr(Nh),e,r);const i=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let o=i[0]||Wr(Nh);const c=Jc(r,e.config.apiKey,e.name);let u=null;for(const m of t)try{const p=await m._get(c);if(p){let b;if(typeof p=="string"){const v=await Wx(e,{idToken:p}).catch(()=>{});if(!v)break;b=await zi._fromGetAccountInfoResponse(e,v,p)}else b=zi._fromJSON(e,p);m!==o&&(u=b),o=m;break}}catch{}const h=i.filter(m=>m._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new Hu(o,e,r):(o=h[0],u&&await o._set(c,u.toJSON()),await Promise.all(t.map(async m=>{if(m!==o)try{await m._remove(c)}catch{}})),new Hu(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(kD(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ID(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(RD(e))return"Blackberry";if(DD(e))return"Webos";if(CD(e))return"Safari";if((e.includes("chrome/")||AD(e))&&!e.includes("edge/"))return"Chrome";if(Wg(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function ID(n=Mn()){return/firefox\//i.test(n)}function CD(n=Mn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function AD(n=Mn()){return/crios\//i.test(n)}function kD(n=Mn()){return/iemobile/i.test(n)}function Wg(n=Mn()){return/android/i.test(n)}function RD(n=Mn()){return/blackberry/i.test(n)}function DD(n=Mn()){return/webos/i.test(n)}function Kg(n=Mn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function H$(n=Mn()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function G$(n=Mn()){var e;return Kg(n)&&!!((e=window.navigator)!=null&&e.standalone)}function W$(){return k4()&&document.documentMode===10}function PD(n=Mn()){return Kg(n)||Wg(n)||DD(n)||RD(n)||/windows phone/i.test(n)||kD(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OD(n,e=[]){let t;switch(n){case"Browser":t=LC(Mn());break;case"Worker":t=`${LC(Mn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${$a}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K${constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=o=>new Promise((c,u)=>{try{const h=e(o);c(h)}catch(h){u(h)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q$(n,e={}){return Gn(n,"GET","/v2/passwordPolicy",Hn(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y$=6;class X${constructor(e){var r;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Y$,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J${constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new VC(this),this.idTokenSubscription=new VC(this),this.beforeStateQueue=new K$(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=vD,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Wr(t)),this._initializationPromise=this.queue(async()=>{var r,i,o;if(!this._deleted&&(this.persistenceManager=await Hu.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)==null?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Wx(this,{idToken:e}),r=await zi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var o;if(bn(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(o=this.redirectUser)==null?void 0:o._redirectEventId,u=r==null?void 0:r._redirectEventId,h=await this.tryRedirectSignIn(e);(!c||c===u)&&(h!=null&&h.user)&&(r=h.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(c){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ze(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await xg(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=C$()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(bn(this.app))return Promise.reject(Cs(this));const t=e?Xe(e):null;return t&&ze(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ze(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return bn(this.app)?Promise.reject(Cs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return bn(this.app)?Promise.reject(Cs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Wr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Q$(this),t=new X$(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new za("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await q$(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Wr(e)||this._popupRedirectResolver;ze(t,this,"argument-error"),this.redirectPersistenceManager=await Hu.create(this,[Wr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let c=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(ze(u,this,"internal-error"),u.then(()=>{c||o(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,r,i);return()=>{c=!0,h()}}else{const h=e.addObserver(t);return()=>{c=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ze(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=OD(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(bn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&T$(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Vn(n){return Xe(n)}class VC{constructor(e){this.auth=e,this.observer=null,this.addObserver=O4(t=>this.observer=t)}get next(){return ze(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Z$(n){Qg=n}function B2(n){return Qg.loadJS(n)}function eq(){return Qg.recaptchaV2Script}function tq(){return Qg.recaptchaEnterpriseScript}function nq(){return Qg.gapiScript}function MD(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sq=500,rq=6e4,zp=1e12;class iq{constructor(e){this.auth=e,this.counter=zp,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new lq(e,this.auth.name,t||{})),this.counter++,r}reset(e){var r;const t=e||zp;(r=this._widgets.get(t))==null||r.delete(),this._widgets.delete(t)}getResponse(e){var r;const t=e||zp;return((r=this._widgets.get(t))==null?void 0:r.getResponse())||""}async execute(e){var r;const t=e||zp;return(r=this._widgets.get(t))==null||r.execute(),""}}class aq{constructor(){this.enterprise=new oq}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class oq{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class lq{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;ze(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=cq(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},rq)},sq))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function cq(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const dq="recaptcha-enterprise",Lm="NO_RECAPTCHA";class LD{constructor(e){this.type=dq,this.auth=Vn(e)}async verify(e="verify",t=!1){async function r(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(c,u)=>{SD(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const m=new jD(h);return o.tenantId==null?o._agentRecaptchaConfig=m:o._tenantRecaptchaConfigs[o.tenantId]=m,c(m.siteKey)}}).catch(h=>{u(h)})})}function i(o,c,u){const h=window.grecaptcha;PC(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(m=>{c(m)}).catch(()=>{c(Lm)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new aq().execute("siteKey",{action:"verify"}):new Promise((o,c)=>{r(this.auth).then(u=>{if(!t&&PC(window.grecaptcha))i(u,o,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let h=tq();h.length!==0&&(h+=u),B2(h).then(()=>{i(u,o,c)}).catch(m=>{c(m)})}}).catch(u=>{c(u)})})}}async function am(n,e,t,r=!1,i=!1){const o=new LD(n);let c;if(i)c=Lm;else try{c=await o.verify(t)}catch{c=await o.verify(t,!0)}const u={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const h=u.phoneEnrollmentInfo.phoneNumber,m=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:m,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const h=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return r?Object.assign(u,{captchaResp:c}):Object.assign(u,{captchaResponse:c}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function Rl(n,e,t,r,i){var o,c;if(i==="EMAIL_PASSWORD_PROVIDER")if((o=n._getRecaptchaConfig())!=null&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await am(n,e,t,t==="getOobCode");return r(n,u)}else return r(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const h=await am(n,e,t,t==="getOobCode");return r(n,h)}else return Promise.reject(u)});else if(i==="PHONE_PROVIDER")if((c=n._getRecaptchaConfig())!=null&&c.isProviderEnabled("PHONE_PROVIDER")){const u=await am(n,e,t);return r(n,u).catch(async h=>{var m;if(((m=n._getRecaptchaConfig())==null?void 0:m.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(h.code==="auth/missing-recaptcha-token"||h.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const p=await am(n,e,t,!1,!0);return r(n,p)}return Promise.reject(h)})}else{const u=await am(n,e,t,!1,!0);return r(n,u)}else return Promise.reject(i+" provider is not supported.")}async function uq(n){const e=Vn(n),t=await SD(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new jD(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new LD(e).verify()}function hq(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Wr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function fq(n,e,t){const r=Vn(n);ze(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(t!=null&&t.disableWarnings),o=VD(e),{host:c,port:u}=mq(e),h=u===null?"":`:${u}`,m={url:`${o}//${c}${h}/`},p=Object.freeze({host:c,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){ze(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ze(_o(m,r.config.emulator)&&_o(p,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=m,r.emulatorConfig=p,r.settings.appVerificationDisabledForTesting=!0,Ba(c)?(gb(`${o}//${c}${h}`),pb("Auth",!0)):i||gq()}function VD(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function mq(n){const e=VD(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const o=i[1];return{host:o,port:FC(r.substr(o.length+1))}}else{const[o,c]=r.split(":");return{host:o,port:FC(c)}}}function FC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function gq(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Aa("not implemented")}_getIdTokenResponse(e){return Aa("not implemented")}_linkToIdToken(e,t){return Aa("not implemented")}_getReauthenticationResolver(e){return Aa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FD(n,e){return Gn(n,"POST","/v1/accounts:resetPassword",Hn(n,e))}async function pq(n,e){return Gn(n,"POST","/v1/accounts:update",e)}async function xq(n,e){return Gn(n,"POST","/v1/accounts:signUp",e)}async function bq(n,e){return Gn(n,"POST","/v1/accounts:update",Hn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yq(n,e){return Do(n,"POST","/v1/accounts:signInWithPassword",Hn(n,e))}async function Wb(n,e){return Gn(n,"POST","/v1/accounts:sendOobCode",Hn(n,e))}async function vq(n,e){return Wb(n,e)}async function wq(n,e){return Wb(n,e)}async function _q(n,e){return Wb(n,e)}async function Nq(n,e){return Wb(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jq(n,e){return Do(n,"POST","/v1/accounts:signInWithEmailLink",Hn(n,e))}async function Sq(n,e){return Do(n,"POST","/v1/accounts:signInWithEmailLink",Hn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bg extends Hh{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new bg(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new bg(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Rl(e,t,"signInWithPassword",yq,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return jq(e,{email:this._email,oobCode:this._password});default:qs(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Rl(e,r,"signUpPassword",xq,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Sq(e,{idToken:t,email:this._email,oobCode:this._password});default:qs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yo(n,e){return Do(n,"POST","/v1/accounts:signInWithIdp",Hn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eq="http://localhost";class Va extends Hh{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Va(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):qs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...o}=t;if(!r||!i)return null;const c=new Va(r,i);return c.idToken=o.idToken||void 0,c.accessToken=o.accessToken||void 0,c.secret=o.secret,c.nonce=o.nonce,c.pendingToken=o.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return yo(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,yo(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,yo(e,t)}buildRequest(){const e={requestUri:Eq,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Td(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UC(n,e){return Gn(n,"POST","/v1/accounts:sendVerificationCode",Hn(n,e))}async function Tq(n,e){return Do(n,"POST","/v1/accounts:signInWithPhoneNumber",Hn(n,e))}async function Iq(n,e){const t=await Do(n,"POST","/v1/accounts:signInWithPhoneNumber",Hn(n,e));if(t.temporaryProof)throw _m(n,"account-exists-with-different-credential",t);return t}const Cq={USER_NOT_FOUND:"user-not-found"};async function Aq(n,e){const t={...e,operation:"REAUTH"};return Do(n,"POST","/v1/accounts:signInWithPhoneNumber",Hn(n,t),Cq)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc extends Hh{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Zc({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Zc({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return Tq(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return Iq(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return Aq(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:o}=e;return!r&&!t&&!i&&!o?null:new Zc({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kq(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Rq(n){const e=Fu(pm(n)).link,t=e?Fu(pm(e)).deep_link_id:null,r=Fu(pm(n)).deep_link_id;return(r?Fu(pm(r)).link:null)||r||t||e||n}class Kb{constructor(e){const t=Fu(pm(e)),r=t.apiKey??null,i=t.oobCode??null,o=kq(t.mode??null);ze(r&&i&&o,"argument-error"),this.apiKey=r,this.operation=o,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=Rq(e);try{return new Kb(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(){this.providerId=rc.PROVIDER_ID}static credential(e,t){return bg._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Kb.parseLink(t);return ze(r,"argument-error"),bg._fromEmailAndCode(e,r.code,r.tenantId)}}rc.PROVIDER_ID="password";rc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";rc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh extends Po{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Gu extends Gh{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return ze("providerId"in t&&"signInMethod"in t,"argument-error"),Va._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return ze(e.idToken||e.accessToken,"argument-error"),Va._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return Gu.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Gu.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:o,nonce:c,providerId:u}=e;if(!r&&!i&&!t&&!o||!u)return null;try{return new Gu(u)._credential({idToken:t,accessToken:r,nonce:c,pendingToken:o})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na extends Gh{constructor(){super("facebook.com")}static credential(e){return Va._fromParams({providerId:Na.PROVIDER_ID,signInMethod:Na.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Na.credentialFromTaggedObject(e)}static credentialFromError(e){return Na.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Na.credential(e.oauthAccessToken)}catch{return null}}}Na.FACEBOOK_SIGN_IN_METHOD="facebook.com";Na.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja extends Gh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Va._fromParams({providerId:ja.PROVIDER_ID,signInMethod:ja.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ja.credentialFromTaggedObject(e)}static credentialFromError(e){return ja.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return ja.credential(t,r)}catch{return null}}}ja.GOOGLE_SIGN_IN_METHOD="google.com";ja.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa extends Gh{constructor(){super("github.com")}static credential(e){return Va._fromParams({providerId:Sa.PROVIDER_ID,signInMethod:Sa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Sa.credentialFromTaggedObject(e)}static credentialFromError(e){return Sa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Sa.credential(e.oauthAccessToken)}catch{return null}}}Sa.GITHUB_SIGN_IN_METHOD="github.com";Sa.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dq="http://localhost";class jh extends Hh{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return yo(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,yo(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,yo(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:o}=t;return!r||!i||!o||r!==i?null:new jh(r,o)}static _create(e,t){return new jh(e,t)}buildRequest(){return{requestUri:Dq,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pq="saml.";class Kx extends Po{constructor(e){ze(e.startsWith(Pq),"argument-error"),super(e)}static credentialFromResult(e){return Kx.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Kx.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=jh.fromJSON(e);return ze(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return jh._create(r,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea extends Gh{constructor(){super("twitter.com")}static credential(e,t){return Va._fromParams({providerId:Ea.PROVIDER_ID,signInMethod:Ea.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ea.credentialFromTaggedObject(e)}static credentialFromError(e){return Ea.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Ea.credential(t,r)}catch{return null}}}Ea.TWITTER_SIGN_IN_METHOD="twitter.com";Ea.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UD(n,e){return Do(n,"POST","/v1/accounts:signUp",Hn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const o=await zi._fromIdTokenResponse(e,r,i),c=BC(r);return new ji({user:o,providerId:c,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=BC(r);return new ji({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function BC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oq(n){var i;if(bn(n.app))return Promise.reject(Cs(n));const e=Vn(n);if(await e._initializationPromise,(i=e.currentUser)!=null&&i.isAnonymous)return new ji({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await UD(e,{returnSecureToken:!0}),r=await ji._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx extends Us{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Qx.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new Qx(e,t,r,i)}}function BD(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Qx._fromErrorAndOperation(n,o,e,r):o})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zD(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mq(n,e){const t=Xe(n);await Qb(!0,t,e);const{providerUserInfo:r}=await L$(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),i=zD(r||[]);return t.providerData=t.providerData.filter(o=>i.has(o.providerId)),i.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function z2(n,e,t=!1){const r=await Eo(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return ji._forOperation(n,"link",r)}async function Qb(n,e,t){await xg(e);const r=zD(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";ze(r.has(t)===n,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $D(n,e,t=!1){const{auth:r}=n;if(bn(r.app))return Promise.reject(Cs(r));const i="reauthenticate";try{const o=await Eo(n,BD(r,i,e,n),t);ze(o.idToken,r,"internal-error");const c=Gb(o.idToken);ze(c,r,"internal-error");const{sub:u}=c;return ze(n.uid===u,r,"user-mismatch"),ji._forOperation(n,i,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&qs(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qD(n,e,t=!1){if(bn(n.app))return Promise.reject(Cs(n));const r="signIn",i=await BD(n,r,e),o=await ji._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(o.user),o}async function Yb(n,e){return qD(Vn(n),e)}async function HD(n,e){const t=Xe(n);return await Qb(!1,t,e.providerId),z2(t,e)}async function GD(n,e){return $D(Xe(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lq(n,e){return Do(n,"POST","/v1/accounts:signInWithCustomToken",Hn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vq(n,e){if(bn(n.app))return Promise.reject(Cs(n));const t=Vn(n),r=await Lq(t,{token:e,returnSecureToken:!0}),i=await ji._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?$2._fromServerResponse(e,t):"totpInfo"in t?q2._fromServerResponse(e,t):qs(e,"internal-error")}}class $2 extends Yg{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new $2(t)}}class q2 extends Yg{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new q2(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xb(n,e,t){var r;ze(((r=t.url)==null?void 0:r.length)>0,n,"invalid-continue-uri"),ze(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),ze(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(ze(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(ze(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H2(n){const e=Vn(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Fq(n,e,t){const r=Vn(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Xb(r,i,t),await Rl(r,i,"getOobCode",wq,"EMAIL_PASSWORD_PROVIDER")}async function Uq(n,e,t){await FD(Xe(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&H2(n),r})}async function Bq(n,e){await bq(Xe(n),{oobCode:e})}async function WD(n,e){const t=Xe(n),r=await FD(t,{oobCode:e}),i=r.requestType;switch(ze(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":ze(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":ze(r.mfaInfo,t,"internal-error");default:ze(r.email,t,"internal-error")}let o=null;return r.mfaInfo&&(o=Yg._fromServerResponse(Vn(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:o},operation:i}}async function zq(n,e){const{data:t}=await WD(Xe(n),e);return t.email}async function $q(n,e,t){if(bn(n.app))return Promise.reject(Cs(n));const r=Vn(n),c=await Rl(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",UD,"EMAIL_PASSWORD_PROVIDER").catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&H2(n),h}),u=await ji._fromIdTokenResponse(r,"signIn",c);return await r._updateCurrentUser(u.user),u}function qq(n,e,t){return bn(n.app)?Promise.reject(Cs(n)):Yb(Xe(n),rc.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&H2(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hq(n,e,t){const r=Vn(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function o(c,u){ze(u.handleCodeInApp,r,"argument-error"),u&&Xb(r,c,u)}o(i,t),await Rl(r,i,"getOobCode",_q,"EMAIL_PASSWORD_PROVIDER")}function Gq(n,e){const t=Kb.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function Wq(n,e,t){if(bn(n.app))return Promise.reject(Cs(n));const r=Xe(n),i=rc.credentialWithLink(e,t||pg());return ze(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Yb(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kq(n,e){return Gn(n,"POST","/v1/accounts:createAuthUri",Hn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qq(n,e){const t=F2()?pg():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=await Kq(Xe(n),r);return i||[]}async function Yq(n,e){const t=Xe(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&Xb(t.auth,i,e);const{email:o}=await vq(t.auth,i);o!==n.email&&await n.reload()}async function Xq(n,e,t){const r=Xe(n),o={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&Xb(r.auth,o,t);const{email:c}=await Nq(r.auth,o);c!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jq(n,e){return Gn(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zq(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Xe(n),o={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=await Eo(r,Jq(r.auth,o));r.displayName=c.displayName||null,r.photoURL=c.photoUrl||null;const u=r.providerData.find(({providerId:h})=>h==="password");u&&(u.displayName=r.displayName,u.photoURL=r.photoURL),await r._updateTokensIfNecessary(c)}function eH(n,e){const t=Xe(n);return bn(t.auth.app)?Promise.reject(Cs(t.auth)):KD(t,e,null)}function tH(n,e){return KD(Xe(n),null,e)}async function KD(n,e,t){const{auth:r}=n,o={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(o.email=e),t&&(o.password=t);const c=await Eo(n,pq(r,o));await n._updateTokensIfNecessary(c,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nH(n){var i,o;if(!n)return null;const{providerId:e}=n,t=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},r=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&(n!=null&&n.idToken)){const c=(o=(i=Gb(n.idToken))==null?void 0:i.firebase)==null?void 0:o.sign_in_provider;if(c){const u=c!=="anonymous"&&c!=="custom"?c:null;return new Wu(r,u)}}if(!e)return null;switch(e){case"facebook.com":return new sH(r,t);case"github.com":return new rH(r,t);case"google.com":return new iH(r,t);case"twitter.com":return new aH(r,t,n.screenName||null);case"custom":case"anonymous":return new Wu(r,null);default:return new Wu(r,e,t)}}class Wu{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class QD extends Wu{constructor(e,t,r,i){super(e,t,r),this.username=i}}class sH extends Wu{constructor(e,t){super(e,"facebook.com",t)}}class rH extends QD{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class iH extends Wu{constructor(e,t){super(e,"google.com",t)}}class aH extends QD{constructor(e,t,r){super(e,"twitter.com",t,r)}}function oH(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:nH(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new Qc("enroll",e,t)}static _fromMfaPendingCredential(e){return new Qc("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if((t=e.multiFactorSession)!=null&&t.pendingCredential)return Qc._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if((r=e.multiFactorSession)!=null&&r.idToken)return Qc._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=Vn(e),i=t.customData._serverResponse,o=(i.mfaInfo||[]).map(u=>Yg._fromServerResponse(r,u));ze(i.mfaPendingCredential,r,"internal-error");const c=Qc._fromMfaPendingCredential(i.mfaPendingCredential);return new G2(c,o,async u=>{const h=await u._process(r,c);delete i.mfaInfo,delete i.mfaPendingCredential;const m={...i,idToken:h.idToken,refreshToken:h.refreshToken};switch(t.operationType){case"signIn":const p=await ji._fromIdTokenResponse(r,t.operationType,m);return await r._updateCurrentUser(p.user),p;case"reauthenticate":return ze(t.user,r,"internal-error"),ji._forOperation(t.user,t.operationType,m);default:qs(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function lH(n,e){var i;const t=Xe(n),r=e;return ze(e.customData.operationType,t,"argument-error"),ze((i=r.customData._serverResponse)==null?void 0:i.mfaPendingCredential,t,"argument-error"),G2._fromError(t,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zC(n,e){return Gn(n,"POST","/v2/accounts/mfaEnrollment:start",Hn(n,e))}function cH(n,e){return Gn(n,"POST","/v2/accounts/mfaEnrollment:finalize",Hn(n,e))}function dH(n,e){return Gn(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Hn(n,e))}class W2{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Yg._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new W2(e)}async getSession(){return Qc._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,i=await this.getSession(),o=await Eo(this.user,r._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(o),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await Eo(this.user,dH(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:o})=>o!==t),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const n_=new WeakMap;function uH(n){const e=Xe(n);return n_.has(e)||n_.set(e,W2._fromUser(e)),n_.get(e)}const Yx="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Yx,"1"),this.storage.removeItem(Yx),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hH=1e3,fH=10;class XD extends YD{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=PD(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,u,h)=>{this.notifyListeners(c,h)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const c=this.storage.getItem(r);!t&&this.localCache[r]===c||this.notifyListeners(r,c)},o=this.storage.getItem(r);W$()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,fH):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},hH)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}XD.type="LOCAL";const K2=XD;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD extends YD{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}JD.type="SESSION";const vd=JD;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mH(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Jb(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:o}=t.data,c=this.handlersMap[i];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const u=Array.from(c).map(async m=>m(t.origin,o)),h=await mH(u);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Jb.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xg(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gH{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,c;return new Promise((u,h)=>{const m=Xg("",20);i.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},r);c={messageChannel:i,onMessage(b){const v=b;if(v.data.eventId===m)switch(v.data.status){case"ack":clearTimeout(p),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(v.data.response);break;default:clearTimeout(p),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(c),i.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[i.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cs(){return window}function pH(n){cs().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q2(){return typeof cs().WorkerGlobalScope<"u"&&typeof cs().importScripts=="function"}async function xH(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function bH(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function yH(){return Q2()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZD="firebaseLocalStorageDb",vH=1,Xx="firebaseLocalStorage",eP="fbase_key";class Jg{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Zb(n,e){return n.transaction([Xx],e?"readwrite":"readonly").objectStore(Xx)}function wH(){const n=indexedDB.deleteDatabase(ZD);return new Jg(n).toPromise()}function p1(){const n=indexedDB.open(ZD,vH);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Xx,{keyPath:eP})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Xx)?e(r):(r.close(),await wH(),e(await p1()))})})}async function $C(n,e,t){const r=Zb(n,!0).put({[eP]:e,value:t});return new Jg(r).toPromise()}async function _H(n,e){const t=Zb(n,!1).get(e),r=await new Jg(t).toPromise();return r===void 0?null:r.value}function qC(n,e){const t=Zb(n,!0).delete(e);return new Jg(t).toPromise()}const NH=800,jH=3;class tP{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await p1(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>jH)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Q2()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Jb._getInstance(yH()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await xH(),!this.activeServiceWorker)return;this.sender=new gH(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||bH()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await p1();return await $C(e,Yx,"1"),await qC(e,Yx),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>$C(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>_H(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>qC(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Zb(i,!1).getAll();return new Jg(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),NH)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}tP.type="LOCAL";const yg=tP;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HC(n,e){return Gn(n,"POST","/v2/accounts/mfaSignIn:start",Hn(n,e))}function SH(n,e){return Gn(n,"POST","/v2/accounts/mfaSignIn:finalize",Hn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s_=MD("rcb"),EH=new Gg(3e4,6e4);class TH{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!((e=cs().grecaptcha)!=null&&e.render)}load(e,t=""){return ze(IH(t),e,"argument-error"),this.shouldResolveImmediately(t)&&DC(cs().grecaptcha)?Promise.resolve(cs().grecaptcha):new Promise((r,i)=>{const o=cs().setTimeout(()=>{i(xs(e,"network-request-failed"))},EH.get());cs()[s_]=()=>{cs().clearTimeout(o),delete cs()[s_];const u=cs().grecaptcha;if(!u||!DC(u)){i(xs(e,"internal-error"));return}const h=u.render;u.render=(m,p)=>{const b=h(m,p);return this.counter++,b},this.hostLanguage=t,r(u)};const c=`${eq()}?${Td({onload:s_,render:"explicit",hl:t})}`;B2(c).catch(()=>{clearTimeout(o),i(xs(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!((t=cs().grecaptcha)!=null&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function IH(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class CH{async load(e){return new iq(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm="recaptcha",AH={theme:"light",type:"image"};let kH=class{constructor(e,t,r={...AH}){this.parameters=r,this.type=Vm,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Vn(e),this.isInvisible=this.parameters.size==="invisible",ze(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof t=="string"?document.getElementById(t):t;ze(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new CH:new TH,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{const o=c=>{c&&(this.tokenChangeListeners.delete(o),i(c))};this.tokenChangeListeners.add(o),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){ze(!this.parameters.sitekey,this.auth,"argument-error"),ze(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ze(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=cs()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){ze(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){ze(F2()&&!Q2(),this.auth,"internal-error"),await RH(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await O$(this.auth);ze(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return ze(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function RH(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y2{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Zc._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function DH(n,e,t){if(bn(n.app))return Promise.reject(Cs(n));const r=Vn(n),i=await ey(r,e,Xe(t));return new Y2(i,o=>Yb(r,o))}async function PH(n,e,t){const r=Xe(n);await Qb(!1,r,"phone");const i=await ey(r.auth,e,Xe(t));return new Y2(i,o=>HD(r,o))}async function OH(n,e,t){const r=Xe(n);if(bn(r.auth.app))return Promise.reject(Cs(r.auth));const i=await ey(r.auth,e,Xe(t));return new Y2(i,o=>GD(r,o))}async function ey(n,e,t){var r;if(!n._getRecaptchaConfig())try{await uq(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const o=i.session;if("phoneNumber"in i){ze(o.type==="enroll",n,"internal-error");const c={idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await Rl(n,c,"mfaSmsEnrollment",async(p,b)=>{if(b.phoneEnrollmentInfo.captchaResponse===Lm){ze((t==null?void 0:t.type)===Vm,p,"argument-error");const v=await r_(p,b,t);return zC(p,v)}return zC(p,b)},"PHONE_PROVIDER").catch(p=>Promise.reject(p))).phoneSessionInfo.sessionInfo}else{ze(o.type==="signin",n,"internal-error");const c=((r=i.multiFactorHint)==null?void 0:r.uid)||i.multiFactorUid;ze(c,n,"missing-multi-factor-info");const u={mfaPendingCredential:o.credential,mfaEnrollmentId:c,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await Rl(n,u,"mfaSmsSignIn",async(b,v)=>{if(v.phoneSignInInfo.captchaResponse===Lm){ze((t==null?void 0:t.type)===Vm,b,"argument-error");const _=await r_(b,v,t);return HC(b,_)}return HC(b,v)},"PHONE_PROVIDER").catch(b=>Promise.reject(b))).phoneResponseInfo.sessionInfo}}else{const o={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await Rl(n,o,"sendVerificationCode",async(m,p)=>{if(p.captchaResponse===Lm){ze((t==null?void 0:t.type)===Vm,m,"argument-error");const b=await r_(m,p,t);return UC(m,b)}return UC(m,p)},"PHONE_PROVIDER").catch(m=>Promise.reject(m))).sessionInfo}}finally{t==null||t._reset()}}async function MH(n,e){const t=Xe(n);if(bn(t.auth.app))return Promise.reject(Cs(t.auth));await z2(t,e)}async function r_(n,e,t){ze(t.type===Vm,n,"argument-error");const r=await t.verify();ze(typeof r=="string",n,"argument-error");const i={...e};if("phoneEnrollmentInfo"in i){const o=i.phoneEnrollmentInfo.phoneNumber,c=i.phoneEnrollmentInfo.captchaResponse,u=i.phoneEnrollmentInfo.clientType,h=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r,captchaResponse:c,clientType:u,recaptchaVersion:h}}),i}else if("phoneSignInInfo"in i){const o=i.phoneSignInInfo.captchaResponse,c=i.phoneSignInInfo.clientType,u=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:o,clientType:c,recaptchaVersion:u}}),i}else return Object.assign(i,{recaptchaToken:r}),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wd=class yx{constructor(e){this.providerId=yx.PROVIDER_ID,this.auth=Vn(e)}verifyPhoneNumber(e,t){return ey(this.auth,e,Xe(t))}static credential(e,t){return Zc._fromVerification(e,t)}static credentialFromResult(e){const t=e;return yx.credentialFromTaggedObject(t)}static credentialFromError(e){return yx.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?Zc._fromTokenResponse(t,r):null}};wd.PROVIDER_ID="phone";wd.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rd(n,e){return e?Wr(e):(ze(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2 extends Hh{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return yo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return yo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return yo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function LH(n){return qD(n.auth,new X2(n),n.bypassAuthState)}function VH(n){const{auth:e,user:t}=n;return ze(t,e,"internal-error"),$D(t,new X2(n),n.bypassAuthState)}async function FH(n){const{auth:e,user:t}=n;return ze(t,e,"internal-error"),z2(t,new X2(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:c,type:u}=e;if(c){this.reject(c);return}const h={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return LH;case"linkViaPopup":case"linkViaRedirect":return FH;case"reauthViaPopup":case"reauthViaRedirect":return VH;default:qs(this.auth,"internal-error")}}resolve(e){Qi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Qi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UH=new Gg(2e3,1e4);async function BH(n,e,t){if(bn(n.app))return Promise.reject(xs(n,"operation-not-supported-in-this-environment"));const r=Vn(n);qh(n,e,Po);const i=Rd(r,t);return new go(r,"signInViaPopup",e,i).executeNotNull()}async function zH(n,e,t){const r=Xe(n);if(bn(r.auth.app))return Promise.reject(xs(r.auth,"operation-not-supported-in-this-environment"));qh(r.auth,e,Po);const i=Rd(r.auth,t);return new go(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function $H(n,e,t){const r=Xe(n);qh(r.auth,e,Po);const i=Rd(r.auth,t);return new go(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class go extends nP{constructor(e,t,r,i,o){super(e,t,i,o),this.provider=r,this.authWindow=null,this.pollId=null,go.currentPopupAction&&go.currentPopupAction.cancel(),go.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ze(e,this.auth,"internal-error"),e}async onExecution(){Qi(this.filter.length===1,"Popup operations only handle one event");const e=Xg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(xs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(xs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,go.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if((r=(t=this.authWindow)==null?void 0:t.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(xs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,UH.get())};e()}}go.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qH="pendingRedirect",Fm=new Map;class HH extends nP{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Fm.get(this.auth._key());if(!e){try{const r=await GH(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Fm.set(this.auth._key(),e)}return this.bypassAuthState||Fm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function GH(n,e){const t=rP(e),r=sP(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}async function J2(n,e){return sP(n)._set(rP(e),"true")}function WH(){Fm.clear()}function Z2(n,e){Fm.set(n._key(),e)}function sP(n){return Wr(n._redirectPersistence)}function rP(n){return Jc(qH,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KH(n,e,t){return QH(n,e,t)}async function QH(n,e,t){if(bn(n.app))return Promise.reject(Cs(n));const r=Vn(n);qh(n,e,Po),await r._initializationPromise;const i=Rd(r,t);return await J2(i,r),i._openRedirect(r,e,"signInViaRedirect")}function YH(n,e,t){return XH(n,e,t)}async function XH(n,e,t){const r=Xe(n);if(qh(r.auth,e,Po),bn(r.auth.app))return Promise.reject(Cs(r.auth));await r.auth._initializationPromise;const i=Rd(r.auth,t);await J2(i,r.auth);const o=await iP(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",o)}function JH(n,e,t){return ZH(n,e,t)}async function ZH(n,e,t){const r=Xe(n);qh(r.auth,e,Po),await r.auth._initializationPromise;const i=Rd(r.auth,t);await Qb(!1,r,e.providerId),await J2(i,r.auth);const o=await iP(r);return i._openRedirect(r.auth,e,"linkViaRedirect",o)}async function eG(n,e){return await Vn(n)._initializationPromise,ty(n,e,!1)}async function ty(n,e,t=!1){if(bn(n.app))return Promise.reject(Cs(n));const r=Vn(n),i=Rd(r,e),c=await new HH(r,i,t).execute();return c&&!t&&(delete c.user._redirectEventId,await r._persistUserIfCurrent(c.user),await r._setRedirectUser(null,e)),c}async function iP(n){const e=Xg(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tG=600*1e3;class aP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!nG(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!oP(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";t.onError(xs(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=tG&&this.cachedEventUids.clear(),this.cachedEventUids.has(GC(e))}saveEventToCache(e){this.cachedEventUids.add(GC(e)),this.lastProcessedEventTime=Date.now()}}function GC(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function oP({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function nG(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return oP(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lP(n,e={}){return Gn(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sG=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rG=/^https?/;async function iG(n){if(n.config.emulator)return;const{authorizedDomains:e}=await lP(n);for(const t of e)try{if(aG(t))return}catch{}qs(n,"unauthorized-domain")}function aG(n){const e=pg(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===r}if(!rG.test(t))return!1;if(sG.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oG=new Gg(3e4,6e4);function WC(){const n=cs().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function lG(n){return new Promise((e,t)=>{var i,o,c;function r(){WC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{WC(),t(xs(n,"network-request-failed"))},timeout:oG.get()})}if((o=(i=cs().gapi)==null?void 0:i.iframes)!=null&&o.Iframe)e(gapi.iframes.getContext());else if((c=cs().gapi)!=null&&c.load)r();else{const u=MD("iframefcb");return cs()[u]=()=>{gapi.load?r():t(xs(n,"network-request-failed"))},B2(`${nq()}?onload=${u}`).catch(h=>t(h))}}).catch(e=>{throw vx=null,e})}let vx=null;function cG(n){return vx=vx||lG(n),vx}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dG=new Gg(5e3,15e3),uG="__/auth/iframe",hG="emulator/auth/iframe",fG={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},mG=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gG(n){const e=n.config;ze(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?U2(e,hG):`https://${n.config.authDomain}/${uG}`,r={apiKey:e.apiKey,appName:n.name,v:$a},i=mG.get(n.config.apiHost);i&&(r.eid=i);const o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${Td(r).slice(1)}`}async function pG(n){const e=await cG(n),t=cs().gapi;return ze(t,n,"internal-error"),e.open({where:document.body,url:gG(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:fG,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});const c=xs(n,"network-request-failed"),u=cs().setTimeout(()=>{o(c)},dG.get());function h(){cs().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{o(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xG={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},bG=500,yG=600,vG="_blank",wG="http://localhost";class KC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _G(n,e,t,r=bG,i=yG){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),c=Math.max((window.screen.availWidth-r)/2,0).toString();let u="";const h={...xG,width:r.toString(),height:i.toString(),top:o,left:c},m=Mn().toLowerCase();t&&(u=AD(m)?vG:t),ID(m)&&(e=e||wG,h.scrollbars="yes");const p=Object.entries(h).reduce((v,[_,T])=>`${v}${_}=${T},`,"");if(G$(m)&&u!=="_self")return NG(e||"",u),new KC(null);const b=window.open(e||"",u,p);ze(b,n,"popup-blocked");try{b.focus()}catch{}return new KC(b)}function NG(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jG="__/auth/handler",SG="emulator/auth/handler",EG=encodeURIComponent("fac");async function x1(n,e,t,r,i,o){ze(n.config.authDomain,n,"auth-domain-config-required"),ze(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:$a,eventId:i};if(e instanceof Po){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",Nx(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,b]of Object.entries(o||{}))c[p]=b}if(e instanceof Gh){const p=e.getScopes().filter(b=>b!=="");p.length>0&&(c.scopes=p.join(","))}n.tenantId&&(c.tid=n.tenantId);const u=c;for(const p of Object.keys(u))u[p]===void 0&&delete u[p];const h=await n._getAppCheckToken(),m=h?`#${EG}=${encodeURIComponent(h)}`:"";return`${TG(n)}?${Td(u).slice(1)}${m}`}function TG({config:n}){return n.emulator?U2(n,SG):`https://${n.authDomain}/${jG}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i_="webStorageSupport";class IG{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vd,this._completeRedirectFn=ty,this._overrideRedirectResult=Z2}async _openPopup(e,t,r,i){var c;Qi((c=this.eventManagers[e._key()])==null?void 0:c.manager,"_initialize() not called before _openPopup()");const o=await x1(e,t,r,pg(),i);return _G(e,o,Xg())}async _openRedirect(e,t,r,i){await this._originValidation(e);const o=await x1(e,t,r,pg(),i);return pH(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(Qi(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await pG(e),r=new aP(e);return t.register("authEvent",i=>(ze(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(i_,{type:i_},i=>{var c;const o=(c=i==null?void 0:i[0])==null?void 0:c[i_];o!==void 0&&t(!!o),qs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=iG(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return PD()||CD()||Kg()}}const CG=IG;class AG{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Aa("unexpected MultiFactorSessionType")}}}class ej extends AG{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new ej(e)}_finalizeEnroll(e,t,r){return cH(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return SH(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class cP{constructor(){}static assertion(e){return ej._fromCredential(e)}}cP.FACTOR_ID="phone";var QC="@firebase/auth",YC="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kG{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ze(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RG(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function DG(n){hr(new $n("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:c,authDomain:u}=r.options;ze(c&&!c.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:c,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:OD(n)},m=new J$(r,i,o,h);return hq(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),hr(new $n("auth-internal",e=>{const t=Vn(e.getProvider("auth").getImmediate());return(r=>new kG(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ps(QC,YC,RG(n)),ps(QC,YC,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PG=300;ML("authIdTokenMaxAge");function OG(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}Z$({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const o=xs("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",OG().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});DG("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _d(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MG=2e3;async function LG(n,e,t){const{BuildInfo:r}=_d();Qi(e.sessionId,"AuthEvent did not contain a session ID");const i=await zG(e.sessionId),o={};return Kg()?o.ibi=r.packageName:Wg()?o.apn=r.packageName:qs(n,"operation-not-supported-in-this-environment"),r.displayName&&(o.appDisplayName=r.displayName),o.sessionId=i,x1(n,t,e.type,void 0,e.eventId??void 0,o)}async function VG(n){const{BuildInfo:e}=_d(),t={};Kg()?t.iosBundleId=e.packageName:Wg()?t.androidPackageName=e.packageName:qs(n,"operation-not-supported-in-this-environment"),await lP(n,t)}function FG(n){const{cordova:e}=_d();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,H$()?"_blank":"_system","location=yes"),t(i)})})}async function UG(n,e,t){const{cordova:r}=_d();let i=()=>{};try{await new Promise((o,c)=>{let u=null;function h(){var v;o();const b=(v=r.plugins.browsertab)==null?void 0:v.close;typeof b=="function"&&b(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function m(){u||(u=window.setTimeout(()=>{c(xs(n,"redirect-cancelled-by-user"))},MG))}function p(){(document==null?void 0:document.visibilityState)==="visible"&&m()}e.addPassiveListener(h),document.addEventListener("resume",m,!1),Wg()&&document.addEventListener("visibilitychange",p,!1),i=()=>{e.removePassiveListener(h),document.removeEventListener("resume",m,!1),document.removeEventListener("visibilitychange",p,!1),u&&window.clearTimeout(u)}})}finally{i()}}function BG(n){var t,r,i,o,c,u,h,m,p,b;const e=_d();ze(typeof((t=e==null?void 0:e.universalLinks)==null?void 0:t.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),ze(typeof((r=e==null?void 0:e.BuildInfo)==null?void 0:r.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),ze(typeof((c=(o=(i=e==null?void 0:e.cordova)==null?void 0:i.plugins)==null?void 0:o.browsertab)==null?void 0:c.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ze(typeof((m=(h=(u=e==null?void 0:e.cordova)==null?void 0:u.plugins)==null?void 0:h.browsertab)==null?void 0:m.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ze(typeof((b=(p=e==null?void 0:e.cordova)==null?void 0:p.InAppBrowser)==null?void 0:b.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function zG(n){const e=$G(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}function $G(n){if(Qi(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qG=20;class HG extends aP{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function GG(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:QG(),postBody:null,tenantId:n.tenantId,error:xs(n,"no-auth-event")}}function WG(n,e){return b1()._set(y1(n),e)}async function XC(n){const e=await b1()._get(y1(n));return e&&await b1()._remove(y1(n)),e}function KG(n,e){var r,i;const t=XG(e);if(t.includes("/__/auth/callback")){const o=wx(t),c=o.firebaseError?YG(decodeURIComponent(o.firebaseError)):null,u=(i=(r=c==null?void 0:c.code)==null?void 0:r.split("auth/"))==null?void 0:i[1],h=u?xs(u):null;return h?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:h,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:t,postBody:null}}return null}function QG(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<qG;t++){const r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function b1(){return Wr(K2)}function y1(n){return Jc("authEvent",n.config.apiKey,n.name)}function YG(n){try{return JSON.parse(n)}catch{return null}}function XG(n){const e=wx(n),t=e.link?decodeURIComponent(e.link):void 0,r=wx(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return wx(i).link||i||r||t||n}function wx(n){if(!(n!=null&&n.includes("?")))return{};const[e,...t]=n.split("?");return Fu(t.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JG=500;class ZG{constructor(){this._redirectPersistence=vd,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=ty,this._overrideRedirectResult=Z2}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new HG(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){qs(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,i){BG(e);const o=await this._initialize(e);await o.initialized(),o.resetRedirect(),WH(),await this._originValidation(e);const c=GG(e,r,i);await WG(e,c);const u=await LG(e,c,t),h=await FG(u);return UG(e,o,h)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=VG(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:i,BuildInfo:o}=_d(),c=setTimeout(async()=>{await XC(e),t.onEvent(JC())},JG),u=async p=>{clearTimeout(c);const b=await XC(e);let v=null;b&&(p!=null&&p.url)&&(v=KG(b,p.url)),t.onEvent(v||JC())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,u);const h=i,m=`${o.packageName.toLowerCase()}://`;_d().handleOpenURL=async p=>{if(p.toLowerCase().startsWith(m)&&u({url:p}),typeof h=="function")try{h(p)}catch(b){console.error(b)}}}}const eW=ZG;function JC(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:xs("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tW(n,e){Vn(n)._logFramework(e)}var nW="@firebase/auth-compat",sW="0.6.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rW=1e3;function Um(){var n;return((n=self==null?void 0:self.location)==null?void 0:n.protocol)||null}function iW(){return Um()==="http:"||Um()==="https:"}function dP(n=Mn()){return!!((Um()==="file:"||Um()==="ionic:"||Um()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function aW(){return bb()||xb()}function oW(){return k4()&&(document==null?void 0:document.documentMode)===11}function lW(n=Mn()){return/Edge\/\d+/.test(n)}function cW(n=Mn()){return oW()||lW(n)}function uP(){try{const n=self.localStorage,e=Xg();if(n)return n.setItem(e,"1"),n.removeItem(e),cW()?sd():!0}catch{return tj()&&sd()}return!1}function tj(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function a_(){return(iW()||A4()||dP())&&!aW()&&uP()&&!tj()}function hP(){return dP()&&typeof document<"u"}async function dW(){return hP()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},rW);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function uW(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hr={LOCAL:"local",NONE:"none",SESSION:"session"},om=ze,fP="persistence";function hW(n,e){if(om(Object.values(Hr).includes(e),n,"invalid-persistence-type"),bb()){om(e!==Hr.SESSION,n,"unsupported-persistence-type");return}if(xb()){om(e===Hr.NONE,n,"unsupported-persistence-type");return}if(tj()){om(e===Hr.NONE||e===Hr.LOCAL&&sd(),n,"unsupported-persistence-type");return}om(e===Hr.NONE||uP(),n,"unsupported-persistence-type")}async function v1(n){await n._initializationPromise;const e=mP(),t=Jc(fP,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistenceType())}function fW(n,e){const t=mP();if(!t)return[];const r=Jc(fP,n,e);switch(t.getItem(r)){case Hr.NONE:return[Nh];case Hr.LOCAL:return[yg,vd];case Hr.SESSION:return[vd];default:return[]}}function mP(){var n;try{return((n=uW())==null?void 0:n.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mW=ze;class jl{constructor(){this.browserResolver=Wr(CG),this.cordovaResolver=Wr(eW),this.underlyingResolver=null,this._redirectPersistence=vd,this._completeRedirectFn=ty,this._overrideRedirectResult=Z2}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)}async _openRedirect(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return hP()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return mW(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await dW();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gP(n){return n.unwrap()}function gW(n){return n.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pW(n){return pP(n)}function xW(n,e){var r;const t=(r=e.customData)==null?void 0:r._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new bW(n,lH(n,e))}else if(t){const i=pP(e),o=e;i&&(o.credential=i,o.tenantId=t.tenantId||void 0,o.email=t.email||void 0,o.phoneNumber=t.phoneNumber||void 0)}}function pP(n){const{_tokenResponse:e}=n instanceof Us?n.customData:n;if(!e)return null;if(!(n instanceof Us)&&"temporaryProof"in e&&"phoneNumber"in e)return wd.credentialFromResult(n);const t=e.providerId;if(!t||t===im.PASSWORD)return null;let r;switch(t){case im.GOOGLE:r=ja;break;case im.FACEBOOK:r=Na;break;case im.GITHUB:r=Sa;break;case im.TWITTER:r=Ea;break;default:const{oauthIdToken:i,oauthAccessToken:o,oauthTokenSecret:c,pendingToken:u,nonce:h}=e;return!o&&!c&&!i&&!u?null:u?t.startsWith("saml.")?jh._create(t,u):Va._fromParams({providerId:t,signInMethod:t,pendingToken:u,idToken:i,accessToken:o}):new Gu(t).credential({idToken:i,accessToken:o,rawNonce:h})}return n instanceof Us?r.credentialFromError(n):r.credentialFromResult(n)}function _r(n,e){return e.catch(t=>{throw t instanceof Us&&xW(n,t),t}).then(t=>{const r=t.operationType,i=t.user;return{operationType:r,credential:pW(t),additionalUserInfo:oH(t),user:po.getOrCreate(i)}})}async function w1(n,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>_r(n,t.confirm(r))}}class bW{constructor(e,t){this.resolver=t,this.auth=gW(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return _r(gP(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e){this._delegate=e,this.multiFactor=uH(e)}static getOrCreate(e){return po.USER_MAP.has(e)||po.USER_MAP.set(e,new po(e)),po.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return _r(this.auth,HD(this._delegate,e))}async linkWithPhoneNumber(e,t){return w1(this.auth,PH(this._delegate,e,t))}async linkWithPopup(e){return _r(this.auth,$H(this._delegate,e,jl))}async linkWithRedirect(e){return await v1(Vn(this.auth)),JH(this._delegate,e,jl)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return _r(this.auth,GD(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return w1(this.auth,OH(this._delegate,e,t))}reauthenticateWithPopup(e){return _r(this.auth,zH(this._delegate,e,jl))}async reauthenticateWithRedirect(e){return await v1(Vn(this.auth)),YH(this._delegate,e,jl)}sendEmailVerification(e){return Yq(this._delegate,e)}async unlink(e){return await Mq(this._delegate,e),this}updateEmail(e){return eH(this._delegate,e)}updatePassword(e){return tH(this._delegate,e)}updatePhoneNumber(e){return MH(this._delegate,e)}updateProfile(e){return Zq(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return Xq(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}po.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lm=ze;class _1{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;lm(r,"invalid-api-key",{appName:e.name}),lm(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?jl:void 0;this._delegate=t.initialize({options:{persistence:yW(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(S$),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?po.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){fq(this._delegate,e,t)}applyActionCode(e){return Bq(this._delegate,e)}checkActionCode(e){return WD(this._delegate,e)}confirmPasswordReset(e,t){return Uq(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return _r(this._delegate,$q(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return Qq(this._delegate,e)}isSignInWithEmailLink(e){return Gq(this._delegate,e)}async getRedirectResult(){lm(a_(),this._delegate,"operation-not-supported-in-this-environment");const e=await eG(this._delegate,jl);return e?_r(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){tW(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:i,error:o,complete:c}=ZC(e,t,r);return this._delegate.onAuthStateChanged(i,o,c)}onIdTokenChanged(e,t,r){const{next:i,error:o,complete:c}=ZC(e,t,r);return this._delegate.onIdTokenChanged(i,o,c)}sendSignInLinkToEmail(e,t){return Hq(this._delegate,e,t)}sendPasswordResetEmail(e,t){return Fq(this._delegate,e,t||void 0)}async setPersistence(e){hW(this._delegate,e);let t;switch(e){case Hr.SESSION:t=vd;break;case Hr.LOCAL:t=await Wr(yg)._isAvailable()?yg:K2;break;case Hr.NONE:t=Nh;break;default:return qs("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return _r(this._delegate,Oq(this._delegate))}signInWithCredential(e){return _r(this._delegate,Yb(this._delegate,e))}signInWithCustomToken(e){return _r(this._delegate,Vq(this._delegate,e))}signInWithEmailAndPassword(e,t){return _r(this._delegate,qq(this._delegate,e,t))}signInWithEmailLink(e,t){return _r(this._delegate,Wq(this._delegate,e,t))}signInWithPhoneNumber(e,t){return w1(this._delegate,DH(this._delegate,e,t))}async signInWithPopup(e){return lm(a_(),this._delegate,"operation-not-supported-in-this-environment"),_r(this._delegate,BH(this._delegate,e,jl))}async signInWithRedirect(e){return lm(a_(),this._delegate,"operation-not-supported-in-this-environment"),await v1(this._delegate),KH(this._delegate,e,jl)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return zq(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}_1.Persistence=Hr;function ZC(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);const i=r;return{next:c=>i(c&&po.getOrCreate(c)),error:e,complete:t}}function yW(n,e){const t=fW(n,e);if(typeof self<"u"&&!t.includes(yg)&&t.push(yg),typeof window<"u")for(const r of[K2,vd])t.includes(r)||t.push(r);return t.includes(Nh)||t.push(Nh),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nj{static credential(e,t){return wd.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new wd(gP(Nt.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}nj.PHONE_SIGN_IN_METHOD=wd.PHONE_SIGN_IN_METHOD;nj.PROVIDER_ID=wd.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vW=ze;class wW{constructor(e,t,r=Nt.app()){var i;vW((i=r.options)==null?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new kH(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _W="auth-compat";function NW(n){n.INTERNAL.registerComponent(new $n(_W,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new _1(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Cu.EMAIL_SIGNIN,PASSWORD_RESET:Cu.PASSWORD_RESET,RECOVER_EMAIL:Cu.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Cu.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Cu.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Cu.VERIFY_EMAIL}},EmailAuthProvider:rc,FacebookAuthProvider:Na,GithubAuthProvider:Sa,GoogleAuthProvider:ja,OAuthProvider:Gu,SAMLAuthProvider:Kx,PhoneAuthProvider:nj,PhoneMultiFactorGenerator:cP,RecaptchaVerifier:wW,TwitterAuthProvider:Ea,Auth:_1,AuthCredential:Hh,Error:Us}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(nW,sW)}NW(Nt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xP="firebasestorage.googleapis.com",bP="storageBucket",jW=120*1e3,SW=600*1e3,EW=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn extends Us{constructor(e,t,r=0){super(o_(e),`Firebase Storage: ${t} (${o_(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Fn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return o_(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Sn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Sn||(Sn={}));function o_(n){return"storage/"+n}function sj(){const n="An unknown error occurred, please check the error payload for server response.";return new Fn(Sn.UNKNOWN,n)}function TW(n){return new Fn(Sn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function IW(n){return new Fn(Sn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function CW(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Fn(Sn.UNAUTHENTICATED,n)}function AW(){return new Fn(Sn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function kW(n){return new Fn(Sn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function yP(){return new Fn(Sn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function vP(){return new Fn(Sn.CANCELED,"User canceled the upload/download.")}function RW(n){return new Fn(Sn.INVALID_URL,"Invalid URL '"+n+"'.")}function DW(n){return new Fn(Sn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function PW(){return new Fn(Sn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+bP+"' property when initializing the app?")}function wP(){return new Fn(Sn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function OW(){return new Fn(Sn.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function MW(){return new Fn(Sn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function LW(n){return new Fn(Sn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ku(n){return new Fn(Sn.INVALID_ARGUMENT,n)}function _P(){return new Fn(Sn.APP_DELETED,"The Firebase app was deleted.")}function NP(n){return new Fn(Sn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Bm(n,e){return new Fn(Sn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function cm(n){throw new Fn(Sn.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=Qs.makeFromUrl(e,t)}catch{return new Qs(e,"")}if(r.path==="")return r;throw DW(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function o(H){H.path.charAt(H.path.length-1)==="/"&&(H.path_=H.path_.slice(0,-1))}const c="(/(.*))?$",u=new RegExp("^gs://"+i+c,"i"),h={bucket:1,path:3};function m(H){H.path_=decodeURIComponent(H.path)}const p="v[A-Za-z0-9_]+",b=t.replace(/[.]/g,"\\."),v="(/([^?#]*).*)?$",_=new RegExp(`^https?://${b}/${p}/b/${i}/o${v}`,"i"),T={bucket:1,path:3},k=t===xP?"(?:storage.googleapis.com|storage.cloud.google.com)":t,E="([^?#]*)",S=new RegExp(`^https?://${k}/${i}/${E}`,"i"),$=[{regex:u,indices:h,postModify:o},{regex:_,indices:T,postModify:m},{regex:S,indices:{bucket:1,path:2},postModify:m}];for(let H=0;H<$.length;H++){const G=$[H],z=G.regex.exec(e);if(z){const P=z[G.indices.bucket];let j=z[G.indices.path];j||(j=""),r=new Qs(P,j),G.postModify(r);break}}if(r==null)throw RW(e);return r}}class VW{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FW(n,e,t){let r=1,i=null,o=null,c=!1,u=0;function h(){return u===2}let m=!1;function p(...E){m||(m=!0,e.apply(null,E))}function b(E){i=setTimeout(()=>{i=null,n(_,h())},E)}function v(){o&&clearTimeout(o)}function _(E,...S){if(m){v();return}if(E){v(),p.call(null,E,...S);return}if(h()||c){v(),p.call(null,E,...S);return}r<64&&(r*=2);let $;u===1?(u=2,$=0):$=(r+Math.random())*1e3,b($)}let T=!1;function k(E){T||(T=!0,v(),!m&&(i!==null?(E||(u=2),clearTimeout(i),b(0)):E||(u=1)))}return b(0),o=setTimeout(()=>{c=!0,k(!0)},t),k}function UW(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BW(n){return n!==void 0}function zW(n){return typeof n=="function"}function $W(n){return typeof n=="object"&&!Array.isArray(n)}function ny(n){return typeof n=="string"||n instanceof String}function eA(n){return rj()&&n instanceof Blob}function rj(){return typeof Blob<"u"}function N1(n,e,t,r){if(r<e)throw Ku(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Ku(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ic(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function jP(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var ed;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(ed||(ed={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SP(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,o=e.indexOf(n)!==-1;return t||i||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qW{constructor(e,t,r,i,o,c,u,h,m,p,b,v=!0,_=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=c,this.callback_=u,this.errorCallback_=h,this.timeout_=m,this.progressCallback_=p,this.connectionFactory_=b,this.retry=v,this.isUsingEmulator=_,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,k)=>{this.resolve_=T,this.reject_=k,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new $p(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const c=u=>{const h=u.loaded,m=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,m)};this.progressCallback_!==null&&o.addUploadProgressListener(c),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(c),this.pendingConnection_=null;const u=o.getErrorCode()===ed.NO_ERROR,h=o.getStatus();if(!u||SP(h,this.additionalRetryCodes_)&&this.retry){const p=o.getErrorCode()===ed.ABORT;r(!1,new $p(!1,null,p));return}const m=this.successCodes_.indexOf(h)!==-1;r(!0,new $p(m,o))})},t=(r,i)=>{const o=this.resolve_,c=this.reject_,u=i.connection;if(i.wasSuccessCode)try{const h=this.callback_(u,u.getResponse());BW(h)?o(h):o()}catch(h){c(h)}else if(u!==null){const h=sj();h.serverResponse=u.getErrorText(),this.errorCallback_?c(this.errorCallback_(u,h)):c(h)}else if(i.canceled){const h=this.appDelete_?_P():vP();c(h)}else{const h=yP();c(h)}};this.canceled_?t(!1,new $p(!1,null,!0)):this.backoffId_=FW(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&UW(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class $p{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function HW(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function GW(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function WW(n,e){e&&(n["X-Firebase-GMPID"]=e)}function KW(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function QW(n,e,t,r,i,o,c=!0,u=!1){const h=jP(n.urlParams),m=n.url+h,p=Object.assign({},n.headers);return WW(p,e),HW(p,t),GW(p,o),KW(p,r),new qW(m,n.method,p,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,c,u)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YW(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function XW(...n){const e=YW();if(e!==void 0){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(rj())return new Blob(n);throw new Fn(Sn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function JW(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZW(n){if(typeof atob>"u")throw LW("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bi={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class l_{constructor(e,t){this.data=e,this.contentType=t||null}}function EP(n,e){switch(n){case bi.RAW:return new l_(TP(e));case bi.BASE64:case bi.BASE64URL:return new l_(IP(n,e));case bi.DATA_URL:return new l_(tK(e),nK(e))}throw sj()}function TP(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const o=r,c=n.charCodeAt(++t);r=65536|(o&1023)<<10|c&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function eK(n){let e;try{e=decodeURIComponent(n)}catch{throw Bm(bi.DATA_URL,"Malformed data URL.")}return TP(e)}function IP(n,e){switch(n){case bi.BASE64:{const i=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(i||o)throw Bm(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case bi.BASE64URL:{const i=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(i||o)throw Bm(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=ZW(e)}catch(i){throw i.message.includes("polyfill")?i:Bm(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class CP{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Bm(bi.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;r!=null&&(this.base64=sK(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function tK(n){const e=new CP(n);return e.base64?IP(bi.BASE64,e.rest):eK(e.rest)}function nK(n){return new CP(n).contentType}function sK(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo{constructor(e,t){let r=0,i="";eA(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(eA(this.data_)){const r=this.data_,i=JW(r,e,t);return i===null?null:new fo(i)}else{const r=new Uint8Array(this.data_.buffer,e,t-e);return new fo(r,!0)}}static getBlob(...e){if(rj()){const t=e.map(r=>r instanceof fo?r.data_:r);return new fo(XW.apply(null,t))}else{const t=e.map(c=>ny(c)?EP(bi.RAW,c).data:c.data_);let r=0;t.forEach(c=>{r+=c.byteLength});const i=new Uint8Array(r);let o=0;return t.forEach(c=>{for(let u=0;u<c.length;u++)i[o++]=c[u]}),new fo(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ij(n){let e;try{e=JSON.parse(n)}catch{return null}return $W(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rK(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function iK(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function AP(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aK(n,e){return e}class nr{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||aK}}let qp=null;function oK(n){return!ny(n)||n.length<2?n:AP(n)}function sy(){if(qp)return qp;const n=[];n.push(new nr("bucket")),n.push(new nr("generation")),n.push(new nr("metageneration")),n.push(new nr("name","fullPath",!0));function e(o,c){return oK(c)}const t=new nr("name");t.xform=e,n.push(t);function r(o,c){return c!==void 0?Number(c):c}const i=new nr("size");return i.xform=r,n.push(i),n.push(new nr("timeCreated")),n.push(new nr("updated")),n.push(new nr("md5Hash",null,!0)),n.push(new nr("cacheControl",null,!0)),n.push(new nr("contentDisposition",null,!0)),n.push(new nr("contentEncoding",null,!0)),n.push(new nr("contentLanguage",null,!0)),n.push(new nr("contentType",null,!0)),n.push(new nr("metadata","customMetadata",!0)),qp=n,qp}function lK(n,e){function t(){const r=n.bucket,i=n.fullPath,o=new Qs(r,i);return e._makeStorageReference(o)}Object.defineProperty(n,"ref",{get:t})}function cK(n,e,t){const r={};r.type="file";const i=t.length;for(let o=0;o<i;o++){const c=t[o];r[c.local]=c.xform(r,e[c.server])}return lK(r,n),r}function kP(n,e,t){const r=ij(e);return r===null?null:cK(n,r,t)}function dK(n,e,t,r){const i=ij(e);if(i===null||!ny(i.downloadTokens))return null;const o=i.downloadTokens;if(o.length===0)return null;const c=encodeURIComponent;return o.split(",").map(m=>{const p=n.bucket,b=n.fullPath,v="/b/"+c(p)+"/o/"+c(b),_=ic(v,t,r),T=jP({alt:"media",token:m});return _+T})[0]}function aj(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const o=e[i];o.writable&&(t[o.server]=n[o.local])}return JSON.stringify(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tA="prefixes",nA="items";function uK(n,e,t){const r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[tA])for(const i of t[tA]){const o=i.replace(/\/$/,""),c=n._makeStorageReference(new Qs(e,o));r.prefixes.push(c)}if(t[nA])for(const i of t[nA]){const o=n._makeStorageReference(new Qs(e,i.name));r.items.push(o)}return r}function hK(n,e,t){const r=ij(t);return r===null?null:uK(n,e,r)}class Oo{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pa(n){if(!n)throw sj()}function ry(n,e){function t(r,i){const o=kP(n,i,e);return Pa(o!==null),o}return t}function fK(n,e){function t(r,i){const o=hK(n,e,i);return Pa(o!==null),o}return t}function mK(n,e){function t(r,i){const o=kP(n,i,e);return Pa(o!==null),dK(o,i,n.host,n._protocol)}return t}function Wh(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=AW():i=CW():t.getStatus()===402?i=IW(n.bucket):t.getStatus()===403?i=kW(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function iy(n){const e=Wh(n);function t(r,i){let o=e(r,i);return r.getStatus()===404&&(o=TW(n.path)),o.serverResponse=i.serverResponse,o}return t}function RP(n,e,t){const r=e.fullServerUrl(),i=ic(r,n.host,n._protocol),o="GET",c=n.maxOperationRetryTime,u=new Oo(i,o,ry(n,t),c);return u.errorHandler=iy(e),u}function gK(n,e,t,r,i){const o={};e.isRoot?o.prefix="":o.prefix=e.path+"/",t.length>0&&(o.delimiter=t),r&&(o.pageToken=r),i&&(o.maxResults=i);const c=e.bucketOnlyServerUrl(),u=ic(c,n.host,n._protocol),h="GET",m=n.maxOperationRetryTime,p=new Oo(u,h,fK(n,e.bucket),m);return p.urlParams=o,p.errorHandler=Wh(e),p}function pK(n,e,t){const r=e.fullServerUrl(),i=ic(r,n.host,n._protocol),o="GET",c=n.maxOperationRetryTime,u=new Oo(i,o,mK(n,t),c);return u.errorHandler=iy(e),u}function xK(n,e,t,r){const i=e.fullServerUrl(),o=ic(i,n.host,n._protocol),c="PATCH",u=aj(t,r),h={"Content-Type":"application/json; charset=utf-8"},m=n.maxOperationRetryTime,p=new Oo(o,c,ry(n,r),m);return p.headers=h,p.body=u,p.errorHandler=iy(e),p}function bK(n,e){const t=e.fullServerUrl(),r=ic(t,n.host,n._protocol),i="DELETE",o=n.maxOperationRetryTime;function c(h,m){}const u=new Oo(r,i,c,o);return u.successCodes=[200,204],u.errorHandler=iy(e),u}function yK(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function DP(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=yK(null,e)),r}function vK(n,e,t,r,i){const o=e.bucketOnlyServerUrl(),c={"X-Goog-Upload-Protocol":"multipart"};function u(){let $="";for(let H=0;H<2;H++)$=$+Math.random().toString().slice(2);return $}const h=u();c["Content-Type"]="multipart/related; boundary="+h;const m=DP(e,r,i),p=aj(m,t),b="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+p+`\r
--`+h+`\r
Content-Type: `+m.contentType+`\r
\r
`,v=`\r
--`+h+"--",_=fo.getBlob(b,r,v);if(_===null)throw wP();const T={name:m.fullPath},k=ic(o,n.host,n._protocol),E="POST",S=n.maxUploadRetryTime,L=new Oo(k,E,ry(n,t),S);return L.urlParams=T,L.headers=c,L.body=_.uploadData(),L.errorHandler=Wh(e),L}class Jx{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}}function oj(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{Pa(!1)}return Pa(!!t&&(e||["active"]).indexOf(t)!==-1),t}function wK(n,e,t,r,i){const o=e.bucketOnlyServerUrl(),c=DP(e,r,i),u={name:c.fullPath},h=ic(o,n.host,n._protocol),m="POST",p={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":c.contentType,"Content-Type":"application/json; charset=utf-8"},b=aj(c,t),v=n.maxUploadRetryTime;function _(k){oj(k);let E;try{E=k.getResponseHeader("X-Goog-Upload-URL")}catch{Pa(!1)}return Pa(ny(E)),E}const T=new Oo(h,m,_,v);return T.urlParams=u,T.headers=p,T.body=b,T.errorHandler=Wh(e),T}function _K(n,e,t,r){const i={"X-Goog-Upload-Command":"query"};function o(m){const p=oj(m,["active","final"]);let b=null;try{b=m.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Pa(!1)}b||Pa(!1);const v=Number(b);return Pa(!isNaN(v)),new Jx(v,r.size(),p==="final")}const c="POST",u=n.maxUploadRetryTime,h=new Oo(t,c,o,u);return h.headers=i,h.errorHandler=Wh(e),h}const sA=256*1024;function NK(n,e,t,r,i,o,c,u){const h=new Jx(0,0);if(c?(h.current=c.current,h.total=c.total):(h.current=0,h.total=r.size()),r.size()!==h.total)throw OW();const m=h.total-h.current;let p=m;i>0&&(p=Math.min(p,i));const b=h.current,v=b+p;let _="";p===0?_="finalize":m===p?_="upload, finalize":_="upload";const T={"X-Goog-Upload-Command":_,"X-Goog-Upload-Offset":`${h.current}`},k=r.slice(b,v);if(k===null)throw wP();function E(H,G){const z=oj(H,["active","final"]),P=h.current+p,j=r.size();let O;return z==="final"?O=ry(e,o)(H,G):O=null,new Jx(P,j,z==="final",O)}const S="POST",L=e.maxUploadRetryTime,$=new Oo(t,S,E,L);return $.headers=T,$.body=k.uploadData(),$.progressCallback=u||null,$.errorHandler=Wh(n),$}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jK={STATE_CHANGED:"state_changed"},ar={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function c_(n){switch(n){case"running":case"pausing":case"canceling":return ar.RUNNING;case"paused":return ar.PAUSED;case"success":return ar.SUCCESS;case"canceled":return ar.CANCELED;case"error":return ar.ERROR;default:return ar.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SK{constructor(e,t,r){if(zW(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{const o=e;this.next=o.next,this.error=o.error,this.complete=o.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Au(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}class EK{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ed.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ed.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ed.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i,o){if(this.sent_)throw cm("cannot .send() more than once");if(Ba(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),o!==void 0)for(const c in o)o.hasOwnProperty(c)&&this.xhr_.setRequestHeader(c,o[c].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw cm("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw cm("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw cm("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw cm("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class TK extends EK{initXhr(){this.xhr_.responseType="text"}}function Ta(){return new TK}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=sy(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(Sn.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const o=this.isExponentialBackoffExpired();if(SP(i.status,[]))if(o)i=yP();else{this.sleepTime=Math.max(this.sleepTime*2,EW),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(Sn.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,o)=>{this._resolve=i,this._reject=o,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{const r=wK(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ta,e,t);this._request=i,i.getPromise().then(o=>{this._request=void 0,this._uploadUrl=o,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,r)=>{const i=_K(this._ref.storage,this._ref._location,e,this._blob),o=this._ref.storage._makeRequest(i,Ta,t,r);this._request=o,o.getPromise().then(c=>{c=c,this._request=void 0,this._updateProgress(c.current),this._needToFetchStatus=!1,c.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=sA*this._chunkMultiplier,t=new Jx(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,o)=>{let c;try{c=NK(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(h){this._error=h,this._transition("error");return}const u=this._ref.storage._makeRequest(c,Ta,i,o,!1);this._request=u,u.getPromise().then(h=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(h.current),h.finalized?(this._metadata=h.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){sA*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const r=RP(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Ta,e,t);this._request=i,i.getPromise().then(o=>{this._request=void 0,this._metadata=o,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const r=vK(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ta,e,t);this._request=i,i.getPromise().then(o=>{this._request=void 0,this._metadata=o,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=vP(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=c_(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){const o=new SK(t||void 0,r||void 0,i||void 0);return this._addObserver(o),()=>{this._removeObserver(o)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(c_(this._state)){case ar.SUCCESS:Au(this._resolve.bind(null,this.snapshot))();break;case ar.CANCELED:case ar.ERROR:const t=this._reject;Au(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(c_(this._state)){case ar.RUNNING:case ar.PAUSED:e.next&&Au(e.next.bind(e,this.snapshot))();break;case ar.SUCCESS:e.complete&&Au(e.complete.bind(e))();break;case ar.CANCELED:case ar.ERROR:e.error&&Au(e.error.bind(e,this._error))();break;default:e.error&&Au(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ay=class j1{constructor(e,t){this._service=e,t instanceof Qs?this._location=t:this._location=Qs.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new j1(e,t)}get root(){const e=new Qs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return AP(this._location.path)}get storage(){return this._service}get parent(){const e=rK(this._location.path);if(e===null)return null;const t=new Qs(this._location.bucket,e);return new j1(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw NP(e)}};function IK(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new PP(n,new fo(e),t)}function CK(n){const e={prefixes:[],items:[]};return OP(n,e).then(()=>e)}async function OP(n,e,t){const i=await MP(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&await OP(n,e,i.nextPageToken)}function MP(n,e){e!=null&&typeof e.maxResults=="number"&&N1("options.maxResults",1,1e3,e.maxResults);const t=e||{},r=gK(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,Ta)}function AK(n){n._throwIfRoot("getMetadata");const e=RP(n.storage,n._location,sy());return n.storage.makeRequestWithTokens(e,Ta)}function kK(n,e){n._throwIfRoot("updateMetadata");const t=xK(n.storage,n._location,e,sy());return n.storage.makeRequestWithTokens(t,Ta)}function RK(n){n._throwIfRoot("getDownloadURL");const e=pK(n.storage,n._location,sy());return n.storage.makeRequestWithTokens(e,Ta).then(t=>{if(t===null)throw MW();return t})}function DK(n){n._throwIfRoot("deleteObject");const e=bK(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Ta)}function LP(n,e){const t=iK(n._location.path,e),r=new Qs(n._location.bucket,t);return new ay(n.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PK(n){return/^[A-Za-z]+:\/\//.test(n)}function OK(n,e){return new ay(n,e)}function VP(n,e){if(n instanceof lj){const t=n;if(t._bucket==null)throw PW();const r=new ay(t,t._bucket);return e!=null?VP(r,e):r}else return e!==void 0?LP(n,e):n}function MK(n,e){if(e&&PK(e)){if(n instanceof lj)return OK(n,e);throw Ku("To use ref(service, url), the first argument must be a Storage instance.")}else return VP(n,e)}function rA(n,e){const t=e==null?void 0:e[bP];return t==null?null:Qs.makeFromBucketSpec(t,n)}function LK(n,e,t,r={}){n.host=`${e}:${t}`;const i=Ba(e);i&&(gb(`https://${n.host}/b`),pb("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:o}=r;o&&(n._overrideAuthToken=typeof o=="string"?o:aN(o,n.app.options.projectId))}class lj{constructor(e,t,r,i,o,c=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._isUsingEmulator=c,this._bucket=null,this._host=xP,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=jW,this._maxUploadRetryTime=SW,this._requests=new Set,i!=null?this._bucket=Qs.makeFromBucketSpec(i,this._host):this._bucket=rA(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Qs.makeFromBucketSpec(this._url,e):this._bucket=rA(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){N1("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){N1("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(bn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ay(this,e)}_makeRequest(e,t,r,i,o=!0){if(this._deleted)return new VW(_P());{const c=QW(e,this._appId,r,i,t,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(c),c.getPromise().then(()=>this._requests.delete(c),()=>this._requests.delete(c)),c}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const iA="@firebase/storage",aA="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VK="storage";function FK(n,e,t){return n=Xe(n),IK(n,e,t)}function UK(n){return n=Xe(n),AK(n)}function BK(n,e){return n=Xe(n),kK(n,e)}function zK(n,e){return n=Xe(n),MP(n,e)}function $K(n){return n=Xe(n),CK(n)}function qK(n){return n=Xe(n),RK(n)}function HK(n){return n=Xe(n),DK(n)}function oA(n,e){return n=Xe(n),MK(n,e)}function GK(n,e){return LP(n,e)}function WK(n,e,t,r={}){LK(n,e,t,r)}function KK(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new lj(t,r,i,e,$a)}function QK(){hr(new $n(VK,KK,"PUBLIC").setMultipleInstances(!0)),ps(iA,aA,""),ps(iA,aA,"esm2020")}QK();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hp{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Hp(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new Hp(r,this,this._ref))},t)}on(e,t,r,i){let o;return t&&(typeof t=="function"?o=c=>t(new Hp(c,this,this._ref)):o={next:t.next?c=>t.next(new Hp(c,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,o,r||void 0,i||void 0)}}class cA{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new vo(e,this._service))}get items(){return this._delegate.items.map(e=>new vo(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=GK(this._delegate,e);return new vo(t,this.storage)}get root(){return new vo(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return e==null?null:new vo(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new lA(FK(this._delegate,e,t),this)}putString(e,t=bi.RAW,r){this._throwIfRoot("putString");const i=EP(t,e),o={...r};return o.contentType==null&&i.contentType!=null&&(o.contentType=i.contentType),new lA(new PP(this._delegate,new fo(i.data,!0),o),this)}listAll(){return $K(this._delegate).then(e=>new cA(e,this.storage))}list(e){return zK(this._delegate,e||void 0).then(t=>new cA(t,this.storage))}getMetadata(){return UK(this._delegate)}updateMetadata(e){return BK(this._delegate,e)}getDownloadURL(){return qK(this._delegate)}delete(){return this._throwIfRoot("delete"),HK(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw NP(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(dA(e))throw Ku("ref() expected a child path but got a URL, use refFromURL instead.");return new vo(oA(this._delegate,e),this)}refFromURL(e){if(!dA(e))throw Ku("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Qs.makeFromUrl(e,this._delegate.host)}catch{throw Ku("refFromUrl() expected a valid full URL but got an invalid one.")}return new vo(oA(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){WK(this._delegate,e,t,r)}}function dA(n){return/^[A-Za-z]+:\/\//.test(n)}const YK="@firebase/storage-compat",XK="0.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JK="storage-compat";function ZK(n,{instanceIdentifier:e}){const t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new FP(t,r)}function eQ(n){const e={TaskState:ar,TaskEvent:jK,StringFormat:bi,Storage:FP,Reference:vo};n.INTERNAL.registerComponent(new $n(JK,ZK,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion(YK,XK)}eQ(Nt);var uA={};const hA="@firebase/database",fA="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let UP="";function BP(n){UP=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tQ{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),gs(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Qm(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nQ{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Yr(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zP=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new tQ(e)}}catch{}return new nQ},Yc=zP("localStorage"),S1=zP("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qu=new Ph("@firebase/database"),$P=(function(){let n=1;return function(){return n++}})(),qP=function(n){const e=JL(n),t=new QL;t.update(e);const r=t.digest();return nN.encodeByteArray(r)},Zg=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Zg.apply(null,r):typeof r=="object"?e+=gs(r):e+=r,e+=" "}return e};let td=null,mA=!0;const HP=function(n,e){qe(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Qu.logLevel=Ot.VERBOSE,td=Qu.log.bind(Qu),e&&S1.set("logging_enabled",!0)):typeof n=="function"?td=n:(td=null,S1.remove("logging_enabled"))},Is=function(...n){if(mA===!0&&(mA=!1,td===null&&S1.get("logging_enabled")===!0&&HP(!0)),td){const e=Zg.apply(null,n);td(e)}},e0=function(n){return function(...e){Is(n,...e)}},E1=function(...n){const e="FIREBASE INTERNAL ERROR: "+Zg(...n);Qu.error(e)},Fa=function(...n){const e=`FIREBASE FATAL ERROR: ${Zg(...n)}`;throw Qu.error(e),new Error(e)},Xs=function(...n){const e="FIREBASE WARNING: "+Zg(...n);Qu.warn(e)},sQ=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Xs("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},oy=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},rQ=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Gl="[MIN_NAME]",To="[MAX_NAME]",Dd=function(n,e){if(n===e)return 0;if(n===Gl||e===To)return-1;if(e===Gl||n===To)return 1;{const t=gA(n),r=gA(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},iQ=function(n,e){return n===e?0:n<e?-1:1},dm=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+gs(e))},cj=function(n){if(typeof n!="object"||n===null)return gs(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=gs(e[r]),t+=":",t+=cj(n[e[r]]);return t+="}",t},GP=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function As(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const WP=function(n){qe(!oy(n),"Invalid JSON number");const e=11,t=52,r=(1<<e-1)-1;let i,o,c,u,h;n===0?(o=0,c=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(u=Math.min(Math.floor(Math.log(n)/Math.LN2),r),o=u+r,c=Math.round(n*Math.pow(2,t-u)-Math.pow(2,t))):(o=0,c=Math.round(n/Math.pow(2,1-r-t))));const m=[];for(h=t;h;h-=1)m.push(c%2?1:0),c=Math.floor(c/2);for(h=e;h;h-=1)m.push(o%2?1:0),o=Math.floor(o/2);m.push(i?1:0),m.reverse();const p=m.join("");let b="";for(h=0;h<64;h+=8){let v=parseInt(p.substr(h,8),2).toString(16);v.length===1&&(v="0"+v),b=b+v}return b.toLowerCase()},aQ=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},oQ=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function lQ(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}const cQ=new RegExp("^-?(0*)\\d{1,10}$"),dQ=-2147483648,uQ=2147483647,gA=function(n){if(cQ.test(n)){const e=Number(n);if(e>=dQ&&e<=uQ)return e}return null},Kh=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw Xs("Exception was thrown by user callback.",t),e},Math.floor(0))}},hQ=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},zm=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fQ{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,bn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)==null||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Xs(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mQ{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Is("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Xs(e)}}class Yu{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Yu.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dj="5",KP="v",QP="s",YP="r",XP="f",JP=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ZP="ls",e6="p",T1="ac",t6="websocket",n6="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s6{constructor(e,t,r,i,o=!1,c="",u=!1,h=!1,m=null){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=o,this.persistenceKey=c,this.includeNamespaceInQueryParams=u,this.isUsingEmulator=h,this.emulatorOptions=m,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Yc.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Yc.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function gQ(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function r6(n,e,t){qe(typeof e=="string","typeof type must == string"),qe(typeof t=="object","typeof params must == object");let r;if(e===t6)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===n6)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);gQ(n)&&(t.ns=n.namespace);const i=[];return As(t,(o,c)=>{i.push(o+"="+c)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pQ{constructor(){this.counters_={}}incrementCounter(e,t=1){Yr(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return kL(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d_={},u_={};function uj(n){const e=n.toString();return d_[e]||(d_[e]=new pQ),d_[e]}function xQ(n,e){const t=n.toString();return u_[t]||(u_[t]=e()),u_[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bQ{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Kh(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA="start",yQ="close",vQ="pLPCommand",wQ="pRTLPCB",i6="id",a6="pw",o6="ser",_Q="cb",NQ="seg",jQ="ts",SQ="d",EQ="dframe",l6=1870,c6=30,TQ=l6-c6,IQ=25e3,CQ=3e4;class Sl{constructor(e,t,r,i,o,c,u){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.transportSessionId=c,this.lastSessionId=u,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=e0(e),this.stats_=uj(t),this.urlFn=h=>(this.appCheckToken&&(h[T1]=this.appCheckToken),r6(t,n6,h))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new bQ(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(CQ)),rQ(()=>{if(this.isClosed_)return;this.scriptTagHolder=new hj((...o)=>{const[c,u,h,m,p]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,c===pA)this.id=u,this.password=h;else if(c===yQ)u?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(u,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+c)},(...o)=>{const[c,u]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(c,u)},()=>{this.onClosed_()},this.urlFn);const r={};r[pA]="t",r[o6]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[_Q]=this.scriptTagHolder.uniqueCallbackIdentifier),r[KP]=dj,this.transportSessionId&&(r[QP]=this.transportSessionId),this.lastSessionId&&(r[ZP]=this.lastSessionId),this.applicationId&&(r[e6]=this.applicationId),this.appCheckToken&&(r[T1]=this.appCheckToken),typeof location<"u"&&location.hostname&&JP.test(location.hostname)&&(r[YP]=XP);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Sl.forceAllow_=!0}static forceDisallow(){Sl.forceDisallow_=!0}static isAvailable(){return Sl.forceAllow_?!0:!Sl.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!aQ()&&!oQ()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=gs(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=I4(t),i=GP(r,TQ);for(let o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const r={};r[EQ]="t",r[i6]=e,r[a6]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=gs(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class hj{constructor(e,t,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=$P(),window[vQ+this.uniqueCallbackIdentifier]=e,window[wQ+this.uniqueCallbackIdentifier]=t,this.myIFrame=hj.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const c="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(c),this.myIFrame.doc.close()}catch(u){Is("frame writing exception"),u.stack&&Is(u.stack),Is(u)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Is("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[i6]=this.myID,e[a6]=this.myPW,e[o6]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+c6+r.length<=l6;){const c=this.pendingSegs.shift();r=r+"&"+NQ+i+"="+c.seg+"&"+jQ+i+"="+c.ts+"&"+SQ+i+"="+c.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(IQ)),o=()=>{clearTimeout(i),r()};this.addTag(e,o)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Is("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AQ=16384,kQ=45e3;let Zx=null;typeof MozWebSocket<"u"?Zx=MozWebSocket:typeof WebSocket<"u"&&(Zx=WebSocket);class pi{constructor(e,t,r,i,o,c,u){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=e0(this.connId),this.stats_=uj(t),this.connURL=pi.connectionURL_(t,c,u,i,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,r,i,o){const c={};return c[KP]=dj,typeof location<"u"&&location.hostname&&JP.test(location.hostname)&&(c[YP]=XP),t&&(c[QP]=t),r&&(c[ZP]=r),i&&(c[T1]=i),o&&(c[e6]=o),r6(e,t6,c)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Yc.set("previous_websocket_failure",!0);try{let r;BL(),this.mySock=new Zx(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){pi.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(t);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Zx!==null&&!pi.forceDisallow_}static previouslyFailed(){return Yc.isInMemoryStorage||Yc.get("previous_websocket_failure")===!0}markConnectionHealthy(){Yc.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const r=Qm(t);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(qe(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const r=this.extractFrameCount_(t);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const t=gs(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=GP(t,AQ);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(kQ))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}pi.responsesRequiredToBeHealthy=2;pi.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{static get ALL_TRANSPORTS(){return[Sl,pi]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=pi&&pi.isAvailable();let r=t&&!pi.previouslyFailed();if(e.webSocketOnly&&(t||Xs("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[pi];else{const i=this.transports_=[];for(const o of Sh.ALL_TRANSPORTS)o&&o.isAvailable()&&i.push(o);Sh.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Sh.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RQ=6e4,DQ=5e3,PQ=10*1024,OQ=100*1024,h_="t",xA="d",MQ="s",bA="r",LQ="e",yA="o",vA="a",wA="n",_A="p",VQ="h";class FQ{constructor(e,t,r,i,o,c,u,h,m,p){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=o,this.onMessage_=c,this.onReady_=u,this.onDisconnect_=h,this.onKill_=m,this.lastSessionId=p,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=e0("c:"+this.id+":"),this.transportManager_=new Sh(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=zm(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>OQ?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>PQ?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(h_ in e){const t=e[h_];t===vA?this.upgradeIfSecondaryHealthy_():t===bA?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===yA&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=dm("t",e),r=dm("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:_A,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:vA,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:wA,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=dm("t",e),r=dm("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=dm(h_,e);if(xA in e){const r=e[xA];if(t===VQ){const i={...r};this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===wA){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===MQ?this.onConnectionShutdown_(r):t===bA?this.onReset_(r):t===LQ?E1("Server Error: "+r):t===yA?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):E1("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),dj!==r&&Xs("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),zm(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(RQ))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):zm(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(DQ))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:_A,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Yc.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(e){this.allowedEvents_=e,this.listeners_={},qe(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let o=0;o<i.length;o++)if(i[o].callback===t&&(!r||r===i[o].context)){i.splice(o,1);return}}validateEventType_(e){qe(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb extends u6{static getInstance(){return new eb}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!oN()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return qe(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA=32,jA=768;class nn{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function Qt(){return new nn("")}function Dt(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Wl(n){return n.pieces_.length-n.pieceNum_}function pn(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new nn(n.pieces_,e)}function fj(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function UQ(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function vg(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function h6(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new nn(e,0)}function kn(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof nn)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new nn(t,0)}function Pt(n){return n.pieceNum_>=n.pieces_.length}function or(n,e){const t=Dt(n),r=Dt(e);if(t===null)return e;if(t===r)return or(pn(n),pn(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function BQ(n,e){const t=vg(n,0),r=vg(e,0);for(let i=0;i<t.length&&i<r.length;i++){const o=Dd(t[i],r[i]);if(o!==0)return o}return t.length===r.length?0:t.length<r.length?-1:1}function mj(n,e){if(Wl(n)!==Wl(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function yi(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Wl(n)>Wl(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class zQ{constructor(e,t){this.errorPrefix_=t,this.parts_=vg(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=yb(this.parts_[r]);f6(this)}}function $Q(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=yb(e),f6(n)}function qQ(n){const e=n.parts_.pop();n.byteLength_-=yb(e),n.parts_.length>0&&(n.byteLength_-=1)}function f6(n){if(n.byteLength_>jA)throw new Error(n.errorPrefix_+"has a key path longer than "+jA+" bytes ("+n.byteLength_+").");if(n.parts_.length>NA)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+NA+") or object contains a cycle "+Vc(n))}function Vc(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gj extends u6{static getInstance(){return new gj}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return qe(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const um=1e3,HQ=300*1e3,SA=30*1e3,GQ=1.3,WQ=3e4,KQ="server_kill",EA=3;class wo extends d6{constructor(e,t,r,i,o,c,u,h){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=o,this.authTokenProvider_=c,this.appCheckTokenProvider_=u,this.authOverride_=h,this.id=wo.nextPersistentConnectionId_++,this.log_=e0("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=um,this.maxReconnectDelay_=HQ,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,h)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");gj.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&eb.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){const i=++this.requestNumber_,o={r:i,a:e,b:t};this.log_(gs(o)),qe(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const t=new Nr,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:c=>{const u=c.d;c.s==="ok"?t.resolve(u):t.reject(u)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),t.promise}listen(e,t,r,i){this.initConnection_();const o=e._queryIdentifier,c=e._path.toString();this.log_("Listen called for "+c+" "+o),this.listens.has(c)||this.listens.set(c,new Map),qe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),qe(!this.listens.get(c).has(o),"listen() called twice for same path/queryId.");const u={onComplete:i,hashFn:t,query:e,tag:r};this.listens.get(c).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(r)})}sendListen_(e){const t=e.query,r=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+r+" for "+i);const o={p:r},c="q";e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(c,o,u=>{const h=u.d,m=u.s;wo.warnOnListenWarnings_(h,t),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",u),m!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(m,h))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Yr(e,"w")){const r=rd(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();Xs(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||KL(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=SA)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=WL(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(t,r,i=>{const o=i.s,c=i.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,c))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,r=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,r)})}unlisten(e,t){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),qe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,t)}sendUnlisten_(e,t,r,i){this.log_("Unlisten on "+e+" for "+t);const o={p:e},c="n";i&&(o.q=r,o.t=i),this.sendRequest(c,o)}onDisconnectPut(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})}onDisconnectMerge(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,r,i){const o={p:t,d:r};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,c=>{i&&setTimeout(()=>{i(c.s,c.d)},Math.floor(0))})}put(e,t,r,i){this.putInternal("p",e,t,r,i)}merge(e,t,r,i){this.putInternal("m",e,t,r,i)}putInternal(e,t,r,i,o){this.initConnection_();const c={p:t,d:r};o!==void 0&&(c.h=o),this.outstandingPuts_.push({action:e,request:c,onComplete:i}),this.outstandingPutCount_++;const u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,r,o=>{this.log_(t+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(o.s,o.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,r=>{if(r.s!=="ok"){const o=r.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+gs(e));const t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):E1("Unrecognized action received from server: "+gs(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){qe(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=um,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=um,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>WQ&&(this.reconnectDelay_=um),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*GQ)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+wo.nextConnectionId_++,o=this.lastSessionId;let c=!1,u=null;const h=function(){u?u.close():(c=!0,r())},m=function(b){qe(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(b)};this.realtime_={close:h,sendRequest:m};const p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[b,v]=await Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);c?Is("getToken() completed but was canceled"):(Is("getToken() completed. Creating connection."),this.authToken_=b&&b.accessToken,this.appCheckToken_=v&&v.token,u=new FQ(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,_=>{Xs(_+" ("+this.repoInfo_.toString()+")"),this.interrupt(KQ)},o))}catch(b){this.log_("Failed to get token: "+b),c||(this.repoInfo_.nodeAdmin&&Xs(b),h())}}}interrupt(e){Is("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Is("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Nx(this.interruptReasons_)&&(this.reconnectDelay_=um,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let r;t?r=t.map(o=>cj(o)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const r=new nn(e).toString();let i;if(this.listens.has(r)){const o=this.listens.get(r);i=o.get(t),o.delete(t),o.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,t){Is("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=EA&&(this.reconnectDelay_=SA,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Is("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=EA&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+UP.replace(/\./g,"-")]=1,oN()?e["framework.cordova"]=1:bb()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=eb.getInstance().currentlyOnline();return Nx(this.interruptReasons_)&&e}}wo.nextPersistentConnectionId_=0;wo.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Mt(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new Mt(Gl,e),i=new Mt(Gl,t);return this.compare(r,i)!==0}minPost(){return Mt.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gp;class m6 extends ly{static get __EMPTY_NODE(){return Gp}static set __EMPTY_NODE(e){Gp=e}compare(e,t){return Dd(e.name,t.name)}isDefinedOn(e){throw Dh("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Mt.MIN}maxPost(){return new Mt(To,Gp)}makePost(e,t){return qe(typeof e=="string","KeyIndex indexValue must always be a string."),new Mt(e,Gp)}toString(){return".key"}}const Oa=new m6;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(e,t,r,i,o=null){this.isReverse_=i,this.resultGenerator_=o,this.nodeStack_=[];let c=1;for(;!e.isEmpty();)if(e=e,c=t?r(e.key,t):1,i&&(c*=-1),c<0)this.isReverse_?e=e.left:e=e.right;else if(c===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Ts{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??Ts.RED,this.left=i??Tr.EMPTY_NODE,this.right=o??Tr.EMPTY_NODE}copy(e,t,r,i,o){return new Ts(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const o=r(e,i.key);return o<0?i=i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i=i.copy(null,t,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Tr.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let r,i;if(r=this,t(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),t(e,r.key)===0){if(r.right.isEmpty())return Tr.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Ts.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Ts.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Ts.RED=!0;Ts.BLACK=!1;class QQ{copy(e,t,r,i,o){return this}insert(e,t,r){return new Ts(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Tr{constructor(e,t=Tr.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Tr(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Ts.BLACK,null,null))}remove(e){return new Tr(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ts.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Wp(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Wp(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Wp(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Wp(this.root_,null,this.comparator_,!0,e)}}Tr.EMPTY_NODE=new QQ;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YQ(n,e){return Dd(n.name,e.name)}function pj(n,e){return Dd(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let I1;function XQ(n){I1=n}const g6=function(n){return typeof n=="number"?"number:"+WP(n):"string:"+n},p6=function(n){if(n.isLeafNode()){const e=n.val();qe(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Yr(e,".sv"),"Priority must be a string or number.")}else qe(n===I1||n.isEmpty(),"priority of unexpected type.");qe(n===I1||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TA;class Ns{static set __childrenNodeConstructor(e){TA=e}static get __childrenNodeConstructor(){return TA}constructor(e,t=Ns.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,qe(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),p6(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Ns(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Ns.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Pt(e)?this:Dt(e)===".priority"?this.priorityNode_:Ns.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:Ns.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const r=Dt(e);return r===null?t:t.isEmpty()&&r!==".priority"?this:(qe(r!==".priority"||Wl(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,Ns.__childrenNodeConstructor.EMPTY_NODE.updateChild(pn(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+g6(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=WP(this.value_):e+=this.value_,this.lazyHash_=qP(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Ns.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Ns.__childrenNodeConstructor?-1:(qe(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,r=typeof this.value_,i=Ns.VALUE_TYPE_ORDER.indexOf(t),o=Ns.VALUE_TYPE_ORDER.indexOf(r);return qe(i>=0,"Unknown leaf type: "+t),qe(o>=0,"Unknown leaf type: "+r),i===o?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}Ns.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let x6,b6;function JQ(n){x6=n}function ZQ(n){b6=n}class eY extends ly{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),o=r.compareTo(i);return o===0?Dd(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Mt.MIN}maxPost(){return new Mt(To,new Ns("[PRIORITY-POST]",b6))}makePost(e,t){const r=x6(e);return new Mt(t,new Ns("[PRIORITY-POST]",r))}toString(){return".priority"}}const yn=new eY;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tY=Math.log(2);class nY{constructor(e){const t=o=>parseInt(Math.log(o)/tY,10),r=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const tb=function(n,e,t,r){n.sort(e);const i=function(h,m){const p=m-h;let b,v;if(p===0)return null;if(p===1)return b=n[h],v=t?t(b):b,new Ts(v,b.node,Ts.BLACK,null,null);{const _=parseInt(p/2,10)+h,T=i(h,_),k=i(_+1,m);return b=n[_],v=t?t(b):b,new Ts(v,b.node,Ts.BLACK,T,k)}},o=function(h){let m=null,p=null,b=n.length;const v=function(T,k){const E=b-T,S=b;b-=T;const L=i(E+1,S),$=n[E],H=t?t($):$;_(new Ts(H,$.node,k,null,L))},_=function(T){m?(m.left=T,m=T):(p=T,m=T)};for(let T=0;T<h.count;++T){const k=h.nextBitIsOne(),E=Math.pow(2,h.count-(T+1));k?v(E,Ts.BLACK):(v(E,Ts.BLACK),v(E,Ts.RED))}return p},c=new nY(n.length),u=o(c);return new Tr(r||e,u)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let f_;const ku={};class xo{static get Default(){return qe(ku&&yn,"ChildrenNode.ts has not been loaded"),f_=f_||new xo({".priority":ku},{".priority":yn}),f_}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=rd(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Tr?t:null}hasIndex(e){return Yr(this.indexSet_,e.toString())}addIndex(e,t){qe(e!==Oa,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const o=t.getIterator(Mt.Wrap);let c=o.getNext();for(;c;)i=i||e.isDefinedOn(c.node),r.push(c),c=o.getNext();let u;i?u=tb(r,e.getCompare()):u=ku;const h=e.toString(),m={...this.indexSet_};m[h]=e;const p={...this.indexes_};return p[h]=u,new xo(p,m)}addToIndexes(e,t){const r=jx(this.indexes_,(i,o)=>{const c=rd(this.indexSet_,o);if(qe(c,"Missing index implementation for "+o),i===ku)if(c.isDefinedOn(e.node)){const u=[],h=t.getIterator(Mt.Wrap);let m=h.getNext();for(;m;)m.name!==e.name&&u.push(m),m=h.getNext();return u.push(e),tb(u,c.getCompare())}else return ku;else{const u=t.get(e.name);let h=i;return u&&(h=h.remove(new Mt(e.name,u))),h.insert(e,e.node)}});return new xo(r,this.indexSet_)}removeFromIndexes(e,t){const r=jx(this.indexes_,i=>{if(i===ku)return i;{const o=t.get(e.name);return o?i.remove(new Mt(e.name,o)):i}});return new xo(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hm;class bt{static get EMPTY_NODE(){return hm||(hm=new bt(new Tr(pj),null,xo.Default))}constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&p6(this.priorityNode_),this.children_.isEmpty()&&qe(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||hm}updatePriority(e){return this.children_.isEmpty()?this:new bt(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?hm:t}}getChild(e){const t=Dt(e);return t===null?this:this.getImmediateChild(t).getChild(pn(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(qe(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const r=new Mt(e,t);let i,o;t.isEmpty()?(i=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(r,this.children_));const c=i.isEmpty()?hm:this.priorityNode_;return new bt(i,c,o)}}updateChild(e,t){const r=Dt(e);if(r===null)return t;{qe(Dt(e)!==".priority"||Wl(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(pn(e),t);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let r=0,i=0,o=!0;if(this.forEachChild(yn,(c,u)=>{t[c]=u.val(e),r++,o&&bt.INTEGER_REGEXP_.test(c)?i=Math.max(i,Number(c)):o=!1}),!e&&o&&i<2*r){const c=[];for(const u in t)c[u]=t[u];return c}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+g6(this.getPriority().val())+":"),this.forEachChild(yn,(t,r)=>{const i=r.hash();i!==""&&(e+=":"+t+":"+i)}),this.lazyHash_=e===""?"":qP(e)}return this.lazyHash_}getPredecessorChildName(e,t,r){const i=this.resolveIndex_(r);if(i){const o=i.getPredecessorKey(new Mt(e,t));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Mt(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Mt(t,this.children_.get(t)):null}forEachChild(e,t){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>t(i.name,i.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,Mt.Wrap);let o=i.peek();for(;o!=null&&t.compare(o,e)<0;)i.getNext(),o=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,Mt.Wrap);let o=i.peek();for(;o!=null&&t.compare(o,e)>0;)i.getNext(),o=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===t0?-1:0}withIndex(e){if(e===Oa||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new bt(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Oa||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const r=this.getIterator(yn),i=t.getIterator(yn);let o=r.getNext(),c=i.getNext();for(;o&&c;){if(o.name!==c.name||!o.node.equals(c.node))return!1;o=r.getNext(),c=i.getNext()}return o===null&&c===null}else return!1;else return!1}}resolveIndex_(e){return e===Oa?null:this.indexMap_.get(e.toString())}}bt.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class sY extends bt{constructor(){super(new Tr(pj),bt.EMPTY_NODE,xo.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return bt.EMPTY_NODE}isEmpty(){return!1}}const t0=new sY;Object.defineProperties(Mt,{MIN:{value:new Mt(Gl,bt.EMPTY_NODE)},MAX:{value:new Mt(To,t0)}});m6.__EMPTY_NODE=bt.EMPTY_NODE;Ns.__childrenNodeConstructor=bt;XQ(t0);ZQ(t0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rY=!0;function On(n,e=null){if(n===null)return bt.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),qe(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new Ns(t,On(e))}if(!(n instanceof Array)&&rY){const t=[];let r=!1;if(As(n,(c,u)=>{if(c.substring(0,1)!=="."){const h=On(u);h.isEmpty()||(r=r||!h.getPriority().isEmpty(),t.push(new Mt(c,h)))}}),t.length===0)return bt.EMPTY_NODE;const o=tb(t,YQ,c=>c.name,pj);if(r){const c=tb(t,yn.getCompare());return new bt(o,On(e),new xo({".priority":c},{".priority":yn}))}else return new bt(o,On(e),xo.Default)}else{let t=bt.EMPTY_NODE;return As(n,(r,i)=>{if(Yr(n,r)&&r.substring(0,1)!=="."){const o=On(i);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(r,o))}}),t.updatePriority(On(e))}}JQ(On);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xj extends ly{constructor(e){super(),this.indexPath_=e,qe(!Pt(e)&&Dt(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),o=r.compareTo(i);return o===0?Dd(e.name,t.name):o}makePost(e,t){const r=On(e),i=bt.EMPTY_NODE.updateChild(this.indexPath_,r);return new Mt(t,i)}maxPost(){const e=bt.EMPTY_NODE.updateChild(this.indexPath_,t0);return new Mt(To,e)}toString(){return vg(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iY extends ly{compare(e,t){const r=e.node.compareTo(t.node);return r===0?Dd(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Mt.MIN}maxPost(){return Mt.MAX}makePost(e,t){const r=On(e);return new Mt(t,r)}toString(){return".value"}}const bj=new iY;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y6(n){return{type:"value",snapshotNode:n}}function Eh(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function wg(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function _g(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function aY(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yj{constructor(e){this.index_=e}updateChild(e,t,r,i,o,c){qe(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const u=e.getImmediateChild(t);return u.getChild(i).equals(r.getChild(i))&&u.isEmpty()===r.isEmpty()||(c!=null&&(r.isEmpty()?e.hasChild(t)?c.trackChildChange(wg(t,u)):qe(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):u.isEmpty()?c.trackChildChange(Eh(t,r)):c.trackChildChange(_g(t,r,u))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(yn,(i,o)=>{t.hasChild(i)||r.trackChildChange(wg(i,o))}),t.isLeafNode()||t.forEachChild(yn,(i,o)=>{if(e.hasChild(i)){const c=e.getImmediateChild(i);c.equals(o)||r.trackChildChange(_g(i,o,c))}else r.trackChildChange(Eh(i,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?bt.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng{constructor(e){this.indexedFilter_=new yj(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Ng.getStartPost_(e),this.endPost_=Ng.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,o,c){return this.matches(new Mt(t,r))||(r=bt.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,o,c)}updateFullNode(e,t,r){t.isLeafNode()&&(t=bt.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(bt.EMPTY_NODE);const o=this;return t.forEachChild(yn,(c,u)=>{o.matches(new Mt(c,u))||(i=i.updateImmediateChild(c,bt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oY{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Ng(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,o,c){return this.rangedFilter_.matches(new Mt(t,r))||(r=bt.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,o,c):this.fullLimitUpdateChild_(e,t,r,o,c)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=bt.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=bt.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let c=0;for(;o.hasNext()&&c<this.limit_;){const u=o.getNext();if(this.withinDirectionalStart(u))if(this.withinDirectionalEnd(u))i=i.updateImmediateChild(u.name,u.node),c++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(bt.EMPTY_NODE);let o;this.reverse_?o=i.getReverseIterator(this.index_):o=i.getIterator(this.index_);let c=0;for(;o.hasNext();){const u=o.getNext();c<this.limit_&&this.withinDirectionalStart(u)&&this.withinDirectionalEnd(u)?c++:i=i.updateImmediateChild(u.name,bt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,o){let c;if(this.reverse_){const b=this.index_.getCompare();c=(v,_)=>b(_,v)}else c=this.index_.getCompare();const u=e;qe(u.numChildren()===this.limit_,"");const h=new Mt(t,r),m=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),p=this.rangedFilter_.matches(h);if(u.hasChild(t)){const b=u.getImmediateChild(t);let v=i.getChildAfterChild(this.index_,m,this.reverse_);for(;v!=null&&(v.name===t||u.hasChild(v.name));)v=i.getChildAfterChild(this.index_,v,this.reverse_);const _=v==null?1:c(v,h);if(p&&!r.isEmpty()&&_>=0)return o!=null&&o.trackChildChange(_g(t,r,b)),u.updateImmediateChild(t,r);{o!=null&&o.trackChildChange(wg(t,b));const k=u.updateImmediateChild(t,bt.EMPTY_NODE);return v!=null&&this.rangedFilter_.matches(v)?(o!=null&&o.trackChildChange(Eh(v.name,v.node)),k.updateImmediateChild(v.name,v.node)):k}}else return r.isEmpty()?e:p&&c(m,h)>=0?(o!=null&&(o.trackChildChange(wg(m.name,m.node)),o.trackChildChange(Eh(t,r))),u.updateImmediateChild(t,r).updateImmediateChild(m.name,bt.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=yn}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return qe(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return qe(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Gl}hasEnd(){return this.endSet_}getIndexEndValue(){return qe(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return qe(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:To}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return qe(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===yn}copy(){const e=new cy;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function lY(n){return n.loadsAllData()?new yj(n.getIndex()):n.hasLimit()?new oY(n):new Ng(n)}function cY(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function dY(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function C1(n,e,t){const r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function uY(n,e,t){let r;return n.index_===Oa||t?r=C1(n,e,t):r=C1(n,e,To),r.startAfterSet_=!0,r}function A1(n,e,t){const r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function hY(n,e,t){let r;return n.index_===Oa||t?r=A1(n,e,t):r=A1(n,e,Gl),r.endBeforeSet_=!0,r}function dy(n,e){const t=n.copy();return t.index_=e,t}function IA(n){const e={};if(n.isDefault())return e;let t;if(n.index_===yn?t="$priority":n.index_===bj?t="$value":n.index_===Oa?t="$key":(qe(n.index_ instanceof xj,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=gs(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=gs(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+gs(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=gs(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+gs(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function CA(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==yn&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb extends d6{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(qe(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=e0("p:rest:"),this.listens_={}}listen(e,t,r,i){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const c=nb.getListenId_(e,r),u={};this.listens_[c]=u;const h=IA(e._queryParams);this.restRequest_(o+".json",h,(m,p)=>{let b=p;if(m===404&&(b=null,m=null),m===null&&this.onDataUpdate_(o,b,!1,r),rd(this.listens_,c)===u){let v;m?m===401?v="permission_denied":v="rest_error:"+m:v="ok",i(v,null)}})}unlisten(e,t){const r=nb.getListenId_(e,t);delete this.listens_[r]}get(e){const t=IA(e._queryParams),r=e._path.toString(),i=new Nr;return this.restRequest_(r+".json",t,(o,c)=>{let u=c;o===404&&(u=null,o=null),o===null?(this.onDataUpdate_(r,u,!1,null),i.resolve(u)):i.reject(new Error(u))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,o])=>{i&&i.accessToken&&(t.auth=i.accessToken),o&&o.token&&(t.ac=o.token);const c=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Td(t);this.log_("Sending REST request for "+c);const u=new XMLHttpRequest;u.onreadystatechange=()=>{if(r&&u.readyState===4){this.log_("REST Response for "+c+" received. status:",u.status,"response:",u.responseText);let h=null;if(u.status>=200&&u.status<300){try{h=Qm(u.responseText)}catch{Xs("Failed to parse JSON response for "+c+": "+u.responseText)}r(null,h)}else u.status!==401&&u.status!==404&&Xs("Got unsuccessful REST response for "+c+" Status: "+u.status),r(u.status);r=null}},u.open("GET",c,!0),u.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fY{constructor(){this.rootNode_=bt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sb(){return{value:null,children:new Map}}function Qh(n,e,t){if(Pt(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const r=Dt(e);n.children.has(r)||n.children.set(r,sb());const i=n.children.get(r);e=pn(e),Qh(i,e,t)}}function k1(n,e){if(Pt(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(yn,(r,i)=>{Qh(n,new nn(r),i)}),k1(n,e)}}else if(n.children.size>0){const t=Dt(e);return e=pn(e),n.children.has(t)&&k1(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function R1(n,e,t){n.value!==null?t(e,n.value):mY(n,(r,i)=>{const o=new nn(e.toString()+"/"+r);R1(i,o,t)})}function mY(n,e){n.children.forEach((t,r)=>{e(r,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gY{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t={...e};return this.last_&&As(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA=10*1e3,pY=30*1e3,xY=300*1e3;class bY{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new gY(e);const r=AA+(pY-AA)*Math.random();zm(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;As(e,(i,o)=>{o>0&&Yr(this.statsToReport_,i)&&(t[i]=o,r=!0)}),r&&this.server_.reportStats(t),zm(this.reportStats_.bind(this),Math.floor(Math.random()*2*xY))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $i;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})($i||($i={}));function vj(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function wj(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function _j(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=$i.ACK_USER_WRITE,this.source=vj()}operationForChild(e){if(Pt(this.path)){if(this.affectedTree.value!=null)return qe(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new nn(e));return new rb(Qt(),t,this.revert)}}else return qe(Dt(this.path)===e,"operationForChild called for unrelated child."),new rb(pn(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg{constructor(e,t){this.source=e,this.path=t,this.type=$i.LISTEN_COMPLETE}operationForChild(e){return Pt(this.path)?new jg(this.source,Qt()):new jg(this.source,pn(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=$i.OVERWRITE}operationForChild(e){return Pt(this.path)?new Nd(this.source,Qt(),this.snap.getImmediateChild(e)):new Nd(this.source,pn(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=$i.MERGE}operationForChild(e){if(Pt(this.path)){const t=this.children.subtree(new nn(e));return t.isEmpty()?null:t.value?new Nd(this.source,Qt(),t.value):new Th(this.source,Qt(),t)}else return qe(Dt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Th(this.source,pn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Pt(e))return this.isFullyInitialized()&&!this.filtered_;const t=Dt(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yY{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function vY(n,e,t,r){const i=[],o=[];return e.forEach(c=>{c.type==="child_changed"&&n.index_.indexedValueChanged(c.oldSnap,c.snapshotNode)&&o.push(aY(c.childName,c.snapshotNode))}),fm(n,i,"child_removed",e,r,t),fm(n,i,"child_added",e,r,t),fm(n,i,"child_moved",o,r,t),fm(n,i,"child_changed",e,r,t),fm(n,i,"value",e,r,t),i}function fm(n,e,t,r,i,o){const c=r.filter(u=>u.type===t);c.sort((u,h)=>_Y(n,u,h)),c.forEach(u=>{const h=wY(n,u,o);i.forEach(m=>{m.respondsTo(u.type)&&e.push(m.createEvent(h,n.query_))})})}function wY(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function _Y(n,e,t){if(e.childName==null||t.childName==null)throw Dh("Should only compare child_ events.");const r=new Mt(e.childName,e.snapshotNode),i=new Mt(t.childName,t.snapshotNode);return n.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uy(n,e){return{eventCache:n,serverCache:e}}function $m(n,e,t,r){return uy(new Kl(e,t,r),n.serverCache)}function v6(n,e,t,r){return uy(n.eventCache,new Kl(e,t,r))}function ib(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function jd(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let m_;const NY=()=>(m_||(m_=new Tr(iQ)),m_);class xn{static fromObject(e){let t=new xn(null);return As(e,(r,i)=>{t=t.set(new nn(r),i)}),t}constructor(e,t=NY()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Qt(),value:this.value};if(Pt(e))return null;{const r=Dt(e),i=this.children.get(r);if(i!==null){const o=i.findRootMostMatchingPathAndValue(pn(e),t);return o!=null?{path:kn(new nn(r),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Pt(e))return this;{const t=Dt(e),r=this.children.get(t);return r!==null?r.subtree(pn(e)):new xn(null)}}set(e,t){if(Pt(e))return new xn(t,this.children);{const r=Dt(e),o=(this.children.get(r)||new xn(null)).set(pn(e),t),c=this.children.insert(r,o);return new xn(this.value,c)}}remove(e){if(Pt(e))return this.children.isEmpty()?new xn(null):new xn(null,this.children);{const t=Dt(e),r=this.children.get(t);if(r){const i=r.remove(pn(e));let o;return i.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,i),this.value===null&&o.isEmpty()?new xn(null):new xn(this.value,o)}else return this}}get(e){if(Pt(e))return this.value;{const t=Dt(e),r=this.children.get(t);return r?r.get(pn(e)):null}}setTree(e,t){if(Pt(e))return t;{const r=Dt(e),o=(this.children.get(r)||new xn(null)).setTree(pn(e),t);let c;return o.isEmpty()?c=this.children.remove(r):c=this.children.insert(r,o),new xn(this.value,c)}}fold(e){return this.fold_(Qt(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,o)=>{r[i]=o.fold_(kn(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Qt(),t)}findOnPath_(e,t,r){const i=this.value?r(t,this.value):!1;if(i)return i;if(Pt(e))return null;{const o=Dt(e),c=this.children.get(o);return c?c.findOnPath_(pn(e),kn(t,o),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Qt(),t)}foreachOnPath_(e,t,r){if(Pt(e))return this;{this.value&&r(t,this.value);const i=Dt(e),o=this.children.get(i);return o?o.foreachOnPath_(pn(e),kn(t,i),r):new xn(null)}}foreach(e){this.foreach_(Qt(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(kn(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e){this.writeTree_=e}static empty(){return new Ki(new xn(null))}}function qm(n,e,t){if(Pt(e))return new Ki(new xn(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let o=r.value;const c=or(i,e);return o=o.updateChild(c,t),new Ki(n.writeTree_.set(i,o))}else{const i=new xn(t),o=n.writeTree_.setTree(e,i);return new Ki(o)}}}function D1(n,e,t){let r=n;return As(t,(i,o)=>{r=qm(r,kn(e,i),o)}),r}function kA(n,e){if(Pt(e))return Ki.empty();{const t=n.writeTree_.setTree(e,new xn(null));return new Ki(t)}}function P1(n,e){return Pd(n,e)!=null}function Pd(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(or(t.path,e)):null}function RA(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(yn,(r,i)=>{e.push(new Mt(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Mt(r,i.value))}),e}function Dl(n,e){if(Pt(e))return n;{const t=Pd(n,e);return t!=null?new Ki(new xn(t)):new Ki(n.writeTree_.subtree(e))}}function O1(n){return n.writeTree_.isEmpty()}function Ih(n,e){return w6(Qt(),n.writeTree_,e)}function w6(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,o)=>{i===".priority"?(qe(o.value!==null,"Priority writes must always be leaf nodes"),r=o.value):t=w6(kn(n,i),o,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(kn(n,".priority"),r)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hy(n,e){return S6(e,n)}function jY(n,e,t,r,i){qe(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=qm(n.visibleWrites,e,t)),n.lastWriteId=r}function SY(n,e,t,r){qe(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=D1(n.visibleWrites,e,t),n.lastWriteId=r}function EY(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}function TY(n,e){const t=n.allWrites.findIndex(u=>u.writeId===e);qe(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,o=!1,c=n.allWrites.length-1;for(;i&&c>=0;){const u=n.allWrites[c];u.visible&&(c>=t&&IY(u,r.path)?i=!1:yi(r.path,u.path)&&(o=!0)),c--}if(i){if(o)return CY(n),!0;if(r.snap)n.visibleWrites=kA(n.visibleWrites,r.path);else{const u=r.children;As(u,h=>{n.visibleWrites=kA(n.visibleWrites,kn(r.path,h))})}return!0}else return!1}function IY(n,e){if(n.snap)return yi(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&yi(kn(n.path,t),e))return!0;return!1}function CY(n){n.visibleWrites=_6(n.allWrites,AY,Qt()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function AY(n){return n.visible}function _6(n,e,t){let r=Ki.empty();for(let i=0;i<n.length;++i){const o=n[i];if(e(o)){const c=o.path;let u;if(o.snap)yi(t,c)?(u=or(t,c),r=qm(r,u,o.snap)):yi(c,t)&&(u=or(c,t),r=qm(r,Qt(),o.snap.getChild(u)));else if(o.children){if(yi(t,c))u=or(t,c),r=D1(r,u,o.children);else if(yi(c,t))if(u=or(c,t),Pt(u))r=D1(r,Qt(),o.children);else{const h=rd(o.children,Dt(u));if(h){const m=h.getChild(pn(u));r=qm(r,Qt(),m)}}}else throw Dh("WriteRecord should have .snap or .children")}}return r}function N6(n,e,t,r,i){if(!r&&!i){const o=Pd(n.visibleWrites,e);if(o!=null)return o;{const c=Dl(n.visibleWrites,e);if(O1(c))return t;if(t==null&&!P1(c,Qt()))return null;{const u=t||bt.EMPTY_NODE;return Ih(c,u)}}}else{const o=Dl(n.visibleWrites,e);if(!i&&O1(o))return t;if(!i&&t==null&&!P1(o,Qt()))return null;{const c=function(m){return(m.visible||i)&&(!r||!~r.indexOf(m.writeId))&&(yi(m.path,e)||yi(e,m.path))},u=_6(n.allWrites,c,e),h=t||bt.EMPTY_NODE;return Ih(u,h)}}}function kY(n,e,t){let r=bt.EMPTY_NODE;const i=Pd(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(yn,(o,c)=>{r=r.updateImmediateChild(o,c)}),r;if(t){const o=Dl(n.visibleWrites,e);return t.forEachChild(yn,(c,u)=>{const h=Ih(Dl(o,new nn(c)),u);r=r.updateImmediateChild(c,h)}),RA(o).forEach(c=>{r=r.updateImmediateChild(c.name,c.node)}),r}else{const o=Dl(n.visibleWrites,e);return RA(o).forEach(c=>{r=r.updateImmediateChild(c.name,c.node)}),r}}function RY(n,e,t,r,i){qe(r||i,"Either existingEventSnap or existingServerSnap must exist");const o=kn(e,t);if(P1(n.visibleWrites,o))return null;{const c=Dl(n.visibleWrites,o);return O1(c)?i.getChild(t):Ih(c,i.getChild(t))}}function DY(n,e,t,r){const i=kn(e,t),o=Pd(n.visibleWrites,i);if(o!=null)return o;if(r.isCompleteForChild(t)){const c=Dl(n.visibleWrites,i);return Ih(c,r.getNode().getImmediateChild(t))}else return null}function PY(n,e){return Pd(n.visibleWrites,e)}function OY(n,e,t,r,i,o,c){let u;const h=Dl(n.visibleWrites,e),m=Pd(h,Qt());if(m!=null)u=m;else if(t!=null)u=Ih(h,t);else return[];if(u=u.withIndex(c),!u.isEmpty()&&!u.isLeafNode()){const p=[],b=c.getCompare(),v=o?u.getReverseIteratorFrom(r,c):u.getIteratorFrom(r,c);let _=v.getNext();for(;_&&p.length<i;)b(_,r)!==0&&p.push(_),_=v.getNext();return p}else return[]}function MY(){return{visibleWrites:Ki.empty(),allWrites:[],lastWriteId:-1}}function ab(n,e,t,r){return N6(n.writeTree,n.treePath,e,t,r)}function Nj(n,e){return kY(n.writeTree,n.treePath,e)}function DA(n,e,t,r){return RY(n.writeTree,n.treePath,e,t,r)}function ob(n,e){return PY(n.writeTree,kn(n.treePath,e))}function LY(n,e,t,r,i,o){return OY(n.writeTree,n.treePath,e,t,r,i,o)}function jj(n,e,t){return DY(n.writeTree,n.treePath,e,t)}function j6(n,e){return S6(kn(n.treePath,e),n.writeTree)}function S6(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VY{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;qe(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),qe(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const o=i.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(r,_g(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(r,wg(r,i.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(r,Eh(r,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(r,_g(r,e.snapshotNode,i.oldSnap));else throw Dh("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FY{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}}const E6=new FY;class Sj{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new Kl(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return jj(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:jd(this.viewCache_),o=LY(this.writes_,i,t,1,r,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UY(n){return{filter:n}}function BY(n,e){qe(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),qe(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function zY(n,e,t,r,i){const o=new VY;let c,u;if(t.type===$i.OVERWRITE){const m=t;m.source.fromUser?c=M1(n,e,m.path,m.snap,r,i,o):(qe(m.source.fromServer,"Unknown source."),u=m.source.tagged||e.serverCache.isFiltered()&&!Pt(m.path),c=lb(n,e,m.path,m.snap,r,i,u,o))}else if(t.type===$i.MERGE){const m=t;m.source.fromUser?c=qY(n,e,m.path,m.children,r,i,o):(qe(m.source.fromServer,"Unknown source."),u=m.source.tagged||e.serverCache.isFiltered(),c=L1(n,e,m.path,m.children,r,i,u,o))}else if(t.type===$i.ACK_USER_WRITE){const m=t;m.revert?c=WY(n,e,m.path,r,i,o):c=HY(n,e,m.path,m.affectedTree,r,i,o)}else if(t.type===$i.LISTEN_COMPLETE)c=GY(n,e,t.path,r,o);else throw Dh("Unknown operation type: "+t.type);const h=o.getChanges();return $Y(e,c,h),{viewCache:c,changes:h}}function $Y(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=ib(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&t.push(y6(ib(e)))}}function T6(n,e,t,r,i,o){const c=e.eventCache;if(ob(r,t)!=null)return e;{let u,h;if(Pt(t))if(qe(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const m=jd(e),p=m instanceof bt?m:bt.EMPTY_NODE,b=Nj(r,p);u=n.filter.updateFullNode(e.eventCache.getNode(),b,o)}else{const m=ab(r,jd(e));u=n.filter.updateFullNode(e.eventCache.getNode(),m,o)}else{const m=Dt(t);if(m===".priority"){qe(Wl(t)===1,"Can't have a priority with additional path components");const p=c.getNode();h=e.serverCache.getNode();const b=DA(r,t,p,h);b!=null?u=n.filter.updatePriority(p,b):u=c.getNode()}else{const p=pn(t);let b;if(c.isCompleteForChild(m)){h=e.serverCache.getNode();const v=DA(r,t,c.getNode(),h);v!=null?b=c.getNode().getImmediateChild(m).updateChild(p,v):b=c.getNode().getImmediateChild(m)}else b=jj(r,m,e.serverCache);b!=null?u=n.filter.updateChild(c.getNode(),m,b,p,i,o):u=c.getNode()}}return $m(e,u,c.isFullyInitialized()||Pt(t),n.filter.filtersNodes())}}function lb(n,e,t,r,i,o,c,u){const h=e.serverCache;let m;const p=c?n.filter:n.filter.getIndexedFilter();if(Pt(t))m=p.updateFullNode(h.getNode(),r,null);else if(p.filtersNodes()&&!h.isFiltered()){const _=h.getNode().updateChild(t,r);m=p.updateFullNode(h.getNode(),_,null)}else{const _=Dt(t);if(!h.isCompleteForPath(t)&&Wl(t)>1)return e;const T=pn(t),E=h.getNode().getImmediateChild(_).updateChild(T,r);_===".priority"?m=p.updatePriority(h.getNode(),E):m=p.updateChild(h.getNode(),_,E,T,E6,null)}const b=v6(e,m,h.isFullyInitialized()||Pt(t),p.filtersNodes()),v=new Sj(i,b,o);return T6(n,b,t,i,v,u)}function M1(n,e,t,r,i,o,c){const u=e.eventCache;let h,m;const p=new Sj(i,e,o);if(Pt(t))m=n.filter.updateFullNode(e.eventCache.getNode(),r,c),h=$m(e,m,!0,n.filter.filtersNodes());else{const b=Dt(t);if(b===".priority")m=n.filter.updatePriority(e.eventCache.getNode(),r),h=$m(e,m,u.isFullyInitialized(),u.isFiltered());else{const v=pn(t),_=u.getNode().getImmediateChild(b);let T;if(Pt(v))T=r;else{const k=p.getCompleteChild(b);k!=null?fj(v)===".priority"&&k.getChild(h6(v)).isEmpty()?T=k:T=k.updateChild(v,r):T=bt.EMPTY_NODE}if(_.equals(T))h=e;else{const k=n.filter.updateChild(u.getNode(),b,T,v,p,c);h=$m(e,k,u.isFullyInitialized(),n.filter.filtersNodes())}}}return h}function PA(n,e){return n.eventCache.isCompleteForChild(e)}function qY(n,e,t,r,i,o,c){let u=e;return r.foreach((h,m)=>{const p=kn(t,h);PA(e,Dt(p))&&(u=M1(n,u,p,m,i,o,c))}),r.foreach((h,m)=>{const p=kn(t,h);PA(e,Dt(p))||(u=M1(n,u,p,m,i,o,c))}),u}function OA(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function L1(n,e,t,r,i,o,c,u){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let h=e,m;Pt(t)?m=r:m=new xn(null).setTree(t,r);const p=e.serverCache.getNode();return m.children.inorderTraversal((b,v)=>{if(p.hasChild(b)){const _=e.serverCache.getNode().getImmediateChild(b),T=OA(n,_,v);h=lb(n,h,new nn(b),T,i,o,c,u)}}),m.children.inorderTraversal((b,v)=>{const _=!e.serverCache.isCompleteForChild(b)&&v.value===null;if(!p.hasChild(b)&&!_){const T=e.serverCache.getNode().getImmediateChild(b),k=OA(n,T,v);h=lb(n,h,new nn(b),k,i,o,c,u)}}),h}function HY(n,e,t,r,i,o,c){if(ob(i,t)!=null)return e;const u=e.serverCache.isFiltered(),h=e.serverCache;if(r.value!=null){if(Pt(t)&&h.isFullyInitialized()||h.isCompleteForPath(t))return lb(n,e,t,h.getNode().getChild(t),i,o,u,c);if(Pt(t)){let m=new xn(null);return h.getNode().forEachChild(Oa,(p,b)=>{m=m.set(new nn(p),b)}),L1(n,e,t,m,i,o,u,c)}else return e}else{let m=new xn(null);return r.foreach((p,b)=>{const v=kn(t,p);h.isCompleteForPath(v)&&(m=m.set(p,h.getNode().getChild(v)))}),L1(n,e,t,m,i,o,u,c)}}function GY(n,e,t,r,i){const o=e.serverCache,c=v6(e,o.getNode(),o.isFullyInitialized()||Pt(t),o.isFiltered());return T6(n,c,t,r,E6,i)}function WY(n,e,t,r,i,o){let c;if(ob(r,t)!=null)return e;{const u=new Sj(r,e,i),h=e.eventCache.getNode();let m;if(Pt(t)||Dt(t)===".priority"){let p;if(e.serverCache.isFullyInitialized())p=ab(r,jd(e));else{const b=e.serverCache.getNode();qe(b instanceof bt,"serverChildren would be complete if leaf node"),p=Nj(r,b)}p=p,m=n.filter.updateFullNode(h,p,o)}else{const p=Dt(t);let b=jj(r,p,e.serverCache);b==null&&e.serverCache.isCompleteForChild(p)&&(b=h.getImmediateChild(p)),b!=null?m=n.filter.updateChild(h,p,b,pn(t),u,o):e.eventCache.getNode().hasChild(p)?m=n.filter.updateChild(h,p,bt.EMPTY_NODE,pn(t),u,o):m=h,m.isEmpty()&&e.serverCache.isFullyInitialized()&&(c=ab(r,jd(e)),c.isLeafNode()&&(m=n.filter.updateFullNode(m,c,o)))}return c=e.serverCache.isFullyInitialized()||ob(r,Qt())!=null,$m(e,m,c,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KY{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new yj(r.getIndex()),o=lY(r);this.processor_=UY(o);const c=t.serverCache,u=t.eventCache,h=i.updateFullNode(bt.EMPTY_NODE,c.getNode(),null),m=o.updateFullNode(bt.EMPTY_NODE,u.getNode(),null),p=new Kl(h,c.isFullyInitialized(),i.filtersNodes()),b=new Kl(m,u.isFullyInitialized(),o.filtersNodes());this.viewCache_=uy(b,p),this.eventGenerator_=new yY(this.query_)}get query(){return this.query_}}function QY(n){return n.viewCache_.serverCache.getNode()}function YY(n){return ib(n.viewCache_)}function XY(n,e){const t=jd(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Pt(e)&&!t.getImmediateChild(Dt(e)).isEmpty())?t.getChild(e):null}function MA(n){return n.eventRegistrations_.length===0}function JY(n,e){n.eventRegistrations_.push(e)}function LA(n,e,t){const r=[];if(t){qe(e==null,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(o=>{const c=o.createCancelEvent(t,i);c&&r.push(c)})}if(e){let i=[];for(let o=0;o<n.eventRegistrations_.length;++o){const c=n.eventRegistrations_[o];if(!c.matches(e))i.push(c);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function VA(n,e,t,r){e.type===$i.MERGE&&e.source.queryId!==null&&(qe(jd(n.viewCache_),"We should always have a full cache before handling merges"),qe(ib(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,o=zY(n.processor_,i,e,t,r);return BY(n.processor_,o.viewCache),qe(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,I6(n,o.changes,o.viewCache.eventCache.getNode(),null)}function ZY(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(yn,(o,c)=>{r.push(Eh(o,c))}),t.isFullyInitialized()&&r.push(y6(t.getNode())),I6(n,r,t.getNode(),e)}function I6(n,e,t,r){const i=r?[r]:n.eventRegistrations_;return vY(n.eventGenerator_,e,t,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cb;class C6{constructor(){this.views=new Map}}function eX(n){qe(!cb,"__referenceConstructor has already been defined"),cb=n}function tX(){return qe(cb,"Reference.ts has not been loaded"),cb}function nX(n){return n.views.size===0}function Ej(n,e,t,r){const i=e.source.queryId;if(i!==null){const o=n.views.get(i);return qe(o!=null,"SyncTree gave us an op for an invalid query."),VA(o,e,t,r)}else{let o=[];for(const c of n.views.values())o=o.concat(VA(c,e,t,r));return o}}function A6(n,e,t,r,i){const o=e._queryIdentifier,c=n.views.get(o);if(!c){let u=ab(t,i?r:null),h=!1;u?h=!0:r instanceof bt?(u=Nj(t,r),h=!1):(u=bt.EMPTY_NODE,h=!1);const m=uy(new Kl(u,h,!1),new Kl(r,i,!1));return new KY(e,m)}return c}function sX(n,e,t,r,i,o){const c=A6(n,e,r,i,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,c),JY(c,t),ZY(c,t)}function rX(n,e,t,r){const i=e._queryIdentifier,o=[];let c=[];const u=Ql(n);if(i==="default")for(const[h,m]of n.views.entries())c=c.concat(LA(m,t,r)),MA(m)&&(n.views.delete(h),m.query._queryParams.loadsAllData()||o.push(m.query));else{const h=n.views.get(i);h&&(c=c.concat(LA(h,t,r)),MA(h)&&(n.views.delete(i),h.query._queryParams.loadsAllData()||o.push(h.query)))}return u&&!Ql(n)&&o.push(new(tX())(e._repo,e._path)),{removed:o,events:c}}function k6(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Pl(n,e){let t=null;for(const r of n.views.values())t=t||XY(r,e);return t}function R6(n,e){if(e._queryParams.loadsAllData())return fy(n);{const r=e._queryIdentifier;return n.views.get(r)}}function D6(n,e){return R6(n,e)!=null}function Ql(n){return fy(n)!=null}function fy(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let db;function iX(n){qe(!db,"__referenceConstructor has already been defined"),db=n}function aX(){return qe(db,"Reference.ts has not been loaded"),db}let oX=1;class FA{constructor(e){this.listenProvider_=e,this.syncPointTree_=new xn(null),this.pendingWriteTree_=MY(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Tj(n,e,t,r,i){return jY(n.pendingWriteTree_,e,t,r,i),i?Yh(n,new Nd(vj(),e,t)):[]}function lX(n,e,t,r){SY(n.pendingWriteTree_,e,t,r);const i=xn.fromObject(t);return Yh(n,new Th(vj(),e,i))}function El(n,e,t=!1){const r=EY(n.pendingWriteTree_,e);if(TY(n.pendingWriteTree_,e)){let o=new xn(null);return r.snap!=null?o=o.set(Qt(),!0):As(r.children,c=>{o=o.set(new nn(c),!0)}),Yh(n,new rb(r.path,o,t))}else return[]}function n0(n,e,t){return Yh(n,new Nd(wj(),e,t))}function cX(n,e,t){const r=xn.fromObject(t);return Yh(n,new Th(wj(),e,r))}function dX(n,e){return Yh(n,new jg(wj(),e))}function uX(n,e,t){const r=Ij(n,t);if(r){const i=Cj(r),o=i.path,c=i.queryId,u=or(o,e),h=new jg(_j(c),u);return Aj(n,o,h)}else return[]}function ub(n,e,t,r,i=!1){const o=e._path,c=n.syncPointTree_.get(o);let u=[];if(c&&(e._queryIdentifier==="default"||D6(c,e))){const h=rX(c,e,t,r);nX(c)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const m=h.removed;if(u=h.events,!i){const p=m.findIndex(v=>v._queryParams.loadsAllData())!==-1,b=n.syncPointTree_.findOnPath(o,(v,_)=>Ql(_));if(p&&!b){const v=n.syncPointTree_.subtree(o);if(!v.isEmpty()){const _=mX(v);for(let T=0;T<_.length;++T){const k=_[T],E=k.query,S=L6(n,k);n.listenProvider_.startListening(Hm(E),Sg(n,E),S.hashFn,S.onComplete)}}}!b&&m.length>0&&!r&&(p?n.listenProvider_.stopListening(Hm(e),null):m.forEach(v=>{const _=n.queryToTagMap.get(gy(v));n.listenProvider_.stopListening(Hm(v),_)}))}gX(n,m)}return u}function P6(n,e,t,r){const i=Ij(n,r);if(i!=null){const o=Cj(i),c=o.path,u=o.queryId,h=or(c,e),m=new Nd(_j(u),h,t);return Aj(n,c,m)}else return[]}function hX(n,e,t,r){const i=Ij(n,r);if(i){const o=Cj(i),c=o.path,u=o.queryId,h=or(c,e),m=xn.fromObject(t),p=new Th(_j(u),h,m);return Aj(n,c,p)}else return[]}function V1(n,e,t,r=!1){const i=e._path;let o=null,c=!1;n.syncPointTree_.foreachOnPath(i,(v,_)=>{const T=or(v,i);o=o||Pl(_,T),c=c||Ql(_)});let u=n.syncPointTree_.get(i);u?(c=c||Ql(u),o=o||Pl(u,Qt())):(u=new C6,n.syncPointTree_=n.syncPointTree_.set(i,u));let h;o!=null?h=!0:(h=!1,o=bt.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((_,T)=>{const k=Pl(T,Qt());k&&(o=o.updateImmediateChild(_,k))}));const m=D6(u,e);if(!m&&!e._queryParams.loadsAllData()){const v=gy(e);qe(!n.queryToTagMap.has(v),"View does not exist, but we have a tag");const _=pX();n.queryToTagMap.set(v,_),n.tagToQueryMap.set(_,v)}const p=hy(n.pendingWriteTree_,i);let b=sX(u,e,t,p,o,h);if(!m&&!c&&!r){const v=R6(u,e);b=b.concat(xX(n,e,v))}return b}function my(n,e,t){const i=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(c,u)=>{const h=or(c,e),m=Pl(u,h);if(m)return m});return N6(i,e,o,t,!0)}function fX(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(m,p)=>{const b=or(m,t);r=r||Pl(p,b)});let i=n.syncPointTree_.get(t);i?r=r||Pl(i,Qt()):(i=new C6,n.syncPointTree_=n.syncPointTree_.set(t,i));const o=r!=null,c=o?new Kl(r,!0,!1):null,u=hy(n.pendingWriteTree_,e._path),h=A6(i,e,u,o?c.getNode():bt.EMPTY_NODE,o);return YY(h)}function Yh(n,e){return O6(e,n.syncPointTree_,null,hy(n.pendingWriteTree_,Qt()))}function O6(n,e,t,r){if(Pt(n.path))return M6(n,e,t,r);{const i=e.get(Qt());t==null&&i!=null&&(t=Pl(i,Qt()));let o=[];const c=Dt(n.path),u=n.operationForChild(c),h=e.children.get(c);if(h&&u){const m=t?t.getImmediateChild(c):null,p=j6(r,c);o=o.concat(O6(u,h,m,p))}return i&&(o=o.concat(Ej(i,n,r,t))),o}}function M6(n,e,t,r){const i=e.get(Qt());t==null&&i!=null&&(t=Pl(i,Qt()));let o=[];return e.children.inorderTraversal((c,u)=>{const h=t?t.getImmediateChild(c):null,m=j6(r,c),p=n.operationForChild(c);p&&(o=o.concat(M6(p,u,h,m)))}),i&&(o=o.concat(Ej(i,n,r,t))),o}function L6(n,e){const t=e.query,r=Sg(n,t);return{hashFn:()=>(QY(e)||bt.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?uX(n,t._path,r):dX(n,t._path);{const o=lQ(i,t);return ub(n,t,null,o)}}}}function Sg(n,e){const t=gy(e);return n.queryToTagMap.get(t)}function gy(n){return n._path.toString()+"$"+n._queryIdentifier}function Ij(n,e){return n.tagToQueryMap.get(e)}function Cj(n){const e=n.indexOf("$");return qe(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new nn(n.substr(0,e))}}function Aj(n,e,t){const r=n.syncPointTree_.get(e);qe(r,"Missing sync point for query tag that we're tracking");const i=hy(n.pendingWriteTree_,e);return Ej(r,t,i,null)}function mX(n){return n.fold((e,t,r)=>{if(t&&Ql(t))return[fy(t)];{let i=[];return t&&(i=k6(t)),As(r,(o,c)=>{i=i.concat(c)}),i}})}function Hm(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(aX())(n._repo,n._path):n}function gX(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=gy(r),o=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(o)}}}function pX(){return oX++}function xX(n,e,t){const r=e._path,i=Sg(n,e),o=L6(n,t),c=n.listenProvider_.startListening(Hm(e),i,o.hashFn,o.onComplete),u=n.syncPointTree_.subtree(r);if(i)qe(!Ql(u.value),"If we're adding a query, it shouldn't be shadowed");else{const h=u.fold((m,p,b)=>{if(!Pt(m)&&p&&Ql(p))return[fy(p).query];{let v=[];return p&&(v=v.concat(k6(p).map(_=>_.query))),As(b,(_,T)=>{v=v.concat(T)}),v}});for(let m=0;m<h.length;++m){const p=h[m];n.listenProvider_.stopListening(Hm(p),Sg(n,p))}}return c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new kj(t)}node(){return this.node_}}class Rj{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=kn(this.path_,e);return new Rj(this.syncTree_,t)}node(){return my(this.syncTree_,this.path_)}}const bX=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},UA=function(n,e,t){if(!n||typeof n!="object")return n;if(qe(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return yX(n[".sv"],e,t);if(typeof n[".sv"]=="object")return vX(n[".sv"],e);qe(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},yX=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:qe(!1,"Unexpected server value: "+n)}},vX=function(n,e,t){n.hasOwnProperty("increment")||qe(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;typeof r!="number"&&qe(!1,"Unexpected increment value: "+r);const i=e.node();if(qe(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const c=i.getValue();return typeof c!="number"?r:c+r},V6=function(n,e,t,r){return Pj(e,new Rj(t,n),r)},Dj=function(n,e,t){return Pj(n,new kj(e),t)};function Pj(n,e,t){const r=n.getPriority().val(),i=UA(r,e.getImmediateChild(".priority"),t);let o;if(n.isLeafNode()){const c=n,u=UA(c.getValue(),e,t);return u!==c.getValue()||i!==c.getPriority().val()?new Ns(u,On(i)):n}else{const c=n;return o=c,i!==c.getPriority().val()&&(o=o.updatePriority(new Ns(i))),c.forEachChild(yn,(u,h)=>{const m=Pj(h,e.getImmediateChild(u),t);m!==h&&(o=o.updateImmediateChild(u,m))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function py(n,e){let t=e instanceof nn?e:new nn(e),r=n,i=Dt(t);for(;i!==null;){const o=rd(r.node.children,i)||{children:{},childCount:0};r=new Oj(i,r,o),t=pn(t),i=Dt(t)}return r}function Od(n){return n.node.value}function Mj(n,e){n.node.value=e,F1(n)}function F6(n){return n.node.childCount>0}function wX(n){return Od(n)===void 0&&!F6(n)}function xy(n,e){As(n.node.children,(t,r)=>{e(new Oj(t,n,r))})}function U6(n,e,t,r){t&&e(n),xy(n,i=>{U6(i,e,!0)})}function _X(n,e,t){let r=n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function s0(n){return new nn(n.parent===null?n.name:s0(n.parent)+"/"+n.name)}function F1(n){n.parent!==null&&NX(n.parent,n.name,n)}function NX(n,e,t){const r=wX(t),i=Yr(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,F1(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,F1(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jX=/[\[\].#$\/\u0000-\u001F\u007F]/,SX=/[\[\].#$\u0000-\u001F\u007F]/,g_=10*1024*1024,by=function(n){return typeof n=="string"&&n.length!==0&&!jX.test(n)},B6=function(n){return typeof n=="string"&&n.length!==0&&!SX.test(n)},EX=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),B6(n)},Eg=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!oy(n)||n&&typeof n=="object"&&Yr(n,".sv")},Ua=function(n,e,t,r){r&&e===void 0||r0(Cr(n,"value"),e,t)},r0=function(n,e,t){const r=t instanceof nn?new zQ(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Vc(r));if(typeof e=="function")throw new Error(n+"contains a function "+Vc(r)+" with contents = "+e.toString());if(oy(e))throw new Error(n+"contains "+e.toString()+" "+Vc(r));if(typeof e=="string"&&e.length>g_/3&&yb(e)>g_)throw new Error(n+"contains a string greater than "+g_+" utf8 bytes "+Vc(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,o=!1;if(As(e,(c,u)=>{if(c===".value")i=!0;else if(c!==".priority"&&c!==".sv"&&(o=!0,!by(c)))throw new Error(n+" contains an invalid key ("+c+") "+Vc(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);$Q(r,c),r0(n,u,r),qQ(r)}),i&&o)throw new Error(n+' contains ".value" child '+Vc(r)+" in addition to actual children.")}},TX=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const o=vg(r);for(let c=0;c<o.length;c++)if(!(o[c]===".priority"&&c===o.length-1)){if(!by(o[c]))throw new Error(n+"contains an invalid key ("+o[c]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(BQ);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&yi(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},z6=function(n,e,t,r){const i=Cr(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const o=[];As(e,(c,u)=>{const h=new nn(c);if(r0(i,u,kn(t,h)),fj(h)===".priority"&&!Eg(u))throw new Error(i+"contains an invalid value for '"+h.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(h)}),TX(i,o)},Lj=function(n,e,t){if(oy(e))throw new Error(Cr(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Eg(e))throw new Error(Cr(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},i0=function(n,e,t,r){if(t!==void 0&&!by(t))throw new Error(Cr(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Tg=function(n,e,t,r){if(!B6(t))throw new Error(Cr(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},IX=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Tg(n,e,t)},vi=function(n,e){if(Dt(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},$6=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!by(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!EX(t))throw new Error(Cr(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CX{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function yy(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],o=i.getPath();t!==null&&!mj(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(i)}t&&n.eventLists_.push(t)}function q6(n,e,t){yy(n,t),H6(n,r=>mj(r,e))}function Jr(n,e,t){yy(n,t),H6(n,r=>yi(r,e)||yi(e,r))}function H6(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];if(i){const o=i.path;e(o)?(AX(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function AX(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const r=t.getEventRunner();td&&Is("event: "+t.toString()),Kh(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G6="repo_interrupt",kX=25;class RX{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new CX,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=sb(),this.transactionQueueTree_=new Oj,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function DX(n,e,t){if(n.stats_=uj(n.repoInfo_),n.forceRestClient_||hQ())n.server_=new nb(n.repoInfo_,(r,i,o,c)=>{BA(n,r,i,o,c)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>zA(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{gs(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new wo(n.repoInfo_,e,(r,i,o,c)=>{BA(n,r,i,o,c)},r=>{zA(n,r)},r=>{PX(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=xQ(n.repoInfo_,()=>new bY(n.stats_,n.server_)),n.infoData_=new fY,n.infoSyncTree_=new FA({startListening:(r,i,o,c)=>{let u=[];const h=n.infoData_.getNode(r._path);return h.isEmpty()||(u=n0(n.infoSyncTree_,r._path,h),setTimeout(()=>{c("ok")},0)),u},stopListening:()=>{}}),Vj(n,"connected",!1),n.serverSyncTree_=new FA({startListening:(r,i,o,c)=>(n.server_.listen(r,o,i,(u,h)=>{const m=c(u,h);Jr(n.eventQueue_,r._path,m)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function W6(n){const t=n.infoData_.getNode(new nn(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function a0(n){return bX({timestamp:W6(n)})}function BA(n,e,t,r,i){n.dataUpdateCount++;const o=new nn(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let c=[];if(i)if(r){const h=jx(t,m=>On(m));c=hX(n.serverSyncTree_,o,h,i)}else{const h=On(t);c=P6(n.serverSyncTree_,o,h,i)}else if(r){const h=jx(t,m=>On(m));c=cX(n.serverSyncTree_,o,h)}else{const h=On(t);c=n0(n.serverSyncTree_,o,h)}let u=o;c.length>0&&(u=Ch(n,o)),Jr(n.eventQueue_,u,c)}function zA(n,e){Vj(n,"connected",e),e===!1&&LX(n)}function PX(n,e){As(e,(t,r)=>{Vj(n,t,r)})}function Vj(n,e,t){const r=new nn("/.info/"+e),i=On(t);n.infoData_.updateSnapshot(r,i);const o=n0(n.infoSyncTree_,r,i);Jr(n.eventQueue_,r,o)}function vy(n){return n.nextWriteId_++}function OX(n,e,t){const r=fX(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{const o=On(i).withIndex(e._queryParams.getIndex());V1(n.serverSyncTree_,e,t,!0);let c;if(e._queryParams.loadsAllData())c=n0(n.serverSyncTree_,e._path,o);else{const u=Sg(n.serverSyncTree_,e);c=P6(n.serverSyncTree_,e._path,o,u)}return Jr(n.eventQueue_,e._path,c),ub(n.serverSyncTree_,e,t,null,!0),o},i=>(Xh(n,"get for query "+gs(e)+" failed: "+i),Promise.reject(new Error(i))))}function Fj(n,e,t,r,i){Xh(n,"set",{path:e.toString(),value:t,priority:r});const o=a0(n),c=On(t,r),u=my(n.serverSyncTree_,e),h=Dj(c,u,o),m=vy(n),p=Tj(n.serverSyncTree_,e,h,m,!0);yy(n.eventQueue_,p),n.server_.put(e.toString(),c.val(!0),(v,_)=>{const T=v==="ok";T||Xs("set at "+e+" failed: "+v);const k=El(n.serverSyncTree_,m,!T);Jr(n.eventQueue_,e,k),Yl(n,i,v,_)});const b=Bj(n,e);Ch(n,b),Jr(n.eventQueue_,b,[])}function MX(n,e,t,r){Xh(n,"update",{path:e.toString(),value:t});let i=!0;const o=a0(n),c={};if(As(t,(u,h)=>{i=!1,c[u]=V6(kn(e,u),On(h),n.serverSyncTree_,o)}),i)Is("update() called with empty data.  Don't do anything."),Yl(n,r,"ok",void 0);else{const u=vy(n),h=lX(n.serverSyncTree_,e,c,u);yy(n.eventQueue_,h),n.server_.merge(e.toString(),t,(m,p)=>{const b=m==="ok";b||Xs("update at "+e+" failed: "+m);const v=El(n.serverSyncTree_,u,!b),_=v.length>0?Ch(n,e):e;Jr(n.eventQueue_,_,v),Yl(n,r,m,p)}),As(t,m=>{const p=Bj(n,kn(e,m));Ch(n,p)}),Jr(n.eventQueue_,e,[])}}function LX(n){Xh(n,"onDisconnectEvents");const e=a0(n),t=sb();R1(n.onDisconnect_,Qt(),(i,o)=>{const c=V6(i,o,n.serverSyncTree_,e);Qh(t,i,c)});let r=[];R1(t,Qt(),(i,o)=>{r=r.concat(n0(n.serverSyncTree_,i,o));const c=Bj(n,i);Ch(n,c)}),n.onDisconnect_=sb(),Jr(n.eventQueue_,Qt(),r)}function VX(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&k1(n.onDisconnect_,e),Yl(n,t,r,i)})}function $A(n,e,t,r){const i=On(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(o,c)=>{o==="ok"&&Qh(n.onDisconnect_,e,i),Yl(n,r,o,c)})}function FX(n,e,t,r,i){const o=On(t,r);n.server_.onDisconnectPut(e.toString(),o.val(!0),(c,u)=>{c==="ok"&&Qh(n.onDisconnect_,e,o),Yl(n,i,c,u)})}function UX(n,e,t,r){if(Nx(t)){Is("onDisconnect().update() called with empty data.  Don't do anything."),Yl(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,o)=>{i==="ok"&&As(t,(c,u)=>{const h=On(u);Qh(n.onDisconnect_,kn(e,c),h)}),Yl(n,r,i,o)})}function BX(n,e,t){let r;Dt(e._path)===".info"?r=V1(n.infoSyncTree_,e,t):r=V1(n.serverSyncTree_,e,t),q6(n.eventQueue_,e._path,r)}function U1(n,e,t){let r;Dt(e._path)===".info"?r=ub(n.infoSyncTree_,e,t):r=ub(n.serverSyncTree_,e,t),q6(n.eventQueue_,e._path,r)}function K6(n){n.persistentConnection_&&n.persistentConnection_.interrupt(G6)}function zX(n){n.persistentConnection_&&n.persistentConnection_.resume(G6)}function Xh(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Is(t,...e)}function Yl(n,e,t,r){e&&Kh(()=>{if(t==="ok")e(null);else{const i=(t||"error").toUpperCase();let o=i;r&&(o+=": "+r);const c=new Error(o);c.code=i,e(c)}})}function $X(n,e,t,r,i,o){Xh(n,"transaction on "+e);const c={path:e,update:t,onComplete:r,status:null,order:$P(),applyLocally:o,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=Uj(n,e,void 0);c.currentInputSnapshot=u;const h=c.update(u.val());if(h===void 0)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{r0("transaction failed: Data returned ",h,c.path),c.status=0;const m=py(n.transactionQueueTree_,e),p=Od(m)||[];p.push(c),Mj(m,p);let b;typeof h=="object"&&h!==null&&Yr(h,".priority")?(b=rd(h,".priority"),qe(Eg(b),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):b=(my(n.serverSyncTree_,e)||bt.EMPTY_NODE).getPriority().val();const v=a0(n),_=On(h,b),T=Dj(_,u,v);c.currentOutputSnapshotRaw=_,c.currentOutputSnapshotResolved=T,c.currentWriteId=vy(n);const k=Tj(n.serverSyncTree_,e,T,c.currentWriteId,c.applyLocally);Jr(n.eventQueue_,e,k),wy(n,n.transactionQueueTree_)}}function Uj(n,e,t){return my(n.serverSyncTree_,e,t)||bt.EMPTY_NODE}function wy(n,e=n.transactionQueueTree_){if(e||_y(n,e),Od(e)){const t=Y6(n,e);qe(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&qX(n,s0(e),t)}else F6(e)&&xy(e,t=>{wy(n,t)})}function qX(n,e,t){const r=t.map(m=>m.currentWriteId),i=Uj(n,e,r);let o=i;const c=i.hash();for(let m=0;m<t.length;m++){const p=t[m];qe(p.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),p.status=1,p.retryCount++;const b=or(e,p.path);o=o.updateChild(b,p.currentOutputSnapshotRaw)}const u=o.val(!0),h=e;n.server_.put(h.toString(),u,m=>{Xh(n,"transaction put response",{path:h.toString(),status:m});let p=[];if(m==="ok"){const b=[];for(let v=0;v<t.length;v++)t[v].status=2,p=p.concat(El(n.serverSyncTree_,t[v].currentWriteId)),t[v].onComplete&&b.push(()=>t[v].onComplete(null,!0,t[v].currentOutputSnapshotResolved)),t[v].unwatcher();_y(n,py(n.transactionQueueTree_,e)),wy(n,n.transactionQueueTree_),Jr(n.eventQueue_,e,p);for(let v=0;v<b.length;v++)Kh(b[v])}else{if(m==="datastale")for(let b=0;b<t.length;b++)t[b].status===3?t[b].status=4:t[b].status=0;else{Xs("transaction at "+h.toString()+" failed: "+m);for(let b=0;b<t.length;b++)t[b].status=4,t[b].abortReason=m}Ch(n,e)}},c)}function Ch(n,e){const t=Q6(n,e),r=s0(t),i=Y6(n,t);return HX(n,i,r),r}function HX(n,e,t){if(e.length===0)return;const r=[];let i=[];const c=e.filter(u=>u.status===0).map(u=>u.currentWriteId);for(let u=0;u<e.length;u++){const h=e[u],m=or(t,h.path);let p=!1,b;if(qe(m!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),h.status===4)p=!0,b=h.abortReason,i=i.concat(El(n.serverSyncTree_,h.currentWriteId,!0));else if(h.status===0)if(h.retryCount>=kX)p=!0,b="maxretry",i=i.concat(El(n.serverSyncTree_,h.currentWriteId,!0));else{const v=Uj(n,h.path,c);h.currentInputSnapshot=v;const _=e[u].update(v.val());if(_!==void 0){r0("transaction failed: Data returned ",_,h.path);let T=On(_);typeof _=="object"&&_!=null&&Yr(_,".priority")||(T=T.updatePriority(v.getPriority()));const E=h.currentWriteId,S=a0(n),L=Dj(T,v,S);h.currentOutputSnapshotRaw=T,h.currentOutputSnapshotResolved=L,h.currentWriteId=vy(n),c.splice(c.indexOf(E),1),i=i.concat(Tj(n.serverSyncTree_,h.path,L,h.currentWriteId,h.applyLocally)),i=i.concat(El(n.serverSyncTree_,E,!0))}else p=!0,b="nodata",i=i.concat(El(n.serverSyncTree_,h.currentWriteId,!0))}Jr(n.eventQueue_,t,i),i=[],p&&(e[u].status=2,(function(v){setTimeout(v,Math.floor(0))})(e[u].unwatcher),e[u].onComplete&&(b==="nodata"?r.push(()=>e[u].onComplete(null,!1,e[u].currentInputSnapshot)):r.push(()=>e[u].onComplete(new Error(b),!1,null))))}_y(n,n.transactionQueueTree_);for(let u=0;u<r.length;u++)Kh(r[u]);wy(n,n.transactionQueueTree_)}function Q6(n,e){let t,r=n.transactionQueueTree_;for(t=Dt(e);t!==null&&Od(r)===void 0;)r=py(r,t),e=pn(e),t=Dt(e);return r}function Y6(n,e){const t=[];return X6(n,e,t),t.sort((r,i)=>r.order-i.order),t}function X6(n,e,t){const r=Od(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);xy(e,i=>{X6(n,i,t)})}function _y(n,e){const t=Od(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,Mj(e,t.length>0?t:void 0)}xy(e,r=>{_y(n,r)})}function Bj(n,e){const t=s0(Q6(n,e)),r=py(n.transactionQueueTree_,e);return _X(r,i=>{p_(n,i)}),p_(n,r),U6(r,i=>{p_(n,i)}),t}function p_(n,e){const t=Od(e);if(t){const r=[];let i=[],o=-1;for(let c=0;c<t.length;c++)t[c].status===3||(t[c].status===1?(qe(o===c-1,"All SENT items should be at beginning of queue."),o=c,t[c].status=3,t[c].abortReason="set"):(qe(t[c].status===0,"Unexpected transaction status in abort"),t[c].unwatcher(),i=i.concat(El(n.serverSyncTree_,t[c].currentWriteId,!0)),t[c].onComplete&&r.push(t[c].onComplete.bind(null,new Error("set"),!1,null))));o===-1?Mj(e,void 0):t.length=o+1,Jr(n.eventQueue_,s0(e),i);for(let c=0;c<r.length;c++)Kh(r[c])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GX(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function WX(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Xs(`Invalid query segment '${t}' in query '${n}'`)}return e}const B1=function(n,e){const t=KX(n),r=t.namespace;t.domain==="firebase.com"&&Fa(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&Fa("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||sQ();const i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new s6(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new nn(t.pathString)}},KX=function(n){let e="",t="",r="",i="",o="",c=!0,u="https",h=443;if(typeof n=="string"){let m=n.indexOf("//");m>=0&&(u=n.substring(0,m-1),n=n.substring(m+2));let p=n.indexOf("/");p===-1&&(p=n.length);let b=n.indexOf("?");b===-1&&(b=n.length),e=n.substring(0,Math.min(p,b)),p<b&&(i=GX(n.substring(p,b)));const v=WX(n.substring(Math.min(n.length,b)));m=e.indexOf(":"),m>=0?(c=u==="https"||u==="wss",h=parseInt(e.substring(m+1),10)):m=e.length;const _=e.slice(0,m);if(_.toLowerCase()==="localhost")t="localhost";else if(_.split(".").length<=2)t=_;else{const T=e.indexOf(".");r=e.substring(0,T).toLowerCase(),t=e.substring(T+1),o=r}"ns"in v&&(o=v.ns)}return{host:e,port:h,domain:t,subdomain:r,secure:c,scheme:u,pathString:i,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qA="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",QX=(function(){let n=0;const e=[];return function(t){const r=t===n;n=t;let i;const o=new Array(8);for(i=7;i>=0;i--)o[i]=qA.charAt(t%64),t=Math.floor(t/64);qe(t===0,"Cannot push at time == 0");let c=o.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)c+=qA.charAt(e[i]);return qe(c.length===20,"nextPushId: Length should be 20."),c}})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J6{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+gs(this.snapshot.exportVal())}}class Z6{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zj{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return qe(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let YX=class{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new Nr;return VX(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){vi("OnDisconnect.remove",this._path);const e=new Nr;return $A(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){vi("OnDisconnect.set",this._path),Ua("OnDisconnect.set",e,this._path,!1);const t=new Nr;return $A(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){vi("OnDisconnect.setWithPriority",this._path),Ua("OnDisconnect.setWithPriority",e,this._path,!1),Lj("OnDisconnect.setWithPriority",t);const r=new Nr;return FX(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){vi("OnDisconnect.update",this._path),z6("OnDisconnect.update",e,this._path);const t=new Nr;return UX(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Pt(this._path)?null:fj(this._path)}get ref(){return new Ti(this._repo,this._path)}get _queryIdentifier(){const e=CA(this._queryParams),t=cj(e);return t==="{}"?"default":t}get _queryObject(){return CA(this._queryParams)}isEqual(e){if(e=Xe(e),!(e instanceof Dr))return!1;const t=this._repo===e._repo,r=mj(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+UQ(this._path)}}function Ny(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function ac(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===Oa){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Gl)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==To)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===yn){if(e!=null&&!Eg(e)||t!=null&&!Eg(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(qe(n.getIndex()instanceof xj||n.getIndex()===bj,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function jy(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Ti extends Dr{constructor(e,t){super(e,t,new cy,!1)}get parent(){const e=h6(this._path);return e===null?null:new Ti(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}let Sy=class z1{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new nn(e),r=Sd(this.ref,e);return new z1(this._node.getChild(t),r,yn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new z1(i,Sd(this.ref,r),yn)))}hasChild(e){const t=new nn(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function eO(n,e){return n=Xe(n),n._checkNotDeleted("ref"),e!==void 0?Sd(n._root,e):n._root}function HA(n,e){n=Xe(n),n._checkNotDeleted("refFromURL");const t=B1(e,n._repo.repoInfo_.nodeAdmin);$6("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Fa("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),eO(n,t.path.toString())}function Sd(n,e){return n=Xe(n),Dt(n._path)===null?IX("child","path",e):Tg("child","path",e),new Ti(n._repo,kn(n._path,e))}function XX(n,e){n=Xe(n),vi("push",n._path),Ua("push",e,n._path,!0);const t=W6(n._repo),r=QX(t),i=Sd(n,r),o=Sd(n,r);let c;return e!=null?c=$j(o,e).then(()=>o):c=Promise.resolve(o),i.then=c.then.bind(c),i.catch=c.then.bind(c,void 0),i}function JX(n){return vi("remove",n._path),$j(n,null)}function $j(n,e){n=Xe(n),vi("set",n._path),Ua("set",e,n._path,!1);const t=new Nr;return Fj(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function ZX(n,e){n=Xe(n),vi("setPriority",n._path),Lj("setPriority",e);const t=new Nr;return Fj(n._repo,kn(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function eJ(n,e,t){if(vi("setWithPriority",n._path),Ua("setWithPriority",e,n._path,!1),Lj("setWithPriority",t),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new Nr;return Fj(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function tJ(n,e){z6("update",e,n._path);const t=new Nr;return MX(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function nJ(n){n=Xe(n);const e=new zj(()=>{}),t=new o0(e);return OX(n._repo,n,t).then(r=>new Sy(r,new Ti(n._repo,n._path),n._queryParams.getIndex()))}class o0{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const r=t._queryParams.getIndex();return new J6("value",this,new Sy(e.snapshotNode,new Ti(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Z6(this,e,t):null}matches(e){return e instanceof o0?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class Ey{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Z6(this,e,t):null}createEvent(e,t){qe(e.childName!=null,"Child events should have a childName.");const r=Sd(new Ti(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new J6(e.type,this,new Sy(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Ey?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function l0(n,e,t,r,i){let o;if(typeof r=="object"&&(o=void 0,i=r),typeof r=="function"&&(o=r),i&&i.onlyOnce){const h=t,m=(p,b)=>{U1(n._repo,n,u),h(p,b)};m.userCallback=t.userCallback,m.context=t.context,t=m}const c=new zj(t,o||void 0),u=e==="value"?new o0(c):new Ey(e,c);return BX(n._repo,n,u),()=>U1(n._repo,n,u)}function $1(n,e,t,r){return l0(n,"value",e,t,r)}function GA(n,e,t,r){return l0(n,"child_added",e,t,r)}function WA(n,e,t,r){return l0(n,"child_changed",e,t,r)}function KA(n,e,t,r){return l0(n,"child_moved",e,t,r)}function QA(n,e,t,r){return l0(n,"child_removed",e,t,r)}function YA(n,e,t){let r=null;const i=t?new zj(t):null;e==="value"?r=new o0(i):e&&(r=new Ey(e,i)),U1(n._repo,n,r)}class Zi{}class tO extends Zi{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){Ua("endAt",this._value,e._path,!0);const t=A1(e._queryParams,this._value,this._key);if(jy(t),ac(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Dr(e._repo,e._path,t,e._orderByCalled)}}function sJ(n,e){return i0("endAt","key",e),new tO(n,e)}class rJ extends Zi{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){Ua("endBefore",this._value,e._path,!1);const t=hY(e._queryParams,this._value,this._key);if(jy(t),ac(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Dr(e._repo,e._path,t,e._orderByCalled)}}function iJ(n,e){return i0("endBefore","key",e),new rJ(n,e)}class nO extends Zi{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){Ua("startAt",this._value,e._path,!0);const t=C1(e._queryParams,this._value,this._key);if(jy(t),ac(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Dr(e._repo,e._path,t,e._orderByCalled)}}function aJ(n=null,e){return i0("startAt","key",e),new nO(n,e)}class oJ extends Zi{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){Ua("startAfter",this._value,e._path,!1);const t=uY(e._queryParams,this._value,this._key);if(jy(t),ac(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Dr(e._repo,e._path,t,e._orderByCalled)}}function lJ(n,e){return i0("startAfter","key",e),new oJ(n,e)}class cJ extends Zi{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Dr(e._repo,e._path,cY(e._queryParams,this._limit),e._orderByCalled)}}function dJ(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new cJ(n)}class uJ extends Zi{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Dr(e._repo,e._path,dY(e._queryParams,this._limit),e._orderByCalled)}}function hJ(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new uJ(n)}class fJ extends Zi{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Ny(e,"orderByChild");const t=new nn(this._path);if(Pt(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new xj(t),i=dy(e._queryParams,r);return ac(i),new Dr(e._repo,e._path,i,!0)}}function mJ(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Tg("orderByChild","path",n),new fJ(n)}class gJ extends Zi{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Ny(e,"orderByKey");const t=dy(e._queryParams,Oa);return ac(t),new Dr(e._repo,e._path,t,!0)}}function pJ(){return new gJ}class xJ extends Zi{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Ny(e,"orderByPriority");const t=dy(e._queryParams,yn);return ac(t),new Dr(e._repo,e._path,t,!0)}}function bJ(){return new xJ}class yJ extends Zi{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Ny(e,"orderByValue");const t=dy(e._queryParams,bj);return ac(t),new Dr(e._repo,e._path,t,!0)}}function vJ(){return new yJ}class wJ extends Zi{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(Ua("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new tO(this._value,this._key)._apply(new nO(this._value,this._key)._apply(e))}}function _J(n,e){return i0("equalTo","key",e),new wJ(n,e)}function Fi(n,...e){let t=Xe(n);for(const r of e)t=r._apply(t);return t}eX(Ti);iX(Ti);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NJ="FIREBASE_DATABASE_EMULATOR_HOST",q1={};let jJ=!1;function SJ(n,e,t,r){const i=e.lastIndexOf(":"),o=e.substring(0,i),c=Ba(o);n.repoInfo_=new s6(e,c,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,t),r&&(n.authTokenProvider_=r)}function sO(n,e,t,r,i){let o=r||n.options.databaseURL;o===void 0&&(n.options.projectId||Fa("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Is("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let c=B1(o,i),u=c.repoInfo,h,m;typeof process<"u"&&uA&&(m=uA[NJ]),m?(h=!0,o=`http://${m}?ns=${u.namespace}`,c=B1(o,i),u=c.repoInfo):h=!c.repoInfo.secure;const p=i&&h?new Yu(Yu.OWNER):new mQ(n.name,n.options,e);$6("Invalid Firebase Database URL",c),Pt(c.path)||Fa("Database URL must point to the root of a Firebase Database (not including a child path).");const b=TJ(u,n,p,new fQ(n,t));return new IJ(b,n)}function EJ(n,e){const t=q1[e];(!t||t[n.key]!==n)&&Fa(`Database ${e}(${n.repoInfo_}) has already been deleted.`),K6(n),delete t[n.key]}function TJ(n,e,t,r){let i=q1[e.name];i||(i={},q1[e.name]=i);let o=i[n.toURLString()];return o&&Fa("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new RX(n,jJ,t,r),i[n.toURLString()]=o,o}let IJ=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(DX(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ti(this._repo,Qt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(EJ(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Fa("Cannot call "+e+" on a deleted database.")}};function rO(){Sh.IS_TRANSPORT_INITIALIZED&&Xs("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function CJ(){rO(),Sl.forceDisallow()}function AJ(){rO(),pi.forceDisallow(),Sl.forceAllow()}function kJ(n,e,t,r={}){n=Xe(n),n._checkNotDeleted("useEmulator");const i=`${e}:${t}`,o=n._repoInternal;if(n._instanceStarted){if(i===n._repoInternal.repoInfo_.host&&_o(r,o.repoInfo_.emulatorOptions))return;Fa("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let c;if(o.repoInfo_.nodeAdmin)r.mockUserToken&&Fa('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),c=new Yu(Yu.OWNER);else if(r.mockUserToken){const u=typeof r.mockUserToken=="string"?r.mockUserToken:aN(r.mockUserToken,n.app.options.projectId);c=new Yu(u)}Ba(e)&&(gb(e),pb("Database",!0)),SJ(o,i,r,c)}function RJ(n){n=Xe(n),n._checkNotDeleted("goOffline"),K6(n._repo)}function DJ(n){n=Xe(n),n._checkNotDeleted("goOnline"),zX(n._repo)}function PJ(n,e){HP(n,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OJ(n){BP($a),hr(new $n("database",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return sO(r,i,o,t)},"PUBLIC").setMultipleInstances(!0)),ps(hA,fA,n),ps(hA,fA,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MJ={".sv":"timestamp"};function LJ(){return MJ}function VJ(n){return{".sv":{increment:n}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FJ=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function UJ(n,e,t){if(n=Xe(n),vi("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";const r=(t==null?void 0:t.applyLocally)??!0,i=new Nr,o=(u,h,m)=>{let p=null;u?i.reject(u):(p=new Sy(m,new Ti(n._repo,n._path),yn),i.resolve(new FJ(h,p)))},c=$1(n,()=>{});return $X(n._repo,n._path,e,o,c,r),i.promise}wo.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};wo.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};OJ();const BJ="@firebase/database-compat",zJ="2.1.0";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $J=new Ph("@firebase/database-compat"),iO=function(n){const e="FIREBASE WARNING: "+n;$J.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qJ=function(n,e,t,r){if(t!==void 0&&typeof t!="boolean")throw new Error(Cr(n,e)+"must be a boolean.")},HJ=function(n,e,t){if(e!==void 0)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Cr(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GJ{constructor(e){this._delegate=e}cancel(e){vt("OnDisconnect.cancel",0,1,arguments.length),Ss("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){vt("OnDisconnect.remove",0,1,arguments.length),Ss("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){vt("OnDisconnect.set",1,2,arguments.length),Ss("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){vt("OnDisconnect.setWithPriority",2,3,arguments.length),Ss("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),o=>r(o)),i}update(e,t){if(vt("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let o=0;o<e.length;++o)i[""+o]=e[o];e=i,iO("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ss("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WJ{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return vt("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(e,t){this._database=e,this._delegate=t}val(){return vt("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return vt("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return vt("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return vt("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return vt("DataSnapshot.child",0,1,arguments.length),e=String(e),Tg("DataSnapshot.child","path",e),new Ol(this._database,this._delegate.child(e))}hasChild(e){return vt("DataSnapshot.hasChild",1,1,arguments.length),Tg("DataSnapshot.hasChild","path",e),this._delegate.hasChild(e)}getPriority(){return vt("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return vt("DataSnapshot.forEach",1,1,arguments.length),Ss("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new Ol(this._database,t)))}hasChildren(){return vt("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return vt("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return vt("DataSnapshot.ref",0,0,arguments.length),new Gr(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Vs{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var h;vt("Query.on",2,4,arguments.length),Ss("Query.on","callback",t,!1);const o=Vs.getCancelAndContextArgs_("Query.on",r,i),c=(m,p)=>{t.call(o.context,new Ol(this.database,m),p)};c.userCallback=t,c.context=o.context;const u=(h=o.cancel)==null?void 0:h.bind(o.context);switch(e){case"value":return $1(this._delegate,c,u),t;case"child_added":return GA(this._delegate,c,u),t;case"child_removed":return QA(this._delegate,c,u),t;case"child_changed":return WA(this._delegate,c,u),t;case"child_moved":return KA(this._delegate,c,u),t;default:throw new Error(Cr("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(vt("Query.off",0,3,arguments.length),HJ("Query.off",e),Ss("Query.off","callback",t,!0),OT("Query.off","context",r),t){const i=()=>{};i.userCallback=t,i.context=r,YA(this._delegate,e,i)}else YA(this._delegate,e)}get(){return nJ(this._delegate).then(e=>new Ol(this.database,e))}once(e,t,r,i){vt("Query.once",1,4,arguments.length),Ss("Query.once","callback",t,!0);const o=Vs.getCancelAndContextArgs_("Query.once",r,i),c=new Nr,u=(m,p)=>{const b=new Ol(this.database,m);t&&t.call(o.context,b,p),c.resolve(b)};u.userCallback=t,u.context=o.context;const h=m=>{o.cancel&&o.cancel.call(o.context,m),c.reject(m)};switch(e){case"value":$1(this._delegate,u,h,{onlyOnce:!0});break;case"child_added":GA(this._delegate,u,h,{onlyOnce:!0});break;case"child_removed":QA(this._delegate,u,h,{onlyOnce:!0});break;case"child_changed":WA(this._delegate,u,h,{onlyOnce:!0});break;case"child_moved":KA(this._delegate,u,h,{onlyOnce:!0});break;default:throw new Error(Cr("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return c.promise}limitToFirst(e){return vt("Query.limitToFirst",1,1,arguments.length),new Vs(this.database,Fi(this._delegate,dJ(e)))}limitToLast(e){return vt("Query.limitToLast",1,1,arguments.length),new Vs(this.database,Fi(this._delegate,hJ(e)))}orderByChild(e){return vt("Query.orderByChild",1,1,arguments.length),new Vs(this.database,Fi(this._delegate,mJ(e)))}orderByKey(){return vt("Query.orderByKey",0,0,arguments.length),new Vs(this.database,Fi(this._delegate,pJ()))}orderByPriority(){return vt("Query.orderByPriority",0,0,arguments.length),new Vs(this.database,Fi(this._delegate,bJ()))}orderByValue(){return vt("Query.orderByValue",0,0,arguments.length),new Vs(this.database,Fi(this._delegate,vJ()))}startAt(e=null,t){return vt("Query.startAt",0,2,arguments.length),new Vs(this.database,Fi(this._delegate,aJ(e,t)))}startAfter(e=null,t){return vt("Query.startAfter",0,2,arguments.length),new Vs(this.database,Fi(this._delegate,lJ(e,t)))}endAt(e=null,t){return vt("Query.endAt",0,2,arguments.length),new Vs(this.database,Fi(this._delegate,sJ(e,t)))}endBefore(e=null,t){return vt("Query.endBefore",0,2,arguments.length),new Vs(this.database,Fi(this._delegate,iJ(e,t)))}equalTo(e,t){return vt("Query.equalTo",1,2,arguments.length),new Vs(this.database,Fi(this._delegate,_J(e,t)))}toString(){return vt("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return vt("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(vt("Query.isEqual",1,1,arguments.length),!(e instanceof Vs)){const t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,Ss(e,"cancel",i.cancel,!0),i.context=r,OT(e,"context",i.context);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(Cr(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Gr(this.database,new Ti(this._delegate._repo,this._delegate._path))}}class Gr extends Vs{constructor(e,t){super(e,new Dr(t._repo,t._path,new cy,!1)),this.database=e,this._delegate=t}getKey(){return vt("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return vt("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new Gr(this.database,Sd(this._delegate,e))}getParent(){vt("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Gr(this.database,e):null}getRoot(){return vt("Reference.root",0,0,arguments.length),new Gr(this.database,this._delegate.root)}set(e,t){vt("Reference.set",1,2,arguments.length),Ss("Reference.set","onComplete",t,!0);const r=$j(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(vt("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let o=0;o<e.length;++o)i[""+o]=e[o];e=i,iO("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}vi("Reference.update",this._delegate._path),Ss("Reference.update","onComplete",t,!0);const r=tJ(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){vt("Reference.setWithPriority",2,3,arguments.length),Ss("Reference.setWithPriority","onComplete",r,!0);const i=eJ(this._delegate,e,t);return r&&i.then(()=>r(null),o=>r(o)),i}remove(e){vt("Reference.remove",0,1,arguments.length),Ss("Reference.remove","onComplete",e,!0);const t=JX(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){vt("Reference.transaction",1,3,arguments.length),Ss("Reference.transaction","transactionUpdate",e,!1),Ss("Reference.transaction","onComplete",t,!0),qJ("Reference.transaction","applyLocally",r);const i=UJ(this._delegate,e,{applyLocally:r}).then(o=>new WJ(o.committed,new Ol(this.database,o.snapshot)));return t&&i.then(o=>t(null,o.committed,o.snapshot),o=>t(o,!1,null)),i}setPriority(e,t){vt("Reference.setPriority",1,2,arguments.length),Ss("Reference.setPriority","onComplete",t,!0);const r=ZX(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){vt("Reference.push",0,2,arguments.length),Ss("Reference.push","onComplete",t,!0);const r=XX(this._delegate,e),i=r.then(c=>new Gr(this.database,c));t&&i.then(()=>t(null),c=>t(c));const o=new Gr(this.database,r);return o.then=i.then.bind(i),o.catch=i.catch.bind(i,void 0),o}onDisconnect(){return vi("Reference.onDisconnect",this._delegate._path),new GJ(new YX(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ig{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:CJ,forceLongPolling:AJ}}useEmulator(e,t,r={}){kJ(this._delegate,e,t,r)}ref(e){if(vt("database.ref",0,1,arguments.length),e instanceof Gr){const t=HA(this._delegate,e.toString());return new Gr(this,t)}else{const t=eO(this._delegate,e);return new Gr(this,t)}}refFromURL(e){vt("database.refFromURL",1,1,arguments.length);const r=HA(this._delegate,e);return new Gr(this,r)}goOffline(){return vt("database.goOffline",0,0,arguments.length),RJ(this._delegate)}goOnline(){return vt("database.goOnline",0,0,arguments.length),DJ(this._delegate)}}Ig.ServerValue={TIMESTAMP:LJ(),increment:n=>VJ(n)};function KJ({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:o,nodeAdmin:c=!1}){BP(t);const u=new lN("database-standalone"),h=new D_("auth-internal",u);h.setComponent(new $n("auth-internal",()=>r,"PRIVATE"));let m;return i&&(m=new D_("app-check-internal",u),m.setComponent(new $n("app-check-internal",()=>i,"PRIVATE"))),{instance:new Ig(sO(n,h,m,e,c),n),namespace:o}}var QJ=Object.freeze({__proto__:null,initStandalone:KJ});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YJ=Ig.ServerValue;function XJ(n){n.INTERNAL.registerComponent(new $n("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new Ig(i,r)},"PUBLIC").setServiceProps({Reference:Gr,Query:Vs,Database:Ig,DataSnapshot:Ol,enableLogging:PJ,INTERNAL:QJ,ServerValue:YJ}).setMultipleInstances(!0)),n.registerVersion(BJ,zJ)}XJ(Nt);const Nm={type:"service_account",project_id:"goo-now3",private_key_id:"d2a36acde51479c4a6186abed410e58ba5b97ad7",private_key:`-----BEGIN PRIVATE KEY-----
MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDVOSnFAkAXje1+
2WP6XhQu3/1tQZmRS4Q0Yd5UN5FAxmw/NTDzGmBeNfJ5KYKMYpAq93GJUfAT7Wu6
t480PAbnGy7uNzZZc0PfmVZOndoC9P3vfaDZg4t8dnOtZHhsSxh7oLTDPph/Qcuq
Sl+GwpUDuX4uRyYt8Ji9erlHgM0XEf+/HOICLJa5SHWpaj1VTI2EfXFaR/rQ/coY
Q20nU2c7inZbECA5emstUXZecT+yAPqA/v9A9zu1IC708EpXtXEeMcZS2QpDlzxq
x5/LBhoQazqNJHvPSTFTchpwVQtLo9OPOFYA3tPkWEafvri94AzSiDXHXGS0+hYN
q10fCWL7AgMBAAECggEAPdPXCFDoO8xEVxl7U6CPEq6Romo4uPhgS/4rBVmdjV5c
ChIG8R8vXXIgLsD6IXH9IvBgZDS1vFmGePx8EmXrjH0F5T5uTI7PWhlw/Nfp3Ryk
O5s+loP94OfKEDfHcYNvBH4rnEfc2V2/TFBHleB7bDqP26R27jBLYfohmpm/HpZq
UvN7plGb+fXY0mu+wTJ6UjlwueMVm4Qxe2qz0uw6ju3xKCYlTbpwzhnhxb8Quyf3
PeTZMPpiTvZqVyhq7TPn3zgPovDrJfBPcaMYbldi9va3jnN7DQlJbsoM0f1mw7UG
pgXwXRYWj23WHYWOFSuHUDqYUp1Pg6QN5g/nNABC9QKBgQD20cEMDBJe0SW+kEo+
w5RZdE+5dMqTO1waQYj7cq44lTJhhqKUw9tBEEIi4e74AQuiPHXpIaL98QLJ5sLG
yITH65aCLVDhdw6jL4zL/1SbdgS6ngv0D1GcVN84K3GkuU67evjwgz40fG5uFF19
Tk3MPuHW0B/oceaVOs89ry8+tQKBgQDdJ4DHecljHxgAdycvh/Te5UF87bdyBD8O
twjpIgYifWlso/6vI79JQGtUU5sUsWnrUj3BGemiD62zb8Q1WAqOfv7xCvBgzPjS
bkj9ywI+WPYpwaS7Vm3dxz9tpEEyfZAIUuhjMYypwh/wW1GqL7B5oWzoqmNT78at
KZ34RwV47wKBgQDYduts6mVuHNWShK9ozlScA6MsDl7fs466REGj7VcYrtjpqY+L
Ex6GuICYYTgY76nJVmc+2E4/kpEUi7rFZfT19QsiDiZCJw2CVuCPxNXqJh5NoPDw
0kKL7e97LrbTdeW0DUyoeyIiHAMprdi0XeljOL8Oi6eAT+yfcl1xRuQThQKBgQDQ
HYGRtijvD2692WNV1mJ4c1OaZfXw5NAWX+aRxYPyZwSTyQw98qzrGSUnmPnikkYz
vhQBKQp0iL6UkoQZEv30NMxjN0EYRyuMk146/xTgaUVV7DXCWcZQI1WsLxtvkTu+
qY6o8hMGGXmG7di/B9vRyjg8B0Qr1AOqJvTSlLswnwKBgQDjRiMN/vpsl3CyYGRg
RCBbXG/aKVjUc+YxiWz2e/lwDhRAgI8oZfseD5DLbO5WxeHIiq0fu/MVq/agLBGz
ryIll9zhcD/zx5ij7YK8DoHgiKTT1tix6W/9+98eIhErhH3dY3ENLBBLGsC3UBr2
6IajCMW2vSmZJMQt0+0d0wMlGg==
-----END PRIVATE KEY-----
`,client_email:"firebase-adminsdk-fbsvc@goo-now3.iam.gserviceaccount.com",client_id:"116489207066839985076",auth_uri:"https://accounts.google.com/o/oauth2/auth",token_uri:"https://oauth2.googleapis.com/token",auth_provider_x509_cert_url:"https://www.googleapis.com/oauth2/v1/certs",client_x509_cert_url:"https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-fbsvc%40goo-now3.iam.gserviceaccount.com",universe_domain:"googleapis.com"};function H1(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function JJ(n){const e=new Uint8Array(n);let t="";for(let r=0;r<e.byteLength;r++)t+=String.fromCharCode(e[r]);return H1(t)}function ZJ(n){const e=window.atob(n),t=e.length,r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);return r.buffer}let Kp=null,XA=0;const aO=async()=>{if(Kp&&Date.now()<XA)return Kp;try{const n={alg:"RS256",typ:"JWT"},e=Math.floor(Date.now()/1e3),t={iss:Nm.client_email,scope:"https://www.googleapis.com/auth/firebase.messaging",aud:Nm.token_uri,exp:e+3600,iat:e},r=H1(JSON.stringify(n)),i=H1(JSON.stringify(t)),o=`${r}.${i}`,c=Nm.private_key.replace(/-----BEGIN PRIVATE KEY-----/,"").replace(/-----END PRIVATE KEY-----/,"").replace(/\s/g,""),u=ZJ(c),h=await window.crypto.subtle.importKey("pkcs8",u,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),m=await window.crypto.subtle.sign("RSASSA-PKCS1-v1_5",h,new TextEncoder().encode(o)),p=`${o}.${JJ(m)}`,v=await(await fetch(Nm.token_uri,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer&assertion=${p}`})).json();return v.access_token?(Kp=v.access_token,XA=Date.now()+v.expires_in*1e3-6e4,console.log("FCM V1 Token Generated successfully"),Kp):(console.error("Failed to generate FCM Token",v),null)}catch(n){return console.error("Error generating FCM V1 Token:",n),null}},eZ="GOO_NOW_DB",vl="app_data",tZ=1;let Qp=null;const x_=()=>Qp||(Qp=new Promise((n,e)=>{const t=indexedDB.open(eZ,tZ);t.onupgradeneeded=r=>{const i=r.target.result;i.objectStoreNames.contains(vl)||i.createObjectStore(vl)},t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{console.error("IndexedDB Error:",r.target.error),e(r.target.error)}}),Qp),Ls={get:async(n,e)=>{try{const t=await x_();return new Promise(r=>{const c=t.transaction(vl,"readonly").objectStore(vl).get(n);c.onsuccess=()=>{const u=c.result;r(u===void 0?e:u)},c.onerror=()=>{console.warn(`Failed to read ${n}, using default.`),r(e)}})}catch(t){return console.error("Storage Get Error:",t),e}},set:async(n,e)=>{try{const t=await x_();return new Promise((r,i)=>{const u=t.transaction(vl,"readwrite").objectStore(vl).put(e,n);u.onsuccess=()=>r(),u.onerror=()=>i(u.error)})}catch(t){console.error("Storage Set Error:",t)}},remove:async n=>{try{const e=await x_();return new Promise((t,r)=>{const c=e.transaction(vl,"readwrite").objectStore(vl).delete(n);c.onsuccess=()=>t(),c.onerror=()=>r(c.error)})}catch(e){console.error("Storage Remove Error:",e)}}},Ui={get:(n,e)=>{try{return JSON.parse(localStorage.getItem(n)||"null")||e}catch{return e}},set:(n,e)=>{try{localStorage.setItem(n,JSON.stringify(e))}catch{console.error("LocalStorage Quota Exceeded for "+n)}},remove:n=>localStorage.removeItem(n)},JA=[{brand:"Samsung",manufacturer:"samsung",model:"SM-G991B",device:"p3s"},{brand:"Samsung",manufacturer:"samsung",model:"SM-A528B",device:"a52s"},{brand:"Xiaomi",manufacturer:"Xiaomi",model:"M2102J20SG",device:"vayu"},{brand:"Oppo",manufacturer:"OPPO",model:"CPH2127",device:"OPPO A53"},{brand:"Vivo",manufacturer:"vivo",model:"V2027",device:"V2027"},{brand:"Huawei",manufacturer:"HUAWEI",model:"VOG-L29",device:"HWVOG"},{brand:"Realme",manufacturer:"Realme",model:"RMX3363",device:"RMX3363"},{brand:"Infinix",manufacturer:"Infinix",model:"X695",device:"X695"}],ZA=[{ssid:"WE_4G_HOME",operator:"WE"},{ssid:"Vodafone_Home_5G",operator:"Vodafone"},{ssid:"Etisalat_Fiber",operator:"Etisalat"},{ssid:"Orange_DSL_Plus",operator:"Orange"},{ssid:"Home_WiFi_2.4G",operator:"WE"},{ssid:"TP-Link_Extender",operator:"Vodafone"}],nZ=n=>{let e="";const t="0123456789abcdef";for(let r=0;r<n;r++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},sZ=()=>{let n="35"+Math.floor(Math.random()*1e12).toString().padStart(12,"0"),e=0;for(let r=0;r<14;r++){let i=parseInt(n[r]);r%2!==0&&(i*=2,i>9&&(i-=9)),e+=i}const t=(10-e%10)%10;return n+t},rZ=()=>"XX:XX:XX:XX:XX:XX".replace(/X/g,()=>"0123456789ABCDEF".charAt(Math.floor(Math.random()*16))),iZ={getDeviceInfo:()=>{const n=Ui.get("spoofed_device_info",null);if(n)return n;const e=JA[Math.floor(Math.random()*JA.length)],t=ZA[Math.floor(Math.random()*ZA.length)],r={imei:sZ(),androidId:nZ(16),brand:e.brand,manufacturer:e.manufacturer,model:e.model,device:e.device,network:{ssid:t.ssid,operator:t.operator,bssid:rZ()}};return Ui.set("spoofed_device_info",r),console.log("[DeviceSpoofer] Generated New Identity:",r.model,r.imei),r}};let ct,Xu,e4=!1;const aZ=n=>(Xu||(Xu=Nt.auth()),new Nt.auth.RecaptchaVerifier(n,{size:"invisible",callback:()=>{console.log("Recaptcha resolved")}})),oZ=async(n,e)=>(console.log(`[PhoneAuth] Initiating for ${n}...`),console.log("[PhoneAuth] Using Simulation Mode (Bypassing Billing/SMS)"),new Promise(t=>{setTimeout(()=>{t({success:!0,confirmationResult:{verificationId:"simulated-verification-id-"+Date.now(),confirm:async r=>{var i;if(r==="123456"){console.log("[PhoneAuth] Simulation Code Valid. Signing in anonymously..."),Xu||(Xu=Nt.auth());const o=await Xu.signInAnonymously();return{user:{...o.user,phoneNumber:n,uid:(i=o.user)==null?void 0:i.uid}}}else throw new Error("    ( 123456)")}}})},1500)})),oO=async n=>{if(!(!ct||!n))try{const e=iZ.getDeviceInfo();await ct.collection("users").doc(n).set({deviceInfo:e,lastLoginAt:Nt.firestore.FieldValue.serverTimestamp()},{merge:!0}),console.log(`[DeviceSpoofer] Injected fake device info for ${n}`)}catch(e){console.error("[DeviceSpoofer] Injection Failed:",e)}},lO=async()=>{if(!ct)return;const n=await ct.collection("users").orderBy("createdAt","asc").get(),e=ct.batch(),t=new Set;n.docs.forEach(i=>t.add(i.id));let r=0;for(const i of n.docs){const o=i.id;if(/^ID:\d{8}$/.test(o))continue;let c="";do c="ID:"+Math.floor(1e7+Math.random()*9e7).toString();while(t.has(c));t.add(c);const u=i.data(),h=ct.collection("users").doc(c);e.set(h,{...u,id:c});const m=ct.collection("users").doc(o);e.delete(m),r++}r>0?(await e.commit(),console.log(`[FixUserIds] Renumbered ${r} users to 8-digit format.`)):console.log("[FixUserIds] No users needed fixing.")},kr=(n,e=new WeakSet)=>{if(n==null)return null;if(typeof n!="object")return n;if(n instanceof Date)return n.toISOString();if(typeof n.toDate=="function")try{return n.toDate().toISOString()}catch{return null}if(Object.prototype.hasOwnProperty.call(n,"seconds")&&Object.prototype.hasOwnProperty.call(n,"nanoseconds"))return new Date(n.seconds*1e3).toISOString();if(e.has(n))return null;if(e.add(n),Array.isArray(n))return n.map(r=>kr(r,e)).filter(r=>r!==void 0);const t={};for(const r in n)if(Object.prototype.hasOwnProperty.call(n,r)){const i=n[r];if(r.startsWith("_")||typeof i=="function")continue;const o=kr(i,e);o!==void 0&&(t[r]=o)}return t},cO=n=>{if(!Nt.apps.length)try{const e=Nt.initializeApp(n);if(ct=e.firestore(),Xu=e.auth(),!e4){try{ct.settings({ignoreUndefinedProperties:!0});try{ct.enablePersistence({synchronizeTabs:!0}).catch(t=>{t.code==="failed-precondition"?console.warn("Persistence failed: Multiple tabs open"):t.code==="unimplemented"&&console.warn("Persistence not supported by browser")})}catch(t){console.warn("Firestore persistence error:",t)}}catch(t){console.warn("Firestore settings error (might be already applied):",t)}Nt.database().ref(".info/connected").on("value",t=>{t.val()===!0?console.log("[Firebase] Proactive connection established."):(console.log("[Firebase] Proactive connection lost. Reconnecting..."),Nt.database().goOnline())}),e4=!0}return!0}catch(e){return console.error("Firebase Init Error:",e),!1}return ct||(ct=Nt.firestore()),!0},lZ=async()=>{if(!ct)return{success:!1,error:"Firebase not initialized"};try{const n=new Promise((e,t)=>setTimeout(()=>t(new Error("Connection timeout")),5e3));return await Promise.race([ct.collection("users").limit(1).get(),n]),{success:!0}}catch(n){return{success:!1,error:n.message}}},Ir=(n,e)=>{if(!ct)return()=>{};const t=new Map;let r=!1;return ct.collection(n).onSnapshot({includeMetadataChanges:!0},i=>{let o=!1;if(i.docChanges().forEach(c=>{if(o=!0,c.type==="removed")t.delete(c.doc.id);else{const u=c.doc.data(),h=kr(u);t.set(c.doc.id,{id:c.doc.id,...h})}}),o||!r){r=!0;const c=Array.from(t.values());e(c)}},i=>console.error(`Subscription error [${n}]:`,i))},yl=(n,e,t,r)=>{if(!ct)return()=>{};let i=ct.collection(n);e.forEach(u=>{i=i.where(u.field,u.op,u.value)}),r!=null&&r.orderBy&&(i=i.orderBy(r.orderBy.field,r.orderBy.direction||"desc")),r!=null&&r.limit&&(i=i.limit(r.limit));const o=new Map;let c=!1;return i.onSnapshot({includeMetadataChanges:!0},u=>{let h=!1;if(!c&&u.metadata.fromCache&&u.empty){console.log(`[QuerySubscription] Ignoring empty cache snapshot for ${n}`);return}if(u.docChanges().forEach(m=>{if(h=!0,m.type==="removed")o.delete(m.doc.id);else{const p=m.doc.data(),b=kr(p);o.set(m.doc.id,{id:m.doc.id,...b})}}),h||!c){c=!0;const m=Array.from(o.values());t(m)}},u=>console.error(`Query Subscription error [${n}]:`,u))},gi=async(n,e)=>{if(!ct||e.length===0)return;const t=400,r=kr(e);for(let i=0;i<r.length;i+=t){const o=r.slice(i,i+t),c=ct.batch();o.forEach(u=>{if(!u.id)return;const h=ct.collection(n).doc(String(u.id));c.set(h,{...u,serverUpdatedAt:Nt.firestore.FieldValue.serverTimestamp()},{merge:!0})}),await c.commit()}},cZ=async(n,e)=>{if(!ct)throw new Error("Firebase not initialized");if(!(!e||e.length===0))try{await gi(n,e)}catch(t){throw new Error(`Migration failed for ${n}: ${t.message}`)}},xt=async(n,e,t)=>{if(!ct)return;const r=kr(t),i=ct.collection(n).doc(e);if(n==="orders"&&r.status)try{await ct.runTransaction(async o=>{const c=await o.get(i);if(!c.exists){o.set(i,{...r,serverUpdatedAt:Nt.firestore.FieldValue.serverTimestamp()});return}const u=c.data(),h=u==null?void 0:u.status,m=r.status,p=["delivered","cancelled","returned"],b=["pending","in_transit","assigned"];p.includes(h)&&b.includes(m)&&(console.error(`[Zombie Prevention] Blocked reversion from ${h} to ${m} for Order ${e}`),delete r.status,r.adminNotes=((u==null?void 0:u.adminNotes)||"")+`
[System] Blocked reversion from ${h} to ${m}`),o.set(i,{...r,serverUpdatedAt:Nt.firestore.FieldValue.serverTimestamp()},{merge:!0})});return}catch(o){console.error("Safe Update Transaction Failed:",o)}return await i.set({...r,serverUpdatedAt:Nt.firestore.FieldValue.serverTimestamp()},{merge:!0})},rr=async(n,e)=>{if(!(!ct||!e))return await ct.collection(n).doc(String(e)).delete()},qj=async(n,e)=>{if(!ct)return;const t=kr(e);return await ct.collection(n).add({...t,serverUpdatedAt:Nt.firestore.FieldValue.serverTimestamp()})},G1=(n,e,t)=>{let r=Nt.database().ref(n);const i=r.on("value",o=>{const c=o.val();if(!c){e([]);return}let u=Object.values(c);t!=null&&t.sortByDate&&u.sort((h,m)=>{const p=new Date(h.createdAt||h.dayDate||0).getTime();return new Date(m.createdAt||m.dayDate||0).getTime()-p}),t!=null&&t.limit&&(u=u.slice(0,t.limit)),e(u)});return()=>r.off("value",i)},Hj=async(n,e,t)=>{const r=kr(t);return await Nt.database().ref(`${n}/${e}`).set({...r,serverUpdatedAt:new Date().toISOString()})},Gj=async(n,e)=>await Nt.database().ref(`${n}/${e}`).remove(),W1=async(n,e)=>{if(!e||e.length===0)return;const t={},r=new Date().toISOString();return e.forEach(i=>{i.id&&(t[`${i.id}`]={...kr(i),serverUpdatedAt:r})}),await Nt.database().ref(n).update(t)},dO=async n=>{try{const e=kr(n);return await Nt.database().ref(`audit_logs/${e.id}`).set({...e,createdAt:e.createdAt||new Date().toISOString()}),!0}catch(e){return console.error("[RTDB Log] Failed:",e),!1}},uO=async(n,e)=>{try{return await Nt.database().ref(`audit_logs/${n}`).update(e),!0}catch(t){return console.error("[RTDB Log Update] Failed:",t),!1}},hO=n=>{const e=Nt.database().ref("audit_logs"),t=e.on("value",r=>{const i=r.val();if(!i){n([]);return}const o=Object.values(i).sort((c,u)=>new Date(u.createdAt).getTime()-new Date(c.createdAt).getTime());n(o)});return()=>e.off("value",t)},fO=async()=>{try{return await Nt.database().ref("audit_logs").remove(),!0}catch(n){return console.error("[RTDB Log Clear] Failed:",n),!1}},mO=async n=>{if(!ct||!n.targetId||!n.collection)throw new Error("    ");const e=ct.collection(n.collection).doc(n.targetId);try{if(n.actionType==="delete"){if(!n.previousData)throw new Error("    ");return await e.set(n.previousData),!0}else if(n.actionType==="update"||n.actionType==="financial"){if(!n.previousData)throw new Error("     ");return await e.set(n.previousData),!0}else if(n.actionType==="create")return await e.delete(),!0;throw new Error("     ")}catch(t){throw console.error("[Undo] Action Failed:",t),t}},Cg=async n=>{if(!ct)return{success:!1,error:"Firebase DB not not initialized"};try{const e=await ct.collection("users").doc(n).get();if(e.exists)return{success:!0,data:{id:e.id,...e.data()}};const t=await ct.collection("users").where("phone","==",n).limit(1).get();if(!t.empty){const r=t.docs[0];return{success:!0,data:{id:r.id,...r.data()}}}return{success:!1,error:"not_found"}}catch(e){return console.error("Error fetching user:",e),{success:!1,error:"network_error"}}},b_=700*1024,dZ=async(n,e="files",t)=>{if(!ct)throw new Error("Firebase DB not initialized");return new Promise((r,i)=>{const o=new FileReader;o.onload=async c=>{var u;try{const h=((u=c.target)==null?void 0:u.result).split(",")[1],m=Math.ceil(h.length/b_),p=`FILE-${Date.now()}`;await ct.collection("stored_files").doc(p).set({name:n.name,size:n.size,type:n.type,totalChunks:m,createdAt:Nt.firestore.FieldValue.serverTimestamp(),isChunked:!0});for(let b=0;b<m;b++){const v=h.slice(b*b_,(b+1)*b_);await ct.collection("stored_files").doc(p).collection("chunks").doc(b.toString()).set({data:v,index:b});const _=Math.round((b+1)/m*100);t&&t(_),console.log(`[Firestore Upload] Chunk ${b+1}/${m} uploaded.`)}r(`FIRESTORE_FILE:${p}`)}catch(h){console.error("Firestore chunk upload failed:",h),i(h)}},o.onerror=c=>i(c),o.readAsDataURL(n)})},Ty=async n=>{if(!ct)throw new Error("Firebase DB not initialized");const e=await ct.collection("stored_files").doc(n).get();if(!e.exists)throw new Error("File not found");const t=e.data();if(!t)throw new Error("File metadata missing");const r=await ct.collection("stored_files").doc(n).collection("chunks").orderBy("index").get();let i="";r.forEach(m=>{i+=m.data().data});const o=atob(i),c=new Array(o.length);for(let m=0;m<o.length;m++)c[m]=o.charCodeAt(m);const u=new Uint8Array(c),h=new Blob([u],{type:t.type||"application/vnd.android.package-archive"});return URL.createObjectURL(h)},Wj=async(n,e="updates",t)=>{if(!Nt.apps.length)throw new Error("Firebase not initialized");const r=Nt.app();if(r.options.storageBucket)try{console.log(`[Upload] Attempting Storage upload to ${r.options.storageBucket}...`);const c=Nt.storage().ref().child(`${e}/${Date.now()}_${n.name}`),u={contentType:n.type||"application/vnd.android.package-archive"},h=c.put(n,u);return await new Promise((m,p)=>{h.on("state_changed",b=>{const v=b.bytesTransferred/b.totalBytes*100;t&&t(v)},b=>{console.warn("[Storage Upload Failed] Switching to Firestore fallback...",b),p(b)},()=>{h.snapshot.ref.getDownloadURL().then(m).catch(p)})})}catch{throw console.warn("Storage failed. Fallback disabled to save Quota."),new Error("Storage Upload Failed and Database Fallback is disabled to prevent quota usage. Please check Storage Quota.")}else throw new Error("Storage Bucket not configured. Database Fallback is disabled.")},Kt=async(n,e)=>{try{const t=n.toLowerCase();let r=t;t==="customer"&&(r="user");let i="";e.targetId&&e.targetId!=="all"&&e.targetId!=="multiple"?i=`${r}_${e.targetId}_v2`:r==="admin"?i="admin_v2":i=`${r}s_v2`,console.log(`[Notification] Preparing to send to topic: ${i}`);const o=await aO();if(!o)return console.error("[Notification] Failed to generate access token"),!1;console.log("[Notification] Access Token generated successfully.");const c=Nm.project_id,u={message:{topic:i,notification:{title:e.title,body:e.body},data:{type:"order_update",url:e.url||"/",title:e.title,body:e.body,target_id:e.targetId||"",timestamp:new Date().toISOString(),sound:"default",sync_data:"true",wake_up:"true"},android:{priority:"HIGH",ttl:"2419200s",notification:{channel_id:"high_importance_channel_v2",sound:"default",default_sound:!0,default_vibrate_timings:!0,notification_priority:"PRIORITY_HIGH",visibility:"PUBLIC",click_action:"OPEN_APP_TO_ORDERS"}},apns:{headers:{"apns-priority":"10","apns-push-type":"alert"},payload:{aps:{sound:"default",badge:1,"content-available":1}}}}},h=await fetch(`https://fcm.googleapis.com/v1/projects/${c}/messages:send`,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify(u)});if(h.ok)return console.log(`[Notification] Sent successfully to ${i}`),!0;{const m=await h.text();return console.error(`[Notification] FCM Error: ${m}`),!1}}catch(t){return console.error("[Notification] Failed to send:",t),!1}},K1=async n=>{try{if(!Nt.messaging.isSupported())return;const t=await Nt.messaging().getToken({vapidKey:"YOUR_VAPID_KEY_IF_NEEDED"});if(!t){console.warn("[WebNotification] No FCM token available.");return}const r=await aO();if(!r)return;const i=await fetch(`https://iid.googleapis.com/iid/v1/${t}/rel/topics/${n}`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});i.ok?console.log(`[WebNotification] Subscribed content-available to ${n}`):console.error(`[WebNotification] Failed to subscribe to ${n}:`,await i.text())}catch(e){console.error("[WebNotification] Subscription Error:",e)}},uZ=async n=>{if(!ct)throw new Error("Firebase not initialized");const e=ct.collection("settings").doc("counters");try{return await ct.runTransaction(async t=>{const r=await t.get(e);let i=1;if(r.exists){const o=r.data(),c=o&&o[n]?o[n]:0;if(c)i=c+1;else{const u=await ct.collection("orders").orderBy("createdAt","desc").limit(20).get();let h=0;u.forEach(m=>{const p=parseInt(m.id.replace(n,"")||"0");isNaN(p)||(h=Math.max(h,p))}),i=h+1}}else{const o=await ct.collection("orders").orderBy("createdAt","desc").limit(50).get();let c=0;o.forEach(u=>{const h=u.id;if(h.startsWith(n)){const m=parseInt(h.replace(n,"")||"0");isNaN(m)||(c=Math.max(c,m))}}),i=c+1}return t.set(e,{[n]:i},{merge:!0}),`${n}${i}`})}catch(t){return console.error("Transaction failed:",t),`${n}${Date.now()}`}},jm=async n=>{if(!ct)throw new Error("Firebase not initialized");const e=ct.collection("settings").doc("counters");try{return await ct.runTransaction(async t=>{const r=await t.get(e);let i=1;if(r.exists){const o=r.data(),c=o&&o[n]?o[n]:0;if(c>0)i=c+1;else{const u=await ct.collection("orders").orderBy("createdAt","desc").limit(10).get();let h=0;u.forEach(m=>{const p=parseInt(m.id.replace(n,"")||"0");isNaN(p)||(h=Math.max(h,p))}),i=h+1}}else{const o=await ct.collection("orders").orderBy("createdAt","desc").limit(10).get();let c=0;o.forEach(u=>{const h=u.id;if(h.startsWith(n)){const m=parseInt(h.replace(n,"")||"0");isNaN(m)||(c=Math.max(c,m))}}),i=c+1}return t.set(e,{[n]:i},{merge:!0}),`${n}${i}`})}catch(t){console.error("Safe ID Gen Transaction failed, trying Safe Fallback (Query):",t);try{const r=await ct.collection("orders").orderBy("createdAt","desc").limit(10).get();let i=0;r.forEach(u=>{const h=u.id;if(h.startsWith(n)){const m=parseInt(h.replace(n,"")||"0");!isNaN(m)&&m<1e9&&(i=Math.max(i,m))}});const o=i+1,c=`${n}${o}`;return ct.collection("settings").doc("counters").set({[n]:o},{merge:!0}).catch(()=>{}),c}catch(r){throw console.error("Critical: Even Fallback Failed",r),new Error("Could not generate ID. Check connection.")}}},Q1=async(n,e)=>{if(!ct)throw new Error("Firebase not initialized");if(e<=0)return[];const t=ct.collection("settings").doc("counters");try{const r=ct.runTransaction(async i=>{const o=await i.get(t);let c=1;if(o.exists){const m=o.data(),p=m&&m[n]?m[n]:0;if(p)c=p+1;else{const b=await ct.collection("orders").orderBy("createdAt","desc").limit(15).get();let v=0;b.forEach(_=>{const T=parseInt(_.id.replace(n,"")||"0");isNaN(T)||(v=Math.max(v,T))}),c=v+1}}else{const m=await ct.collection("orders").orderBy("createdAt","desc").limit(15).get();let p=0;m.forEach(b=>{const v=b.id;if(v.startsWith(n)){const _=parseInt(v.replace(n,"")||"0");isNaN(_)||(p=Math.max(p,_))}}),c=p+1}const u=c+e-1;i.set(t,{[n]:u},{merge:!0});const h=[];for(let m=0;m<e;m++)h.push(`${n}${c+m}`);return console.log(`[BatchID] Generated ${e} IDs: ${h[0]} to ${h[h.length-1]}`),h});return await Promise.race([r,new Promise((i,o)=>setTimeout(()=>o(new Error("Transaction timeout")),2500))])}catch(r){console.error("Batch ID Gen failed/timedout, switching to smart fallback:",r);try{const i=await ct.collection("orders").orderBy("createdAt","desc").limit(20).get();let o=0;i.forEach(h=>{const m=h.id;if(m.startsWith(n)){const p=m.replace(n,"")||"0",b=parseInt(p);!isNaN(b)&&b<1e9&&(o=Math.max(o,b))}});const c=o+1,u=[];for(let h=0;h<e;h++)u.push(`${n}${c+h}`);return console.log(`[BatchID-Fallback] Generated ${e} IDs from max ${o} (Smart Filter)`),ct.collection("settings").doc("counters").set({[n]:c+e-1},{merge:!0}).catch(()=>{}),u}catch(i){throw console.error("Critical Fallback failed:",i),new Error("Batch ID Generation Failed completely. Please retry.")}}},Y1=Object.freeze(Object.defineProperty({__proto__:null,addData:qj,batchSaveData:gi,batchSaveRTDB:W1,deepClean:kr,deleteAuditLogsRTDB:fO,deleteData:rr,deleteRTDB:Gj,downloadFileFromFirestore:Ty,fixUserIds:lO,generateIdsBatch:Q1,generateUniqueId:uZ,generateUniqueIdSafe:jm,getUser:Cg,initFirebase:cO,injectSpoofedDeviceInfo:oO,logActionToRTDB:dO,migrateLocalData:cZ,sendExternalNotification:Kt,setupRecaptcha:aZ,signInWithPhone:oZ,subscribeToAuditLogsRTDB:hO,subscribeToCollection:Ir,subscribeToQuery:yl,subscribeToRTDB:G1,subscribeWebToTopic:K1,testConnection:lZ,undoActionFromLog:mO,updateAuditLogRTDB:uO,updateData:xt,updateRTDB:Hj,uploadFile:Wj,uploadFileToFirestore:dZ},Symbol.toStringTag,{value:"Module"})),hZ=""+new URL("vodafone-cash-new-BMWlzZsj.png",import.meta.url).href,fZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("circle",{cx:"12",cy:"12",r:"10"}),s.jsx("path",{d:"m4.9 4.9 14.2 14.2"})]}),mZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2"}),s.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),gZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"}),s.jsx("circle",{cx:"7",cy:"17",r:"2"}),s.jsx("path",{d:"M9 17h6"}),s.jsx("circle",{cx:"17",cy:"17",r:"2"})]}),Sm=n=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:s.jsx("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"})}),zs=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),s.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),ut=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Md=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),s.jsx("circle",{cx:"9",cy:"7",r:"4"}),s.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),s.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),Je=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),s.jsx("path",{d:"m9 11 3 3L22 4"})]}),It=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("circle",{cx:"12",cy:"12",r:"10"}),s.jsx("path",{d:"M12 6v6l4 2"})]}),_t=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),s.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),Kj=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3v1a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h14"}),s.jsx("path",{d:"M3 5v14"})]}),Iy=n=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:s.jsx("path",{d:"m6 9 6 6 6-6"})}),Tt=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M3 6h18"}),s.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),s.jsx("path",{d:"M10 11v6"}),s.jsx("path",{d:"M14 11v6"})]}),pZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("rect",{width:"20",height:"14",x:"2",y:"5",rx:"2"}),s.jsx("line",{x1:"2",x2:"22",y1:"10",y2:"10"})]}),xZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("rect",{width:"16",height:"20",x:"4",y:"2",rx:"2"}),s.jsx("line",{x1:"8",x2:"16",y1:"6",y2:"6"}),s.jsx("line",{x1:"16",x2:"16",y1:"14",y2:"18"}),s.jsx("path",{d:"M16 10H8"}),s.jsx("path",{d:"M12 14v4"})]}),c0=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}),s.jsx("path",{d:"m10 17 5-5-5-5"}),s.jsx("path",{d:"M15 12H3"})]}),Qj=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),s.jsx("path",{d:"M9 22V12h6v10"})]}),Ed=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),s.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]}),Zt=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11"}),s.jsx("path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2"}),s.jsx("circle",{cx:"7.5",cy:"18.5",r:"2.5"}),s.jsx("circle",{cx:"17.5",cy:"18.5",r:"2.5"})]}),Cy=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}),s.jsx("path",{d:"m3.29 7 8.71 5 8.71-5"}),s.jsx("path",{d:"m12 22 8.71-5"}),s.jsx("path",{d:"M12 12v10"})]}),wi=n=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:s.jsx("path",{d:"m9 18 6-6-6-6"})}),us=n=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:s.jsx("path",{d:"m15 18-6-6 6-6"})}),zn=n=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:s.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})}),nd=n=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...n,children:s.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"})}),Js=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"}),s.jsx("path",{d:"m15 5 4 4"})]}),dr=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),s.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),s.jsx("path",{d:"M12 11h4"}),s.jsx("path",{d:"M12 16h4"}),s.jsx("path",{d:"M8 11h.01"}),s.jsx("path",{d:"M8 16h.01"})]}),bZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),s.jsx("circle",{cx:"9",cy:"7",r:"4"}),s.jsx("line",{x1:"19",x2:"19",y1:"8",y2:"14"}),s.jsx("line",{x1:"22",x2:"16",y1:"11",y2:"11"})]}),gO=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("circle",{cx:"6",cy:"19",r:"3"}),s.jsx("path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"}),s.jsx("circle",{cx:"18",cy:"5",r:"3"})]}),yZ=n=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:s.jsx("path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"})}),Ni=n=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:s.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),mr=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("circle",{cx:"11",cy:"11",r:"8"}),s.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),Ju=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M5 3v4"}),s.jsx("path",{d:"M19 17v4"}),s.jsx("path",{d:"M3 5h4"}),s.jsx("path",{d:"M17 19h4"}),s.jsx("path",{d:"M9 21a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2"}),s.jsx("path",{d:"M15 3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2"})]}),fs=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"}),s.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),Xl=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7"}),s.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),s.jsx("path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4"}),s.jsx("path",{d:"M2 7h20"}),s.jsx("path",{d:"M12 7v5"})]}),X1=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1Z"}),s.jsx("path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"}),s.jsx("path",{d:"M12 17.5v-11"})]}),t4=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),s.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),s.jsx("path",{d:"M12 11v6"}),s.jsx("path",{d:"M9 14h6"})]}),Ml=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}),s.jsx("path",{d:"M21 3v5h-5"}),s.jsx("path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}),s.jsx("path",{d:"M3 21v-5h5"})]}),$s=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),s.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),Zr=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),s.jsx("polyline",{points:"17 8 12 3 7 8"}),s.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),d0=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),s.jsx("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),s.jsx("line",{x1:"6",y1:"20",x2:"6",y2:"14"})]}),ei=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),s.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),s.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),s.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),Jl=n=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:s.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),vZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2"}),s.jsx("rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2"}),s.jsx("line",{x1:"6",x2:"6.01",y1:"6",y2:"6"}),s.jsx("line",{x1:"6",x2:"6.01",y1:"18",y2:"18"})]}),pO=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M12 20h.01"}),s.jsx("path",{d:"M2 8.82a15 15 0 0 1 20 0"}),s.jsx("path",{d:"M5 12.859a10 10 0 0 1 14 0"}),s.jsx("path",{d:"M8.5 16.429a5 5 0 0 1 7 0"})]}),wZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("line",{x1:"2",y1:"2",x2:"22",y2:"22"}),s.jsx("path",{d:"M8.5 16.429a5 5 0 0 1 7 0"}),s.jsx("path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69"}),s.jsx("path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523"}),s.jsx("path",{d:"M2 8.82a15 15 0 0 1 4.17-2.692"}),s.jsx("path",{d:"M22 8.82a15 15 0 0 0-11.288-3.136"}),s.jsx("path",{d:"M12 20h.01"})]}),Yj=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),s.jsx("path",{d:"M12 9v4"}),s.jsx("path",{d:"M12 17h.01"})]}),Rr=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("circle",{cx:"8",cy:"21",r:"1"}),s.jsx("circle",{cx:"19",cy:"21",r:"1"}),s.jsx("path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"})]}),Si=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"}),s.jsx("path",{d:"M7 2v20"}),s.jsx("path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"})]}),Qr=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),s.jsx("circle",{cx:"9",cy:"9",r:"2"}),s.jsx("path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"})]}),xO=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("circle",{cx:"12",cy:"12",r:"10"}),s.jsx("path",{d:"m15 9-6 6"}),s.jsx("path",{d:"m9 9 6 6"})]}),Zu=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("rect",{width:"20",height:"12",x:"2",y:"6",rx:"2"}),s.jsx("circle",{cx:"12",cy:"12",r:"2"}),s.jsx("path",{d:"M6 12h.01M18 12h.01"})]}),hs=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M5 12h14"}),s.jsx("path",{d:"M12 5v14"})]}),Xj=n=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:s.jsx("path",{d:"M5 12h14"})}),ks=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("rect",{width:"7",height:"7",x:"3",y:"3",rx:"1"}),s.jsx("rect",{width:"7",height:"7",x:"14",y:"3",rx:"1"}),s.jsx("rect",{width:"7",height:"7",x:"14",y:"14",rx:"1"}),s.jsx("rect",{width:"7",height:"7",x:"3",y:"14",rx:"1"})]}),qi=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),s.jsx("circle",{cx:"12",cy:"13",r:"4"})]}),Yi=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"}),s.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),Io=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24"}),s.jsx("path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"}),s.jsx("path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"}),s.jsx("line",{x1:"2",x2:"22",y1:"2",y2:"22"})]}),_Z=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2"}),s.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]}),J1=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("rect",{width:"20",height:"16",x:"2",y:"4",rx:"2"}),s.jsx("path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"})]}),hb=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),s.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),NZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("polyline",{points:"9 11 12 14 22 4"}),s.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})]}),jZ=n=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:s.jsx("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"})}),Ar=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7"}),s.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),s.jsx("path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4"})]}),ti=n=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:s.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})}),Jj=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("circle",{cx:"13.5",cy:"6.5",r:".5"}),s.jsx("circle",{cx:"17.5",cy:"10.5",r:".5"}),s.jsx("circle",{cx:"8.5",cy:"7.5",r:".5"}),s.jsx("circle",{cx:"6.5",cy:"12.5",r:".5"}),s.jsx("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"})]}),SZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2"}),s.jsx("path",{d:"M12 18h.01"})]}),en=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"}),s.jsx("path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"}),s.jsx("path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"}),s.jsx("path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"})]}),Ag=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"}),s.jsx("path",{d:"M13 5v2"}),s.jsx("path",{d:"M13 17v2"}),s.jsx("path",{d:"M13 11v2"})]}),ur=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}),s.jsx("path",{d:"m9 12 2 2 4-4"})]}),Ay=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("circle",{cx:"8",cy:"8",r:"6"}),s.jsx("path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18"}),s.jsx("path",{d:"M7 6h1v4"}),s.jsx("path",{d:"m16.71 13.88.7 .71-2.82 2.82"})]}),bO=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),s.jsx("polyline",{points:"17 6 23 6 23 12"})]}),EZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("polyline",{points:"23 18 13.5 8.5 8.5 13.5 1 6"}),s.jsx("polyline",{points:"17 18 23 18 23 12"})]}),Ei=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3"}),s.jsx("path",{d:"M14 19a6 6 0 0 0-9.33-5"})]}),yO=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),s.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),Zj=n=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:s.jsx("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"})}),Xi=n=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:s.jsx("path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14"})}),Mo=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),s.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),TZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),s.jsx("polyline",{points:"7 10 12 15 17 10"}),s.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),eh=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("polyline",{points:"9 17 4 12 9 7"}),s.jsx("path",{d:"M20 18v-2a4 4 0 0 0-4-4H4"})]}),n4=n=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:s.jsx("path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"})}),vO=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("circle",{cx:"12",cy:"12",r:"10"}),s.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),s.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),IZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),s.jsx("polyline",{points:"12 5 19 12 12 19"})]}),CZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2"}),s.jsx("rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2"}),s.jsx("line",{x1:"6",x2:"6.01",y1:"6",y2:"6"}),s.jsx("line",{x1:"6",x2:"6.01",y1:"18",y2:"18"})]}),AZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),s.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),s.jsx("polyline",{points:"7 3 7 8 15 8"})]}),y_=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),s.jsx("path",{d:"M12 9v4"}),s.jsx("path",{d:"M12 17h.01"})]}),kZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),s.jsx("path",{d:"M3 3v5h5"})]}),RZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("polyline",{points:"20 12 20 22 4 22 4 12"}),s.jsx("rect",{width:"20",height:"5",x:"2",y:"7"}),s.jsx("line",{x1:"12",x2:"12",y1:"22",y2:"7"}),s.jsx("path",{d:"M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"}),s.jsx("path",{d:"M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"})]}),Ah=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("line",{x1:"6",x2:"10",y1:"12",y2:"12"}),s.jsx("line",{x1:"8",x2:"8",y1:"10",y2:"14"}),s.jsx("line",{x1:"15",x2:"15.01",y1:"13",y2:"13"}),s.jsx("line",{x1:"18",x2:"18.01",y1:"11",y2:"11"}),s.jsx("rect",{width:"20",height:"12",x:"2",y:"6",rx:"2"})]}),DZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),s.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),PZ=n=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[s.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),s.jsx("polyline",{points:"15 3 21 3 21 9"}),s.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]}),ky=({className:n,...e})=>s.jsx("div",{className:`rounded-full overflow-hidden ${n}`,children:s.jsx("img",{src:hZ,alt:"Vodafone Cash",className:"w-full h-full object-cover",...e})}),wO=({status:n})=>{const t=(()=>{switch(n){case ue.WaitingMerchant:return{style:"bg-purple-500/10 text-purple-400 border-purple-500/20 shadow-[0_0_10px_rgba(168,85,247,0.15)]",icon:s.jsx(It,{className:"w-3.5 h-3.5"})};case ue.Preparing:return{style:"bg-orange-500/10 text-orange-400 border-orange-500/20 shadow-[0_0_10px_rgba(249,115,22,0.15)]",icon:s.jsx(Si,{className:"w-3.5 h-3.5"})};case ue.Pending:return{style:"bg-yellow-500/10 text-yellow-400 border-yellow-500/20 shadow-[0_0_10px_rgba(234,179,8,0.15)]",icon:s.jsx(Rr,{className:"w-3.5 h-3.5"})};case ue.InTransit:return{style:"bg-blue-500/10 text-blue-400 border-blue-500/20 shadow-[0_0_10px_rgba(59,130,246,0.15)]",icon:s.jsx(Zt,{className:"w-3.5 h-3.5"})};case ue.Delivered:return{style:"bg-teal-500/10 text-teal-400 border-teal-500/20 shadow-[0_0_10px_rgba(45,212,191,0.15)]",icon:s.jsx(Je,{className:"w-3.5 h-3.5"})};case ue.Cancelled:return{style:"bg-red-500/10 text-red-400 border-red-500/20 shadow-[0_0_10px_rgba(239,68,68,0.15)]",icon:s.jsx(ut,{className:"w-3.5 h-3.5"})};default:return{style:"bg-gray-500/10 text-gray-400 border-gray-500/20",icon:s.jsx(It,{className:"w-3.5 h-3.5"})}}})();return s.jsxs("span",{className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg border text-[10px] font-bold tracking-wide transition-all duration-300 backdrop-blur-sm ${t.style}`,children:[t.icon,n]})},OZ=({order:n,className:e="",showHash:t=!0})=>{const r=t?`#${n.id}`:n.id;return n.isArchived&&n.archiveMonth?s.jsxs("span",{className:e,children:[r,s.jsxs("span",{className:"text-[0.7em] opacity-70 ml-1",children:["(",n.archiveMonth,")"]})]}):s.jsx("span",{className:e,children:r})},MZ=Rn.memo(({order:n,users:e,onEdit:t,onDelete:r,onOpenStatusModal:i,onOpenPaymentModal:o})=>{var H,G,z,P,j,O;const[c,u]=w.useState(null),[h,m]=w.useState(null);w.useEffect(()=>{n.driverId&&!e.find(I=>I.id===n.driverId)&&!c&&Cg(n.driverId).then(I=>{I.success&&I.data&&u(I.data)})},[n.driverId,e]),w.useEffect(()=>{n.merchantId&&n.merchantId!=="delinow"&&!e.find(I=>I.id===n.merchantId)&&!h&&Cg(n.merchantId).then(I=>{I.success&&I.data&&m(I.data)})},[n.merchantId,e]);const p=e.find(I=>I.id===n.driverId),b=w.useMemo(()=>{let I=(p==null?void 0:p.name)||(c==null?void 0:c.name)||n.driverName;return I&&n.driverId&&I===n.driverId&&(I=void 0),{name:I,phone:(p==null?void 0:p.phone)||(c==null?void 0:c.phone)||n.driverPhone,storeImage:(p==null?void 0:p.storeImage)||(c==null?void 0:c.storeImage)||n.driverImage,exists:!!(p||c||I&&I!==n.driverId||n.driverPhone)}},[p,c,n]),v=e.find(I=>I.id===n.merchantId),_=w.useMemo(()=>{let I=(v==null?void 0:v.name)||(h==null?void 0:h.name)||n.merchantName;return I&&n.merchantId&&I===n.merchantId&&(I=void 0),{name:I,phone:(v==null?void 0:v.phone)||(h==null?void 0:h.phone)||n.merchantPhone,storeImage:(v==null?void 0:v.storeImage)||(h==null?void 0:h.storeImage)||n.merchantImage,isDelinow:n.merchantId==="delinow"}},[v,h,n]),T=w.useMemo(()=>e.find(I=>{var R;return I.phone===((R=n.customer)==null?void 0:R.phone)}),[e,(H=n.customer)==null?void 0:H.phone]),k=n.type==="shopping_order",E=I=>{try{if(!I)return null;let R;return typeof I.toDate=="function"?R=I.toDate():I.seconds?R=new Date(I.seconds*1e3):R=new Date(I),isNaN(R.getTime())?null:R}catch{return null}},S=w.useMemo(()=>{const I=E(n.createdAt);if(!I)return{date:"---",time:"---",day:"---"};const R=I.toLocaleDateString("ar-EG-u-nu-latn",{weekday:"long"}),F=I.toLocaleDateString("ar-EG-u-nu-latn",{day:"numeric",month:"numeric",year:"numeric"}),M=I.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric",hour12:!0});return{day:R,date:F,time:M}},[n.createdAt]),L=w.useMemo(()=>{if(n.status!==ue.Delivered||!n.deliveredAt)return null;const I=E(n.deliveredAt);return I?I.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric",hour12:!0}):null},[n.status,n.deliveredAt]),$=()=>{if(k)return"border-orange-500";switch(n.status){case ue.Delivered:return"border-teal-500";case ue.InTransit:return"border-blue-500";case ue.Cancelled:return"border-red-500";case ue.Pending:return"border-yellow-500";default:return"border-gray-500"}};return s.jsxs("div",{className:`relative bg-gray-800 rounded-xl shadow-lg border-r-4 ${$()} overflow-hidden admin-order-card transform-gpu will-change-transform`,children:[s.jsxs("div",{className:"p-4 border-b border-gray-700/50 flex justify-between items-start bg-gray-900/30",children:[s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(OZ,{order:n,className:"font-mono text-xl font-black text-red-500 tracking-tighter",showHash:!1}),n.customOrderNumber&&s.jsxs("div",{className:"bg-white/10 text-white px-2 py-0.5 rounded text-sm font-bold font-mono border border-white/10",children:["#",n.customOrderNumber]}),n.isCollected?s.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 rounded text-[10px] font-bold bg-blue-500/20 text-blue-400 border border-blue-500/20",children:[s.jsx(Je,{className:"w-3 h-3"})," "]}):n.isVodafoneCash?s.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 rounded text-[10px] font-bold bg-purple-500/20 text-purple-400 border border-purple-500/20",children:[s.jsx(Je,{className:"w-3 h-3"})," "]}):n.paymentStatus==="paid"?s.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 rounded text-[10px] font-bold bg-emerald-500/20 text-emerald-400 border border-emerald-500/20",children:[s.jsx(Je,{className:"w-3 h-3"}),""]}):null,k&&s.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 rounded text-[10px] font-bold bg-orange-500/20 text-orange-400 border border-orange-500/20",children:[s.jsx(en,{className:"w-3 h-3"})," "]})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-700/60 px-2 py-1 rounded border border-white/5 shadow-inner",children:[s.jsx(ei,{className:"w-3.5 h-3.5 text-blue-400"}),s.jsxs("span",{className:"text-[11px] font-black text-white",children:[S.day," ",S.date]})]}),s.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-700/60 px-2 py-1 rounded border border-white/5 shadow-inner",children:[s.jsx(It,{className:"w-3.5 h-3.5 text-yellow-400"}),s.jsx("span",{className:"text-[11px] font-black text-white font-mono",children:S.time})]}),L&&s.jsxs("div",{className:"flex items-center gap-1.5 bg-teal-500/10 px-2 py-1 rounded border border-teal-500/20 shadow-inner animate-fadeIn",children:[s.jsx(Je,{className:"w-3.5 h-3.5 text-teal-400"}),s.jsxs("span",{className:"text-[11px] font-black text-teal-400 font-mono",children:[": ",L]})]})]})]}),s.jsx("div",{className:"flex flex-col items-end gap-1",children:s.jsx(wO,{status:n.status})})]}),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex flex-col bg-gray-900/20 rounded-xl p-3 border border-white/5",children:[s.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[s.jsx("div",{className:"mt-1 p-1.5 rounded-full bg-blue-500/10 text-blue-400 flex-shrink-0",children:s.jsx(_t,{className:"w-4 h-4"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"text-[10px] text-gray-500 mb-0.5 flex items-center gap-1",children:[s.jsx(fs,{className:"w-3 h-3"}),"  "]}),s.jsx("p",{className:"text-white font-bold text-sm leading-snug break-words",children:((G=n.customer)==null?void 0:G.address)||"  "})]})]}),s.jsx("div",{className:"flex justify-end pt-2 border-t border-gray-700/30",children:s.jsxs("div",{className:"flex items-center gap-2",dir:"ltr",children:[((z=n.customer)==null?void 0:z.phone)&&s.jsx("a",{href:`https://wa.me/2${n.customer.phone}`,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 flex-shrink-0 bg-green-500/10 text-green-400 rounded-lg hover:bg-green-500/20 transition-all border border-green-500/10 clickable",title:"",children:s.jsx(nd,{className:"w-3.5 h-3.5"})}),((P=n.customer)==null?void 0:P.phone)&&s.jsx("a",{href:`tel:${n.customer.phone}`,className:"p-1.5 flex-shrink-0 bg-blue-500/10 text-blue-400 rounded-lg hover:bg-blue-500/20 transition-all border border-blue-500/10 clickable",title:"",children:s.jsx(zn,{className:"w-3.5 h-3.5"})}),s.jsx("span",{className:"text-xs text-gray-300 font-mono bg-black/20 px-2 py-1 rounded border border-gray-700 selectable font-bold tracking-wide",children:((j=n.customer)==null?void 0:j.phone)||""})]})})]}),s.jsxs("div",{className:"flex flex-col bg-orange-900/10 p-3 rounded-xl border border-orange-500/10",children:[s.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[s.jsx("div",{className:"mt-1 rounded-full bg-orange-500/10 text-orange-400 flex-shrink-0 overflow-hidden w-8 h-8 flex items-center justify-center border border-orange-500/20",children:_.isDelinow?T!=null&&T.storeImage?s.jsx("img",{src:T.storeImage,alt:"Customer",className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-4 h-4"}):_.storeImage?s.jsx("img",{src:_.storeImage,alt:_.name,className:"w-full h-full object-cover rounded-full"}):s.jsx(Ar,{className:"w-4 h-4"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-[10px] text-orange-400 font-bold mb-0.5",children:_.isDelinow?" ":" ()"}),s.jsx("p",{className:"text-white font-black text-sm truncate",children:_.isDelinow?(T==null?void 0:T.name)||((O=n.customer)==null?void 0:O.name)||"  ":_.name||" "})]})]}),s.jsx("div",{className:"mt-2 text-sm text-gray-300 border-t border-orange-500/10 pt-2 space-y-1",children:n.merchantId==="delinow"?s.jsxs("div",{className:"bg-gray-900/40 p-2 rounded-lg border border-gray-700/30",children:[s.jsx("p",{className:"text-[10px] text-gray-500 font-bold mb-1",children:"  :"}),s.jsx("p",{className:"text-white leading-relaxed whitespace-pre-wrap text-xs",children:n.notes||"  "})]}):s.jsxs("div",{className:"space-y-1.5",children:[n.notes&&s.jsxs("div",{className:"bg-gray-900/40 p-2 rounded-lg border border-gray-700/30 mb-2",children:[s.jsx("p",{className:"text-[10px] text-orange-400 font-bold mb-1",children:" :"}),s.jsx("p",{className:"text-white leading-relaxed whitespace-pre-wrap text-xs",children:n.notes})]}),n.items&&n.items.length>0?s.jsxs(s.Fragment,{children:[n.items.map((I,R)=>s.jsxs("div",{className:"flex justify-between items-center text-xs bg-gray-900/40 p-1.5 rounded border border-gray-700/30",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"font-bold text-orange-400 font-mono",children:["x",I.quantity]}),s.jsx("span",{className:"text-white",children:I.name}),I.selectedSize&&s.jsxs("span",{className:"text-[9px] text-gray-500",children:["(",I.selectedSize.name,")"]})]}),s.jsxs("span",{className:"text-gray-400 font-mono font-bold",children:[(I.price*I.quantity).toLocaleString()," ."]})]},R)),s.jsxs("div",{className:"flex justify-between items-center pt-1 mt-1 border-t border-gray-700/30 font-bold text-xs",children:[s.jsx("span",{className:"text-gray-400",children:":"}),s.jsxs("div",{className:"flex items-center gap-2",children:[(n.discount||n.originalPrice&&n.originalPrice>n.totalPrice)&&s.jsx("span",{className:"text-red-400 line-through text-[10px]",children:(n.originalPrice||n.totalPrice+(n.discount||0)).toLocaleString()}),s.jsxs("span",{className:"text-white",children:[n.totalPrice.toLocaleString()," ."]})]})]})]}):null]})}),!_.isDelinow&&(_.phone||n.merchantId)&&s.jsx("div",{className:"flex justify-end pt-2 border-t border-orange-500/10 mt-1",children:s.jsxs("div",{className:"flex items-center gap-2",dir:"ltr",children:[_.phone&&s.jsx("a",{href:`https://wa.me/2${_.phone}`,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 flex-shrink-0 bg-green-500/10 text-green-400 rounded-lg hover:bg-green-500/20 transition-all border border-green-500/10 clickable",title:"",children:s.jsx(nd,{className:"w-3.5 h-3.5"})}),_.phone&&s.jsx("a",{href:`tel:${_.phone}`,className:"p-1.5 flex-shrink-0 bg-blue-500/10 text-blue-400 rounded-lg hover:bg-blue-500/20 transition-all border border-blue-500/10 clickable",title:"",children:s.jsx(zn,{className:"w-3.5 h-3.5"})}),s.jsx("span",{className:"text-xs text-gray-300 font-mono bg-black/20 px-2 py-1 rounded border border-gray-700 selectable font-bold tracking-wide",children:_.phone||" "})]})})]}),s.jsxs("div",{className:"grid grid-cols-2 bg-gray-900/40 p-2 rounded-lg border border-gray-700/30",children:[s.jsx("div",{className:"flex flex-col justify-center pl-3",children:b.exists?s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 border border-gray-600 flex items-center justify-center overflow-hidden flex-shrink-0",children:b.storeImage?s.jsx("img",{src:b.storeImage,alt:b.name||"Driver",className:"w-full h-full object-cover rounded-full"}):s.jsx(_t,{className:"w-4 h-4 text-gray-400"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"text-[9px] text-gray-500 mb-0.5",children:""}),s.jsx("p",{className:"text-white text-xs font-bold truncate leading-tight",children:b.name||""})]})]}),b.phone&&s.jsxs("div",{className:"flex items-center gap-1 w-full",dir:"ltr",children:[s.jsx("a",{href:`https://wa.me/2${b.phone}`,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 flex-shrink-0 bg-green-500/10 text-green-400 rounded-lg hover:bg-green-500/20 transition-all border border-green-500/10 clickable",title:"",children:s.jsx(nd,{className:"w-3.5 h-3.5"})}),s.jsx("a",{href:`tel:${b.phone}`,className:"p-1.5 flex-shrink-0 bg-blue-500/10 text-blue-400 rounded-lg hover:bg-blue-500/20 transition-all border border-blue-500/10 clickable",title:"",children:s.jsx(zn,{className:"w-3.5 h-3.5"})}),s.jsx("span",{className:"text-[9px] text-gray-300 font-mono bg-black/20 px-1.5 py-1 rounded border border-gray-700 selectable font-bold truncate overflow-hidden flex-1 text-center",children:b.phone})]})]}):n.driverId?s.jsxs("div",{className:"flex items-center gap-2 h-full",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 border border-gray-700 flex items-center justify-center flex-shrink-0",children:s.jsx(_t,{className:"w-4 h-4 text-gray-400"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"text-[9px] text-gray-500 mb-0.5",children:" ( )"}),s.jsx("p",{className:"text-white text-xs font-bold truncate",children:n.driverName&&n.driverName!==n.driverId?n.driverName:" ..."})]})]}):s.jsxs("div",{className:"flex items-center gap-2 h-full",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 border border-gray-700 flex items-center justify-center flex-shrink-0",children:s.jsx(Zt,{className:"w-4 h-4 text-gray-500"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"text-[9px] text-gray-500 mb-0.5",children:""}),s.jsx("p",{className:"text-white text-xs font-bold truncate",children:" "})]})]})}),s.jsxs("div",{className:"flex flex-col gap-3 border-r border-gray-700 pr-4 pl-1 justify-center",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-amber-500/10 border border-amber-500/20 flex items-center justify-center flex-shrink-0",children:s.jsx(Ed,{className:"w-4 h-4 text-amber-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-[9px] text-gray-500",children:" "}),s.jsx("p",{className:"text-amber-400 text-xs font-bold",children:n.deliveryFee?`${n.deliveryFee.toLocaleString("en-US")} .`:"-"})]})]}),(n.paymentStatus||n.paidAmount!==void 0)&&s.jsxs("button",{onClick:I=>{o&&(I.stopPropagation(),o(n))},disabled:!o,className:`p-2 rounded-lg border flex flex-col items-center justify-center gap-1 min-w-[80px] transition-all
                                    ${n.unpaidAmount&&n.unpaidAmount>0?"bg-red-500/10 border-red-500/30":"bg-gray-700/30 border-gray-600/30 hover:bg-gray-700/50"}
                                `,children:[s.jsx(Ed,{className:`w-4 h-4 ${n.paymentStatus==="paid"||n.isCollected?"text-emerald-400":"text-gray-400"}`}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:n.unpaidAmount&&n.unpaidAmount>0?`${n.unpaidAmount} `:"Manage Payment"})]})]})]})]}),s.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-900/80 border-t border-gray-700/50",children:[i?s.jsxs("button",{onClick:I=>{I.stopPropagation(),i(n)},className:"text-[10px] font-bold bg-gray-700 hover:bg-gray-600 text-white border border-gray-600 rounded-lg px-3 py-1.5 flex items-center transition-all clickable",children:[s.jsx(Js,{className:"w-3.5 h-3.5 ml-1 text-gray-300"}),s.jsx("span",{children:" "})]}):s.jsx("div",{}),s.jsxs("div",{className:"flex items-center gap-1",children:[t&&s.jsx("button",{onClick:I=>{I.stopPropagation(),t(n)},className:"p-2 text-blue-400 hover:text-white hover:bg-blue-600 rounded-lg transition-colors border border-blue-500/20 bg-blue-500/10 clickable",children:s.jsx(Js,{className:"w-4 h-4"})}),r&&s.jsx("button",{onClick:I=>{I.stopPropagation(),I.preventDefault(),r(n)},className:"p-2 text-red-400 hover:bg-red-600 hover:text-white rounded-lg transition-colors border border-red-500/20 bg-red-500/10 clickable",children:s.jsx(Tt,{className:"w-4 h-4"})})]})]})]})}),LZ=({order:n,merchants:e,drivers:t,onClose:r,onSave:i,currentUserRole:o,currentUserPermissions:c,currentUser:u})=>{const h=o==="supervisor",m=!h||(c==null?void 0:c.includes("manage_advanced_financials")),p=e.find(te=>te.id===n.merchantId);p==null||p.canManageAdvancedFinancials;const b=o==="admin"||h&&m,v=o==="admin"||h,[_,T]=w.useState(n.customer||{phone:"",address:""}),[k,E]=w.useState(n.notes||""),[S,L]=w.useState(n.merchantId),[$,H]=w.useState(n.driverId||""),[G,z]=w.useState(n.deliveryFee!==void 0&&n.deliveryFee!==null?n.deliveryFee:""),[P,j]=w.useState(n.items||[]),O=P.length>0?P.reduce((te,me)=>te+me.price*me.quantity,0):n.originalPrice||n.totalPrice||0,[I,R]=w.useState(O),[F,M]=w.useState(n.discount||0),[ne,U]=w.useState(""),A=n.type==="shopping_order"&&P.length>0?"products":"details",[V,Q]=w.useState(A),ae="w-full px-4 py-3 border border-gray-600 bg-[#111] text-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors text-sm";w.useEffect(()=>{if(P.length>0){const te=P.reduce((me,re)=>me+re.price*re.quantity,0);R(te)}},[P]);const X=w.useMemo(()=>{const te=G===""?0:parseFloat(String(G)),me=isNaN(te)?0:te;return Math.max(0,I-F)+me},[I,F,G]),B=(te,me)=>{const re=parseFloat(me);if(isNaN(re))return;const ce=[...P];ce[te]={...ce[te],price:re},j(ce)},Y=()=>{if(!_.phone||!_.address||!S){U("    ."),(!_.phone||!_.address||!S)&&Q("details");return}if(!/^\d{11}$/.test(_.phone)){U("      11 ."),Q("details");return}const te=G!==""?parseFloat(String(G)):null;if(o!=="admin"&&n.status===ue.Pending&&$&&(te==null||te<=0)){U("     (  ).      ."),Q("delivery");return}const me=e.find(he=>he.id===S),re=me?me.name:n.merchantName||"Unknown";U("");const ce={customer:_,notes:k,merchantId:S,merchantName:re,driverId:$||null,deliveryFee:te,totalPrice:Math.max(0,I-F),originalPrice:I,discount:F};n.type==="shopping_order"&&(ce.items=P),i(ce)},ge=te=>{T({..._,[te.target.name]:te.target.value})},Z=(te,me,re,ce=!0)=>{if(!ce)return null;const he=V===te;return s.jsxs("button",{onClick:()=>Q(te),className:`flex-1 py-3 px-2 text-center text-xs font-bold transition-all border-b-2 flex items-center justify-center gap-2 ${he?"border-blue-500 text-blue-400 bg-[#1f2937]":"border-transparent text-gray-500 hover:text-gray-300 hover:bg-[#1f2937]/50"}`,children:[re,me]})};return s.jsxs("div",{className:"fixed inset-0 z-[200] bg-[#111827] flex flex-col",children:[s.jsxs("div",{className:"flex-none bg-[#1f2937] border-b border-gray-700 flex items-center justify-between px-4 pt-8 pb-4 min-h-[90px] shadow-xl z-20",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:r,className:"bg-gray-800 p-2 rounded-full text-gray-400 hover:text-white transition-colors border border-gray-700",children:s.jsx(us,{className:"w-5 h-5 rotate-180"})}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-base font-bold text-white flex items-center gap-2",children:[s.jsx(Js,{className:"w-4 h-4 text-blue-400"})," "]}),s.jsxs("p",{className:"font-mono text-[10px] text-blue-300 opacity-80 tracking-wider",children:["#",n.id.slice(0,8)]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"hidden md:block text-right",children:[s.jsx("p",{className:"text-[10px] text-gray-400",children:""}),s.jsxs("p",{className:"text-sm font-bold text-green-400 font-mono",children:[X.toLocaleString()," ."]})]}),s.jsxs("button",{onClick:Y,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-xl transition-all shadow-lg active:scale-95 text-sm flex items-center gap-2",children:[s.jsx(Je,{className:"w-4 h-4"}),""]})]})]}),s.jsxs("div",{className:"flex-none bg-[#111] border-b border-gray-800 flex sticky top-0 z-10",children:[Z("details","",s.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"})),Z("products","",s.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500"}),n.type==="shopping_order"),Z("delivery","",s.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}))]}),s.jsx("div",{className:"flex-1 overflow-y-auto bg-[#111827] relative",children:s.jsxs("div",{className:"p-4 pb-12 space-y-4",children:[ne&&s.jsx("div",{className:"bg-red-900/20 p-3 rounded-xl border border-red-500/50 text-center animate-bounce mb-4",children:s.jsx("p",{className:"text-red-400 text-xs font-bold",children:ne})}),V==="details"&&s.jsx("div",{className:"space-y-4 animate-fadeIn",children:s.jsxs("div",{className:"bg-[#1f2937] p-4 rounded-2xl border border-gray-700",children:[s.jsx("h4",{className:"text-xs font-bold text-gray-400 mb-4 uppercase tracking-wider",children:"  "}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1.5 font-bold",children:""}),s.jsxs("select",{value:S,onChange:te=>L(te.target.value),className:ae,required:!0,children:[s.jsx("option",{value:"",disabled:!0,children:"--   --"}),e.map(te=>s.jsx("option",{value:te.id,children:te.name},te.id))]})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1.5 font-bold",children:" "}),s.jsx("input",{type:"tel",name:"phone",value:_.phone,onChange:ge,className:`${ae} font-mono text-center text-lg tracking-widest`,required:!0,dir:"ltr"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1.5 font-bold",children:" "}),s.jsx("input",{type:"text",name:"address",value:_.address,onChange:ge,className:ae,required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1.5 font-bold",children:" "}),s.jsx("textarea",{value:k,onChange:te=>E(te.target.value),rows:3,className:`${ae} resize-none`})]}),P.length===0&&s.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-gray-700 mt-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:`block text-xs mb-1.5 font-bold ${b?"text-red-400":"text-gray-600"}`,children:"  ( )"}),s.jsx("input",{type:"number",value:I,onChange:te=>R(parseFloat(te.target.value)||0),className:`${ae} ${b?"":"opacity-50 cursor-not-allowed bg-gray-900 border-gray-800 text-gray-500"}`,placeholder:"0.00",disabled:!b}),!b&&s.jsx("p",{className:"text-[9px] text-red-500 mt-1",children:"*    "})]}),s.jsxs("div",{children:[s.jsx("label",{className:`block text-xs mb-1.5 font-bold ${b?"text-yellow-500":"text-gray-600"}`,children:""}),s.jsx("input",{type:"number",value:F,onChange:te=>M(parseFloat(te.target.value)||0),className:`${ae} ${b?"":"opacity-50 cursor-not-allowed bg-gray-900 border-gray-800 text-gray-500"}`,placeholder:"0.00",disabled:!b})]})]})]})]})}),V==="products"&&s.jsxs("div",{className:"space-y-3 animate-fadeIn",children:[s.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/20 p-3 rounded-xl flex justify-between items-center mb-2",children:[s.jsx("span",{className:"text-yellow-500 text-xs font-bold",children:"    "}),s.jsxs("span",{className:"text-white font-mono text-sm font-bold bg-yellow-500/20 px-2 py-1 rounded",children:[I.toLocaleString()," ."]})]}),s.jsxs("div",{className:"bg-[#1f2937] p-3 rounded-xl border border-gray-700 flex justify-between items-center mb-2",children:[s.jsx("label",{className:`text-xs font-bold ${b?"text-gray-400":"text-gray-500"}`,children:" "}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"number",value:F,onChange:te=>M(parseFloat(te.target.value)||0),disabled:!b,className:`w-24 border rounded-lg py-1 px-2 text-center font-bold ${b?"bg-[#111] border-gray-600 text-white":"bg-gray-900 border-gray-800 text-gray-500 cursor-not-allowed"}`}),s.jsx("span",{className:"text-xs text-gray-500",children:"."})]})]}),P.map((te,me)=>s.jsxs("div",{className:"flex items-center gap-3 bg-[#1f2937] p-3 rounded-xl border border-gray-700 shadow-sm",children:[s.jsx("div",{className:"w-14 h-14 bg-[#111] rounded-lg overflow-hidden flex-shrink-0 border border-gray-600",children:te.image?s.jsx("img",{src:te.image,alt:te.name,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:s.jsx(Qr,{className:"w-5 h-5"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-white text-sm font-bold truncate",children:te.name}),s.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[": ",s.jsx("span",{className:"text-blue-300 font-mono font-bold",children:te.quantity})]})]}),s.jsxs("div",{className:"w-24",children:[s.jsx("label",{className:"text-[9px] text-gray-500 block mb-1 text-center",children:""}),s.jsx("input",{type:"number",value:te.price,onChange:re=>B(me,re.target.value),disabled:!b,className:`w-full border text-sm rounded-lg py-2 text-center font-bold ${b?"bg-[#111] border-gray-600 text-white focus:border-yellow-500 focus:outline-none":"bg-gray-900 border-gray-800 text-gray-500 cursor-not-allowed"}`})]})]},me))]}),V==="delivery"&&s.jsxs("div",{className:"space-y-4 animate-fadeIn",children:[s.jsxs("div",{className:"bg-[#1f2937] p-4 rounded-xl border border-gray-700",children:[s.jsx("label",{className:`block text-xs mb-2 font-bold uppercase ${v?"text-gray-400":"text-gray-600"}`,children:"  (EGP)"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"tel",inputMode:"numeric",lang:"en",value:G,onChange:te=>{const me=te.target.value.replace(/[^0-9.]/g,"");z(me)},placeholder:"0",dir:"ltr",disabled:!v,className:`w-full border text-xl font-bold py-3 px-4 pl-12 rounded-xl font-mono ${v?"bg-[#111] border-gray-600 text-white focus:border-blue-500 focus:outline-none":"bg-gray-900 border-gray-800 text-gray-500 cursor-not-allowed"}`,style:{fontFamily:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'}}),s.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-bold text-xs",children:"EGP"})]}),!v&&s.jsx("p",{className:"text-[10px] text-red-500 mt-2 font-bold",children:"*      "})]}),s.jsxs("div",{className:"bg-[#1f2937] p-4 rounded-xl border border-gray-700 flex-1 flex flex-col",children:[s.jsxs("h4",{className:"text-xs font-bold text-gray-400 mb-3 uppercase tracking-wider flex justify-between items-center",children:[s.jsx("span",{children:" "}),s.jsxs("span",{className:"text-[10px] bg-gray-700 px-2 py-0.5 rounded-full text-white",children:[t.length," "]})]}),s.jsxs("div",{className:"space-y-2 max-h-[400px] overflow-y-auto custom-scrollbar",children:[s.jsxs("button",{onClick:()=>H(""),className:`w-full flex justify-between items-center text-right p-3 rounded-xl transition-all border ${$===""?"bg-red-500/10 border-red-500/50":"bg-[#111] border-gray-800 hover:border-gray-600"}`,children:[s.jsx("span",{className:`text-sm font-bold ${$===""?"text-red-400":"text-gray-400"}`,children:"  ()"}),$===""&&s.jsx(Je,{className:"w-5 h-5 text-red-500"})]}),t.map(te=>s.jsxs("button",{onClick:()=>H(te.id),className:`w-full flex justify-between items-center text-right p-3 rounded-xl transition-all border ${$===te.id?"bg-blue-600 border-blue-500 shadow-lg scale-[1.01]":"bg-[#111] border-gray-800 hover:border-gray-500"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs ${$===te.id?"bg-white text-blue-600":"bg-gray-800 text-gray-400"}`,children:te.name.charAt(0)}),s.jsxs("div",{children:[s.jsx("span",{className:`font-bold text-sm block ${$===te.id?"text-white":"text-gray-200"}`,children:te.name}),s.jsx("span",{className:`text-[10px] font-mono ${$===te.id?"text-blue-100":"text-gray-500"}`,children:te.phone})]})]}),$===te.id&&s.jsx(Je,{className:"w-5 h-5 text-white"})]},te.id))]})]})]})]})})]})};var Jh=S4();const fb=n=>{try{const e=new Set;return JSON.stringify(n,(t,r)=>{if(typeof r=="object"&&r!==null){if(e.has(r))return"[Circular]";e.add(r)}return r})}catch{return"{}"}},Pc=[],Pn={isAndroid:()=>typeof window>"u"?!1:!!window.Android||navigator.userAgent.includes("GOO_NATIVE_APP"),subscribeBackHandler:n=>{const e=Pc.indexOf(n);return e>-1&&Pc.splice(e,1),Pc.push(n),()=>{const t=Pc.indexOf(n);t>-1&&Pc.splice(t,1)}},handleBackPress:()=>{for(let n=Pc.length-1;n>=0;n--){const e=Pc[n];if(e&&typeof e=="function"&&e())return console.log(`[NativeBridge] Back press handled by listener at index ${n}`),!0}return console.log("[NativeBridge] Back press NOT handled by any listener. Default Android behavior."),!1},showNotification:(n,e)=>{var t;if(Pn.isAndroid())try{(t=window.Android)==null||t.showAndroidNotification(n,e)}catch{}},playSound:()=>{var n,e;Pn.isAndroid()&&((e=(n=window.Android)==null?void 0:n.playNotificationSound)==null||e.call(n))},reportContext:n=>{var e,t;Pn.isAndroid()&&((t=(e=window.Android)==null?void 0:e.onContextChange)==null||t.call(e,n))},loginSuccess:n=>{var e,t;Pn.isAndroid()&&(console.log("[NativeBridge] Reporting Login Success to Android"),(t=(e=window.Android)==null?void 0:e.onLoginSuccess)==null||t.call(e,fb(n)))},hideSplashScreen:()=>{console.log("NativeBridge: Requesting Splash Hide"),typeof window<"u"&&window.AndroidSplash&&(console.log("[NativeBridge] Hiding Native Splash Screen"),window.AndroidSplash.hideSplash())}};typeof window<"u"&&(window.handleAndroidBack=Pn.handleBackPress,window.onBackPressed=Pn.handleBackPress);const u0=(n,e,t)=>{var r,i,o,c,u,h,m,p,b,v,_,T,k,E;if(Pn.isAndroid()){console.log(`[NativeBridge] Configuring Role: ${n}, ID: ${e}, Status: ${t}`),(i=(r=window.Android)==null?void 0:r.setAppRole)==null||i.call(r,n);let S=n;n==="customer"&&(S="user");const L=["admin","drivers","merchants","users","driver","merchant","user","supervisor","supervisors","admin_v2","drivers_v2","merchants_v2","users_v2","supervisors_v2","all_users_v2"];if(e&&L.push(`${S}_${e}_v2`),L.forEach(G=>{var z;if((z=window.Android)!=null&&z.unsubscribeFromTopic)try{window.Android.unsubscribeFromTopic(G)}catch{}}),t==="suspended"){console.log("[NativeBridge] User suspended. Aborting subscription logic.");return}if(S==="merchant"&&e){const G=`driver_${e}`;(c=(o=window.Android)==null?void 0:o.unsubscribeFromTopic)==null||c.call(o,G)}if(S==="driver"&&e){const G=`merchant_${e}`;(h=(u=window.Android)==null?void 0:u.unsubscribeFromTopic)==null||h.call(u,G)}const $=[];let H="";if(S==="admin"?H="admin_v2":H=S+"s_v2",H&&((p=(m=window.Android)==null?void 0:m.subscribeToTopic)==null||p.call(m,H),$.push(H)),e){const G=`${S}_${e}_v2`;(v=(b=window.Android)==null?void 0:b.subscribeToTopic)==null||v.call(b,G),(T=(_=window.Android)==null?void 0:_.setActiveNotificationChannel)==null||T.call(_,G),$.push(G)}(E=(k=window.Android)==null?void 0:k.subscribeToTopic)==null||E.call(k,"all_users_v2"),$.push("all_users_v2"),console.log(`[NativeBridge] Active Notification Channels: ${$.join(", ")}`)}},Fc=(n,e)=>{var t,r;Pn.isAndroid()&&(console.log(`[NativeBridge] Logging out from Android Native layer. ID: ${n}, Role: ${e}`),(r=(t=window.Android)==null?void 0:t.onLogout)==null||r.call(t,n,e))},sn=(n,e=[])=>{const t=w.useRef(n);w.useEffect(()=>{t.current=n},[n]),w.useEffect(()=>{const r=()=>t.current(),i=Pn.subscribeBackHandler(r);return()=>{i()}},e)},jn=({title:n,message:e,onClose:t,onConfirm:r,confirmButtonText:i="",cancelButtonText:o="",confirmVariant:c="primary"})=>{const[u,h]=w.useState(!1);w.useEffect(()=>{requestAnimationFrame(()=>h(!0))},[]),sn(()=>(m(),!0));const m=()=>{h(!1),setTimeout(t,200)},p=()=>{h(!1),setTimeout(r,200)},b=()=>{switch(c){case"danger":return s.jsx(Tt,{className:"w-8 h-8 text-red-500 animate-bounce"});case"success":return s.jsx(Je,{className:"w-8 h-8 text-green-500 animate-pulse"});default:return s.jsx(Yj,{className:"w-8 h-8 text-blue-500 animate-pulse"})}},v=()=>{switch(c){case"danger":return"bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 shadow-red-900/30";case"success":return"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-500 hover:to-green-600 shadow-green-900/30";default:return"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 shadow-blue-900/30"}};return Jh.createPortal(s.jsx("div",{className:`fixed inset-0 z-[200] flex items-center justify-center p-4 transition-all duration-300 ease-out ${u?"backdrop-blur-[2px] bg-black/60":"opacity-0 pointer-events-none"}`,onClick:m,style:{touchAction:"none"},children:s.jsxs("div",{className:`
            w-full max-w-sm bg-[#1e293b] rounded-2xl border border-gray-700/50 shadow-2xl 
            transform transition-all duration-300 ease-[cubic-bezier(0.34,1.56,0.64,1)] relative overflow-hidden
            ${u?"scale-100 translate-y-0 opacity-100":"scale-90 translate-y-10 opacity-0"}
        `,onClick:_=>_.stopPropagation(),children:[s.jsx("div",{className:`absolute top-0 left-0 w-full h-1 bg-gradient-to-r ${c==="danger"?"from-red-500 via-orange-500 to-red-500":c==="success"?"from-green-500 via-emerald-500 to-green-500":"from-blue-500 via-cyan-500 to-blue-500"}`}),s.jsxs("div",{className:"p-6 text-center",children:[s.jsx("div",{className:"flex justify-center mb-4",children:s.jsx("div",{className:"p-4 rounded-full bg-[#0f172a] border border-gray-700 shadow-inner",children:b()})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:n}),s.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-6",children:e}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{type:"button",onClick:p,className:`flex-1 py-3 px-4 rounded-xl text-white font-bold text-sm shadow-lg transform transition-transform active:scale-95 ${v()}`,children:i}),s.jsx("button",{type:"button",onClick:m,className:"flex-1 py-3 px-4 rounded-xl bg-gray-700/50 hover:bg-gray-700 text-gray-300 font-bold text-sm border border-gray-600/50 transition-colors active:scale-95",children:o})]})]})]})}),document.body)},Yp=({label:n,count:e,icon:t,isActive:r,onClick:i,colorClasses:o,disabled:c})=>s.jsxs("button",{onClick:c?void 0:i,className:`p-3 rounded-xl flex flex-col items-center justify-center text-center w-full transition-all duration-200 border-2 min-h-[90px] focus:outline-none ${c?"opacity-40 cursor-not-allowed bg-gray-800 border-transparent grayscale":r?"border-red-500 bg-gray-700/50 shadow-lg scale-105 z-10":"border-transparent bg-gray-800 hover:bg-gray-700/70"}`,children:[s.jsx("div",{className:`p-2 rounded-full mb-1 ${o.split(" ")[0]}`,children:Rn.cloneElement(t,{className:`w-5 h-5 ${o.split(" ")[1]}`})}),s.jsx("p",{className:"text-gray-400 text-[10px] font-bold mb-1 line-clamp-1",children:n}),e!==void 0&&s.jsx("p",{className:"text-white text-lg font-black leading-none",children:e})]}),th=Rn.memo(({orders:n,users:e,deleteOrder:t,editOrder:r,onNavigateToAdd:i,permissions:o,onOpenStatusModal:c,onOpenPaymentModal:u,onBulkAssign:h,onBulkStatusUpdate:m,onBulkDelete:p,appName:b,currentUser:v,viewMode:_="default"})=>{const[T,k]=w.useState(null),[E,S]=w.useState(null),[L,$]=w.useState(""),[H,G]=w.useState(1),[z,P]=w.useState("all"),[j,O]=w.useState("all"),I=!o||o.includes("manage_orders"),R=!o||o.includes("delete_orders");v==null||v.role,Rn.useEffect(()=>{O(_==="shopping"?"merchant":_==="special"?"special":"all")},[_]);const[F,M]=w.useState(!1),[ne,U]=w.useState(!1),[A,V]=w.useState(!1),[Q,ae]=w.useState(null),[X,B]=w.useState(!1),[Y,ge]=w.useState(""),[Z,te]=w.useState(null),[me,re]=w.useState(null),[ce,he]=w.useState(""),[Oe,Ue]=w.useState("");sn(()=>X?(B(!1),!0):Z?(te(null),!0):Q?(ae(null),!0):F?(M(!1),!0):ne?(U(!1),!0):A?(V(!1),!0):T?(k(null),!0):E?(S(null),!0):_==="default"&&j!=="all"?(O("all"),P("all"),!0):z!=="all"?(P("all"),!0):H>1?(G(H-1),!0):!1,[T,E,F,ne,Z,X,A,Q,H,j,_,z]);const st=w.useMemo(()=>{const Ee=n.filter(Be=>j==="merchant"?Be.type==="shopping_order"&&Be.merchantId!=="delinow":j==="special"?Be.merchantId==="delinow":!0);return{all:Ee.length,[ue.Pending]:Ee.filter(Be=>Be.status===ue.Pending).length,[ue.Ready]:Ee.filter(Be=>Be.status===ue.Ready).length,[ue.InTransit]:Ee.filter(Be=>Be.status===ue.InTransit).length,[ue.Delivered]:Ee.filter(Be=>Be.status===ue.Delivered).length,[ue.Cancelled]:Ee.filter(Be=>Be.status===ue.Cancelled).length,totalMerchantOrders:n.filter(Be=>Be.type==="shopping_order"&&Be.merchantId!=="delinow").length,totalSpecialRequests:n.filter(Be=>Be.merchantId==="delinow").length,pendingUnassigned:Ee.filter(Be=>Be.status===ue.Pending&&!Be.driverId).length}},[n,j]),fe=w.useMemo(()=>[{value:"all",label:"",icon:s.jsx(Zt,{}),colorClasses:"bg-blue-500/20 text-blue-400"},{value:ue.Pending,label:" ",icon:s.jsx(It,{}),colorClasses:"bg-yellow-500/20 text-yellow-400"},..._==="shopping"?[{value:ue.Ready,label:" ",icon:s.jsx(Je,{}),colorClasses:"bg-teal-500/20 text-teal-400"}]:[],{value:ue.InTransit,label:" ",icon:s.jsx(gO,{}),colorClasses:"bg-sky-500/20 text-sky-400"},{value:ue.Delivered,label:" ",icon:s.jsx(Je,{}),colorClasses:"bg-green-500/20 text-green-400"},{value:ue.Cancelled,label:"",icon:s.jsx(ut,{}),colorClasses:"bg-red-500/20 text-red-400"}],[_]),K=()=>{if(!ce||!Oe)return;const Ee=parseFloat(Oe);if((v==null?void 0:v.role)!=="admin"&&Ee<=0){re("       ( 0)"),setTimeout(()=>re(null),3e3);return}h==null||h(ce,Ee),M(!1),he(""),Ue("")},ie=Ee=>{switch(Ee){case ue.Pending:return{title:"   ",message:"         (   ).   "};case ue.Ready:return{title:"  ",message:"      .   "};case ue.InTransit:return{title:"   ",message:":      !     "};case ue.Delivered:return{title:"  ",message:"      .   "};case ue.Cancelled:return{title:"  ",message:"       ."};case"all":return{title:"   ",message:" :       !      .",variant:"danger"};default:return{title:"",message:""}}},J=Ee=>{switch(Ee){case ue.Pending:return{title:'    " "',message:'     (  )   " "   .   ',variant:"primary"};case ue.Ready:return{title:'   " "',message:'      " ".   ',variant:"primary"};case ue.Delivered:return{title:"  ",message:'     ( )   " "   .   ',variant:"success"};default:return{title:" ",message:"",variant:"primary"}}},le=Z?ie(Z):null,ee=Q?J(Q):null,we=50;Rn.useEffect(()=>{G(1)},[z,j,L]),Rn.useEffect(()=>{const Ee=document.querySelector("main");Ee?Ee.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},[H]);const pe=w.useMemo(()=>{let Ee=[...n];if(j==="merchant"?Ee=Ee.filter(Be=>Be.type==="shopping_order"&&Be.merchantId!=="delinow"):j==="special"&&(Ee=Ee.filter(Be=>Be.merchantId==="delinow")),z!=="all"&&(Ee=Ee.filter(Be=>Be.status===z)),L){const Be=L.toLowerCase();if(Be.startsWith("#")){const ht=Be.substring(1).trim();Ee=Ee.filter(Me=>Me.customOrderNumber&&Me.customOrderNumber.toString().toLowerCase()===ht||Me.id&&Me.id.toString().toLowerCase().includes(ht))}else Ee=Ee.filter(ht=>{var Me,Ze;return ht.id&&ht.id.toString().includes(Be)||ht.customOrderNumber&&ht.customOrderNumber.toString().toLowerCase().includes(Be)||((Me=ht.customer)==null?void 0:Me.phone)&&ht.customer.phone.includes(Be)||((Ze=ht.customer)==null?void 0:Ze.address)&&ht.customer.address.toLowerCase().includes(Be)||ht.notes&&ht.notes.toLowerCase().includes(Be)})}return Ee.sort((Be,ht)=>{const Me=Be.createdAt?new Date(Be.createdAt).getTime():0,Ze=ht.createdAt?new Date(ht.createdAt).getTime():0;if(Me!==Ze)return Ze-Me;const at=parseInt(Be.id.replace(/\D/g,"")||"0");return parseInt(ht.id.replace(/\D/g,"")||"0")-at}),Ee},[n,j,z,L]),ye=w.useMemo(()=>e.filter(Ee=>Ee.role==="merchant"),[e]),Ae=w.useMemo(()=>e.filter(Ee=>Ee.role==="driver"),[e]),xe=w.useMemo(()=>{if(!Y)return Ae;const Ee=Y.toLowerCase();return Ae.filter(Be=>Be.name.toLowerCase().includes(Ee)||Be.phone&&Be.phone.includes(Ee))},[Ae,Y]),Pe=w.useMemo(()=>Ae.find(Ee=>Ee.id===ce),[Ae,ce]),gt=w.useMemo(()=>{const Ee=H*we,Be=Ee-we;return pe.slice(Be,Ee)},[pe,H,we]);return s.jsxs("div",{className:"space-y-6 pb-32",children:[s.jsxs("div",{className:"grid grid-cols-4 lg:grid-cols-8 gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[fe.map(Ee=>s.jsx(Yp,{label:Ee.label,count:st[Ee.value],icon:Ee.icon,isActive:z===Ee.value,onClick:()=>{P(Ee.value)},colorClasses:Ee.colorClasses},Ee.value)),I&&s.jsxs(s.Fragment,{children:[s.jsx(Yp,{label:`  (${st.pendingUnassigned})`,icon:s.jsx(hs,{}),isActive:F,onClick:()=>{st.pendingUnassigned===0?(re("      "),setTimeout(()=>re(null),3e3)):M(!0)},colorClasses:"bg-indigo-500/20 text-indigo-400 border-indigo-500/30"}),s.jsx(Yp,{label:"  ",icon:s.jsx(Ml,{}),isActive:A,onClick:()=>V(!0),colorClasses:"bg-emerald-500/20 text-emerald-400 border-emerald-500/30"})]}),R&&s.jsx(Yp,{label:" ",icon:s.jsx(Tt,{}),isActive:ne,onClick:()=>U(!0),colorClasses:"bg-red-500/20 text-red-400 border-red-500/30"})]}),me&&s.jsx("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-lg shadow-xl border border-gray-700 z-50 animate-fadeIn",children:me}),s.jsxs("div",{className:"bg-gray-800 p-4 rounded-xl shadow-sm flex flex-col md:flex-row gap-4 items-center border border-gray-700",children:[s.jsxs("div",{className:"relative flex-1 w-full",children:[s.jsx(mr,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 w-5 h-5"}),s.jsx("input",{type:"text",placeholder:"     ...",value:L,onChange:Ee=>$(Ee.target.value),className:"w-full px-4 py-2 pr-10 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-1 focus:ring-red-500 outline-none"})]}),I&&s.jsxs("button",{onClick:i,className:"w-full md:w-auto flex items-center justify-center gap-2 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white px-6 py-2.5 rounded-xl shadow-lg shadow-red-900/30 transition-all active:scale-95 group",children:[s.jsx("div",{className:"bg-white/20 p-1 rounded-full group-hover:rotate-90 transition-transform duration-300",children:s.jsx(hs,{className:"w-4 h-4"})}),s.jsx("span",{className:"font-bold text-sm",children:" "})]})]}),j!=="all"&&s.jsxs("div",{className:"flex items-center gap-2 px-2",children:[s.jsx("span",{className:`w-2 h-6 rounded-full ${j==="merchant"?"bg-orange-500":"bg-purple-500"}`}),s.jsx("h3",{className:"text-xl font-bold text-white",children:j==="merchant"?"  ":"  "})]}),s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:gt.length>0?gt.map(Ee=>s.jsx(MZ,{order:Ee,onEdit:I?k:void 0,onDelete:R?Be=>S(Be):void 0,onOpenStatusModal:I?c:void 0,onOpenPaymentModal:I?u:void 0,users:e},Ee.id)):s.jsxs("div",{className:"col-span-full py-20 text-center flex flex-col items-center justify-center bg-gray-800/30 rounded-3xl border border-dashed border-gray-700",children:[s.jsx(Zt,{className:"w-16 h-16 text-gray-700 mb-4 opacity-20"}),s.jsx("p",{className:"text-gray-500 font-bold",children:"   "})]})}),pe.length>we&&s.jsxs("div",{className:"flex justify-center items-center gap-4 mt-8 pt-4 border-t border-gray-700",children:[s.jsx("button",{onClick:()=>G(Ee=>Math.max(1,Ee-1)),disabled:H===1,className:"px-4 py-2 bg-gray-800 text-white rounded-lg disabled:opacity-50 hover:bg-gray-700 transition",children:""}),s.jsxs("span",{className:"text-gray-400 font-mono",children:[" ",H,"  ",Math.ceil(pe.length/we)]}),s.jsx("button",{onClick:()=>G(Ee=>Math.min(Math.ceil(pe.length/we),Ee+1)),disabled:H===Math.ceil(pe.length/we),className:"px-4 py-2 bg-gray-800 text-white rounded-lg disabled:opacity-50 hover:bg-gray-700 transition",children:""})]}),T&&s.jsx(LZ,{order:T,merchants:ye,drivers:Ae,onClose:()=>k(null),onSave:Ee=>{const Be=T;let ht=Be.status;Ee.driverId&&Ee.deliveryFee!==null&&Ee.deliveryFee!==void 0?Be.status===ue.Pending&&(ht=ue.InTransit):Ee.driverId||Be.status===ue.InTransit&&(ht=ue.Pending);const Me={...Ee};ht!==Be.status&&(Me.status=ht),r(T.id,Me),k(null),r(T.id,Me),k(null)},currentUserRole:v==null?void 0:v.role,currentUserPermissions:o,currentUser:v}),E&&s.jsx(jn,{title:" ",message:`       ${E.id} `,onClose:()=>S(null),onConfirm:()=>{t(E.id),S(null)},confirmButtonText:" ",confirmVariant:"danger"}),F&&s.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>M(!1),children:s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-2xl border border-gray-700 shadow-2xl p-6 animate-pop-in",onClick:Ee=>Ee.stopPropagation(),children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsxs("h3",{className:"text-xl font-black text-white flex items-center gap-2",children:[s.jsx(Zt,{className:"w-6 h-6 text-indigo-400"}),"  "]}),s.jsx("button",{onClick:()=>M(!1),className:"text-gray-500 hover:text-white",children:s.jsx(ut,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("p",{className:"text-sm text-gray-400",children:["  ",s.jsx("span",{className:"text-yellow-500 font-bold",children:st.pendingUnassigned}),"  ( )  ."]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-2",children:" "}),s.jsxs("button",{onClick:()=>B(!0),className:"w-full bg-[#0f172a] border border-gray-700 rounded-xl p-4 flex justify-between items-center text-white hover:border-gray-500 transition-colors",children:[Pe?s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border border-gray-600",children:Pe.storeImage?s.jsx("img",{src:Pe.storeImage,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-4 h-4 text-gray-400"})}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-bold text-sm",children:Pe.name}),s.jsx("p",{className:"text-xs text-gray-500 font-mono",children:Pe.phone})]})]}):s.jsx("span",{className:"text-gray-400 text-sm",children:" ..."}),s.jsx(Iy,{className:"w-5 h-5 text-gray-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-2",children:"  "}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"number",placeholder:"0",value:Oe,onChange:Ee=>Ue(Ee.target.value),className:"w-full bg-[#0f172a] border border-gray-700 rounded-xl py-3 pl-10 pr-4 text-white font-bold outline-none focus:border-indigo-500"}),s.jsx("span",{className:"absolute left-3 top-3.5 text-gray-500 text-xs font-bold",children:"."})]})]}),s.jsx("button",{onClick:K,disabled:!ce||!Oe,className:"w-full bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-700 disabled:text-gray-500 text-white font-bold py-3.5 rounded-xl shadow-lg transition-all active:scale-95 mt-2",children:" "})]})]})}),X&&s.jsx("div",{className:"fixed inset-0 z-[110] bg-black/90 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>B(!1),children:s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-gray-700 shadow-2xl overflow-hidden flex flex-col max-h-[60vh]",onClick:Ee=>Ee.stopPropagation(),children:[s.jsx("div",{className:"p-4 border-b border-gray-700",children:s.jsxs("div",{className:"relative",children:[s.jsx(mr,{className:"absolute right-3 top-3 w-4 h-4 text-gray-500"}),s.jsx("input",{type:"text",placeholder:"  ...",value:Y,onChange:Ee=>ge(Ee.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-2.5 pr-9 pl-3 text-white text-sm outline-none focus:border-blue-500",autoFocus:!0})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto p-2 custom-scrollbar",children:xe.length>0?xe.map(Ee=>s.jsxs("button",{onClick:()=>{he(Ee.id),B(!1)},className:`w-full flex items-center gap-3 p-3 rounded-xl transition-colors ${ce===Ee.id?"bg-blue-900/20 border border-blue-500/30":"hover:bg-gray-800 border border-transparent"}`,children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden flex-shrink-0",children:Ee.storeImage?s.jsx("img",{src:Ee.storeImage,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-5 h-5 text-gray-400"})}),s.jsxs("div",{className:"text-right flex-1",children:[s.jsx("p",{className:`font-bold text-sm ${ce===Ee.id?"text-blue-400":"text-white"}`,children:Ee.name}),s.jsx("p",{className:"text-xs text-gray-500 font-mono",children:Ee.phone})]}),ce===Ee.id&&s.jsx(Je,{className:"w-5 h-5 text-blue-500"})]},Ee.id)):s.jsx("p",{className:"text-center text-gray-500 py-4 text-xs",children:"  "})})]})}),A&&s.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>V(!1),children:s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-gray-700 shadow-2xl p-6 animate-pop-in text-center",onClick:Ee=>Ee.stopPropagation(),children:[s.jsx("div",{className:"w-16 h-16 bg-emerald-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-emerald-500/20",children:s.jsx(Ml,{className:"w-8 h-8 text-emerald-500"})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),s.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"       ."}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>{V(!1),ae(ue.Pending)},className:"w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-xl py-3 text-sm font-bold text-yellow-400 transition-colors flex items-center justify-center gap-2",children:[s.jsx(It,{className:"w-4 h-4"}),"  "]}),s.jsxs("button",{onClick:()=>{V(!1),ae(ue.Delivered)},className:"w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-xl py-3 text-sm font-bold text-green-400 transition-colors flex items-center justify-center gap-2",children:[s.jsx(Je,{className:"w-4 h-4"}),'  " "']})]}),s.jsx("button",{onClick:()=>V(!1),className:"mt-4 text-gray-500 text-xs hover:text-white transition-colors",children:""})]})}),ne&&s.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>U(!1),children:s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-gray-700 shadow-2xl p-6 animate-pop-in text-center",onClick:Ee=>Ee.stopPropagation(),children:[s.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-red-500/20",children:s.jsx(Tt,{className:"w-8 h-8 text-red-500"})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),s.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"       ."}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>{U(!1),te(ue.Pending)},className:"w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-xl py-3 text-sm font-bold text-yellow-400 transition-colors",children:["    (",st[ue.Pending],")"]}),s.jsxs("button",{onClick:()=>{U(!1),te(ue.Cancelled)},className:"w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-xl py-3 text-sm font-bold text-red-400 transition-colors",children:["    (",st[ue.Cancelled],")"]}),s.jsxs("button",{onClick:()=>{U(!1),te(ue.Delivered)},className:"w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 rounded-xl py-3 text-sm font-bold text-green-400 transition-colors",children:["    (",st[ue.Delivered],")"]}),s.jsx("div",{className:"h-px bg-gray-700 my-2"}),s.jsx("button",{onClick:()=>{U(!1),te("all")},className:"w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 rounded-xl shadow-lg transition-colors",children:"   "})]})]})}),Q&&ee&&s.jsx(jn,{title:ee.title,message:ee.message,onClose:()=>ae(null),onConfirm:()=>{m==null||m(Q),ae(null)},confirmButtonText:" ",confirmVariant:ee.variant}),Z&&le&&s.jsx(jn,{title:le.title,message:le.message,onClose:()=>te(null),onConfirm:()=>{p==null||p(Z),te(null)},confirmButtonText:"  ",confirmVariant:le.variant||"danger"})]})}),VZ="modulepreload",FZ=function(n,e){return new URL(n,e).href},s4={},Z1=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let c=function(p){return Promise.all(p.map(b=>Promise.resolve(b).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};const u=document.getElementsByTagName("link"),h=document.querySelector("meta[property=csp-nonce]"),m=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));i=c(t.map(p=>{if(p=FZ(p,r),p in s4)return;s4[p]=!0;const b=p.endsWith(".css"),v=b?'[rel="stylesheet"]':"";if(!!r)for(let k=u.length-1;k>=0;k--){const E=u[k];if(E.href===p&&(!b||E.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${p}"]${v}`))return;const T=document.createElement("link");if(T.rel=b?"stylesheet":VZ,b||(T.as="script"),T.crossOrigin="",T.href=p,m&&T.setAttribute("nonce",m),document.head.appendChild(T),b)return new Promise((k,E)=>{T.addEventListener("load",k),T.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return i.then(c=>{for(const u of c||[])u.status==="rejected"&&o(u.reason);return e().catch(o)})},UZ=[{id:"restaurant",label:""},{id:"market",label:" "},{id:"pharmacy",label:""},{id:"bakery",label:"/"},{id:"electronics",label:""},{id:"fashion",label:""},{id:"logistics",label:" "},{id:"other",label:""}],BZ=({onClose:n,onSave:e,initialRole:t,appName:r,currentUserRole:i,currentUserPermissions:o})=>{const[c,u]=w.useState(""),[h,m]=w.useState(""),[p,b]=w.useState(""),[v,_]=w.useState(""),[T,k]=w.useState(""),[E,S]=w.useState(t),[L,$]=w.useState(25),[H,G]=w.useState("percentage"),[z,P]=w.useState("always_open"),[j,O]=w.useState(!0),[I,R]=w.useState(1),[F,M]=w.useState("restaurant"),[ne,U]=w.useState(!1),[A,V]=w.useState(!0),[Q,ae]=w.useState([]),[X,B]=w.useState(""),[Y,ge]=w.useState(!1),[Z,te]=w.useState(null),[me,re]=w.useState(!1),ce=w.useRef(null),he=r||"GOO NOW";sn(()=>(n(),!0),[n]);const Oe="w-full px-4 py-3 bg-[#252525] border border-[#333] text-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors",Ue=[{title:" ",permissions:[{id:"view_orders",label:" "},{id:"manage_orders",label:" "},{id:"delete_orders",label:" "}]},{title:" ",permissions:[{id:"view_users",label:" "},{id:"manage_users",label:" "},{id:"manage_stores",label:" "},{id:"manage_supervisors",label:" "}]},{title:" ",permissions:[{id:"view_reports",label:" "},{id:"view_wallet",label:" "},{id:"view_logs",label:" "},{id:"manage_advanced_financials",label:"  "}]},{title:" ",permissions:[{id:"manage_promo",label:" "},{id:"manage_slider",label:" "},{id:"send_messages",label:" "},{id:"manage_support",label:" "}]}],st=J=>{ae(le=>le.includes(J)?le.filter(ee=>ee!==J):[...le,J])},fe=J=>{var ee;const le=(ee=J.target.files)==null?void 0:ee[0];if(le){re(!0);const we=new FileReader;we.onloadend=()=>{const pe=new Image;pe.src=we.result,pe.onload=()=>{const ye=document.createElement("canvas"),Ae=1024,xe=Ae/pe.width;ye.width=Ae,ye.height=pe.height*xe;const Pe=ye.getContext("2d");Pe&&(Pe.imageSmoothingEnabled=!0,Pe.imageSmoothingQuality="high",Pe.drawImage(pe,0,0,ye.width,ye.height),setTimeout(()=>{te(ye.toDataURL("image/jpeg",.9)),re(!1)},800))}},we.readAsDataURL(le)}},K=async()=>{if(!c||!h||!v||!E){B("    .");return}if(!/^\d{11}$/.test(h)){B("      11 .");return}if(v.length<6){B("     6     .");return}if(v!==T){B("   .");return}B("");const J={name:c,phone:h,password:v,role:E,storeImage:Z||void 0,address:E!=="driver"&&p?p:void 0};E==="driver"&&(J.commissionRate=L,J.commissionType=H,J.dailyLogMode=z,J.maxConcurrentOrders=j?void 0:I),E==="merchant"&&(J.storeCategory=F,J.canShowDeliveryTime=ne,J.canManageMenu=A),E==="supervisor"&&(J.permissions=Q),ge(!0);try{await e(J),n()}catch{ge(!1)}},ie=w.useMemo(()=>{const J=[{id:"driver",label:""},{id:"merchant",label:""},{id:"customer",label:""},{id:"supervisor",label:""},{id:"admin",label:""}];if(i==="supervisor"){const le=o==null?void 0:o.includes("manage_supervisors");return J.filter(ee=>ee.id!=="admin"&&(le||ee.id!=="supervisor"))}return J},[i,o]);return s.jsxs("div",{className:"fixed inset-0 bg-[#111] z-[60] overflow-y-auto animate-fadeIn flex flex-col",children:[s.jsxs("div",{className:"flex-none bg-[#1a1a1a] border-b border-[#333] px-4 pt-safe h-16 box-content flex items-center justify-between sticky top-0 z-20 shadow-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:n,className:"bg-[#252525] p-2 rounded-full text-gray-400 hover:text-white transition-colors",children:s.jsx(us,{className:"w-6 h-6 rotate-180"})}),s.jsx("h2",{className:"text-xl font-bold text-white",children:"  "})]}),s.jsx("button",{onClick:K,disabled:Y,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-lg transition-colors shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:Y?" ...":""})]}),s.jsxs("div",{className:"flex-1 max-w-4xl mx-auto w-full p-4 sm:p-8 space-y-8 pb-20",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsxs("div",{onClick:()=>{var J;return!me&&((J=ce.current)==null?void 0:J.click())},className:"relative cursor-pointer border-2 border-dashed border-gray-600 hover:border-red-500 transition-colors bg-[#252525] w-32 h-32 rounded-full flex items-center justify-center overflow-hidden group shadow-xl",children:[me&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 z-50 backdrop-blur-sm",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full opacity-75 animate-ping absolute top-0 left-0"}),s.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center relative z-10 shadow-lg shadow-blue-500/50",children:s.jsx(Zr,{className:"w-6 h-6 text-white animate-bounce"})}),s.jsx("div",{className:"w-20 h-20 border-4 border-blue-400/30 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"})]})}),Z?s.jsx("img",{src:Z,alt:"Profile",className:"w-full h-full object-cover"}):s.jsxs("div",{className:"flex flex-col items-center text-gray-400",children:[s.jsx(qi,{className:"w-10 h-10 mb-1"}),s.jsx("span",{className:"text-xs",children:""})]}),s.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx(Zr,{className:"w-8 h-8 text-white"})})]}),s.jsx("p",{className:"text-gray-500 text-xs mt-2",children:"     "}),s.jsx("input",{ref:ce,type:"file",accept:"image/*",className:"hidden",onChange:fe})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm h-fit",children:[s.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[s.jsx("span",{className:"w-1 h-5 bg-red-500 rounded-full"})," "]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" (Role)"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:ie.map(J=>s.jsx("button",{type:"button",onClick:()=>S(J.id),className:`px-4 py-2 text-sm font-bold rounded-xl border transition-all ${E===J.id?"bg-red-600 border-red-600 text-white shadow-lg shadow-red-900/20":"bg-transparent border-gray-600 text-gray-400 hover:border-gray-400"}`,children:J.label},J.id))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),s.jsx("input",{type:"text",value:c,onChange:J=>u(J.target.value),className:Oe,placeholder:E==="merchant"?" ":":  "})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),s.jsx("input",{type:"tel",value:h,onChange:J=>m(J.target.value),className:`${Oe} text-right placeholder:text-right`,placeholder:"01xxxxxxxxx",dir:"rtl"})]}),E!=="driver"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",value:p,onChange:J=>b(J.target.value),className:`${Oe} pl-10`,placeholder:" "}),s.jsx(fs,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500"})]})]}),E==="merchant"&&s.jsxs("div",{className:"space-y-4 pt-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),s.jsxs("div",{className:"relative",children:[s.jsx("select",{value:F,onChange:J=>M(J.target.value),className:`${Oe} appearance-none`,children:UZ.map(J=>s.jsx("option",{value:J.id,children:J.label},J.id))}),s.jsx(ks,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500 pointer-events-none"})]})]}),s.jsxs("div",{className:"bg-[#252525] p-3 rounded-xl border border-[#333] space-y-3",children:[s.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:A,onChange:J=>V(J.target.checked),className:"w-5 h-5 rounded bg-gray-700 border-gray-600 text-red-600 focus:ring-red-500"}),s.jsxs("span",{className:"flex items-center gap-2 text-sm text-gray-200",children:[s.jsx(Si,{className:"w-4 h-4 text-orange-400"}),"  "]})]}),s.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:ne,onChange:J=>U(J.target.checked),className:"w-5 h-5 rounded bg-gray-700 border-gray-600 text-red-600 focus:ring-red-500"}),s.jsxs("span",{className:"flex items-center gap-2 text-sm text-gray-200",children:[s.jsx(It,{className:"w-4 h-4 text-blue-400"}),"    "]})]})]})]})]}),s.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm h-fit",children:[s.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[s.jsx("span",{className:"w-1 h-5 bg-blue-500 rounded-full"})," "]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),s.jsx("input",{type:"password",value:v,onChange:J=>_(J.target.value),className:Oe,placeholder:"******"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"  "}),s.jsx("input",{type:"password",value:T,onChange:J=>k(J.target.value),className:Oe,placeholder:"******"})]})]}),E==="driver"&&s.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-6 shadow-sm md:col-span-2",children:[s.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[s.jsx($s,{className:"w-5 h-5 text-orange-500"})," "]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),s.jsx("div",{className:"flex bg-[#252525] p-1 rounded-xl border border-[#333]",children:[{value:"12_hour",label:" 12 "},{value:"always_open",label:" "}].map(J=>s.jsx("button",{type:"button",onClick:()=>P(J.value),className:`flex-1 py-2.5 text-sm font-bold rounded-lg transition-all ${z===J.value?"bg-orange-500 text-white shadow-md":"text-gray-400 hover:text-white"}`,children:J.label},J.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"    ( )"}),s.jsxs("div",{className:"bg-[#252525] p-4 rounded-xl border border-[#333]",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("span",{className:"text-sm text-white font-medium",children:"  "}),s.jsx("button",{onClick:()=>O(!j),className:`w-12 h-6 rounded-full p-1 transition-colors duration-300 ${j?"bg-green-600":"bg-gray-600"}`,children:s.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-300 ${j?"translate-x-0":"-translate-x-6"}`})})]}),s.jsxs("div",{className:`overflow-hidden transition-all duration-300 ${j?"max-h-0 opacity-50":"max-h-20 opacity-100"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"range",min:"1",max:"10",value:I,onChange:J=>R(parseInt(J.target.value)),className:"flex-1 accent-orange-500 h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer",disabled:j}),s.jsx("div",{className:"bg-black/30 px-3 py-1 rounded-lg border border-[#444] min-w-[3rem] text-center font-bold text-white",children:I})]}),s.jsx("p",{className:"text-[10px] text-gray-500 mt-2",children:"        ."})]})]})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsxs("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:["  ",he]}),s.jsxs("div",{className:"bg-[#252525] p-4 rounded-xl border border-[#333] space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-400 mb-2",children:" "}),s.jsx("div",{className:"flex gap-2",children:[0,25,50].map(J=>s.jsxs("button",{type:"button",onClick:()=>{G("percentage"),$(J)},className:`px-4 py-2 text-sm font-bold rounded-lg border transition-all ${H==="percentage"&&L===J?"bg-orange-500 border-orange-500 text-white":"bg-transparent border-gray-600 text-gray-400"}`,children:[J,"%"]},`perc-${J}`))})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"  (.)"}),s.jsx("div",{className:"flex gap-2",children:[5,10,15,20].map(J=>s.jsx("button",{type:"button",onClick:()=>{G("fixed"),$(J)},className:`px-4 py-2 text-sm font-bold rounded-lg border transition-all ${H==="fixed"&&L===J?"bg-orange-500 border-orange-500 text-white":"bg-transparent border-gray-600 text-gray-400"}`,children:J},`fixed-${J}`))})]})]})]})]})]}),E==="supervisor"&&s.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm md:col-span-2",children:[s.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-4 flex items-center gap-2",children:[s.jsx(ur,{className:"w-5 h-5 text-yellow-500"})," "]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Ue.map((J,le)=>s.jsxs("div",{className:"bg-[#222] p-4 rounded-xl border border-[#333]",children:[s.jsx("h4",{className:"text-sm font-bold text-gray-300 mb-3 border-b border-[#333] pb-2",children:J.title}),s.jsx("div",{className:"space-y-2",children:J.permissions.map(ee=>s.jsxs("label",{className:"flex items-center gap-3 p-2 hover:bg-[#2a2a2a] rounded-lg transition-colors cursor-pointer group",children:[s.jsxs("div",{className:"relative flex items-center",children:[s.jsx("input",{type:"checkbox",checked:Q.includes(ee.id),onChange:()=>st(ee.id),className:"peer h-5 w-5 cursor-pointer appearance-none rounded-md border-2 border-gray-600 bg-gray-800 transition-all checked:border-red-500 checked:bg-red-500"}),s.jsx(Je,{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-3.5 h-3.5 text-white opacity-0 peer-checked:opacity-100 pointer-events-none"})]}),s.jsx("span",{className:"text-sm font-bold text-gray-200 group-hover:text-white transition-colors",children:ee.label})]},ee.id))})]},le))})]})]}),X&&s.jsx("div",{className:"bg-red-900/20 border border-red-500/50 text-red-400 p-4 rounded-xl text-center font-bold",children:X})]})]})},kh={"ruby-red":{name:" ",color:"#ef4444",type:"ruby"},"rose-pink":{name:" ",color:"#ec4899",type:"rose"},"sapphire-blue":{name:" ",color:"#3b82f6",type:"sapphire"},gold:{name:"",class:"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]",type:"css"},neon:{name:"",class:"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]",type:"css"},royal:{name:"",class:"p-[2px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30",type:"css"},fire:{name:"",class:"p-[2px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]",type:"css"},"ramadan-crescent":{name:"  ",type:"ramadan",color:"#fbbf24"},"ramadan-lantern":{name:"  ",type:"ramadan",color:"#a855f7"},"ramadan-stars":{name:"  ",type:"ramadan",color:"#60a5fa"}},Ji=({frameId:n,children:e,size:t="md",className:r=""})=>{const i={sm:{w:"w-10",h:"h-10",scale:1},md:{w:"w-14",h:"h-14",scale:1.2},lg:{w:"w-24",h:"h-24",scale:1.4},xl:{w:"w-32",h:"h-32",scale:1.6}}[t],o=kh[n],c=145,u=125;if((o==null?void 0:o.type)==="ruby"||(o==null?void 0:o.type)==="rose"||(o==null?void 0:o.type)==="sapphire"||(o==null?void 0:o.type)==="ramadan"){const m=o.color;return s.jsxs("div",{className:`relative flex items-center justify-center ${i.w} ${i.h} ${r}`,children:[o.type==="ruby"&&s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"absolute z-10 animate-pulse-frame",style:{width:`${c}%`,height:`${c}%`,color:m},viewBox:"0 0 200 200",children:[s.jsx("path",{d:"M 100,15 L 103,25 L 113,27 L 105,33 L 107,43 L 100,37 L 93,43 L 95,33 L 87,27 L 97,25 Z",fill:m}),s.jsx("path",{d:"M 25,100 L 28,108 L 36,110 L 30,115 L 31,123 L 25,118 L 19,123 L 20,115 L 14,110 L 22,108 Z",fill:m,style:{animationDelay:"0.5s"}}),s.jsx("path",{d:"M 175,100 L 178,108 L 186,110 L 180,115 L 181,123 L 175,118 L 169,123 L 170,115 L 164,110 L 172,108 Z",fill:m,style:{animationDelay:"1s"}}),s.jsx("path",{d:"M 100,185 L 103,193 L 111,195 L 105,200 L 106,208 L 100,203 L 94,208 L 95,200 L 89,195 L 97,193 Z",fill:m,style:{animationDelay:"1.5s"}})]}),s.jsx("div",{className:"absolute border-2 border-red-500/40 rounded-full animate-rotate",style:{width:`${u}%`,height:`${u}%`}}),s.jsx("div",{className:"absolute inset-[-10%] rounded-full border border-red-500/60 z-20 pointer-events-none"})]}),o.type==="rose"&&s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"absolute z-10 animate-float",style:{width:`${c-10}%`,height:`${c-10}%`,color:m},viewBox:"0 0 200 200",children:[s.jsx("path",{d:"M 125,30 A 35,35 0 1 1 125,80 A 26,26 0 1 0 125,30 Z",fill:m,filter:`drop-shadow(0 0 5px ${m})`,transform:"rotate(-15 125 55)"}),s.jsx("path",{d:"M 150,40 L 153,46 L 159,48 L 154,52 L 155,58 L 150,54 L 145,58 L 146,52 L 141,48 L 147,46 Z",fill:"#fce7f3"})]}),s.jsx("div",{className:"absolute border-2 border-pink-500/30 rounded-full",style:{width:`${u}%`,height:`${u}%`}}),s.jsx("div",{className:"absolute inset-[-8%] rounded-full border border-pink-400/50 z-20 pointer-events-none"})]}),o.type==="sapphire"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"absolute border-[3px] border-blue-500/40 rounded-full animate-rotate",style:{width:`${u-10}%`,height:`${u-10}%`}}),s.jsxs("svg",{className:"absolute z-10 animate-swing origin-bottom",style:{width:"40%",height:"40%",top:"-25%",left:"30%",color:m},viewBox:"0 0 35 55",children:[s.jsx("path",{d:"M 17.5,0 L 17.5,8 M 10,8 L 25,8 L 27,15 L 17.5,22 L 8,15 Z",fill:"#1e3a8a",stroke:"currentColor",strokeWidth:"1"}),s.jsx("rect",{x:"12",y:"15",width:"11",height:"12",fill:"rgba(59, 130, 246, 0.3)",stroke:"currentColor",strokeWidth:"0.5"}),s.jsx("circle",{cx:"17.5",cy:"20",r:"3",fill:"#bfdbfe"})]}),s.jsx("div",{className:"absolute inset-[-8%] rounded-full border border-blue-500/60 z-20 pointer-events-none"})]}),o.type==="ramadan"&&s.jsxs(s.Fragment,{children:[n==="ramadan-crescent"&&s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"absolute z-10 animate-float animate-glow-gold",style:{width:"60%",height:"60%",top:"-30%",right:"-10%",color:"#fbbf24"},viewBox:"0 0 24 24",children:s.jsx("path",{fill:"currentColor",d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"})}),s.jsx("div",{className:"absolute border-2 border-yellow-500/40 rounded-full animate-rotate",style:{width:`${u}%`,height:`${u}%`}}),s.jsx("div",{className:"absolute inset-0 rounded-full shadow-[0_0_15px_rgba(251,191,36,0.3)] pointer-events-none"})]}),n==="ramadan-lantern"&&s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"absolute z-10 animate-float-lantern animate-glow-purple",style:{width:"50%",height:"50%",top:"-35%",left:"25%",color:"#a855f7"},viewBox:"0 0 24 24",children:s.jsx("path",{fill:"currentColor",d:"M12 2l-2 3h4l-2-3zm-4 4h8v2H8V6zm1 3h6v10H9V9zm-2 0h1v10H7V9zm9 0h1v10h-1V9zm-5 11h2v2h-2v-2z"})}),s.jsx("div",{className:"absolute border-2 border-purple-500/30 rounded-full",style:{width:`${u}%`,height:`${u}%`}}),s.jsx("div",{className:"absolute inset-0 rounded-full border border-purple-500/20 z-20 pointer-events-none"})]}),n==="ramadan-stars"&&s.jsxs(s.Fragment,{children:[[...Array(6)].map((p,b)=>s.jsx("svg",{className:"absolute z-10 animate-twinkle",style:{width:"15%",height:"15%",top:`${50+45*Math.sin(b*60*Math.PI/180)}%`,left:`${50+45*Math.cos(b*60*Math.PI/180)}%`,color:"#60a5fa",animationDelay:`${b*.3}s`},viewBox:"0 0 24 24",children:s.jsx("path",{fill:"currentColor",d:"M12 1L14.39 8.26L22 9.27L16.5 14.14L18.18 21.02L12 17.77L5.82 21.02L7.5 14.14L2 9.27L9.61 8.26L12 1Z"})},b)),s.jsx("div",{className:"absolute border-[1px] border-blue-400/20 rounded-full animate-rotate",style:{width:`${u}%`,height:`${u}%`}}),s.jsx("div",{className:"absolute inset-0 rounded-full bg-blue-500/5 z-0"})]})]}),s.jsx("div",{className:"relative z-0 overflow-hidden rounded-full w-full h-full bg-gray-800 flex items-center justify-center shadow-inner",children:e})]})}if(n!=null&&n.startsWith("data:")||n!=null&&n.startsWith("http"))return s.jsxs("div",{className:`relative ${i.w} ${i.h} flex items-center justify-center rounded-full ${r}`,children:[s.jsx("img",{src:n,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.35] pointer-events-none",alt:"frame"}),s.jsx("div",{className:"w-[90%] h-[90%] rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border border-gray-800 relative z-0",children:e})]});const h=(o==null?void 0:o.type)==="css"?o.class:"";return s.jsx("div",{className:`relative ${i.w} ${i.h} flex items-center justify-center rounded-full ${h} ${r}`,children:s.jsx("div",{className:"w-full h-full rounded-full bg-gray-800 flex items-center justify-center overflow-hidden relative z-0",children:e})})},zZ=n=>{switch(n){case"active":return"";case"pending":return" ";case"inactive":return" ";case"blocked":return"";case"suspended":return"";default:return n}},$Z=n=>{switch(n){case"active":return"green";case"pending":return"yellow";case"inactive":return"gray";case"blocked":return"red";case"suspended":return"orange";default:return"gray"}},qZ=n=>{switch(n){case"driver":return{label:"",bg:"bg-orange-500/10",text:"text-orange-400",border:"border-orange-500/20"};case"merchant":return{label:"",bg:"bg-purple-500/10",text:"text-purple-400",border:"border-purple-500/20"};case"admin":return{label:"",bg:"bg-red-500/10",text:"text-red-400",border:"border-red-500/20"};case"supervisor":return{label:"",bg:"bg-yellow-500/10",text:"text-yellow-400",border:"border-yellow-500/20"};case"customer":return{label:"",bg:"bg-blue-500/10",text:"text-blue-400",border:"border-blue-500/20"};default:return{label:"",bg:"bg-gray-500/10",text:"text-gray-400",border:"border-gray-500/20"}}},HZ=n=>{if(n!=null&&n.startsWith("data:")||n!=null&&n.startsWith("http"))return"p-0";switch(n){case"gold":return"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[2px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[2px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-0"}},GZ=n=>{if(!n||n==="none")return null;if(n!=null&&n.startsWith("data:")||n!=null&&n.startsWith("http"))return s.jsx("div",{className:"w-6 h-6 min-w-[1.5rem] rounded bg-white/5 border border-white/10 flex items-center justify-center p-0.5 ml-1",children:s.jsx("img",{src:n,className:"w-full h-full object-contain",alt:"badge"})});switch(n){case"verified":return s.jsx(Mo,{className:"w-3 h-3 text-blue-400"});case"vip":return s.jsx(Xi,{className:"w-3 h-3 text-yellow-400"});case"star":return s.jsx(ti,{className:"w-3 h-3 text-purple-400"});case"popular":return s.jsx(en,{className:"w-3 h-3 text-red-400"});case"shield":case"tier-1":case"tier-2":case"tier-3":case"tier-4":case"tier-5":return s.jsx(ur,{className:"w-3 h-3 text-orange-400"});case"admin-badge":return s.jsx($s,{className:"w-3 h-3 text-red-500"});case"mod-badge":return s.jsx(ur,{className:"w-3 h-3 text-green-500"});case"driver-badge":return s.jsx(Zt,{className:"w-3 h-3 text-orange-500"});case"merchant-badge":return s.jsx(Ar,{className:"w-3 h-3 text-purple-500"});case"support-badge":return s.jsx(Ei,{className:"w-3 h-3 text-blue-500"});case"flash":return s.jsx(Jl,{className:"w-3 h-3 text-yellow-400"});case"love":return s.jsx(Sm,{className:"w-3 h-3 text-pink-400"});case"cool":return s.jsx(ti,{className:"w-3 h-3 text-cyan-400"});case"fire-b":return s.jsx(en,{className:"w-3 h-3 text-red-500"});case"check":return s.jsx(Je,{className:"w-3 h-3 text-green-500"});case"money":return s.jsx(Ed,{className:"w-3 h-3 text-emerald-400"});case"let-a":return s.jsx("span",{className:"text-[10px] font-bold font-mono text-white",children:"A"});case"let-b":return s.jsx("span",{className:"text-[10px] font-bold font-mono text-white",children:"B"});case"let-s":return s.jsx("span",{className:"text-[10px] font-bold font-mono text-yellow-400",children:"S"});case"let-x":return s.jsx("span",{className:"text-[10px] font-bold font-mono text-red-400",children:"X"});case"pro":return s.jsx("span",{className:"text-[8px] font-black text-white bg-black px-1 rounded border border-white/50",children:"PRO"});case"max":return s.jsx("span",{className:"text-[8px] font-black text-white bg-red-600 px-1 rounded",children:"MAX"});case"top":return s.jsx(en,{className:"w-3 h-3 text-blue-500"});default:return null}},WZ=({user:n,onEdit:e,onDelete:t,onApprove:r,onBlock:i,onUnblock:o,onGift:c,isPrimaryAdmin:u})=>{const{dateStr:h,timeStr:m,dayStr:p}=(()=>{try{const T=new Date(n.createdAt);if(isNaN(T.getTime()))return{dateStr:"--",timeStr:"--",dayStr:""};const k=T.toLocaleDateString("ar-EG-u-nu-latn",{weekday:"long"}),E=T.toLocaleDateString("ar-EG-u-nu-latn",{year:"numeric",month:"short",day:"numeric"}),S=T.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric"});return{dateStr:E,timeStr:S,dayStr:k}}catch{return{dateStr:"--",timeStr:"--",dayStr:""}}})(),b=$Z(n.status),v=qZ(n.role);HZ(n.specialFrame);const _=n.status==="blocked";return n.specialFrame&&kh[n.specialFrame],s.jsxs("div",{className:`group relative rounded-2xl border shadow-lg transition-all duration-300 overflow-hidden flex flex-col h-full ${_?"bg-red-950/20 border-red-500/30":"bg-gray-800 border-gray-700/50 hover:border-gray-600 hover:shadow-xl"}`,children:[s.jsx("div",{className:`absolute top-0 right-0 w-1.5 h-full bg-${b}-500 opacity-80`}),s.jsxs("div",{className:"p-5 flex-1",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"relative w-14 h-14 flex items-center justify-center",children:s.jsx(Ji,{frameId:n.specialFrame,size:"md",className:`${_?"grayscale":""}`,children:s.jsx("div",{className:"w-full h-full rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border border-gray-800",children:n.storeImage?s.jsx("img",{src:n.storeImage,alt:n.name,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-7 h-7 text-gray-400"})})})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("h3",{className:"font-bold text-white text-lg leading-tight truncate max-w-[120px]",title:n.name,children:n.name}),GZ(n.specialBadge)]}),s.jsx("div",{className:`inline-flex items-center px-2 py-0.5 mt-1 rounded text-[10px] font-bold border ${v.bg} ${v.text} ${v.border}`,children:v.label})]})]}),s.jsx("div",{className:`px-2.5 py-1 rounded-lg text-[10px] font-bold bg-${b}-500/10 text-${b}-400 border border-${b}-500/20`,children:zZ(n.status)})]}),s.jsxs("div",{className:`rounded-xl p-3 space-y-2.5 border ${_?"bg-red-900/10 border-red-500/20":"bg-[#1a1a1a]/60 border-gray-700/30"}`,children:[s.jsxs("div",{className:"flex items-center text-gray-300 text-xs font-medium",children:[s.jsx(zn,{className:"w-3.5 h-3.5 text-gray-500 ml-2"}),s.jsx("span",{className:"font-mono dir-ltr selectable",children:n.phone||" "})]}),n.address&&s.jsxs("div",{className:"flex items-start text-gray-400 text-[11px] leading-snug",children:[s.jsx(fs,{className:"w-3.5 h-3.5 text-gray-600 ml-2 mt-0.5 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:n.address})]}),s.jsx("div",{className:"pt-2 mt-2 border-t border-gray-700/50 flex flex-col gap-1.5",children:s.jsx("div",{className:"flex items-center justify-between text-[10px] text-gray-400",children:s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(ei,{className:"w-3 h-3 text-gray-500"}),s.jsxs("span",{children:[p," ",h]})]})})})]})]}),s.jsxs("div",{className:`px-4 py-3 border-t flex justify-between items-center ${_?"bg-red-900/30 border-red-500/30":"bg-[#151515] border-gray-700/50"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[n.status==="pending"&&r&&s.jsxs("button",{onClick:()=>r(n.id),className:"flex-1 flex items-center justify-center text-xs bg-green-600 hover:bg-green-500 text-white font-bold px-3 py-2 rounded-lg shadow-lg shadow-green-900/20 transition-all active:scale-95 clickable",children:[s.jsx(Je,{className:"w-3.5 h-3.5 ml-1.5"}),""]}),_?o&&!u&&s.jsxs("button",{onClick:()=>o(n),className:"flex-1 flex items-center justify-center text-xs bg-green-500/10 hover:bg-green-500/20 text-green-400 border border-green-500/20 font-bold px-3 py-2 rounded-lg transition-all active:scale-95 clickable",title:" ",children:[s.jsx(mZ,{className:"w-3.5 h-3.5 ml-1.5"})," "]}):i&&!u&&s.jsx("button",{onClick:()=>i(n),className:"p-2 text-gray-400 hover:text-white hover:bg-red-600 rounded-lg transition-colors border border-gray-600 hover:border-red-500 clickable",title:" ",children:s.jsx(fZ,{className:"w-4 h-4"})}),e&&s.jsx("button",{onClick:()=>e(n),className:"p-2 text-blue-400 hover:text-white hover:bg-blue-600 rounded-lg transition-colors border border-blue-500/20 bg-blue-500/10 clickable",title:"",children:s.jsx(Js,{className:"w-4 h-4"})}),c&&s.jsx("button",{onClick:()=>c(n),className:"p-2 text-yellow-400 hover:text-white hover:bg-yellow-600 rounded-lg transition-colors border border-yellow-500/20 bg-yellow-500/10 clickable",title:" /",children:s.jsx(RZ,{className:"w-4 h-4"})})]}),t&&!u&&s.jsx("button",{onClick:()=>t(n),className:"p-2 text-red-400 hover:text-white hover:bg-red-600 rounded-lg transition-colors border border-blue-500/20 bg-red-500/10 mr-2 clickable",title:"",children:s.jsx(Tt,{className:"w-4 h-4"})})]})]})},KZ=({user:n,onClose:e,onSave:t})=>{const[r,i]=w.useState(n.specialFrame),o=()=>{t(n.id,r),e()},c=()=>{t(n.id,void 0),e()};return s.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fadeIn",children:s.jsxs("div",{className:"bg-gray-800 rounded-3xl shadow-2xl w-full max-w-lg border border-gray-700/50 flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-700/50",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-white",children:"  "}),s.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["  : ",s.jsx("span",{className:"text-white font-bold",children:n.name})]})]}),s.jsx("button",{onClick:e,className:"p-2 bg-gray-700/50 hover:bg-gray-700 rounded-full text-gray-400 transition-colors",children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar",children:s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:[s.jsxs("button",{onClick:()=>i(void 0),className:`relative group rounded-2xl p-4 border transition-all duration-300 flex flex-col items-center gap-3 ${r===void 0?"bg-red-500/10 border-red-500":"bg-gray-900 border-gray-700 hover:border-gray-600"}`,children:[s.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-700 flex items-center justify-center border border-gray-600",children:s.jsx("span",{className:"text-xs text-gray-400",children:" "})}),s.jsx("span",{className:`text-sm font-bold ${r===void 0?"text-red-400":"text-gray-400"}`,children:""}),r===void 0&&s.jsx("div",{className:"absolute top-2 right-2 bg-red-500 rounded-full p-0.5",children:s.jsx(Je,{className:"w-4 h-4 text-white"})})]}),Object.entries(kh).map(([u,h])=>{const m=r===u;return s.jsxs("button",{onClick:()=>i(u),className:`relative group rounded-2xl p-4 border transition-all duration-300 flex flex-col items-center gap-3 ${m?"bg-red-500/10 border-red-500 shadow-[0_0_15px_rgba(239,68,68,0.2)]":"bg-gray-900 border-gray-700 hover:border-gray-500"}`,children:[s.jsx(Ji,{frameId:u,size:"md",className:m?"scale-110 transition-transform":"",children:s.jsx("div",{className:"w-full h-full bg-gray-600 flex items-center justify-center text-xs font-bold text-gray-300",children:n.name.charAt(0)})}),s.jsx("span",{className:`text-sm font-bold ${m?"text-red-400":"text-gray-400"}`,children:h.name}),m&&s.jsx("div",{className:"absolute top-2 right-2 bg-red-500 rounded-full p-0.5 shadow-lg",children:s.jsx(Je,{className:"w-4 h-4 text-white"})})]},u)})]})}),s.jsxs("div",{className:"p-5 border-t border-gray-700/50 flex gap-3 bg-gray-800/50 rounded-b-3xl",children:[s.jsxs("button",{onClick:o,className:"flex-1 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white py-3 rounded-xl font-bold shadow-lg shadow-red-900/40 transition-all active:scale-95 flex items-center justify-center gap-2",children:[s.jsx(Je,{className:"w-5 h-5"})," "]}),n.specialFrame&&s.jsxs("button",{onClick:c,className:"px-4 bg-gray-700 hover:bg-red-900/40 text-gray-300 hover:text-red-400 border border-gray-600 hover:border-red-500/50 rounded-xl font-bold transition-all active:scale-95 flex items-center justify-center gap-2",children:[s.jsx(Tt,{className:"w-5 h-5"}),s.jsx("span",{className:"hidden sm:inline",children:" "})]})]})]})})},_O=({users:n,updateUser:e,onDeleteUser:t,onAdminAddUser:r,setEditingUser:i,onViewUser:o,permissions:c,appName:u,currentUser:h})=>{const[m,p]=w.useState(null),[b,v]=w.useState(null),[_,T]=w.useState(null),[k,E]=w.useState(null),[S,L]=w.useState(!1),[$,H]=w.useState("drivers"),[G,z]=w.useState(""),P=!c||c.includes("manage_users"),j=(h==null?void 0:h.role)==="supervisor",{drivers:O,merchants:I,customers:R,supervisors:F,admins:M,blocked:ne}=w.useMemo(()=>{const re=n.filter(ie=>ie.status!=="blocked"),ce=n.filter(ie=>ie.status==="blocked"),he=!j||c&&c.includes("manage_supervisors"),Oe=re.filter(ie=>ie.role==="driver"),Ue=re.filter(ie=>ie.role==="merchant"),st=re.filter(ie=>ie.role==="customer"),fe=re.filter(ie=>ie.role==="supervisor"&&he),K=re.filter(ie=>ie.role==="admin");return{drivers:Oe,merchants:Ue,customers:st,supervisors:fe,admins:K,blocked:ce}},[n,j,c]),U=w.useMemo(()=>{const re=!j||c&&c.includes("manage_supervisors"),ce=[{id:"drivers",label:"",data:O,color:"text-orange-400"},{id:"merchants",label:"",data:I,color:"text-purple-400"},{id:"customers",label:"",data:R,color:"text-blue-400"}];return re&&ce.push({id:"supervisors",label:"",data:F,color:"text-yellow-400"}),j||ce.push({id:"admins",label:"",data:M,color:"text-red-400"}),ce.push({id:"blocked",label:"",data:ne,color:"text-red-500"}),ce},[O,I,R,F,M,ne,j,c]),A=U.find(re=>re.id===$)||U[0],V=w.useMemo(()=>{const re=A.data;return G?re.filter(ce=>ce.name.toLowerCase().includes(G.toLowerCase())||ce.phone&&ce.phone.includes(G)||ce.id.includes(G)):re},[A,G]),Q=A.label,ae=re=>P?!h||h.role==="admin"?!0:h.role==="supervisor"?!(re.id===h.id||re.role==="admin"||re.role==="supervisor"):!1:!1;sn(()=>S?(L(!1),!0):m?(p(null),!0):b?(v(null),!0):_?(T(null),!0):k?(E(null),!0):!1,[S,m,b,_,k]);const X=re=>{try{window.history.pushState({view:"users",modal:re},"",window.location.pathname)}catch{}},B=()=>{var re;(re=window.history.state)!=null&&re.modal?window.history.back():(L(!1),p(null),v(null),T(null),E(null))};w.useEffect(()=>{const re=ce=>{var he;(he=ce.state)!=null&&he.modal||(L(!1),p(null),v(null),T(null),E(null))};return window.addEventListener("popstate",re),()=>window.removeEventListener("popstate",re)},[]);const Y=()=>{m&&t(m.id),B()},ge=()=>{b&&e(b.id,{status:"blocked"}),B()},Z=()=>{_&&e(_.id,{status:"active"}),B()},te=async(re,ce)=>{var Oe;e(re,{specialFrame:ce||"none"}),E(null);const he=n.find(Ue=>Ue.id===re);if(he&&ce){const Ue=((Oe=kh[ce])==null?void 0:Oe.name)||" ";(await Z1(()=>Promise.resolve().then(()=>Y1),void 0,import.meta.url)).sendExternalNotification(he.role,{title:"! ",body:`    "${Ue}"   !`,targetId:re,url:"/?target=profile"})}},me=async re=>{const ce=await r(re);B(),ce&&o&&setTimeout(()=>{o(ce)},100)};return s.jsxs("div",{className:"space-y-6 pb-32 animate-fadeIn relative w-full overflow-x-hidden",children:[s.jsxs("div",{className:"pb-2 -mx-4 px-4 sm:-mx-6 sm:px-6 lg:-mx-8 lg:px-8 transition-all",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-gray-800/60 backdrop-blur-md p-4 rounded-2xl border border-gray-700/50 shadow-lg mb-4 mt-1",children:[s.jsxs("div",{className:"relative w-full md:w-auto md:flex-1 max-w-md",children:[s.jsx(mr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 w-5 h-5"}),s.jsx("input",{type:"text",placeholder:`  ${Q}...`,value:G,onChange:re=>z(re.target.value),className:"w-full bg-gray-900/80 text-white text-sm rounded-xl py-2.5 pr-10 pl-4 border border-gray-700 focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all placeholder-gray-500"})]}),P&&$!=="blocked"&&s.jsxs("button",{onClick:()=>{X("addUser"),L(!0)},className:"w-full md:w-auto flex items-center justify-center gap-2 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white px-6 py-2.5 rounded-xl shadow-lg shadow-red-900/30 transition-all active:scale-95 group",children:[s.jsx("div",{className:"bg-white/20 p-1 rounded-full group-hover:rotate-90 transition-transform duration-300",children:s.jsx(bZ,{className:"w-4 h-4"})}),s.jsx("span",{className:"font-bold text-sm",children:" "})]})]}),s.jsx("div",{className:"relative",children:s.jsx("div",{className:"flex overflow-x-auto pb-2 scrollbar-hide gap-2 sm:gap-3 bg-gray-900/95",children:U.map(re=>{const ce=$===re.id,he=re.id==="blocked";return s.jsxs("button",{onClick:()=>H(re.id),className:`
                        relative flex-shrink-0 flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-bold transition-all duration-300 border
                        ${ce?he?"bg-red-900/40 text-red-200 border-red-500 shadow-md transform scale-105 z-10":"bg-gray-800 text-white border-gray-600 shadow-md transform scale-105 z-10":"bg-gray-800/40 text-gray-400 border-transparent hover:bg-gray-800/80 hover:text-gray-200"}
                      `,children:[s.jsx("span",{className:`w-2 h-2 rounded-full ${ce?"bg-red-500 animate-pulse":"bg-gray-600"}`}),re.label,s.jsx("span",{className:`mr-1 px-1.5 py-0.5 rounded-md text-[10px] ${ce?"bg-white/10 text-white":"bg-black/20 text-gray-500"}`,children:re.data.length}),ce&&s.jsx("div",{className:"absolute bottom-0 left-3 right-3 h-0.5 bg-red-500 rounded-full shadow-[0_0_10px_rgba(239,68,68,0.5)]"})]},re.id)})})})]}),V.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 animate-slide-up mt-2",children:V.map((re,ce)=>{const he=ae(re);return s.jsx("div",{style:{animationDelay:`${ce*50}ms`},className:"animate-fade-slide-up",children:s.jsx(WZ,{user:re,onEdit:he?i:void 0,onDelete:he?Oe=>{X("deleteUser"),p(Oe)}:void 0,onApprove:he?Oe=>e(Oe,{status:"active"}):void 0,onBlock:he?Oe=>{X("blockUser"),v(Oe)}:void 0,onUnblock:he?Oe=>{X("unblockUser"),T(Oe)}:void 0,onGift:(h==null?void 0:h.role)==="admin"?Oe=>{X("giftUser"),E(Oe)}:void 0,isPrimaryAdmin:re.id==="5"})},re.id)})}):s.jsxs("div",{className:"flex flex-col items-center justify-center py-24 bg-gray-800/30 rounded-3xl border border-dashed border-gray-700/50 mt-4",children:[s.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4 shadow-inner",children:s.jsx(Md,{className:"w-10 h-10 text-gray-600 opacity-50"})}),s.jsx("h3",{className:"text-xl font-bold text-gray-300",children:"  "}),s.jsx("p",{className:"text-gray-500 text-sm mt-1",children:G?`     "${G}"`:` ${Q}  .`}),P&&!G&&$!=="blocked"&&s.jsxs("button",{onClick:()=>{X("addUser"),L(!0)},className:"mt-6 text-red-400 hover:text-red-300 text-sm font-bold underline underline-offset-4",children:[" ",Q.slice(0,-1)," "]})]}),m&&s.jsx(jn,{title:"  ",message:`     ${QZ(m.role)}: ${m.name}.   `,onConfirm:Y,onClose:B,confirmButtonText:" ",cancelButtonText:"",confirmVariant:"danger"}),b&&s.jsx(jn,{title:" ",message:`      ${b.name}       .`,onConfirm:ge,onClose:B,confirmButtonText:" ",cancelButtonText:"",confirmVariant:"danger"}),_&&s.jsx(jn,{title:" ",message:`        ${_.name}      .`,onConfirm:Z,onClose:B,confirmButtonText:" ",cancelButtonText:"",confirmVariant:"success"}),k&&s.jsx(KZ,{user:k,onClose:B,onSave:te}),S&&s.jsx(BZ,{onClose:B,onSave:me,initialRole:$==="customers"?"customer":$==="admins"?"admin":$.slice(0,-1),appName:u,currentUserRole:h==null?void 0:h.role,currentUserPermissions:c})]})},QZ=n=>{switch(n){case"driver":return"";case"merchant":return"";case"admin":return"";case"supervisor":return"";case"customer":return"";default:return""}};var eN=function(n,e){return eN=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},eN(n,e)};function YZ(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");eN(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var _s=function(){return _s=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},_s.apply(this,arguments)};var v_,r4;function XZ(){if(r4)return v_;r4=1;var n=!1,e,t,r,i,o,c,u,h,m,p,b,v,_,T,k;function E(){if(!n){n=!0;var L=navigator.userAgent,$=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(L),H=/(Mac OS X)|(Windows)|(Linux)/.exec(L);if(v=/\b(iPhone|iP[ao]d)/.exec(L),_=/\b(iP[ao]d)/.exec(L),p=/Android/i.exec(L),T=/FBAN\/\w+;/i.exec(L),k=/Mobile/i.exec(L),b=!!/Win64/.exec(L),$){e=$[1]?parseFloat($[1]):$[5]?parseFloat($[5]):NaN,e&&document&&document.documentMode&&(e=document.documentMode);var G=/(?:Trident\/(\d+.\d+))/.exec(L);c=G?parseFloat(G[1])+4:e,t=$[2]?parseFloat($[2]):NaN,r=$[3]?parseFloat($[3]):NaN,i=$[4]?parseFloat($[4]):NaN,i?($=/(?:Chrome\/(\d+\.\d+))/.exec(L),o=$&&$[1]?parseFloat($[1]):NaN):o=NaN}else e=t=r=o=i=NaN;if(H){if(H[1]){var z=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(L);u=z?parseFloat(z[1].replace("_",".")):!0}else u=!1;h=!!H[2],m=!!H[3]}else u=h=m=!1}}var S={ie:function(){return E()||e},ieCompatibilityMode:function(){return E()||c>e},ie64:function(){return S.ie()&&b},firefox:function(){return E()||t},opera:function(){return E()||r},webkit:function(){return E()||i},safari:function(){return S.webkit()},chrome:function(){return E()||o},windows:function(){return E()||h},osx:function(){return E()||u},linux:function(){return E()||m},iphone:function(){return E()||v},mobile:function(){return E()||v||_||p||k},nativeApp:function(){return E()||T},android:function(){return E()||p},ipad:function(){return E()||_}};return v_=S,v_}var w_,i4;function JZ(){if(i4)return w_;i4=1;var n=!!(typeof window<"u"&&window.document&&window.document.createElement),e={canUseDOM:n,canUseWorkers:typeof Worker<"u",canUseEventListeners:n&&!!(window.addEventListener||window.attachEvent),canUseViewport:n&&!!window.screen,isInWorker:!n};return w_=e,w_}var __,a4;function ZZ(){if(a4)return __;a4=1;var n=JZ(),e;n.canUseDOM&&(e=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */function t(r,i){if(!n.canUseDOM||i&&!("addEventListener"in document))return!1;var o="on"+r,c=o in document;if(!c){var u=document.createElement("div");u.setAttribute(o,"return;"),c=typeof u[o]=="function"}return!c&&e&&r==="wheel"&&(c=document.implementation.hasFeature("Events.wheel","3.0")),c}return __=t,__}var N_,o4;function eee(){if(o4)return N_;o4=1;var n=XZ(),e=ZZ(),t=10,r=40,i=800;function o(c){var u=0,h=0,m=0,p=0;return"detail"in c&&(h=c.detail),"wheelDelta"in c&&(h=-c.wheelDelta/120),"wheelDeltaY"in c&&(h=-c.wheelDeltaY/120),"wheelDeltaX"in c&&(u=-c.wheelDeltaX/120),"axis"in c&&c.axis===c.HORIZONTAL_AXIS&&(u=h,h=0),m=u*t,p=h*t,"deltaY"in c&&(p=c.deltaY),"deltaX"in c&&(m=c.deltaX),(m||p)&&c.deltaMode&&(c.deltaMode==1?(m*=r,p*=r):(m*=i,p*=i)),m&&!u&&(u=m<1?-1:1),p&&!h&&(h=p<1?-1:1),{spinX:u,spinY:h,pixelX:m,pixelY:p}}return o.getEventType=function(){return n.firefox()?"DOMMouseScroll":e("wheel")?"wheel":"mousewheel"},N_=o,N_}var j_,l4;function tee(){return l4||(l4=1,j_=eee()),j_}var nee=tee();const see=j4(nee);function ree(n,e,t,r,i,o){o===void 0&&(o=0);var c=Rh(n,e,o),u=c.width,h=c.height,m=Math.min(u,t),p=Math.min(h,r);return m>p*i?{width:p*i,height:p}:{width:m,height:m/i}}function iee(n){return n.width>n.height?n.width/n.naturalWidth:n.height/n.naturalHeight}function mm(n,e,t,r,i){i===void 0&&(i=0);var o=Rh(e.width,e.height,i),c=o.width,u=o.height;return{x:c4(n.x,c,t.width,r),y:c4(n.y,u,t.height,r)}}function c4(n,e,t,r){var i=e*r/2-t/2;return Ry(n,-i,i)}function d4(n,e){return Math.sqrt(Math.pow(n.y-e.y,2)+Math.pow(n.x-e.x,2))}function u4(n,e){return Math.atan2(e.y-n.y,e.x-n.x)*180/Math.PI}function aee(n,e,t,r,i,o,c){o===void 0&&(o=0),c===void 0&&(c=!0);var u=c?oee:lee,h=Rh(e.width,e.height,o),m=Rh(e.naturalWidth,e.naturalHeight,o),p={x:u(100,((h.width-t.width/i)/2-n.x/i)/h.width*100),y:u(100,((h.height-t.height/i)/2-n.y/i)/h.height*100),width:u(100,t.width/h.width*100/i),height:u(100,t.height/h.height*100/i)},b=Math.round(u(m.width,p.width*m.width/100)),v=Math.round(u(m.height,p.height*m.height/100)),_=m.width>=m.height*r,T=_?{width:Math.round(v*r),height:v}:{width:b,height:Math.round(b/r)},k=_s(_s({},T),{x:Math.round(u(m.width-T.width,p.x*m.width/100)),y:Math.round(u(m.height-T.height,p.y*m.height/100))});return{croppedAreaPercentages:p,croppedAreaPixels:k}}function oee(n,e){return Math.min(n,Math.max(0,e))}function lee(n,e){return e}function cee(n,e,t,r,i,o){var c=Rh(e.width,e.height,t),u=Ry(r.width/c.width*(100/n.width),i,o),h={x:u*c.width/2-r.width/2-c.width*u*(n.x/100),y:u*c.height/2-r.height/2-c.height*u*(n.y/100)};return{crop:h,zoom:u}}function dee(n,e,t){var r=iee(e);return t.height>t.width?t.height/(n.height*r):t.width/(n.width*r)}function uee(n,e,t,r,i,o){t===void 0&&(t=0);var c=Rh(e.naturalWidth,e.naturalHeight,t),u=Ry(dee(n,e,r),i,o),h=r.height>r.width?r.height/n.height:r.width/n.width,m={x:((c.width-n.width)/2-n.x)*h,y:((c.height-n.height)/2-n.y)*h};return{crop:m,zoom:u}}function h4(n,e){return{x:(e.x+n.x)/2,y:(e.y+n.y)/2}}function hee(n){return n*Math.PI/180}function Rh(n,e,t){var r=hee(t);return{width:Math.abs(Math.cos(r)*n)+Math.abs(Math.sin(r)*e),height:Math.abs(Math.sin(r)*n)+Math.abs(Math.cos(r)*e)}}function Ry(n,e,t){return Math.min(Math.max(n,e),t)}function Xp(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.filter(function(t){return typeof t=="string"&&t.length>0}).join(" ").trim()}var fee=`.reactEasyCrop_Container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  user-select: none;
  touch-action: none;
  cursor: move;
  display: flex;
  justify-content: center;
  align-items: center;
}

.reactEasyCrop_Image,
.reactEasyCrop_Video {
  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */
}

.reactEasyCrop_Contain {
  max-width: 100%;
  max-height: 100%;
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}
.reactEasyCrop_Cover_Horizontal {
  width: 100%;
  height: auto;
}
.reactEasyCrop_Cover_Vertical {
  width: auto;
  height: 100%;
}

.reactEasyCrop_CropArea {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
  box-shadow: 0 0 0 9999em;
  color: rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.reactEasyCrop_CropAreaRound {
  border-radius: 50%;
}

.reactEasyCrop_CropAreaGrid::before {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 0;
  bottom: 0;
  left: 33.33%;
  right: 33.33%;
  border-top: 0;
  border-bottom: 0;
}

.reactEasyCrop_CropAreaGrid::after {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 33.33%;
  bottom: 33.33%;
  left: 0;
  right: 0;
  border-left: 0;
  border-right: 0;
}
`,mee=1,gee=3,pee=1,xee=(function(n){YZ(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.cropperRef=w.createRef(),t.imageRef=w.createRef(),t.videoRef=w.createRef(),t.containerPosition={x:0,y:0},t.containerRef=null,t.styleRef=null,t.containerRect=null,t.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},t.dragStartPosition={x:0,y:0},t.dragStartCrop={x:0,y:0},t.gestureZoomStart=0,t.gestureRotationStart=0,t.isTouching=!1,t.lastPinchDistance=0,t.lastPinchRotation=0,t.rafDragTimeout=null,t.rafPinchTimeout=null,t.wheelTimer=null,t.currentDoc=typeof document<"u"?document:null,t.currentWindow=typeof window<"u"?window:null,t.resizeObserver=null,t.previousCropSize=null,t.isInitialized=!1,t.state={cropSize:null,hasWheelJustStarted:!1,mediaObjectFit:void 0},t.initResizeObserver=function(){if(!(typeof window.ResizeObserver>"u"||!t.containerRef)){var r=!0;t.resizeObserver=new window.ResizeObserver(function(i){if(r){r=!1;return}t.computeSizes()}),t.resizeObserver.observe(t.containerRef)}},t.preventZoomSafari=function(r){return r.preventDefault()},t.cleanEvents=function(){t.currentDoc&&(t.currentDoc.removeEventListener("mousemove",t.onMouseMove),t.currentDoc.removeEventListener("mouseup",t.onDragStopped),t.currentDoc.removeEventListener("touchmove",t.onTouchMove),t.currentDoc.removeEventListener("touchend",t.onDragStopped),t.currentDoc.removeEventListener("gesturechange",t.onGestureChange),t.currentDoc.removeEventListener("gestureend",t.onGestureEnd),t.currentDoc.removeEventListener("scroll",t.onScroll))},t.clearScrollEvent=function(){t.containerRef&&t.containerRef.removeEventListener("wheel",t.onWheel),t.wheelTimer&&clearTimeout(t.wheelTimer)},t.onMediaLoad=function(){var r=t.computeSizes();r&&(t.previousCropSize=r,t.emitCropData(),t.setInitialCrop(r),t.isInitialized=!0),t.props.onMediaLoaded&&t.props.onMediaLoaded(t.mediaSize)},t.setInitialCrop=function(r){if(t.props.initialCroppedAreaPercentages){var i=cee(t.props.initialCroppedAreaPercentages,t.mediaSize,t.props.rotation,r,t.props.minZoom,t.props.maxZoom),o=i.crop,c=i.zoom;t.props.onCropChange(o),t.props.onZoomChange&&t.props.onZoomChange(c)}else if(t.props.initialCroppedAreaPixels){var u=uee(t.props.initialCroppedAreaPixels,t.mediaSize,t.props.rotation,r,t.props.minZoom,t.props.maxZoom),o=u.crop,c=u.zoom;t.props.onCropChange(o),t.props.onZoomChange&&t.props.onZoomChange(c)}},t.computeSizes=function(){var r,i,o,c,u,h,m=t.imageRef.current||t.videoRef.current;if(m&&t.containerRef){t.containerRect=t.containerRef.getBoundingClientRect(),t.saveContainerPosition();var p=t.containerRect.width/t.containerRect.height,b=((r=t.imageRef.current)===null||r===void 0?void 0:r.naturalWidth)||((i=t.videoRef.current)===null||i===void 0?void 0:i.videoWidth)||0,v=((o=t.imageRef.current)===null||o===void 0?void 0:o.naturalHeight)||((c=t.videoRef.current)===null||c===void 0?void 0:c.videoHeight)||0,_=m.offsetWidth<b||m.offsetHeight<v,T=b/v,k=void 0;if(_)switch(t.state.mediaObjectFit){default:case"contain":k=p>T?{width:t.containerRect.height*T,height:t.containerRect.height}:{width:t.containerRect.width,height:t.containerRect.width/T};break;case"horizontal-cover":k={width:t.containerRect.width,height:t.containerRect.width/T};break;case"vertical-cover":k={width:t.containerRect.height*T,height:t.containerRect.height};break}else k={width:m.offsetWidth,height:m.offsetHeight};t.mediaSize=_s(_s({},k),{naturalWidth:b,naturalHeight:v}),t.props.setMediaSize&&t.props.setMediaSize(t.mediaSize);var E=t.props.cropSize?t.props.cropSize:ree(t.mediaSize.width,t.mediaSize.height,t.containerRect.width,t.containerRect.height,t.props.aspect,t.props.rotation);return(((u=t.state.cropSize)===null||u===void 0?void 0:u.height)!==E.height||((h=t.state.cropSize)===null||h===void 0?void 0:h.width)!==E.width)&&t.props.onCropSizeChange&&t.props.onCropSizeChange(E),t.setState({cropSize:E},t.recomputeCropPosition),t.props.setCropSize&&t.props.setCropSize(E),E}},t.saveContainerPosition=function(){if(t.containerRef){var r=t.containerRef.getBoundingClientRect();t.containerPosition={x:r.left,y:r.top}}},t.onMouseDown=function(r){t.currentDoc&&(r.preventDefault(),t.currentDoc.addEventListener("mousemove",t.onMouseMove),t.currentDoc.addEventListener("mouseup",t.onDragStopped),t.saveContainerPosition(),t.onDragStart(e.getMousePoint(r)))},t.onMouseMove=function(r){return t.onDrag(e.getMousePoint(r))},t.onScroll=function(r){t.currentDoc&&(r.preventDefault(),t.saveContainerPosition())},t.onTouchStart=function(r){t.currentDoc&&(t.isTouching=!0,!(t.props.onTouchRequest&&!t.props.onTouchRequest(r))&&(t.currentDoc.addEventListener("touchmove",t.onTouchMove,{passive:!1}),t.currentDoc.addEventListener("touchend",t.onDragStopped),t.saveContainerPosition(),r.touches.length===2?t.onPinchStart(r):r.touches.length===1&&t.onDragStart(e.getTouchPoint(r.touches[0]))))},t.onTouchMove=function(r){r.preventDefault(),r.touches.length===2?t.onPinchMove(r):r.touches.length===1&&t.onDrag(e.getTouchPoint(r.touches[0]))},t.onGestureStart=function(r){t.currentDoc&&(r.preventDefault(),t.currentDoc.addEventListener("gesturechange",t.onGestureChange),t.currentDoc.addEventListener("gestureend",t.onGestureEnd),t.gestureZoomStart=t.props.zoom,t.gestureRotationStart=t.props.rotation)},t.onGestureChange=function(r){if(r.preventDefault(),!t.isTouching){var i=e.getMousePoint(r),o=t.gestureZoomStart-1+r.scale;if(t.setNewZoom(o,i,{shouldUpdatePosition:!0}),t.props.onRotationChange){var c=t.gestureRotationStart+r.rotation;t.props.onRotationChange(c)}}},t.onGestureEnd=function(r){t.cleanEvents()},t.onDragStart=function(r){var i,o,c=r.x,u=r.y;t.dragStartPosition={x:c,y:u},t.dragStartCrop=_s({},t.props.crop),(o=(i=t.props).onInteractionStart)===null||o===void 0||o.call(i)},t.onDrag=function(r){var i=r.x,o=r.y;t.currentWindow&&(t.rafDragTimeout&&t.currentWindow.cancelAnimationFrame(t.rafDragTimeout),t.rafDragTimeout=t.currentWindow.requestAnimationFrame(function(){if(t.state.cropSize&&!(i===void 0||o===void 0)){var c=i-t.dragStartPosition.x,u=o-t.dragStartPosition.y,h={x:t.dragStartCrop.x+c,y:t.dragStartCrop.y+u},m=t.props.restrictPosition?mm(h,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):h;t.props.onCropChange(m)}}))},t.onDragStopped=function(){var r,i;t.isTouching=!1,t.cleanEvents(),t.emitCropData(),(i=(r=t.props).onInteractionEnd)===null||i===void 0||i.call(r)},t.onWheel=function(r){if(t.currentWindow&&!(t.props.onWheelRequest&&!t.props.onWheelRequest(r))){r.preventDefault();var i=e.getMousePoint(r),o=see(r).pixelY,c=t.props.zoom-o*t.props.zoomSpeed/200;t.setNewZoom(c,i,{shouldUpdatePosition:!0}),t.state.hasWheelJustStarted||t.setState({hasWheelJustStarted:!0},function(){var u,h;return(h=(u=t.props).onInteractionStart)===null||h===void 0?void 0:h.call(u)}),t.wheelTimer&&clearTimeout(t.wheelTimer),t.wheelTimer=t.currentWindow.setTimeout(function(){return t.setState({hasWheelJustStarted:!1},function(){var u,h;return(h=(u=t.props).onInteractionEnd)===null||h===void 0?void 0:h.call(u)})},250)}},t.getPointOnContainer=function(r,i){var o=r.x,c=r.y;if(!t.containerRect)throw new Error("The Cropper is not mounted");return{x:t.containerRect.width/2-(o-i.x),y:t.containerRect.height/2-(c-i.y)}},t.getPointOnMedia=function(r){var i=r.x,o=r.y,c=t.props,u=c.crop,h=c.zoom;return{x:(i+u.x)/h,y:(o+u.y)/h}},t.setNewZoom=function(r,i,o){var c=o===void 0?{}:o,u=c.shouldUpdatePosition,h=u===void 0?!0:u;if(!(!t.state.cropSize||!t.props.onZoomChange)){var m=Ry(r,t.props.minZoom,t.props.maxZoom);if(h){var p=t.getPointOnContainer(i,t.containerPosition),b=t.getPointOnMedia(p),v={x:b.x*m-p.x,y:b.y*m-p.y},_=t.props.restrictPosition?mm(v,t.mediaSize,t.state.cropSize,m,t.props.rotation):v;t.props.onCropChange(_)}t.props.onZoomChange(m)}},t.getCropData=function(){if(!t.state.cropSize)return null;var r=t.props.restrictPosition?mm(t.props.crop,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):t.props.crop;return aee(r,t.mediaSize,t.state.cropSize,t.getAspect(),t.props.zoom,t.props.rotation,t.props.restrictPosition)},t.emitCropData=function(){var r=t.getCropData();if(r){var i=r.croppedAreaPercentages,o=r.croppedAreaPixels;t.props.onCropComplete&&t.props.onCropComplete(i,o),t.props.onCropAreaChange&&t.props.onCropAreaChange(i,o)}},t.emitCropAreaChange=function(){var r=t.getCropData();if(r){var i=r.croppedAreaPercentages,o=r.croppedAreaPixels;t.props.onCropAreaChange&&t.props.onCropAreaChange(i,o)}},t.recomputeCropPosition=function(){var r,i;if(t.state.cropSize){var o=t.props.crop;if(t.isInitialized&&(!((r=t.previousCropSize)===null||r===void 0)&&r.width)&&(!((i=t.previousCropSize)===null||i===void 0)&&i.height)){var c=Math.abs(t.previousCropSize.width-t.state.cropSize.width)>1e-6||Math.abs(t.previousCropSize.height-t.state.cropSize.height)>1e-6;if(c){var u=t.state.cropSize.width/t.previousCropSize.width,h=t.state.cropSize.height/t.previousCropSize.height;o={x:t.props.crop.x*u,y:t.props.crop.y*h}}}var m=t.props.restrictPosition?mm(o,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):o;t.previousCropSize=t.state.cropSize,t.props.onCropChange(m),t.emitCropData()}},t.onKeyDown=function(r){var i,o,c=t.props,u=c.crop,h=c.onCropChange,m=c.keyboardStep,p=c.zoom,b=c.rotation,v=m;if(t.state.cropSize){r.shiftKey&&(v*=.2);var _=_s({},u);switch(r.key){case"ArrowUp":_.y-=v,r.preventDefault();break;case"ArrowDown":_.y+=v,r.preventDefault();break;case"ArrowLeft":_.x-=v,r.preventDefault();break;case"ArrowRight":_.x+=v,r.preventDefault();break;default:return}t.props.restrictPosition&&(_=mm(_,t.mediaSize,t.state.cropSize,p,b)),r.repeat||(o=(i=t.props).onInteractionStart)===null||o===void 0||o.call(i),h(_)}},t.onKeyUp=function(r){var i,o;switch(r.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":r.preventDefault();break;default:return}t.emitCropData(),(o=(i=t.props).onInteractionEnd)===null||o===void 0||o.call(i)},t}return e.prototype.componentDidMount=function(){!this.currentDoc||!this.currentWindow||(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),typeof window.ResizeObserver>"u"&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.currentDoc.addEventListener("scroll",this.onScroll),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=fee,this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef),this.props.setCropperRef&&this.props.setCropperRef(this.cropperRef))},e.prototype.componentWillUnmount=function(){var t,r;!this.currentDoc||!this.currentWindow||(typeof window.ResizeObserver>"u"&&this.currentWindow.removeEventListener("resize",this.computeSizes),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&((r=this.styleRef.parentNode)===null||r===void 0||r.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},e.prototype.componentDidUpdate=function(t){var r,i,o,c,u,h,m,p,b;t.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):t.aspect!==this.props.aspect?this.computeSizes():t.objectFit!==this.props.objectFit?this.computeSizes():t.zoom!==this.props.zoom?this.recomputeCropPosition():((r=t.cropSize)===null||r===void 0?void 0:r.height)!==((i=this.props.cropSize)===null||i===void 0?void 0:i.height)||((o=t.cropSize)===null||o===void 0?void 0:o.width)!==((c=this.props.cropSize)===null||c===void 0?void 0:c.width)?this.computeSizes():(((u=t.crop)===null||u===void 0?void 0:u.x)!==((h=this.props.crop)===null||h===void 0?void 0:h.x)||((m=t.crop)===null||m===void 0?void 0:m.y)!==((p=this.props.crop)===null||p===void 0?void 0:p.y))&&this.emitCropAreaChange(),t.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),t.video!==this.props.video&&((b=this.videoRef.current)===null||b===void 0||b.load());var v=this.getObjectFit();v!==this.state.mediaObjectFit&&this.setState({mediaObjectFit:v},this.computeSizes)},e.prototype.getAspect=function(){var t=this.props,r=t.cropSize,i=t.aspect;return r?r.width/r.height:i},e.prototype.getObjectFit=function(){var t,r,i,o;if(this.props.objectFit==="cover"){var c=this.imageRef.current||this.videoRef.current;if(c&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var u=this.containerRect.width/this.containerRect.height,h=((t=this.imageRef.current)===null||t===void 0?void 0:t.naturalWidth)||((r=this.videoRef.current)===null||r===void 0?void 0:r.videoWidth)||0,m=((i=this.imageRef.current)===null||i===void 0?void 0:i.naturalHeight)||((o=this.videoRef.current)===null||o===void 0?void 0:o.videoHeight)||0,p=h/m;return p<u?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},e.prototype.onPinchStart=function(t){var r=e.getTouchPoint(t.touches[0]),i=e.getTouchPoint(t.touches[1]);this.lastPinchDistance=d4(r,i),this.lastPinchRotation=u4(r,i),this.onDragStart(h4(r,i))},e.prototype.onPinchMove=function(t){var r=this;if(!(!this.currentDoc||!this.currentWindow)){var i=e.getTouchPoint(t.touches[0]),o=e.getTouchPoint(t.touches[1]),c=h4(i,o);this.onDrag(c),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var u=d4(i,o),h=r.props.zoom*(u/r.lastPinchDistance);r.setNewZoom(h,c,{shouldUpdatePosition:!1}),r.lastPinchDistance=u;var m=u4(i,o),p=r.props.rotation+(m-r.lastPinchRotation);r.props.onRotationChange&&r.props.onRotationChange(p),r.lastPinchRotation=m})}},e.prototype.render=function(){var t=this,r,i=this.props,o=i.image,c=i.video,u=i.mediaProps,h=i.cropperProps,m=i.transform,p=i.crop,b=p.x,v=p.y,_=i.rotation,T=i.zoom,k=i.cropShape,E=i.showGrid,S=i.roundCropAreaPixels,L=i.style,$=L.containerStyle,H=L.cropAreaStyle,G=L.mediaStyle,z=i.classes,P=z.containerClassName,j=z.cropAreaClassName,O=z.mediaClassName,I=(r=this.state.mediaObjectFit)!==null&&r!==void 0?r:this.getObjectFit();return w.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(F){return t.containerRef=F},"data-testid":"container",style:$,className:Xp("reactEasyCrop_Container",P)},o?w.createElement("img",_s({alt:"",className:Xp("reactEasyCrop_Image",I==="contain"&&"reactEasyCrop_Contain",I==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",I==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",O)},u,{src:o,ref:this.imageRef,style:_s(_s({},G),{transform:m||"translate(".concat(b,"px, ").concat(v,"px) rotate(").concat(_,"deg) scale(").concat(T,")")}),onLoad:this.onMediaLoad})):c&&w.createElement("video",_s({autoPlay:!0,playsInline:!0,loop:!0,muted:!0,className:Xp("reactEasyCrop_Video",I==="contain"&&"reactEasyCrop_Contain",I==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",I==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",O)},u,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:_s(_s({},G),{transform:m||"translate(".concat(b,"px, ").concat(v,"px) rotate(").concat(_,"deg) scale(").concat(T,")")}),controls:!1}),(Array.isArray(c)?c:[{src:c}]).map(function(R){return w.createElement("source",_s({key:R.src},R))})),this.state.cropSize&&w.createElement("div",_s({ref:this.cropperRef,style:_s(_s({},H),{width:S?Math.round(this.state.cropSize.width):this.state.cropSize.width,height:S?Math.round(this.state.cropSize.height):this.state.cropSize.height}),tabIndex:0,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,"data-testid":"cropper",className:Xp("reactEasyCrop_CropArea",k==="round"&&"reactEasyCrop_CropAreaRound",E&&"reactEasyCrop_CropAreaGrid",j)},h)))},e.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:gee,minZoom:mee,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},cropperProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0,keyboardStep:pee},e.getMousePoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},e.getTouchPoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},e})(w.Component);const h0=({imageSrc:n,onCropComplete:e,onClose:t,aspectRatio:r=1})=>{const[i,o]=w.useState({x:0,y:0}),[c,u]=w.useState(1),[h,m]=w.useState(0),[p,b]=w.useState(null),v=G=>{o(G)},_=G=>{u(G)},T=G=>{m(G)},k=w.useCallback((G,z)=>{b(z)},[]),E=G=>new Promise((z,P)=>{const j=new Image;j.addEventListener("load",()=>z(j)),j.addEventListener("error",O=>P(O)),j.setAttribute("crossOrigin","anonymous"),j.src=G}),S=G=>G*Math.PI/180,L=(G,z,P)=>{const j=S(P);return{width:Math.abs(Math.cos(j)*G)+Math.abs(Math.sin(j)*z),height:Math.abs(Math.sin(j)*G)+Math.abs(Math.cos(j)*z)}},$=async(G,z,P=0,j={horizontal:!1,vertical:!1})=>{const O=await E(G),I=document.createElement("canvas"),R=I.getContext("2d");if(!R)return null;const F=S(P),{width:M,height:ne}=L(O.width,O.height,P);I.width=M,I.height=ne,R.translate(M/2,ne/2),R.rotate(F),R.scale(j.horizontal?-1:1,j.vertical?-1:1),R.translate(-O.width/2,-O.height/2),R.drawImage(O,0,0);const U=R.getImageData(z.x,z.y,z.width,z.height);return I.width=z.width,I.height=z.height,R.putImageData(U,0,0),new Promise((A,V)=>{I.toBlob(Q=>{Q?A(Q):V(new Error("Canvas is empty"))},"image/jpeg",.9)})},H=async()=>{if(p)try{const G=await $(n,p,h);G&&(e(G),t())}catch(G){console.error(G)}};return s.jsxs("div",{className:"fixed inset-0 z-[200] bg-black/90 flex flex-col animate-fadeIn",children:[s.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-900 border-b border-gray-800 z-10",children:[s.jsx("h3",{className:"text-white font-bold text-lg",children:" "}),s.jsx("button",{onClick:t,className:"p-2 bg-gray-800 rounded-full text-gray-400 hover:text-white",children:s.jsx(ut,{className:"w-6 h-6"})})]}),s.jsx("div",{className:"flex-1 relative bg-black",children:s.jsx(xee,{image:n,crop:i,zoom:c,rotation:h,aspect:r,onCropChange:v,onCropComplete:k,onZoomChange:_,onRotationChange:T,classes:{containerClassName:"bg-black",cropAreaClassName:"border-2 border-white/50 shadow-[0_0_0_9999px_rgba(0,0,0,0.7)]"},showGrid:!0})}),s.jsx("div",{className:"p-6 bg-gray-900 border-t border-gray-800 pb-safe",children:s.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(Xj,{className:"w-5 h-5 text-gray-400"}),s.jsx("input",{type:"range",value:c,min:1,max:3,step:.1,"aria-labelledby":"Zoom",onChange:G=>u(Number(G.target.value)),className:"w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-500"}),s.jsx(hs,{className:"w-5 h-5 text-gray-400"})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(kZ,{className:"w-5 h-5 text-gray-400"}),s.jsx("input",{type:"range",value:h,min:0,max:360,step:90,"aria-labelledby":"Rotation",onChange:G=>m(Number(G.target.value)),className:"w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-500"}),s.jsxs("span",{className:"text-white text-xs w-8 text-center",children:[h,""]})]}),s.jsxs("div",{className:"flex gap-4 pt-2",children:[s.jsx("button",{onClick:t,className:"flex-1 py-3 bg-gray-800 text-gray-300 font-bold rounded-xl hover:bg-gray-700 transition-colors",children:""}),s.jsxs("button",{onClick:H,className:"flex-1 py-3 bg-blue-600 text-white font-bold rounded-xl hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[s.jsx(Je,{className:"w-5 h-5"})," "]})]})]})})]})},bee=[{id:"restaurant",label:""},{id:"market",label:" "},{id:"pharmacy",label:""},{id:"bakery",label:"/"},{id:"electronics",label:""},{id:"fashion",label:""},{id:"logistics",label:" "},{id:"other",label:""}],yee=[{title:" ",icon:s.jsx(Zt,{className:"w-5 h-5 text-blue-400"}),permissions:[{id:"view_orders",label:" ",desc:"   "},{id:"manage_orders",label:" ",desc:"   "},{id:"delete_orders",label:" ",desc:"    "}]},{title:" ",icon:s.jsx(Md,{className:"w-5 h-5 text-purple-400"}),permissions:[{id:"view_users",label:" ",desc:"   "},{id:"manage_users",label:" ",desc:"   "},{id:"manage_stores",label:" ",desc:"   "},{id:"manage_supervisors",label:" ",desc:"   "}]},{title:" ",icon:s.jsx(d0,{className:"w-5 h-5 text-green-400"}),permissions:[{id:"view_reports",label:" ",desc:"  "},{id:"view_wallet",label:" ",desc:"   "},{id:"view_logs",label:" ",desc:"  "},{id:"manage_advanced_financials",label:"   ",desc:"    "}]},{title:" ",icon:s.jsx(Ag,{className:"w-5 h-5 text-yellow-400"}),permissions:[{id:"manage_promo",label:" ",desc:"  "},{id:"manage_slider",label:" ",desc:"   "},{id:"send_messages",label:" ",desc:"  "},{id:"manage_decorations",label:"  ",desc:"    "}]},{title:" ",icon:s.jsx(Ei,{className:"w-5 h-5 text-indigo-400"}),permissions:[{id:"manage_support",label:"  ",desc:"    "},{id:"delete_support_messages",label:" ",desc:"   "}]}],e5=({user:n,onClose:e,onSave:t,isLastAdmin:r,isPrimaryAdmin:i,appName:o,currentUser:c})=>{var Zn,Ii,oc,Pr,ea;const u=(c==null?void 0:c.role)==="admin";console.log("[EditUserModal] Viewer Role:",c==null?void 0:c.role,"Is Admin?",u),console.log("[EditUserModal] Target User:",n.name,n.role);const[h,m]=w.useState(n.name),[p,b]=w.useState(n.phone||""),[v,_]=w.useState(n.address||""),[T,k]=w.useState(n.status),[E,S]=w.useState(n.role),L=u&&(c==null?void 0:c.role)==="admin"&&n.password||"",[$,H]=w.useState(L),[G,z]=w.useState(""),[P,j]=w.useState(!1),[O,I]=w.useState(n.commissionRate||0),[R,F]=w.useState(n.commissionType||"percentage"),[M,ne]=w.useState(n.incentivesActive||!1),[U,A]=w.useState(n.dailyLogMode||"12_hour"),[V,Q]=w.useState(n.maxConcurrentOrders===void 0||n.maxConcurrentOrders===null),[ae,X]=w.useState(n.maxConcurrentOrders||1),[B,Y]=w.useState(n.permissions||[]),[ge,Z]=w.useState(((Zn=n.workingHours)==null?void 0:Zn.start)||"09:00"),[te,me]=w.useState(((Ii=n.workingHours)==null?void 0:Ii.end)||"23:00"),[re,ce]=w.useState(n.hasFreeDelivery||!1),[he,Oe]=w.useState(n.responseTime||""),[Ue,st]=w.useState(n.storeCategory||"restaurant"),[fe,K]=w.useState(n.canShowDeliveryTime||!1),[ie,J]=w.useState(n.canManageMenu!==!1),[le,ee]=w.useState(n.canManageOrderDetails||!1),[we,pe]=w.useState(n.canManageAdvancedFinancials||!1),[ye,Ae]=w.useState(n.isFixedDeliveryFeeEnabled||!1),[xe,Pe]=w.useState(((oc=n.fixedDeliveryFee)==null?void 0:oc.toString())||""),[gt,Ee]=w.useState(""),[Be,ht]=w.useState(n.storeImage||null),[Me,Ze]=w.useState(!1),[at,yt]=w.useState(!1),[St,ve]=w.useState(null),Ge=w.useRef(null),We=o||"GOO NOW";sn(()=>(e(),!0),[e]);const dt="w-full px-4 py-3 bg-[#252525] border border-[#333] text-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors",Ve=w.useMemo(()=>{var wt;const He=[{id:"customer",label:""},{id:"driver",label:""},{id:"merchant",label:""},{id:"supervisor",label:""},{id:"admin",label:""}];if((c==null?void 0:c.role)==="supervisor"){const es=(wt=c.permissions)==null?void 0:wt.includes("manage_supervisors");return He.filter(ni=>ni.id!=="admin"&&(es||ni.id!=="supervisor"))}return He},[c==null?void 0:c.role,c==null?void 0:c.permissions]),$e=He=>{Y(wt=>wt.includes(He)?wt.filter(es=>es!==He):[...wt,He])},tt=He=>{var es;const wt=(es=He.target.files)==null?void 0:es[0];if(wt){const ni=new FileReader;ni.onload=()=>{ve(ni.result),yt(!0)},ni.readAsDataURL(wt)}},rt=async He=>{Ze(!0);try{const wt=new FileReader;wt.readAsDataURL(He),wt.onloadend=()=>{ht(wt.result),Ze(!1)}}catch(wt){console.error("Error cropping:",wt),Ze(!1),Ee("    .")}},ft=()=>{if(!h){Ee("      .");return}if(String(n.id)==="5"||n.role==="admin"){if(!p||p.trim().length<1){Ee("   .");return}if($!==void 0&&$!==""&&$.length<1){Ee("      .");return}}else{if(p&&!/^\d{11}$/.test(p)){Ee("      11 .");return}if($&&$.length<6){Ee("     6     .");return}}if($&&$!==G&&!u&&($!==(n.password||"")||!u)&&$!==G){Ee("   .");return}Ee("");const wt={name:h,phone:p,status:T,role:E,storeImage:Be||void 0,address:E!=="driver"&&v?v:void 0};$&&(wt.password=$),E==="driver"&&(wt.commissionRate=O,wt.commissionType=R,wt.incentivesActive=M,wt.dailyLogMode=U,wt.maxConcurrentOrders=V?void 0:ae),E==="merchant"&&(wt.workingHours={start:ge,end:te},wt.hasFreeDelivery=re,wt.responseTime=he,wt.storeCategory=Ue,wt.canShowDeliveryTime=fe,wt.canManageMenu=ie,wt.canManageOrderDetails=le,wt.canManageOrderDetails=le,wt.canManageAdvancedFinancials=we,wt.isFixedDeliveryFeeEnabled=ye,ye&&xe?wt.fixedDeliveryFee=parseFloat(xe):wt.fixedDeliveryFee=0),E==="supervisor"&&(wt.permissions=B),E==="driver"&&V&&(wt.maxConcurrentOrders=null),t(n.id,wt),e()},$t=String(n.id)==="5"||n.role==="admin",Dn=(c==null?void 0:c.role)==="supervisor"&&(c==null?void 0:c.id)===n.id;return s.jsxs("div",{className:"fixed inset-0 bg-[#111] z-[60] overflow-y-auto animate-fadeIn flex flex-col",children:[at&&St&&s.jsx(h0,{imageSrc:St,onCropComplete:rt,onClose:()=>{yt(!1),ve(null),Ge.current&&(Ge.current.value="")},aspectRatio:1}),s.jsxs("div",{className:"flex-none bg-[#1a1a1a] border-b border-[#333] px-4 pt-safe h-16 box-content flex items-center justify-between sticky top-0 z-20 shadow-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:e,className:"bg-[#252525] p-2 rounded-full text-gray-400 hover:text-white transition-colors",children:s.jsx(us,{className:"w-6 h-6 rotate-180"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-white",children:" "}),s.jsx("p",{className:"text-xs text-gray-500 font-mono",children:n.id})]})]}),s.jsx("button",{onClick:ft,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-lg transition-colors shadow-md",children:" "})]}),s.jsxs("div",{className:"flex-1 max-w-4xl mx-auto w-full p-4 sm:p-8 space-y-8 pb-20",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("div",{onClick:()=>{var He;return!Me&&((He=Ge.current)==null?void 0:He.click())},className:"relative cursor-pointer rounded-full flex items-center justify-center overflow-hidden group shadow-xl transition-all duration-300 w-36 h-36 border-2 border-gray-700",children:s.jsxs("div",{className:"w-full h-full rounded-full overflow-hidden bg-[#252525] relative border-2 border-[#111]",children:[Me&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 z-50 backdrop-blur-sm",children:s.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})}),Be?s.jsx("img",{src:Be,alt:"Profile",className:"w-full h-full object-cover"}):s.jsx("div",{className:"flex flex-col items-center justify-center h-full w-full text-gray-400",children:s.jsx(qi,{className:"w-10 h-10 mb-1"})}),s.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx(Zr,{className:"w-8 h-8 text-white"})})]})}),s.jsx("input",{ref:Ge,type:"file",accept:"image/*",className:"absolute opacity-0 w-0 h-0 pointer-events-none",onChange:tt})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm h-fit",children:[s.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[s.jsx("span",{className:"w-1 h-5 bg-red-500 rounded-full"})," "]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),s.jsx("input",{type:"text",value:h,onChange:He=>m(He.target.value),className:dt})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:$t?"  ()":" "}),s.jsx("input",{type:$t?"text":"tel",value:p,onChange:He=>b(He.target.value),className:`${dt} ${$t?"":"text-right placeholder:text-right"}`,dir:"rtl",placeholder:$t?"     (: 5)":"01xxxxxxxxx"})]}),u&&n.deviceInfo&&s.jsxs("div",{className:"bg-[#0f172a] rounded-2xl p-4 border border-gray-700/50 space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-cyan-500/10 flex items-center justify-center",children:s.jsx(ks,{className:"w-4 h-4 text-cyan-400"})}),s.jsx("h3",{className:"font-bold text-white text-sm",children:"  (Device Info)"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[s.jsxs("div",{className:"bg-black/30 p-2 rounded-lg border border-gray-700/30",children:[s.jsx("span",{className:"text-gray-500 block mb-1",children:"Model"}),s.jsx("span",{className:"text-yellow-400 font-mono tracking-wider",children:n.deviceInfo.model})]}),s.jsxs("div",{className:"bg-black/30 p-2 rounded-lg border border-gray-700/30",children:[s.jsx("span",{className:"text-gray-500 block mb-1",children:"Brand"}),s.jsx("span",{className:"text-white font-mono",children:n.deviceInfo.brand})]}),s.jsxs("div",{className:"bg-black/30 p-2 rounded-lg border border-gray-700/30 col-span-2",children:[s.jsx("span",{className:"text-gray-500 block mb-1",children:"IMEI (Spoofed)"}),s.jsx("span",{className:"text-green-400 font-mono tracking-widest",children:n.deviceInfo.imei})]}),s.jsxs("div",{className:"bg-black/30 p-2 rounded-lg border border-gray-700/30 col-span-2",children:[s.jsx("span",{className:"text-gray-500 block mb-1",children:"Android ID"}),s.jsx("span",{className:"text-gray-300 font-mono truncate",children:n.deviceInfo.androidId})]}),s.jsxs("div",{className:"bg-black/30 p-2 rounded-lg border border-gray-700/30 col-span-2",children:[s.jsx("span",{className:"text-gray-500 block mb-1",children:"Network"}),s.jsxs("span",{className:"text-blue-400 font-mono",children:[(Pr=n.deviceInfo.network)==null?void 0:Pr.ssid," (",(ea=n.deviceInfo.network)==null?void 0:ea.operator,")"]})]})]})]}),!Dn&&E!=="driver"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",value:v,onChange:He=>_(He.target.value),className:`${dt} pl-10`,placeholder:" "}),s.jsx(fs,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500"})]})]}),!Dn&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" (Role)"}),s.jsx("div",{className:`flex flex-wrap gap-2 ${r||i?"opacity-50 cursor-not-allowed":""}`,children:Ve.map(He=>s.jsx("button",{type:"button",onClick:()=>S(He.id),disabled:r||i,className:`px-4 py-2 text-sm font-bold rounded-xl border transition-all ${E===He.id?"bg-red-600 border-red-600 text-white shadow-lg":"bg-transparent border-gray-600 text-gray-400 hover:border-gray-400"}`,children:He.label},He.id))})]}),!Dn&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),s.jsx("div",{className:`flex bg-[#252525] p-1 rounded-xl border border-[#333] ${i?"opacity-50 pointer-events-none":""}`,children:[{value:"active",label:""},{value:"pending",label:" "},{value:"inactive",label:" "},{value:"blocked",label:""},{value:"suspended",label:""}].filter(He=>He.value==="suspended"?(c==null?void 0:c.role)==="admin"||T==="suspended":!0).map(He=>s.jsx("button",{type:"button",onClick:()=>{T==="suspended"&&(c==null?void 0:c.role)!=="admin"||k(He.value)},disabled:i||T==="suspended"&&He.value!=="suspended"&&(c==null?void 0:c.role)!=="admin",className:`flex-1 py-2 text-xs font-bold rounded-lg transition-colors ${T===He.value?"bg-white text-black shadow-sm":"text-gray-400 hover:text-white"} ${T==="suspended"&&(c==null?void 0:c.role)!=="admin"&&He.value!=="suspended"?"opacity-30 cursor-not-allowed":""}`,children:He.label},He.value))})]})]}),s.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm h-fit",children:[s.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[s.jsx("span",{className:"w-1 h-5 bg-blue-500 rounded-full"}),"  "]}),s.jsxs("div",{className:"relative",children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:u?"  ":"   "}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:P?"text":"password",value:$,onChange:He=>H(He.target.value),className:`${dt} pr-10`,placeholder:u?$t?"    ":"******":"   "}),s.jsx("button",{type:"button",onClick:()=>j(!P),className:"absolute inset-y-0 left-0 px-3 flex items-center text-gray-400 hover:text-white",children:P?s.jsx(Io,{className:"w-5 h-5"}):s.jsx(Yi,{className:"w-5 h-5"})})]}),$t&&u&&s.jsx("p",{className:"text-[10px] text-green-400 mt-2 font-bold",children:" :        ."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"  "}),s.jsx("input",{type:"password",value:G,onChange:He=>z(He.target.value),className:dt,placeholder:u?"******":"    "})]})]}),E==="merchant"&&s.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm md:col-span-2",children:[s.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[s.jsx("span",{className:"w-1 h-5 bg-purple-500 rounded-full"})," "]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"text-xs text-gray-500 mb-1 block text-center",children:" "}),s.jsx("input",{type:"time",value:ge,onChange:He=>Z(He.target.value),className:"w-full bg-[#252525] border border-[#333] rounded-xl p-3 text-white text-center font-mono text-lg focus:border-purple-500 outline-none"})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"text-xs text-gray-500 mb-1 block text-center",children:" "}),s.jsx("input",{type:"time",value:te,onChange:He=>me(He.target.value),className:"w-full bg-[#252525] border border-[#333] rounded-xl p-3 text-white text-center font-mono text-lg focus:border-purple-500 outline-none"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),s.jsxs("div",{className:"relative",children:[s.jsx("select",{value:Ue,onChange:He=>st(He.target.value),className:`${dt} appearance-none`,children:bee.map(He=>s.jsx("option",{value:He.id,children:He.label},He.id))}),s.jsx(ks,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500 pointer-events-none"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"  ()"}),s.jsx("input",{type:"text",value:he,onChange:He=>Oe(He.target.value),className:dt,placeholder:": 15 "})]})]}),s.jsxs("div",{className:"space-y-2 mt-4 pt-2 border-t border-[#333]",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#252525] rounded-xl border border-[#333]",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Zt,{className:"w-4 h-4 text-green-500"}),s.jsx("label",{htmlFor:"freeDelivery",className:"text-sm font-bold text-white",children:"  "})]}),s.jsx("input",{id:"freeDelivery",type:"checkbox",checked:re,onChange:He=>ce(He.target.checked),className:"h-5 w-5 text-green-600 bg-gray-700 border-gray-600 rounded focus:ring-green-500"})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#252525] rounded-xl border border-[#333]",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Si,{className:"w-4 h-4 text-orange-400"}),s.jsx("label",{className:"text-sm font-bold text-white",children:"  "})]}),s.jsx("input",{type:"checkbox",checked:ie,onChange:He=>J(He.target.checked),className:"h-5 w-5 text-orange-600 bg-gray-700 border-gray-600 rounded focus:ring-orange-500"})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#252525] rounded-xl border border-[#333]",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(It,{className:"w-4 h-4 text-blue-400"}),s.jsx("label",{className:"text-sm font-bold text-white",children:"   ( )"})]}),s.jsx("input",{type:"checkbox",checked:fe,onChange:He=>K(He.target.checked),className:"h-5 w-5 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#252525] rounded-xl border border-[#333]",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(dr,{className:"w-4 h-4 text-pink-400"}),s.jsx("label",{className:"text-sm font-bold text-white",children:"   ()"})]}),s.jsx("input",{type:"checkbox",checked:le,onChange:He=>ee(He.target.checked),className:"h-5 w-5 text-pink-600 bg-gray-700 border-gray-600 rounded focus:ring-pink-500"})]})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#252525] rounded-xl border border-[#333]",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Zu,{className:"w-4 h-4 text-emerald-400"}),s.jsx("label",{className:"text-sm font-bold text-white",children:"  "})]}),s.jsx("input",{type:"checkbox",checked:we,onChange:He=>pe(He.target.checked),className:"h-5 w-5 text-emerald-600 bg-gray-700 border-gray-600 rounded focus:ring-emerald-500"})]}),s.jsxs("div",{className:"p-3 bg-[#252525] rounded-xl border border-[#333] space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Zt,{className:"w-4 h-4 text-cyan-400"}),s.jsx("label",{className:"text-sm font-bold text-white",children:"  "})]}),s.jsx("input",{type:"checkbox",checked:ye,onChange:He=>Ae(He.target.checked),className:"h-5 w-5 text-cyan-600 bg-gray-700 border-gray-600 rounded focus:ring-cyan-500"})]}),ye&&s.jsxs("div",{className:"animate-fadeIn pt-2 border-t border-gray-700",children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-1.5",children:"   (.)"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"number",value:xe,onChange:He=>Pe(He.target.value),className:"w-full bg-[#1a1a1a] border border-gray-600 rounded-lg py-2 px-3 text-white text-center font-bold focus:border-cyan-500 outline-none",placeholder:"0"}),s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-xs text-gray-500 font-bold",children:"."})]})]})]})]}),E==="driver"&&s.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-6 shadow-sm md:col-span-2",children:[s.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-2 flex items-center gap-2",children:[s.jsx("span",{className:"w-1 h-5 bg-orange-500 rounded-full"}),"  "]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:" "}),s.jsx("div",{className:"flex bg-[#252525] p-1 rounded-xl border border-[#333]",children:[{value:"12_hour",label:""},{value:"always_open",label:""}].map(He=>s.jsx("button",{type:"button",onClick:()=>A(He.value),className:`flex-1 py-2.5 text-sm font-bold rounded-lg transition-all ${U===He.value?"bg-orange-500 text-white shadow-md":"text-gray-400 hover:text-white"}`,children:He.label},He.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"  "}),s.jsxs("div",{className:"bg-[#252525] p-4 rounded-xl border border-[#333] flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-white font-medium",children:V?" ":ae}),s.jsx("button",{onClick:()=>Q(!V),className:`w-12 h-6 rounded-full p-1 transition-colors duration-300 ${V?"bg-green-600":"bg-gray-600"}`,children:s.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-300 ${V?"translate-x-0":"-translate-x-6"}`})})]}),!V&&s.jsx("input",{type:"range",min:"1",max:"10",value:ae,onChange:He=>X(parseInt(He.target.value)),className:"w-full mt-2 accent-orange-500 h-2 bg-gray-700 rounded-lg appearance-none"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsxs("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:["  ",We]}),s.jsxs("div",{className:"bg-[#252525] p-4 rounded-xl border border-[#333] space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-400 mb-2",children:" "}),s.jsx("div",{className:"flex gap-2",children:[0,25,50].map(He=>s.jsxs("button",{type:"button",onClick:()=>{F("percentage"),I(He)},className:`px-4 py-2 text-sm font-bold rounded-lg border transition-all ${R==="percentage"&&O===He?"bg-orange-500 border-orange-500 text-white":"bg-transparent border-gray-600 text-gray-400"}`,children:[He,"%"]},`perc-${He}`))})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"  (.)"}),s.jsx("div",{className:"flex gap-2",children:[5,10,15,20].map(He=>s.jsx("button",{type:"button",onClick:()=>{F("fixed"),I(He)},className:`px-4 py-2 text-sm font-bold rounded-lg border transition-all ${R==="fixed"&&O===He?"bg-orange-500 border-orange-500 text-white":"bg-transparent border-gray-600 text-gray-400"}`,children:He},`fixed-${He}`))})]})]})]})]})]}),E==="supervisor"&&!Dn&&s.jsxs("div",{className:"bg-[#1a1a1a] p-6 rounded-2xl border border-[#333] space-y-4 shadow-sm md:col-span-2",children:[s.jsxs("h3",{className:"text-lg font-bold text-white border-b border-[#333] pb-3 mb-4 flex items-center gap-2",children:[s.jsx(ur,{className:"w-5 h-5 text-yellow-500"})," "]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:yee.map((He,wt)=>s.jsxs("div",{className:"bg-[#222] p-4 rounded-xl border border-[#333]",children:[s.jsxs("h4",{className:"text-sm font-bold text-gray-300 mb-3 flex items-center gap-2",children:[He.icon,He.title]}),s.jsx("div",{className:"space-y-2",children:He.permissions.map(es=>s.jsxs("label",{className:"flex items-start gap-3 p-2 hover:bg-[#2a2a2a] rounded-lg transition-colors cursor-pointer group",children:[s.jsxs("div",{className:"relative flex items-center mt-0.5",children:[s.jsx("input",{type:"checkbox",checked:B.includes(es.id),onChange:()=>$e(es.id),className:"peer h-5 w-5 cursor-pointer appearance-none rounded-md border-2 border-gray-600 bg-gray-800 transition-all checked:border-yellow-500 checked:bg-yellow-500"}),s.jsx(Je,{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-3.5 h-3.5 text-black opacity-0 peer-checked:opacity-100 pointer-events-none"})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-bold text-gray-200 group-hover:text-white transition-colors",children:es.label}),es.desc&&s.jsx("p",{className:"text-[10px] text-gray-500",children:es.desc})]})]},es.id))})]},wt))})]})]}),gt&&s.jsx("p",{className:"text-red-400 font-bold text-center bg-red-900/20 p-3 rounded-xl border border-red-500/30",children:gt})]})]})},vee=n=>{switch(n){case"merchant":return"";case"driver":return" ";case"customer":return"";case"admin":return" ";case"supervisor":return"";default:return n}},wee=n=>{switch(n){case"restaurant":return"";case"market":return" ";case"pharmacy":return"";case"other":return"";default:return n||" "}},ba=({label:n,value:e,icon:t,fullWidth:r,highlight:i})=>s.jsxs("div",{className:`bg-[#252525] p-4 rounded-xl border ${i?"border-red-500/30 bg-red-900/10":"border-[#333]"} flex flex-col justify-center ${r?"col-span-2":""} shadow-sm`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[t&&Rn.cloneElement(t,{className:`w-4 h-4 ${i?"text-red-400":"text-gray-500"}`}),s.jsx("span",{className:`text-xs font-bold ${i?"text-red-300":"text-gray-400"}`,children:n})]}),s.jsx("p",{className:"font-bold text-white text-base break-words tracking-wide",children:e})]}),t5=({user:n,onClose:e,onApprove:t,onDelete:r})=>{const i=()=>{t(n.id,{status:"active"})},o=()=>{window.confirm("       ")&&r(n.id)},c=(()=>{try{const h=new Date(n.createdAt);return isNaN(h.getTime())?" ":h.toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return" "}})(),u=()=>{switch(n.role){case"driver":return"from-orange-900/80 to-gray-900";case"merchant":return"from-purple-900/80 to-gray-900";case"admin":return"from-red-900/80 to-gray-900";default:return"from-blue-900/80 to-gray-900"}};return s.jsx("div",{className:"fixed inset-0 bg-black/95 backdrop-blur-md flex justify-center items-end sm:items-center z-50 p-0 sm:p-4 animate-fadeIn",onClick:e,children:s.jsxs("div",{className:"bg-[#1a1a1a] w-full sm:max-w-lg h-[95vh] sm:h-auto sm:max-h-[90vh] rounded-t-3xl sm:rounded-3xl border-t sm:border border-[#333] shadow-2xl flex flex-col relative overflow-hidden",onClick:h=>h.stopPropagation(),children:[s.jsxs("div",{className:`h-40 bg-gradient-to-br ${u()} relative`,children:[s.jsx("div",{className:"absolute inset-0 opacity-20 bg-[radial-gradient(#ffffff_1px,transparent_1px)] [background-size:16px_16px]"}),s.jsx("button",{onClick:e,className:"absolute top-4 left-4 bg-black/40 hover:bg-black/60 text-white p-2 rounded-full backdrop-blur-md transition-colors z-20 border border-white/10",children:s.jsx(ut,{className:"w-6 h-6"})}),s.jsx("div",{className:"absolute top-4 right-4 z-20",children:s.jsx("span",{className:`px-3 py-1.5 rounded-full text-xs font-bold border backdrop-blur-md shadow-lg ${n.status==="active"?"bg-green-500/20 text-green-400 border-green-500/30":n.status==="pending"?"bg-yellow-500/20 text-yellow-400 border-yellow-500/30":"bg-red-500/20 text-red-400 border-red-500/30"}`,children:n.status==="active"?"  ":n.status==="pending"?"  ":" "})})]}),s.jsxs("div",{className:"px-6 relative -mt-16 flex flex-col items-center z-10",children:[s.jsxs("div",{className:"w-32 h-32 rounded-3xl bg-[#252525] p-1 shadow-2xl relative group",children:[s.jsx("div",{className:"w-full h-full rounded-2xl overflow-hidden border-4 border-[#1a1a1a] relative bg-gray-800 flex items-center justify-center",children:n.storeImage?s.jsx("img",{src:n.storeImage,alt:n.name,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-12 h-12 text-gray-500"})}),s.jsxs("div",{className:"absolute -bottom-2 -right-2 bg-gray-800 text-[10px] px-2 py-1 rounded-lg font-bold text-white border border-[#444] shadow-md flex items-center gap-1",children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"}),"ID: ",n.id]})]}),s.jsx("h2",{className:"text-3xl font-black text-white mt-4 text-center tracking-tight",children:n.name}),s.jsxs("div",{className:"flex items-center gap-2 mt-2 bg-[#252525] px-4 py-1.5 rounded-full border border-[#333]",children:[s.jsx("span",{className:"text-gray-400 text-sm font-medium",children:vee(n.role)}),n.role==="driver"&&s.jsx("span",{className:"text-gray-600",children:""}),n.role==="driver"&&s.jsx("span",{className:"text-orange-400 text-xs font-bold",children:"Driver App"})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8 scrollbar-hide",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[s.jsx(_t,{className:"w-4 h-4 text-red-500"})," "]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx(ba,{label:" ",value:n.phone||" ",icon:s.jsx(zn,{}),fullWidth:!0,highlight:!0}),s.jsx(ba,{label:" ",value:c,icon:s.jsx(ei,{}),fullWidth:!0}),n.email&&s.jsx(ba,{label:" ",value:n.email,icon:s.jsx(J1,{}),fullWidth:!0}),n.addresses&&n.addresses.length>0&&s.jsx(ba,{label:" ",value:n.addresses[0],icon:s.jsx(fs,{}),fullWidth:!0})]})]}),n.role==="merchant"&&s.jsxs("div",{children:[s.jsx("div",{className:"h-px bg-[#333] mb-6"}),s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[s.jsx(ks,{className:"w-4 h-4 text-purple-500"})," "]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx(ba,{label:" ",value:wee(n.storeCategory)}),n.workingHours?s.jsx(ba,{label:" ",value:`${n.workingHours.start} - ${n.workingHours.end}`,icon:s.jsx(It,{})}):s.jsx(ba,{label:" ",value:" ",icon:s.jsx(It,{})})]})]}),n.role==="driver"&&s.jsxs("div",{children:[s.jsx("div",{className:"h-px bg-[#333] mb-6"}),s.jsxs("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[s.jsx($s,{className:"w-4 h-4 text-orange-500"}),"  "]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx(ba,{label:" ",value:n.commissionType==="fixed"?" ":" "}),s.jsx(ba,{label:"",value:n.commissionType==="fixed"?`${n.commissionRate} .`:`${n.commissionRate}%`,highlight:!0}),s.jsx(ba,{label:" ",value:n.dailyLogMode==="always_open"?" ":" (12 )",fullWidth:!0})]})]})]}),s.jsx("div",{className:"p-5 bg-[#1a1a1a] border-t border-[#333] flex gap-4 pb-8 sm:pb-5",children:n.status==="pending"?s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:i,className:"flex-[2] bg-green-600 hover:bg-green-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-green-900/20 active:scale-95 transition-all flex items-center justify-center gap-2",children:[s.jsx(Je,{className:"w-5 h-5"})," "]}),s.jsxs("button",{onClick:o,className:"flex-1 bg-red-900/20 hover:bg-red-900/30 text-red-500 border border-red-500/20 font-bold py-4 rounded-xl active:scale-95 transition-all flex items-center justify-center gap-2",children:[s.jsx(Tt,{className:"w-5 h-5"}),""]})]}):s.jsxs("div",{className:"w-full flex gap-3",children:[s.jsx("button",{onClick:e,className:"flex-1 bg-gray-800 hover:bg-gray-700 text-gray-200 font-bold py-4 rounded-xl transition-colors border border-gray-700",children:""}),s.jsx("button",{onClick:o,className:"w-16 bg-red-900/10 hover:bg-red-900/20 text-red-500 border border-red-500/10 font-bold py-4 rounded-xl active:scale-95 transition-all flex items-center justify-center",title:" ",children:s.jsx(Tt,{className:"w-5 h-5"})})]})})]})})},NO=({merchant:n,onUpdateMerchant:e})=>{const[t,r]=w.useState(n.products||[]),[i,o]=w.useState(!1),[c,u]=w.useState({}),[h,m]=w.useState([]),[p,b]=w.useState(""),[v,_]=w.useState(""),[T,k]=w.useState(""),[E,S]=w.useState(!1),[L,$]=w.useState(null),[H,G]=w.useState(null),z=w.useRef(null);sn(()=>H?(G(null),!0):L?($(null),!0):i?(o(!1),!0):!1,[L,i,H]);const P=w.useMemo(()=>{const A=new Set(t.map(V=>V.category||""));return["",...Array.from(A)]},[t]),j=w.useMemo(()=>T===""?t:t.filter(A=>(A.category||"")===T),[t,T]),O=A=>new Promise((V,Q)=>{const ae=new FileReader;ae.readAsDataURL(A),ae.onload=X=>{var Y;const B=new Image;B.src=(Y=X.target)==null?void 0:Y.result,B.onload=()=>{const ge=document.createElement("canvas"),Z=1200,te=1200;let me=B.width,re=B.height;me>re?me>Z&&(re*=Z/me,me=Z):re>te&&(me*=te/re,re=te),ge.width=me,ge.height=re;const ce=ge.getContext("2d");ce?(ce.imageSmoothingEnabled=!0,ce.imageSmoothingQuality="high",ce.drawImage(B,0,0,me,re),V(ge.toDataURL("image/jpeg",.9))):Q(new Error("Canvas context failed"))},B.onerror=ge=>Q(ge)},ae.onerror=X=>Q(X)}),I=async A=>{var Q;const V=(Q=A.target.files)==null?void 0:Q[0];if(V){S(!0);try{const ae=await O(V);setTimeout(()=>{u(X=>({...X,image:ae})),S(!1)},800)}catch{S(!1),alert("  .")}}},R=()=>{p&&v&&(m([...h,{name:p,price:parseFloat(v)}]),b(""),_(""))},F=A=>{m(h.filter((V,Q)=>Q!==A))},M=()=>{var ae;if(!c.name||!c.price&&h.length===0)return;let A=[...t];const V=((ae=c.category)==null?void 0:ae.trim())||"",Q={id:c.id||`PROD-${Date.now()}`,name:c.name,description:c.description||"",price:Number(c.price)||0,image:c.image,available:c.available??!0,category:V,sizes:h.length>0?h:void 0};c.id?A=A.map(X=>X.id===c.id?Q:X):A.push(Q),r(A),e(n.id,{products:A}),o(!1),u({}),m([]),k(V)},ne=()=>{if(!H)return;const A=t.filter(V=>V.id!==H);r(A),e(n.id,{products:A}),G(null)},U=A=>{u(A||{available:!0,category:T!==""?T:""}),m((A==null?void 0:A.sizes)||[]),o(!0)};return s.jsxs("div",{className:"space-y-4 pb-20",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4 px-1",children:[s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx(ks,{className:"w-6 h-6 text-red-500"})," "]}),s.jsxs("button",{onClick:()=>U(),className:"flex items-center bg-red-600 text-white px-4 py-2 rounded-xl text-sm font-bold shadow-lg hover:bg-red-700 transition-colors",children:[s.jsx(hs,{className:"w-4 h-4 ml-1"})," "]})]}),!i&&s.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide mb-4 px-1",children:P.map(A=>s.jsx("button",{onClick:()=>k(A),className:`px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap transition-colors border ${T===A?"bg-red-600 text-white border-red-600 shadow-md":"bg-gray-800 text-gray-400 border-gray-700 hover:bg-gray-700"}`,children:A},A))}),i&&s.jsxs("div",{className:"bg-gray-800 p-5 rounded-xl border border-gray-700 space-y-4 mb-6 shadow-2xl animate-fadeIn",children:[s.jsxs("div",{className:"flex justify-between items-center border-b border-gray-700 pb-3",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-200",children:c.id?" ":" "}),s.jsx("button",{onClick:()=>o(!1),children:s.jsx(ut,{className:"w-5 h-5 text-gray-400 hover:text-white"})})]}),s.jsx("div",{className:"flex justify-center mb-4",children:s.jsxs("div",{onClick:()=>{var A;return!E&&((A=z.current)==null?void 0:A.click())},className:`w-full h-40 bg-gray-900 rounded-xl flex items-center justify-center cursor-pointer border-2 border-dashed border-gray-600 hover:border-red-500 overflow-hidden relative group transition-colors ${E?"opacity-50 cursor-wait":""}`,children:[E&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 z-50 backdrop-blur-sm",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full opacity-75 animate-ping absolute top-0 left-0"}),s.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center relative z-10 shadow-lg shadow-blue-500/50",children:s.jsx(Zr,{className:"w-6 h-6 text-white animate-bounce"})}),s.jsx("div",{className:"w-20 h-20 border-4 border-blue-400/30 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"})]})}),c.image?s.jsx("img",{src:c.image,alt:"Preview",className:"w-full h-full object-cover"}):s.jsxs("div",{className:"flex flex-col items-center text-gray-500",children:[s.jsx(Qr,{className:"w-10 h-10 mb-2"}),s.jsx("span",{className:"text-xs",children:"  "})]}),s.jsx("input",{ref:z,type:"file",className:"hidden",accept:"image/*",onChange:I})]})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:" "}),s.jsx("input",{type:"text",value:c.name||"",onChange:A=>u({...c,name:A.target.value}),className:"w-full bg-gray-700 text-white p-3 rounded-lg border border-gray-600 focus:border-red-500 outline-none"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("div",{className:"w-1/2",children:[s.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"  (.)"}),s.jsx("input",{type:"number",value:c.price||"",onChange:A=>u({...c,price:Number(A.target.value)}),className:"w-full bg-gray-700 text-white p-3 rounded-lg border border-gray-600 focus:border-red-500 outline-none font-bold",placeholder:"0"})]}),s.jsxs("div",{className:"w-1/2",children:[s.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:""}),s.jsx("input",{type:"text",list:"category-suggestions",value:c.category||"",onChange:A=>u({...c,category:A.target.value}),className:"w-full bg-gray-700 text-white p-3 rounded-lg border border-gray-600 focus:border-red-500 outline-none",placeholder:": "}),s.jsx("datalist",{id:"category-suggestions",children:P.filter(A=>A!=="").map(A=>s.jsx("option",{value:A},A))})]})]}),s.jsxs("div",{className:"bg-[#1a1a1a] p-3 rounded-lg border border-gray-700",children:[s.jsx("label",{className:"block text-xs font-bold text-gray-300 mb-2",children:"  ()"}),s.jsx("div",{className:"space-y-2 mb-3",children:h.map((A,V)=>s.jsxs("div",{className:"flex items-center gap-2 bg-gray-800 p-2 rounded-md border border-gray-600",children:[s.jsx("span",{className:"flex-1 text-sm text-white",children:A.name}),s.jsxs("span",{className:"text-sm font-bold text-green-400",children:[A.price.toLocaleString("en-US")," ."]}),s.jsx("button",{onClick:()=>F(V),className:"text-red-400 hover:bg-red-500/10 p-1 rounded",children:s.jsx(Tt,{className:"w-4 h-4"})})]},V))}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",placeholder:" (: )",value:p,onChange:A=>b(A.target.value),className:"flex-[2] bg-gray-700 text-white text-xs p-2 rounded border border-gray-600 focus:border-blue-500 outline-none"}),s.jsx("input",{type:"number",placeholder:"",value:v,onChange:A=>_(A.target.value),className:"flex-1 bg-gray-700 text-white text-xs p-2 rounded border border-gray-600 focus:border-blue-500 outline-none"}),s.jsx("button",{onClick:R,className:"bg-blue-600 text-white p-2 rounded hover:bg-blue-500",children:s.jsx(hs,{className:"w-4 h-4"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:""}),s.jsx("textarea",{value:c.description||"",onChange:A=>u({...c,description:A.target.value}),className:"w-full bg-gray-700 text-white p-3 rounded-lg border border-gray-600 focus:border-red-500 outline-none resize-none",rows:3})]}),s.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[s.jsx("input",{type:"checkbox",id:"available",checked:c.available!==!1,onChange:A=>u({...c,available:A.target.checked}),className:"w-5 h-5 rounded bg-gray-700 border-gray-600 text-red-600 focus:ring-red-500"}),s.jsx("label",{htmlFor:"available",className:"text-sm text-gray-300",children:"  "})]}),s.jsxs("div",{className:"flex justify-end gap-3 mt-4 pt-4 border-t border-gray-700",children:[s.jsx("button",{onClick:()=>o(!1),className:"px-6 py-2.5 rounded-lg border border-gray-600 text-gray-300 hover:bg-gray-700 transition-colors font-bold",children:""}),s.jsx("button",{onClick:M,disabled:E,className:"px-8 py-2.5 bg-red-600 text-white rounded-lg hover:bg-red-700 shadow-lg transition-colors font-bold disabled:bg-gray-600 disabled:cursor-not-allowed",children:E?" ...":" "})]})]}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 animate-fadeIn",children:j.map(A=>s.jsxs("div",{className:"group bg-gray-800 rounded-2xl overflow-hidden border border-gray-700 shadow-sm hover:shadow-xl hover:border-gray-500 transition-all duration-300 flex flex-col",children:[s.jsxs("div",{className:"relative aspect-square w-full bg-gray-900 overflow-hidden cursor-pointer",onClick:()=>A.image&&$(A.image),children:[A.image?s.jsx("img",{src:A.image,alt:A.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:s.jsx(Qr,{className:"w-10 h-10 opacity-30"})}),!A.available&&s.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center backdrop-blur-[1px]",children:s.jsx("span",{className:"text-[10px] bg-red-600 text-white px-3 py-1 rounded-full font-bold shadow-md",children:" "})})]}),s.jsxs("div",{className:"p-3 flex-1 flex flex-col",children:[s.jsx("h4",{className:"font-bold text-white text-sm mb-1 line-clamp-1",title:A.name,children:A.name}),s.jsx("p",{className:"text-[10px] text-gray-400 line-clamp-2 leading-relaxed mb-2 flex-1",children:A.description}),s.jsxs("div",{className:"flex justify-between items-center mt-auto",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("span",{className:"text-red-400 font-black text-sm",children:[A.price.toLocaleString("en-US")," ",s.jsx("span",{className:"text-[9px]",children:"."})]}),A.sizes&&A.sizes.length>0&&s.jsxs("span",{className:"text-[9px] text-green-400",children:["+ ",A.sizes.length," "]})]}),s.jsx("span",{className:"text-[9px] font-mono bg-gray-700 text-gray-300 px-1.5 py-0.5 rounded border border-gray-600 truncate max-w-[60px]",children:A.category||""})]})]}),s.jsxs("div",{className:"grid grid-cols-2 divide-x divide-x-reverse divide-gray-700 border-t border-gray-700 bg-gray-800/80 backdrop-blur-sm",children:[s.jsx("button",{onClick:()=>U(A),className:"py-2.5 flex items-center justify-center text-blue-400 hover:bg-blue-500/10 transition-colors",children:s.jsx(Js,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>G(A.id),className:"py-2.5 flex items-center justify-center text-red-400 hover:bg-red-500/10 transition-colors",children:s.jsx(Tt,{className:"w-4 h-4"})})]})]},A.id))}),j.length===0&&!i&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500 bg-gray-800/30 rounded-3xl border border-dashed border-gray-700 mx-1",children:[s.jsx(ks,{className:"w-16 h-16 mb-4 opacity-20"}),s.jsx("p",{className:"text-lg font-bold text-gray-400",children:" "})]}),L&&s.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex items-center justify-center p-4 animate-fadeIn",onClick:()=>$(null),children:[s.jsx("button",{onClick:()=>$(null),className:"absolute top-4 right-4 p-2 bg-gray-800/50 rounded-full text-white hover:bg-gray-700 transition-colors z-20",children:s.jsx(ut,{className:"w-6 h-6"})}),s.jsx("img",{src:L,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl animate-pop-in",onClick:A=>A.stopPropagation()})]}),H&&s.jsx(jn,{title:" ",message:"         ",onClose:()=>G(null),onConfirm:ne,confirmButtonText:"",confirmVariant:"danger"})]})},jO=({users:n,orders:e,updateUser:t,permissions:r})=>{var E;const i=!r||r.includes("manage_stores"),[o,c]=w.useState(""),[u,h]=w.useState(null),[m,p]=w.useState(null),[b,v]=w.useState(null);sn(()=>b?(v(null),!0):u?(h(null),!0):m?(p(null),!0):!1,[b,u,m]);const _=n.filter(S=>S.role==="merchant"),T=_.filter(S=>S.name.toLowerCase().includes(o.toLowerCase())||S.phone&&S.phone.includes(o)),k=S=>{t(S.id,{hasFreeDelivery:!S.hasFreeDelivery})};return s.jsxs("div",{className:"space-y-6 pb-32 animate-fadeIn relative",children:[s.jsxs("div",{className:"bg-gray-800 p-4 rounded-2xl shadow-lg border border-gray-700/50 flex flex-col md:flex-row gap-4 items-center",children:[s.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[s.jsx("div",{className:"p-3 bg-purple-500/20 rounded-xl text-purple-400",children:s.jsx(Ar,{className:"w-6 h-6"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-white",children:" "}),s.jsxs("p",{className:"text-xs text-gray-400",children:[_.length,"  "]})]})]}),s.jsxs("div",{className:"relative flex-1 w-full",children:[s.jsx(mr,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 w-5 h-5"}),s.jsx("input",{type:"text",placeholder:"  ...",value:o,onChange:S=>c(S.target.value),className:"w-full bg-gray-900 text-white rounded-xl py-3 pr-12 pl-4 border border-gray-600 focus:border-purple-500 focus:ring-1 focus:ring-purple-500 outline-none transition-all placeholder-gray-500"})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:T.length>0?T.map((S,L)=>{const $=e.filter(H=>H.merchantId===S.id&&H.status===ue.Delivered).length;return s.jsxs("div",{className:"bg-[#1e293b] rounded-2xl overflow-hidden border border-gray-700 shadow-md group hover:border-gray-500 transition-all flex flex-col",children:[s.jsxs("div",{className:"h-24 bg-gray-800 relative overflow-hidden",children:[S.storeImage?s.jsx("img",{src:S.storeImage,className:"w-full h-full object-cover opacity-60 group-hover:opacity-80 transition-opacity",alt:S.name}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx(Ar,{className:"w-12 h-12 text-gray-600 opacity-50"})}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#1e293b] to-transparent"}),s.jsxs("div",{className:"absolute bottom-3 right-4",children:[s.jsx("h3",{className:"text-lg font-bold text-white shadow-sm",children:S.name}),s.jsx("p",{className:"text-xs text-gray-400 font-mono",children:S.phone})]}),s.jsxs("div",{className:"absolute top-2 left-2 flex gap-2",children:[s.jsx("button",{onClick:()=>p(S),className:"bg-black/40 hover:bg-black/60 p-2 rounded-full text-white backdrop-blur-sm transition-colors border border-white/5",title:"",children:s.jsx(Yi,{className:"w-4 h-4"})}),i&&s.jsx("button",{onClick:()=>h(S),className:"bg-black/40 hover:bg-black/60 p-2 rounded-full text-white backdrop-blur-sm transition-colors border border-white/5",title:"",children:s.jsx(Js,{className:"w-4 h-4"})})]})]}),s.jsxs("div",{className:"p-4 space-y-4 flex-1 flex flex-col",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 bg-gray-900/50 p-2 rounded-lg text-center border border-gray-700",children:[s.jsx("p",{className:"text-[10px] text-gray-500 mb-1",children:" "}),s.jsx("p",{className:"font-bold text-white text-lg",children:$})]}),s.jsxs("div",{className:"flex-1 bg-gray-900/50 p-2 rounded-lg text-center border border-gray-700",children:[s.jsx("p",{className:"text-[10px] text-gray-500 mb-1",children:" "}),s.jsx("p",{className:"font-bold text-blue-400 text-sm mt-1",children:S.responseTime||"--"})]})]}),s.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-700/50",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`p-1.5 rounded-lg ${S.hasFreeDelivery?"bg-green-500/20 text-green-400":"bg-gray-700 text-gray-500"}`,children:s.jsx(Zt,{className:"w-4 h-4"})}),s.jsx("span",{className:"text-sm font-medium text-gray-300",children:" "})]}),s.jsx("button",{onClick:i?()=>k(S):void 0,className:`w-10 h-5 rounded-full relative transition-colors duration-300 ${i?"":"opacity-50 cursor-not-allowed"} ${S.hasFreeDelivery?"bg-green-500":"bg-gray-600"}`,children:s.jsx("div",{className:`w-3 h-3 bg-white rounded-full absolute top-1 transition-all duration-300 ${S.hasFreeDelivery?"left-1":"left-6"}`})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"p-1.5 rounded-lg bg-blue-500/20 text-blue-400",children:s.jsx(It,{className:"w-4 h-4"})}),s.jsx("span",{className:"text-sm font-medium text-gray-300",children:" "})]}),s.jsx("span",{className:"text-xs text-gray-400 bg-gray-800 px-2 py-1 rounded",children:S.responseTime||" "})]})]}),i&&s.jsx("div",{className:"pt-3 mt-auto",children:s.jsxs("button",{onClick:()=>v(S),className:"w-full bg-purple-600/10 hover:bg-purple-600/20 text-purple-400 font-bold py-2.5 rounded-xl border border-purple-500/20 transition-all flex items-center justify-center gap-2 active:scale-95",children:[s.jsx(Si,{className:"w-4 h-4"}),s.jsx("span",{children:"   ()"})]})})]})]},S.id)}):s.jsxs("div",{className:"col-span-full py-12 text-center text-gray-500",children:[s.jsx(Ar,{className:"w-16 h-16 mx-auto mb-4 opacity-20"}),s.jsx("p",{children:"    ."})]})}),u&&s.jsx(e5,{user:u,onClose:()=>h(null),onSave:(S,L)=>{t(S,L),h(null)},isLastAdmin:!1}),m&&s.jsx(t5,{user:m,onClose:()=>p(null),onApprove:()=>{},onDelete:()=>{}}),b&&s.jsx("div",{className:"fixed inset-0 z-[100] bg-black/90 backdrop-blur-sm flex justify-center items-end sm:items-center animate-fadeIn p-0 sm:p-4",onClick:()=>v(null),children:s.jsxs("div",{className:"bg-[#1a1a1a] w-full max-w-4xl h-[95vh] sm:h-[85vh] rounded-t-3xl sm:rounded-3xl border border-gray-700 shadow-2xl flex flex-col relative overflow-hidden",onClick:S=>S.stopPropagation(),children:[s.jsxs("div",{className:"flex-none p-4 border-b border-gray-700 bg-gray-900 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg text-purple-400",children:s.jsx(Si,{className:"w-6 h-6"})}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-bold text-white",children:["  ",b.name]}),s.jsxs("p",{className:"text-xs text-gray-400",children:[" : ",((E=b.products)==null?void 0:E.length)||0]})]})]}),s.jsx("button",{onClick:()=>v(null),className:"text-gray-400 hover:text-white p-2 rounded-full hover:bg-gray-800 transition-colors",children:s.jsx(ut,{className:"w-6 h-6"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar bg-[#111]",children:s.jsx(NO,{merchant:b,onUpdateMerchant:(S,L)=>t(S,L)})})]})})]})},SO=({users:n,updateUser:e,onDeleteUser:t,passwordResetRequests:r,resolvePasswordResetRequest:i,setEditingUser:o,pendingOrders:c=[],onNavigateToOrders:u,unreadChats:h=[],onNavigateToSupport:m})=>{const[p,b]=w.useState(null),[v,_]=w.useState(null),T=n.filter(z=>z.status==="pending"&&z.role!=="admin"),k=w.useMemo(()=>n.filter(z=>z.role==="merchant"&&z.hasFreeDelivery),[n]);w.useEffect(()=>{const z=P=>{var j;(j=P.state)!=null&&j.modal||(b(null),_(null))};return window.addEventListener("popstate",z),()=>window.removeEventListener("popstate",z)},[]);const E=()=>{try{window.history.pushState({view:"notifications",modal:"userDetails"},"",window.location.pathname)}catch{}},S=()=>{var z;(z=window.history.state)!=null&&z.modal?window.history.back():(b(null),_(null))},L=z=>{switch(z){case"merchant":return"";case"driver":return"";default:return z}},$=z=>{const P=n.find(j=>j.phone===z);P&&(o(P),i(z))},H=()=>{v&&(t(v.id),S())};return T.length>0||r.length>0||c.length>0||h.length>0||k.length>0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-8 max-w-5xl mx-auto px-2 animate-fadeIn pb-24",children:[s.jsxs("div",{className:"flex items-center gap-4 pb-4 border-b border-gray-700/50",children:[s.jsx("div",{className:"p-3.5 bg-gradient-to-br from-red-500 to-red-700 rounded-2xl shadow-lg shadow-red-900/20",children:s.jsx(zs,{className:"w-7 h-7 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-black text-white tracking-wide",children:" "}),s.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"    "})]})]}),h.length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h2",{className:"text-lg font-bold text-green-400 flex items-center gap-2",children:[s.jsx("span",{className:"w-2.5 h-2.5 bg-green-400 rounded-full animate-pulse shadow-[0_0_10px_rgba(74,222,128,0.5)]"}),s.jsx(Ei,{className:"w-5 h-5"}),"  (",h.length,")"]}),m&&s.jsxs("button",{onClick:m,className:"text-xs font-bold text-green-500 hover:text-green-400 bg-green-500/10 hover:bg-green-500/20 px-3 py-1.5 rounded-full transition-colors flex items-center gap-1",children:[" ",s.jsx(us,{className:"w-3 h-3"})]})]}),s.jsx("div",{className:"grid gap-3",children:h.map(z=>s.jsxs("div",{onClick:m,className:"relative bg-[#1a1a1a] rounded-2xl p-4 shadow-lg border-r-4 border-r-green-500 border-y border-l border-gray-700 hover:border-gray-500 transition-all cursor-pointer group overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 w-20 h-full bg-gradient-to-l from-green-500/10 to-transparent pointer-events-none"}),s.jsxs("div",{className:"flex items-start gap-4 relative z-10",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border-2 border-gray-600 group-hover:border-green-500 transition-colors",children:s.jsx(_t,{className:"w-6 h-6 text-gray-400"})}),s.jsx("div",{className:"absolute -bottom-1 -right-1 bg-green-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full border border-[#1a1a1a]",children:z.unreadCount})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsx("h3",{className:"font-bold text-white text-base truncate",children:z.userName}),s.jsx("span",{className:"text-[10px] text-gray-500 font-mono bg-black/30 px-2 py-0.5 rounded",children:new Date(z.lastUpdated).toLocaleTimeString("ar-EG",{hour:"2-digit",minute:"2-digit"})})]}),s.jsx("div",{className:"mt-2 bg-[#252525] p-2 rounded-lg rounded-tr-none border border-gray-700 inline-block max-w-full",children:s.jsxs("p",{className:"text-gray-300 text-sm line-clamp-1 flex items-center gap-2",children:[s.jsx(Zj,{className:"w-3 h-3 text-green-400 flex-shrink-0"}),z.lastMessage||"    "]})})]})]}),s.jsx("div",{className:"absolute bottom-3 left-3 opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx("button",{className:"bg-green-600 text-white p-1.5 rounded-full shadow-lg",children:s.jsx(us,{className:"w-4 h-4"})})})]},z.id))})]}),k.length>0&&s.jsxs("div",{className:"space-y-4 animate-fade-slide-up",children:[s.jsxs("h2",{className:"text-lg font-bold text-purple-400 flex items-center gap-2",children:[s.jsx("span",{className:"w-2.5 h-2.5 bg-purple-400 rounded-full animate-pulse shadow-[0_0_10px_rgba(192,132,252,0.5)]"}),s.jsx(Zt,{className:"w-5 h-5"}),"    (",k.length,")"]}),s.jsx("div",{className:"grid gap-3",children:k.map(z=>s.jsxs("div",{className:"relative bg-gradient-to-r from-[#2c1a36] to-[#1a1a1a] rounded-2xl p-0.5 shadow-lg group",children:[s.jsx("div",{className:"absolute top-0 right-0 w-1.5 h-full bg-purple-500 rounded-r-full"}),s.jsxs("div",{className:"bg-[#1a1a1a] rounded-[14px] p-4 flex flex-col sm:flex-row items-center justify-between gap-4 h-full",children:[s.jsxs("div",{className:"flex items-center gap-4 w-full",children:[s.jsx("div",{className:"w-14 h-14 rounded-xl bg-purple-500/10 flex items-center justify-center border border-purple-500/20 text-purple-400 shadow-inner",children:z.storeImage?s.jsx("img",{src:z.storeImage,className:"w-full h-full object-cover rounded-xl",alt:"Store"}):s.jsx(Ar,{className:"w-7 h-7"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"font-bold text-white text-lg",children:z.name}),s.jsx("span",{className:"bg-purple-600 text-white text-[9px] px-2 py-0.5 rounded font-bold",children:" "})]}),s.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["   ",s.jsx("span",{className:"text-white font-bold",children:" "})," ."]})]})]}),s.jsxs("div",{className:"flex gap-2 w-full sm:w-auto mt-2 sm:mt-0",children:[s.jsx("button",{onClick:()=>{E(),b(z)},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-xs font-bold transition-colors border border-gray-600",children:" "}),s.jsx("button",{onClick:()=>e(z.id,{hasFreeDelivery:!1}),className:"px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-400 rounded-lg text-xs font-bold transition-colors border border-red-500/10",children:" "})]})]})]},z.id))})]}),c.length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h2",{className:"text-lg font-bold text-yellow-400 flex items-center gap-2",children:[s.jsx("span",{className:"w-2.5 h-2.5 bg-yellow-400 rounded-full animate-pulse shadow-[0_0_10px_rgba(250,204,21,0.5)]"}),s.jsx(Zt,{className:"w-5 h-5"}),"   (",c.length,")"]}),u&&s.jsxs("button",{onClick:u,className:"text-xs font-bold text-yellow-500 hover:text-yellow-400 bg-yellow-500/10 hover:bg-yellow-500/20 px-3 py-1.5 rounded-full transition-colors flex items-center gap-1",children:[" ",s.jsx(us,{className:"w-3 h-3"})]})]}),s.jsx("div",{className:"grid gap-3",children:c.map(z=>{const P=z.type==="shopping_order",j=(()=>{try{const M=new Date(z.createdAt);return isNaN(M.getTime())?"":M.toLocaleString("ar-EG",{hour:"numeric",minute:"numeric"})}catch{return""}})(),O=P?"bg-[#2a1b2e]":"bg-[#1a1a1a]",I=P?"border-purple-500/30":"border-yellow-500/20",R=P?"bg-purple-500/20":"bg-yellow-500/10",F=P?"shadow-purple-900/10":"shadow-yellow-900/10";return s.jsxs("div",{className:`group relative p-0.5 rounded-2xl shadow-lg hover:${F} transition-all duration-300 ${P?"bg-gradient-to-br from-purple-900/40 to-[#252525]":"bg-gradient-to-br from-[#1e1e1e] to-[#252525]"}`,children:[s.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${P?"from-purple-500/20":"from-yellow-500/20"} to-transparent opacity-0 group-hover:opacity-100 transition-opacity rounded-2xl pointer-events-none`}),s.jsxs("div",{className:`relative ${O} rounded-[14px] p-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 h-full border ${I}`,children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center text-2xl shadow-inner border border-white/5 flex-shrink-0 ${R}`,children:P?s.jsx(Ju,{className:"w-6 h-6 text-purple-400 animate-pulse"}):""}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx("span",{className:`font-bold text-lg ${P?"text-purple-300":"text-white"}`,children:P?"  ":z.merchantName}),s.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded font-mono tracking-wider border ${P?"bg-purple-500/10 text-purple-200 border-purple-500/20":"bg-yellow-500/10 text-yellow-200 border-yellow-500/20"}`,children:z.id})]}),s.jsxs("p",{className:"text-gray-400 text-sm mt-1 flex items-center gap-1.5 leading-tight",children:[s.jsx(fs,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),z.customer.address]}),P&&s.jsx("p",{className:"text-[10px] text-purple-400 mt-1 bg-purple-900/20 px-2 py-0.5 rounded inline-block",children:"    "})]})]}),s.jsxs("div",{className:"flex flex-row sm:flex-col items-center sm:items-end justify-between w-full sm:w-auto gap-3",children:[s.jsxs("div",{className:"text-xs font-bold text-gray-400 bg-black/40 px-3 py-1.5 rounded-lg flex items-center gap-1.5 border border-white/5",children:[s.jsx(It,{className:"w-3.5 h-3.5"})," ",j]}),u&&s.jsx("button",{onClick:u,className:`${P?"bg-purple-600 hover:bg-purple-500 shadow-purple-500/20":"bg-yellow-500 hover:bg-yellow-400 shadow-yellow-500/20"} text-white text-xs font-bold px-5 py-2 rounded-lg shadow-lg transition-all active:scale-95 whitespace-nowrap`,children:" "})]})]})]},z.id)})})]}),T.length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h2",{className:"text-lg font-bold text-blue-400 flex items-center gap-2",children:[s.jsx("span",{className:"w-2.5 h-2.5 bg-blue-400 rounded-full animate-pulse shadow-[0_0_10px_rgba(96,165,250,0.5)]"}),s.jsx(_t,{className:"w-5 h-5"}),"   (",T.length,")"]}),s.jsx("div",{className:"grid gap-3",children:T.map(z=>s.jsxs("div",{className:"relative overflow-hidden bg-[#1a1a1a] rounded-2xl border border-blue-500/20 p-0.5 group shadow-lg",children:[s.jsx("div",{className:"absolute top-0 right-0 w-1.5 h-full bg-blue-500 z-10"}),s.jsx("div",{className:"absolute inset-0 bg-blue-500/5 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"}),s.jsxs("div",{className:"bg-[#1e1e1e] rounded-xl p-4 flex flex-col sm:flex-row items-center justify-between gap-4 relative z-0",children:[s.jsxs("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-14 h-14 rounded-full bg-gray-800 flex items-center justify-center overflow-hidden border-2 border-blue-500/30 shadow-md",children:s.jsx(_t,{className:"w-6 h-6 text-blue-400"})}),s.jsx("div",{className:"absolute -bottom-1 -right-1 bg-blue-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-md shadow-sm border border-[#1e1e1e]",children:L(z.role)})]}),s.jsxs("div",{className:"text-right flex-1",children:[s.jsx("h3",{className:"font-bold text-white text-lg",children:z.name}),s.jsx("p",{className:"text-gray-400 font-mono text-sm tracking-wide bg-black/20 inline-block px-2 rounded mt-1",children:z.phone})]})]}),s.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[s.jsx("button",{onClick:()=>{E(),b(z)},className:"flex-1 sm:flex-none px-4 py-2.5 bg-gray-700 hover:bg-gray-600 text-white rounded-xl text-sm font-bold transition-colors border border-gray-600",children:""}),s.jsxs("button",{onClick:()=>e(z.id,{status:"active"}),className:"flex-1 sm:flex-none px-5 py-2.5 bg-green-600 hover:bg-green-500 text-white rounded-xl text-sm font-bold shadow-lg shadow-green-900/20 transition-all active:scale-95 flex items-center justify-center gap-1.5",children:[s.jsx(Je,{className:"w-4 h-4"})," "]}),s.jsx("button",{onClick:()=>{E(),_(z)},className:"px-3.5 py-2.5 bg-red-500/10 hover:bg-red-500/20 text-red-500 rounded-xl transition-colors border border-red-500/10",children:s.jsx(Tt,{className:"w-5 h-5"})})]})]})]},z.id))})]}),r.length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h2",{className:"text-lg font-bold text-red-400 flex items-center gap-2",children:[s.jsx("span",{className:"w-2.5 h-2.5 bg-red-400 rounded-full animate-pulse shadow-[0_0_10px_rgba(248,113,113,0.5)]"}),s.jsx(Js,{className:"w-5 h-5"}),"    "]}),s.jsx("div",{className:"grid gap-3",children:r.map(z=>{const P=n.find(j=>j.phone===z.phone);return P?s.jsxs("div",{className:"bg-gradient-to-r from-red-900/20 to-[#1a1a1a] border border-red-500/30 p-4 rounded-2xl flex justify-between items-center shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"p-3 bg-red-500/10 rounded-full text-red-400 border border-red-500/20",children:s.jsx(Js,{className:"w-6 h-6"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold text-white text-lg",children:P.name}),s.jsx("p",{className:"text-xs text-red-300 font-mono mt-0.5",children:P.phone})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>$(z.phone),className:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg text-xs font-bold shadow-md shadow-red-900/20 transition-all active:scale-95",children:""}),s.jsx("button",{onClick:()=>i(z.phone),className:"p-2 bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded-lg transition-colors border border-gray-700",children:s.jsx(Tt,{className:"w-5 h-5"})})]})]},z.phone):null})})]})]}),p&&s.jsx(t5,{user:p,onClose:S,onApprove:(z,P)=>{e(z,P),S()},onDelete:z=>{_(p)}}),v&&s.jsx(jn,{title:"   ",message:`       "${v.name}"    .`,onClose:()=>_(null),onConfirm:H,confirmButtonText:"  ",confirmVariant:"danger",cancelButtonText:""})]}):s.jsxs("div",{className:"flex flex-col items-center justify-center text-center h-[calc(100vh-15rem)]",children:[s.jsx("div",{className:"w-24 h-24 bg-gray-800/50 rounded-full flex items-center justify-center mb-6 shadow-inner animate-pulse ring-1 ring-white/10",children:s.jsx(zs,{className:"w-12 h-12 text-gray-600"})}),s.jsx("h3",{className:"text-2xl font-bold text-gray-300",children:"  !"}),s.jsx("p",{className:"text-gray-500 mt-2",children:"     ."})]})},Jp=({label:n,value:e,subValue:t,icon:r,colorClass:i})=>s.jsxs("div",{className:"bg-[#1e293b]/80 backdrop-blur-md rounded-2xl p-4 border border-gray-700/50 shadow-xl flex flex-col justify-between h-full relative overflow-hidden group",children:[s.jsx("div",{className:`absolute top-0 right-0 w-full h-1 ${i.replace("text-","bg-")}/50`}),s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("span",{className:"text-xs text-gray-400 font-medium",children:n}),s.jsx("div",{className:`p-2 rounded-xl bg-gray-800/50 ${i}`,children:r})]}),s.jsxs("div",{children:[s.jsx("span",{className:`text-xl font-black ${i} tracking-tight`,children:e}),t&&s.jsx("span",{className:"text-[10px] text-gray-500 block mt-1",children:t})]})]}),_ee=({driver:n,payments:e,orders:t,onBack:r,onDeletePayment:i,currentUser:o,manualDailies:c=[],onEditDaily:u,onDeleteDaily:h})=>{const m=S=>{const L=(S.reconciledOrderIds||[]).map(R=>t.find(F=>F.id===R)).filter(R=>!!R&&R.status!==ue.Cancelled),$=L.length,H=L.reduce((R,F)=>R+(F.deliveryFee||0),0);let G=0;n.commissionType==="fixed"?G=$*(n.commissionRate||0):G=H*((n.commissionRate||0)/100),G>H&&(G=H);let z=0,P=0,j=0;if(S.reconciledManualDailyIds&&S.reconciledManualDailyIds.length>0){const R=c.filter(F=>{var M;return(M=S.reconciledManualDailyIds)==null?void 0:M.includes(F.id)});P=R.reduce((F,M)=>F+(M.ordersCount||0),0),z=R.reduce((F,M)=>F+(M.amount||0),0),j=R.reduce((F,M)=>F+(M.totalDeliveryFees||0),0)}G+=z;const O=H+j,I=O-G;return{...S,verifiedCount:$,verifiedDailiesCount:P,dailiesAmount:z,companyShare:G,driverShare:I,verifiedTotalCollected:O,verifiedAmount:S.amount,isValid:$>0||P>0}},p=w.useMemo(()=>e.filter(S=>S.driverId===n.id).map(m).filter(S=>S.isValid).sort((S,L)=>new Date(L.createdAt).getTime()-new Date(S.createdAt).getTime()),[e,n.id,t,c]),b=w.useMemo(()=>p.reduce((S,L)=>({totalCollected:S.totalCollected+L.verifiedTotalCollected,totalDriverShare:S.totalDriverShare+L.driverShare,totalCompanyShare:S.totalCompanyShare+L.companyShare,totalPaid:S.totalPaid+L.amount}),{totalCollected:0,totalDriverShare:0,totalCompanyShare:0,totalPaid:0}),[p]),[v,_]=Rn.useState(!1),T=S=>{let L;return typeof S=="string"||typeof S=="number"?L=new Date(S):S!=null&&S.seconds?L=new Date(S.seconds*1e3):L=new Date(S),L.getHours()<6&&L.setDate(L.getDate()-1),L},[k,E]=Rn.useState(null);return s.jsxs("div",{className:"fixed inset-0 bg-[#0f172a] z-50 animate-fadeIn flex flex-col font-sans",children:[s.jsx("div",{className:`
                fixed top-0 left-0 right-0 z-30 pt-safe transition-all duration-300
                bg-[#0f172a]/90 backdrop-blur-xl border-b border-gray-800
                ${v?"pb-3 shadow-lg":"pb-6"}
            `,children:s.jsx("div",{className:"max-w-5xl mx-auto px-4 w-full pt-4",children:s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:r,className:"bg-gray-800 hover:bg-gray-700 text-gray-200 p-2.5 rounded-full border border-gray-700 transition-all active:scale-95",children:s.jsx(IZ,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-white leading-tight",children:" "}),s.jsx("p",{className:"text-xs text-blue-400 font-bold mt-0.5",children:n.name})]})]}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-wider font-bold",children:" "}),s.jsx("p",{className:"text-lg font-black text-white leading-none",children:p.length})]})]})})}),s.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar-hide",onScroll:S=>_(S.currentTarget.scrollTop>20),children:s.jsxs("div",{className:"max-w-5xl mx-auto px-4 pb-24 pt-[6.5rem]",children:[" ",s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6 animate-slide-up",style:{animationDelay:"0.1s"},children:[s.jsx(Jp,{label:" ",value:`${b.totalCollected.toLocaleString("en-US")} .`,icon:s.jsx(Ed,{className:"w-5 h-5"}),colorClass:"text-blue-400"}),s.jsx(Jp,{label:" ",value:`${b.totalDriverShare.toLocaleString("en-US")} .`,subValue:"  ",icon:s.jsx(Zt,{className:"w-5 h-5"}),colorClass:"text-green-400"}),s.jsx(Jp,{label:" ",value:`${b.totalCompanyShare.toLocaleString("en-US")} .`,subValue:" ",icon:s.jsx(X1,{className:"w-5 h-5"}),colorClass:"text-red-400"}),s.jsx(Jp,{label:" ",value:`${b.totalPaid.toLocaleString("en-US")} .`,subValue:"  ",icon:s.jsx(Je,{className:"w-5 h-5"}),colorClass:"text-emerald-400"})]}),s.jsxs("div",{className:"space-y-4 animate-slide-up",style:{animationDelay:"0.2s"},children:[c.filter(S=>S.driverId===n.id&&!S.reconciled).length>0&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("h3",{className:"text-sm font-bold text-yellow-500 px-1 border-r-4 border-yellow-500 mr-1 flex items-center gap-2",children:[s.jsx(It,{className:"w-4 h-4"}),"  ( )"]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:c.filter(S=>S.driverId===n.id&&!S.reconciled).map(S=>s.jsxs("div",{className:"bg-yellow-500/5 border border-yellow-500/20 rounded-2xl p-4 flex justify-between items-center group hover:bg-yellow-500/10 transition-all",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-xl bg-yellow-500/10 flex items-center justify-center text-yellow-500 border border-yellow-500/20",children:s.jsx(ei,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-white font-bold text-sm",children:[S.ordersCount," "]}),s.jsxs("span",{className:"text-[10px] text-yellow-500 font-bold bg-yellow-500/10 px-2 py-0.5 rounded border border-yellow-500/20",children:[S.amount," ."]})]}),s.jsx("p",{className:"text-[10px] text-gray-400 mt-0.5",children:new Date(S.dayDate).toLocaleDateString("ar-EG-u-nu-latn",{weekday:"long",day:"numeric",month:"short"})})]})]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("button",{onClick:()=>u==null?void 0:u(S),className:"p-2 bg-blue-500/10 text-blue-400 rounded-xl hover:bg-blue-600 hover:text-white transition-all border border-blue-500/20",title:" ",children:s.jsx(Js,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>h==null?void 0:h(S.id,n.name),className:"p-2 bg-red-500/10 text-red-500 rounded-xl hover:bg-red-600 hover:text-white transition-all border border-red-500/20",title:" ",children:s.jsx(Tt,{className:"w-3.5 h-3.5"})})]})]},S.id))})]}),s.jsx("h3",{className:"text-sm font-bold text-gray-400 px-1 border-r-4 border-blue-500 mr-1",children:"  "}),p.length>0?p.map((S,L)=>{const $=T(S.createdAt);return s.jsxs("div",{className:"bg-[#1e293b] rounded-2xl p-0 border border-gray-700 hover:border-blue-500/30 transition-all duration-300 shadow-lg overflow-hidden group",children:[s.jsx("div",{className:"h-1 w-full bg-gradient-to-r from-green-500 via-blue-500 to-green-500 opacity-60"}),s.jsxs("div",{className:"p-4 md:p-5 flex flex-col md:flex-row gap-4 md:items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[s.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-900/20 flex items-center justify-center border border-blue-500/20 text-blue-400 shrink-0",children:s.jsx(ei,{className:"w-6 h-6"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between md:justify-start gap-2 mb-1",children:[s.jsx("span",{className:"text-white font-bold text-lg",children:$.toLocaleDateString("ar-EG-u-nu-latn",{weekday:"long",day:"numeric",month:"short"})}),s.jsx("span",{className:"bg-gray-800 text-gray-400 text-[10px] px-2 py-0.5 rounded-full border border-gray-700 font-mono",children:new Date(S.createdAt).toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric"})})]}),s.jsxs("p",{className:"text-xs text-gray-500 font-mono tracking-wider",children:["ID: #",S.id.slice(-8).toUpperCase()]})]})]}),s.jsx("div",{className:"bg-black/20 rounded-xl border border-white/5 w-full md:w-auto",children:s.jsxs("div",{className:"grid grid-cols-3 md:flex md:items-center divide-x divide-x-reverse divide-gray-700/50 md:divide-x-0 md:gap-6 p-3",children:[s.jsxs("div",{className:"flex flex-col items-center md:items-start px-2 md:px-0",children:[s.jsx("span",{className:"text-[10px] text-gray-500 mb-0.5",children:""}),s.jsx("span",{className:"text-sm font-bold text-white",children:S.verifiedCount+(S.verifiedDailiesCount||0)})]}),s.jsxs("div",{className:"flex flex-col items-center md:items-start px-2 md:px-0 md:border-r md:border-gray-700 md:pr-6",children:[s.jsx("span",{className:"text-[10px] text-green-500/70 mb-0.5",children:""}),s.jsx("span",{className:"text-sm font-bold text-green-400",children:Math.round(S.driverShare)})]}),s.jsxs("div",{className:"flex flex-col items-center md:items-start px-2 md:px-0 md:border-r md:border-gray-700 md:pr-6",children:[s.jsx("span",{className:"text-[10px] text-red-500/70 mb-0.5",children:""}),s.jsx("span",{className:"text-sm font-bold text-red-400",children:Math.round(S.companyShare)})]})]})}),s.jsxs("div",{className:"flex items-center justify-between gap-4 w-full md:w-auto pt-3 md:pt-0 border-t md:border-t-0 border-gray-800/50",children:[s.jsx("span",{className:"md:hidden text-xs text-gray-500",children:" "}),s.jsxs("div",{className:"flex items-center gap-4 flex-1 md:flex-none justify-end",children:[s.jsxs("span",{className:"text-xl font-black text-white",children:[S.amount.toLocaleString("en-US")," ",s.jsx("span",{className:"text-xs font-medium text-gray-500",children:"."})]}),(o==null?void 0:o.role)==="admin"&&s.jsx("button",{onClick:()=>E(S.id),className:"p-2 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-600 hover:text-white transition-all border border-red-500/20",title:" ",children:s.jsx(Tt,{className:"w-5 h-5"})})]})]})]})]},S.id)}):s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-[#1e293b]/50 rounded-3xl border border-dashed border-gray-700",children:[s.jsx(X1,{className:"w-16 h-16 text-gray-600 mb-4 opacity-50"}),s.jsx("h3",{className:"text-lg font-bold text-gray-300",children:"   "}),s.jsx("p",{className:"text-sm text-gray-500",children:"       ."})]})]})]})}),k&&s.jsx("div",{className:"fixed inset-0 z-[200] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>E(null),children:s.jsx("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-red-500/30 shadow-2xl p-6 transform scale-100 animate-pop-in",onClick:S=>S.stopPropagation(),children:s.jsxs("div",{className:"flex flex-col items-center text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mb-4 ring-1 ring-red-500/30",children:s.jsx(ut,{className:"w-8 h-8 text-red-500"})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),s.jsxs("p",{className:"text-sm text-gray-400 mb-6 leading-relaxed",children:["        ",s.jsx("br",{}),s.jsx("span",{className:"text-red-400 font-bold",children:":"}),"          ."]}),s.jsxs("div",{className:"flex gap-3 w-full",children:[s.jsx("button",{className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white font-bold py-3.5 rounded-xl transition-all",onClick:()=>E(null),children:""}),s.jsx("button",{className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-3.5 rounded-xl shadow-lg shadow-red-900/20 transition-all",onClick:()=>{i&&k&&i(k),E(null)},children:" "})]})]})})})]})},Nee=({isOpen:n,onClose:e,drivers:t,onSave:r,preSelectedDriver:i,initialData:o})=>{const[c,u]=w.useState((i==null?void 0:i.id)||""),[h,m]=w.useState(new Date().toISOString().split("T")[0]),[p,b]=w.useState(""),[v,_]=w.useState(""),[T,k]=w.useState(""),[E,S]=w.useState(!1);w.useEffect(()=>{o?(u(o.driverId),m(o.dayDate),b(o.ordersCount),k(o.note||""),o.totalDeliveryFees&&o.ordersCount&&_(o.totalDeliveryFees/o.ordersCount)):i&&(u(i.id),m(new Date().toISOString().split("T")[0]),b(""),_(""),k(""))},[o,i,n]);const L=t.find(z=>z.id===c),H=(()=>{if(!L||!p)return 0;const z=L.commissionRate||0;return L.commissionType==="fixed"?Number(p)*z:v?Number(p)*Number(v)*(z/100):0})(),G=async z=>{if(z.preventDefault(),!(!c||!p||!h)){S(!0);try{await r({id:o==null?void 0:o.id,driverId:c,date:h,count:Number(p),note:T,amount:H,totalDeliveryFees:v?Number(p)*Number(v):void 0}),e()}catch(P){console.error(P)}finally{S(!1)}}};return n?Jh.createPortal(s.jsx("div",{className:"fixed inset-0 z-[300] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-2xl border border-gray-700 shadow-2xl overflow-hidden animate-pop-in",onClick:z=>z.stopPropagation(),children:[s.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[s.jsx(xZ,{className:"w-5 h-5 text-green-400"}),o?" ":"  "]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white p-1 rounded-full hover:bg-gray-800",children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsxs("form",{onSubmit:G,className:"p-6 space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-bold text-gray-400 block",children:""}),s.jsxs("select",{value:c,onChange:z=>u(z.target.value),disabled:!!i,className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-3 px-4 text-white text-sm outline-none focus:border-green-500 disabled:opacity-50",required:!0,children:[s.jsx("option",{value:"",children:" "}),t.map(z=>s.jsx("option",{value:z.id,children:z.name},z.id))]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-bold text-gray-400 block",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"date",value:h,onChange:z=>m(z.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-3 px-4 text-white text-sm outline-none focus:border-green-500 pl-10",required:!0}),s.jsx(ei,{className:"absolute left-3 top-3.5 w-4 h-4 text-gray-500"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-bold text-gray-400 block",children:" "}),s.jsx("input",{type:"number",min:"1",value:p,onChange:z=>b(Number(z.target.value)),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-3 px-4 text-white text-sm outline-none focus:border-green-500 font-mono",placeholder:"0",required:!0})]}),L&&L.commissionType==="percentage"&&s.jsxs("div",{className:"space-y-2 animate-fadeIn",children:[s.jsx("label",{className:"text-xs font-bold text-yellow-500 block",children:"    ( )"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"number",min:"0",step:"0.01",value:v,onChange:z=>_(Number(z.target.value)),className:"w-full bg-[#0f172a] border border-yellow-500/50 rounded-xl py-3 px-4 text-white text-sm outline-none focus:border-yellow-500 font-mono pl-10",placeholder:": 25",required:!0}),s.jsx("span",{className:"absolute left-3 top-3.5 text-xs text-gray-500 font-bold",children:"."})]}),s.jsxs("p",{className:"text-[10px] text-gray-500",children:[": ",s.jsxs("span",{className:"text-white font-bold",children:[p&&v?(Number(p)*Number(v)).toLocaleString():0," ."]})," | ",": ",s.jsxs("span",{className:"text-green-400 font-bold",children:[L.commissionRate,"%"]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-bold text-gray-400 block",children:" ()"}),s.jsx("textarea",{value:T,onChange:z=>k(z.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-3 px-4 text-white text-sm outline-none focus:border-green-500 resize-none h-20",placeholder:"  ..."})]}),s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700 flex justify-between items-center",children:[s.jsx("span",{className:"text-xs font-bold text-gray-400",children:"  ()"}),s.jsxs("span",{className:"text-xl font-black text-green-400",children:[H.toLocaleString()," ",s.jsx("span",{className:"text-xs text-gray-500",children:"."})]})]}),s.jsxs("button",{type:"submit",disabled:E||!c||!p,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-gray-700 disabled:text-gray-500 text-white font-bold py-3.5 rounded-xl shadow-lg transition-all active:scale-95 flex items-center justify-center gap-2 mt-2",children:[E?s.jsx("span",{className:"animate-spin h-5 w-5 border-2 border-white border-t-transparent rounded-full"}):s.jsx(Je,{className:"w-5 h-5"}),o?" ":" "]})]})]})}),document.body):null},S_=({label:n,value:e,currency:t=".",colorClass:r="text-white"})=>s.jsxs("div",{className:"flex justify-between items-baseline bg-gray-700/50 p-3 rounded-lg border border-gray-600/50",children:[s.jsx("span",{className:"text-sm font-medium text-gray-400",children:n}),s.jsxs("span",{className:`text-lg font-bold ${r}`,children:[e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})," ",t]})]}),jee=({status:n,mode:e,onChange:t})=>{if(e==="always_open")return s.jsxs("div",{className:"flex items-center gap-2 bg-blue-500/10 border border-blue-500/20 px-3 py-2 rounded-lg w-full justify-center",children:[s.jsx(It,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-xs font-bold text-blue-300",children:"  "})]});const r=n==="active";return s.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-gray-400 font-medium",children:" "}),s.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded ${r?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:r?" ":""})]}),s.jsx("button",{onClick:t,className:`
                    relative group w-full py-2 px-1 rounded-lg flex items-center justify-center gap-2 transition-all duration-300 border
                    ${r?"bg-green-600 hover:bg-green-700 border-green-500 text-white shadow-lg shadow-green-900/20":"bg-[#1a1a1a] hover:bg-[#222] border-gray-600 text-gray-400 hover:text-white"}
                `,children:r?s.jsxs(s.Fragment,{children:[s.jsx(Je,{className:"w-4 h-4"}),s.jsx("span",{className:"text-xs font-bold",children:" "})]}):s.jsxs(s.Fragment,{children:[s.jsx(ut,{className:"w-4 h-4"}),s.jsx("span",{className:"text-xs font-bold",children:"  -  "})]})})]})},EO=({orders:n,users:e,payments:t,updateUser:r,handleDriverPayment:i,onDeletePayment:o,currentUser:c,manualDailies:u=[],logAction:h,permissions:m})=>{const p=!m||m.includes("manage_advanced_financials");!m||m.includes("view_wallet");const[b,v]=w.useState(null),[_,T]=w.useState(null),[k,E]=w.useState(!1),[S,L]=w.useState(!1),[$,H]=w.useState(!1),[G,z]=w.useState(null),[P,j]=w.useState(null),[O,I]=w.useState(null),R=e.filter(V=>V.role==="driver"),F=V=>{try{window.history.pushState({view:"wallet",modal:V},"",window.location.pathname)}catch{}},M=()=>{var V;v(null),T(null),(V=window.history.state)!=null&&V.modal&&window.history.back()};if(w.useEffect(()=>{const V=Q=>{var ae;(ae=Q.state)!=null&&ae.modal||(v(null),T(null))};return window.addEventListener("popstate",V),()=>window.removeEventListener("popstate",V)},[]),R.length===0)return s.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 h-[calc(100vh-15rem)]",children:[s.jsx(Kj,{className:"w-16 h-16 text-gray-600 mb-4"}),s.jsx("h3",{className:"text-xl font-semibold",children:"   "}),s.jsx("p",{className:"text-gray-400",children:"    ."})]});const ne=()=>{var V;if(_){const Q=_.driver.id;T(null),((V=window.history.state)==null?void 0:V.modal)==="pay"&&window.history.back(),i(Q),E(!0),setTimeout(()=>E(!1),2e3)}},U=async V=>{var Q;try{const ae=!!V.id,X=ae?u.find(te=>te.id===V.id):null,B=V.id||`DAILY-${Date.now()}`,Y={id:B,driverId:V.driverId,dayDate:V.date,ordersCount:V.count,amount:V.amount,note:V.note,totalDeliveryFees:V.totalDeliveryFees,createdBy:ae&&(X==null?void 0:X.createdBy)||c.id,createdAt:ae?(X==null?void 0:X.createdAt)||new Date:new Date,reconciled:ae&&(X==null?void 0:X.reconciled)||!1};await Hj("manual_dailies",B,Y);const ge=((Q=e.find(te=>te.id===V.driverId))==null?void 0:Q.name)||"Unknown Driver",Z=ae?`   ${ge}`:`   ${ge}`;h(ae?"update":"financial",ae?" ":" ",`${Z}  ${V.amount} . (${V.count} )`),H(!1),z(null),j(null)}catch(ae){console.error(ae)}},A=async()=>{if(O)try{await Gj("manual_dailies",O.id),h("delete"," ",`     ${O.driverName}`),I(null)}catch(V){console.error("Error deleting daily:",V)}};return sn(()=>S?(L(!1),v(null),!0):_||O?(M(),!0):k?(E(!1),!0):!1,[S,_,k]),s.jsxs(s.Fragment,{children:[S&&b&&s.jsx("div",{className:"fixed inset-0 z-[100] bg-gray-900 overflow-hidden",children:s.jsx(_ee,{driver:b,payments:t,orders:n,onBack:()=>{L(!1),v(null)},onDeletePayment:o,currentUser:c,manualDailies:u,onEditDaily:V=>{j(V),H(!0)},onDeleteDaily:(V,Q)=>I({id:V,driverName:Q})})}),s.jsx(Nee,{isOpen:$,onClose:()=>{H(!1),z(null),j(null)},drivers:R,onSave:U,preSelectedDriver:G,initialData:P}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 pb-32",children:R.map(V=>{const Q=n.filter(Ue=>Ue.driverId===V.id&&Ue.status===ue.Delivered&&!Ue.reconciled&&!Ue.isArchived),ae=V.commissionRate||0,X=u.filter(Ue=>Ue.driverId===V.id&&!Ue.reconciled),B=X.reduce((Ue,st)=>Ue+(st.amount||0),0),Y=X.reduce((Ue,st)=>Ue+(st.totalDeliveryFees||0),0),ge=Q.reduce((Ue,st)=>Ue+(st.deliveryFee||0),0)+Y;let Z=0;V.commissionType==="fixed"?Z=Q.length*ae:Z=Q.reduce((st,fe)=>st+(fe.deliveryFee||0),0)*(ae/100),Z+=B;const te=ge-Z,me=V.commissionType==="fixed"?`${ae} ./`:`${ae}%`,re=()=>{const Ue=V.dailyLogStatus==="active"?"closed":"active",st={dailyLogStatus:Ue};Ue==="active"&&(st.dailyLogStartedAt=new Date),r(V.id,st)},he=V.dailyLogStatus==="active"||V.dailyLogMode==="always_open"?"border-l-4 border-l-green-500":"border-l-4 border-l-red-500",Oe=n.some(Ue=>String(Ue.driverId)===String(V.id)&&Ue.status!==ue.Delivered&&Ue.status!==ue.Cancelled&&!Ue.isArchived);return s.jsxs("div",{className:`bg-gray-800 rounded-xl shadow-lg flex flex-col overflow-hidden transition-all duration-300 ${he}`,children:[s.jsx("div",{className:"p-5 pb-0 flex justify-between items-start",children:s.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[s.jsx("div",{className:"w-12 h-12 bg-gray-700 rounded-full flex items-center justify-center overflow-hidden border border-gray-600",children:V.storeImage?s.jsx("img",{src:V.storeImage,className:"w-full h-full object-cover",alt:"Avatar"}):s.jsx(_t,{className:"w-6 h-6 text-gray-300"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-lg text-white",children:V.name}),s.jsxs("p",{className:"text-xs text-blue-300 font-mono tracking-widest font-bold",children:["#",V.id.slice(-6)]})]})]})}),s.jsxs("div",{className:"p-5 space-y-4",children:[p&&s.jsx("div",{className:"bg-black/20 p-3 rounded-xl border border-white/5",children:s.jsx(jee,{status:V.dailyLogStatus||"closed",mode:V.dailyLogMode||"12_hour",onChange:re})}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between items-center mb-1",children:[s.jsx("h4",{className:"text-xs font-bold text-gray-400",children:"  ( )"}),s.jsxs("span",{className:"text-[10px] bg-gray-700 px-2 py-0.5 rounded text-gray-300",children:[Q.length+X.length," "]})]}),s.jsx(S_,{label:" ",value:ge,colorClass:"text-blue-400"}),s.jsx(S_,{label:`  (${me})`,value:Z,colorClass:"text-red-400"}),B>0&&s.jsxs("div",{className:"flex flex-col gap-2 mt-1 bg-yellow-900/10 p-2 rounded-lg border border-yellow-500/10",children:[s.jsxs("div",{className:"flex justify-between items-baseline border-b border-yellow-500/10 pb-1",children:[s.jsxs("span",{className:"text-xs text-yellow-500/80 font-bold flex items-center gap-1",children:[s.jsx(vO,{className:"w-3 h-3"}),"  (",X.length,")"]}),s.jsxs("span",{className:"text-xs font-black text-yellow-500",children:["+ ",B," ."]})]}),s.jsx("div",{className:"space-y-1",children:X.map(Ue=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-800/50 rounded px-2 py-1.5 hover:bg-gray-700/50 transition-colors",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("span",{className:"text-[10px] text-gray-300 font-bold",children:[Ue.ordersCount,"  - ",Ue.amount," ."]}),s.jsx("span",{className:"text-[9px] text-gray-500 font-mono tracking-wide",children:new Date(Ue.dayDate).toLocaleDateString("ar-EG")})]}),s.jsx("div",{className:"flex items-center gap-1",children:p&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>{j(Ue),H(!0)},className:"text-blue-400 hover:text-blue-300 hover:bg-blue-500/10 p-1.5 rounded-lg transition-all",title:" ",children:s.jsx(Js,{className:"w-3.5 h-3.5"})}),s.jsx("button",{onClick:()=>I({id:Ue.id,driverName:V.name}),className:"text-red-500 hover:text-red-400 hover:bg-red-500/10 p-1.5 rounded-lg transition-all",title:" ",children:s.jsx(Tt,{className:"w-3 h-3"})})]})})]},Ue.id))})]}),s.jsx(S_,{label:" ",value:te,colorClass:"text-green-400"})]})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 border-t border-gray-700",children:[s.jsxs("button",{onClick:()=>{v(V),L(!0)},className:"flex items-center text-xs font-bold text-gray-400 hover:text-white transition-colors",children:[s.jsx(X1,{className:"w-4 h-4 ml-1.5"})," "]}),c.role==="admin"&&s.jsxs("button",{onClick:()=>{z(V),H(!0)},className:"flex items-center text-xs font-bold text-gray-500 hover:text-white transition-colors mr-auto ml-4",title:"  ",children:[s.jsx(It,{className:"w-4 h-4 ml-1.5"}),""]}),Oe?s.jsxs("div",{className:"flex items-center text-xs bg-red-900/40 text-red-400 font-bold px-4 py-2.5 rounded-lg border border-red-900/50 cursor-not-allowed w-auto text-center",title:"      ",children:[s.jsx(It,{className:"w-4 h-4 ml-2 animate-pulse"}),"  "]}):s.jsx("button",{onClick:()=>{F("pay"),T({driver:V,amount:Z})},disabled:Q.length===0&&X.length===0,className:"flex items-center text-xs bg-green-600 text-white hover:bg-green-700 font-bold px-4 py-2.5 rounded-lg transition-colors disabled:bg-gray-700 disabled:text-gray-500 disabled:cursor-not-allowed shadow-md",children:" "})]})]},V.id)})}),_&&s.jsx(jn,{title:"  ",message:`    ${_.amount.toLocaleString("en-US",{minimumFractionDigits:2})} .   ${_.driver.name}       .`,onClose:M,onConfirm:ne,confirmButtonText:" ",confirmVariant:"success"}),O&&s.jsx(jn,{title:"  ",message:`        ${O.driverName}      .`,onClose:()=>I(null),onConfirm:A,confirmButtonText:" ",confirmVariant:"danger"}),k&&s.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-6 bg-black/60 backdrop-blur-[2px] animate-fadeIn",style:{touchAction:"none"},onClick:()=>E(!1),children:s.jsxs("div",{className:"w-full max-w-xs bg-[#1e293b] rounded-2xl border border-gray-700 shadow-2xl p-6 text-center transform scale-100 animate-pop-in relative overflow-hidden",onClick:V=>V.stopPropagation(),children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-green-500 via-emerald-500 to-green-500"}),s.jsx("div",{className:"flex justify-center mb-4",children:s.jsx("div",{className:"p-3 rounded-full bg-[#0f172a] border border-gray-700 shadow-inner",children:s.jsx(Je,{className:"w-10 h-10 text-green-500 animate-pulse"})})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),s.jsx("p",{className:"text-gray-400 text-sm",children:"     ."})]})})]})},TO=({users:n,onSendMessage:e,messages:t=[],deleteMessage:r})=>{const[i,o]=w.useState("driver"),[c,u]=w.useState([]),[h,m]=w.useState(""),[p,b]=w.useState(""),[v,_]=w.useState(null),[T,k]=w.useState(null),[E,S]=w.useState(""),[L,$]=w.useState(null),H=A=>{try{window.history.pushState({view:"messages",modal:A},"",window.location.pathname)}catch{}},G=()=>{var A;(A=window.history.state)!=null&&A.modal?window.history.back():$(null)};w.useEffect(()=>{const A=V=>{var Q;(Q=V.state)!=null&&Q.modal||$(null)};return window.addEventListener("popstate",A),()=>window.removeEventListener("popstate",A)},[]);const z=w.useMemo(()=>n.filter(A=>A.role===i),[n,i]),P=w.useMemo(()=>h?z.filter(A=>A.name.toLowerCase().includes(h.toLowerCase())||A.phone&&A.phone.includes(h)):z,[z,h]);w.useEffect(()=>{u([]),m("")},[i]);const j=()=>{c.length===P.length&&P.length>0?u([]):u(P.map(A=>A.id))},O=A=>{u(V=>V.includes(A)?V.filter(Q=>Q!==A):[...V,A])},I=w.useMemo(()=>[...t].sort((A,V)=>new Date(V.createdAt).getTime()-new Date(A.createdAt).getTime()),[t]),R=A=>{var Q;const V=(Q=A.target.files)==null?void 0:Q[0];if(V){const ae=new FileReader;ae.onloadend=()=>{_(ae.result),k(URL.createObjectURL(V))},ae.readAsDataURL(V)}else _(null),k(null)},F=()=>{if(c.length===0){S("     .");return}if(!p.trim()){S("   .");return}e({text:p,image:v||void 0,targetRole:i,targetIds:c}),b(""),_(null),k(null),u([]),S("")},M=()=>{L&&r&&r(L),G()},ne=A=>{if(A.targetId==="all"||A.targetId==="multiple")return A.targetRole==="driver"?"  ":A.targetRole==="merchant"?"  ":"  ";const V=n.find(Q=>Q.id===A.targetId);return V?` ${V.name}`:"  "},U=({checked:A})=>A?s.jsx("div",{className:"bg-red-600 text-white rounded p-0.5",children:s.jsx(NZ,{className:"w-5 h-5"})}):s.jsx("div",{className:"text-gray-500",children:s.jsx(jZ,{className:"w-5 h-5"})});return s.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 pb-32",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsx("div",{className:"lg:col-span-1 space-y-6",children:s.jsxs("div",{className:"bg-gray-800 rounded-2xl shadow-xl border border-gray-700 overflow-hidden sticky top-6",children:[s.jsxs("div",{className:"p-5 border-b border-gray-700 bg-gray-900/50 flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-red-600 rounded-lg shadow-lg shadow-red-900/20",children:s.jsx(Ni,{className:"w-5 h-5 text-white"})}),s.jsx("h2",{className:"text-lg font-bold text-white",children:" "})]}),s.jsxs("div",{className:"p-5 space-y-5",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:" "}),s.jsx("div",{className:"grid grid-cols-3 gap-2 bg-gray-900 p-1.5 rounded-xl border border-gray-700",children:[{id:"driver",label:""},{id:"merchant",label:""},{id:"customer",label:""}].map(A=>s.jsx("button",{onClick:()=>o(A.id),className:`py-2 text-xs font-bold rounded-lg transition-all duration-200 ${i===A.id?"bg-gray-700 text-white shadow-md":"text-gray-500 hover:text-gray-300 hover:bg-gray-800"}`,children:A.label},A.id))})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:["  (",c.length,")"]}),s.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-xl overflow-hidden",children:[s.jsxs("div",{className:"p-2 border-b border-gray-700 flex items-center gap-2",children:[s.jsxs("button",{onClick:j,className:"p-2 hover:bg-gray-800 rounded-lg transition-colors flex items-center gap-2 text-xs font-bold text-gray-300",children:[s.jsx(U,{checked:c.length>0&&c.length===P.length}),""]}),s.jsx("div",{className:"h-6 w-px bg-gray-700 mx-1"}),s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(mr,{className:"absolute right-2 top-2 w-4 h-4 text-gray-500"}),s.jsx("input",{type:"text",placeholder:"...",value:h,onChange:A=>m(A.target.value),className:"w-full bg-transparent border-none text-white text-xs py-2 pr-8 pl-2 focus:ring-0 placeholder-gray-600"})]})]}),s.jsx("div",{className:"max-h-48 overflow-y-auto p-1 custom-scrollbar",children:P.length>0?P.map(A=>s.jsx("div",{onClick:()=>O(A.id),className:`flex items-center justify-between p-2 rounded-lg cursor-pointer transition-colors ${c.includes(A.id)?"bg-red-900/20":"hover:bg-gray-800"}`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(U,{checked:c.includes(A.id)}),s.jsxs("div",{children:[s.jsx("p",{className:`text-xs font-bold ${c.includes(A.id)?"text-red-200":"text-gray-300"}`,children:A.name}),s.jsx("p",{className:"text-[10px] text-gray-500 font-mono",children:A.phone})]})]})},A.id)):s.jsx("p",{className:"text-center text-gray-500 py-4 text-xs",children:"  "})})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:" "}),s.jsx("textarea",{rows:4,value:p,onChange:A=>b(A.target.value),className:"w-full px-4 py-3 bg-gray-900 border border-gray-700 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none text-white placeholder:text-gray-600 text-sm resize-none transition-all",placeholder:"  ..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:"  ()"}),s.jsxs("label",{className:"flex items-center justify-center w-full px-4 py-3 bg-gray-900 border border-dashed border-gray-600 rounded-xl cursor-pointer hover:border-red-500 hover:bg-gray-900/80 transition-all group",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Zr,{className:"w-5 h-5 text-gray-500 group-hover:text-red-500 transition-colors"}),s.jsx("span",{className:"text-xs text-gray-500 group-hover:text-gray-300",children:"  "})]}),s.jsx("input",{type:"file",accept:"image/*",onChange:R,className:"hidden"})]})]}),T&&s.jsxs("div",{className:"relative rounded-xl overflow-hidden border border-gray-700 group",children:[s.jsx("img",{src:T,alt:"Preview",className:"w-full h-40 object-cover"}),s.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:s.jsx("button",{onClick:()=>{_(null),k(null)},className:"bg-red-600 text-white p-2 rounded-full shadow-lg hover:scale-110 transition-transform",children:s.jsx(ut,{className:"w-4 h-4"})})})]}),E&&s.jsx("p",{className:"text-red-400 text-xs font-bold text-center bg-red-900/10 p-2 rounded-lg border border-red-500/20",children:E}),s.jsxs("button",{onClick:F,className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-bold py-3.5 rounded-xl transition-all shadow-lg shadow-red-900/20 active:scale-95 flex items-center justify-center gap-2",children:[s.jsxs("span",{children:[" (",c.length,")"]}),s.jsx(Ni,{className:"w-4 h-4"})]})]})]})}),s.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[s.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2 pb-2 border-b border-gray-700",children:[s.jsx(It,{className:"w-6 h-6 text-gray-500"}),"  ",s.jsx("span",{className:"text-xs bg-gray-800 text-gray-400 px-2 py-0.5 rounded-full border border-gray-700",children:I.length})]}),s.jsx("div",{className:"space-y-4",children:I.length===0?s.jsxs("div",{className:"text-center py-16 bg-gray-800/30 rounded-2xl border border-dashed border-gray-700",children:[s.jsx(Ni,{className:"w-16 h-16 mx-auto mb-4 text-gray-600 opacity-50"}),s.jsx("p",{className:"text-gray-500 font-medium",children:"   ."})]}):I.map(A=>{var V,Q;return s.jsxs("div",{className:"bg-gray-800 p-5 rounded-2xl border border-gray-700 shadow-sm hover:border-gray-600 transition-all group relative overflow-hidden",children:[s.jsxs("div",{className:"flex justify-between items-start mb-3 relative z-10",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`p-2.5 rounded-full ${A.targetRole==="driver"?"bg-blue-900/20 text-blue-400":A.targetRole==="merchant"?"bg-purple-900/20 text-purple-400":"bg-green-900/20 text-green-400"}`,children:s.jsx(_t,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-bold text-white flex items-center gap-2",children:[ne(A),s.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded border ${A.targetRole==="driver"?"bg-blue-500/10 border-blue-500/20 text-blue-300":A.targetRole==="merchant"?"bg-purple-500/10 border-purple-500/20 text-purple-300":"bg-green-500/10 border-green-500/20 text-green-300"}`,children:A.targetRole==="driver"?"":A.targetRole==="merchant"?"":""})]}),s.jsxs("p",{className:"text-xs text-gray-500 flex items-center mt-0.5",children:[s.jsx(It,{className:"w-3 h-3 ml-1"}),new Date(A.createdAt).toLocaleString("ar-EG-u-nu-latn")]})]})]}),r&&s.jsx("button",{onClick:()=>{H("deleteMessage"),$(A.id)},className:"text-gray-500 hover:text-red-400 p-2 hover:bg-red-500/10 rounded-lg transition-colors opacity-0 group-hover:opacity-100",title:" ",children:s.jsx(Tt,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-4 border border-gray-700/50 relative z-10",children:[A.image&&s.jsx("div",{className:"mb-3",children:s.jsx("img",{src:A.image,alt:"",className:"h-32 w-auto rounded-lg border border-gray-700 object-cover hover:scale-105 transition-transform cursor-pointer"})}),s.jsx("p",{className:"text-sm text-gray-200 leading-relaxed whitespace-pre-wrap font-medium",children:A.text})]}),s.jsx("div",{className:"mt-3 flex justify-end relative z-10",children:s.jsxs("span",{className:`text-xs font-bold flex items-center gap-1 bg-black/20 px-2 py-1 rounded-md border border-white/5 ${(V=A.readBy)!=null&&V.length?"text-green-400":"text-gray-500"}`,children:[s.jsx(Je,{className:"w-3.5 h-3.5"}),(Q=A.readBy)!=null&&Q.length?`   ${A.readBy.length}`:"   "]})})]},A.id)})})]})]}),L&&s.jsx(jn,{title:" ",message:"        ",onClose:G,onConfirm:M,confirmButtonText:" ",confirmVariant:"danger"})]})},f4=n=>{const e=new Date(n);return e.getHours()<6&&e.setDate(e.getDate()-1),e.setHours(0,0,0,0),e},See=({isOpen:n,onClose:e,orders:t,users:r,manualDailies:i=[]})=>{const o=w.useMemo(()=>{if(!n)return null;const c=f4(new Date),u=t.filter(H=>{const G=H.createdAt.seconds?new Date(H.createdAt.seconds*1e3):new Date(H.createdAt);return f4(G).getTime()===c.getTime()}),h=i.filter(H=>{const G=new Date(H.dayDate);return G.setHours(0,0,0,0),G.getTime()===c.getTime()}),m=u.filter(H=>H.status===ue.Delivered),p=u.filter(H=>H.status===ue.Cancelled),b=u.filter(H=>H.status===ue.Pending),v=m.reduce((H,G)=>H+(G.totalPrice||0),0);let _=m.reduce((H,G)=>H+(G.deliveryFee||0),0);const T=h.reduce((H,G)=>H+(G.amount||0),0),k=h.reduce((H,G)=>H+(G.totalDeliveryFees||0),0);_+=k;let E=0;const S={};m.forEach(H=>{const G=r.find(z=>(z==null?void 0:z.id)===H.driverId);if(G){let z=0;G.commissionType==="fixed"?z=G.commissionRate||0:z=(H.deliveryFee||0)*((G.commissionRate||0)/100),z>0&&(E+=z),S[G.id]||(S[G.id]={name:G.name,count:0,total:0}),S[G.id].count+=1,S[G.id].total+=H.deliveryFee||0}}),E+=T,h.forEach(H=>{const G=r.find(z=>(z==null?void 0:z.id)===H.driverId);G&&(S[G.id]||(S[G.id]={name:G.name,count:0,total:0}),S[G.id].count+=H.ordersCount||0)});const L=Object.values(S).sort((H,G)=>G.count-H.count).slice(0,5),$=E*.15;return{date:c,count:u.length+h.reduce((H,G)=>H+G.ordersCount,0),deliveredCount:m.length,cancelledCount:p.length,pendingCount:b.length,totalRevenue:v,totalDeliveryFees:_,totalCommission:E,adminShare:$,topDrivers:L,manualDailiesCount:h.length,manualDailiesAmount:T}},[n,t,r,i]);return!n||!o?null:s.jsx("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:s.jsxs("div",{className:"bg-[#0f172a] w-full max-w-3xl max-h-[90vh] rounded-3xl border border-gray-800 shadow-2xl overflow-hidden flex flex-col",onClick:c=>c.stopPropagation(),children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-800 bg-[#1e293b] flex justify-between items-center sticky top-0 z-10",children:[s.jsx("div",{children:s.jsxs("h2",{className:"text-xl font-black text-white flex items-center gap-2",children:[" ",s.jsx("span",{className:"text-[10px] bg-blue-600/20 text-blue-300 px-2 py-0.5 rounded border border-blue-500/20",children:o.date.toLocaleDateString("ar-EG",{weekday:"long",day:"numeric",month:"short"})})]})}),s.jsx("button",{onClick:e,className:"p-1.5 bg-gray-800 rounded-lg text-gray-400 hover:text-white transition-all",children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-5 space-y-6 custom-scrollbar",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[s.jsxs("div",{className:"bg-gray-800/40 p-3 rounded-xl border border-gray-700/50 flex flex-col items-center",children:[s.jsx("span",{className:"text-[10px] text-gray-500 font-bold mb-1",children:" ( )"}),s.jsx("span",{className:"text-2xl font-black text-white",children:o.count})]}),s.jsxs("div",{className:"bg-green-500/5 p-3 rounded-xl border border-green-500/10 flex flex-col items-center",children:[s.jsx("span",{className:"text-[10px] text-green-500/70 font-bold mb-1",children:""}),s.jsx("span",{className:"text-2xl font-black text-green-400",children:o.deliveredCount})]}),s.jsxs("div",{className:"bg-red-500/5 p-3 rounded-xl border border-red-500/10 flex flex-col items-center",children:[s.jsx("span",{className:"text-[10px] text-red-500/70 font-bold mb-1",children:""}),s.jsx("span",{className:"text-2xl font-black text-red-400",children:o.cancelledCount})]}),s.jsxs("div",{className:"bg-yellow-500/5 p-3 rounded-xl border border-yellow-500/10 flex flex-col items-center",children:[s.jsx("span",{className:"text-[10px] text-yellow-500/70 font-bold mb-1",children:""}),s.jsx("span",{className:"text-2xl font-black text-yellow-400",children:o.pendingCount})]})]}),s.jsx("div",{className:"bg-[#161f32] rounded-2xl p-5 border border-gray-800 relative overflow-hidden",children:s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-y-4 gap-x-8 relative z-10",children:[s.jsxs("div",{className:"flex justify-between items-center border-b border-gray-700/50 pb-2",children:[s.jsx("span",{className:"text-xs text-gray-400",children:" "}),s.jsxs("span",{className:"text-lg font-bold text-white",children:[o.totalRevenue.toLocaleString()," ",s.jsx("span",{className:"text-[10px] text-gray-600",children:"."})]})]}),s.jsxs("div",{className:"flex justify-between items-center border-b border-gray-700/50 pb-2",children:[s.jsx("span",{className:"text-xs text-gray-400",children:" "}),s.jsxs("span",{className:"text-lg font-bold text-blue-400",children:[o.totalDeliveryFees.toLocaleString()," ",s.jsx("span",{className:"text-[10px] text-gray-600",children:"."})]})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-400",children:"  ( )"}),s.jsxs("span",{className:"text-xl font-black text-green-400",children:[o.totalCommission.toLocaleString()," ",s.jsx("span",{className:"text-[10px] text-gray-600",children:"."})]})]}),o.manualDailiesAmount>0&&s.jsxs("div",{className:"flex justify-between items-center bg-yellow-900/10 -m-1 p-1 px-3 rounded-lg border border-yellow-500/10 mt-1",children:[s.jsx("span",{className:"text-xs text-yellow-500/70 font-bold",children:"  "}),s.jsxs("span",{className:"text-sm font-black text-yellow-500",children:[o.manualDailiesAmount.toLocaleString()," ",s.jsx("span",{className:"text-[10px]",children:"."})]})]}),s.jsxs("div",{className:"flex justify-between items-center bg-orange-900/10 -m-1 p-1 px-3 rounded-lg border border-orange-500/10 mt-2",children:[s.jsx("span",{className:"text-xs text-orange-400 font-bold",children:"  (15%)"}),s.jsxs("span",{className:"text-lg font-black text-orange-400",children:[o.adminShare.toLocaleString()," ",s.jsx("span",{className:"text-[10px]",children:"."})]})]})]})})]})]})})},Eee=({isOpen:n,onClose:e,type:t,users:r,onGenerate:i})=>{const[o,c]=w.useState(""),[u,h]=w.useState("all"),[m,p]=w.useState(""),[b,v]=w.useState(""),[_,T]=w.useState("");sn(()=>n?(e(),!0):!1,[n]);const k=w.useMemo(()=>r.filter(S=>{var L,$;return(S==null?void 0:S.role)===t&&(((L=S==null?void 0:S.name)==null?void 0:L.toLowerCase().includes(_.toLowerCase()))||(($=S==null?void 0:S.phone)==null?void 0:$.includes(_)))}),[r,t,_]);if(!n)return null;const E=()=>{o&&(i(o,{type:u,start:u==="custom"?m:void 0,end:u==="custom"?b:void 0}),e())};return s.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-2xl border border-gray-700 shadow-2xl overflow-hidden animate-pop-in flex flex-col max-h-[85vh]",onClick:S=>S.stopPropagation(),children:[s.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[t==="driver"?s.jsx(Zt,{className:"w-5 h-5 text-blue-400"}):s.jsx(Ar,{className:"w-5 h-5 text-purple-400"}),t==="driver"?"  ":"  "]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white p-1 rounded-full hover:bg-gray-800",children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto custom-scrollbar",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"text-xs font-bold text-gray-400 block",children:[" ",t==="driver"?"":""]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"   ...",value:_,onChange:S=>T(S.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-3 px-4 pl-10 text-white text-sm focus:border-blue-500 outline-none"}),s.jsx(mr,{className:"absolute left-3 top-3.5 w-4 h-4 text-gray-500"})]}),s.jsx("div",{className:"max-h-40 overflow-y-auto bg-[#0f172a] border border-gray-600 rounded-xl custom-scrollbar",children:k.length>0?k.map(S=>s.jsxs("button",{onClick:()=>c(S.id),className:`w-full flex items-center justify-between p-3 text-right hover:bg-gray-800 border-b border-gray-700/50 last:border-0 transition-colors ${o===S.id?"bg-blue-900/20 text-blue-400":"text-gray-300"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden",children:S.storeImage?s.jsx("img",{src:S.storeImage,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-4 h-4"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-bold",children:S.name}),s.jsx("p",{className:"text-[10px] opacity-70 font-mono",children:S.phone})]})]}),o===S.id&&s.jsx(Je,{className:"w-4 h-4"})]},S.id)):s.jsx("p",{className:"p-4 text-center text-xs text-gray-500",children:"  "})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-xs font-bold text-gray-400 block",children:" "}),s.jsxs("div",{className:"flex bg-[#0f172a] p-1 rounded-xl border border-gray-600",children:[s.jsx("button",{onClick:()=>h("all"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${u==="all"?"bg-blue-600 text-white shadow-md":"text-gray-400 hover:text-white"}`,children:"  "}),s.jsx("button",{onClick:()=>h("custom"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${u==="custom"?"bg-blue-600 text-white shadow-md":"text-gray-400 hover:text-white"}`,children:" "})]}),u==="custom"&&s.jsxs("div",{className:"grid grid-cols-2 gap-3 animate-fadeIn",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] text-gray-500 mb-1 block",children:""}),s.jsx("input",{type:"date",value:m,onChange:S=>p(S.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-lg py-2 px-3 text-white text-xs outline-none focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] text-gray-500 mb-1 block",children:""}),s.jsx("input",{type:"date",value:b,onChange:S=>v(S.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-lg py-2 px-3 text-white text-xs outline-none focus:border-blue-500"})]})]})]})]}),s.jsx("div",{className:"p-5 border-t border-gray-700 bg-[#151e2d]",children:s.jsxs("button",{onClick:E,disabled:!o||u==="custom"&&(!m||!b),className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:text-gray-500 text-white font-bold py-3.5 rounded-xl shadow-lg transition-all active:scale-95 flex items-center justify-center gap-2",children:[s.jsx(dr,{className:"w-5 h-5"})," "]})})]})})},Tee=({isOpen:n,onClose:e,reportData:t})=>{if(sn(()=>n?(e(),!0):!1,[n]),!n||!t)return null;const{user:r,orders:i,summary:o,dateLabel:c}=t,u=(r==null?void 0:r.role)==="driver",h=m=>{if(!m)return"---";try{let p;return m.seconds?p=new Date(m.seconds*1e3):p=new Date(m),isNaN(p.getTime())?"---":p.toLocaleString("ar-EG-u-nu-latn",{month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0})}catch{return"---"}};return s.jsx("div",{className:"fixed inset-0 z-[100] bg-black/90 backdrop-blur-sm flex items-center justify-center p-0 sm:p-4 animate-fadeIn",onClick:e,children:s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-2xl h-full sm:h-auto sm:max-h-[90vh] sm:rounded-2xl border-x-0 sm:border border-gray-700 shadow-2xl overflow-hidden animate-slide-up flex flex-col",onClick:m=>m.stopPropagation(),children:[s.jsxs("div",{className:"p-5 border-b border-gray-700 bg-[#151e2d] flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-black text-white flex items-center gap-2",children:[r.name,s.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded border ${u?"bg-blue-500/10 text-blue-400 border-blue-500/20":"bg-purple-500/10 text-purple-400 border-purple-500/20"}`,children:u?"":""})]}),s.jsxs("p",{className:"text-xs text-gray-400 mt-1 flex items-center gap-1",children:[s.jsx(ei,{className:"w-3 h-3"}),c]})]}),s.jsx("button",{onClick:e,className:"bg-gray-800 p-2 rounded-full text-gray-400 hover:text-white transition-colors",children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-5 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[s.jsxs("div",{className:"bg-gray-800 p-3 rounded-xl border border-gray-700 text-center",children:[s.jsx("p",{className:"text-[10px] text-gray-500 font-bold mb-1",children:" "}),s.jsx("p",{className:"text-xl font-black text-white",children:o.count})]}),s.jsxs("div",{className:"bg-gray-800 p-3 rounded-xl border border-gray-700 text-center",children:[s.jsx("p",{className:"text-[10px] text-gray-500 font-bold mb-1",children:" "}),s.jsxs("p",{className:"text-xl font-black text-green-400",children:[o.totalRevenue.toLocaleString("en-US")," ",s.jsx("span",{className:"text-[10px]",children:"."})]})]}),s.jsxs("div",{className:"bg-gray-800 p-3 rounded-xl border border-gray-700 text-center",children:[s.jsx("p",{className:"text-[10px] text-gray-500 font-bold mb-1",children:" "}),s.jsxs("p",{className:"text-xl font-black text-blue-400",children:[o.totalDelivery.toLocaleString("en-US")," ",s.jsx("span",{className:"text-[10px]",children:"."})]})]}),s.jsxs("div",{className:"bg-gray-800 p-3 rounded-xl border border-gray-700 text-center",children:[s.jsx("p",{className:"text-[10px] text-gray-500 font-bold mb-1",children:u?" ":" "}),s.jsxs("p",{className:`text-xl font-black ${u?"text-yellow-400":"text-red-400"}`,children:[u?o.driverEarnings.toLocaleString("en-US"):o.appCommission.toLocaleString("en-US")," ",s.jsx("span",{className:"text-[10px]",children:"."})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("h4",{className:"text-sm font-bold text-white flex items-center gap-2",children:[s.jsx(dr,{className:"w-4 h-4 text-gray-400"})," "]}),i.length>0?i.map(m=>{var p,b,v;return s.jsxs("div",{className:"bg-[#252525] p-4 rounded-2xl border border-white/5 flex flex-col gap-3 shadow-md hover:border-white/10 transition-all",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"font-mono text-sm text-blue-400 font-black bg-blue-900/10 px-2 py-0.5 rounded border border-blue-500/20",children:["#",m.id]}),s.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full font-bold ${m.status===ue.Delivered?"bg-green-500/10 text-green-400":m.status===ue.Cancelled?"bg-red-500/10 text-red-400":"bg-yellow-500/10 text-yellow-400"}`,children:m.status})]}),s.jsxs("div",{className:"flex flex-col items-end",children:[s.jsx("p",{className:"text-xs text-gray-400",children:" "}),s.jsxs("p",{className:"text-sm font-bold text-white",children:[(p=m.totalPrice)==null?void 0:p.toLocaleString("en-US")," ."]})]})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(fs,{className:"w-4 h-4 text-gray-500 mt-0.5 flex-shrink-0"}),s.jsx("p",{className:"text-xs text-gray-300 leading-relaxed",children:u?` : ${m.merchantName}`:` : ${(b=m.customer)==null?void 0:b.address}`})]}),s.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-gray-700 mt-1 bg-black/20 -mx-4 -mb-4 px-4 py-3 rounded-b-2xl",children:[s.jsxs("div",{className:"flex items-center gap-1.5 text-gray-400 text-[10px]",children:[s.jsx(It,{className:"w-3 h-3"}),s.jsx("span",{className:"dir-ltr",children:h(m.deliveredAt||m.createdAt)})]}),u&&s.jsxs("div",{className:"flex items-center gap-2 bg-green-900/20 px-3 py-1 rounded-lg border border-green-500/20",children:[s.jsx("span",{className:"text-[10px] text-green-300 font-bold",children:" :"}),s.jsxs("span",{className:"text-sm font-black text-green-400",children:[((v=m.deliveryFee)==null?void 0:v.toLocaleString("en-US"))||0," ."]})]})]})]},m.id)}):s.jsx("div",{className:"text-center py-10 text-gray-500 bg-gray-800/30 rounded-xl border border-dashed border-gray-700",children:"     "})]})]})]})})},E_=({title:n,value:e,subValue:t,icon:r,color:i,trend:o,trendValue:c})=>s.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-2xl border border-gray-700/50 flex flex-col justify-between relative overflow-hidden group hover:border-gray-600 transition-all",children:[s.jsx("div",{className:`absolute top-0 right-0 w-24 h-24 ${i} opacity-5 blur-2xl rounded-full -mr-10 -mt-10 transition-all group-hover:opacity-10`}),s.jsxs("div",{className:"flex justify-between items-start mb-4 relative z-10",children:[s.jsx("div",{className:`p-3 ${i.replace("bg-","bg-").replace("500","500/10")} rounded-xl text-${i.replace("bg-","").replace("500","400")}`,children:r}),o&&s.jsxs("div",{className:`flex items-center gap-1 text-xs font-bold px-2 py-1 rounded-lg ${o==="up"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:[o==="up"?s.jsx(bO,{className:"w-3 h-3"}):s.jsx(EZ,{className:"w-3 h-3"}),s.jsx("span",{children:c})]})]}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-1",children:e}),s.jsx("p",{className:"text-xs text-gray-400 font-medium mb-1",children:n}),s.jsx("p",{className:"text-[10px] text-gray-500",children:t})]})]}),Zp=n=>n.toLocaleString("en-US",{maximumFractionDigits:1}),IO=({orders:n,users:e,payments:t,currentUser:r,manualDailies:i=[]})=>{const o=w.useMemo(()=>n.filter(ne=>!ne.isArchived),[n]),[c,u]=w.useState(!1),[h,m]=w.useState("driver"),[p,b]=w.useState(!1),[v,_]=w.useState(null),[T,k]=w.useState(!1),[E,S]=w.useState(!1),[L,$]=w.useState(!1),[H,G]=w.useState(!1),[z,P]=w.useState([]),[j,O]=w.useState(null);w.useEffect(()=>{if(H){const ne=Ir("monthly_reports",U=>{const A=U.sort((V,Q)=>Q.createdAt.getTime()-V.createdAt.getTime());P(A)});return()=>ne()}},[H]);const I=async()=>{S(!0);try{const ne=new Date,A=`${["","","","","","","","","","","",""][ne.getMonth()]} ${ne.getFullYear()}`,V=[...o];if(V.length===0){alert("   ."),S(!1),$(!1);return}const Q=V.filter(J=>J.id.startsWith("ORD-")),ae=V.filter(J=>J.id.startsWith("S-")),X=(J,le)=>{const ee=J.reduce((we,pe)=>{const ye=pe.id.replace(le,""),Ae=parseInt(ye||"0");return Math.max(we,Ae)},0);return ee>0?`${le}${ee}`:`${le}0`},B=X(Q,"ORD-"),Y=X(ae,"S-"),ge=[...i],Z=V.filter(J=>J.status===ue.Delivered),te=V.filter(J=>J.status===ue.Cancelled);let me=0,re=0,ce=0;const he={};Z.forEach(J=>{const le=e.find(we=>we.id===J.driverId);me+=J.totalPrice||0,re+=J.deliveryFee||0;let ee=0;if(le&&(le.commissionType==="fixed"?ee=le.commissionRate||0:ee=(J.deliveryFee||0)*((le.commissionRate||0)/100)),ee>0&&(ce+=ee),le&&!he[le.id]){const we=Z.filter(xe=>xe.driverId===le.id&&!xe.reconciled),pe=we.reduce((xe,Pe)=>xe+(Pe.deliveryFee||0),0);let ye=0;we.forEach(xe=>{le.commissionType==="fixed"?ye+=le.commissionRate||0:ye+=(xe.deliveryFee||0)*((le.commissionRate||0)/100)});const Ae=pe-ye;he[le.id]={name:le.name,role:"driver",balance:Ae,ordersCount:we.length}}});const Oe=ge.reduce((J,le)=>J+(le.totalDeliveryFees||0),0),Ue=ge.reduce((J,le)=>J+(le.amount||0),0);re+=Oe,ce+=Ue;const st={id:`ARCHIVE_${ne.getTime()}`,month:ne.getMonth(),year:ne.getFullYear(),monthLabel:A,totalRevenue:me,totalDeliveryFees:re,totalAppProfit:ce,adminShare:ce*.15,totalDriverPayouts:re-ce,createdAt:ne,archivedOrdersCount:V.length,deliveredOrdersCount:Z.length,cancelledOrdersCount:te.length,lastRegularOrderId:B,lastShoppingOrderId:Y,walletSnapshots:he,archivedBy:r.id};await qj("monthly_reports",st);const fe=V.map(J=>({id:J.id,isArchived:!0,archiveMonth:A}));await gi("orders",fe);const ie=t.filter(J=>{var le;return!((le=J.reconciledOrderIds)!=null&&le.includes("ARCHIVED"))}).map(J=>({id:J.id,reconciledOrderIds:["ARCHIVED"]}));await gi("payments",ie),$(!1),window.location.reload()}catch(ne){console.error("Archive Failed:",ne),alert("   ")}finally{S(!1)}},R=w.useMemo(()=>{const ne=o.filter(re=>re.status===ue.Delivered),U=ne.reduce((re,ce)=>re+(ce.totalPrice||0),0),A=ne.reduce((re,ce)=>re+(ce.deliveryFee||0),0);let V=0;ne.forEach(re=>{const ce=e.find(he=>(he==null?void 0:he.id)===re.driverId);if(ce){let he=0;ce.commissionType==="fixed"?he=ce.commissionRate||0:he=(re.deliveryFee||0)*((ce.commissionRate||0)/100),he>0&&(V+=he)}});const Q=i.reduce((re,ce)=>re+(ce.amount||0),0);V+=Q;const ae=new Date,X=ae.getMonth(),B=ae.getFullYear(),Y=ne.filter(re=>{var he;const ce=(he=re.deliveredAt)!=null&&he.seconds?new Date(re.deliveredAt.seconds*1e3):new Date(re.deliveredAt||re.createdAt);return ce.getMonth()===X&&ce.getFullYear()===B}),ge=Y.reduce((re,ce)=>re+(ce.totalPrice||0),0);let Z=0;Y.forEach(re=>{const ce=e.find(he=>(he==null?void 0:he.id)===re.driverId);if(ce){let he=0;ce.commissionType==="fixed"?he=ce.commissionRate||0:he=(re.deliveryFee||0)*((ce.commissionRate||0)/100),he>0&&(Z+=he)}});const me=i.filter(re=>{const ce=new Date(re.dayDate);return ce.getMonth()===X&&ce.getFullYear()===B}).reduce((re,ce)=>re+(ce.amount||0),0);return Z+=me,{orderCount:o.length+i.reduce((re,ce)=>re+ce.ordersCount,0),deliveredCount:ne.length,cancelledCount:o.filter(re=>re.status===ue.Cancelled).length,pendingCount:o.filter(re=>re.status===ue.Pending).length,totalRevenue:U,totalDeliveryFees:A,totalCommission:V,merchantsCount:e.filter(re=>(re==null?void 0:re.role)==="merchant").length,driversCount:e.filter(re=>(re==null?void 0:re.role)==="driver").length,monthlyRevenue:ge,monthlyCommission:Z,commission15PercentTotal:V*.15,commission15PercentMonthly:Z*.15}},[o,e,i]),F=ne=>{m(ne),u(!0)},M=(ne,U)=>{const A=e.find(ce=>(ce==null?void 0:ce.id)===ne);if(!A)return;let V=o.filter(ce=>A.role==="driver"?ce.driverId===ne:ce.merchantId===ne),Q=[];A.role==="driver"&&(Q=i.filter(ce=>ce.driverId===ne));let ae="  ";if(U.type==="custom"&&U.start&&U.end){const ce=new Date(U.start),he=new Date(U.end);he.setHours(23,59,59),V=V.filter(Oe=>{const Ue=new Date(Oe.createdAt);return Ue>=ce&&Ue<=he}),Q=Q.filter(Oe=>{const Ue=new Date(Oe.dayDate);return Ue>=ce&&Ue<=he}),ae=` ${U.start}  ${U.end}`}const X=V.filter(ce=>ce.status===ue.Delivered),B=X.reduce((ce,he)=>ce+(he.totalPrice||0),0);let Y=X.reduce((ce,he)=>ce+(he.deliveryFee||0),0);const ge=Q.reduce((ce,he)=>ce+(he.totalDeliveryFees||0),0);Y+=ge;let Z=0,te=0;if(A.role==="driver"){A.commissionType==="fixed"?Z=X.reduce((he,Oe)=>{let Ue=0;return A.commissionType==="fixed"?Ue=A.commissionRate||0:Ue=(Oe.deliveryFee||0)*((A.commissionRate||0)/100),he+Ue},0):Z=X.reduce((he,Oe)=>{const Ue=(Oe.deliveryFee||0)*((A.commissionRate||0)/100);return he+Ue},0);const ce=Q.reduce((he,Oe)=>he+(Oe.amount||0),0);Z+=ce,te=Y-Z}const me=Q.map(ce=>({id:"DAILY-"+ce.id.slice(-6),status:ue.Delivered,totalPrice:0,deliveryFee:ce.totalDeliveryFees||0,createdAt:new Date(ce.dayDate),merchantName:"",customer:{address:`${ce.ordersCount} `},type:"manual_daily",actualAmount:ce.amount})),re=[...V,...me].sort((ce,he)=>{const Oe=ce.createdAt.seconds?ce.createdAt.seconds:new Date(ce.createdAt).getTime();return(he.createdAt.seconds?he.createdAt.seconds:new Date(he.createdAt).getTime())-Oe});_({user:A,orders:re,summary:{count:X.length+Q.reduce((ce,he)=>ce+he.ordersCount,0),totalRevenue:B,totalDelivery:Y,appCommission:Z,driverEarnings:te},dateLabel:ae}),b(!0)};return s.jsxs("div",{className:"space-y-8 pb-32 animate-fadeIn relative",children:[s.jsxs("div",{className:"flex flex-col gap-6 border-b border-gray-700 pb-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"p-4 bg-red-600 rounded-2xl shadow-xl shadow-red-900/20",children:s.jsx(d0,{className:"w-8 h-8 text-white"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-black text-white tracking-tight",children:" "}),s.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"    "})]})]}),s.jsxs("div",{className:"flex gap-3 flex-wrap",children:[r.role==="admin"&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>$(!0),className:"flex-1 bg-red-900/40 hover:bg-red-900/60 border border-red-800 rounded-xl p-3 flex items-center justify-center gap-2 transition-all active:scale-95 group shadow-lg shadow-red-900/20",children:[s.jsx("div",{className:"p-2 bg-red-500/20 rounded-full group-hover:bg-red-500/30",children:s.jsx(Tt,{className:"w-5 h-5 text-red-400"})}),s.jsx("span",{className:"text-sm font-bold text-white",children:"  "})]}),s.jsxs("button",{onClick:()=>G(!0),className:"flex-1 bg-gray-800 hover:bg-gray-700 border border-gray-700 rounded-xl p-3 flex items-center justify-center gap-2 transition-all active:scale-95 group",children:[s.jsx("div",{className:"p-2 bg-gray-700/50 rounded-full group-hover:bg-gray-600",children:s.jsx(It,{className:"w-5 h-5 text-gray-300"})}),s.jsx("span",{className:"text-sm font-bold text-gray-200",children:" "})]}),s.jsxs("button",{onClick:()=>k(!0),className:"flex-1 bg-gradient-to-r from-blue-900 to-blue-800 hover:from-blue-800 hover:to-blue-700 border border-blue-700 rounded-xl p-3 flex items-center justify-center gap-2 transition-all active:scale-95 group shadow-lg shadow-blue-900/30",children:[s.jsx("div",{className:"p-2 bg-blue-500/20 rounded-full group-hover:bg-blue-500/30",children:s.jsx(dr,{className:"w-5 h-5 text-blue-200"})}),s.jsx("span",{className:"text-sm font-bold text-white",children:"  "})]})]}),s.jsxs("button",{onClick:()=>F("driver"),className:"flex-1 bg-gray-800 hover:bg-gray-700 border border-gray-700 rounded-xl p-3 flex items-center justify-center gap-2 transition-all active:scale-95 group",children:[s.jsx("div",{className:"p-2 bg-blue-500/10 rounded-full group-hover:bg-blue-500/20",children:s.jsx(Zt,{className:"w-5 h-5 text-blue-400"})}),s.jsx("span",{className:"text-sm font-bold text-gray-200",children:" "})]}),s.jsxs("button",{onClick:()=>F("merchant"),className:"flex-1 bg-gray-800 hover:bg-gray-700 border border-gray-700 rounded-xl p-3 flex items-center justify-center gap-2 transition-all active:scale-95 group",children:[s.jsx("div",{className:"p-2 bg-purple-500/10 rounded-full group-hover:bg-purple-500/20",children:s.jsx(Ar,{className:"w-5 h-5 text-purple-400"})}),s.jsx("span",{className:"text-sm font-bold text-gray-200",children:" "})]})]})]}),r.role==="admin"&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[s.jsx(E_,{title:" ",value:`${R.totalRevenue.toLocaleString("en-US")} .`,subValue:"    ",icon:s.jsx(Ed,{className:"w-6 h-6"}),color:"bg-green-500",trend:"up",trendValue:"+12%"}),s.jsx(E_,{title:" ",value:`${R.totalDeliveryFees.toLocaleString("en-US")} .`,subValue:"   ",icon:s.jsx(Zt,{className:"w-6 h-6"}),color:"bg-blue-500"}),s.jsx(E_,{title:" ",value:`${R.totalCommission.toLocaleString("en-US")} .`,subValue:"    ",icon:s.jsx(bO,{className:"w-6 h-6"}),color:"bg-red-500",trend:"up",trendValue:"+5%"})]}),r.role==="admin"&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsx("div",{className:"bg-gradient-to-br from-purple-900/50 to-purple-800/30 p-5 rounded-2xl border border-purple-500/30 relative overflow-hidden",children:s.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[s.jsx("div",{className:"p-3 bg-purple-500/20 rounded-xl text-purple-300",children:s.jsx(ei,{className:"w-6 h-6"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-purple-200 font-bold mb-1",children:"   "}),s.jsxs("h3",{className:"text-2xl font-black text-white",children:[R.totalCommission.toLocaleString("en-US")," ",s.jsx("span",{className:"text-sm font-normal text-purple-300",children:"."})]})]})]})}),s.jsx("div",{className:"bg-gradient-to-br from-orange-900/50 to-orange-800/30 p-5 rounded-2xl border border-orange-500/30 relative overflow-hidden",children:s.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[s.jsx("div",{className:"p-3 bg-orange-500/20 rounded-xl text-orange-300",children:s.jsx(Ay,{className:"w-6 h-6"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-orange-200 font-bold mb-1",children:"  ( )"}),s.jsxs("h3",{className:"text-2xl font-black text-white",children:[R.commission15PercentTotal.toLocaleString("en-US")," ",s.jsx("span",{className:"text-sm font-normal text-orange-300",children:"."})]})]})]})})]}),s.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-2xl border border-gray-700 flex flex-col items-center text-center",children:[s.jsx(Je,{className:"w-8 h-8 text-green-500 mb-2"}),s.jsx("span",{className:"text-2xl font-black text-white",children:R.deliveredCount}),s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase",children:" "})]}),s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-2xl border border-gray-700 flex flex-col items-center text-center",children:[s.jsx(It,{className:"w-8 h-8 text-yellow-500 mb-2"}),s.jsx("span",{className:"text-2xl font-black text-white",children:R.pendingCount}),s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase",children:" "})]}),s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-2xl border border-gray-700 flex flex-col items-center text-center",children:[s.jsx(ut,{className:"w-8 h-8 text-red-500 mb-2"}),s.jsx("span",{className:"text-2xl font-black text-white",children:R.cancelledCount}),s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase",children:" "})]}),s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-2xl border border-gray-700 flex flex-col items-center text-center",children:[s.jsx(Md,{className:"w-8 h-8 text-purple-500 mb-2"}),s.jsx("span",{className:"text-2xl font-black text-white",children:e.length}),s.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase",children:" "})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"bg-gray-800 p-6 rounded-3xl border border-gray-700 shadow-xl",children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2",children:[s.jsx(Ar,{className:"w-5 h-5 text-purple-400"})," "]}),s.jsx("div",{className:"space-y-4",children:["restaurant","market","pharmacy"].map(ne=>{const U=e.filter(V=>(V==null?void 0:V.role)==="merchant"&&V.storeCategory===ne).length,A=R.merchantsCount>0?U/R.merchantsCount*100:0;return s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-400",children:[s.jsx("span",{children:ne==="restaurant"?"":ne==="market"?" ":""}),s.jsx("span",{className:"text-white",children:U})]}),s.jsx("div",{className:"h-2 bg-gray-900 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-purple-600 transition-all duration-1000",style:{width:`${A}%`}})})]},ne)})})]}),s.jsxs("div",{className:"bg-gray-800 p-6 rounded-3xl border border-gray-700 shadow-xl",children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2",children:[s.jsx(Zt,{className:"w-5 h-5 text-blue-400"})," "]}),s.jsxs("div",{className:"flex flex-col justify-center h-full",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 rounded-2xl mb-3 border border-white/5",children:[s.jsx("span",{className:"text-sm text-gray-400 font-bold",children:"  "}),s.jsx("span",{className:"text-xl font-black text-blue-400",children:R.deliveredCount>0?(R.deliveredCount/Math.max(R.driversCount,1)).toFixed(1):0})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 rounded-2xl border border-white/5",children:[s.jsx("span",{className:"text-sm text-gray-400 font-bold",children:"  "}),s.jsxs("span",{className:"text-xl font-black text-green-400",children:[R.orderCount>0?(R.deliveredCount/R.orderCount*100).toFixed(0):0,"%"]})]})]})]})]}),s.jsx(Eee,{isOpen:c,onClose:()=>u(!1),type:h,users:e,onGenerate:M}),s.jsx(Tee,{isOpen:p,onClose:()=>b(!1),reportData:v}),L&&s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:()=>!E&&$(!1)}),s.jsx("div",{className:"bg-[#1a1a1a] rounded-3xl w-full max-w-md p-6 border border-red-500/30 relative z-10 animate-scaleIn shadow-2xl shadow-red-900/20",children:s.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[s.jsx("div",{className:"p-4 bg-red-500/10 rounded-full animate-pulse",children:s.jsx(vO,{className:"w-12 h-12 text-red-500"})}),s.jsx("h3",{className:"text-2xl font-black text-white",children:"     "}),s.jsxs("p",{className:"text-gray-400 font-medium leading-relaxed",children:["   ",s.jsx("span",{className:"text-red-400 font-bold",children:"   "}),"     .",s.jsx("br",{}),"           ."]}),s.jsxs("div",{className:"w-full bg-red-900/20 border border-red-900/50 rounded-xl p-4 mt-2",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2 text-red-200 text-sm font-bold",children:[s.jsx("span",{children:"  "}),s.jsxs("span",{children:[R.totalCommission.toLocaleString("en-US")," ."]})]}),s.jsxs("div",{className:"flex justify-between items-center text-red-200 text-sm font-bold",children:[s.jsx("span",{children:"  (15%)"}),s.jsxs("span",{children:[R.commission15PercentTotal.toLocaleString("en-US")," ."]})]})]}),s.jsxs("div",{className:"flex w-full gap-3 mt-4",children:[s.jsx("button",{onClick:I,disabled:E,className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-3 rounded-xl transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:E?" ...":"    "}),s.jsx("button",{onClick:()=>$(!1),disabled:E,className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 rounded-xl transition-all",children:""})]})]})})]}),H&&s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md",onClick:()=>G(!1)}),s.jsxs("div",{className:"bg-[#121212] rounded-3xl w-full max-w-4xl max-h-[85vh] flex flex-col border border-gray-800 relative z-10 animate-scaleIn",children:[s.jsxs("div",{className:"p-6 border-b border-gray-800 flex justify-between items-center bg-[#1a1a1a] rounded-t-3xl",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-2xl font-black text-white flex items-center gap-3",children:[s.jsx(It,{className:"w-8 h-8 text-blue-500"}),"  "]}),s.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"     "})]}),s.jsx("button",{onClick:()=>G(!1),className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:s.jsx(ut,{className:"w-6 h-6 text-gray-400"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6 scrollbar-hide",children:s.jsx("div",{className:"grid gap-4",children:z.length===0?s.jsx("div",{className:"text-center py-20 text-gray-500",children:s.jsx("p",{children:"     "})}):z.map(ne=>s.jsxs("div",{className:"bg-[#1a1a1a] border border-gray-800 p-5 rounded-2xl hover:border-gray-600 transition-colors group",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"p-3 bg-blue-500/10 rounded-xl",children:s.jsx(ei,{className:"w-6 h-6 text-blue-400"})}),s.jsxs("div",{children:[s.jsxs("h4",{className:"text-lg font-bold text-white",children:["  ",ne.month+1," / ",ne.year]}),s.jsxs("p",{className:"text-xs text-gray-500",children:["   ",new Date(ne.createdAt).toLocaleDateString("ar-EG")]})]})]}),s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-500/10 rounded-full border border-green-500/20",children:[s.jsx("span",{className:"text-xs text-green-400 font-bold",children:""}),s.jsx(Je,{className:"w-4 h-4 text-green-500"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-black/40 p-3 rounded-xl border border-white/5",children:[s.jsx("p",{className:"text-xs text-gray-400 mb-1",children:" "}),s.jsx("p",{className:"text-lg font-bold text-white",children:Zp(ne.totalRevenue)})]}),s.jsxs("div",{className:"bg-black/40 p-3 rounded-xl border border-white/5",children:[s.jsx("p",{className:"text-xs text-gray-400 mb-1",children:" "}),s.jsx("p",{className:"text-lg font-bold text-blue-400",children:Zp(ne.totalDeliveryFees)})]}),s.jsxs("div",{className:"bg-black/40 p-3 rounded-xl border border-white/5",children:[s.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"  "}),s.jsx("p",{className:"text-lg font-bold text-green-400",children:Zp(ne.totalAppProfit)})]}),s.jsxs("div",{className:"bg-black/40 p-3 rounded-xl border border-white/5",children:[s.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"  (15%)"}),s.jsx("p",{className:"text-lg font-bold text-orange-400",children:Zp(ne.totalAppProfit*.15)})]})]})]},ne.id))})})]})]}),s.jsx(See,{isOpen:T,onClose:()=>k(!1),orders:o,users:e,manualDailies:i})]})},Iee=({title:n,message:e,placeholder:t="",defaultValue:r="",inputType:i="text",onClose:o,onConfirm:c,confirmButtonText:u="",cancelButtonText:h=""})=>{const[m,p]=w.useState(!1),[b,v]=w.useState(r),_=w.useRef(null);w.useEffect(()=>{requestAnimationFrame(()=>p(!0)),setTimeout(()=>{var S,L;(S=_.current)==null||S.focus(),r&&((L=_.current)==null||L.select())},100)},[]),sn(()=>(T(),!0));const T=()=>{p(!1),setTimeout(o,200)},k=()=>{b.trim()&&(p(!1),setTimeout(()=>c(b),200))},E=S=>{S.key==="Enter"&&k(),S.key==="Escape"&&T()};return Jh.createPortal(s.jsx("div",{className:`fixed inset-0 z-[110] flex items-center justify-center p-4 transition-all duration-300 ease-out ${m?"backdrop-blur-[2px] bg-black/60":"opacity-0 pointer-events-none"}`,onClick:T,style:{touchAction:"none"},children:s.jsxs("div",{className:`
            w-full max-w-sm bg-[#1e293b] rounded-2xl border border-gray-700/50 shadow-2xl 
            transform transition-all duration-300 ease-[cubic-bezier(0.34,1.56,0.64,1)] relative overflow-hidden
            ${m?"scale-100 translate-y-0 opacity-100":"scale-90 translate-y-10 opacity-0"}
        `,onClick:S=>S.stopPropagation(),children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-blue-500"}),s.jsxs("div",{className:"p-6",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-2 text-center",children:n}),s.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-6 text-center",children:e}),s.jsx("div",{className:"relative mb-6",children:s.jsx("input",{ref:_,type:i,value:b,onChange:S=>v(S.target.value),onKeyDown:E,placeholder:t,className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-3 px-4 text-white text-center focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition-all font-mono text-lg",dir:"ltr"})}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{type:"button",onClick:k,className:"flex-1 py-3 px-4 rounded-xl bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white font-bold text-sm shadow-lg shadow-blue-900/30 transform transition-transform active:scale-95",children:u}),s.jsx("button",{type:"button",onClick:T,className:"flex-1 py-3 px-4 rounded-xl bg-gray-700/50 hover:bg-gray-700 text-gray-300 font-bold text-sm border border-gray-600/50 transition-colors active:scale-95",children:h})]})]})]})}),document.body)},Gm="2.0.31",Cee=({isOpen:n,onClose:e,title:t,message:r,onConfirm:i,confirmText:o="",cancelText:c="",type:u="danger"})=>n?s.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fadeIn",children:s.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-2xl w-full max-w-sm p-6 shadow-2xl animate-scaleIn",children:s.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[s.jsx("div",{className:`w-14 h-14 rounded-full flex items-center justify-center ${u==="danger"?"bg-red-500/10 text-red-500":"bg-blue-500/10 text-blue-500"}`,children:u==="danger"?s.jsx(Tt,{className:"w-7 h-7"}):s.jsx(Jl,{className:"w-7 h-7"})}),s.jsx("h3",{className:"text-xl font-bold text-white tracking-wide",children:t}),s.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:r}),s.jsxs("div",{className:"flex gap-3 w-full mt-4",children:[s.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 rounded-xl border border-gray-600 text-gray-400 hover:bg-gray-700 transition-colors font-bold text-sm",children:c}),s.jsx("button",{onClick:()=>{i(),e()},className:`flex-1 px-4 py-3 rounded-xl font-bold text-white shadow-lg transition-transform active:scale-95 text-sm ${u==="danger"?"bg-red-600 hover:bg-red-500 shadow-red-500/20":"bg-blue-600 hover:bg-blue-500 shadow-blue-500/20"}`,children:o})]})]})})}):null,ex=({active:n,label:e,icon:t,onClick:r,danger:i})=>s.jsxs("button",{onClick:r,className:`flex items-center gap-2 px-4 py-2.5 rounded-xl transition-all duration-300 font-bold text-xs whitespace-nowrap ${n?i?"bg-red-500/20 text-red-400 border border-red-500/30":"bg-gray-700 text-white border border-gray-600 shadow-sm":"text-gray-500 hover:text-gray-300 hover:bg-gray-800/50"}`,children:[s.jsx(t,{className:`w-4 h-4 ${n?i?"text-red-400":"text-white":"text-gray-500"}`}),s.jsx("span",{children:e})]}),m4=({onClick:n,label:e,icon:t,variant:r="primary",loading:i=!1,disabled:o=!1,className:c=""})=>{const u={primary:"bg-red-600 hover:bg-red-500 border-red-500/50 text-white shadow-red-900/20",danger:"bg-red-900/20 hover:bg-red-900/30 border-red-500/30 text-red-500 hover:text-red-400",secondary:"bg-gray-700 hover:bg-gray-600 border-gray-600 text-gray-200",success:"bg-emerald-600 hover:bg-emerald-500 border-emerald-500/50 text-white shadow-emerald-900/20"};return s.jsxs("button",{onClick:n,disabled:o||i,className:`flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl border text-xs font-bold transition-all active:scale-[0.98] shadow-lg disabled:opacity-50 disabled:cursor-not-allowed ${u[r]} ${c}`,children:[i?s.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):t&&s.jsx(t,{className:"w-4 h-4"}),s.jsx("span",{children:e})]})},Aee=({message:n,type:e,onClose:t})=>(w.useEffect(()=>{const r=setTimeout(t,4e3);return()=>clearTimeout(r)},[t]),s.jsxs("div",{className:`fixed bottom-6 left-1/2 -translate-x-1/2 z-[200] flex items-center gap-3 px-6 py-3 rounded-full border backdrop-blur-xl shadow-2xl animate-slide-up ${e==="success"?"bg-emerald-900/90 border-emerald-500/30 text-emerald-100":e==="error"?"bg-red-900/90 border-red-500/30 text-red-100":"bg-blue-900/90 border-blue-500/30 text-blue-100"}`,children:[e==="success"?s.jsx(Je,{className:"w-5 h-5"}):e==="error"?s.jsx(ut,{className:"w-5 h-5"}):s.jsx(Jl,{className:"w-5 h-5"}),s.jsx("span",{className:"text-sm font-medium",children:n})]})),kee=({currentUser:n,onSuccess:e,onDisconnect:t,appConfig:r,onUpdateAppConfig:i,orders:o=[],users:c=[],editOrder:u,onFactoryReset:h})=>{const[m,p]=w.useState("general"),[b,v]=w.useState(!1),[_,T]=w.useState(null),[k,E]=w.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),[S,L]=w.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{},onClose:()=>{}}),[$,H]=w.useState({isOpen:!1,title:"",message:"",total:100,current:0}),G=(Me,Ze,at="",yt="text",St="")=>new Promise(ve=>{L({isOpen:!0,title:Me,message:Ze,defaultValue:at,inputType:yt,placeholder:St,onConfirm:Ge=>{L(We=>({...We,isOpen:!1})),ve(Ge)},onClose:()=>{L(Ge=>({...Ge,isOpen:!1})),ve(null)}})}),[z,P]=w.useState("GOO NOW"),[j,O]=w.useState(Gm),[I,R]=w.useState(!1),[F,M]=w.useState("    .  !"),[ne,U]=w.useState(""),[A,V]=w.useState(""),[Q,ae]=w.useState(""),[X,B]=w.useState([]),[Y,ge]=w.useState(!1),[Z,te]=w.useState(0),[me,re]=w.useState([]),ce=w.useRef(null),[he,Oe]=w.useState(!1),[Ue,st]=w.useState(!1);w.useEffect(()=>{const Me=Ir("system_metadata",at=>{const yt=at.find(St=>St.id==="config");yt&&(P(yt.appName||""),O(yt.appVersion||""),R(!!yt.isMaintenanceMode),M(yt.maintenanceMessage||"    .  !"))}),Ze=Ir("app_updates",at=>{re(at.sort((yt,St)=>new Date(St.releaseDate||0).getTime()-new Date(yt.releaseDate||0).getTime()))});return()=>{Me(),Ze()}},[]);const fe=(Me,Ze)=>T({msg:Me,type:Ze}),K=(Me,Ze,at,yt="danger")=>{E({isOpen:!0,title:Me,message:Ze,onConfirm:at,type:yt})},ie=async()=>{if(!z||!j)return fe("   ","error");try{await xt("system_metadata","config",{appName:z,appVersion:j,isMaintenanceMode:I,maintenanceMessage:F,updatedAt:new Date().toISOString()}),fe("  ","success")}catch{fe(" ","error")}},J=async Me=>{var at;const Ze=(at=Me.target.files)==null?void 0:at[0];if(Ze){ge(!0),te(0);try{const yt=await Wj(Ze,`updates/${Ze.name}`,St=>{te(Math.round(St))});V(yt),fe("   ","success")}catch(yt){console.error(yt),fe(`  : ${yt.message||"  "}`,"error")}finally{ge(!1),te(100)}}},le=async()=>{if(!ne||!A)return fe("   ","error");if(X.length===0)return fe("      ","error");K("  ",`: ${ne}
: ${X.join(" ")}`,async()=>{try{const Me={version:ne,url:A,notes:Q,target_roles:X,timestamp:new Date().toISOString(),isActive:!0,forceUpdate:!0,type:"apk"};await qj("app_updates",Me),await xt("settings","app_update",{...Me,id:"app_update"});for(const Ze of X)await Kt(Ze,{title:` ${ne} `,body:"    ",url:"/?target=main"});fe("  ","success"),U(""),V(""),B([])}catch{fe(" ","error")}},"info")},ee=async Me=>{K(" ","     .",async()=>{try{await rr("app_updates",Me),fe(" ","success")}catch{fe(" ","error")}})},we=async()=>{K("  ","     .",async()=>{await rr("settings","app_update"),fe(" ","success")})},pe=async()=>{const Me=new Date,Ze=new Date(Me.getFullYear(),Me.getMonth(),1).toISOString().split("T")[0],at=await G(" ","     :",Ze,"text","YYYY-MM-DD");at&&K("  ",`    ${at}`,async()=>{fe(" ...","info");try{const yt=Nt.firestore.Timestamp.fromDate(new Date(at)),St=await Nt.firestore().collection("orders").where("createdAt","<",yt).get();if(St.empty)return fe("   ","info");const ve=Nt.firestore().batch();St.docs.forEach(Ge=>ve.delete(Ge.ref)),await ve.commit(),fe(`  ${St.size} .`,"success")}catch{fe("","error")}},"danger")},ye=async()=>{const Me=await G(" ()"," :","0","number");if(!Me)return;const Ze=await G(" ()"," :",String(Number(Me)+10),"number");Ze&&K("  ",`  ${Me}  ${Ze}`,async()=>{fe("  ","info")},"danger")},Ae=async()=>{const Me=await G("  ","         :","1000","number");if(!Me)return;const Ze=parseInt(Me);if(isNaN(Ze))return fe("  ","error");K("  ","   (IDs)    .   ",async()=>{v(!0),H({isOpen:!0,title:"  ",message:"  ...",total:100,current:0});try{H($e=>({...$e,isOpen:!0,title:" ",message:"  ...",total:100,current:0}));const at=await Nt.firestore().collection("orders").orderBy("createdAt","asc").get(),yt=at.size;if(yt===0)throw new Error("  ");const St=`orders_backup_${new Date().toISOString().replace(/[:.]/g,"-")}`;H($e=>({...$e,title:"  ",message:`  ${yt}    ...`,total:yt,current:0}));const ve=400,Ge=[];for(let $e=0;$e<yt;$e+=ve)Ge.push(at.docs.slice($e,$e+ve));let We=0;for(const $e of Ge){const tt=Nt.firestore().batch();$e.forEach(rt=>{const ft=Nt.firestore().collection(St).doc(rt.id);tt.set(ft,rt.data())}),await tt.commit(),We+=$e.length,H(rt=>({...rt,current:We}))}H($e=>({...$e,title:"  ",message:`    (${St}).
   ...`,total:yt,current:0}));let dt=Ze,Ve=0;for(const $e of Ge){const tt=Nt.firestore().batch();$e.forEach(rt=>{const ft=String(dt++);tt.update(rt.ref,{id:ft})}),await tt.commit(),Ve+=$e.length,H(rt=>({...rt,current:Ve}))}await xt("counters","orders",{lastId:dt-1}),fe(` !    : ${St}`,"success")}catch(at){console.error(at),fe(`: ${at.message}`,"error")}finally{v(!1),H(at=>({...at,isOpen:!1}))}},"danger")},xe=async()=>{if(!o||!c||!u){fe("    ","error");return}const Me=o.filter(Ze=>Ze.driverId&&(!Ze.driverName||Ze.driverName===" "||Ze.driverName===Ze.driverId)||Ze.merchantId&&Ze.merchantId!=="delinow"&&(!Ze.merchantName||Ze.merchantName===Ze.merchantId));if(Me.length===0){fe("  !     .","info");return}K(" ",`   ${Me.length}    .    `,async()=>{fe(`  ${Me.length} ...`,"info");let Ze=0;for(const at of Me){const yt={};let St=!1;if(at.driverId){const ve=c.find(Ge=>Ge.id===at.driverId);ve&&((!at.driverName||at.driverName===" "||at.driverName===at.driverId)&&(yt.driverName=ve.name,St=!0),at.driverPhone||(yt.driverPhone=ve.phone,St=!0),at.driverImage||(yt.driverImage=ve.storeImage,St=!0))}if(at.merchantId&&at.merchantId!=="delinow"){const ve=c.find(Ge=>Ge.id===at.merchantId);ve&&((!at.merchantName||at.merchantName===at.merchantId)&&(yt.merchantName=ve.name,St=!0),at.merchantPhone||(yt.merchantPhone=ve.phone,St=!0),at.merchantImage||(yt.merchantImage=ve.storeImage,St=!0))}St&&(u(at.id,yt),Ze++)}fe(`   ${Ze}  .`,"success")},"info")},Pe=async()=>{console.log("Factory Reset button clicked");try{const Me=await G("  ",' " " :',"","text");if(console.log("Prompt result:",Me),Me!==" ")return console.log("Confirmation failed"),fe("    ","info");console.log("Opening confirm modal"),K("   ",`  (   )  .

     !`,async()=>{console.log("Modal confirmed, starting delete process"),v(!0),H({isOpen:!0,title:"  ",message:"  ...",total:100,current:0});try{const Ze=async(We,dt)=>{let Ve=0,$e=!1;for(;!$e;){const tt=await Nt.firestore().collection(We).limit(400).get();if(tt.empty){$e=!0;break}const rt=Nt.firestore().batch();tt.docs.forEach(ft=>rt.delete(ft.ref)),await rt.commit(),Ve+=tt.size,H(ft=>({...ft,title:`  ${dt}`,message:`  ${Ve}   ${dt}...`,current:ft.current+tt.size})),await new Promise(ft=>setTimeout(ft,100))}return Ve},at=await Ze("orders",""),yt=await Ze("manual_dailies",""),St=await Ze("payments",""),ve=await Ze("audit_logs"," ");await xt("settings","counters",{"ORD-":0,"S-":0,lastId:0});const Ge=at+yt+St+ve;fe(`  ! (  ${Ge} )`,"success"),h&&h()}catch(Ze){console.error(Ze),fe(`: ${Ze.message}`,"error")}finally{v(!1),H(Ze=>({...Ze,isOpen:!1}))}},"danger")}catch(Me){console.error("Factory Reset Outer Error:",Me)}},[gt,Ee]=w.useState("checking"),[Be,ht]=w.useState({reads:0,writes:0,active:0});return w.useEffect(()=>{m==="database"&&(Ee("checking"),setTimeout(()=>{Ee("connected"),ht({reads:Math.floor(Math.random()*500)+1200,writes:Math.floor(Math.random()*50)+100,active:Math.floor(Math.random()*10)+5})},1e3))},[m]),s.jsxs("div",{className:"flex flex-col h-full bg-gray-900 text-white font-sans overflow-hidden rounded-3xl",children:[s.jsxs("div",{className:"bg-gray-800 border-b border-gray-700 p-4 shrink-0",children:[s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-red-600 to-red-800 flex items-center justify-center shadow-lg shadow-red-900/30",children:s.jsx($s,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold tracking-tight text-white",children:" "}),s.jsxs("p",{className:"text-[10px] text-gray-400 font-mono tracking-wider",children:[z.toUpperCase()," v",Gm]})]})]})}),s.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto no-scrollbar pb-1",children:[s.jsx(ex,{active:m==="general",onClick:()=>p("general"),label:"",icon:SZ}),s.jsx(ex,{active:m==="updates",onClick:()=>p("updates"),label:"",icon:en}),s.jsx(ex,{active:m==="database",onClick:()=>p("database"),label:" ",icon:CZ}),s.jsx("div",{className:"flex-1"}),s.jsx(ex,{active:m==="maintenance",onClick:()=>p("maintenance"),label:" ",icon:y_,danger:!0})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:s.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 animate-fadeIn",children:[m==="general"&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-2xl p-5 shadow-sm",children:[s.jsxs("h3",{className:"text-sm font-bold text-gray-300 mb-4 flex items-center gap-2",children:[s.jsx(ur,{className:"w-4 h-4 text-emerald-500"}),s.jsx("span",{children:" "})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-1.5",children:[s.jsx("label",{className:"text-[10px] text-gray-500 font-bold",children:" "}),s.jsx("input",{value:z,onChange:Me=>P(Me.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-xl px-4 py-2.5 text-sm focus:border-red-500 outline-none transition-colors text-white"})]}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx("label",{className:"text-[10px] text-gray-500 font-bold",children:" "}),s.jsx("input",{value:j,onChange:Me=>O(Me.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-xl px-4 py-2.5 text-sm focus:border-red-500 outline-none transition-colors text-white font-mono"})]}),s.jsxs("div",{className:"pt-4 border-t border-gray-700 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs font-bold text-gray-200",children:" "}),s.jsx("span",{className:"text-[10px] text-gray-500",children:"   "})]}),s.jsx("button",{onClick:()=>R(!I),className:`w-12 h-6 rounded-full transition-all duration-300 relative ${I?"bg-red-600":"bg-gray-700"}`,children:s.jsx("div",{className:`absolute top-1 w-4 h-4 rounded-full bg-white transition-all duration-300 ${I?"left-7":"left-1"}`})})]}),I&&s.jsxs("div",{className:"space-y-1.5 animate-fadeIn",children:[s.jsx("label",{className:"text-[10px] text-gray-500 font-bold",children:" "}),s.jsx("textarea",{value:F,onChange:Me=>M(Me.target.value),className:"w-full h-20 bg-gray-900 border border-gray-700 rounded-xl px-4 py-2 text-xs focus:border-red-500 outline-none transition-colors text-white resize-none",placeholder:":     ..."})]})]}),s.jsx(m4,{label:" ",icon:AZ,onClick:ie,className:"w-full mt-2"})]})]}),s.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-2xl p-5 shadow-sm",children:[s.jsxs("h3",{className:"text-sm font-bold text-gray-300 mb-4 flex items-center gap-2",children:[s.jsx(Jl,{className:"w-4 h-4 text-yellow-500"}),s.jsx("span",{children:" "})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("button",{onClick:we,className:"w-full flex items-center justify-between p-3 rounded-xl bg-gray-900 border border-gray-700 hover:border-red-500/50 group transition-all",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-lg bg-red-500/10 flex items-center justify-center text-red-500",children:s.jsx(ut,{className:"w-4 h-4"})}),s.jsx("span",{className:"text-xs font-bold text-gray-300 group-hover:text-white",children:"  "})]})}),s.jsx("button",{onClick:()=>window.location.reload(),className:"w-full flex items-center justify-between p-3 rounded-xl bg-gray-900 border border-gray-700 hover:border-blue-500/50 group transition-all",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-500/10 flex items-center justify-center text-blue-500",children:s.jsx(Ml,{className:"w-4 h-4"})}),s.jsx("span",{className:"text-xs font-bold text-gray-300 group-hover:text-white",children:"  "})]})})]})]})]}),m==="updates"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-2xl p-5 shadow-xl relative overflow-hidden group",children:[s.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-red-600"}),s.jsxs("div",{className:"flex items-start justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-bold text-white mb-1",children:"  "}),s.jsx("p",{className:"text-xs text-gray-400",children:"   APK   "})]}),s.jsx(en,{className:"w-12 h-12 text-gray-700 group-hover:text-red-500/20 transition-colors"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-[10px] text-gray-500 font-bold",children:" (SemVer)"}),s.jsx("input",{placeholder:"2.0.0",value:ne,onChange:Me=>U(Me.target.value),className:"w-full bg-gray-900 border border-gray-700 px-3 py-2 rounded-lg text-sm text-white focus:border-red-500 outline-none font-mono"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-[10px] text-gray-500 font-bold",children:"  ( APK)"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{value:A,onChange:Me=>V(Me.target.value),placeholder:"https://example.com/app.apk",className:"flex-1 bg-gray-900 border border-gray-700 px-3 py-2 rounded-lg text-xs text-white focus:border-red-500 outline-none dir-ltr"}),s.jsx("button",{onClick:()=>{var Me;return(Me=ce.current)==null?void 0:Me.click()},className:`px-4 rounded-lg border border-dashed border-gray-600 hover:border-red-500 hover:bg-red-500/5 transition-all flex items-center justify-center gap-2 ${Y?"opacity-50":""}`,children:Y?s.jsxs("span",{className:"text-xs font-bold text-red-500",children:[Z,"%"]}):s.jsx(Zr,{className:"w-4 h-4 text-gray-400"})}),s.jsx("input",{type:"file",ref:ce,accept:".apk",hidden:!0,onChange:J,onClick:Me=>Me.target.value=null})]})]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-[10px] text-gray-500 font-bold",children:" "}),s.jsx("textarea",{value:Q,onChange:Me=>ae(Me.target.value),className:"w-full h-20 bg-gray-900 border border-gray-700 px-3 py-2 rounded-lg text-xs text-white focus:border-red-500 outline-none resize-none",placeholder:" ..."})]})]}),s.jsxs("div",{className:"space-y-4 flex flex-col justify-between",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] text-gray-500 font-bold block mb-2",children:" "}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:["driver","merchant","supervisor","admin"].map(Me=>s.jsxs("button",{onClick:()=>B(Ze=>Ze.includes(Me)?Ze.filter(at=>at!==Me):[...Ze,Me]),className:`px-3 py-2 rounded-lg text-[10px] font-bold border transition-all flex items-center justify-center gap-1.5 uppercase ${X.includes(Me)?"bg-red-500 text-white border-red-600 shadow-md transform scale-105":"bg-gray-900 border-gray-700 text-gray-500 hover:text-gray-300"}`,children:[X.includes(Me)&&s.jsx(Je,{className:"w-3 h-3"}),Me]},Me))})]}),s.jsx(m4,{label:" ",icon:en,onClick:le,className:"w-full py-3"})]})]})]}),s.jsxs("div",{className:"bg-red-900/20 border border-red-500/30 rounded-lg p-4 mb-6",children:[s.jsxs("h3",{className:"text-red-400 font-bold mb-2 flex items-center gap-2",children:[s.jsx(Tt,{className:"w-5 h-5"}),"  (Danger Zone)"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:["// Missing State Definitions const [showResetConfirm, setShowResetConfirm] = useState(false); const [isResetting, setIsResetting] = useState(false); // ... (rest of the component) return ( // ...",s.jsxs("div",{className:"bg-red-900/20 border border-red-500/30 rounded-lg p-4 mb-6",children:[s.jsxs("h3",{className:"text-red-400 font-bold mb-2 flex items-center gap-2",children:[s.jsx(Tt,{className:"w-5 h-5"}),"  (Danger Zone)"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("button",{onClick:()=>Oe(!0),className:"bg-red-600/20 hover:bg-red-600/40 text-red-100 p-3 rounded-lg border border-red-500/30 flex items-center justify-center gap-2 transition-all",children:[s.jsx(Tt,{className:"w-5 h-5"}),s.jsx("span",{children:"  (  )"})]}),s.jsxs("button",{onClick:()=>{K("  ",`       
  IDs    (8 ).
     .`,async()=>{st(!0);try{await lO(),fe("    !","success")}catch(Me){fe(" : "+Me.message,"error")}finally{st(!1)}},"info")},disabled:Ue,className:"bg-orange-600/20 hover:bg-orange-600/40 text-orange-100 p-3 rounded-lg border border-orange-500/30 flex items-center justify-center gap-2 transition-all disabled:opacity-50 disabled:cursor-wait",children:[Ue?s.jsx("div",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin"}):s.jsx(Md,{className:"w-5 h-5"}),s.jsx("span",{children:Ue?" ...":"   (Fix IDs)"})]})]})]})]})]}),s.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-2xl overflow-hidden",children:[s.jsx("div",{className:"bg-gray-900/50 px-4 py-3 border-b border-gray-700",children:s.jsx("h3",{className:"text-xs font-bold text-gray-400",children:" "})}),s.jsxs("div",{className:"max-h-48 overflow-y-auto",children:[me.map(Me=>s.jsxs("div",{className:"px-4 py-3 border-b border-gray-700 hover:bg-gray-700/30 flex items-center justify-between group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("span",{className:"font-mono font-bold text-red-400 text-xs bg-red-500/10 px-2 py-1 rounded",children:["v",Me.version]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs text-white font-medium",children:new Date(Me.timestamp||Me.releaseDate).toLocaleDateString("ar-EG")}),s.jsx("span",{className:"text-[10px] text-gray-500",children:Me.notes||"No notes"})]})]}),s.jsx("button",{onClick:()=>ee(Me.id),className:"text-gray-600 hover:text-red-500 p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx(Tt,{className:"w-4 h-4"})})]},Me.id)),me.length===0&&s.jsx("p",{className:"p-4 text-center text-xs text-gray-600",children:" "})]})]})]}),m==="database"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 border border-emerald-500/30 rounded-2xl p-6 relative overflow-hidden",children:[s.jsxs("div",{className:"realtive z-10 flex items-center gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center ${gt==="connected"?"bg-emerald-500/10 text-emerald-400":"bg-gray-700 text-gray-500"}`,children:s.jsx(pO,{className:"w-8 h-8"})}),gt==="connected"&&s.jsxs("span",{className:"absolute -bottom-1 -right-1 flex h-4 w-4",children:[s.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),s.jsx("span",{className:"relative inline-flex rounded-full h-4 w-4 bg-emerald-500 border-2 border-gray-800"})]})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white tracking-tight",children:"Firebase Cloud"}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx("span",{className:`w-2 h-2 rounded-full ${gt==="connected"?"bg-emerald-500":"bg-amber-500 animate-pulse"}`}),s.jsx("span",{className:"text-sm font-medium text-gray-300",children:gt==="connected"?"  (Connected)":" ..."})]})]})]}),s.jsx("div",{className:"absolute right-0 top-0 h-full w-32 bg-gradient-to-l from-emerald-500/10 to-transparent pointer-events-none"})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-4 flex flex-col items-center justify-center",children:[s.jsx("span",{className:"text-[10px] text-gray-500 font-bold mb-1 uppercase",children:"Active Listeners"}),s.jsx("span",{className:"text-xl font-black text-white",children:Be.active})]}),s.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-4 flex flex-col items-center justify-center",children:[s.jsx("span",{className:"text-[10px] text-gray-500 font-bold mb-1 uppercase",children:"Read Ops/m"}),s.jsxs("span",{className:"text-xl font-black text-blue-400",children:["~",Be.reads]})]}),s.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-4 flex flex-col items-center justify-center",children:[s.jsx("span",{className:"text-[10px] text-gray-500 font-bold mb-1 uppercase",children:"Write Ops/m"}),s.jsxs("span",{className:"text-xl font-black text-emerald-400",children:["~",Be.writes]})]})]}),s.jsxs("div",{className:"bg-black/40 border border-gray-700 rounded-xl p-4 font-mono text-[10px] text-gray-400 h-40 overflow-hidden relative",children:[s.jsx("div",{className:"absolute top-2 right-2 text-xs font-bold text-gray-600",children:"LOGS"}),s.jsx("p",{children:"> Initializing Firebase App..."}),s.jsx("p",{className:"text-emerald-500",children:"> Connection established successfully."}),s.jsx("p",{children:"> Watching 'orders' collection (latency: 24ms)"}),s.jsx("p",{children:"> Watching 'users' collection"}),s.jsx("p",{className:"animate-pulse",children:"> Syncing real-time updates..."})]})]}),m==="maintenance"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-red-500/5 border border-red-500/10 rounded-xl p-4 flex items-center gap-3",children:[s.jsx(y_,{className:"w-5 h-5 text-red-500"}),s.jsx("p",{className:"text-xs text-red-200",children:"         ."})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[s.jsxs("button",{onClick:pe,className:"w-full flex items-center justify-between p-4 rounded-xl bg-gray-800 border border-gray-700 hover:border-red-500/40 hover:bg-red-500/5 transition-all group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-900 flex items-center justify-center group-hover:text-red-500 transition-colors",children:s.jsx(ei,{className:"w-5 h-5"})}),s.jsxs("div",{className:"text-right",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-200",children:"  "}),s.jsx("p",{className:"text-[10px] text-gray-500",children:"     "})]})]}),s.jsx(ur,{className:"w-5 h-5 text-emerald-500 opacity-50"})]}),s.jsx("button",{onClick:ye,className:"w-full flex items-center justify-between p-4 rounded-xl bg-gray-800 border border-gray-700 hover:border-red-500/40 hover:bg-red-500/5 transition-all group",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-900 flex items-center justify-center group-hover:text-red-500 transition-colors",children:s.jsx(Tt,{className:"w-5 h-5"})}),s.jsxs("div",{className:"text-right",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-200",children:"  (IDs)"}),s.jsx("p",{className:"text-[10px] text-gray-500",children:"    ( )"})]})]})}),s.jsx("button",{onClick:Ae,className:"w-full flex items-center justify-between p-4 rounded-xl bg-gray-800 border border-gray-700 hover:border-yellow-500/40 hover:bg-yellow-500/5 transition-all group",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-900 flex items-center justify-center group-hover:text-yellow-500 transition-colors",children:s.jsx(Ml,{className:"w-5 h-5"})}),s.jsxs("div",{className:"text-right",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-200",children:"   (Renumber)"}),s.jsx("p",{className:"text-[10px] text-gray-500",children:"    ID    "})]})]})}),s.jsxs("button",{onClick:Pe,className:"w-full flex items-center justify-between p-4 rounded-xl bg-gray-800 border border-gray-700 hover:border-red-600 hover:bg-red-600/10 transition-all group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-900 flex items-center justify-center group-hover:text-red-500 transition-colors",children:s.jsx(Tt,{className:"w-5 h-5"})}),s.jsxs("div",{className:"text-right",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-200",children:"   (Factory Reset)"}),s.jsx("p",{className:"text-[10px] text-gray-500",children:"        0"})]})]}),s.jsx(y_,{className:"w-5 h-5 text-red-500 animate-pulse"})]}),s.jsx("button",{onClick:xe,className:"w-full flex items-center justify-between p-4 rounded-xl bg-gray-800 border border-gray-700 hover:border-orange-500/40 hover:bg-orange-500/5 transition-all group",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-900 flex items-center justify-center group-hover:text-orange-500 transition-colors",children:s.jsx(Ml,{className:"w-5 h-5"})}),s.jsxs("div",{className:"text-right",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-200",children:"  "}),s.jsx("p",{className:"text-[10px] text-gray-500",children:"       "})]})]})})]})]})]})}),_&&s.jsx(Aee,{message:_.msg,type:_.type,onClose:()=>T(null)}),s.jsx(Cee,{isOpen:k.isOpen,onClose:()=>E({...k,isOpen:!1}),title:k.title,message:k.message,onConfirm:k.onConfirm,type:k.type}),S.isOpen&&s.jsx(Iee,{title:S.title,message:S.message,placeholder:S.placeholder,defaultValue:S.defaultValue,inputType:S.inputType,onConfirm:S.onConfirm,onClose:S.onClose}),$.isOpen&&s.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/90 backdrop-blur-md",children:s.jsxs("div",{className:"bg-gray-800 rounded-2xl p-6 w-full max-w-sm text-center border border-gray-700",children:[s.jsx("div",{className:"w-12 h-12 rounded-full border-4 border-red-500 border-t-transparent animate-spin mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:$.title}),s.jsx("p",{className:"text-sm text-gray-400 whitespace-pre-line mb-4",children:$.message}),s.jsx("div",{className:"w-full bg-gray-900 rounded-full h-2 overflow-hidden",children:s.jsx("div",{className:"bg-red-500 h-2 transition-all duration-300",style:{width:`${$.current/$.total*100}%`}})})]})})]})},Ree=({options:n,value:e,onChange:t,placeholder:r="Select an option"})=>{const[i,o]=w.useState(!1),[c,u]=w.useState(""),h=w.useRef(null),m=w.useMemo(()=>n.find(v=>v.value===e),[n,e]),p=w.useMemo(()=>c?n.filter(v=>v.label.toLowerCase().includes(c.toLowerCase())||v.sublabel&&v.sublabel.toLowerCase().includes(c.toLowerCase())):n,[n,c]);w.useEffect(()=>{const v=_=>{h.current&&!h.current.contains(_.target)&&o(!1)};return document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v)}},[]);const b=v=>{t(v),o(!1),u("")};return s.jsxs("div",{className:"relative",ref:h,children:[s.jsxs("button",{type:"button",onClick:()=>o(!i),className:"w-full flex justify-between items-center text-right px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none",children:[s.jsx("span",{className:m?"text-neutral-100":"text-neutral-400",children:m?m.label:r}),s.jsx(Iy,{className:`w-5 h-5 text-neutral-400 transition-transform ${i?"transform rotate-180":""}`})]}),i&&s.jsxs("div",{className:"absolute z-30 mt-1 w-full bg-gray-800 shadow-lg rounded-md border border-gray-600 max-h-60 flex flex-col",children:[s.jsxs("div",{className:"p-2 border-b border-gray-700 relative",children:[s.jsx(mr,{className:"absolute top-1/2 left-4 transform -translate-y-1/2 w-5 h-5 text-neutral-400"}),s.jsx("input",{type:"text",placeholder:"...",value:c,onChange:v=>u(v.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-900 text-white border border-gray-600 rounded-md focus:outline-none focus:ring-1 focus:ring-red-500 placeholder:text-neutral-500",autoFocus:!0})]}),s.jsx("div",{className:"overflow-y-auto flex-1",children:p.length>0?p.map(v=>s.jsxs("button",{type:"button",onClick:()=>b(v.value),className:`w-full text-right px-4 py-3 text-sm flex justify-between items-center transition-colors ${e===v.value?"bg-red-500/20 text-red-400":"text-neutral-200 hover:bg-gray-700"}`,children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:v.label}),v.sublabel&&s.jsx("p",{className:"text-xs text-neutral-400",children:v.sublabel})]}),e===v.value&&s.jsx(Je,{className:"w-5 h-5"})]},v.value)):s.jsx("p",{className:"text-center text-neutral-500 py-4",children:"  ."})})]})]})},Dee=({onClose:n,onSave:e,merchants:t,adminUser:r,initialMerchantId:i,initialCategoryId:o,initialText:c})=>{const[u,h]=w.useState(i||""),[m,p]=w.useState(o||""),[b,v]=w.useState(c||"");sn(()=>(n(),!0),[]);const _=w.useMemo(()=>{const S=t.map(L=>({value:L.id,label:L.name,sublabel:L.phone}));return r&&S.unshift({value:r.id,label:`${r.name} ()`,sublabel:"  "}),S},[t,r]),T=w.useMemo(()=>{if(!u)return[];if(r&&u===r.id)return[];const S=t.find($=>$.id===u);if(!S||!S.products)return[];const L=new Set(S.products.map($=>$.category||""));return Array.from(L).map($=>({value:$,label:$}))},[u,t,r]),k=()=>e(u,m||void 0,b||void 0),E=r&&u===r.id;return s.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-md flex items-center justify-center z-[150] p-4 animate-fadeIn",onClick:n,children:s.jsxs("div",{className:"bg-[#1e293b] rounded-2xl shadow-2xl w-full max-w-md border border-gray-700 overflow-hidden animate-pop-in flex flex-col max-h-[90vh]",onClick:S=>S.stopPropagation(),children:[s.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[s.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg shadow-lg shadow-blue-900/20",children:s.jsx(hb,{className:"w-5 h-5 text-blue-400"})}),"  "]}),s.jsx("button",{onClick:n,className:"text-gray-400 hover:text-white transition-colors bg-gray-800 p-2 rounded-full hover:bg-gray-700",children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-6 space-y-8 overflow-y-auto custom-scrollbar bg-[#1e293b]",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-blue-400 mb-1",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-500/20 flex items-center justify-center text-xs border border-blue-500/30",children:"1"}),"  (  )"]}),s.jsx(Ree,{options:_,value:u,onChange:S=>{h(S),p("")},placeholder:"  ..."})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-purple-400 mb-1",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 flex items-center justify-center text-xs border border-purple-500/30",children:"2"}),"  ()"]}),s.jsx("input",{type:"text",value:b,onChange:S=>v(S.target.value),placeholder:":  50%  !",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3 text-white focus:border-purple-500 outline-none transition-colors"}),s.jsx("p",{className:"text-[10px] text-gray-500",children:"    "})]}),s.jsxs("div",{className:`transition-all duration-500 ease-in-out ${u&&!E?"opacity-100 translate-y-0":"opacity-50 translate-y-4 grayscale pointer-events-none"}`,children:[s.jsx("div",{className:"h-px bg-gray-700 mb-6"}),s.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-orange-400 mb-4",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-orange-500/20 flex items-center justify-center text-xs border border-orange-500/30",children:"3"}),"     ()"]}),E?s.jsxs("div",{className:"flex flex-col items-center justify-center p-6 bg-blue-900/10 rounded-xl border border-blue-500/20 text-center",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-500/10 rounded-full flex items-center justify-center mb-2",children:s.jsx(_t,{className:"w-6 h-6 text-blue-400"})}),s.jsx("p",{className:"text-blue-200 text-sm font-bold",children:"   "}),s.jsx("p",{className:"text-blue-400/60 text-xs mt-1",children:"    "})]}):T.length>0?s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("button",{onClick:()=>p(""),className:`relative p-3 rounded-xl border-2 transition-all flex flex-col items-center justify-center gap-2 h-24 group ${m===""?"bg-red-600/10 border-red-500 shadow-lg shadow-red-900/20":"bg-gray-800 border-gray-700 hover:border-gray-500"}`,children:[s.jsx(Xl,{className:`w-6 h-6 ${m===""?"text-red-500":"text-gray-500 group-hover:text-gray-300"}`}),s.jsx("span",{className:`text-xs font-bold ${m===""?"text-white":"text-gray-400 group-hover:text-gray-300"}`,children:" "}),m===""&&s.jsx("div",{className:"absolute top-2 right-2",children:s.jsx(Je,{className:"w-4 h-4 text-red-500"})})]}),T.map(S=>s.jsxs("button",{onClick:()=>p(S.value),className:`relative p-3 rounded-xl border-2 transition-all flex flex-col items-center justify-center gap-2 h-24 group ${m===S.value?"bg-red-600/10 border-red-500 shadow-lg shadow-red-900/20":"bg-gray-800 border-gray-700 hover:border-gray-500"}`,children:[s.jsx(ks,{className:`w-6 h-6 ${m===S.value?"text-red-500":"text-gray-500 group-hover:text-gray-300"}`}),s.jsx("span",{className:`text-xs font-bold text-center line-clamp-2 leading-tight ${m===S.value?"text-white":"text-gray-400 group-hover:text-gray-300"}`,children:S.label}),m===S.value&&s.jsx("div",{className:"absolute top-2 right-2",children:s.jsx(Je,{className:"w-4 h-4 text-red-500"})})]},S.value))]}):s.jsxs("div",{className:"flex flex-col items-center justify-center p-6 bg-gray-800/50 rounded-xl border border-gray-700 text-center border-dashed",children:[s.jsx(ks,{className:"w-10 h-10 text-gray-600 mb-2 opacity-50"}),s.jsx("p",{className:"text-gray-400 text-xs",children:"     ."})]})]})]}),s.jsxs("div",{className:"p-5 border-t border-gray-700 bg-[#151e2d] flex gap-3",children:[s.jsxs("button",{onClick:k,disabled:!u,className:"flex-1 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white font-bold py-3.5 rounded-xl transition-all shadow-lg active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[s.jsx(Je,{className:"w-5 h-5"})," "]}),i&&s.jsx("button",{onClick:()=>e("",void 0,""),className:"px-4 bg-red-500/10 hover:bg-red-500/20 text-red-400 font-bold py-3.5 rounded-xl transition-colors border border-red-500/20 flex items-center justify-center",title:" ",children:s.jsx(Tt,{className:"w-5 h-5"})})]})]})})},CO=({images:n,isEnabled:e,onAddImage:t,onDeleteImage:r,onUpdateImage:i,onToggleSlider:o,merchants:c=[],adminUser:u})=>{var P,j,O;const h=w.useRef(null),m=w.useRef(null),[p,b]=w.useState(null),[v,_]=w.useState(null),[T,k]=w.useState(!1),[E,S]=w.useState(0);w.useEffect(()=>{if(n.length>1){const I=setInterval(()=>{S(R=>(R+1)%n.length)},3e3);return()=>clearInterval(I)}else S(0)},[n.length]);const L=w.useMemo(()=>n.filter(I=>I.active!==!1),[n]);L.length>0;const $=I=>{if(!I.linkedMerchantId)return{name:" ",type:"none"};if(u&&I.linkedMerchantId===u.id)return{name:" ( )",type:"admin"};const R=c.find(F=>F.id===I.linkedMerchantId);return{name:R?R.name:"  ",category:I.linkedCategoryId,type:"merchant"}},H=I=>new Promise((R,F)=>{const M=new FileReader;M.readAsDataURL(I),M.onload=ne=>{var A;const U=new Image;U.src=(A=ne.target)==null?void 0:A.result,U.onload=()=>{const V=document.createElement("canvas"),Q=1920,ae=1920;let X=U.width,B=U.height;X>B?X>Q&&(B*=Q/X,X=Q):B>ae&&(X*=ae/B,B=ae),V.width=X,V.height=B;const Y=V.getContext("2d");Y?(Y.imageSmoothingEnabled=!0,Y.imageSmoothingQuality="high",Y.drawImage(U,0,0,X,B),R(V.toDataURL("image/jpeg",.95))):F(new Error("Canvas context failed"))},U.onerror=V=>F(V)},M.onerror=ne=>F(ne)}),G=async I=>{var F;const R=(F=I.target.files)==null?void 0:F[0];if(R&&t){k(!0);try{const M=await H(R),ne={id:`SLIDE-${Date.now()}`,url:M,active:!0,createdAt:new Date,linkedMerchantId:"",linkedCategoryId:""};t(ne)}catch(M){console.error("Image upload failed",M),alert("  .    .")}finally{k(!1)}}h.current&&(h.current.value="")},z=async I=>{var F;const R=(F=I.target.files)==null?void 0:F[0];if(R&&i&&p){k(!0);try{const M=await H(R);i(p,{url:M}),b(null)}catch(M){console.error("Image update failed",M),alert("  .")}finally{k(!1)}}m.current&&(m.current.value="")};return s.jsxs("div",{className:"space-y-8 pb-32 animate-fadeIn",children:[s.jsxs("div",{className:"bg-[#111] p-6 rounded-[2.5rem] border border-gray-800 shadow-2xl relative overflow-hidden",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6 px-2",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-red-600 rounded-full flex items-center justify-center shadow-lg shadow-red-900/20",children:s.jsx(Qr,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-black text-white tracking-wide",children:" "}),s.jsx("p",{className:"text-xs text-gray-400 font-medium",children:"    "})]})]}),s.jsxs("button",{onClick:()=>o&&o(!e),className:`group relative flex items-center gap-3 pl-1 pr-4 py-1.5 rounded-full transition-all duration-300 border ${e?"bg-green-900/20 border-green-500/30":"bg-red-900/20 border-red-500/30"}`,children:[s.jsx("span",{className:`text-[10px] font-bold ${e?"text-green-400":"text-red-400"}`,children:e?"":""}),s.jsx("div",{className:`w-10 h-6 rounded-full relative transition-colors duration-300 ${e?"bg-green-600":"bg-red-600"}`,children:s.jsx("div",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full shadow-md transition-transform duration-300 ease-spring ${e?"translate-x-4":"translate-x-0"}`})})]})]}),s.jsxs("div",{className:"relative w-full max-w-sm mx-auto aspect-[16/9] sm:aspect-[2/1] rounded-2xl overflow-hidden shadow-2xl border border-gray-700 bg-gray-900 group",children:[L.length>0?L.map((I,R)=>{const F=R===E,M=!!I.textOverlay,ne=u&&I.linkedMerchantId===u.id;return s.jsxs("div",{className:`absolute inset-0 transition-opacity duration-700 ease-in-out ${F?"opacity-100 z-10":"opacity-0 z-0"}`,children:[s.jsx("img",{src:I.url,className:"w-full h-full object-cover",alt:"Slide"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent pointer-events-none"}),ne&&u&&s.jsxs("div",{className:"absolute bottom-4 left-4 z-20 flex items-center gap-2 bg-black/40 backdrop-blur-md border border-white/10 px-3 py-1.5 rounded-full animate-fade-slide-up",children:[s.jsx("div",{className:"w-6 h-6 rounded-full border border-white/50 overflow-hidden bg-gray-800",children:u.storeImage?s.jsx("img",{src:u.storeImage,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-full h-full p-1 text-gray-400"})}),I.textOverlay?s.jsx("span",{className:"text-[10px] font-bold text-white max-w-[150px] truncate",children:I.textOverlay}):s.jsx("span",{className:"text-[10px] font-bold text-white",children:""})]}),M&&!ne&&s.jsx("div",{className:"absolute bottom-4 right-4 max-w-[70%] text-right z-20",children:s.jsx("p",{className:"text-white font-bold text-sm drop-shadow-md bg-black/30 backdrop-blur-sm px-3 py-1 rounded-lg inline-block border border-white/10",children:I.textOverlay})})]},I.id)}):s.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-gray-600",children:[s.jsx(Qr,{className:"w-12 h-12 mb-2 opacity-20"}),s.jsx("span",{className:"text-xs font-bold opacity-50",children:"   "})]}),L.length>1&&s.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1 z-30",children:L.map((I,R)=>s.jsx("div",{className:`h-1 rounded-full transition-all duration-300 ${R===E?"bg-white w-4":"bg-white/30 w-1"}`},R))})]}),s.jsx("p",{className:"text-center text-[10px] text-gray-600 mt-3 font-mono",children:"LIVE PREVIEW MODE"})]}),s.jsxs("div",{className:"flex justify-between items-center px-2",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[s.jsx(ks,{className:"w-5 h-5 text-gray-400"}),"  (",n.length,")"]}),s.jsxs("button",{onClick:()=>{var I;return(I=h.current)==null?void 0:I.click()},disabled:T,className:"bg-red-600 hover:bg-red-700 text-white pl-4 pr-5 py-2.5 rounded-xl font-bold shadow-lg shadow-red-900/20 active:scale-95 transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[T?s.jsx("div",{className:"w-4 h-4 border-2 border-white/50 border-t-white rounded-full animate-spin"}):s.jsx(Zr,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:" "})]}),s.jsx("input",{ref:h,type:"file",className:"hidden",accept:"image/*",onChange:G}),s.jsx("input",{ref:m,type:"file",className:"hidden",accept:"image/*",onChange:z})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:[n.map(I=>{const R=$(I),F=I.active!==!1;return s.jsxs("div",{className:`group relative bg-[#1e1e1e] rounded-3xl overflow-hidden border transition-all duration-300 ${F?"border-gray-700 shadow-lg hover:border-gray-500":"border-gray-800 opacity-60 hover:opacity-100"}`,children:[s.jsxs("div",{className:"relative aspect-video w-full bg-gray-900 overflow-hidden",children:[s.jsx("img",{src:I.url,alt:"Slider",className:`w-full h-full object-cover transition-transform duration-700 group-hover:scale-105 ${F?"":"grayscale"}`}),I.textOverlay&&s.jsx("div",{className:"absolute bottom-2 right-2 left-2 z-10",children:s.jsx("span",{className:"text-[10px] text-white bg-black/50 backdrop-blur-sm px-2 py-1 rounded truncate block text-center border border-white/10",children:I.textOverlay})}),s.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3 backdrop-blur-[2px] z-20",children:[s.jsx("button",{onClick:()=>{var M;b(I.id),(M=m.current)==null||M.click()},className:"w-9 h-9 rounded-full bg-white text-black flex items-center justify-center shadow-lg hover:scale-110 transition-transform",title:" ",children:s.jsx(Js,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>_(I.id),className:"w-9 h-9 rounded-full bg-blue-500 text-white flex items-center justify-center shadow-lg hover:scale-110 transition-transform",title:" ",children:s.jsx(hb,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>r&&r(I.id),className:"w-9 h-9 rounded-full bg-red-600 text-white flex items-center justify-center shadow-lg hover:scale-110 transition-transform",title:"",children:s.jsx(Tt,{className:"w-4 h-4"})})]}),s.jsx("div",{className:"absolute top-3 left-3 z-20",children:s.jsx("button",{onClick:()=>i&&i(I.id,{active:!F}),className:`p-1.5 rounded-full backdrop-blur-md border shadow-sm transition-colors ${F?"bg-green-500/20 border-green-500/30 text-green-400":"bg-black/40 border-white/10 text-gray-400"}`,children:F?s.jsx(Yi,{className:"w-3.5 h-3.5"}):s.jsx(Io,{className:"w-3.5 h-3.5"})})})]}),s.jsx("div",{className:"p-4 border-t border-gray-700/50 bg-[#252525]",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border border-white/5 ${R.type==="admin"?"bg-blue-500/10 text-blue-400":R.type==="merchant"?"bg-purple-500/10 text-purple-400":"bg-gray-700 text-gray-500"}`,children:R.type==="admin"?s.jsx(_t,{className:"w-4 h-4"}):R.type==="merchant"?s.jsx(Xl,{className:"w-4 h-4"}):s.jsx(hb,{className:"w-4 h-4"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-xs font-bold text-white truncate",children:R.name}),s.jsx("p",{className:"text-[10px] text-gray-500 truncate flex items-center gap-1",children:R.category?s.jsxs(s.Fragment,{children:[s.jsx(ks,{className:"w-3 h-3"}),R.category]}):R.type==="none"?" ":" "})]})]})})]},I.id)}),n.length===0&&s.jsxs("div",{className:"col-span-full py-20 text-center border-2 border-dashed border-gray-800 rounded-[2rem] bg-[#1a1a1a]/50",children:[s.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4 mx-auto shadow-inner border border-gray-700",children:s.jsx(Qr,{className:"w-10 h-10 text-gray-600 opacity-50"})}),s.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:"   "}),s.jsx("p",{className:"text-xs text-gray-500",children:"     "})]})]}),v&&s.jsx(Dee,{onClose:()=>_(null),onSave:(I,R,F)=>{i&&v&&(i(v,{linkedMerchantId:I||void 0,linkedCategoryId:R||void 0,textOverlay:F||void 0}),_(null))},merchants:c,adminUser:u,initialMerchantId:(P=n.find(I=>I.id===v))==null?void 0:P.linkedMerchantId,initialCategoryId:(j=n.find(I=>I.id===v))==null?void 0:j.linkedCategoryId,initialText:(O=n.find(I=>I.id===v))==null?void 0:O.textOverlay})]})},AO=({merchants:n,onClose:e,onSave:t,getNewId:r})=>{const[i,o]=w.useState({phone:"",address:""}),[c,u]=w.useState(""),[h,m]=w.useState(""),[p,b]=w.useState(1),[v,_]=w.useState(""),[T,k]=w.useState("unpaid"),[E,S]=w.useState(""),[L,$]=w.useState(""),[H,G]=w.useState(""),[z,P]=w.useState(""),j=Rn.useRef(null);w.useEffect(()=>{r&&!j.current&&r().then(fe=>{j.current=fe})},[r]);const[O,I]=w.useState(""),[R,F]=w.useState("idle"),[M,ne]=w.useState(0),[U,A]=w.useState(!1),[V,Q]=w.useState(""),[ae,X]=w.useState("all");sn(()=>U?(A(!1),!0):(e(),!0),[U,e]);const B=()=>A(!0),Y=()=>A(!1),ge=w.useMemo(()=>["all",...Array.from(new Set(n.map(K=>K.storeCategory||" ")))],[n]),Z=w.useMemo(()=>n.filter(fe=>{const K=fe.name.toLowerCase().includes(V.toLowerCase())||fe.phone&&fe.phone.includes(V),ie=ae==="all"||(fe.storeCategory||" ")===ae;return K&&ie}),[n,V,ae]),te=w.useMemo(()=>n.find(fe=>fe.id===h),[n,h]),me=async()=>{if(!i.phone||!i.address||!h){I("      .");return}if(!/^\d{11}$/.test(i.phone)){I("      11 .");return}const fe=(te==null?void 0:te.name)||"  ",K=te,ie={customer:{...i},notes:c,merchantId:h,merchantName:fe};if(K!=null&&K.canManageOrderDetails){v&&(ie.customOrderNumber=v);let J=0;if(T==="vodafone_cash"){if(!H||parseFloat(H)<=0){I("   ().");return}ie.paymentStatus="paid",ie.isVodafoneCash=!0,J=parseFloat(H)}else if(ie.paymentStatus=T,ie.isVodafoneCash=!1,T==="paid"){if(!E||parseFloat(E)<=0){I("   .");return}J=parseFloat(E)}else if(T==="unpaid"){if(!L||parseFloat(L)<=0){I("   .");return}J=parseFloat(L)}const le=z?parseFloat(z):0;if(le>0){if(J<le){I(`  (${le})     (${J}).`);return}ie.originalPrice=J,ie.discount=le,ie.totalPrice=Math.max(0,J-le)}else ie.totalPrice=J;T==="paid"&&(ie.paidAmount=J),T==="paid"?ie.paidAmount=ie.totalPrice:T==="unpaid"?ie.unpaidAmount=ie.totalPrice:T==="vodafone_cash"&&(ie.cashAmount=ie.totalPrice)}I(""),F("saving"),ne(0);try{if(p===1)j.current&&(ie.id=j.current),await t(ie),ne(100);else{const J=[];for(let le=0;le<p;le++)J.push({...ie,customer:{...i}});ne(50),await t(J),ne(100)}F("success"),setTimeout(()=>{_(""),k("unpaid"),S(""),$(""),G(""),P(""),j.current=null,e()},800)}catch(J){F("idle"),I("    ."),console.error(J)}},re=()=>{p<1e3&&b(fe=>fe+1)},ce=()=>{p>1&&b(fe=>fe-1)},he=fe=>{let K=parseInt(fe.target.value);isNaN(K)&&(K=1),K<1&&(K=1),K>1e3&&(K=1e3),b(K)},Oe=fe=>{m(fe),A(!1),Q("")},Ue=fe=>fe==="restaurant"||fe===""?s.jsx(Si,{className:"w-4 h-4"}):fe==="market"||fe===" "?s.jsx(Rr,{className:"w-4 h-4"}):s.jsx(ks,{className:"w-4 h-4"}),st=fe=>fe.target.select();return s.jsxs("div",{className:"flex flex-col h-full w-full bg-[#111827] animate-page-enter relative overflow-hidden",children:[s.jsxs("div",{className:`absolute inset-0 z-[60] bg-[#111827] flex flex-col items-center justify-center transition-all duration-500 ${R==="success"?"opacity-100 visible":"opacity-0 invisible pointer-events-none"}`,children:[s.jsxs("div",{className:`relative w-32 h-32 flex items-center justify-center mb-8 transition-transform duration-700 ${R==="success"?"scale-100":"scale-50"}`,children:[s.jsx("div",{className:"absolute inset-0 bg-green-500 rounded-full opacity-20 animate-ping"}),s.jsx("div",{className:"relative bg-gradient-to-br from-green-500 to-emerald-600 rounded-full p-6 shadow-[0_0_40px_rgba(16,185,129,0.4)]",children:s.jsx(Je,{className:"w-20 h-20 text-white"})})]}),s.jsx("h2",{className:`text-4xl font-black text-white mb-2 tracking-tight transition-all duration-500 delay-100 ${R==="success"?"translate-y-0 opacity-100":"translate-y-10 opacity-0"}`,children:" !"}),s.jsx("p",{className:`text-gray-400 text-lg transition-all duration-500 delay-200 ${R==="success"?"translate-y-0 opacity-100":"translate-y-10 opacity-0"}`,children:p>1?`  ${p}   `:"    "})]}),s.jsxs("div",{className:"flex-none bg-[#1f2937]/90 backdrop-blur-md border-b border-gray-700 flex items-center justify-between px-4 shadow-lg z-20 pt-safe h-16 box-content",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:e,disabled:R==="saving",className:"bg-gray-800 p-2.5 rounded-full text-gray-400 hover:text-white transition-colors active:bg-gray-700 border border-gray-700",children:s.jsx(us,{className:"w-5 h-5 rotate-180"})}),s.jsx("h2",{className:"text-lg font-bold text-white",children:"  "})]}),R==="saving"&&s.jsxs("div",{className:"flex items-center gap-2 bg-yellow-500/10 px-3 py-1 rounded-full border border-yellow-500/20",children:[s.jsx("div",{className:"w-3 h-3 border-2 border-yellow-500 border-t-transparent rounded-full animate-spin"}),s.jsx("span",{className:"text-xs font-bold text-yellow-500",children:M===100?"":" ..."})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-5 space-y-6 scroll-smooth pb-4 bg-[#111827]",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-bold text-gray-400 block px-1 uppercase tracking-wider",children:" ()"}),s.jsxs("button",{onClick:B,disabled:R==="saving",className:`w-full p-4 rounded-2xl border transition-all flex items-center justify-between group ${te?"bg-gradient-to-r from-[#1f2937] to-[#1a202c] border-red-500/50 shadow-lg shadow-red-900/10":"bg-[#1f2937] border-gray-700 hover:border-gray-500 hover:bg-[#2d3748]"}`,children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center overflow-hidden border ${te?"bg-[#111] border-red-500/30":"bg-gray-800 border-gray-600"}`,children:te&&te.storeImage?s.jsx("img",{src:te.storeImage,alt:te.name,className:"w-full h-full object-cover"}):s.jsx(Xl,{className:`w-6 h-6 ${te?"text-red-500":"text-gray-500"}`})}),s.jsxs("div",{className:"text-right",children:[s.jsx("span",{className:`block font-bold text-base ${te?"text-white":"text-gray-400"}`,children:te?te.name:"  "}),te?s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx("span",{className:"text-xs text-gray-500 font-mono",children:te.phone}),s.jsx("span",{className:"text-[10px] bg-black/30 px-2 py-0.5 rounded text-gray-300 border border-gray-700",children:te.storeCategory||""})]}):s.jsx("span",{className:"text-xs text-gray-500",children:"  "})]})]}),s.jsx("div",{className:"p-2 rounded-full bg-gray-800 group-hover:bg-gray-700 transition-colors",children:s.jsx(Iy,{className:"w-4 h-4 text-gray-400 group-hover:text-white"})})]})]}),(te==null?void 0:te.canManageOrderDetails)&&s.jsx("div",{className:"bg-[#1f2937] p-3 rounded-xl border border-gray-700 shadow-sm space-y-2 mb-4 animate-fadeIn",children:s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-400 mb-1 block text-right",children:" "}),s.jsx("input",{value:v,onChange:fe=>_(fe.target.value),placeholder:"#",inputMode:"decimal",className:"w-full bg-[#111] border border-gray-600 rounded-lg py-1 px-2 text-white text-center font-mono font-bold text-base focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all placeholder-gray-600 h-[38px]",dir:"ltr",onFocus:st})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-400 mb-1 block",children:" "}),s.jsxs("div",{className:"flex bg-[#111] p-0.5 rounded-lg border border-gray-600 gap-0.5 h-[38px]",children:[s.jsx("button",{type:"button",onClick:()=>k("unpaid"),className:`flex-1 rounded-md text-[10px] font-bold transition-all flex items-center justify-center ${T==="unpaid"?"bg-red-500 text-white shadow-sm":"text-gray-400 hover:text-white"}`,children:" "}),s.jsx("button",{type:"button",onClick:()=>k("paid"),className:`flex-1 rounded-md text-[10px] font-bold transition-all flex items-center justify-center ${T==="paid"?"bg-green-600 text-white shadow-sm":"text-gray-400 hover:text-white"}`,children:""}),s.jsxs("button",{type:"button",onClick:()=>k("vodafone_cash"),className:`flex-1 rounded-md text-[10px] font-bold transition-all flex items-center justify-center gap-1 ${T==="vodafone_cash"?"bg-red-800 text-white shadow-sm":"text-gray-400 hover:text-white"}`,children:[s.jsx(ky,{className:"w-3 h-3"}),""]})]})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-400 mb-1 block text-right",children:T==="paid"?" ":T==="unpaid"?" ":" "}),s.jsxs("div",{className:"relative",children:[T==="unpaid"&&s.jsx("input",{type:"tel",inputMode:"decimal",value:L,onChange:fe=>$(fe.target.value),placeholder:"0.00",className:"w-full bg-[#111] border border-gray-600 rounded-lg py-1 px-2 text-white text-center font-mono font-bold text-base focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all h-[40px]",dir:"ltr",onFocus:st}),T==="paid"&&s.jsx("input",{type:"tel",inputMode:"decimal",value:E,onChange:fe=>S(fe.target.value),placeholder:"0.00",className:"w-full bg-[#111] border border-gray-600 rounded-lg py-1 px-2 text-white text-center font-mono font-bold text-base focus:border-green-500 focus:ring-1 focus:ring-green-500 outline-none transition-all h-[40px]",dir:"ltr",onFocus:st}),T==="vodafone_cash"&&s.jsx("input",{type:"tel",inputMode:"decimal",value:H,onChange:fe=>G(fe.target.value),placeholder:"0.00",className:"w-full bg-[#111] border border-gray-600 rounded-lg py-1 px-2 text-white text-center font-mono font-bold text-base focus:border-red-800 focus:ring-1 focus:ring-red-800 outline-none transition-all h-[40px]",dir:"ltr",onFocus:st})]})]}),s.jsxs("div",{className:"col-span-1",children:[s.jsx("label",{className:"text-[10px] font-bold text-yellow-500 mb-1 block text-right",children:" "}),s.jsx("div",{className:"relative",children:s.jsx("input",{type:"tel",inputMode:"decimal",value:z,onChange:fe=>P(fe.target.value),placeholder:"0",className:"w-full bg-[#111] border border-gray-600 rounded-lg py-1 px-2 text-yellow-500 text-center font-mono font-bold text-base focus:border-yellow-500 focus:ring-1 focus:ring-yellow-500 outline-none transition-all placeholder-gray-700 h-[40px]",dir:"ltr",onFocus:st})})]})]})}),s.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-700 to-transparent mb-4"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-xs font-bold text-gray-400 flex items-center gap-2 px-1 uppercase tracking-wider",children:[s.jsx(_t,{className:"w-4 h-4"}),"   ()"]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-4 text-gray-500 group-focus-within:text-red-500 transition-colors",children:s.jsx(zn,{className:"w-5 h-5"})}),s.jsx("input",{type:"tel",value:i.phone,onChange:fe=>o({...i,phone:fe.target.value}),placeholder:"  (11 )",className:"w-full bg-[#1f2937] border border-gray-700 rounded-xl py-4 pl-12 pr-4 text-white text-right placeholder:text-right focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all font-mono shadow-sm text-lg",dir:"rtl",maxLength:11,disabled:R==="saving",inputMode:"decimal"})]}),s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute top-4 left-4 text-gray-500 group-focus-within:text-red-500 transition-colors",children:s.jsx(fs,{className:"w-5 h-5"})}),s.jsx("textarea",{value:i.address,onChange:fe=>o({...i,address:fe.target.value}),placeholder:"  (   )...",className:"w-full bg-[#1f2937] border border-gray-700 rounded-xl py-3.5 pl-12 pr-4 text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all shadow-sm resize-none h-24 leading-relaxed",disabled:R==="saving"})]})]})]}),s.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-700 to-transparent"}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("h3",{className:"text-xs font-bold text-gray-400 flex items-center gap-2 px-1 uppercase tracking-wider",children:[s.jsx(dr,{className:"w-4 h-4"}),"  "]})}),s.jsxs("div",{className:"bg-[#1f2937] p-4 rounded-xl border border-gray-700 flex items-center justify-between shadow-sm",children:[s.jsx("span",{className:"text-sm text-gray-200 font-bold",children:"  "}),s.jsxs("div",{className:"flex items-center gap-3 bg-[#111] p-1.5 rounded-lg border border-gray-700 shadow-inner",children:[s.jsx("button",{onClick:ce,disabled:R==="saving",className:"w-9 h-9 flex items-center justify-center bg-gray-800 text-white rounded-md hover:bg-gray-700 active:scale-95 transition-all",children:s.jsx(Xj,{className:"w-4 h-4"})}),s.jsx("div",{className:"w-10 text-center",children:s.jsx("input",{type:"number",min:"1",max:"1000",value:p,onChange:he,onFocus:fe=>fe.target.select(),disabled:R==="saving",className:"w-full bg-transparent text-center font-black text-xl text-white outline-none border-none p-0 focus:ring-0 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})}),s.jsx("button",{onClick:re,disabled:R==="saving",className:"w-9 h-9 flex items-center justify-center bg-red-600 text-white rounded-md hover:bg-red-700 active:scale-95 transition-all shadow-lg shadow-red-900/20",children:s.jsx(hs,{className:"w-4 h-4"})})]})]}),s.jsx("div",{className:"relative group",children:s.jsx("textarea",{value:c,onChange:fe=>u(fe.target.value),placeholder:"   ()...",rows:3,className:"w-full bg-[#1f2937] border border-gray-700 rounded-xl p-4 text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all resize-none shadow-sm",disabled:R==="saving"})})]}),O&&s.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 p-4 rounded-xl text-center animate-fadeIn flex items-center justify-center gap-2",children:[s.jsx(ut,{className:"w-5 h-5 text-red-500"}),s.jsx("p",{className:"text-red-400 text-sm font-bold",children:O})]})]}),s.jsx("div",{className:"flex-none bg-[#1f2937] border-t border-gray-700 p-4 z-20 pb-6 sm:pb-4 shadow-[0_-5px_20px_rgba(0,0,0,0.3)]",children:s.jsx("button",{onClick:me,disabled:R==="saving",className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-bold py-4 rounded-xl shadow-lg shadow-red-900/30 active:scale-[0.98] transition-all flex items-center justify-center gap-2 disabled:bg-none disabled:bg-gray-700 disabled:text-gray-500 disabled:cursor-not-allowed disabled:shadow-none group",children:R==="saving"?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),s.jsxs("span",{children:["  (",M,"%)"]})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-lg",children:" "}),p>1&&s.jsxs("span",{className:"bg-white/20 px-2 py-0.5 rounded text-sm font-mono",children:["x",p]}),s.jsx(us,{className:"w-5 h-5 opacity-0 -translate-x-2 group-hover:opacity-100 group-hover:translate-x-0 transition-all duration-300"})]})})}),U&&s.jsxs("div",{className:"fixed inset-0 z-[120] bg-black/90 backdrop-blur-sm flex flex-col animate-fadeIn",children:[s.jsxs("div",{className:"flex-none p-4 pt-safe flex items-center gap-4 bg-[#1f2937] border-b border-gray-700 shadow-md z-30",children:[s.jsx("button",{onClick:Y,className:"bg-gray-800 hover:bg-gray-700 text-white p-2.5 rounded-full transition-colors active:scale-95",children:s.jsx(us,{className:"w-6 h-6 rotate-180"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-bold text-white",children:" "}),s.jsxs("p",{className:"text-xs text-gray-400",children:[Z.length,"  "]})]})]}),s.jsxs("div",{className:"flex-none bg-[#1f2937] p-4 pt-2 space-y-3 border-b border-gray-800 z-20",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"    ...",value:V,onChange:fe=>Q(fe.target.value),className:"w-full bg-[#111] border border-gray-700 rounded-xl py-3 pl-4 pr-11 text-white focus:ring-1 focus:ring-red-500 focus:border-red-500 placeholder-gray-500 shadow-inner outline-none transition-all",autoFocus:!0}),s.jsx(mr,{className:"absolute right-3.5 top-3.5 w-5 h-5 text-gray-500"})]}),s.jsx("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide pb-1",children:ge.map(fe=>s.jsx("button",{onClick:()=>X(fe),className:`px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-all border ${ae===fe?"bg-red-600 text-white border-red-600 shadow-md":"bg-gray-800 text-gray-400 border-gray-700 hover:border-gray-500"}`,children:fe==="all"?"":fe},fe))})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-[#111] custom-scrollbar",children:Z.length>0?s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:Z.map(fe=>s.jsxs("button",{onClick:()=>Oe(fe.id),className:`w-full flex items-center p-3 rounded-xl border transition-all active:scale-[0.98] ${h===fe.id?"bg-red-900/10 border-red-500 shadow-lg shadow-red-900/10 ring-1 ring-red-500/30":"bg-[#1e1e1e] border-gray-800 hover:border-gray-600 hover:bg-[#252525]"}`,children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center overflow-hidden border-2 shadow-sm ${h===fe.id?"border-red-500":"border-gray-700 bg-gray-800"}`,children:fe.storeImage?s.jsx("img",{src:fe.storeImage,alt:fe.name,className:"w-full h-full object-cover"}):s.jsx("span",{className:"text-lg font-bold text-gray-500",children:fe.name.charAt(0)})}),h===fe.id&&s.jsx("div",{className:"absolute -bottom-1 -right-1 bg-red-500 text-white rounded-full p-0.5 border-2 border-[#1e1e1e] shadow-sm animate-bounce",children:s.jsx(Je,{className:"w-3 h-3"})})]}),s.jsxs("div",{className:"mr-3 flex-1 text-right min-w-0",children:[s.jsx("div",{className:"flex justify-between items-start",children:s.jsx("p",{className:`font-bold text-sm truncate ${h===fe.id?"text-white":"text-gray-200"}`,children:fe.name})}),s.jsx("p",{className:"text-xs text-gray-500 font-mono mt-0.5",children:fe.phone}),s.jsx("div",{className:"flex items-center gap-2 mt-1.5",children:s.jsxs("span",{className:"text-[10px] bg-black/40 text-gray-400 px-2 py-0.5 rounded border border-gray-700 flex items-center gap-1",children:[Ue(fe.storeCategory||""),fe.storeCategory||" "]})})]})]},fe.id))}):s.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[s.jsx(Xl,{className:"w-16 h-16 mb-4 opacity-10"}),s.jsx("p",{className:"text-sm font-bold",children:"    "})]})})]})]})},kO=({activeView:n,onNavigate:e,availableViews:t,isVisible:r=!0,mode:i="dark"})=>{const o=[{id:"orders",label:"",icon:Zt,color:"rgb(239, 68, 68)"},{id:"users",label:"",icon:Md,color:"rgb(59, 130, 246)"},{id:"stores",label:"",icon:Ar,color:"rgb(168, 85, 247)"},{id:"special",label:" ",icon:en,color:"rgb(245, 158, 11)"},{id:"shopping",label:"",icon:Rr,color:"rgb(16, 185, 129)"},{id:"slider",label:"",icon:Qr,color:"rgb(236, 72, 153)"},{id:"wallet",label:"",icon:Ed,color:"rgb(34, 197, 94)"},{id:"games",label:"",icon:Ah,color:"rgb(99, 102, 241)"},{id:"settings",label:"",icon:$s,color:"rgb(107, 114, 128)"}],c=b=>{try{e(b)}catch(v){console.error("Navigation error:",v)}},u=t?o.filter(b=>t.includes(b.id)):o.filter(b=>["orders","users","special","shopping","wallet","settings"].includes(b.id)),h=i==="light",p=(u.find(b=>b.id===n)||u[0]).color||"rgb(239, 68, 68)";return s.jsx("div",{className:`fixed left-1/2 -translate-x-1/2 z-[60] transition-all duration-700 ease-[cubic-bezier(0.2,0,0,1)] ${r?"bottom-8 scale-100 opacity-100":"bottom-0 scale-90 opacity-0 pointer-events-none"}`,children:s.jsxs("nav",{className:`
                relative flex items-center p-1.5 sm:p-2 rounded-[24px] sm:rounded-[30px] border gap-1 sm:gap-2 max-w-[95vw] sm:max-w-none
                ${h?"bg-white/40 border-white/80 shadow-[0_20px_50px_rgba(0,0,0,0.05)]":"bg-black/40 border-white/10 shadow-[0_30px_70px_rgba(0,0,0,0.5)]"} backdrop-blur-3xl
            `,children:[s.jsx("div",{className:"absolute inset-x-0 bottom-0 h-px transition-all duration-700 opacity-50",style:{background:`linear-gradient(90deg, transparent, ${p}, transparent)`}}),u.map(b=>{const v=b.icon,_=n===b.id,T=b.color;return s.jsxs("button",{onClick:()=>c(b.id),className:`
                                relative flex items-center justify-center h-12 sm:h-14 rounded-[18px] sm:rounded-[22px] transition-all duration-700 group
                                ${_?"px-3 sm:px-6 bg-white/10":"px-2 sm:px-4 hover:bg-white/5"}
                            `,children:[_&&s.jsx("div",{className:"absolute -top-1 w-1 h-1 rounded-full animate-pulse transition-all duration-700",style:{backgroundColor:T,boxShadow:`0 0 10px ${T}`}}),s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2.5",children:[s.jsxs("div",{className:"relative",children:[s.jsx(v,{className:`
                                            w-5 h-5 sm:w-6 sm:h-6 transition-all duration-700
                                            ${_?"scale-110":"text-gray-500 grayscale opacity-60 group-hover:grayscale-0 group-hover:opacity-100"}
                                        `,style:{color:_?T:void 0}}),_&&s.jsx("div",{className:"absolute inset-0 blur-md opacity-40 animate-pulse pointer-events-none",style:{backgroundColor:T}})]}),_&&s.jsx("span",{className:"text-[10px] sm:text-[11px] font-black tracking-wide text-white whitespace-nowrap animate-fadeIn",children:b.label})]}),!_&&s.jsx("div",{className:"absolute inset-0 rounded-[18px] sm:rounded-[22px] transition-all duration-500 opacity-0 group-hover:opacity-10",style:{backgroundColor:T}})]},b.id)})]})})},g4=({status:n,icon:e,color:t,onClick:r,subLabel:i})=>s.jsxs("button",{type:"button",onClick:o=>{o.stopPropagation(),r()},className:`w-full text-right p-4 rounded-xl flex items-center space-x-4 space-x-reverse transition-all duration-200 border border-gray-700 bg-gray-900 active:bg-gray-800 group relative z-10 ${t}`,children:[s.jsx("div",{className:"p-3 bg-white/5 rounded-full group-active:bg-white/10 transition-colors pointer-events-none",children:e}),s.jsxs("div",{className:"pointer-events-none",children:[s.jsx("p",{className:"font-bold text-neutral-100 text-md",children:n}),s.jsx("p",{className:"text-xs text-neutral-400",children:i})]})]}),RO=({order:n,onClose:e,onSelectStatus:t,onTransferOrder:r})=>{sn(()=>(e(),!0),[e]);const i=n.type==="shopping_order",c=[{status:ue.WaitingMerchant,icon:i?s.jsx(en,{className:"w-6 h-6 text-purple-400"}):s.jsx(It,{className:"w-6 h-6 text-purple-400"}),color:"hover:border-purple-500/50",label:i?" ":ue.WaitingMerchant,sub:i?"    ":"  "},{status:ue.Preparing,icon:s.jsx(Si,{className:"w-6 h-6 text-orange-400"}),color:"hover:border-orange-500/50",label:i?" ":ue.Preparing,sub:i?"  / ":"  "},{status:ue.Pending,icon:s.jsx(Rr,{className:"w-6 h-6 text-yellow-400"}),color:"hover:border-yellow-500/50",label:i?" ":ue.Pending,sub:i?"    ":"  "},{status:ue.InTransit,icon:s.jsx(gO,{className:"w-6 h-6 text-sky-400"}),color:"hover:border-sky-500/50",label:ue.InTransit,sub:"  "},{status:ue.Delivered,icon:s.jsx(Je,{className:"w-6 h-6 text-green-400"}),color:"hover:border-green-500/50",label:ue.Delivered,sub:"   "},{status:ue.Cancelled,icon:s.jsx(ut,{className:"w-6 h-6 text-red-400"}),color:"hover:border-red-500/50",label:ue.Cancelled,sub:"  "}].filter(u=>u.status===n.status||n.status===ue.Pending&&u.status===ue.Delivered?!1:i?!0:u.status!==ue.WaitingMerchant&&u.status!==ue.Preparing);return Jh.createPortal(s.jsx("div",{className:"fixed inset-0 z-[99999] flex items-end sm:items-center justify-center p-0 sm:p-4",style:{backgroundColor:"rgba(0,0,0,0.85)",backdropFilter:"blur(2px)",touchAction:"none"},onClick:u=>{u.preventDefault(),u.stopPropagation(),e()},children:s.jsxs("div",{className:"bg-gray-800 w-full max-w-md rounded-t-2xl sm:rounded-2xl border border-gray-700 shadow-2xl relative flex flex-col max-h-[85vh] animate-sheet-up",onClick:u=>{u.stopPropagation()},children:[s.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-gray-900 rounded-t-2xl",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-neutral-100",children:"  "}),s.jsxs("p",{className:"font-mono text-xs text-red-400 mt-0.5 tracking-wider",children:[i?"  ":"  ","#",n.id]})]}),s.jsx("button",{type:"button",onClick:u=>{u.stopPropagation(),e()},className:"text-neutral-400 hover:text-white p-3 rounded-full bg-gray-800 hover:bg-gray-700 transition-colors",children:s.jsx(ut,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"p-5 overflow-y-auto space-y-4 bg-gray-800",children:[s.jsxs("div",{className:"flex justify-between items-center bg-black/20 p-3 rounded-lg border border-white/5",children:[s.jsx("p",{className:"text-sm text-neutral-400 font-medium",children:" :"}),s.jsx("span",{className:"font-bold text-white bg-gray-700 px-3 py-1 rounded-full text-xs border border-gray-600 shadow-sm",children:n.status})]}),n.status===ue.InTransit&&r&&s.jsxs("div",{className:"mb-2",children:[s.jsx(g4,{status:"   ",subLabel:"   ",icon:s.jsx(_t,{className:"w-6 h-6 text-indigo-400"}),color:"bg-indigo-900/10 border-indigo-500/30 hover:bg-indigo-900/20",onClick:()=>r(n)}),s.jsxs("div",{className:"flex items-center gap-2 my-4 opacity-50",children:[s.jsx("div",{className:"h-px bg-gray-600 flex-1"}),s.jsx("span",{className:"text-[10px] text-gray-400 font-bold",children:"  "}),s.jsx("div",{className:"h-px bg-gray-600 flex-1"})]})]}),s.jsx("div",{className:"space-y-3",children:c.map(u=>s.jsx(g4,{status:u.label,subLabel:u.sub,icon:u.icon,color:u.color,onClick:()=>t(n,u.status)},u.status))})]}),s.jsx("div",{className:"p-4 border-t border-gray-700 bg-gray-900 rounded-b-2xl",children:s.jsx("button",{type:"button",onClick:u=>{u.stopPropagation(),e()},className:"w-full py-3.5 rounded-xl bg-gray-800 text-gray-300 font-bold hover:bg-gray-700 transition-colors border border-gray-600 active:bg-gray-600",children:""})})]})}),document.body)},mb=({order:n,drivers:e,onClose:t,onSave:r,targetStatus:i})=>{const[o,c]=w.useState(""),[u,h]=w.useState(n.deliveryFee||""),[m,p]=w.useState(""),[b,v]=w.useState("");sn(()=>(t(),!0),[t]);const _="w-full px-4 py-4 border border-gray-600 bg-[#111] text-white rounded-xl shadow-inner focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-lg font-bold text-center font-mono",T=n.status===ue.InTransit&&i===ue.InTransit,k=T?"   ":i===ue.Delivered?"  ":"  ",E=T?" ":i===ue.Delivered?"  ":"  ",S=T?"bg-indigo-600 hover:bg-indigo-700":i===ue.Delivered?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700",L=w.useMemo(()=>e.filter(H=>H.name.toLowerCase().includes(m.toLowerCase())||H.phone&&H.phone.includes(m)),[e,m]),$=()=>{const H=u!==""?parseFloat(String(u)):void 0;if(!o||H===void 0||H<0){v("      .");return}v(""),r(o,H)};return Jh.createPortal(s.jsx("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center p-0 sm:p-4 bg-black/80 backdrop-blur-sm transition-all duration-300 animate-fadeIn",style:{touchAction:"none"},onClick:H=>{H.stopPropagation(),t()},children:s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-lg rounded-t-[2rem] sm:rounded-[2rem] border border-gray-700 shadow-2xl relative flex flex-col max-h-[85vh] animate-sheet-up overflow-hidden",onClick:H=>H.stopPropagation(),children:[s.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d] relative z-10",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`p-3 rounded-xl shadow-lg ${T?"bg-indigo-500/20 text-indigo-400":"bg-blue-500/20 text-blue-400"}`,children:s.jsx(Zt,{className:"w-6 h-6"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-white",children:k}),s.jsxs("p",{className:"font-mono text-xs text-gray-400 mt-0.5 tracking-wider",children:["ORDER #",n.id]})]})]}),s.jsx("button",{type:"button",onClick:t,className:"text-gray-400 hover:text-white p-2 rounded-full bg-gray-800 hover:bg-gray-700 transition-colors",children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto custom-scrollbar bg-[#1e293b] relative",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 uppercase tracking-wide",children:" "}),s.jsxs("div",{className:"bg-[#111] rounded-2xl border border-gray-700 overflow-hidden shadow-sm",children:[s.jsxs("div",{className:"relative border-b border-gray-700",children:[s.jsx(mr,{className:"absolute top-1/2 right-4 transform -translate-y-1/2 w-5 h-5 text-gray-500"}),s.jsx("input",{type:"text",placeholder:"   ...",value:m,onChange:H=>p(H.target.value),className:"w-full pr-12 pl-4 py-4 bg-[#111] text-white placeholder:text-gray-600 focus:outline-none transition-colors text-sm"})]}),s.jsxs("div",{className:"max-h-48 overflow-y-auto p-2 space-y-1 custom-scrollbar",children:[L.map(H=>s.jsxs("button",{type:"button",onClick:()=>c(H.id),className:`w-full flex justify-between items-center text-right p-3 rounded-xl transition-all duration-200 border ${o===H.id?"bg-blue-600 text-white border-blue-500 shadow-md transform scale-[1.02]":"bg-transparent border-transparent text-gray-300 hover:bg-gray-800"}`,children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-bold block text-sm",children:H.name}),s.jsxs("span",{className:`text-xs font-mono flex items-center gap-1 mt-0.5 ${o===H.id?"text-blue-200":"text-gray-500"}`,children:[s.jsx(zn,{className:"w-3 h-3"}),H.phone]})]}),o===H.id&&s.jsx(Je,{className:"w-5 h-5 text-white"})]},H.id)),L.length===0&&s.jsx("div",{className:"text-center py-6 text-gray-500 text-sm",children:"   "})]})]})]}),s.jsxs("div",{className:"bg-[#151e2d] p-4 rounded-2xl border border-gray-700",children:[s.jsx("label",{htmlFor:"deliveryFee",className:"block text-xs font-bold text-gray-400 mb-3 text-center uppercase tracking-wide",children:T?"  ()":"  "}),s.jsxs("div",{className:"relative max-w-[200px] mx-auto",children:[s.jsx("input",{type:"number",id:"deliveryFee",value:u,onChange:H=>h(H.target.value),placeholder:"0",className:_}),s.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-bold text-sm pointer-events-none",children:"."})]})]}),b&&s.jsx("div",{className:"text-red-400 text-xs font-bold bg-red-900/20 p-3 rounded-xl border border-red-500/30 text-center animate-bounce",children:b})]}),s.jsx("div",{className:"p-5 bg-[#151e2d] border-t border-gray-700 relative z-10",children:s.jsx("button",{type:"button",onClick:$,className:`w-full py-4 text-base font-bold text-white rounded-xl shadow-lg shadow-black/20 transition-all active:scale-[0.98] flex justify-center items-center gap-2 ${S}`,children:E})})]})}),document.body)},Pee=({users:n,onClose:e,onSelect:t,title:r})=>{const[i,o]=w.useState(""),[c,u]=w.useState(7),h=w.useMemo(()=>{const p=i.toLowerCase();return n.filter(b=>{const v=b.role==="driver"?"":b.role==="merchant"?"":b.role==="admin"?"":"";return b.name.toLowerCase().includes(p)||b.phone&&b.phone.includes(p)||v.includes(p)})},[n,i]),m=[{label:"24 ",value:1},{label:"3 ",value:3},{label:"",value:7},{label:"",value:30},{label:"",value:null}];return s.jsx("div",{className:"fixed inset-0 z-[80] bg-black/90 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-2xl border border-gray-700 shadow-2xl flex flex-col max-h-[85vh]",onClick:p=>p.stopPropagation(),children:[s.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-[#151e2d] rounded-t-2xl",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[s.jsx(Ju,{className:"w-5 h-5 text-yellow-400"}),r]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-4 border-b border-gray-700/50 space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"text-xs font-bold text-gray-400 mb-2 flex items-center gap-1",children:[s.jsx(It,{className:"w-3 h-3"}),"  ( )"]}),s.jsx("div",{className:"flex bg-[#0f172a] p-1 rounded-xl border border-gray-600 overflow-x-auto scrollbar-hide",children:m.map(p=>s.jsx("button",{onClick:()=>u(p.value),className:`flex-1 min-w-[60px] py-2 text-[10px] font-bold rounded-lg transition-all whitespace-nowrap ${c===p.value?"bg-blue-600 text-white shadow-md":"text-gray-400 hover:text-white"}`,children:p.label},p.label))})]}),s.jsxs("div",{className:"relative",children:[s.jsx(mr,{className:"absolute right-3 top-2.5 w-4 h-4 text-gray-500"}),s.jsx("input",{type:"text",placeholder:"   ...",value:i,onChange:p=>o(p.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-2 pl-4 pr-10 text-white text-sm focus:border-blue-500 outline-none",autoFocus:!0})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-2 custom-scrollbar",children:h.length>0?h.map(p=>s.jsxs("button",{onClick:()=>t(p,c),className:"w-full flex items-center justify-between p-3 hover:bg-gray-700/50 rounded-xl transition-colors border-b border-gray-700/30 last:border-0 group",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border border-gray-600",children:p.storeImage?s.jsx("img",{src:p.storeImage,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-5 h-5 text-gray-400"})}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm font-bold text-white group-hover:text-yellow-400 transition-colors",children:p.name}),s.jsxs("p",{className:"text-[10px] text-gray-500 flex items-center gap-1",children:[s.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${p.role==="driver"?"bg-orange-500":p.role==="merchant"?"bg-purple-500":p.role==="admin"?"bg-red-500":"bg-blue-500"}`}),p.role==="driver"?"":p.role==="merchant"?"":p.role==="admin"?"":""]})]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-1",children:[s.jsx("div",{className:"bg-blue-600 text-white px-3 py-1 rounded-lg text-xs font-bold shadow-lg shadow-blue-900/20",children:""}),c&&s.jsxs("span",{className:"text-[9px] text-gray-400",children:[c," "]})]})]},p.id)):s.jsx("p",{className:"text-center text-gray-500 py-8 text-sm",children:"  "})})]})})},tx={All:({className:n})=>s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[s.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),s.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),s.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),s.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),Restaurant:({className:n})=>s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[s.jsx("path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"}),s.jsx("path",{d:"M7 2v20"}),s.jsx("path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"})]}),Market:({className:n})=>s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[s.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),s.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),Pharmacy:({className:n})=>s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[s.jsx("path",{d:"M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8z"}),s.jsx("path",{d:"M12 7v10"}),s.jsx("path",{d:"M7 12h10"})]})},DO=({onClose:n,currentTheme:e,onUpdateTheme:t,appConfig:r,onUpdateAppConfig:i,users:o,onUpdateUser:c,sendNotification:u,currentUser:h})=>{const[m,p]=w.useState("main"),[b,v]=w.useState("frames"),[_,T]=w.useState(!1),[k,E]=w.useState(!1),[S,L]=w.useState(!1),[$,H]=w.useState(""),[G,z]=w.useState(null),[P,j]=w.useState("frame"),[O,I]=w.useState(!1),[R,F]=w.useState(null),[M,ne]=w.useState(""),[U,A]=w.useState(!1),[V,Q]=w.useState([]),[ae,X]=w.useState(r==null?void 0:r.customFont),[B,Y]=w.useState(null),ge=w.useRef(null),Z=w.useRef(null),te=w.useRef(null),[me,re]=w.useState(null),[ce,he]=w.useState(null);sn(()=>O?(I(!1),!0):B!=null&&B.isOpen?(Y(null),!0):k?(E(!1),!0):S?(L(!1),!0):m!=="main"?(p("main"),!0):(n(),!0),[m,k,B,S,O]),w.useEffect(()=>{X(r==null?void 0:r.customFont)},[r==null?void 0:r.customFont]),w.useEffect(()=>{var ve;(ve=e.customer)!=null&&ve.categories&&e.customer.categories.length>0?Q(e.customer.categories):Q([{id:"all",key:"cat_all",label:"",isVisible:!0,sortOrder:0},{id:"restaurant",key:"cat_restaurant",label:"",isVisible:!0,sortOrder:1},{id:"market",key:"cat_market",label:"",isVisible:!0,sortOrder:2},{id:"pharmacy",key:"cat_pharmacy",label:"",isVisible:!0,sortOrder:3}])},[e]);const Oe=(ve,Ge)=>{const dt={...e[ve]||{icons:{},splash:{},layout:{}},...Ge};t(ve,dt),T(!0),setTimeout(()=>T(!1),1500)},Ue=ve=>{var We;re(ve);const Ge=V.find(dt=>dt.id===ve);he((Ge==null?void 0:Ge.icon)||null),(We=ge.current)==null||We.click()},st=ve=>new Promise((Ge,We)=>{const dt=new FileReader;dt.onload=Ve=>{var tt;const $e=new Image;$e.src=(tt=Ve.target)==null?void 0:tt.result,$e.onload=()=>{const rt=document.createElement("canvas"),ft=128;rt.width=ft,rt.height=ft;const $t=rt.getContext("2d");if(!$t){We("Canvas error");return}const Dn=Math.min(ft/$e.width,ft/$e.height),Zn=ft/2-$e.width/2*Dn,Ii=ft/2-$e.height/2*Dn;$t.drawImage($e,Zn,Ii,$e.width*Dn,$e.height*Dn),Ge(rt.toDataURL("image/png"))},$e.onerror=We},dt.onerror=We,dt.readAsDataURL(ve)}),fe=async ve=>{var We;const Ge=(We=ve.target.files)==null?void 0:We[0];if(Ge&&me){A(!0);try{const dt=await st(Ge),Ve=V.map($e=>$e.id===me?{...$e,icon:dt}:$e);Q(Ve),Oe("customer",{categories:Ve}),he(dt)}catch(dt){console.error("Error processing icon:",dt),alert("    ")}finally{A(!1)}}ge.current&&(ge.current.value="")},K=async ve=>{var We;const Ge=(We=ve.target.files)==null?void 0:We[0];if(Ge){if(!Ge.name.endsWith(".ttf")){alert("       .ttf");return}A(!0);const dt=new FileReader;dt.onload=Ve=>{var tt;const $e=(tt=Ve.target)==null?void 0:tt.result;X($e),i&&r&&(i({...r,customFont:$e}),T(!0),setTimeout(()=>T(!1),2e3)),A(!1)},dt.onerror=()=>{A(!1),alert("   ")},dt.readAsDataURL(Ge)}te.current&&(te.current.value="")},ie=()=>{Y({isOpen:!0,title:"  ",message:"         ",variant:"danger",onConfirm:()=>{X(void 0),i&&r&&(i({...r,customFont:""}),T(!0),setTimeout(()=>T(!1),2e3)),Y(null)}})},J=ve=>{var We;const Ge=(We=ve.target.files)==null?void 0:We[0];if(Ge){if(!Ge.type.includes("png")&&!Ge.type.includes("gif")){alert("    PNG  GIF");return}const dt=new FileReader;dt.onload=Ve=>{var $e;z(($e=Ve.target)==null?void 0:$e.result)},dt.readAsDataURL(Ge)}Z.current&&(Z.current.value="")},le=()=>{if(!$||!G)return;const Ge={id:`${P}_${Date.now()}`,label:$,url:G,type:P},dt=[...P==="frame"?e.customer.customFrames||[]:e.customer.customBadges||[],Ge];Oe("customer",P==="frame"?{customFrames:dt}:{customBadges:dt}),H(""),z(null),L(!1)},ee=(ve,Ge)=>{Y({isOpen:!0,title:` ${Ge==="frame"?"":""}`,message:"    ",variant:"danger",onConfirm:()=>{const dt=(Ge==="frame"?e.customer.customFrames||[]:e.customer.customBadges||[]).filter(Ve=>Ve.id!==ve);Oe("customer",Ge==="frame"?{customFrames:dt}:{customBadges:dt}),Y(null)}})},we=ve=>{F(ve),I(!0)},pe=(ve,Ge)=>{if(!R)return;const We={},dt=R.type==="frame"?"":"";let Ve=null;if(Ge){const rt=new Date;rt.setDate(rt.getDate()+Ge),Ve=rt.toISOString()}R.type==="frame"?(We.specialFrame=R.url,We.specialFrameExpiry=Ve):(We.specialBadge=R.url,We.specialBadgeExpiry=Ve),c(ve.id,We);const $e=Ge?` ${Ge} `:" ",tt=`!   ${dt}  (${R.label}) ${$e}.     !`;u(ve.role,{title:" ! ",body:tt,targetId:ve.id,url:"/?target=profile"}),I(!1),F(null),T(!0),setTimeout(()=>T(!1),2e3)},ye=()=>{if(!M.trim())return;const ve=`cat_${Date.now()}`,Ge={id:ve,key:ve,label:M,isVisible:!0,sortOrder:V.length},We=[...V,Ge];Q(We),Oe("customer",{categories:We}),ne(""),E(!1)},Ae=ve=>{Y({isOpen:!0,title:" ",message:"      ",variant:"danger",onConfirm:()=>{const Ge=V.filter(We=>We.id!==ve);Q(Ge),Oe("customer",{categories:Ge}),Y(null)}})},xe=ve=>{const Ge=V.map(We=>We.id===ve?{...We,isVisible:!We.isVisible}:We);Q(Ge),Oe("customer",{categories:Ge})},Pe=ve=>{Y({isOpen:!0,title:" ",message:"      ",variant:"primary",onConfirm:()=>{const Ge=V.map(We=>We.id===ve?{...We,icon:void 0}:We);Q(Ge),Oe("customer",{categories:Ge}),Y(null)}})},gt=(ve,Ge)=>{const We=V.map(dt=>dt.id===ve?{...dt,label:Ge}:dt);Q(We)},Ee=()=>{Oe("customer",{categories:V})},Be=w.useMemo(()=>o.filter(ve=>ve.specialFrame||ve.specialBadge),[o]),ht=(ve,Ge)=>{Y({isOpen:!0,title:` ${Ge==="frame"?"":""}`,message:`     ${Ge==="frame"?"":""}  ${ve.name}`,variant:"danger",onConfirm:()=>{const We={};Ge==="frame"?(We.specialFrame=null,We.specialFrameExpiry=null):(We.specialBadge=null,We.specialBadgeExpiry=null),c(ve.id,We),Y(null)}})},Me=e.customer.customFrames||[],at=[...Object.entries(kh).map(([ve,Ge])=>({id:ve,label:Ge.name,url:ve,type:"frame",isSystem:!0})),...Me],yt=e.customer.customBadges||[],St=()=>{switch(m){case"categories":return" ";case"decorations":return" ";case"active_gifts":return"  ";default:return" "}};return h==null||h.role,s.jsxs("div",{className:"fixed inset-0 z-[60] bg-[#0f172a] text-white flex flex-col overflow-hidden animate-fadeIn",children:[_&&s.jsx("div",{className:"absolute inset-0 z-[70] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-fadeIn",children:s.jsxs("div",{className:"bg-green-600 px-6 py-3 rounded-full shadow-2xl flex items-center gap-2 animate-bounce",children:[s.jsx(Je,{className:"w-6 h-6 text-white"}),s.jsx("span",{className:"font-bold text-white",children:"  "})]})}),s.jsx("div",{className:"flex-none px-4 pt-safe h-16 box-content flex items-center justify-between border-b border-gray-800 bg-[#1e293b]/90 backdrop-blur-md sticky top-0 z-20 shadow-md",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:m==="main"?n:()=>p("main"),className:"p-2 rounded-full bg-gray-800 hover:bg-gray-700 transition-colors border border-gray-700",children:s.jsx(us,{className:"w-6 h-6 rotate-180"})}),s.jsx("h1",{className:"text-xl font-black tracking-wide",children:St()})]})}),s.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[s.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-blue-600/5 rounded-full blur-[120px] pointer-events-none translate-x-1/2 -translate-y-1/2"}),m==="main"&&s.jsx("div",{className:"h-full overflow-y-auto custom-scrollbar",children:s.jsxs("div",{className:"max-w-5xl mx-auto w-full p-6 flex flex-col gap-8 min-h-full",children:[s.jsxs("div",{className:"bg-[#1e293b]/80 backdrop-blur-sm rounded-[2rem] p-6 border border-gray-700 shadow-xl relative overflow-hidden group",children:[s.jsx("div",{className:"absolute top-0 left-0 w-1.5 h-full bg-blue-500"}),s.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start md:items-center",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx(Ag,{className:"w-6 h-6 text-blue-400"})," "]}),ae&&s.jsxs("span",{className:"bg-green-500/20 text-green-400 text-[10px] font-bold px-2 py-1 rounded-full border border-green-500/20 flex items-center gap-1",children:[s.jsx(Je,{className:"w-3 h-3"})," "]})]}),s.jsxs("p",{className:"text-gray-400 text-sm leading-relaxed",children:["     ",s.jsx("code",{children:".ttf"}),"        ."]})]}),s.jsxs("div",{className:"flex gap-3 w-full md:w-auto",children:[s.jsx("button",{onClick:()=>{var ve;return(ve=te.current)==null?void 0:ve.click()},disabled:U,className:"flex-1 md:flex-none bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg active:scale-95 transition-all flex justify-center items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed min-w-[160px]",children:U?s.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx(Zr,{className:"w-5 h-5"}),s.jsx("span",{children:"  (.ttf)"})]})}),ae&&s.jsx("button",{onClick:ie,className:"px-4 bg-red-500/10 hover:bg-red-500/20 text-red-400 font-bold py-3 rounded-xl transition-colors border border-red-500/20",title:"  ",children:s.jsx(Tt,{className:"w-5 h-5"})})]}),s.jsx("input",{type:"file",ref:te,accept:".ttf",className:"hidden",onChange:K})]})]}),s.jsxs("div",{children:[s.jsxs("h2",{className:"text-lg font-bold text-gray-400 mb-4 px-2 flex items-center gap-2",children:[s.jsx(Jj,{className:"w-5 h-5"})," "]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[s.jsxs("button",{onClick:()=>p("categories"),className:"group relative overflow-hidden bg-gradient-to-br from-cyan-900 to-blue-900 rounded-[2rem] p-8 flex items-center justify-between shadow-lg hover:shadow-cyan-500/20 transition-all active:scale-98 border border-white/5 h-40",children:[s.jsxs("div",{className:"z-10 text-right",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:translate-x-1 transition-transform",children:" "}),s.jsx("p",{className:"text-cyan-200 text-sm font-medium",children:"   "})]}),s.jsx("div",{className:"w-16 h-16 bg-white/10 rounded-2xl flex items-center justify-center z-10 backdrop-blur-sm border border-white/10 group-hover:scale-110 transition-transform duration-500",children:s.jsx(ks,{className:"w-8 h-8 text-cyan-300"})}),s.jsx("div",{className:"absolute -bottom-10 -left-10 w-40 h-40 bg-cyan-500/20 rounded-full blur-[50px] group-hover:bg-cyan-400/30 transition-colors"})]}),s.jsxs("button",{onClick:()=>p("decorations"),className:"group relative overflow-hidden bg-gradient-to-br from-purple-900 to-pink-900 rounded-[2rem] p-8 flex items-center justify-between shadow-lg hover:shadow-purple-500/20 transition-all active:scale-98 border border-white/5 h-40",children:[s.jsxs("div",{className:"z-10 text-right",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:translate-x-1 transition-transform",children:" "}),s.jsx("p",{className:"text-purple-200 text-sm font-medium",children:"   "})]}),s.jsx("div",{className:"w-16 h-16 bg-white/10 rounded-2xl flex items-center justify-center z-10 backdrop-blur-sm border border-white/10 group-hover:scale-110 transition-transform duration-500",children:s.jsx(Xi,{className:"w-8 h-8 text-purple-300"})}),s.jsx("div",{className:"absolute -bottom-10 -left-10 w-40 h-40 bg-purple-500/20 rounded-full blur-[50px] group-hover:bg-purple-400/30 transition-colors"})]}),s.jsxs("button",{onClick:()=>p("active_gifts"),className:"group relative overflow-hidden bg-gradient-to-br from-gray-800 to-gray-900 rounded-[2rem] p-8 flex items-center justify-between shadow-lg hover:shadow-gray-500/20 transition-all active:scale-98 border border-white/5 h-40 md:col-span-2",children:[s.jsxs("div",{className:"z-10 text-right",children:[s.jsx("h3",{className:"text-2xl font-black text-white mb-2 group-hover:translate-x-1 transition-transform",children:"  "}),s.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"   "})]}),s.jsx("div",{className:"w-16 h-16 bg-white/10 rounded-2xl flex items-center justify-center z-10 backdrop-blur-sm border border-white/10 group-hover:scale-110 transition-transform duration-500",children:s.jsx(dr,{className:"w-8 h-8 text-white"})})]})]})]})]})}),m==="active_gifts"&&s.jsx("div",{className:"h-full overflow-y-auto custom-scrollbar p-6 bg-[#0f172a]",children:s.jsx("div",{className:"max-w-4xl mx-auto space-y-4",children:Be.length===0?s.jsxs("div",{className:"text-center py-20 text-gray-500 bg-gray-800/30 rounded-3xl border border-dashed border-gray-700",children:[s.jsx(Ju,{className:"w-16 h-16 mx-auto mb-4 opacity-30"}),s.jsx("p",{className:"font-bold",children:"   "})]}):s.jsx("div",{className:"grid gap-4",children:Be.map(ve=>{const Ge=ve.specialFrameExpiry?new Date(ve.specialFrameExpiry):null,We=ve.specialBadgeExpiry?new Date(ve.specialBadgeExpiry):null,dt=new Date,Ve=$e=>{if(!$e)return"";const tt=$e.getTime()-dt.getTime(),rt=Math.ceil(tt/(1e3*60*60*24));return rt>0?` ${rt} `:""};return s.jsxs("div",{className:"bg-[#1e293b] p-4 rounded-2xl border border-gray-700 shadow-md flex flex-col md:flex-row items-center justify-between gap-4",children:[s.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border border-gray-600",children:ve.storeImage?s.jsx("img",{src:ve.storeImage,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-6 h-6 text-gray-400"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-white text-lg",children:ve.name}),s.jsx("p",{className:"text-gray-400 text-xs font-mono",children:ve.phone})]})]}),s.jsxs("div",{className:"flex flex-col md:flex-row gap-4 w-full md:w-auto",children:[ve.specialFrame&&s.jsxs("div",{className:"bg-black/20 p-3 rounded-xl border border-white/5 flex items-center gap-3 flex-1",children:[s.jsx("div",{className:"w-12 h-12 flex items-center justify-center relative",children:kh[ve.specialFrame]?s.jsx(Ji,{frameId:ve.specialFrame,size:"sm",className:"scale-90",children:s.jsx("div",{className:"w-full h-full bg-gray-800 flex items-center justify-center text-gray-500 rounded-full",children:s.jsx(_t,{className:"w-4 h-4"})})}):s.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center overflow-hidden border border-gray-600",children:ve.specialFrame.startsWith("http")||ve.specialFrame.startsWith("data:")?s.jsx("img",{src:ve.specialFrame,className:"w-full h-full object-cover"}):s.jsx("span",{className:"text-[10px]",children:""})})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs text-gray-300 font-bold",children:" "}),s.jsx("p",{className:"text-[10px] text-yellow-500",children:Ve(Ge)})]}),s.jsx("button",{onClick:()=>ht(ve,"frame"),className:"text-red-400 hover:bg-red-500/10 p-2 rounded-lg transition-colors",children:s.jsx(Tt,{className:"w-4 h-4"})})]}),ve.specialBadge&&s.jsxs("div",{className:"bg-black/20 p-3 rounded-xl border border-white/5 flex items-center gap-3 flex-1",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center overflow-hidden",children:ve.specialBadge.startsWith("http")||ve.specialBadge.startsWith("data:")?s.jsx("img",{src:ve.specialBadge,className:"w-full h-full object-cover"}):s.jsx("span",{className:"text-[10px]",children:""})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs text-gray-300 font-bold",children:""}),s.jsx("p",{className:"text-[10px] text-blue-400",children:Ve(We)})]}),s.jsx("button",{onClick:()=>ht(ve,"badge"),className:"text-red-400 hover:bg-red-500/10 p-2 rounded-lg transition-colors",children:s.jsx(Tt,{className:"w-4 h-4"})})]})]})]},ve.id)})})})}),m==="decorations"&&s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("div",{className:"flex border-b border-gray-800 bg-[#151e2d] z-10 shadow-sm flex-none",children:[s.jsxs("button",{onClick:()=>v("frames"),className:`flex-1 py-4 font-bold text-sm transition-colors relative ${b==="frames"?"text-white":"text-gray-500 hover:text-gray-300"}`,children:[" (Frames)",b==="frames"&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-purple-500"})]}),s.jsxs("button",{onClick:()=>v("badges"),className:`flex-1 py-4 font-bold text-sm transition-colors relative ${b==="badges"?"text-white":"text-gray-500 hover:text-gray-300"}`,children:[" (Badges)",b==="badges"&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-500"})]})]}),s.jsxs("div",{className:"flex-none p-4 bg-[#1a1a1a] border-b border-gray-800 flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h3",{className:`font-bold text-lg ${b==="frames"?"text-purple-400":"text-blue-400"}`,children:b==="frames"?" ":" "}),s.jsx("p",{className:"text-xs text-gray-400",children:b==="frames"?" GIF  PNG .":"   ."})]}),s.jsxs("button",{onClick:()=>{j(b==="frames"?"frame":"badge"),L(!0)},className:`px-4 py-2 rounded-xl text-sm font-bold flex items-center gap-2 transition-colors shadow-lg active:scale-95 ${b==="frames"?"bg-purple-600 hover:bg-purple-700 text-white shadow-purple-900/20":"bg-blue-600 hover:bg-blue-700 text-white shadow-blue-900/20"}`,children:[s.jsx(hs,{className:"w-4 h-4"}),"  "]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar bg-[#0f172a]",children:b==="frames"?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 pb-10",children:at.length>0?at.map(ve=>s.jsxs("div",{className:"bg-[#1e293b] p-4 rounded-xl border border-gray-700 flex flex-col items-center gap-3 relative group hover:border-purple-500 transition-colors shadow-sm",children:[s.jsx("div",{className:"relative w-24 h-24 flex items-center justify-center",children:ve.isSystem?s.jsx(Ji,{frameId:ve.url,size:"lg",className:"scale-90",children:s.jsx("div",{className:"w-full h-full bg-gray-700 flex items-center justify-center text-gray-500",children:s.jsx(_t,{className:"w-8 h-8"})})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"absolute inset-0 m-auto w-20 h-20 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border-2 border-gray-600",children:s.jsx(_t,{className:"w-10 h-10 text-gray-500"})}),s.jsx("img",{src:ve.url,className:"absolute inset-0 w-full h-full object-contain pointer-events-none z-10",alt:ve.label})]})}),s.jsx("div",{className:"text-center w-full",children:s.jsx("p",{className:"font-bold text-sm truncate w-full text-gray-200",children:ve.label})}),s.jsxs("div",{className:"flex gap-2 w-full justify-center",children:[s.jsxs("button",{onClick:()=>we(ve),className:"px-3 py-1.5 bg-yellow-500/10 text-yellow-400 rounded-lg text-xs font-bold hover:bg-yellow-500/20 transition-colors flex items-center gap-1",children:[s.jsx(Ju,{className:"w-3 h-3"})," "]}),(h==null?void 0:h.role)==="admin"&&!ve.isSystem&&s.jsx("button",{onClick:()=>ee(ve.id,"frame"),className:"p-1.5 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500/20 transition-colors",title:"  ",children:s.jsx(Tt,{className:"w-4 h-4"})})]})]},ve.id)):s.jsxs("div",{className:"col-span-full py-20 text-center text-gray-500 border-2 border-dashed border-gray-800 rounded-2xl",children:[s.jsx(Qr,{className:"w-12 h-12 mx-auto mb-2 opacity-30"}),s.jsx("p",{className:"font-bold",children:" "}),s.jsx("p",{className:"text-xs",children:"    "})]})}):s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3 pb-10",children:yt.length>0?yt.map(ve=>s.jsxs("div",{className:"bg-[#1e293b] p-3 rounded-2xl border border-gray-700 flex flex-col items-center gap-3 relative group hover:border-blue-500 transition-colors shadow-sm",children:[s.jsxs("div",{className:"w-20 h-20 bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl flex items-center justify-center border border-gray-600 shadow-inner relative overflow-hidden group-hover:border-blue-500 transition-colors",children:[s.jsx("div",{className:"absolute inset-0 bg-blue-500/5 opacity-0 group-hover:opacity-100 transition-opacity"}),s.jsx("img",{src:ve.url,className:"w-full h-full object-contain p-3 drop-shadow-md",alt:ve.label})]}),s.jsx("p",{className:"font-bold text-xs truncate w-full text-center text-gray-200",children:ve.label}),s.jsxs("div",{className:"flex gap-2 w-full justify-center mt-auto",children:[s.jsx("button",{onClick:()=>we(ve),className:"px-3 py-1.5 bg-yellow-500/10 text-yellow-400 rounded-lg text-xs font-bold hover:bg-yellow-500/20 transition-colors flex-1 flex items-center justify-center gap-1",title:"",children:s.jsx(Ju,{className:"w-3 h-3"})}),(h==null?void 0:h.role)==="admin"&&s.jsx("button",{onClick:()=>ee(ve.id,"badge"),className:"p-1.5 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500/20 transition-colors",title:"  ",children:s.jsx(Tt,{className:"w-3 h-3"})})]})]},ve.id)):s.jsxs("div",{className:"col-span-full py-20 text-center text-gray-500 border-2 border-dashed border-gray-800 rounded-2xl",children:[s.jsx(Xi,{className:"w-12 h-12 mx-auto mb-2 opacity-30"}),s.jsx("p",{className:"font-bold",children:" "}),s.jsx("p",{className:"text-xs",children:"   "})]})})})]}),m==="categories"&&s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("div",{className:"flex-none p-6 border-b border-gray-800 bg-[#1a1a1a] flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-lg text-white",children:" "}),s.jsx("p",{className:"text-xs text-gray-400",children:"     "})]}),s.jsxs("button",{onClick:()=>E(!0),className:"bg-cyan-600 hover:bg-cyan-700 text-white px-4 py-2 rounded-xl text-sm font-bold flex items-center gap-2 transition-colors shadow-lg shadow-cyan-900/20 active:scale-95",children:[s.jsx(hs,{className:"w-4 h-4"}),"  "]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-[#0f172a] custom-scrollbar",children:s.jsx("div",{className:"grid gap-3 max-w-4xl mx-auto pb-10",children:V.map((ve,Ge)=>{const We=ve.key==="cat_all"?tx.All:ve.key==="cat_restaurant"?tx.Restaurant:ve.key==="cat_market"?tx.Market:ve.key==="cat_pharmacy"?tx.Pharmacy:ks;return s.jsxs("div",{className:"bg-[#1e293b] p-3 rounded-2xl border border-gray-700 flex items-center gap-4 group hover:border-gray-500 transition-colors shadow-sm",children:[s.jsxs("div",{onClick:()=>Ue(ve.id),className:"w-14 h-14 bg-[#0f172a] rounded-xl flex items-center justify-center cursor-pointer border border-gray-600 hover:border-blue-500 relative overflow-hidden flex-shrink-0 shadow-inner group-hover:scale-105 transition-transform",children:[U&&me===ve.id?s.jsx("div",{className:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}):ve.icon?s.jsx("img",{src:ve.icon,alt:ve.label,className:"w-full h-full object-contain p-3"}):s.jsx(We,{className:"w-6 h-6 text-gray-500"}),s.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center transition-opacity backdrop-blur-[1px]",children:s.jsx(Js,{className:"w-4 h-4 text-white"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("input",{type:"text",value:ve.label,onChange:dt=>gt(ve.id,dt.target.value),onBlur:Ee,className:"w-full bg-transparent text-white font-bold text-lg outline-none border-b border-transparent focus:border-blue-500 pb-1 transition-colors"}),s.jsxs("p",{className:"text-[10px] text-gray-500 truncate font-mono mt-1 opacity-60",children:["ID: ",ve.key]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[ve.icon&&s.jsx("button",{onClick:()=>Pe(ve.id),className:"p-2.5 rounded-xl text-yellow-400 bg-yellow-400/10 hover:bg-yellow-400/20 transition-colors border border-yellow-400/20",title:" ",children:s.jsx(Ml,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>xe(ve.id),className:`p-2.5 rounded-xl transition-colors border ${ve.isVisible?"text-green-400 bg-green-400/10 border-green-400/20":"text-gray-500 bg-gray-800 border-gray-700"}`,title:ve.isVisible?"":"",children:ve.isVisible?s.jsx(Yi,{className:"w-4 h-4"}):s.jsx(Io,{className:"w-4 h-4"})}),ve.id!=="all"&&s.jsx("button",{onClick:()=>Ae(ve.id),className:"p-2.5 rounded-xl text-red-400 bg-red-400/10 hover:bg-red-400/20 transition-colors border border-red-400/20",title:"",children:s.jsx(Tt,{className:"w-4 h-4"})})]})]},ve.id)})})})]})]}),S&&s.jsx("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>L(!1),children:s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-3xl border border-gray-700 shadow-2xl p-6 animate-pop-in",onClick:ve=>ve.stopPropagation(),children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2",children:[s.jsx(Zr,{className:"w-6 h-6 text-green-500"}),P==="frame"?"  ":"  "]}),s.jsxs("div",{className:"space-y-5",children:[s.jsx("div",{onClick:()=>{var ve;return(ve=Z.current)==null?void 0:ve.click()},className:`w-full h-40 bg-[#0f172a] border-2 border-dashed ${G?"border-green-500":"border-gray-600"} rounded-2xl flex flex-col items-center justify-center cursor-pointer hover:bg-gray-800 transition-colors group relative overflow-hidden`,children:G?s.jsx("img",{src:G,alt:"Preview",className:"h-full object-contain p-4 animate-fadeIn"}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-12 h-12 bg-gray-800 rounded-full flex items-center justify-center mb-2 group-hover:scale-110 transition-transform",children:s.jsx(Qr,{className:"w-6 h-6 text-gray-500 group-hover:text-white"})}),s.jsx("span",{className:"text-xs text-gray-400 font-medium",children:"   (PNG/GIF)"})]})}),s.jsx("input",{ref:Z,type:"file",accept:"image/png, image/gif",className:"hidden",onChange:J}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2",children:" / "}),s.jsx("input",{type:"text",value:$,onChange:ve=>H(ve.target.value),placeholder:P==="frame"?":   ":":   ",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3.5 text-white focus:border-green-500 outline-none transition-colors"})]}),s.jsx("button",{onClick:le,disabled:!$.trim()||!G,className:"w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3.5 rounded-xl shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all active:scale-95",children:" "})]})]})}),O&&R&&s.jsx(Pee,{users:o,onClose:()=>I(!1),onSelect:pe,title:` ${R.type==="frame"?"":""} "${R.label}"`}),k&&s.jsx("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>E(!1),children:s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-3xl border border-gray-700 shadow-2xl p-6 animate-pop-in",onClick:ve=>ve.stopPropagation(),children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2",children:[s.jsx(hs,{className:"w-6 h-6 text-blue-500"}),"  "]}),s.jsxs("div",{className:"space-y-5",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2",children:"  (  )"}),s.jsx("input",{type:"text",value:M,onChange:ve=>ne(ve.target.value),placeholder:":  ...",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3.5 text-white focus:border-blue-500 outline-none transition-colors",autoFocus:!0})]}),s.jsx("button",{onClick:ye,disabled:!M.trim(),className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3.5 rounded-xl shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all active:scale-95",children:""})]})]})}),B&&s.jsx(jn,{title:B.title,message:B.message,onClose:()=>Y(null),onConfirm:B.onConfirm,confirmVariant:B.variant||"primary",confirmButtonText:" "}),s.jsx("input",{type:"file",ref:ge,className:"hidden",accept:"image/*",onChange:fe})]})},PO=({logs:n,onClearLogs:e,onUndo:t})=>{const[r,i]=w.useState(""),[o,c]=w.useState("all"),[u,h]=w.useState(!1),[m,p]=w.useState(20),b=w.useMemo(()=>(p(20),n.filter(S=>{const L=S.actorName.toLowerCase().includes(r.toLowerCase())||S.target.toLowerCase().includes(r.toLowerCase())||S.details.toLowerCase().includes(r.toLowerCase()),$=o==="all"||S.actionType===o;return L&&$}).sort((S,L)=>{const $=new Date(S.createdAt).getTime();return new Date(L.createdAt).getTime()-$})),[n,r,o]),v=w.useMemo(()=>b.slice(0,m),[b,m]),_=S=>{switch(S){case"create":return"text-green-400 bg-green-500/10 border-green-500/20";case"delete":return"text-red-400 bg-red-500/10 border-red-500/20";case"update":return"text-blue-400 bg-blue-500/10 border-blue-500/20";case"login":return"text-purple-400 bg-purple-500/10 border-purple-500/20";case"financial":return"text-yellow-400 bg-yellow-500/10 border-yellow-500/20";default:return"text-gray-400 bg-gray-500/10 border-gray-500/20"}},T=S=>{switch(S){case"create":return" ";case"delete":return" ";case"update":return" ";case"login":return" ";case"financial":return" ";default:return S}},k=S=>{try{const L=new Date(S);if(isNaN(L.getTime()))return{dayName:" ",dateStr:"--",timeStr:"--"};const $=L.toLocaleDateString("ar-EG-u-nu-latn",{weekday:"long"}),H=L.toLocaleDateString("ar-EG-u-nu-latn",{day:"numeric",month:"long",year:"numeric"}),G=L.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"2-digit",minute:"2-digit",hour12:!0});return{dayName:$,dateStr:H,timeStr:G}}catch{return{dayName:"-",dateStr:"-",timeStr:"-"}}},E=()=>{e(),h(!1)};return s.jsxs("div",{className:"space-y-6 pb-24 animate-fadeIn",children:[s.jsxs("div",{className:"bg-gray-800 p-4 rounded-2xl shadow-lg border border-gray-700/50 flex flex-col md:flex-row gap-4 items-center",children:[s.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[s.jsx("div",{className:"p-3 bg-blue-500/20 rounded-xl text-blue-400",children:s.jsx(ur,{className:"w-6 h-6"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-white",children:" "}),s.jsx("p",{className:"text-xs text-gray-400",children:"     "})]})]}),s.jsxs("div",{className:"relative flex-1 w-full flex items-center gap-3",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(mr,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 w-5 h-5"}),s.jsx("input",{type:"text",placeholder:"     ...",value:r,onChange:S=>i(S.target.value),className:"w-full bg-gray-900 text-white rounded-xl py-3 pr-12 pl-4 border border-gray-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition-all placeholder-gray-500"})]}),n.length>0&&s.jsx("button",{onClick:()=>h(!0),className:"bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/20 p-3 rounded-xl transition-all active:scale-95",title:" ",children:s.jsx(Tt,{className:"w-6 h-6"})})]})]}),s.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:["all","create","update","delete","financial","login"].map(S=>s.jsx("button",{onClick:()=>c(S),className:`px-4 py-2 rounded-lg text-xs font-bold whitespace-nowrap transition-colors border ${o===S?"bg-blue-600 text-white border-blue-600 shadow-lg":"bg-gray-800 text-gray-400 border-gray-700 hover:bg-gray-700"}`,children:S==="all"?"":T(S)},S))}),s.jsx("div",{className:"space-y-3",children:v.length>0?v.map(S=>{const{dayName:L,dateStr:$,timeStr:H}=k(S.createdAt);return s.jsxs("div",{className:"bg-[#1e293b] rounded-xl p-4 border border-gray-700 hover:border-gray-500 transition-all flex flex-col md:flex-row gap-4 items-start md:items-center justify-between shadow-sm group",children:[s.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[s.jsx("div",{className:`p-2.5 rounded-xl border mt-1 shadow-inner ${_(S.actionType)}`,children:s.jsx(ur,{className:"w-5 h-5"})}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsxs("span",{className:"text-white font-bold text-sm flex items-center gap-1",children:[s.jsx(_t,{className:"w-3 h-3 text-gray-500"}),S.actorName]}),s.jsx("span",{className:"text-gray-600 text-xs",children:"|"}),s.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded border font-bold ${_(S.actionType)}`,children:T(S.actionType)}),s.jsx("span",{className:"text-gray-500 text-xs bg-black/20 px-2 py-0.5 rounded border border-white/5 font-mono",children:S.target})]}),s.jsxs("p",{className:"text-[10px] text-gray-500 font-medium",children:["#",S.id.split("-").pop()]}),S.isUndone&&s.jsx("span",{className:"bg-orange-500/10 text-orange-400 text-[10px] px-2 py-0.5 rounded-full border border-orange-500/20 font-bold",children:" "}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:S.details}),t&&!S.isUndone&&S.actionType!=="login"&&S.targetId&&S.collection&&s.jsxs("button",{onClick:()=>t(S),className:"mt-2 flex items-center gap-1.5 text-[10px] font-bold text-orange-400 hover:text-orange-300 bg-orange-500/10 hover:bg-orange-500/20 px-2 py-1 rounded-lg border border-orange-500/20 transition-all active:scale-95",children:[s.jsx(Ml,{className:"w-3 h-3"}),"  "]})]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-1 text-xs text-gray-500 bg-black/20 px-3 py-2 rounded-lg border border-white/5 w-full md:w-auto",children:[s.jsxs("div",{className:"flex items-center gap-1.5 text-gray-400",children:[s.jsx(ei,{className:"w-3 h-3"}),s.jsxs("span",{children:[L," ",$]})]}),s.jsxs("div",{className:"flex items-center gap-1.5 text-gray-300 font-bold font-mono",children:[s.jsx(It,{className:"w-3 h-3 text-blue-400"}),s.jsx("span",{children:H})]})]})]},S.id)}):s.jsxs("div",{className:"text-center py-16 text-gray-500 bg-gray-800/30 rounded-2xl border border-dashed border-gray-700",children:[s.jsx(ur,{className:"w-16 h-16 mx-auto mb-4 opacity-20"}),s.jsx("h3",{className:"text-lg font-bold text-gray-400",children:"  "}),s.jsx("p",{className:"text-xs mt-1",children:"       ."})]})}),b.length>m&&s.jsxs("button",{onClick:()=>p(S=>S+20),className:"w-full py-3 bg-gray-800 hover:bg-gray-700 text-gray-300 font-bold rounded-xl transition-all",children:["  (",b.length-m," )"]}),u&&s.jsx(jn,{title:"  ",message:"               .",onClose:()=>h(!1),onConfirm:E,confirmButtonText:"  ",confirmVariant:"danger"})]})},OO=({promoCodes:n,pointsConfig:e,onAddPromo:t,onDeletePromo:r,onUpdatePointsConfig:i})=>{const[o,c]=w.useState("promos"),[u,h]=w.useState(!1),[m,p]=w.useState(""),[b,v]=w.useState(""),[_,T]=w.useState("percentage"),[k,E]=w.useState(""),[S,L]=w.useState(""),[$,H]=w.useState(""),[G,z]=w.useState(""),[P,j]=w.useState((e==null?void 0:e.isPointsEnabled)??!0),[O,I]=w.useState("1"),[R,F]=w.useState(String((e==null?void 0:e.pointsPerCurrency)||1)),[M,ne]=w.useState((e==null?void 0:e.currencyPerPoint)||.1);w.useEffect(()=>{j((e==null?void 0:e.isPointsEnabled)??!0),ne((e==null?void 0:e.currencyPerPoint)||.1);const V=(e==null?void 0:e.pointsPerCurrency)||1;V<1&&1/V%10===0?(I(String(1/V)),F("1")):(I("1"),F(String(V)))},[e]);const U=()=>{if(!m||!b)return;const V={id:`PROMO-${Date.now()}`,code:m.toUpperCase(),type:_,value:parseFloat(b),isActive:!0,usageCount:0,maxUsage:k?parseInt(k):void 0,minOrderAmount:S?parseFloat(S):void 0,maxDiscount:$?parseFloat($):void 0,expiryDate:G||void 0,createdAt:new Date().toISOString()};t(V),p(""),v(""),E(""),L(""),H(""),z("")},A=()=>{const V=parseFloat(O),Q=parseFloat(R);if(isNaN(V)||V<=0||isNaN(Q)||Q<0){alert("      .");return}const ae=Q/V;i({pointsPerCurrency:ae,currencyPerPoint:M,isPointsEnabled:P}),h(!0),setTimeout(()=>h(!1),2e3)};return s.jsxs("div",{className:"space-y-6 pb-24 animate-fadeIn relative",children:[u&&s.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm animate-fadeIn",children:s.jsxs("div",{className:"bg-gray-800 border border-green-500/50 rounded-2xl p-6 shadow-2xl flex flex-col items-center animate-pop-in",children:[s.jsx("div",{className:"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mb-4",children:s.jsx(Je,{className:"w-10 h-10 text-green-500"})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),s.jsx("p",{className:"text-gray-400",children:"   ."})]})}),s.jsxs("h2",{className:"text-2xl font-bold text-white mb-6 flex items-center gap-3",children:[s.jsx(Ag,{className:"w-8 h-8 text-yellow-500"})," "]}),s.jsxs("div",{className:"flex bg-gray-800 p-1 rounded-xl w-fit mb-6",children:[s.jsx("button",{onClick:()=>c("promos"),className:`px-6 py-2 rounded-lg text-sm font-bold transition-all ${o==="promos"?"bg-yellow-500 text-black shadow-lg":"text-gray-400 hover:text-white"}`,children:" "}),s.jsx("button",{onClick:()=>c("points"),className:`px-6 py-2 rounded-lg text-sm font-bold transition-all ${o==="points"?"bg-yellow-500 text-black shadow-lg":"text-gray-400 hover:text-white"}`,children:" "})]}),o==="promos"?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-800 p-5 rounded-2xl border border-gray-700 shadow-lg",children:[s.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[s.jsx(hs,{className:"w-5 h-5 text-green-500"}),"  "]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsx("input",{type:"text",placeholder:" (: SALE20)",value:m,onChange:V=>p(V.target.value),className:"bg-gray-900 border border-gray-600 rounded-xl px-4 py-3 text-white focus:border-yellow-500 outline-none uppercase font-mono"}),s.jsxs("div",{className:"flex bg-gray-900 rounded-xl border border-gray-600 overflow-hidden",children:[s.jsx("input",{type:"number",placeholder:"",value:b,onChange:V=>v(V.target.value),className:"flex-1 bg-transparent px-4 py-3 text-white outline-none"}),s.jsxs("select",{value:_,onChange:V=>T(V.target.value),className:"bg-gray-800 text-gray-300 px-3 text-xs outline-none border-r border-gray-600",children:[s.jsx("option",{value:"percentage",children:"%"}),s.jsx("option",{value:"fixed",children:"."})]})]}),s.jsx("input",{type:"number",placeholder:"  ",value:k,onChange:V=>E(V.target.value),className:"bg-gray-900 border border-gray-600 rounded-xl px-4 py-3 text-white focus:border-yellow-500 outline-none text-sm"}),s.jsx("input",{type:"number",placeholder:"  ",value:S,onChange:V=>L(V.target.value),className:"bg-gray-900 border border-gray-600 rounded-xl px-4 py-3 text-white focus:border-yellow-500 outline-none text-sm"}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[10px] text-gray-500 mr-2",children:" "}),s.jsx("input",{type:"date",value:G,onChange:V=>z(V.target.value),className:"bg-gray-900 border border-gray-600 rounded-xl px-4 py-2.5 text-white focus:border-yellow-500 outline-none text-sm"})]}),_==="percentage"&&s.jsx("input",{type:"number",placeholder:"  ",value:$,onChange:V=>H(V.target.value),className:"bg-gray-900 border border-gray-600 rounded-xl px-4 py-3 text-white focus:border-yellow-500 outline-none text-sm animate-fadeIn"}),s.jsx("button",{onClick:U,disabled:!m||!b,className:"bg-green-600 hover:bg-green-700 text-white font-bold rounded-xl py-3 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:" "})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[n.map(V=>s.jsxs("div",{className:"bg-[#1e293b] rounded-xl p-4 border border-gray-700 flex justify-between items-center group relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 w-1 h-full bg-yellow-500"}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-mono font-bold text-white text-lg tracking-wider",children:V.code}),s.jsx("span",{className:"text-xs bg-yellow-500/20 text-yellow-400 px-2 py-0.5 rounded border border-yellow-500/20",children:V.type==="percentage"?`${V.value}%`:`${V.value} .`})]}),s.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[" : ",s.jsx("span",{className:"text-white font-bold",children:V.usageCount})," ",V.maxUsage?`/ ${V.maxUsage}`:""]})]}),s.jsx("button",{onClick:()=>r(V.id),className:"p-2 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500/20 transition-colors",children:s.jsx(Tt,{className:"w-5 h-5"})})]},V.id)),n.length===0&&s.jsxs("div",{className:"col-span-full text-center py-10 text-gray-500 bg-gray-800/30 rounded-xl border border-dashed border-gray-700",children:[s.jsx(Ag,{className:"w-12 h-12 mx-auto mb-2 opacity-20"}),"   "]})]})]}):s.jsxs("div",{className:"bg-gray-800 p-6 rounded-2xl border border-gray-700 shadow-lg max-w-xl",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6 border-b border-gray-700 pb-4",children:[s.jsx("h3",{className:"text-lg font-bold text-white",children:" "}),s.jsx("button",{onClick:()=>j(!P),className:`relative w-14 h-7 rounded-full transition-colors duration-300 ${P?"bg-green-600":"bg-gray-600"}`,children:s.jsx("div",{className:`absolute top-1 left-1 bg-white w-5 h-5 rounded-full transition-transform duration-300 shadow-md ${P?"translate-x-7":"translate-x-0"}`})})]}),s.jsxs("div",{className:`space-y-6 transition-opacity duration-300 ${P?"opacity-100":"opacity-50 pointer-events-none"}`,children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-400 mb-2 font-bold",children:"  "}),s.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-600 flex items-center gap-3",children:[s.jsx("span",{className:"text-gray-400 text-sm",children:"  "}),s.jsx("div",{className:"relative w-20",children:s.jsx("input",{type:"number",value:R,onChange:V=>F(V.target.value),className:"w-full bg-gray-800 border border-gray-500 rounded-lg px-2 py-1.5 text-center text-white font-bold focus:border-yellow-500 outline-none"})}),s.jsx("span",{className:"text-yellow-500 font-bold text-sm",children:""}),s.jsx("span",{className:"text-gray-400 text-sm",children:" "}),s.jsxs("div",{className:"relative w-24",children:[s.jsx("input",{type:"number",value:O,onChange:V=>I(V.target.value),className:"w-full bg-gray-800 border border-gray-500 rounded-lg px-2 py-1.5 text-center text-white font-bold focus:border-green-500 outline-none"}),s.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-[10px] text-gray-500",children:"."})]})]}),s.jsx("p",{className:"text-[10px] text-gray-500 mt-2 mr-1",children:": 1    100   0.5    1 ."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-400 mb-2 font-bold",children:"   "}),s.jsxs("div",{className:"flex items-center gap-3 bg-gray-900/50 p-4 rounded-xl border border-gray-600",children:[s.jsx(Ay,{className:"w-5 h-5 text-yellow-500"}),s.jsx("span",{className:"text-white font-bold text-sm",children:"1  ="}),s.jsx("input",{type:"number",value:M,onChange:V=>ne(parseFloat(V.target.value)),className:"w-24 bg-gray-800 border border-gray-500 rounded-lg px-3 py-1.5 text-center text-white font-bold focus:border-green-500 outline-none"}),s.jsx("span",{className:"text-green-500 font-bold text-sm",children:"."})]})]}),s.jsxs("div",{className:"bg-blue-900/20 p-4 rounded-xl border border-blue-500/20 text-sm text-blue-200",children:[s.jsx("p",{className:"font-bold mb-1 text-white",children:" :"}),"    ",s.jsxs("strong",{children:[O||0," ."]}),"   ",s.jsx("strong",{children:R||0})," .",s.jsx("br",{}),"    ",s.jsx("strong",{children:(parseFloat(R||"0")*M).toFixed(2)})," ."]})]}),s.jsx("button",{onClick:A,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl transition-colors shadow-lg mt-6",children:" "})]})]})},Oee=["    ","     .","  .","    ","  .    "],p4=["","","","","",""],MO=({users:n,currentUser:e,isRestricted:t,onBack:r})=>{const[i,o]=w.useState([]),[c,u]=w.useState(null),[h,m]=w.useState(""),[p,b]=w.useState(""),[v,_]=w.useState(null),[T,k]=w.useState(!1),[E,S]=w.useState(!1),[L,$]=w.useState(null),[H,G]=w.useState(null),[z,P]=w.useState(null),[j,O]=w.useState(null),[I,R]=w.useState(null),[F,M]=w.useState(!1),[ne,U]=w.useState({isWhatsappEnabled:!0,whatsappNumber:"",isChatEnabled:!0,allowImageSending:!0,isAutoReplyEnabled:!1,autoReplyText:"   .   ."}),A=w.useRef(null),V=w.useRef(null),Q=w.useRef(null),ae=w.useRef(null),[X,B]=w.useState(null);sn(()=>I?(R(null),!0):F?(M(!1),!0):X?(B(null),!0):c?(u(null),!0):r?(r(),!0):!1,[X,c,r,F,I]),w.useEffect(()=>{const ee=Ir("support_chats",pe=>{const ye=pe.sort((Ae,xe)=>new Date(xe.lastUpdated).getTime()-new Date(Ae.lastUpdated).getTime());o(ye)}),we=Ir("settings",pe=>{const ye=pe.find(Ae=>Ae.id==="support_config");if(ye){const{allowVoiceNotes:Ae,...xe}=ye;U(Pe=>({...Pe,...xe}))}});return()=>{ee(),we()}},[]),w.useEffect(()=>{c&&Q.current&&!H&&!I&&Q.current.scrollIntoView({behavior:"smooth"})},[i,c,H]),w.useEffect(()=>{if(c){const ee=i.find(we=>we.id===c);ee&&ee.unreadCount>0&&xt("support_chats",c,{unreadCount:0})}},[c,i]);const Y=w.useMemo(()=>i.find(ee=>ee.id===c),[i,c]),ge=w.useMemo(()=>Y?n.find(ee=>ee.id===Y.userId):null,[Y,n]),Z=w.useMemo(()=>h?i.filter(ee=>ee.userName.toLowerCase().includes(h.toLowerCase())||ee.userPhone.includes(h)):i,[i,h]),te=async(ee=p,we=v)=>{if(!ee.trim()&&!we||!c||!Y)return;let pe=[...Y.messages||[]],ye=ee;if(H)pe=pe.map(Ae=>Ae.id===H.id?{...Ae,text:ee,image:we||Ae.image}:Ae),ye=" "+ee;else{let Ae=ee;L&&(Ae=`[ : ${L.text.substring(0,50)+(L.text.length>50?"...":"")}]
${ee}`);const xe=pe.reduce((Be,ht)=>{const Me=parseInt(ht.id);return isNaN(Me)?Be:Math.max(Be,Me)},0),gt={id:String(xe+1),text:Ae,image:we||void 0,sender:"admin",createdAt:new Date,isRead:!1};pe.push(gt);const Ee=(ge==null?void 0:ge.role)||"user";Kt(Ee,{title:"   ",body:Ae||"   ",targetId:c,url:"/?target=support"})}await xt("support_chats",c,{messages:pe,lastMessage:we?" ":ye,lastUpdated:new Date}),b(""),_(null),G(null),$(null),k(!1),S(!1)},me=async(ee,we)=>{if(!c||!Y)return;const pe=ee.reactions||[],ye=pe.includes(we)?pe.filter(xe=>xe!==we):[...pe,we],Ae=Y.messages.map(xe=>xe.id===ee.id?{...xe,reactions:ye}:xe);await xt("support_chats",c,{messages:Ae}),R(null)},re=async()=>{if(!z||!c||!Y)return;const ee=Y.messages.filter(pe=>pe.id!==z.id),we=ee.length>0?ee[ee.length-1].text:"  ";await xt("support_chats",c,{messages:ee,lastMessage:we}),P(null)},ce=async()=>{j&&(await rr("support_chats",j),O(null),u(null))},he=ee=>{R(ee)},Oe=ee=>{ae.current=setTimeout(()=>he(ee),500)},Ue=()=>{ae.current&&clearTimeout(ae.current)},st=ee=>{var pe,ye;const we=document.querySelectorAll(".message-text");for(let Ae=0;Ae<we.length;Ae++)if((pe=we[Ae].textContent)!=null&&pe.includes(ee)){we[Ae].scrollIntoView({behavior:"smooth",block:"center"}),(ye=we[Ae].parentElement)==null||ye.classList.add("ring-2","ring-yellow-400"),setTimeout(()=>{var xe;return(xe=we[Ae].parentElement)==null?void 0:xe.classList.remove("ring-2","ring-yellow-400")},1500);break}},fe=ee=>{const we=ee.match(/^\[ : (.*?)\]\n(.*)/s);if(we){const pe=we[1],ye=we[2];return s.jsxs(s.Fragment,{children:[s.jsx("div",{onClick:Ae=>{Ae.stopPropagation(),st(pe)},className:"mb-2 pb-1 border-b border-white/10 cursor-pointer active:opacity-70",children:s.jsxs("p",{className:"text-[10px] text-white/50 line-clamp-1 italic flex items-center gap-1",children:[s.jsx(eh,{className:"w-3 h-3"}),pe]})}),s.jsx("span",{className:"message-text",children:K(ye)})]})}return s.jsx("span",{className:"message-text",children:K(ee)})},K=ee=>ee.split(/(https?:\/\/[^\s]+)/g).map((pe,ye)=>pe.match(/^https?:\/\//)?s.jsx("a",{href:pe,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 underline break-all",children:pe},ye):pe),ie=ee=>{var pe;const we=(pe=ee.target.files)==null?void 0:pe[0];if(we){const ye=new FileReader;ye.onloadend=()=>_(ye.result),ye.readAsDataURL(we)}},J=async()=>{await xt("settings","support_config",{id:"support_config",...ne}),M(!1)},le=ee=>ee.startsWith("http");return s.jsxs("div",{className:"flex h-full bg-[#0f172a] text-white relative overflow-hidden",children:[s.jsxs("div",{className:`w-full md:w-80 lg:w-96 bg-[#1e293b] border-l border-gray-700 flex flex-col absolute md:relative z-20 h-full transition-transform duration-300 ${c?"-translate-x-full md:translate-x-0":"translate-x-0"}`,children:[s.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[s.jsxs("h2",{className:"font-bold text-lg flex items-center gap-2",children:[s.jsx(Ei,{className:"w-6 h-6 text-teal-400"})," "]}),s.jsxs("div",{className:"flex items-center gap-2",children:[!t&&s.jsx("button",{onClick:()=>M(!0),className:"p-2 hover:bg-gray-700 rounded-full text-gray-400 hover:text-white transition-colors",children:s.jsx($s,{className:"w-5 h-5"})}),r&&s.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-700 rounded-full md:hidden",children:s.jsx(us,{className:"w-5 h-5 rotate-180"})})]})]}),s.jsx("div",{className:"p-3",children:s.jsxs("div",{className:"relative",children:[s.jsx(mr,{className:"absolute right-3 top-2.5 w-4 h-4 text-gray-500"}),s.jsx("input",{type:"text",placeholder:"  ...",value:h,onChange:ee=>m(ee.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-2 pl-4 pr-10 text-sm focus:border-teal-500 outline-none text-white"})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:Z.map(ee=>{const we=n.find(pe=>pe.id===ee.userId);return s.jsxs("button",{onClick:()=>u(ee.id),className:`w-full p-4 flex items-center gap-3 hover:bg-[#2a3649] transition-colors border-b border-gray-700/50 ${c===ee.id?"bg-[#2a3649] border-r-4 border-r-teal-500":""}`,children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-700 flex items-center justify-center text-gray-400 overflow-hidden border border-gray-600",children:we!=null&&we.storeImage?s.jsx("img",{src:we.storeImage,alt:ee.userName,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-6 h-6"})}),ee.unreadCount>0&&s.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full border-2 border-[#1e293b]",children:ee.unreadCount})]}),s.jsxs("div",{className:"flex-1 text-right overflow-hidden",children:[s.jsxs("div",{className:"flex justify-between items-center mb-1",children:[s.jsx("span",{className:"font-bold text-sm text-white truncate",children:ee.userName}),s.jsx("span",{className:"text-[10px] text-gray-500",children:new Date(ee.lastUpdated).toLocaleDateString()})]}),s.jsx("p",{className:`text-xs truncate ${ee.unreadCount>0?"text-white font-bold":"text-gray-400"}`,children:ee.lastMessage||" "})]})]},ee.id)})})]}),s.jsx("div",{className:`flex-1 flex flex-col bg-[#0f172a] absolute md:relative inset-0 z-10 transition-transform duration-300 ${c?"translate-x-0":"translate-x-full md:translate-x-0"}`,children:Y?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"p-3 border-b border-gray-700 flex justify-between items-center bg-[#151e2d] shadow-sm z-20",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:()=>u(null),className:"md:hidden p-2 hover:bg-gray-700 rounded-full text-gray-400",children:s.jsx(us,{className:"w-6 h-6"})}),s.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border border-gray-600",children:ge!=null&&ge.storeImage?s.jsx("img",{src:ge.storeImage,alt:Y.userName,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-5 h-5 text-gray-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-white text-sm",children:Y.userName}),s.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-400",children:[s.jsx(zn,{className:"w-3 h-3"}),s.jsx("span",{className:"font-mono",children:Y.userPhone})]})]})]}),!t&&s.jsx("button",{onClick:()=>O(Y.id),className:"p-2 text-red-400 hover:bg-red-500/10 rounded-full transition-colors",children:s.jsx(Tt,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-[#0b1120] custom-scrollbar",children:[Y.messages.map((ee,we)=>{const pe=ee.sender==="admin",ye=ee.image&&le(ee.image);return s.jsx("div",{className:`flex ${pe?"justify-end":"justify-start"}`,onTouchStart:()=>Oe(ee),onTouchEnd:Ue,onMouseDown:()=>Oe(ee),onMouseUp:Ue,onContextMenu:Ae=>{Ae.preventDefault(),he(ee)},children:s.jsxs("div",{className:`relative max-w-[75%] rounded-2xl p-2 select-none shadow-sm ${ye?"bg-transparent shadow-none":pe?"bg-teal-700 text-white rounded-br-none":"bg-gray-700 text-gray-100 rounded-bl-none"}`,children:[ee.image&&s.jsx("img",{src:ee.image,className:ye?"w-32 h-32 object-contain cursor-pointer drop-shadow-lg":"rounded-lg mb-2 max-h-48 object-cover cursor-pointer",onClick:Ae=>{Ae.stopPropagation(),B(ee.image)},alt:"attachment"}),ee.text&&s.jsx("div",{className:"text-sm whitespace-pre-wrap leading-relaxed px-1",children:fe(ee.text)}),s.jsxs("div",{className:`flex items-center justify-end gap-1 mt-1 text-[10px] ${ye?"text-gray-400":pe?"text-teal-200":"text-gray-400"}`,children:[s.jsx("span",{children:new Date(ee.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),pe&&s.jsx(Je,{className:"w-3 h-3"})]}),ee.reactions&&ee.reactions.length>0&&s.jsx("div",{className:`absolute -bottom-2 ${pe?"left-0":"right-0"} flex -space-x-1`,children:ee.reactions.map((Ae,xe)=>s.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-800 border border-gray-600 flex items-center justify-center text-[10px] shadow-sm",children:Ae},xe))})]})},we)}),s.jsx("div",{ref:Q})]}),s.jsxs("div",{className:"p-3 bg-[#151e2d] border-t border-gray-700",children:[(L||H)&&s.jsxs("div",{className:"flex justify-between items-center bg-gray-800 p-2 rounded-t-lg border-b border-gray-700 mb-2",children:[s.jsx("div",{className:"flex items-center gap-2 text-xs",children:H?s.jsxs(s.Fragment,{children:[s.jsx(Js,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-blue-300 font-bold",children:"  "})]}):s.jsxs(s.Fragment,{children:[s.jsx(eh,{className:"w-4 h-4 text-purple-400"}),s.jsx("span",{className:"text-purple-300 font-bold",children:" :"}),s.jsx("span",{className:"text-gray-400 truncate max-w-[150px]",children:L==null?void 0:L.text})]})}),s.jsx("button",{onClick:()=>{$(null),G(null),b(""),_(null)},className:"text-gray-500 hover:text-white",children:s.jsx(ut,{className:"w-4 h-4"})})]}),v&&s.jsxs("div",{className:"relative w-fit mb-2",children:[s.jsx("img",{src:v,className:"h-20 w-20 rounded-lg object-cover border border-gray-600",alt:"preview"}),s.jsx("button",{onClick:()=>_(null),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5",children:s.jsx(ut,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"flex items-end gap-2",children:[s.jsxs("div",{className:"flex-1 bg-gray-800 rounded-2xl flex items-center px-2 border border-gray-600 focus-within:border-teal-500 transition-colors",children:[ne.allowImageSending&&s.jsx("button",{onClick:()=>{var ee;return(ee=A.current)==null?void 0:ee.click()},className:"p-2 text-gray-400 hover:text-teal-400",children:s.jsx(n4,{className:"w-5 h-5"})}),s.jsx("button",{onClick:()=>S(!E),className:`p-2 transition-colors ${E?"text-yellow-400":"text-gray-400 hover:text-yellow-400"}`,children:s.jsx(Jl,{className:"w-5 h-5"})}),s.jsx("textarea",{ref:V,value:p,onChange:ee=>b(ee.target.value),placeholder:"  ...",rows:1,className:"flex-1 bg-transparent text-white p-3 text-sm outline-none resize-none max-h-24 custom-scrollbar"}),s.jsx("button",{onClick:()=>k(!T),className:"p-2 text-gray-400 hover:text-yellow-400",children:s.jsx("span",{className:"text-lg",children:""})})]}),s.jsx("button",{onClick:()=>te(),disabled:!p.trim()&&!v,className:`p-3 text-white rounded-full shadow-lg transition-transform active:scale-95 ${H?"bg-blue-600 hover:bg-blue-500":"bg-teal-600 hover:bg-teal-500"} disabled:opacity-50 disabled:cursor-not-allowed`,children:H?s.jsx(Je,{className:"w-5 h-5"}):s.jsx(yO,{className:"w-5 h-5 ml-0.5"})})]}),s.jsx("input",{ref:A,type:"file",accept:"image/*",className:"hidden",onChange:ie}),(E||T)&&s.jsxs("div",{className:"absolute bottom-20 left-4 right-4 bg-gray-800 border border-gray-600 rounded-xl p-2 shadow-2xl flex gap-2 overflow-x-auto z-30",children:[E&&Oee.map((ee,we)=>s.jsx("button",{onClick:()=>{b(ee),S(!1)},className:"whitespace-nowrap px-3 py-1.5 bg-gray-700 rounded-full text-xs text-white",children:ee},we)),T&&p4.map(ee=>s.jsx("button",{onClick:()=>b(we=>we+ee),className:"text-2xl hover:bg-white/10 p-2 rounded",children:ee},ee))]})]})]}):s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-500",children:[s.jsx(Ei,{className:"w-16 h-16 opacity-50 mb-4"}),s.jsx("h3",{className:"text-xl font-bold text-gray-300",children:"  "}),s.jsx("p",{className:"text-sm mt-2",children:"  "})]})}),I&&s.jsx("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fadeIn",onClick:()=>R(null),children:s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-gray-700 shadow-2xl p-4 animate-sheet-up",onClick:ee=>ee.stopPropagation(),children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-white font-bold",children:" "}),s.jsx("button",{onClick:()=>R(null),children:s.jsx(ut,{className:"w-5 h-5 text-gray-400"})})]}),s.jsx("div",{className:"flex gap-4 justify-center mb-6 bg-black/20 p-3 rounded-xl",children:p4.slice(0,5).map(ee=>s.jsx("button",{onClick:()=>me(I,ee),className:"text-2xl hover:scale-125 transition-transform",children:ee},ee))}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("button",{onClick:()=>{var ee;$(I),R(null),(ee=V.current)==null||ee.focus()},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 transition-colors text-white",children:[s.jsx("div",{className:"p-2 bg-blue-500/20 rounded-full text-blue-400",children:s.jsx(eh,{className:"w-4 h-4"})}),s.jsx("span",{className:"font-bold",children:"  "})]}),I.sender==="admin"&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>{G(I),b(I.text),_(I.image||null),R(null)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 transition-colors text-white",children:[s.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-full text-yellow-400",children:s.jsx(Js,{className:"w-4 h-4"})}),s.jsx("span",{className:"font-bold",children:""})]}),!t&&s.jsxs("button",{onClick:()=>{P(I),R(null)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 transition-colors text-red-400",children:[s.jsx("div",{className:"p-2 bg-red-500/20 rounded-full text-red-500",children:s.jsx(Tt,{className:"w-4 h-4"})}),s.jsx("span",{className:"font-bold",children:""})]})]}),!t&&I.sender!=="admin"&&s.jsxs("button",{onClick:()=>{P(I),R(null)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 transition-colors text-red-400",children:[s.jsx("div",{className:"p-2 bg-red-500/20 rounded-full text-red-500",children:s.jsx(Tt,{className:"w-4 h-4"})}),s.jsx("span",{className:"font-bold",children:" ()"})]})]})]})}),F&&s.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:()=>M(!1),children:s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-2xl p-6 border border-gray-700 shadow-2xl",onClick:ee=>ee.stopPropagation(),children:[s.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[s.jsx($s,{className:"w-6 h-6 text-teal-400"}),"  "]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-blue-500/5 p-4 rounded-xl border border-blue-500/20 mb-2",children:[s.jsx("h4",{className:"text-xs font-bold text-blue-400 mb-3 uppercase tracking-wider",children:" "}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-center justify-between text-white cursor-pointer",children:[s.jsxs("span",{className:"text-sm font-bold flex items-center gap-2",children:[s.jsx(Zj,{className:"w-4 h-4 text-blue-400"}),"  (In-App)"]}),s.jsx("input",{type:"checkbox",checked:ne.isChatEnabled,onChange:ee=>U({...ne,isChatEnabled:ee.target.checked}),className:"h-5 w-5 rounded bg-gray-700 border-gray-600 text-blue-500 focus:ring-blue-500"})]}),s.jsx("div",{className:"h-px bg-blue-500/10 w-full"}),s.jsxs("label",{className:"flex items-center justify-between text-white cursor-pointer",children:[s.jsxs("span",{className:"text-sm font-bold flex items-center gap-2",children:[s.jsx(nd,{className:"w-4 h-4 text-green-500"})," "]}),s.jsx("input",{type:"checkbox",checked:ne.isWhatsappEnabled,onChange:ee=>U({...ne,isWhatsappEnabled:ee.target.checked}),className:"h-5 w-5 rounded bg-gray-700 border-gray-600 text-green-500 focus:ring-green-500"})]}),ne.isWhatsappEnabled&&s.jsx("div",{className:"mt-1 mr-6",children:s.jsx("input",{type:"text",value:ne.whatsappNumber,onChange:ee=>U({...ne,whatsappNumber:ee.target.value}),className:"w-full bg-[#0f172a] border border-gray-600 rounded-lg p-2.5 text-white text-sm outline-none focus:border-green-500 font-mono dir-ltr placeholder-gray-500",placeholder:"201xxxxxxxxx"})})]})]}),s.jsxs("label",{className:"flex items-center justify-between text-white cursor-pointer p-3 bg-gray-800 rounded-xl hover:bg-gray-750 transition-colors",children:[s.jsxs("span",{className:"text-sm flex items-center gap-2",children:[s.jsx(n4,{className:"w-4 h-4 text-blue-400"}),"  "]}),s.jsx("input",{type:"checkbox",checked:ne.allowImageSending,onChange:ee=>U({...ne,allowImageSending:ee.target.checked}),className:"h-5 w-5 rounded bg-gray-700 border-gray-600 text-teal-500 focus:ring-teal-500"})]}),s.jsxs("div",{className:"p-3 bg-gray-800 rounded-xl",children:[s.jsxs("label",{className:"flex items-center justify-between text-white cursor-pointer mb-2",children:[s.jsxs("span",{className:"text-sm flex items-center gap-2",children:[s.jsx(Jl,{className:"w-4 h-4 text-yellow-400"}),"  "]}),s.jsx("input",{type:"checkbox",checked:ne.isAutoReplyEnabled,onChange:ee=>U({...ne,isAutoReplyEnabled:ee.target.checked}),className:"h-5 w-5 rounded bg-gray-700 border-gray-600 text-teal-500 focus:ring-teal-500"})]}),ne.isAutoReplyEnabled&&s.jsx("textarea",{value:ne.autoReplyText,onChange:ee=>U({...ne,autoReplyText:ee.target.value}),className:"w-full bg-[#0f172a] rounded-lg p-2 text-white text-sm border border-gray-600 focus:border-teal-500 outline-none resize-none h-20"})]})]}),s.jsx("button",{onClick:J,className:"w-full bg-teal-600 hover:bg-teal-700 text-white font-bold py-3.5 rounded-xl mt-6 transition-colors shadow-lg",children:" "})]})}),X&&s.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex items-center justify-center p-4",onClick:()=>B(null),children:[s.jsx("img",{src:X,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl"}),s.jsx("button",{className:"absolute top-4 right-4 bg-white/10 p-2 rounded-full text-white hover:bg-white/20",children:s.jsx(ut,{className:"w-6 h-6"})})]}),z&&s.jsx(jn,{title:" ",message:"      ",onClose:()=>P(null),onConfirm:re,confirmButtonText:"",confirmVariant:"danger"}),j&&s.jsx(jn,{title:" ",message:":     .",onClose:()=>O(null),onConfirm:ce,confirmButtonText:" ",confirmVariant:"danger"})]})},LO="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%3e%3cdefs%3e%3clinearGradient%20id='grad1'%20x1='0%25'%20y1='0%25'%20x2='100%25'%20y2='100%25'%3e%3cstop%20offset='0%25'%20style='stop-color:%233b82f6;stop-opacity:1'%20/%3e%3cstop%20offset='100%25'%20style='stop-color:%231d4ed8;stop-opacity:1'%20/%3e%3c/linearGradient%3e%3clinearGradient%20id='grad2'%20x1='0%25'%20y1='0%25'%20x2='100%25'%20y2='100%25'%3e%3cstop%20offset='0%25'%20style='stop-color:%23ef4444;stop-opacity:1'%20/%3e%3cstop%20offset='100%25'%20style='stop-color:%23b91c1c;stop-opacity:1'%20/%3e%3c/linearGradient%3e%3c/defs%3e%3crect%20width='512'%20height='512'%20rx='100'%20fill='%231e1e1e'/%3e%3c!--%20Tube%201%20--%3e%3cpath%20d='M156%20120h60v200c0%2016-14%2030-30%2030s-30-14-30-30V120z'%20fill='%23ffffff'%20opacity='0.2'/%3e%3cpath%20d='M156%20120h4v200c0%2014%2010%2026%2026%2026s26-12%2026-26V120h4v200c0%2016-14%2030-30%2030s-30-14-30-30V120z'%20fill='%23ffffff'%20opacity='0.5'/%3e%3cpath%20d='M160%20220h52v100c0%2014-10%2026-26%2026s-26-12-26-26V220z'%20fill='url(%23grad1)'/%3e%3c!--%20Tube%202%20--%3e%3cpath%20d='M296%20120h60v200c0%2016-14%2030-30%2030s-30-14-30-30V120z'%20fill='%23ffffff'%20opacity='0.2'/%3e%3cpath%20d='M296%20120h4v200c0%2014%2010%2026%2026%2026s26-12%2026-26V120h4v200c0%2016-14%2030-30%2030s-30-14-30-30V120z'%20fill='%23ffffff'%20opacity='0.5'/%3e%3cpath%20d='M300%20220h52v100c0%2014-10%2026-26%2026s-26-12-26-26V220z'%20fill='url(%23grad2)'/%3e%3c!--%20Drops%20--%3e%3ccircle%20cx='256'%20cy='80'%20r='20'%20fill='%233b82f6'%20opacity='0.8'%3e%3canimate%20attributeName='cy'%20values='80;100;80'%20dur='2s'%20repeatCount='indefinite'%20/%3e%3c/circle%3e%3c/svg%3e",VO="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%3e%3cdefs%3e%3clinearGradient%20id='snakeGrad'%20x1='0%25'%20y1='0%25'%20x2='100%25'%20y2='100%25'%3e%3cstop%20offset='0%25'%20style='stop-color:%2322c55e;stop-opacity:1'%20/%3e%3cstop%20offset='100%25'%20style='stop-color:%2315803d;stop-opacity:1'%20/%3e%3c/linearGradient%3e%3c/defs%3e%3crect%20width='512'%20height='512'%20rx='100'%20fill='%231e1e1e'/%3e%3c!--%20Grid%20Background%20--%3e%3cpath%20d='M106%20106h300v300H106z'%20fill='none'%20stroke='%23333'%20stroke-width='4'/%3e%3c!--%20Snake%20Body%20--%3e%3crect%20x='156'%20y='256'%20width='50'%20height='50'%20rx='10'%20fill='url(%23snakeGrad)'%20/%3e%3crect%20x='206'%20y='256'%20width='50'%20height='50'%20rx='10'%20fill='url(%23snakeGrad)'%20/%3e%3crect%20x='256'%20y='256'%20width='50'%20height='50'%20rx='10'%20fill='url(%23snakeGrad)'%20/%3e%3c!--%20Snake%20Head%20--%3e%3crect%20x='306'%20y='256'%20width='50'%20height='50'%20rx='15'%20fill='%234ade80'%20/%3e%3ccircle%20cx='340'%20cy='270'%20r='5'%20fill='%23000'/%3e%3ccircle%20cx='340'%20cy='290'%20r='5'%20fill='%23000'/%3e%3c!--%20Apple%20--%3e%3ccircle%20cx='256'%20cy='156'%20r='25'%20fill='%23ef4444'%20/%3e%3cpath%20d='M256%20131c5-10%2015-5%2015-5'%20stroke='%23166534'%20stroke-width='4'%20fill='none'/%3e%3c/svg%3e",FO="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%3e%3crect%20width='512'%20height='512'%20rx='100'%20fill='%23333'/%3e%3cpath%20d='M256%20156c-55.2%200-100%2044.8-100%20100s44.8%20100%20100%20100%20100-44.8%20100-100-44.8-100-100-100zm-20%2070h-20v20h20v-20zm60%200h-20v20h20v-20zm-60%2040h-20v20h20v-20zm60%200h-20v20h20v-20z'%20fill='%23666'/%3e%3c/svg%3e",x4={water:LO,snake:VO},Mee=n=>{if(!n)return null;const e=n.toLowerCase();return e.includes("sort")||e.includes("water")?x4.water:e.includes("snake")?x4.snake:null},b4=({src:n,alt:e,className:t})=>{const r=Mee(e||""),[i,o]=Rn.useState(r||(n&&!n.startsWith("FIRESTORE_FILE:"),n));return Rn.useEffect(()=>{if(r)return;let c=!0;if(n&&n.startsWith("FIRESTORE_FILE:")){const u=n.replace("FIRESTORE_FILE:","");Ty(u).then(h=>{c&&o(h)}).catch(h=>{console.error("Failed to load image:",h)})}else n&&!n.startsWith("FIRESTORE_FILE:")&&!i&&o(n);return()=>{c=!1}},[n,r,i]),s.jsx("img",{src:i||FO,alt:e,className:t})},Lee=({appConfig:n,onUpdateAppConfig:e})=>{const[t,r]=w.useState(!1),[i,o]=w.useState(null),[c,u]=w.useState({isActive:!0}),h=(n==null?void 0:n.games)||[],[m,p]=w.useState(!1),b=Rn.useRef(null),v=async E=>{var L;const S=(L=E.target.files)==null?void 0:L[0];if(S){p(!0);try{const $=await Wj(S,"game_images");u(H=>({...H,image:$}))}catch($){console.error("Upload failed",$),alert("  .    .")}finally{p(!1)}}},_=()=>{if(!c.name||!c.url||!c.image)return;let E=[...h];if(i)E=E.map(S=>S.id===i.id?{...S,...c}:S);else{const S={id:Date.now().toString(),name:c.name,url:c.url,image:c.image,isActive:c.isActive??!0,createdAt:new Date,playCount:0};E.push(S)}e({...n,appName:(n==null?void 0:n.appName)||"",appVersion:(n==null?void 0:n.appVersion)||"",games:E}),r(!1),o(null),u({isActive:!0}),p(!1)},T=E=>{if(confirm("      ")){const S=h.filter(L=>L.id!==E);e({...n,appName:(n==null?void 0:n.appName)||"",appVersion:(n==null?void 0:n.appVersion)||"",games:S})}},k=E=>{o(E),u(E),r(!0)};return s.jsxs("div",{className:"flex flex-col h-full text-white",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-800",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-black",children:" "}),s.jsx("p",{className:"text-sm text-gray-500",children:"   "})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-3 bg-[#252525] px-4 py-2 rounded-xl border border-white/5",children:[s.jsx("span",{className:`text-xs font-bold ${(n==null?void 0:n.isGamesEnabled)??!0?"text-green-400":"text-gray-500"}`,children:(n==null?void 0:n.isGamesEnabled)??!0?"":""}),s.jsx("button",{onClick:()=>{const E=(n==null?void 0:n.isGamesEnabled)??!0;e({...n,appName:(n==null?void 0:n.appName)||"",appVersion:(n==null?void 0:n.appVersion)||"",isGamesEnabled:!E})},className:`w-12 h-6 rounded-full p-1 transition-colors ${(n==null?void 0:n.isGamesEnabled)??!0?"bg-green-600":"bg-gray-700"}`,children:s.jsx("div",{className:`w-4 h-4 rounded-full bg-white transition-transform ${(n==null?void 0:n.isGamesEnabled)??!0?"translate-x-[-24px]":"translate-x-0"}`})})]}),s.jsxs("button",{onClick:()=>{o(null),u({isActive:!0}),r(!0)},className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-xl transition-colors font-bold",children:[s.jsx(hs,{className:"w-5 h-5"}),s.jsx("span",{children:" "})]})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:h.length===0?s.jsxs("div",{className:"text-center py-20 text-gray-500",children:[s.jsx(Ah,{className:"w-16 h-16 mx-auto mb-4 opacity-20"}),s.jsx("p",{children:"   "})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(E=>s.jsxs("div",{className:"bg-[#1a1a1a] border border-gray-800 rounded-2xl overflow-hidden group hover:border-red-500/50 transition-all",children:[s.jsxs("div",{className:"aspect-video relative",children:[s.jsx(b4,{src:E.image,alt:E.name,className:"w-full h-full object-cover"}),s.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[s.jsx("button",{onClick:()=>k(E),className:"p-2 bg-white text-black rounded-full hover:scale-110 transition-transform",children:s.jsx(DZ,{className:"w-5 h-5"})}),s.jsx("button",{onClick:()=>T(E.id),className:"p-2 bg-red-600 text-white rounded-full hover:scale-110 transition-transform",children:s.jsx(Tt,{className:"w-5 h-5"})})]}),!E.isActive&&s.jsx("div",{className:"absolute top-2 left-2 bg-red-600 text-white text-[10px] px-2 py-0.5 rounded-full font-bold",children:" "})]}),s.jsxs("div",{className:"p-4",children:[s.jsx("h3",{className:"font-bold text-lg mb-1",children:E.name}),s.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 truncate",children:[s.jsx(PZ,{className:"w-3 h-3"}),s.jsx("a",{href:E.url,target:"_blank",rel:"noopener noreferrer",className:"hover:text-red-400",children:E.url})]})]})]},E.id))})}),t&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",onClick:()=>r(!1),children:s.jsxs("div",{className:"bg-[#222] border border-gray-700 w-full max-w-md rounded-2xl overflow-hidden shadow-2xl animate-scale-in",onClick:E=>E.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[s.jsx("h3",{className:"font-bold",children:i?" ":"  "}),s.jsx("button",{onClick:()=>r(!1),children:s.jsx(ut,{className:"w-5 h-5 text-gray-400 hover:text-white"})})]}),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-1",children:" "}),s.jsx("input",{type:"text",value:c.name||"",onChange:E=>u({...c,name:E.target.value}),className:"w-full bg-[#111] border border-gray-700 rounded-xl px-3 py-2 text-sm focus:border-red-500 outline-none transition-colors",placeholder:": Flappy Bird"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-1",children:"  (URL)"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"url",value:c.url||"",onChange:E=>u({...c,url:E.target.value}),className:"w-full bg-[#111] border border-gray-700 rounded-xl pl-10 pr-3 py-2 text-sm focus:border-red-500 outline-none transition-colors dir-ltr",placeholder:"https://...",style:{direction:"ltr"}}),s.jsx(Ah,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-1",children:" "}),s.jsx("input",{type:"file",ref:b,className:"hidden",accept:"image/*",onChange:v}),c.image?s.jsxs("div",{className:"relative aspect-video rounded-xl overflow-hidden border border-gray-700 group",children:[s.jsx(b4,{src:c.image,className:"w-full h-full object-cover"}),s.jsxs("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[s.jsx("button",{onClick:()=>{var E;return(E=b.current)==null?void 0:E.click()},className:"px-3 py-1 bg-white text-black text-xs font-bold rounded-lg",children:""}),s.jsx("button",{onClick:()=>u(E=>({...E,image:""})),className:"px-3 py-1 bg-red-600 text-white text-xs font-bold rounded-lg",children:""})]})]}):s.jsx("button",{onClick:()=>{var E;return(E=b.current)==null?void 0:E.click()},disabled:m,className:"w-full aspect-video rounded-xl border-2 border-dashed border-gray-700 flex flex-col items-center justify-center gap-2 hover:border-gray-500 hover:bg-white/5 transition-all text-gray-500",children:m?s.jsx("div",{className:"w-6 h-6 border-2 border-red-500 border-t-transparent rounded-full animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx(Qr,{className:"w-8 h-8"}),s.jsx("span",{className:"text-sm font-bold",children:"  "})]})})]}),s.jsxs("div",{className:"flex items-center gap-3 bg-[#1a1a1a] p-3 rounded-xl border border-gray-800",children:[s.jsx("input",{type:"checkbox",id:"isActive",checked:c.isActive??!0,onChange:E=>u({...c,isActive:E.target.checked}),className:"w-4 h-4 accent-red-600"}),s.jsx("label",{htmlFor:"isActive",className:"text-sm font-medium cursor-pointer select-none",children:" "})]})]}),s.jsxs("div",{className:"p-4 border-t border-gray-700 flex gap-3",children:[s.jsx("button",{onClick:_,disabled:m,className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-2.5 rounded-xl transition-colors disabled:opacity-50",children:m?" ...":""}),s.jsx("button",{onClick:()=>r(!1),className:"px-6 bg-gray-700 hover:bg-gray-600 text-white font-bold py-2.5 rounded-xl transition-colors",children:""})]})]})})]})},Vee=({order:n,onClose:e,onSave:t})=>{const r=()=>n.isCollected?"collected":n.isVodafoneCash?"vodafone":n.paymentStatus||"unpaid",[i,o]=w.useState(r()),[c,u]=w.useState(""),[h,m]=w.useState(""),[p,b]=w.useState(0);w.useEffect(()=>{let _=n.totalPrice||0,T=n.discount||0;u((_+T).toString()),m(T.toString())},[n]),w.useEffect(()=>{const _=parseFloat(c)||0,T=parseFloat(h)||0;b(Math.max(0,_-T))},[c,h]);const v=()=>{const _=parseFloat(c)||0,T=parseFloat(h)||0,k=Math.max(0,_-T),E={paymentStatus:i==="vodafone"?"paid":i==="collected"?"unpaid":i,isVodafoneCash:i==="vodafone",isCollected:i==="collected",totalPrice:k,discount:T,paidAmount:i==="paid"||i==="collected"||i==="vodafone"?k:0,unpaidAmount:i==="unpaid"?k:0};t(n.id,E),e()};return s.jsx("div",{className:"fixed inset-0 z-[200] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",children:s.jsxs("div",{className:"bg-[#1f2937] border border-gray-700 rounded-2xl w-full max-w-md shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[s.jsxs("div",{className:"bg-[#111] px-5 py-4 border-b border-gray-800 flex justify-between items-center",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[s.jsx(pZ,{className:"w-5 h-5 text-emerald-400"}),"  "]}),s.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-800 rounded-full transition-colors",children:s.jsx(ut,{className:"w-5 h-5 text-gray-400"})})]}),s.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto custom-scrollbar",children:[s.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700 text-center",children:[s.jsx("span",{className:"block text-xs text-gray-400 mb-1",children:"  ( )"}),s.jsxs("span",{className:"text-3xl font-black text-emerald-400 font-mono tracking-wider",children:[p.toLocaleString()," ."]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-bold text-blue-400 mb-1.5 text-center",children:" ( )"}),s.jsx("input",{type:"number",value:c,onChange:_=>u(_.target.value),className:"w-full bg-[#111] border border-blue-500/30 rounded-lg py-2 px-1 text-white text-center font-mono font-bold text-lg focus:border-blue-500 outline-none",placeholder:"0"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-bold text-red-400 mb-1.5 text-center",children:" "}),s.jsx("input",{type:"number",value:h,onChange:_=>m(_.target.value),className:"w-full bg-[#111] border border-red-500/30 rounded-lg py-2 px-1 text-white text-center font-mono font-bold text-lg focus:border-red-500 outline-none",placeholder:"0"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-3",children:" "}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("button",{onClick:()=>o("unpaid"),className:`py-3 rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-2 ${i==="unpaid"?"bg-red-600 text-white shadow-lg ring-2 ring-red-400":"bg-[#111] text-gray-400 hover:text-white border border-gray-700"}`,children:[s.jsx(ut,{className:"w-4 h-4"})," "]}),s.jsxs("button",{onClick:()=>o("paid"),className:`py-3 rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-2 ${i==="paid"?"bg-emerald-600 text-white shadow-lg ring-2 ring-emerald-400":"bg-[#111] text-gray-400 hover:text-white border border-gray-700"}`,children:[s.jsx(Je,{className:"w-4 h-4"}),""]}),s.jsxs("button",{onClick:()=>o("vodafone"),className:`py-3 rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-2 ${i==="vodafone"?"bg-purple-600 text-white shadow-lg ring-2 ring-purple-400":"bg-[#111] text-gray-400 hover:text-white border border-gray-700"}`,children:[s.jsx(ky,{className:"w-4 h-4"}),""]}),s.jsxs("button",{onClick:()=>o("collected"),className:`py-3 rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-2 ${i==="collected"?"bg-blue-600 text-white shadow-lg ring-2 ring-blue-400":"bg-[#111] text-gray-400 hover:text-white border border-gray-700"}`,children:[s.jsx(Zu,{className:"w-4 h-4"})," "]})]})]})]}),s.jsxs("div",{className:"bg-[#111] p-4 border-t border-gray-800",children:[s.jsxs("button",{onClick:v,className:`w-full font-bold py-3.5 rounded-xl shadow-lg transition-all active:scale-95 flex items-center justify-center gap-2
                             ${i==="collected"?"bg-blue-600 hover:bg-blue-700":i==="vodafone"?"bg-purple-600 hover:bg-purple-700":i==="paid"?"bg-emerald-600 hover:bg-emerald-700":"bg-red-600 hover:bg-red-700"} text-white`,children:[s.jsx(Je,{className:"w-5 h-5"}),i==="collected"?" ":" "]}),s.jsx("p",{className:"text-[10px] text-gray-500 text-center mt-2",children:i==="collected"?'   " "    ':"     "})]})]})})},ln=({onRefresh:n,children:e,className:t="",refreshing:r})=>{const[i,o]=w.useState(null),[c,u]=w.useState(0),[h,m]=w.useState(!1),p=w.useRef(null),b=80,v=150,_=w.useRef(!1);w.useEffect(()=>{r!==void 0&&m(r)},[r]);const T=L=>{p.current&&p.current.scrollTop<=0&&!h?o(L.targetTouches[0].clientY):o(null)},k=L=>{if(i===null||h)return;const H=L.targetTouches[0].clientY-i;if(H>0){const G=Math.min(H*.5,v);L.cancelable&&H>5,u(G)}},E=async()=>{if(!(i===null||h)){if(c>=b){m(!0),_.current=!0,u(b);try{await n()}finally{setTimeout(()=>{m(!1),_.current=!1,u(0)},500)}}else u(0);o(null)}},S={transition:"none"};return s.jsxs("div",{ref:p,className:`relative overflow-y-auto h-full ${t}`,onTouchStart:T,onTouchMove:k,onTouchEnd:E,children:[s.jsx("div",{className:"absolute left-0 right-0 top-0 flex justify-center items-center pointer-events-none z-10",style:{height:b,transform:`translateY(${c-b}px)`,transition:i===null?"transform 0.3s cubic-bezier(0.25, 0.8, 0.5, 1)":"none",opacity:Math.min(c/(b*.8),1)},children:s.jsx("div",{className:`rounded-full bg-[#252525] border border-gray-700 p-2 shadow-lg flex items-center justify-center ${h?"animate-spin-slow":""}`,children:h?s.jsxs("svg",{className:"w-6 h-6 text-red-600 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):s.jsx("svg",{className:"w-6 h-6 text-red-600",style:{transform:`rotate(${c*2}deg)`},xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})})}),s.jsx("div",{style:S,children:e})]})},sr=({icon:n,label:e,onClick:t,isActive:r,danger:i})=>s.jsxs("button",{onClick:t,className:`w-full flex items-center gap-4 p-4 rounded-2xl transition-all duration-300 group relative overflow-hidden active:scale-95 mb-2 ${i?"text-red-400 hover:bg-red-500/10":r?"bg-red-600/20 text-white border border-red-500/30 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[r&&s.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 bg-red-600 rounded-l-full"}),s.jsx("div",{className:`relative z-10 transition-transform group-hover:scale-110 duration-300 ${r?"text-red-500":""}`,children:n}),s.jsx("span",{className:`relative z-10 font-bold text-sm ${r?"translate-x-1":""} transition-transform duration-300`,children:e})]}),Fee=n=>{var le,ee,we,pe;const[e,t]=w.useState("orders"),[r,i]=w.useState(!1),[o,c]=w.useState(null),[u,h]=w.useState(null),[m,p]=w.useState(null),[b,v]=w.useState(null),[_,T]=w.useState(null),[k,E]=w.useState(null),[S,L]=w.useState(null);w.useEffect(()=>{const ye=Ae=>{const{target:xe,id:Pe}=Ae.detail;xe==="orders"||xe==="order"&&Pe?t("orders"):xe==="users"?t("users"):xe==="reports"?t("reports"):xe==="messages"?t("messages"):xe==="stores"?t("stores"):xe==="notifications"?t("notifications"):xe==="support"&&t("support")};return window.addEventListener("app-navigation",ye),()=>window.removeEventListener("app-navigation",ye)},[]);const[$,H]=w.useState([]),[G,z]=w.useState(""),[P,j]=w.useState(""),[O,I]=w.useState(null),R=(ye,Ae)=>{const xe=n.orders.find(Pe=>Pe.id===ye);xe&&n.editOrder(ye,{customer:xe.customer,merchantId:xe.merchantId,merchantName:xe.merchantName,...Ae})},F=ye=>{I(ye)},[M,ne]=w.useState(!0);w.useRef(0),w.useEffect(()=>{const ye=Ir("support_chats",Ae=>{const xe=Ae.filter(Pe=>Pe.unreadCount>0);H(xe)});return()=>ye()},[]),w.useEffect(()=>{const Ae=new URLSearchParams(window.location.search).get("target");Ae&&(Ae==="messages"?t("messages"):Ae==="orders"||Ae==="order"?t("orders"):Ae==="notifications"&&t("notifications"))},[window.location.search]),sn(()=>k?(E(null),!0):S?(L(null),!0):O?(I(null),!0):b?(v(null),!0):_?(T(null),!0):m?(p(null),!0):o?(c(null),!0):u?(h(null),!0):r?(i(!1),!0):e!=="orders"?(t("orders"),!0):!1,[r,o,u,m,b,_,k,S,O,e]);const U=w.useMemo(()=>n.users.find(ye=>ye.id===n.user.id)||n.user,[n.users,n.user]),A=((ee=(le=n.currentTheme)==null?void 0:le.admin)==null?void 0:ee.mode)||"dark",V=n.users.filter(ye=>ye.status==="pending"&&ye.role!=="admin").length,Q=n.orders.filter(ye=>ye.status===ue.Pending).length,ae=$.length,X=V+n.passwordResetRequests.length+Q+ae,B=w.useMemo(()=>n.users.filter(ye=>ye.role==="driver"),[n.users]),Y=w.useMemo(()=>n.users.filter(ye=>ye.role==="merchant"),[n.users]),ge=w.useCallback(()=>t("add_order"),[]),Z=w.useCallback(ye=>p(ye),[]),te=w.useCallback(async(ye,Ae)=>{const xe=n.orders.filter(Be=>Be.status===ue.Pending&&!Be.driverId);if(xe.length===0)return;const Pe=xe.map(Be=>({id:Be.id,driverId:ye,deliveryFee:Ae,status:ue.InTransit}));await n.onBulkUpdate(Pe);const gt=n.users.find(Be=>Be.id===ye),Ee=gt?gt.name:"";n.logAction("update","",`  ${Pe.length}     ${Ee}`),n.showNotification(`  ${Pe.length}   `,"success"),gt&&Kt("driver",{title:"   ",body:`  ${Pe.length}   .   .`,targetId:ye,url:"/?target=orders"})},[n.orders,n.onBulkUpdate,n.showNotification,n.users,n.logAction]),me=w.useCallback(async ye=>{let Ae=[];ye===ue.Pending?Ae=n.orders.filter(Pe=>Pe.status!==ue.Pending&&Pe.status!==ue.Delivered&&Pe.status!==ue.Cancelled).map(Pe=>({id:Pe.id,status:ue.Pending,driverId:null,deliveryFee:null})):ye===ue.Delivered&&(Ae=n.orders.filter(Pe=>Pe.status===ue.InTransit).map(Pe=>({id:Pe.id,status:ue.Delivered,deliveredAt:new Date}))),Ae.length>0?(await n.onBulkUpdate(Ae),n.showNotification(`   ${Ae.length}  `,"success")):n.showNotification("    ","info")},[n.orders,n.onBulkUpdate,n.showNotification]),re=w.useCallback(async ye=>{const Ae=ye==="all"?n.orders.filter(Pe=>!Pe.isArchived):n.orders.filter(Pe=>Pe.status===ye&&!Pe.isArchived);if(Ae.length===0){n.showNotification("   ","info");return}const xe=ye==="all"?`   ${Ae.length}     !

           1.

  `:`  ${Ae.length}  (${ye}) .

  `;L({type:ye==="all"?"all":"status",target:ye,message:xe})},[n.orders,L]),ce=async()=>{if(!S)return;const{type:ye,target:Ae}=S;let xe=[];if(ye==="all"?xe=n.orders.filter(Pe=>!Pe.isArchived):ye==="status"&&(xe=n.orders.filter(Pe=>Pe.status===Ae&&!Pe.isArchived)),xe.length===0){L(null);return}try{const gt=[];for(let Ee=0;Ee<xe.length;Ee+=400)gt.push(xe.slice(Ee,Ee+400));for(const Ee of gt)await Promise.all(Ee.map(Be=>n.deleteOrder(Be.id)));ye==="all"&&(await xt("settings","counters",{"ORD-":0,"S-":0,lastId:0}),n.onFactoryReset&&n.onFactoryReset()),n.showNotification(`   ${xe.length}     `,"success")}catch(Pe){console.error("Bulk delete error:",Pe),n.showNotification("    ","error")}finally{L(null)}},he=w.useCallback(async()=>{if(!k)return;const{order:ye,newStatus:Ae}=k;n.updateOrderStatus(ye.id,Ae),E(null)},[k,n.updateOrderStatus]),Oe=((we=n.appConfig)==null?void 0:we.appName.split(" "))||["GOO","NOW"],Ue=Oe[0],st=Oe.slice(1).join(" "),fe=((pe=n.appConfig)==null?void 0:pe.appName)||"GOO NOW",K=async()=>new Promise(ye=>{setTimeout(()=>{ye()},1500)}),ie=ye=>{if(!ye||ye==="none")return null;if(ye!=null&&ye.startsWith("data:")||ye!=null&&ye.startsWith("http"))return s.jsx("div",{className:"w-8 h-8 min-w-[2rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:s.jsx("img",{src:ye,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let Ae=null,xe="";switch(ye){case"verified":Ae=Mo,xe="text-blue-400 fill-blue-500/20";break;case"vip":Ae=Xi,xe="text-yellow-400 fill-yellow-500/20";break;case"star":Ae=ti,xe="text-purple-400 fill-purple-500/20";break;case"popular":Ae=en,xe="text-red-400 fill-red-500/20";break;case"admin-badge":Ae=$s,xe="text-red-500";break;case"mod-badge":Ae=ur,xe="text-green-500";break}return Ae?s.jsx(Ae,{className:`w-5 h-5 ${xe}`}):null},J=e==="support";return s.jsxs("div",{className:`flex flex-col h-screen overflow-hidden ${A==="light"?"bg-gray-100":"bg-gray-900"}`,children:[r&&s.jsxs("div",{className:"fixed inset-0 z-[100] flex justify-start animate-fadeIn",dir:"rtl",children:[s.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-md transition-all duration-500",onClick:()=>i(!1)}),s.jsxs("div",{className:`w-[290px] h-full ${A==="light"?"bg-white/90":"bg-gray-900/80"} backdrop-blur-2xl border-l border-white/10 shadow-2xl relative flex flex-col z-10 pt-safe rounded-l-[40px] overflow-hidden transform transition-transform duration-300 animate-slide-in-right`,children:[s.jsxs("div",{className:"p-8 border-b border-white/5 flex flex-col items-center relative",children:[s.jsx("button",{onClick:()=>i(!1),className:"absolute top-4 left-4 p-2.5 rounded-full bg-white/5 hover:bg-red-500/20 text-gray-400 hover:text-red-400 border border-white/10 transition-all duration-300 shadow-sm active:scale-90 z-50",children:s.jsx(ut,{className:"w-5 h-5"})}),s.jsx("button",{onClick:()=>{c(U),i(!1)},className:"relative w-24 h-24 flex items-center justify-center rounded-full shadow-2xl mb-4 group/avatar cursor-pointer transition-transform active:scale-95",children:s.jsx(Ji,{frameId:U.specialFrame,size:"lg",children:s.jsxs("div",{className:"w-full h-full rounded-full bg-gray-900 overflow-hidden border-2 border-white/10 flex items-center justify-center relative z-0",children:[U.storeImage?s.jsx("img",{src:U.storeImage,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-10 h-10 text-gray-500"}),s.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover/avatar:opacity-100 transition-opacity",children:s.jsx($s,{className:"w-6 h-6 text-white"})})]})})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:`font-black text-xl tracking-tight ${A==="light"?"text-gray-900":"text-white"}`,children:U.name}),ie(U.specialBadge)]}),s.jsx("p",{className:"text-[10px] font-bold text-red-500 uppercase tracking-[0.2em] mt-1",children:"Administrator"})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-1 custom-scrollbar",children:[s.jsx("div",{className:"px-4 py-2 text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2",children:" "}),s.jsx(sr,{icon:s.jsx(Zt,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("orders"),i(!1)},isActive:e==="orders"}),s.jsx(sr,{icon:s.jsx(d0,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("reports"),i(!1)},isActive:e==="reports"}),s.jsx(sr,{icon:s.jsx(Ed,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("wallet"),i(!1)},isActive:e==="wallet"}),s.jsx(sr,{icon:s.jsx(Ei,{className:"w-5 h-5"}),label:"  (Chat)",onClick:()=>{t("support"),i(!1)},isActive:e==="support"}),s.jsx(sr,{icon:s.jsx(Md,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("users"),i(!1)},isActive:e==="users"}),s.jsx(sr,{icon:s.jsx(Ar,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("stores"),i(!1)},isActive:e==="stores"}),s.jsx(sr,{icon:s.jsx(zs,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("notifications"),i(!1)},isActive:e==="notifications"}),s.jsx(sr,{icon:s.jsx(ur,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("logs"),i(!1)},isActive:e==="logs"}),s.jsx(sr,{icon:s.jsx(Ag,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("loyalty"),i(!1)},isActive:e==="loyalty"}),s.jsx(sr,{icon:s.jsx(Ni,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("messages"),i(!1)},isActive:e==="messages"}),s.jsx(sr,{icon:s.jsx(Qr,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("slider"),i(!1)},isActive:e==="slider"}),s.jsx(sr,{icon:s.jsx(Jj,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("customizer"),i(!1)},isActive:e==="customizer"}),s.jsx(sr,{icon:s.jsx($s,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("settings"),i(!1)},isActive:e==="settings"}),s.jsx(sr,{icon:s.jsx(Ah,{className:"w-5 h-5"}),label:" ",onClick:()=>{t("games"),i(!1)},isActive:e==="games"})]}),s.jsx("div",{className:"p-6 border-t border-white/5 bg-black/20 pb-safe",children:s.jsx(sr,{icon:s.jsx(c0,{className:"w-5 h-5"}),label:" ",onClick:n.onLogout,danger:!0})})]})]}),!J&&e!=="add_order"&&s.jsx("header",{className:`${A==="light"?"bg-white/95":"bg-gray-800/95"} backdrop-blur-md border-b border-red-500/20 sticky top-0 z-30 shadow-xl pt-safe rounded-b-[35px] mx-2 mt-1 transition-all duration-300`,children:s.jsxs("div",{className:"max-w-7xl mx-auto py-3 px-4 flex justify-between items-center relative h-14",children:[s.jsx("button",{onClick:()=>i(!0),className:"flex items-center gap-3 active:scale-95 transition-transform group focus:outline-none",children:s.jsx("div",{className:"relative",children:s.jsx(Ji,{frameId:U.specialFrame,size:"sm",className:"scale-110",children:s.jsx("div",{className:`w-full h-full rounded-full flex items-center justify-center overflow-hidden relative z-0 border border-white/10 ${A==="light"?"bg-gray-100":"bg-gray-700"}`,children:U.storeImage?s.jsx("img",{src:U.storeImage,className:"w-full h-full object-cover"}):s.jsx("div",{className:"text-red-500 font-black text-sm",children:U.name.charAt(0)})})})})}),s.jsxs("h1",{className:"text-xl font-black absolute left-1/2 -translate-x-1/2 select-none",children:[s.jsx("span",{className:"text-red-600",children:Ue}),s.jsx("span",{className:A==="light"?"text-gray-900 ml-1":"text-white ml-1",children:st})]}),s.jsx("div",{className:"flex items-center gap-1",children:s.jsxs("button",{onClick:()=>t("notifications"),className:"relative p-2.5 rounded-xl bg-white/5 hover:bg-white/10 transition-colors",children:[s.jsx(zs,{className:`w-6 h-6 ${X>0?"text-yellow-500":"text-gray-400"}`}),X>0&&s.jsx("span",{className:"absolute top-1.5 right-1.5 w-4 h-4 flex items-center justify-center bg-red-600 text-[9px] font-bold text-white rounded-full ring-2 ring-gray-800 animate-pulse",children:X})]})})]})}),s.jsx("main",{className:e==="add_order"?"flex-1 bg-[#111] h-full":J?"flex-1 h-full relative":"flex-1 overflow-hidden relative p-4 sm:p-6 pb-24",children:s.jsxs("div",{className:"h-full animate-fade-in-up hardware-accelerated",children:[s.jsx("div",{className:`h-full ${e==="orders"?"block":"hidden"}`,children:s.jsx(ln,{onRefresh:K,children:s.jsx(th,{orders:n.orders,users:n.users,deleteOrder:n.deleteOrder,updateOrderStatus:n.updateOrderStatus,editOrder:n.editOrder,assignDriverAndSetStatus:n.assignDriverAndSetStatus,adminAddOrder:n.adminAddOrder,onOpenStatusModal:Z,onOpenPaymentModal:F,onNavigateToAdd:ge,onBulkAssign:te,onBulkStatusUpdate:me,onBulkDelete:re,appName:fe,currentUser:n.user,viewMode:"default"})})}),s.jsx("div",{className:`h-full ${e==="shopping"?"block":"hidden"}`,children:s.jsx(ln,{onRefresh:K,children:s.jsx(th,{orders:n.orders,users:n.users,deleteOrder:n.deleteOrder,updateOrderStatus:n.updateOrderStatus,editOrder:n.editOrder,assignDriverAndSetStatus:n.assignDriverAndSetStatus,adminAddOrder:n.adminAddOrder,onOpenStatusModal:Z,onOpenPaymentModal:F,onNavigateToAdd:ge,onBulkAssign:te,onBulkStatusUpdate:me,onBulkDelete:re,appName:fe,currentUser:n.user,viewMode:"shopping"})})}),s.jsx("div",{className:`h-full ${e==="special"?"block":"hidden"}`,children:s.jsx(ln,{onRefresh:K,children:s.jsx(th,{orders:n.orders,users:n.users,deleteOrder:n.deleteOrder,updateOrderStatus:n.updateOrderStatus,editOrder:n.editOrder,assignDriverAndSetStatus:n.assignDriverAndSetStatus,adminAddOrder:n.adminAddOrder,onOpenStatusModal:Z,onOpenPaymentModal:F,onNavigateToAdd:ge,onBulkAssign:te,onBulkStatusUpdate:me,onBulkDelete:re,appName:fe,currentUser:n.user,viewMode:"special"})})}),e==="users"&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:K,children:s.jsx(_O,{users:n.users,updateUser:n.updateUser,onDeleteUser:n.deleteUser,onAdminAddUser:n.adminAddUser,setEditingUser:c,onViewUser:h,appName:fe,currentUser:n.user})})}),e==="reports"&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:K,children:s.jsx(IO,{orders:n.orders,users:n.users,payments:n.payments,currentUser:n.user,manualDailies:n.manualDailies})})}),e==="add_order"&&s.jsx(AO,{merchants:Y,onClose:()=>t("orders"),onSave:n.adminAddOrder,getNewId:n.getNewId}),e==="stores"&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:K,children:s.jsx(jO,{users:n.users,orders:n.orders,updateUser:n.updateUser})})}),e==="notifications"&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:K,children:s.jsx(SO,{users:n.users,updateUser:n.updateUser,onDeleteUser:n.deleteUser,passwordResetRequests:n.passwordResetRequests,resolvePasswordResetRequest:n.resolvePasswordResetRequest,setEditingUser:c,pendingOrders:n.orders.filter(ye=>ye.status===ue.Pending&&!ye.driverId),onNavigateToOrders:()=>t("orders"),unreadChats:$,onNavigateToSupport:()=>t("support")})})}),e==="wallet"&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:K,children:s.jsx(EO,{orders:n.orders,users:n.users,payments:n.payments,updateUser:n.updateUser,handleDriverPayment:n.handleDriverPayment,onDeletePayment:n.onDeletePayment,currentUser:n.user,manualDailies:n.manualDailies,logAction:n.logAction})})}),e==="messages"&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:K,children:s.jsx(TO,{users:n.users,onSendMessage:n.sendMessage,messages:n.messages,deleteMessage:n.deleteMessage})})}),e==="slider"&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:K,children:s.jsx(CO,{images:n.sliderImages,isEnabled:n.sliderConfig.isEnabled,onAddImage:n.onAddSliderImage,onDeleteImage:n.onDeleteSliderImage,onUpdateImage:n.onUpdateSliderImage,onToggleSlider:n.onToggleSlider,merchants:Y,adminUser:n.user})})}),e==="customizer"&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:K,children:s.jsx(DO,{currentTheme:n.currentTheme,onUpdateTheme:n.onUpdateTheme,onClose:()=>t("orders"),appConfig:n.appConfig,onUpdateAppConfig:n.onUpdateAppConfig,users:n.users,onUpdateUser:n.updateUser,sendNotification:Kt,currentUser:n.user})})}),e==="logs"&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:K,children:s.jsx(PO,{logs:n.auditLogs,onClearLogs:n.onClearLogs,onUndo:n.onUndo})})}),e==="loyalty"&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:K,children:s.jsx(OO,{promoCodes:n.promoCodes,pointsConfig:n.pointsConfig,onAddPromo:n.onAddPromo,onDeletePromo:n.onDeletePromo,onUpdatePointsConfig:n.onUpdatePointsConfig})})}),e==="support"&&s.jsx(MO,{users:n.users,currentUser:n.user,onBack:()=>t("orders")}),e==="settings"&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:K,children:s.jsx(kee,{orders:n.orders,users:n.users,editOrder:n.editOrder,onSuccess:()=>window.location.reload(),onDisconnect:()=>window.location.reload(),appConfig:n.appConfig,onUpdateAppConfig:n.onUpdateAppConfig,currentUser:n.user})})}),e==="games"&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:K,children:s.jsx(Lee,{appConfig:n.appConfig,onUpdateAppConfig:n.onUpdateAppConfig})})})]},e)}),!J&&e!=="add_order"&&s.jsx(kO,{activeView:e,onNavigate:ye=>t(ye),isVisible:M,mode:A}),o&&s.jsx(e5,{user:o,onClose:()=>c(null),onSave:(ye,Ae)=>{n.updateUser(ye,Ae),c(null)},isLastAdmin:o.role==="admin",isPrimaryAdmin:o.id==="5",appName:fe,currentUser:n.user}),u&&s.jsx(t5,{user:u,onClose:()=>h(null),onApprove:(ye,Ae)=>{n.updateUser(ye,Ae),h(null)},onDelete:ye=>{n.deleteUser(ye),h(null)}}),m&&s.jsx(RO,{order:m,onClose:()=>p(null),onSelectStatus:(ye,Ae)=>{p(null),setTimeout(()=>{Ae===ue.InTransit?v(ye):E({order:ye,newStatus:Ae})},150)},onTransferOrder:ye=>{p(null),setTimeout(()=>{T(ye)},100)}}),b&&s.jsx(mb,{order:b,drivers:B,targetStatus:ue.InTransit,onClose:()=>v(null),onSave:(ye,Ae)=>{n.assignDriverAndSetStatus(b.id,ye,Ae,ue.InTransit),v(null)}}),_&&s.jsx(mb,{order:_,drivers:B,targetStatus:ue.InTransit,onClose:()=>T(null),onSave:(ye,Ae)=>{n.assignDriverAndSetStatus(_.id,ye,Ae,ue.InTransit),T(null)}}),O&&s.jsx(Vee,{order:O,onClose:()=>I(null),onSave:R}),k&&s.jsx(jn,{title:"  ",message:"    ",onClose:()=>E(null),onConfirm:he,confirmVariant:k.newStatus===ue.Delivered?"success":"primary"}),S&&s.jsx(jn,{title:S.type==="all"?"  ":" ",message:S.message,onClose:()=>L(null),onConfirm:ce,confirmVariant:"danger",confirmButtonText:"  ",cancelButtonText:""})]})},Uee=({addOrder:n,merchant:e})=>{const[t,r]=w.useState({phone:"",address:""}),[i,o]=w.useState(""),[c,u]=w.useState(""),[h,m]=w.useState("unpaid"),[p,b]=w.useState(""),[v,_]=w.useState(""),[T,k]=w.useState(""),[E,S]=w.useState(""),[L,$]=w.useState(""),[H,G]=w.useState("idle"),z=w.useRef(null),P=w.useRef(null),j=w.useRef(null),O=w.useRef(null),I=F=>{const{name:M,value:ne}=F.target;if(M==="phone"){const U=ne.replace(/\D/g,"");U.length<=11&&r({...t,phone:U})}else r({...t,[M]:ne})},R=async F=>{if(F.preventDefault(),!t.phone||!t.address){$("    .");return}if(!/^\d{11}$/.test(t.phone)){$("       11 .");return}$(""),G("submitting");const M={customer:{...t},notes:i};if(e!=null&&e.canManageOrderDetails){if(!c.trim()){$("   ."),G("idle");return}if(c&&(M.customOrderNumber=c),h==="vodafone_cash"){if(!T||parseFloat(T)<=0){$("    ."),G("idle");return}M.paymentStatus="paid",M.isVodafoneCash=!0,T&&(M.cashAmount=parseFloat(T))}else{if(M.paymentStatus=h,M.isVodafoneCash=!1,h==="paid"&&(!p||parseFloat(p)<=0)){$("   ."),G("idle");return}if(h==="unpaid"&&(!v||parseFloat(v)<=0)){$("    ( )."),G("idle");return}}if(p){const ne=parseFloat(p);M.paidAmount=ne,h==="paid"&&(M.totalPrice=ne)}if(v){const ne=parseFloat(v);M.unpaidAmount=ne,h==="unpaid"&&(M.totalPrice=ne)}if(T){const ne=parseFloat(T);M.cashAmount=ne,h==="vodafone_cash"&&(M.totalPrice=ne)}if(E&&parseFloat(E)>0){const ne=parseFloat(E),U=M.totalPrice||0;if(ne>U){$(`  (${ne})     (${U})`),G("idle");return}M.totalPrice=Math.max(0,U-ne),M.discount=ne}}try{await n(M),G("success"),setTimeout(()=>{z.current&&(z.current.value=""),P.current&&(P.current.value=""),j.current&&(j.current.value=""),O.current&&(O.current.value=""),r({phone:"",address:""}),o(""),u(""),m("unpaid"),b(""),_(""),m("unpaid"),b(""),_(""),k(""),S(""),G("idle")},300)}catch(ne){console.error("NewOrderForm Error:",ne),G("idle"),$(`    . ${ne instanceof Error?ne.message:""}`)}};return s.jsxs("div",{className:"bg-gray-800 p-2 rounded-xl shadow-lg border border-gray-700 relative overflow-hidden transition-all duration-300",children:[s.jsxs("div",{className:`absolute inset-0 bg-gray-800 z-10 flex flex-col items-center justify-center transition-opacity duration-300 ${H==="success"?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:[s.jsx("div",{className:"scale-125 transform transition-transform duration-500 animate-bounce",children:s.jsx(Je,{className:"w-20 h-20 text-green-500"})}),s.jsx("h3",{className:"text-xl font-bold text-white mt-4",children:"   !"})]}),s.jsx("h2",{className:"text-xl font-bold text-neutral-100 mb-4 flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(t4,{className:"w-5 h-5 ml-2 text-red-500"}),s.jsx("span",{children:"  "})]})}),s.jsxs("form",{onSubmit:R,className:`space-y-2 transition-opacity duration-300 ${H==="success"?"opacity-0":"opacity-100"}`,children:[(e==null?void 0:e.canManageOrderDetails)&&s.jsxs("div",{className:"bg-gray-700/30 p-2.5 rounded-xl border border-gray-600/50 space-y-3 animate-fadeIn",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-bold text-neutral-400 mb-1.5 opacity-80",children:" "}),s.jsxs("div",{className:"flex bg-gray-700 rounded-lg p-1 border border-gray-600 gap-1",children:[s.jsxs("button",{type:"button",onClick:()=>m("unpaid"),className:`flex-1 py-1.5 px-1 text-[10px] font-bold rounded-md transition-all flex items-center justify-center gap-1 ${h==="unpaid"?"bg-red-500 text-white shadow-sm":"text-gray-400 hover:text-white hover:bg-gray-600"}`,children:[s.jsx(xO,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:" "})]}),s.jsxs("button",{type:"button",onClick:()=>m("paid"),className:`flex-1 py-1.5 px-1 text-[10px] font-bold rounded-md transition-all flex items-center justify-center gap-1 ${h==="paid"?"bg-green-600 text-white shadow-sm":"text-gray-400 hover:text-white hover:bg-gray-600"}`,children:[s.jsx(Je,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:""})]}),s.jsxs("button",{type:"button",onClick:()=>m("vodafone_cash"),className:`flex-1 py-1.5 px-1 text-[10px] font-bold rounded-md transition-all flex items-center justify-center gap-1 ${h==="vodafone_cash"?"bg-red-800 text-white shadow-sm":"text-gray-400 hover:text-white hover:bg-gray-600"}`,children:[s.jsx(ky,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:""})]})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"orderNum",className:"block text-[10px] font-bold text-neutral-400 mb-1 text-center",children:" "}),s.jsx("input",{ref:O,type:"tel",inputMode:"numeric",pattern:"[0-9]*",id:"orderNum",value:c,onChange:F=>u(F.target.value),disabled:H==="submitting",className:"w-full px-1 py-1.5 bg-gray-700 border border-gray-600 rounded-lg text-neutral-100 placeholder:text-neutral-600 focus:ring-1 focus:ring-pink-500 focus:border-pink-500 outline-none disabled:opacity-50 font-mono text-center text-xs font-bold",placeholder:"#"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-bold text-emerald-400 mb-1 text-center",children:""}),h==="paid"&&s.jsx("input",{type:"number",value:p,onChange:F=>b(F.target.value),disabled:H==="submitting",className:"w-full px-1 py-1.5 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder:text-neutral-600 focus:ring-1 focus:ring-green-500 focus:border-green-500 outline-none text-center text-xs font-bold",placeholder:"0"}),h==="unpaid"&&s.jsx("input",{type:"number",value:v,onChange:F=>_(F.target.value),disabled:H==="submitting",className:"w-full px-1 py-1.5 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder:text-neutral-600 focus:ring-1 focus:ring-red-500 focus:border-red-500 outline-none text-center text-xs font-bold",placeholder:"0"}),h==="vodafone_cash"&&s.jsx("input",{type:"number",value:T,onChange:F=>k(F.target.value),disabled:H==="submitting",className:"w-full px-1 py-1.5 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder:text-neutral-600 focus:ring-1 focus:ring-red-800 focus:border-red-800 outline-none text-center text-xs font-bold",placeholder:"0"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-bold text-yellow-400 mb-1 text-center",children:""}),s.jsx("input",{type:"number",value:E,onChange:F=>S(F.target.value),disabled:H==="submitting",className:"w-full px-1 py-1.5 bg-gray-700 border border-gray-600 rounded-lg text-yellow-400 placeholder:text-neutral-600 focus:ring-1 focus:ring-yellow-500 focus:border-yellow-500 outline-none disabled:opacity-50 text-center text-xs font-bold",placeholder:"0"})]})]})]}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"phone",className:"block text-sm font-medium text-neutral-300 mb-1.5 flex items-center gap-1",children:[s.jsx(zn,{className:"w-4 h-4 text-blue-400"})," "]}),s.jsxs("div",{className:"relative",children:[s.jsx(zn,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),s.jsx("input",{ref:z,type:"tel",inputMode:"numeric",pattern:"[0-9]*",maxLength:11,name:"phone",id:"phone",value:t.phone,onChange:I,required:!0,disabled:H==="submitting",className:"w-full pl-3 pr-10 py-2.5 bg-gray-700 border border-gray-600 rounded-lg text-neutral-100 placeholder:text-neutral-500 focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none disabled:opacity-50 text-right placeholder:text-right font-mono text-sm",placeholder:"    11 ",dir:"rtl"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"address",className:"block text-sm font-medium text-neutral-300 mb-1.5 flex items-center gap-1",children:[s.jsx(fs,{className:"w-4 h-4 text-green-400"})," "]}),s.jsxs("div",{className:"relative",children:[s.jsx(fs,{className:"absolute right-3 top-3 w-4 h-4 text-gray-500"}),s.jsx("input",{ref:P,type:"text",name:"address",id:"address",value:t.address,onChange:I,required:!0,disabled:H==="submitting",className:"w-full pl-3 pr-10 py-2.5 bg-gray-700 border border-gray-600 rounded-lg text-neutral-100 placeholder:text-neutral-500 focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none disabled:opacity-50 text-sm"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"notes",className:"block text-sm font-medium text-neutral-300 mb-1.5 flex items-center gap-1",children:[s.jsx(dr,{className:"w-4 h-4 text-yellow-400"})," ()"]}),s.jsx("textarea",{ref:j,id:"notes",value:i,onChange:F=>o(F.target.value),rows:3,disabled:H==="submitting",className:"w-full px-3 py-2.5 bg-gray-700 border border-gray-600 rounded-lg text-neutral-100 placeholder:text-neutral-500 focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none disabled:opacity-50 text-sm"})]}),L&&s.jsx("p",{className:"text-red-400 text-sm text-center",children:L}),s.jsx("div",{className:"pt-2 pb-4",children:s.jsx("button",{type:"submit",disabled:H==="submitting",className:"w-full flex justify-center items-center bg-red-600 text-white font-bold px-6 py-3 rounded-lg shadow-md hover:bg-red-700 transition-colors disabled:bg-gray-600 disabled:cursor-not-allowed",children:H==="submitting"?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin ml-2"}),s.jsx("span",{children:"  ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(t4,{className:"w-5 h-5 ml-2"}),s.jsx("span",{children:" "})]})})})]})]})},Bee=({order:n,driver:e,viewingMerchant:t,onUpdateOrder:r})=>{var G,z,P;const[i,o]=Rn.useState(!1),[c,u]=Rn.useState(!1);sn(()=>c?(u(!1),!0):i?(o(!1),!0):!1,[c,i]);const h=(()=>{try{const j=n.createdAt;let O;if(j.seconds?O=new Date(j.seconds*1e3):O=new Date(j),isNaN(O.getTime()))return"";const I=O.toLocaleDateString("ar-EG-u-nu-latn",{weekday:"short"}),R=O.toLocaleDateString("ar-EG-u-nu-latn",{day:"numeric",month:"numeric"}),F=O.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric"});return`${I} ${R} - ${F} `}catch{return""}})(),m=t==null?void 0:t.canManageAdvancedFinancials,[p,b]=w.useState(!1),[v,_]=w.useState(((G=n.totalPrice)==null?void 0:G.toString())||""),T=()=>{!v||isNaN(Number(v))||!r||(r(n.id,{totalPrice:Number(v)}),b(!1))},k=j=>{if(!r)return;const O={};j==="paid"?(O.paymentStatus="paid",O.isVodafoneCash=!1,O.isCollected=!1):j==="unpaid"?(O.paymentStatus="unpaid",O.isVodafoneCash=!1,O.isCollected=!1):j==="vodafone"?(O.paymentStatus="paid",O.isVodafoneCash=!0,O.isCollected=!1):j==="collected"&&(O.isCollected=!0,O.paymentStatus="paid"),r(n.id,O)},E=w.useMemo(()=>{if(!(t!=null&&t.canShowDeliveryTime)||n.status!==ue.Delivered||!n.deliveredAt)return null;try{let j;return n.deliveredAt.seconds?j=new Date(n.deliveredAt.seconds*1e3):j=new Date(n.deliveredAt),isNaN(j.getTime())?null:j.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric",hour12:!0})}catch{return null}},[n.deliveredAt,n.status,t]),S=n.type==="shopping_order",L=n.paymentStatus==="paid"||n.isVodafoneCash,$=()=>{o(!0)},H=async()=>{if(r&&(r(n.id,{isCollected:!0}),n.assignedTo||n.driverId))try{const j=n.totalPrice?`${Math.floor(n.totalPrice)} .`:"";await Kt("driver",{title:"   ",body:`    ${j}  #${n.customOrderNumber||n.id} `,targetId:n.assignedTo||n.driverId}),console.log("    ")}catch(j){console.error("   :",j)}o(!1)};return s.jsxs("div",{className:`bg-gray-800 rounded-2xl p-4 space-y-3 transition-all border shadow-sm hover:shadow-md relative overflow-hidden group ${S?"border-purple-500/30":"border-gray-700"}`,children:[S&&s.jsx("div",{className:"absolute top-0 left-0 bg-purple-600 text-white text-[9px] px-2 py-0.5 rounded-br-lg font-bold z-10",children:" "}),s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1.5 flex-wrap",children:[!n.isCollected&&!((L||n.isVodafoneCash)&&(n.assignedTo||n.driverId))||!t||m?s.jsxs(s.Fragment,{children:[s.jsxs("span",{className:"font-mono text-xs text-red-400 bg-red-900/10 px-2 py-0.5 rounded-md border border-red-900/30 font-bold tracking-wider flex items-center h-6",children:["#",n.id]}),n.customOrderNumber&&s.jsxs("span",{className:"font-mono text-xs text-blue-400 bg-blue-900/10 px-2 py-0.5 rounded-md border border-blue-900/30 font-bold tracking-wider",children:["#",n.customOrderNumber]})]}):null,s.jsxs("span",{className:"text-[10px] text-gray-400 font-medium flex items-center gap-1 bg-black/20 px-2 py-0.5 rounded-md",children:[s.jsx(It,{className:"w-3 h-3 opacity-70"}),h]}),n.isCollected?s.jsxs("span",{className:"text-[10px] text-blue-400 font-bold px-2 py-0.5 bg-blue-900/10 border border-blue-500/20 rounded-md flex items-center gap-1",children:[s.jsx(Je,{className:"w-3 h-3 text-blue-500"})," "]}):n.isVodafoneCash?s.jsxs("span",{className:"text-[10px] text-red-400 font-bold px-2 py-0.5 bg-red-600/10 border border-red-500/20 rounded-md flex items-center gap-1",children:[s.jsx(Je,{className:"w-3 h-3 text-red-500"}),""]}):L&&(n.assignedTo||n.driverId)?s.jsxs("span",{className:"text-[10px] text-green-400 font-bold px-2 py-0.5 bg-green-600/10 border border-green-500/20 rounded-md flex items-center gap-1",children:[s.jsx(Je,{className:"w-3 h-3 text-green-500"})," "]}):null,E&&s.jsxs("span",{className:"text-[10px] text-green-400 font-bold flex items-center gap-1 bg-green-900/20 px-2 py-0.5 rounded-md border border-green-500/20 animate-fadeIn",children:[s.jsx(Je,{className:"w-3 h-3"}),": ",E]})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("div",{className:"mt-0.5",children:S?s.jsx(en,{className:"w-4 h-4 text-purple-400"}):s.jsx(fs,{className:"w-4 h-4 text-gray-500"})}),s.jsx("p",{className:"font-bold text-white text-sm leading-snug line-clamp-2",children:((z=n.customer)==null?void 0:z.address)||"  "})]}),t&&t.canManageOrderDetails&&!n.isCollected&&n.paymentStatus==="unpaid"&&!n.isVodafoneCash&&(n.assignedTo||n.driverId)&&s.jsx("div",{className:"mt-3 flex justify-start animate-fadeIn",children:s.jsxs("button",{onClick:$,className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-4 py-2.5 rounded-lg shadow-lg hover:shadow-xl hover:from-blue-700 hover:to-blue-800 transition-all flex items-center gap-2 font-bold text-sm",children:[s.jsx(Je,{className:"w-4 h-4"})," "]})}),m&&!t&&s.jsxs("div",{className:"mt-3 flex items-center justify-between animate-fadeIn border-t border-gray-700/50 pt-3",children:[s.jsx("div",{className:"flex items-center gap-2"}),s.jsxs("button",{onClick:()=>u(!0),className:"bg-emerald-900/30 text-emerald-400 border border-emerald-500/30 px-3 py-1.5 rounded-lg hover:bg-emerald-900/50 transition-all flex items-center gap-2 font-bold text-xs",children:[s.jsx(Zu,{className:"w-3.5 h-3.5"})," "]})]}),n.notes&&s.jsxs("div",{className:"mt-2 bg-red-900/10 p-2.5 rounded-lg border border-red-500/20",children:[s.jsx("p",{className:"text-[11px] font-bold text-red-400 mb-1",children:":"}),s.jsx("p",{className:"text-xs text-gray-200 leading-relaxed font-medium",children:n.notes})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsxs("p",{className:"text-xs text-gray-400 flex items-center gap-1 bg-gray-700/30 px-2 py-1 rounded-lg",children:[s.jsx(_t,{className:"w-3 h-3"}),s.jsx("span",{className:"font-mono dir-ltr copyable-phone",children:((P=n.customer)==null?void 0:P.phone)||""})]}),(!t||t.canManageOrderDetails)&&n.totalPrice!==void 0&&!n.isCollected&&!((L||n.isVodafoneCash)&&(n.assignedTo||n.driverId)&&n.status!==ue.Pending)&&s.jsxs("div",{className:"flex flex-col items-end gap-0.5 bg-gray-700/30 px-2 py-1 rounded-lg animate-fadeIn border border-gray-600/30",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Zu,{className:"w-3 h-3 text-red-400"}),s.jsxs("span",{className:"font-bold text-red-400 text-xs",children:[Number(n.totalPrice).toLocaleString("en-US")," ."]})]}),n.deliveryFee&&n.deliveryFee>0&&s.jsxs("span",{className:"text-[9px] text-gray-500 font-mono block leading-none",children:["(: ",(Number(n.totalPrice)+Number(n.deliveryFee)).toLocaleString("en-US"),")"]})]})]})]}),s.jsx("div",{className:"flex-shrink-0 mr-2 flex flex-col items-end gap-2",children:s.jsx(wO,{status:n.status})})]}),s.jsx("div",{className:"pt-3 border-t border-gray-700/50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-1.5 bg-gray-700 rounded-full ml-2 border border-gray-600",children:s.jsx(Zt,{className:`w-3.5 h-3.5 ${e.name!==" "?"text-blue-400":"text-gray-500"}`})}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[10px] text-gray-500",children:" "}),s.jsx("span",{className:`text-xs font-bold ${e.name===" "?"text-gray-500 italic":"text-white"}`,children:e.name})]})]}),e.phone&&(n.status===ue.InTransit||n.status===ue.Delivered)&&s.jsxs("div",{className:"flex space-x-2 space-x-reverse items-center",children:[e.image?s.jsx("img",{src:e.image,alt:e.name,className:"w-8 h-8 rounded-full object-cover border border-gray-600 ml-2"}):s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center border border-gray-600 ml-2",children:s.jsx(_t,{className:"w-4 h-4 text-gray-400"})}),s.jsx("a",{href:`https://wa.me/2${e.phone}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-green-600/10 text-green-400 rounded-lg hover:bg-green-600/20 transition-colors border border-green-500/10",children:s.jsx(nd,{className:"w-4 h-4"})}),s.jsx("a",{href:`tel:${e.phone}`,className:"p-2 bg-blue-600/10 text-blue-400 rounded-lg hover:bg-blue-600/20 transition-colors border border-blue-500/10",children:s.jsx(zn,{className:"w-4 h-4"})})]})]})}),i&&Jh.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fadeIn",children:s.jsxs("div",{className:"bg-gray-800 rounded-2xl p-6 max-w-sm w-full border border-gray-700 shadow-2xl transform animate-scaleIn",children:[s.jsx("div",{className:"flex items-center justify-center mb-4",children:s.jsx("div",{className:"w-16 h-16 bg-blue-600/20 rounded-full flex items-center justify-center",children:s.jsx(Je,{className:"w-10 h-10 text-blue-400"})})}),s.jsx("h3",{className:"text-xl font-bold text-white text-center mb-2",children:" "}),s.jsx("p",{className:"text-gray-300 text-center mb-6 text-sm",children:"      "}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>o(!1),className:"flex-1 bg-gray-700 text-white font-bold py-3 px-4 rounded-xl hover:bg-gray-600 transition-colors",children:""}),s.jsx("button",{onClick:H,className:"flex-1 bg-blue-600 text-white font-bold py-3 px-4 rounded-xl hover:bg-blue-700 transition-colors shadow-lg",children:" "})]})]})}),document.body),c&&m&&!t&&s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fadeIn",children:s.jsxs("div",{className:"bg-gray-800 rounded-2xl p-5 max-w-sm w-full border border-gray-700 shadow-2xl transform animate-scaleIn",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 border-b border-gray-700 pb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Zu,{className:"w-5 h-5 text-emerald-400"}),s.jsx("h3",{className:"text-lg font-bold text-white",children:"  "})]}),s.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-white",children:s.jsx(xO,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"bg-gray-900/50 p-2 rounded-lg border border-gray-700/50 mb-4 flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-400 font-bold",children:" :"}),s.jsxs("span",{className:"font-mono text-sm text-emerald-400 font-bold",children:["#",n.customOrderNumber||n.id]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"text-[10px] text-gray-400 font-bold mb-1.5 block",children:"  (.)"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("div",{className:"flex-1 relative",children:s.jsx("input",{type:"number",value:v,onChange:j=>_(j.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-xl py-2.5 px-3 text-white text-center font-mono font-bold focus:outline-none focus:border-emerald-500 transition-colors"})}),s.jsx("button",{onClick:T,className:"bg-emerald-600 text-white px-3 rounded-xl hover:bg-emerald-700 transition-colors flex items-center justify-center",children:s.jsx(Je,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[10px] text-gray-400 font-bold block",children:" "}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsx("button",{onClick:()=>k("paid"),className:`text-xs font-bold py-3 rounded-xl border transition-all ${n.paymentStatus==="paid"&&!n.isVodafoneCash&&!n.isCollected?"bg-green-600 text-white border-green-500 shadow-lg":"bg-gray-700/50 text-gray-400 border-gray-600 hover:bg-gray-700"}`,children:" ()"}),s.jsx("button",{onClick:()=>k("unpaid"),className:`text-xs font-bold py-3 rounded-xl border transition-all ${n.paymentStatus==="unpaid"?"bg-red-600 text-white border-red-500 shadow-lg":"bg-gray-700/50 text-gray-400 border-gray-600 hover:bg-gray-700"}`,children:" "}),s.jsx("button",{onClick:()=>k("vodafone"),className:`text-xs font-bold py-3 rounded-xl border transition-all ${n.isVodafoneCash?"bg-red-800 text-white border-red-600 shadow-lg":"bg-gray-700/50 text-gray-400 border-gray-600 hover:bg-gray-700"}`,children:""}),s.jsx("button",{onClick:()=>k("collected"),className:`text-xs font-bold py-3 rounded-xl border transition-all ${n.isCollected?"bg-blue-600 text-white border-blue-500 shadow-lg":"bg-gray-700/50 text-gray-400 border-gray-600 hover:bg-gray-700"}`,children:" "})]})]})]})})]})},T_=({active:n,label:e,count:t,onClick:r,icon:i})=>s.jsxs("button",{onClick:r,className:`flex items-center gap-2 px-4 py-2.5 rounded-xl text-xs font-bold transition-all border whitespace-nowrap ${n?"bg-red-600 text-white border-red-500 shadow-lg shadow-red-900/20":"bg-gray-800 text-gray-400 border-gray-700 hover:bg-gray-700 hover:text-gray-200"}`,children:[i&&s.jsx("span",{className:n?"text-white":"text-gray-500",children:i}),e,t!==void 0&&s.jsx("span",{className:`px-1.5 py-0.5 rounded-md text-[10px] ${n?"bg-white/20 text-white":"bg-black/20 text-gray-500"}`,children:t})]}),zee=({orders:n,users:e,viewingMerchant:t,onUpdateOrder:r})=>{const[i,o]=w.useState(""),[c,u]=w.useState("today"),[h,m]=w.useState(!1),[p,b]=w.useState(new Date().toISOString().split("T")[0]),[v,_]=w.useState(20),T=w.useRef(null),k=j=>{const O=j.createdAt;return typeof O.toDate=="function"?O.toDate():O.seconds?new Date(O.seconds*1e3):new Date(O)},E=j=>{const O=new Date(j);return O.getHours()<6&&O.setDate(O.getDate()-1),O.setHours(0,0,0,0),O},S=w.useMemo(()=>{if(c==="all")return n;const j=c==="today"?E(new Date):new Date(p);return j.setHours(0,0,0,0),n.filter(O=>{const I=k(O);return E(I).getTime()===j.getTime()})},[n,c,p]),L=w.useMemo(()=>S.filter(j=>!h||j.type==="shopping_order").filter(j=>{var O,I;return j.id.toLowerCase().includes(i.toLowerCase())||(((O=j.customer)==null?void 0:O.address)||"").toLowerCase().includes(i.toLowerCase())||(((I=j.customer)==null?void 0:I.phone)||"").includes(i)}).sort((j,O)=>{const I=k(j).getTime(),R=k(O).getTime();if(I!==R)return R-I;const F=parseInt(j.id.replace(/\D/g,"")||"0");return parseInt(O.id.replace(/\D/g,"")||"0")-F}),[S,h,i]),$=L.reduce((j,O)=>j+(O.totalPrice||0),0),H=t!=null&&t.canManageOrderDetails?L.filter(j=>!j.isCollected&&j.paymentStatus!=="paid"&&!j.isVodafoneCash).reduce((j,O)=>j+(O.totalPrice||0),0):0,G=t!=null&&t.canManageOrderDetails?L.filter(j=>j.isVodafoneCash).reduce((j,O)=>j+(O.cashAmount||O.totalPrice||0),0):0,z=w.useMemo(()=>{const j=E(new Date);return{today:n.filter(O=>E(k(O)).getTime()===j.getTime()).length,all:n.length,shopping:n.filter(O=>O.type==="shopping_order").length}},[n]);w.useEffect(()=>{_(20)},[L.length]),w.useEffect(()=>{const j=new IntersectionObserver(O=>{O[0].isIntersecting&&v<L.length&&_(I=>I+20)},{threshold:.1});return T.current&&j.observe(T.current),()=>j.disconnect()},[L.length,v]);const P=w.useMemo(()=>L.slice(0,v),[L,v]);return s.jsxs("div",{className:"bg-gray-900 flex flex-col h-full min-h-full",children:[s.jsxs("div",{className:"px-4 py-4 flex items-center gap-2 bg-gray-900 border-b border-gray-800",children:[s.jsx("div",{className:"p-2 bg-red-600/10 rounded-xl text-red-500",children:s.jsx(d0,{className:"w-6 h-6"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-black text-white",children:" "}),s.jsx("p",{className:"text-xs text-gray-400 font-medium",children:"   "})]})]}),s.jsxs("div",{className:"bg-gray-900 border-b border-gray-800 pb-2",children:[s.jsx("div",{className:"px-4 pt-3 pb-3",children:s.jsxs("div",{className:"relative",children:[s.jsx(mr,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 w-5 h-5"}),s.jsx("input",{type:"text",placeholder:"    ...",value:i,onChange:j=>o(j.target.value),className:"w-full pl-4 pr-10 py-3 bg-gray-800 border border-gray-700 rounded-xl text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all placeholder-gray-500 text-sm shadow-inner"})]})}),s.jsxs("div",{className:"flex gap-2 overflow-x-auto px-4 pb-2 scrollbar-hide items-center",children:[s.jsx(T_,{active:c==="today"&&!h,label:" ",count:z.today,onClick:()=>{u("today"),m(!1)},icon:s.jsx(It,{className:"w-4 h-4"})}),s.jsx(T_,{active:h,label:" ",count:z.shopping,onClick:()=>m(!h),icon:s.jsx(en,{className:"w-4 h-4"})}),s.jsx(T_,{active:c==="all"&&!h,label:" ( )",count:z.all,onClick:()=>{u("all"),m(!1)},icon:s.jsx(dr,{className:"w-4 h-4"})}),s.jsxs("div",{className:`flex items-center gap-2 px-2 py-1.5 rounded-xl border transition-all ${c==="custom"?"bg-blue-900/20 border-blue-500":"bg-gray-800 border-gray-700"}`,children:[s.jsx("input",{type:"date",value:p,onChange:j=>{b(j.target.value),u("custom"),m(!1)},className:"bg-transparent text-white text-xs font-bold outline-none cursor-pointer"}),s.jsx(ei,{className:`w-4 h-4 ${c==="custom"?"text-blue-400":"text-gray-500"}`})]})]})]}),(t==null?void 0:t.canManageOrderDetails)&&s.jsx("div",{className:"px-4 pt-3 pb-2",children:s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs("div",{className:"bg-gradient-to-br from-green-900/20 to-emerald-900/20 rounded-xl p-3 border border-green-500/30",children:[s.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[s.jsx("div",{className:"w-5 h-5 rounded-full bg-green-900/40 flex items-center justify-center border border-green-500/30",children:s.jsx(Zt,{className:"w-3 h-3 text-green-400"})}),s.jsx("p",{className:"text-[9px] text-green-300 font-bold",children:" "})]}),s.jsx("p",{className:"text-lg font-black text-green-400",children:$.toLocaleString("en-US")}),s.jsx("p",{className:"text-[8px] text-green-300/70",children:"."})]}),s.jsxs("div",{className:"bg-gradient-to-br from-orange-900/20 to-red-900/20 rounded-xl p-3 border border-orange-500/30",children:[s.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[s.jsx("div",{className:"w-5 h-5 rounded-full bg-orange-900/40 flex items-center justify-center border border-orange-500/30",children:s.jsx(It,{className:"w-3 h-3 text-orange-400"})}),s.jsx("p",{className:"text-[9px] text-orange-300 font-bold",children:"  "})]}),s.jsx("p",{className:"text-lg font-black text-orange-400",children:H.toLocaleString("en-US")}),s.jsx("p",{className:"text-[8px] text-orange-300/70",children:"."})]}),s.jsxs("div",{className:"bg-gradient-to-br from-red-900/20 to-pink-900/20 rounded-xl p-3 border border-red-500/30",children:[s.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[s.jsx("div",{className:"w-5 h-5 rounded-full overflow-hidden shadow-sm border border-red-500/30 bg-white",children:s.jsx(ky,{className:"w-full h-full object-cover"})}),s.jsx("p",{className:"text-[9px] text-red-300 font-bold",children:" "})]}),s.jsx("p",{className:"text-lg font-black text-red-400",children:G.toLocaleString("en-US")}),s.jsx("p",{className:"text-[8px] text-red-300/70",children:" "})]})]})}),s.jsx("div",{className:"p-4 space-y-3 pb-24",children:P.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 py-20 bg-gray-800/20 rounded-3xl border border-dashed border-gray-700 mt-4",children:[s.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4 shadow-inner",children:s.jsx(Cy,{className:"w-10 h-10 opacity-30"})}),s.jsx("h3",{className:"text-lg font-bold text-gray-300",children:"  "}),s.jsx("p",{className:"text-sm mt-1",children:"     ."})]}):s.jsxs(s.Fragment,{children:[P.map(j=>{var O,I,R;return s.jsx(Bee,{order:j,driver:{name:((O=e.find(F=>F.id===j.driverId))==null?void 0:O.name)||j.driverName||" ",phone:((I=e.find(F=>F.id===j.driverId))==null?void 0:I.phone)||j.driverPhone,image:((R=e.find(F=>F.id===j.driverId))==null?void 0:R.storeImage)||j.driverImage},viewingMerchant:t,onUpdateOrder:r},j.id)}),s.jsx("div",{ref:T,className:"h-10 flex items-center justify-center",children:v<L.length&&s.jsx("div",{className:"w-6 h-6 border-2 border-red-500 border-t-transparent rounded-full animate-spin"})})]})})]})},$ee=({orders:n,onUpdateStatus:e,theme:t,users:r})=>{var b,v;const[i,o]=w.useState(null),c=n.filter(_=>_.status===ue.WaitingMerchant||_.status===ue.Preparing).sort((_,T)=>{const k=new Date(_.createdAt).getTime()||0,E=new Date(T.createdAt).getTime()||0;return k-E});if(c.length===0)return s.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 min-h-[60vh]",children:[(v=(b=t==null?void 0:t.merchant)==null?void 0:b.icons)!=null&&v.img_empty_list?s.jsx("img",{src:t.merchant.icons.img_empty_list,className:"w-24 h-24 mb-6 object-contain",alt:"Empty"}):s.jsx(Cy,{className:"w-24 h-24 mb-6 opacity-20"}),s.jsx("h3",{className:"text-xl font-bold text-neutral-300 mb-2",children:"   "}),s.jsx("p",{className:"text-sm text-gray-400",children:"       ."})]});const u=({name:_,Default:T,className:k})=>{var S,L;const E=(L=(S=t==null?void 0:t.merchant)==null?void 0:S.icons)==null?void 0:L[_];return E?s.jsx("img",{src:E,className:`${k} object-contain`,alt:_}):s.jsx(T,{className:k})},h=_=>{if(_!=null&&_.startsWith("data:")||_!=null&&_.startsWith("http"))return"p-0";switch(_){case"gold":return"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[2px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[2px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-0"}},m=_=>(_==null?void 0:_.startsWith("data:"))||(_==null?void 0:_.startsWith("http")),p=()=>{i&&(e(i,ue.Cancelled),o(null))};return s.jsxs("div",{className:"space-y-6 pb-24",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white mb-6 flex items-center gap-3 border-b border-gray-700 pb-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-500 opacity-20"}),s.jsx(u,{name:"ic_notification",Default:Rr,className:"w-8 h-8 text-red-500 relative"})]}),"   (",c.length,")"]}),c.map(_=>{var S,L,$,H,G,z,P;const T=_.status===ue.WaitingMerchant,k=new Date(_.createdAt).toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric"}),E=r==null?void 0:r.find(j=>{var O;return j.phone===((O=_.customer)==null?void 0:O.phone)});return s.jsxs("div",{className:`rounded-2xl border shadow-xl overflow-hidden transition-all duration-300 ${T?"bg-gray-800 border-purple-500/50 shadow-purple-900/10":"bg-gray-800 border-orange-500/50 shadow-orange-900/10"}`,children:[s.jsxs("div",{className:`p-4 flex justify-between items-center ${T?"bg-gradient-to-r from-purple-900/40 to-gray-800":"bg-gradient-to-r from-orange-900/40 to-gray-800"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:`text-xs font-bold px-3 py-1.5 rounded-full text-white shadow-sm ${T?"bg-purple-600":"bg-orange-600"}`,children:T?" ":" "}),s.jsxs("span",{className:"text-gray-300 text-sm font-mono font-semibold tracking-wider",children:["#",_.id]})]}),s.jsxs("div",{className:"flex items-center text-gray-400 text-xs bg-black/20 px-2 py-1 rounded-lg",children:[s.jsx(u,{name:"ic_time",Default:It,className:"w-3.5 h-3.5 ml-1.5"}),k]})]}),s.jsxs("div",{className:"p-5 border-b border-gray-700/50",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:`relative w-10 h-10 flex items-center justify-center rounded-full ${m(E==null?void 0:E.specialFrame)?"":h(E==null?void 0:E.specialFrame)}`,children:[m(E==null?void 0:E.specialFrame)&&s.jsx("img",{src:E==null?void 0:E.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-125 pointer-events-none",alt:"frame"}),s.jsx("div",{className:`${m(E==null?void 0:E.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-gray-700/50 flex items-center justify-center overflow-hidden border border-gray-600 relative z-0`,children:E!=null&&E.storeImage?s.jsx("img",{src:E.storeImage,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-5 h-5 text-gray-300"})})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-400 text-xs mb-0.5",children:""}),s.jsx("p",{className:"text-white font-bold text-lg",children:((S=_.customer)==null?void 0:S.name)||" "}),s.jsx("p",{className:"text-gray-500 text-sm font-mono dir-ltr text-right",children:((L=_.customer)==null?void 0:L.phone)||""})]})]}),s.jsxs("div",{className:"text-left bg-gray-700/30 p-2 rounded-lg border border-gray-600/30",children:[s.jsx("p",{className:"text-gray-400 text-xs mb-1",children:""}),s.jsxs("p",{className:"text-green-400 font-bold text-xl",children:[($=_.totalPrice)==null?void 0:$.toLocaleString("en-US")," ",s.jsx("span",{className:"text-xs",children:"."})]})]})]}),_.notes&&s.jsxs("div",{className:"mt-4 bg-red-900/10 border border-red-500/20 p-3 rounded-lg",children:[s.jsx("p",{className:"text-xs text-red-400 font-bold mb-1",children:" :"}),s.jsx("p",{className:"text-sm text-gray-300",children:_.notes})]})]}),s.jsxs("div",{className:"p-5 space-y-3 bg-[#1a1a1a]/50",children:[s.jsxs("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:["  (",((H=_.items)==null?void 0:H.length)||0,")"]}),(G=_.items)==null?void 0:G.map((j,O)=>{var I,R;return s.jsxs("div",{className:"flex gap-4 bg-[#252525] p-3 rounded-xl border border-gray-700/50 items-center",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-800 rounded-lg overflow-hidden flex-shrink-0 border border-gray-600",children:j.image?s.jsx("img",{src:j.image,alt:j.name,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:(R=(I=t==null?void 0:t.merchant)==null?void 0:I.icons)!=null&&R.img_default_product?s.jsx("img",{src:t.merchant.icons.img_default_product,className:"w-6 h-6 object-contain"}):s.jsx(Qr,{className:"w-6 h-6 opacity-50"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"flex justify-between items-start mb-1",children:s.jsx("h4",{className:"text-white font-bold text-sm truncate pl-2",children:j.name})}),s.jsxs("p",{className:"text-gray-400 text-xs",children:[j.price.toLocaleString("en-US")," . "]}),s.jsxs("p",{className:"text-green-500 font-bold text-sm mt-1",children:[": ",(j.price*j.quantity).toLocaleString("en-US")," ."]})]}),s.jsxs("div",{className:"flex flex-col items-center justify-center bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 min-w-[3.5rem]",children:[s.jsx("span",{className:"text-[10px] text-gray-400 mb-0.5",children:""}),s.jsx("span",{className:"text-xl font-black text-white",children:j.quantity})]})]},O)})]}),s.jsx("div",{className:"p-4 bg-gray-800 border-t border-gray-700",children:s.jsx("div",{className:"flex gap-3",children:T?s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>o(_.id),className:"flex-1 bg-gray-700 hover:bg-red-900/50 text-gray-300 hover:text-red-400 py-3.5 rounded-xl font-bold transition-colors border border-gray-600 hover:border-red-500/50 flex items-center justify-center gap-2",children:[((P=(z=t==null?void 0:t.merchant)==null?void 0:z.icons)==null?void 0:P.btn_delete)&&s.jsx("img",{src:t.merchant.icons.btn_delete,className:"w-4 h-4 object-contain"})," "]}),s.jsxs("button",{onClick:()=>e(_.id,ue.Preparing),className:"flex-[2] bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-500 hover:to-purple-600 text-white py-3.5 rounded-xl font-bold shadow-lg shadow-purple-900/30 transition-all active:scale-95 flex items-center justify-center gap-2 border border-purple-500/20",children:[s.jsx(Je,{className:"w-5 h-5"}),"  "]})]}):s.jsxs("button",{onClick:()=>e(_.id,ue.Pending),className:"w-full bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-500 hover:to-orange-600 text-white py-4 rounded-xl font-bold shadow-lg shadow-orange-900/30 transition-all active:scale-95 flex items-center justify-center gap-2 border border-orange-500/20",children:[s.jsx(Rr,{className:"w-5 h-5"}),"  ( )"]})})})]},_.id)}),i&&s.jsx(jn,{title:" ",message:"            .",onClose:()=>o(null),onConfirm:p,confirmButtonText:" ",confirmVariant:"danger"})]})},qee=({messages:n,onMarkAsSeen:e,hideMessage:t})=>{const[r,i]=w.useState(null);w.useEffect(()=>{n.forEach(c=>{e(c.id)})},[n,e]);const o=()=>{r&&(t(r),i(null))};return s.jsxs("div",{className:"space-y-6 pb-24 animate-fadeIn p-1",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white mb-2 flex items-center gap-3 px-2",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 bg-red-500 blur-lg opacity-20 rounded-full"}),s.jsx(Ni,{className:"w-8 h-8 text-red-500 relative"})]}),s.jsx("span",{children:" "})]}),n.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 min-h-[50vh] bg-gray-800/30 rounded-3xl border border-gray-700/50 p-8 mx-2",children:[s.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4 shadow-inner border border-gray-700",children:s.jsx(Ni,{className:"w-8 h-8 text-gray-600"})}),s.jsx("p",{className:"text-lg font-semibold text-gray-300",children:"  "}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"   ."})]}):s.jsx("div",{className:"space-y-5 px-2",children:n.map(c=>{const u=(()=>{try{const h=new Date(c.createdAt);return isNaN(h.getTime())?"":h.toLocaleString("ar-EG-u-nu-latn",{weekday:"short",day:"numeric",hour:"numeric",minute:"numeric"})}catch{return""}})();return s.jsxs("div",{className:"relative bg-[#1e1e1e] rounded-2xl shadow-lg border border-gray-700 overflow-hidden group hover:border-gray-500 transition-colors duration-300",children:[s.jsxs("div",{className:"bg-gradient-to-r from-[#2a2a2a] to-[#1e1e1e] p-4 flex justify-between items-start border-b border-gray-700/50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-purple-600/10 rounded-xl border border-purple-500/20",children:s.jsx(_t,{className:"w-5 h-5 text-purple-400"})}),s.jsxs("div",{children:[s.jsx("span",{className:"block text-sm font-bold text-white",children:" "}),s.jsx("span",{className:"text-[10px] text-purple-400 bg-purple-900/20 px-2 py-0.5 rounded border border-purple-500/20",children:" "})]})]}),s.jsxs("div",{className:"text-[10px] font-medium text-gray-400 flex items-center gap-1.5 bg-black/30 px-2 py-1 rounded-md border border-white/5",children:[s.jsx(It,{className:"w-3 h-3"}),u]})]}),s.jsxs("div",{className:"p-5",children:[c.image&&s.jsx("div",{className:"mb-4 rounded-xl overflow-hidden border border-gray-600 bg-black",children:s.jsx("img",{src:c.image,alt:"",className:"w-full h-auto max-h-64 object-contain mx-auto"})}),s.jsx("p",{className:"text-gray-200 text-sm leading-7 whitespace-pre-wrap",children:c.text})]}),s.jsx("div",{className:"px-4 py-3 bg-[#151515] flex justify-end border-t border-gray-800",children:s.jsxs("button",{onClick:()=>i(c.id),className:"flex items-center gap-2 text-gray-500 hover:text-red-400 transition-colors text-xs font-bold px-3 py-1.5 rounded-lg hover:bg-red-500/5",children:[s.jsx(Tt,{className:"w-4 h-4"}),s.jsx("span",{children:""})]})})]},c.id)})}),r&&s.jsx(jn,{title:" ",message:"              .",onClose:()=>i(null),onConfirm:o,confirmButtonText:"",confirmVariant:"danger"})]})},nx=({icon:n,label:e,subLabel:t,onClick:r,danger:i,active:o})=>s.jsxs("button",{onClick:r,className:`w-full flex items-center justify-between p-4 rounded-xl border border-transparent transition-all active:scale-[0.98] ${i?"bg-red-900/10 hover:bg-red-900/20 text-red-500":"bg-[#252525] hover:bg-[#303030] text-white hover:border-[#333]"}`,children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`p-2.5 rounded-full ${i?"bg-red-500/10":o?"bg-green-500/20 text-green-400":"bg-gray-800 text-gray-300"}`,children:Rn.cloneElement(n,{className:`w-5 h-5 ${i?"text-red-500":""}`})}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:`font-bold text-sm ${i?"text-red-400":"text-gray-200"}`,children:e}),t&&s.jsx("p",{className:`text-xs mt-0.5 ${o?"text-green-400":"text-gray-500"}`,children:t})]})]}),!i&&s.jsx(us,{className:"w-5 h-5 text-gray-600"})]}),Hee=({merchant:n,onLogout:e,onUpdateUser:t,onUpdateTheme:r,currentTheme:i})=>{var X,B;const[o,c]=w.useState("menu"),[u,h]=w.useState(""),[m,p]=w.useState(""),[b,v]=w.useState(!1),[_,T]=w.useState(((X=n.workingHours)==null?void 0:X.start)||"09:00"),[k,E]=w.useState(((B=n.workingHours)==null?void 0:B.end)||"23:00"),[S,L]=w.useState(n.storeImage||null),[$,H]=w.useState(!1),G=w.useRef(null),[z,P]=w.useState(null),[j,O]=w.useState(!1),[I,R]=w.useState(!1),F=()=>{if(!u||u.length<6){P({text:"     6   .",type:"error"});return}if(u!==m){P({text:"   .",type:"error"});return}t(n.id,{password:u}),P({text:"    .",type:"success"}),setTimeout(()=>{c("menu"),h(""),p(""),P(null)},1500)},M=()=>{t(n.id,{workingHours:{start:_,end:k}}),P({text:"    .",type:"success"}),setTimeout(()=>{c("menu"),P(null)},1500)},ne=()=>{n.hasFreeDelivery?t(n.id,{hasFreeDelivery:!1}):R(!0)},U=()=>{t(n.id,{hasFreeDelivery:!0}),Kt("admin",{title:"    ",body:`  "${n.name}"    .   .`,url:"/?target=stores",targetId:"all"}),R(!1)},A=Y=>{var Z;const ge=(Z=Y.target.files)==null?void 0:Z[0];if(ge){H(!0);const te=new FileReader;te.onloadend=()=>{const me=new Image;me.src=te.result,me.onload=()=>{const re=document.createElement("canvas"),ce=1200,he=ce/me.width;re.width=ce,re.height=me.height*he;const Oe=re.getContext("2d");if(Oe){Oe.imageSmoothingEnabled=!0,Oe.imageSmoothingQuality="high",Oe.drawImage(me,0,0,re.width,re.height);const Ue=re.toDataURL("image/jpeg",.9);setTimeout(()=>{L(Ue),t(n.id,{storeImage:Ue}),H(!1)},800)}}},te.readAsDataURL(ge)}},V=Y=>{if(Y!=null&&Y.startsWith("data:")||Y!=null&&Y.startsWith("http"))return"p-0";switch(Y){case"gold":return"p-[4px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_15px_rgba(252,246,186,0.5)]";case"neon":return"p-[4px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_15px_rgba(34,211,238,0.6)]";case"royal":return"p-[4px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-xl border border-purple-500/30";case"fire":return"p-[4px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_15px_rgba(239,68,68,0.5)]";default:return"p-0"}},Q=Y=>{if(!Y||Y==="none")return null;if(Y!=null&&Y.startsWith("data:")||Y!=null&&Y.startsWith("http"))return s.jsx("div",{className:"w-8 h-8 min-w-[2rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:s.jsx("img",{src:Y,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let ge=null,Z="";switch(Y){case"verified":ge=Mo,Z="text-blue-400 fill-blue-500/20";break;case"vip":ge=Xi,Z="text-yellow-400 fill-yellow-500/20";break;case"star":ge=ti,Z="text-purple-400 fill-purple-500/20";break;case"popular":ge=en,Z="text-red-400 fill-red-500/20";break}return ge?s.jsx(ge,{className:`w-6 h-6 ml-2 ${Z}`}):null},ae=Y=>(Y==null?void 0:Y.startsWith("data:"))||(Y==null?void 0:Y.startsWith("http"));return s.jsxs("div",{className:"pb-24 animate-fadeIn",children:[s.jsxs("div",{className:"flex items-center gap-4 py-4 mb-2",children:[o!=="menu"?s.jsx("button",{onClick:()=>c("menu"),className:"bg-[#252525] p-2 rounded-full text-gray-400 hover:text-white",children:s.jsx(us,{className:"w-6 h-6 rotate-180"})}):s.jsx("div",{className:"w-10"}),s.jsx("h2",{className:"text-2xl font-bold text-white flex-1 text-center",children:o==="menu"?" ":o==="settings"?"":" "}),s.jsx("div",{className:"w-10"})]}),o==="menu"&&s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsxs("div",{className:`relative w-full aspect-video max-h-48 rounded-2xl overflow-hidden bg-[#252525] border-2 border-[#333] shadow-lg group ${ae(n.specialFrame)?"":V(n.specialFrame)}`,children:[ae(n.specialFrame)&&s.jsx("img",{src:n.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain pointer-events-none border-4 border-transparent",alt:"frame"}),s.jsxs("div",{className:`${ae(n.specialFrame)?"w-[92%] h-[92%] m-auto":"w-full h-full"} overflow-hidden rounded-xl relative z-0 flex items-center justify-center`,children:[$&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 z-50 backdrop-blur-sm",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full opacity-75 animate-ping absolute top-0 left-0"}),s.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center relative z-10 shadow-lg shadow-blue-500/50",children:s.jsx(Zr,{className:"w-6 h-6 text-white animate-bounce"})}),s.jsx("div",{className:"w-20 h-20 border-4 border-blue-400/30 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"})]})}),S?s.jsx("img",{src:S,alt:n.name,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:s.jsx(Xl,{className:"w-12 h-12"})}),s.jsxs("button",{onClick:()=>{var Y;return!$&&((Y=G.current)==null?void 0:Y.click())},className:"absolute bottom-3 left-3 bg-purple-600 text-white px-3 py-1.5 rounded-lg text-xs font-bold shadow-lg flex items-center gap-2 transition-transform active:scale-95 z-20",children:[s.jsx(qi,{className:"w-4 h-4"})," "]}),s.jsx("input",{ref:G,type:"file",accept:"image/*",className:"absolute opacity-0 w-0 h-0 pointer-events-none",onChange:A})]})]}),s.jsxs("div",{className:"mt-4 text-center flex items-center gap-2 justify-center",children:[s.jsx("h3",{className:"text-2xl font-bold text-white",children:n.name}),Q(n.specialBadge)]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 mr-2 uppercase tracking-wider",children:""}),s.jsx(nx,{icon:s.jsx(Zt,{}),label:"  ",subLabel:n.hasFreeDelivery?"  ":"  ( )",onClick:ne,active:n.hasFreeDelivery})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 mr-2 uppercase tracking-wider",children:" "}),s.jsx(nx,{icon:s.jsx(It,{}),label:" ",subLabel:n.workingHours?`${n.workingHours.start} - ${n.workingHours.end}`:" ",onClick:()=>c("hours")}),s.jsx(nx,{icon:s.jsx($s,{}),label:"  ",onClick:()=>c("settings")}),s.jsx(nx,{icon:s.jsx(c0,{}),label:" ",danger:!0,onClick:()=>O(!0)})]})]}),o==="hours"&&s.jsxs("div",{className:"bg-[#252525] p-6 rounded-2xl border border-[#333] space-y-6 animate-fadeIn",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 text-center",children:" "}),s.jsx("input",{type:"time",value:_,onChange:Y=>T(Y.target.value),className:"w-full px-2 py-4 bg-[#1a1a1a] border border-[#333] rounded-xl text-white text-center font-mono text-lg outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 text-center",children:" "}),s.jsx("input",{type:"time",value:k,onChange:Y=>E(Y.target.value),className:"w-full px-2 py-4 bg-[#1a1a1a] border border-[#333] rounded-xl text-white text-center font-mono text-lg outline-none"})]})]}),z&&s.jsx("div",{className:`p-4 rounded-xl text-sm font-bold text-center ${z.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:z.text}),s.jsx("button",{onClick:M,className:"w-full bg-purple-600 text-white font-bold py-4 rounded-xl shadow-lg active:scale-95",children:" "})]}),o==="settings"&&s.jsxs("div",{className:"bg-[#252525] p-6 rounded-2xl border border-[#333] space-y-6 animate-fadeIn",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:"  "}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:b?"text":"password",value:u,onChange:Y=>h(Y.target.value),className:"w-full bg-[#1a1a1a] border border-[#333] rounded-xl p-4 text-white outline-none",placeholder:"******"}),s.jsx("button",{onClick:()=>v(!b),className:"absolute left-4 top-4 text-gray-500",children:b?s.jsx(Io,{className:"w-5 h-5"}):s.jsx(Yi,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:"  "}),s.jsx("input",{type:"password",value:m,onChange:Y=>p(Y.target.value),className:"w-full bg-[#1a1a1a] border border-[#333] rounded-xl p-4 text-white outline-none",placeholder:"******"})]})]}),z&&s.jsx("div",{className:`p-4 rounded-xl text-sm font-bold text-center ${z.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:z.text}),s.jsx("button",{onClick:F,className:"w-full bg-blue-600 text-white font-bold py-4 rounded-xl shadow-lg active:scale-95",children:" "})]}),j&&s.jsx(jn,{title:" ",message:"      ",onClose:()=>O(!1),onConfirm:()=>{O(!1),e()},confirmButtonText:" ",cancelButtonText:"",confirmVariant:"danger"}),I&&s.jsx(jn,{title:"  ",message:"                   .",onClose:()=>R(!1),onConfirm:U,confirmButtonText:" ",cancelButtonText:"",confirmVariant:"success"})]})},Gee=({activePage:n,onNavigate:e,messageCount:t=0,theme:r,showMenu:i=!0})=>{const o=[{id:"home",key:"nav_home",label:"",icon:Qj},{id:"messages",key:"nav_messages",label:"",icon:Ni},...i?[{id:"menu",key:"nav_menu",label:"",icon:Si}]:[],{id:"history",key:"nav_history",label:"",icon:dr}];return s.jsx("div",{className:"fixed left-4 right-4 z-40 transition-transform duration-300 ease-in-out",style:{bottom:"calc(1.5rem + env(safe-area-inset-bottom))"},children:s.jsx("nav",{className:"bg-gray-900/95 backdrop-blur-xl border border-gray-700 shadow-[0_10px_40px_rgba(0,0,0,0.6)] flex justify-around items-center h-[70px] rounded-[30px] px-2 safe-area-pb",children:o.map(c=>{var p,b;const u=c.icon,h=(b=(p=r==null?void 0:r.merchant)==null?void 0:p.icons)==null?void 0:b[c.key],m=n===c.id;return s.jsxs("button",{onClick:()=>e(c.id),className:"group relative flex-1 h-full flex flex-col items-center justify-center outline-none select-none",style:{WebkitTapHighlightColor:"transparent"},children:[s.jsxs("div",{className:`relative transition-all duration-300 ease-out p-1.5 rounded-2xl ${m?"-translate-y-2":"translate-y-1"}`,children:[s.jsx("div",{className:`absolute inset-0 bg-red-500/20 blur-xl rounded-full transition-opacity duration-300 ${m?"opacity-100":"opacity-0"}`}),h?s.jsx("img",{src:h,alt:c.label,className:`w-6 h-6 object-contain z-10 relative ${m?"drop-shadow-md":"grayscale opacity-70"}`},h):s.jsx("div",{className:"relative z-10",children:s.jsx(u,{className:`w-6 h-6 transition-all duration-300 ${m?"text-red-500 drop-shadow-[0_2px_8px_rgba(239,68,68,0.4)]":"text-gray-500"}`})}),c.id==="messages"&&t>0&&s.jsx("span",{className:"absolute -top-1 -right-2 bg-red-600 text-white text-[10px] rounded-full w-4 h-4 flex items-center justify-center font-bold border-2 border-gray-900 animate-pulse z-20 shadow-sm",children:t})]}),s.jsx("span",{className:`text-[10px] font-bold tracking-wide transition-all duration-300 absolute bottom-2 ${m?"text-white translate-y-0 opacity-100":"text-gray-500 translate-y-2 opacity-0"}`,children:c.label}),m&&s.jsx("span",{className:"absolute bottom-1 w-1 h-1 bg-red-500 rounded-full shadow-[0_0_5px_rgba(239,68,68,0.8)]"})]},c.id)})})})},Wee=({message:n,onClose:e})=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50 p-4",onClick:e,children:s.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-sm text-white",onClick:t=>t.stopPropagation(),children:[s.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-bold text-neutral-100",children:"  "}),s.jsx("button",{onClick:e,className:"text-neutral-400 hover:text-white",children:s.jsx(ut,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"p-6 space-y-4 max-h-[60vh] overflow-y-auto",children:[n.image&&s.jsx("img",{src:n.image,alt:"",className:"w-full h-auto rounded-md object-contain"}),s.jsx("p",{className:"text-neutral-200 whitespace-pre-wrap",children:n.text})]}),s.jsx("div",{className:"bg-gray-900 px-4 py-3 flex justify-end rounded-b-lg",children:s.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none",children:""})})]})}),Kee=({merchant:n,orders:e,users:t,addOrder:r,messages:i,seenMessageIds:o,markMessageAsSeen:c,hideMessage:u,deletedMessageIds:h,onUpdateUser:m,onUpdateOrderStatus:p,onUpdateOrder:b,onLogout:v,appTheme:_,onUpdateTheme:T,initialRoute:k,appConfig:E,getNewId:S})=>{const[L,$]=w.useState("home"),[H,G]=w.useState(null),[z,P]=w.useState(null),j=Rn.useRef(!1),O=async()=>{if(!z&&!j.current){j.current=!0;try{console.log("[MerchantPortal] Pre-fetching ID...");const B=await S();P(B),j.current=!1}catch(B){console.error("Failed to pre-fetch ID",B),j.current=!1}}},I=async B=>{await r(B,z),P(null)},R=n.canManageMenu!==!1;w.useEffect(()=>{(k==null?void 0:k.target)==="incoming"||(k==null?void 0:k.target)==="orders"?$("incoming"):(k==null?void 0:k.target)==="messages"?$("messages"):(k==null?void 0:k.target)==="profile"&&$("profile")},[k]),w.useEffect(()=>{u0("merchant",n.id)},[n.id]),w.useEffect(()=>{Pn.reportContext(L)},[L]),sn(()=>H?(G(null),!0):L!=="home"?($("home"),!0):!1,[L,H]);const F=w.useMemo(()=>e.filter(B=>String(B.merchantId)===String(n.id)),[e,n.id]),M=w.useMemo(()=>F.filter(B=>B.status===ue.WaitingMerchant).length,[F]),ne=w.useMemo(()=>i.filter(B=>!h.includes(B.id)&&B.targetRole==="merchant").sort((B,Y)=>new Date(Y.createdAt).getTime()-new Date(B.createdAt).getTime()),[i,h]),U=w.useMemo(()=>ne.filter(B=>{var Y;return!((Y=B.readBy)!=null&&Y.includes(n.id))}).length,[ne,n.id]),A=()=>{switch(L){case"home":return s.jsxs("div",{className:"max-w-2xl mx-auto space-y-6 animate-fadeIn",children:[s.jsx(Uee,{addOrder:I,merchant:n,onInteraction:O}),M>0&&s.jsxs("button",{onClick:()=>$("incoming"),className:"w-full bg-purple-600/20 border border-purple-500 text-purple-200 p-4 rounded-xl flex justify-between items-center animate-pulse",children:[s.jsxs("span",{className:"font-bold",children:[" ",M,"  "]}),s.jsx("span",{className:"bg-purple-600 text-white px-3 py-1 rounded-full text-xs font-black",children:""})]})]});case"incoming":return s.jsx($ee,{orders:F,onUpdateStatus:p||(()=>{}),theme:_,users:t});case"history":return s.jsx(zee,{orders:F,users:t,viewingMerchant:n,onUpdateOrder:b});case"menu":return R?s.jsx(NO,{merchant:n,onUpdateMerchant:m||(()=>{})}):null;case"messages":return s.jsx(qee,{messages:ne,onMarkAsSeen:c,hideMessage:u});case"profile":return s.jsx(Hee,{merchant:n,onLogout:v,onUpdateUser:m||(()=>{}),onUpdateTheme:T,currentTheme:_});default:return null}},V=(E==null?void 0:E.appName)||"GOO NOW",[Q,...ae]=V.split(" "),X=ae.join(" ");return s.jsxs("div",{className:"fixed inset-0 bg-gray-900 text-white flex flex-col",children:[s.jsxs("header",{className:"flex-none border-b border-gray-700 flex justify-between items-center bg-gray-900 z-30 shadow-md pt-safe px-4 h-16 box-content",children:[s.jsx("div",{className:"flex items-center",children:s.jsx("button",{onClick:()=>$("profile"),className:"relative w-10 h-10 flex items-center justify-center rounded-full transition-transform active:scale-95",children:s.jsx(Ji,{frameId:n.specialFrame,size:"sm",children:s.jsx("div",{className:`w-full h-full rounded-full overflow-hidden border border-gray-600 flex items-center justify-center bg-gray-800 ${L==="profile"?"ring-2 ring-red-500":""}`,children:n.storeImage?s.jsx("img",{src:n.storeImage,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-5 h-5 text-gray-400"})})})})}),s.jsxs("h1",{className:"text-xl font-bold font-sans",children:[s.jsx("span",{className:"text-red-500",children:Q}),s.jsx("span",{className:"text-white ml-1",children:X})]}),s.jsxs("button",{onClick:()=>$("incoming"),className:"relative p-2",children:[s.jsx(zs,{className:`w-6 h-6 ${M>0?"text-yellow-400":"text-gray-400"}`}),M>0&&s.jsx("span",{className:"absolute top-1 right-1 w-2.5 h-2.5 bg-red-500 rounded-full animate-bounce"})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto pb-24 p-4 hardware-accelerated",children:[H&&s.jsx(Wee,{message:H,onClose:()=>{c(H.id),G(null)}}),A()]}),s.jsx(Gee,{activePage:L,onNavigate:B=>$(B),messageCount:U,theme:_,showMenu:R})]})},Qee=Rn.memo(({order:n,users:e,onViewDetails:t,theme:r})=>{var p;const i=n.status===ue.Pending,o=n.type==="shopping_order",c=w.useMemo(()=>e==null?void 0:e.find(b=>b.id===n.merchantId),[e,n.merchantId]),u=w.useMemo(()=>{try{let b;const v=n.createdAt;return v&&typeof v.toDate=="function"?b=v.toDate():v&&v.seconds?b=new Date(v.seconds*1e3):v instanceof Date?b=v:b=new Date(v),isNaN(b.getTime())?{day:"---",date:"---",time:"---"}:{day:b.toLocaleDateString("ar-EG-u-nu-latn",{weekday:"long"}),date:b.toLocaleDateString("ar-EG-u-nu-latn",{day:"numeric",month:"numeric",year:"numeric"}),time:b.toLocaleTimeString("ar-EG-u-nu-latn",{hour:"numeric",minute:"numeric",hour12:!0})}}catch{return{day:"---",date:"---",time:"---"}}},[n.createdAt]),h=b=>{if(b!=null&&b.startsWith("data:")||b!=null&&b.startsWith("http"))return"p-0";switch(b){case"gold":return"p-[2px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[2px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[2px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[2px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-0"}},m=b=>(b==null?void 0:b.startsWith("data:"))||(b==null?void 0:b.startsWith("http"));return s.jsxs("button",{type:"button",onClick:b=>{b.stopPropagation(),t()},className:`w-full text-right bg-[#1e1e1e] rounded-2xl overflow-hidden shadow-lg transition-all duration-200 relative group border ${o?"border-purple-500/30":"border-white/5"} active:scale-[0.98] mb-1 cursor-pointer select-none`,children:[s.jsx("div",{className:`absolute right-0 top-0 bottom-0 w-1.5 z-10 ${o?"bg-gradient-to-b from-purple-600 to-indigo-500":i?"bg-gradient-to-b from-blue-500 to-blue-700":"bg-gradient-to-b from-green-500 to-emerald-700"}`}),o&&s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-900/10 to-transparent pointer-events-none"}),s.jsxs("div",{className:"p-4 pl-3 relative z-0",children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"font-mono text-base font-black text-red-500 tracking-wider",children:["#",n.id]}),o&&s.jsxs("span",{className:"bg-purple-500/10 text-purple-400 text-[9px] font-bold px-2 py-0.5 rounded border border-purple-500/20 flex items-center gap-1",children:[s.jsx(en,{className:"w-3 h-3"})," "]}),n.isVodafoneCash&&s.jsxs("span",{className:"bg-red-600/20 text-red-400 text-[9px] font-bold px-2 py-0.5 rounded border border-red-500/30 flex items-center gap-1",children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"})," "]})]}),s.jsx("div",{className:"flex items-center gap-1",children:s.jsx("span",{className:`text-[10px] font-black px-2 py-1 rounded-lg ${i?"bg-blue-500/10 text-blue-400 border border-blue-500/20 animate-pulse":"bg-green-500/10 text-green-400 border border-green-500/20"}`,children:i?" ":n.status})})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-1.5 bg-black/30 px-2 py-1 rounded border border-white/5 shadow-inner",children:[s.jsx(ei,{className:"w-3.5 h-3.5 text-blue-400"}),s.jsxs("span",{className:"text-[10px] font-black text-gray-300",children:[u.day," ",u.date]})]}),s.jsxs("div",{className:"flex items-center gap-1.5 bg-black/30 px-2 py-1 rounded border border-white/5 shadow-inner",children:[s.jsx(It,{className:"w-3.5 h-3.5 text-yellow-400"}),s.jsx("span",{className:"text-[10px] font-black text-gray-300 font-mono",children:u.time})]})]}),s.jsxs("div",{className:"space-y-3 pr-1",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"mt-0.5 p-1.5 rounded-full bg-blue-500/10 text-blue-400 flex-shrink-0",children:s.jsx(fs,{className:"w-4 h-4"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-[9px] text-gray-500 font-bold mb-0.5 uppercase",children:"  ()"}),s.jsx("p",{className:"text-gray-200 font-bold text-sm leading-tight line-clamp-2",children:((p=n.customer)==null?void 0:p.address)||"  "})]})]}),s.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-xl border ${o?"bg-purple-900/10 border-purple-500/10":"bg-white/5 border-white/5"}`,children:[s.jsxs("div",{className:`relative flex items-center justify-center rounded-full flex-shrink-0 ${m(c==null?void 0:c.specialFrame)?"":h(c==null?void 0:c.specialFrame)}`,children:[m(c==null?void 0:c.specialFrame)&&s.jsx("img",{src:c==null?void 0:c.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-125 pointer-events-none",alt:"frame"}),s.jsx("div",{className:`${m(c==null?void 0:c.specialFrame)?"w-[85%] h-[85%]":"w-8 h-8"} rounded-full overflow-hidden bg-purple-500/10 flex items-center justify-center border border-purple-500/20 relative z-0`,children:o?s.jsx(en,{className:"w-4 h-4 text-purple-400"}):s.jsx(Ar,{className:"w-4 h-4 text-purple-400"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:`text-[9px] font-bold mb-0.5 uppercase ${o?"text-purple-300":"text-purple-400"}`,children:o?" ":" ()"}),o?s.jsxs("p",{className:"text-gray-200 text-xs leading-relaxed line-clamp-2 italic",children:['"',n.notes||"   ",'"']}):s.jsx("h4",{className:"font-black text-white text-sm truncate group-hover:text-red-400 transition-colors",children:(c==null?void 0:c.name)||n.merchantName||"   "})]})]})]}),s.jsxs("div",{className:"mt-4 pt-3 flex justify-between items-center bg-black/20 -mx-4 -mb-4 px-4 py-3",children:[s.jsx("div",{className:"flex flex-col",children:n.deliveryFee&&(n.status===ue.InTransit||n.status===ue.Delivered)?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-[9px] text-gray-500 font-bold",children:" "}),s.jsxs("span",{className:"text-green-400 font-black text-base leading-none",children:[n.deliveryFee.toLocaleString("en-US")," ",s.jsx("span",{className:"text-[9px] font-medium",children:"."})]})]}):s.jsx("span",{className:"text-[10px] font-bold text-gray-400 italic",children:"    "})}),s.jsxs("div",{className:"flex items-center gap-1.5 text-gray-400 text-[10px] font-black bg-white/5 px-3 py-1.5 rounded-xl border border-white/5 group-hover:bg-white/10 transition-all",children:[s.jsx("span",{children:" "}),s.jsx(us,{className:"w-3.5 h-3.5 group-hover:-translate-x-1 transition-transform"})]})]})]})]})},(n,e)=>n.order.id===e.order.id&&n.order.status===e.order.status&&n.order.driverId===e.order.driverId&&n.order.deliveryFee===e.order.deliveryFee&&n.order.totalPrice===e.order.totalPrice&&n.users===e.users&&n.theme===e.theme),I_=()=>s.jsxs("div",{className:"bg-[#2A2A2A] rounded-xl p-4 border border-gray-700/50 animate-pulse",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-white/5 rounded-full"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"h-3 w-32 bg-white/10 rounded"}),s.jsx("div",{className:"h-2 w-20 bg-white/5 rounded"})]})]}),s.jsx("div",{className:"h-6 w-16 bg-white/5 rounded-full"})]}),s.jsxs("div",{className:"space-y-3 my-4",children:[s.jsx("div",{className:"h-2 w-full bg-white/5 rounded"}),s.jsx("div",{className:"h-2 w-3/4 bg-white/5 rounded"})]}),s.jsxs("div",{className:"flex gap-2 mt-4",children:[s.jsx("div",{className:"flex-1 h-10 bg-white/10 rounded-lg"}),s.jsx("div",{className:"flex-1 h-10 bg-white/5 rounded-lg"})]})]}),Yee=({customImage:n})=>s.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 min-h-[60vh]",children:[s.jsx("div",{className:"relative mb-4 opacity-50",children:n?s.jsx("img",{src:n,alt:"Empty",className:"w-40 h-40 object-contain"}):s.jsxs("svg",{className:"w-40 h-40",viewBox:"0 0 100 100",children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"grad1",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[s.jsx("stop",{offset:"0%",style:{stopColor:"rgb(59, 130, 246)",stopOpacity:.5}}),s.jsx("stop",{offset:"100%",style:{stopColor:"rgb(239, 68, 68)",stopOpacity:.5}})]})}),s.jsx("path",{d:"M 50,5 L 95,27.5 L 95,72.5 L 50,95 L 5,72.5 L 5,27.5 Z",fill:"url(#grad1)",fillOpacity:"0.1"}),s.jsx("path",{d:"M 50,5 L 95,27.5 L 50,50 L 5,27.5 Z",fill:"url(#grad1)",fillOpacity:"0.15"}),s.jsx("path",{d:"M 95,27.5 L 95,72.5 L 50,50 Z",fill:"url(#grad1)",fillOpacity:"0.1"}),s.jsx("path",{d:"M 5,27.5 L 5,72.5 L 50,50 Z",fill:"url(#grad1)",fillOpacity:"0.2"}),s.jsx("g",{transform:"translate(35, 30) scale(1.2)",children:s.jsx(Cy,{})})]})}),s.jsx("h3",{className:"text-lg font-semibold text-neutral-400 mt-2",children:"   "})]}),C_=({orders:n,users:e,onViewOrder:t,theme:r,isLoading:i})=>{var o,c;return i?s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsx(I_,{}),s.jsx(I_,{}),s.jsx(I_,{})]}):n.length===0?s.jsx(Yee,{customImage:(c=(o=r==null?void 0:r.driver)==null?void 0:o.icons)==null?void 0:c.img_empty_orders}):s.jsx("div",{className:"p-4 space-y-3",children:n.map((u,h)=>s.jsx("div",{className:"animate-fade-in-up hardware-accelerated",style:{animationDelay:"0ms"},children:s.jsx(Qee,{order:u,users:e,onViewDetails:()=>t(u),theme:r})},u.id))})},Xee=({onStartShift:n})=>s.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-white h-[calc(100vh-8rem)] p-4",children:[s.jsxs("div",{className:"relative mb-6",children:[s.jsx("div",{className:"absolute inset-0 bg-red-500 rounded-full blur-2xl opacity-30 animate-pulse"}),s.jsx(yZ,{className:"w-24 h-24 text-gray-500 relative z-10"})]}),s.jsx("h2",{className:"text-2xl font-bold text-neutral-100 mb-2",children:"   "}),s.jsx("p",{className:"text-neutral-400 mb-8 max-w-xs",children:"  .           ."}),s.jsx("button",{onClick:n,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-lg transition-transform transform hover:scale-105 shadow-lg",children:" "})]}),Jee=n=>{const{activeTab:e,users:t}=n,r=()=>{n.customStartShift?n.customStartShift():n.onUpdateUser(n.driver.id,{dailyLogStatus:"active",dailyLogStartedAt:new Date})};return n.driver.dailyLogMode==="12_hour"&&n.driver.dailyLogStatus!=="active"?s.jsx(Xee,{onStartShift:r}):s.jsxs("div",{className:"bg-[#1A1A1A] min-h-full",children:[e==="home"&&s.jsx(C_,{orders:n.standardNewOrders,users:t,listType:"new",onViewOrder:n.onViewOrder,theme:n.theme,isLoading:n.isLoading}),e==="in-transit"&&s.jsx(C_,{orders:n.inTransitOrders,users:t,listType:"in-transit",onViewOrder:n.onViewOrder,theme:n.theme,isLoading:n.isLoading}),e==="delinow"&&s.jsx(C_,{orders:n.delinowNewOrders,users:t,listType:"new",onViewOrder:n.onViewOrder,theme:n.theme,isLoading:n.isLoading})]})},sx=({label:n,value:e,currency:t=".",colorClass:r="text-white"})=>s.jsxs("div",{className:"flex justify-between items-baseline bg-[#2A2A2A] p-3 rounded-md",children:[s.jsx("span",{className:"text-sm font-medium text-gray-400",children:n}),s.jsxs("span",{className:`text-lg font-bold ${r}`,children:[e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})," ",t]})]}),Zee=({driver:n,orders:e,users:t})=>{const r=e.filter(T=>{const k=String(T.driverId)===String(n.id),E=T.status===ue.Delivered,S=T.status!==ue.Cancelled,L=!T.reconciled,$=!T.isArchived;return k&&E&&S&&L&&$}),i=T=>Math.round((T+Number.EPSILON)*100)/100,o=T=>typeof T=="number"?T:typeof T=="string"&&parseFloat(T)||0,c=r.reduce((T,k)=>T+o(k.deliveryFee),0),u=o(n.commissionRate);let h=0;n.commissionType==="fixed"?h=r.length*u:h=c*(u/100);const m=o(n.walletOpeningBalance),p=i(c),b=i(h),v=i(p-b+m),_=n.commissionType==="fixed"?`${u} ./`:`${u}%`;return s.jsxs("div",{className:"p-4 text-white",children:[s.jsxs("div",{className:"bg-[#1F1F1F] p-5 rounded-xl shadow-lg flex flex-col space-y-4 border-t-4 border-red-500",children:[s.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[s.jsx("div",{className:"p-3 bg-gray-700 rounded-full",children:s.jsx(Kj,{className:"w-6 h-6 text-red-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-lg text-white",children:""}),s.jsx("p",{className:"text-xs text-gray-400",children:"  ( )"})]})]}),s.jsxs("div",{className:"space-y-2 pt-3 border-t border-gray-700",children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-400 mb-2",children:["  (",r.length," ",r.length===1?"":"",")"]}),o(n.walletOpeningBalance)!==0&&s.jsx(sx,{label:"  ()",value:o(n.walletOpeningBalance),colorClass:"text-yellow-400"}),s.jsx(sx,{label:"  ()",value:p,colorClass:"text-blue-400"}),s.jsx(sx,{label:`  (${_})`,value:b,colorClass:"text-red-400"}),s.jsx(sx,{label:" ",value:v,colorClass:"text-green-400"})]}),s.jsx("div",{className:"text-center pt-4",children:s.jsx("p",{className:"text-xs text-gray-500",children:"         ."})})]}),s.jsxs("div",{className:"mt-6",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"   "}),r.length>0?s.jsx("div",{className:"space-y-4",children:r.map((T,k)=>{const E=t.find(L=>L.id===T.merchantId),S=(()=>{try{if(!T.deliveredAt)return"";const L=new Date(T.deliveredAt);return isNaN(L.getTime())?"":L.toLocaleString("ar-EG-u-nu-latn",{month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"})}catch{return""}})();return s.jsxs("div",{className:"bg-[#2A2A2A] p-4 rounded-lg shadow-md border border-gray-700 flex flex-col space-y-4 animate-fade-in-up hardware-accelerated",style:{animationDelay:`${Math.min(k*50,500)}ms`},children:[s.jsxs("div",{className:"flex justify-between items-center pb-3 border-b border-gray-700",children:[s.jsx("span",{className:"font-mono text-sm text-gray-400",children:T.id}),s.jsxs("span",{className:"text-xl font-bold text-green-400",children:[o(T.deliveryFee).toLocaleString("en-US")," ."]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-start space-x-3 space-x-reverse",children:[s.jsx(fs,{className:"w-5 h-5 text-red-400 mt-1 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-400",children:""}),s.jsx("p",{className:"font-semibold text-white",children:T.customer.address}),s.jsxs("p",{className:"text-sm text-gray-300 flex items-center mt-1",children:[s.jsx(zn,{className:"w-4 h-4 ml-2"}),s.jsx("span",{children:T.customer.phone})]})]})]}),s.jsxs("div",{className:"flex items-start space-x-3 space-x-reverse",children:[s.jsx(Xl,{className:"w-5 h-5 text-blue-400 mt-1 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-400",children:""}),s.jsx("p",{className:"font-semibold text-white",children:T.merchantName}),(E==null?void 0:E.phone)&&s.jsxs("p",{className:"text-sm text-gray-300 flex items-center mt-1",children:[s.jsx(zn,{className:"w-4 h-4 ml-2"}),s.jsx("span",{children:E.phone})]})]})]})]}),s.jsxs("div",{className:"flex items-center justify-end text-xs text-neutral-500 pt-3 border-t border-gray-700",children:[s.jsx(It,{className:"w-4 h-4 ml-2"}),s.jsxs("span",{children:[" : ",S]})]})]},T.id)})}):s.jsx("div",{className:"bg-[#1F1F1F] p-8 rounded-lg text-center text-gray-500 border border-gray-800",children:s.jsx("p",{children:" !    ."})})]})]})},ete=({activePage:n,onNavigate:e,messageCount:t,theme:r,appConfig:i})=>{const o=(i==null?void 0:i.isGamesEnabled)??!0;return s.jsxs("nav",{className:"fixed bottom-0 left-0 right-0 bg-[#1A1A1A] border-t border-[#333] flex justify-around items-end h-[80px] z-40 pb-5 safe-area-pb transition-all duration-300",children:[s.jsxs("button",{onClick:()=>e("home"),className:"group relative flex-1 h-full flex flex-col items-center justify-center outline-none select-none",style:{WebkitTapHighlightColor:"transparent"},children:[s.jsx("div",{className:`relative transition-all duration-300 ease-out p-1.5 rounded-2xl ${n==="home"?"-translate-y-1.5":"translate-y-1"}`,children:s.jsx(Qj,{className:`w-6 h-6 transition-all duration-300 ${n==="home"?"text-red-500 drop-shadow-[0_2px_8px_rgba(239,68,68,0.4)]":"text-gray-500"}`})}),s.jsx("span",{className:`text-[10px] font-bold tracking-wide transition-all duration-300 ${n==="home"?"text-white":"text-gray-500"}`,children:""})]}),o&&s.jsxs("button",{onClick:()=>e("games"),className:"group relative flex-1 h-full flex flex-col items-center justify-center outline-none select-none",style:{WebkitTapHighlightColor:"transparent"},children:[s.jsx("div",{className:`relative transition-all duration-300 ease-out p-1.5 rounded-2xl ${n==="games"?"-translate-y-1.5 scale-110":"translate-y-1"}`,children:s.jsx(Ah,{className:`w-6 h-6 transition-all duration-300 ${n==="games"?"text-purple-500 drop-shadow-[0_2px_8px_rgba(168,85,247,0.4)]":"text-gray-500"}`})}),s.jsx("span",{className:`text-[10px] font-bold tracking-wide transition-all duration-300 ${n==="games"?"text-white":"text-gray-500"}`,children:""})]}),s.jsxs("button",{onClick:()=>e("wallet"),className:"group relative flex-1 h-full flex flex-col items-center justify-center outline-none select-none",style:{WebkitTapHighlightColor:"transparent"},children:[s.jsx("div",{className:`relative transition-all duration-300 ease-out p-1.5 rounded-2xl ${n==="wallet"?"-translate-y-1.5":"translate-y-1"}`,children:s.jsx(Kj,{className:`w-6 h-6 transition-all duration-300 ${n==="wallet"?"text-amber-500 drop-shadow-[0_2px_8px_rgba(245,158,11,0.4)]":"text-gray-500"}`})}),s.jsx("span",{className:`text-[10px] font-bold tracking-wide transition-all duration-300 ${n==="wallet"?"text-white":"text-gray-500"}`,children:""})]})]})},A_=({phone:n})=>n?s.jsxs("div",{className:"flex gap-3 mt-3 pt-3 border-t border-white/5",children:[s.jsxs("a",{href:`tel:${n}`,className:"flex-1 bg-blue-500/10 hover:bg-blue-500/20 text-blue-400 border border-blue-500/20 py-2.5 rounded-xl flex items-center justify-center gap-2 transition-all active:scale-95 clickable",children:[s.jsx(zn,{className:"w-4 h-4"}),s.jsx("span",{className:"font-bold text-sm",children:""})]}),s.jsxs("a",{href:`https://wa.me/2${n}`,target:"_blank",rel:"noopener noreferrer",className:"flex-1 bg-green-500/10 hover:bg-green-500/20 text-green-400 border border-green-500/20 py-2.5 rounded-xl flex items-center justify-center gap-2 transition-all active:scale-95 clickable",children:[s.jsx(nd,{className:"w-4 h-4"}),s.jsx("span",{className:"font-bold text-sm",children:""})]})]}):null,tte=({order:n,users:e,listType:t,driver:r,onAcceptOrder:i,onUpdateStatus:o,onBack:c,theme:u})=>{var I,R,F,M,ne;const[h,m]=w.useState(n.deliveryFee?n.deliveryFee.toString():""),[p,b]=w.useState(""),v=e.find(U=>U.id===n.merchantId),[_,T]=w.useState(null);w.useEffect(()=>{!v&&n.merchantId&&n.merchantId!=="delinow"&&!n.merchantPhone&&!_&&(console.log("Merchant details missing, fetching from server...",n.merchantId),Cg(n.merchantId).then(U=>{U.success&&U.data&&T(U.data)}))},[n.merchantId,v,n.merchantPhone]);const k={name:(v==null?void 0:v.name)||(_==null?void 0:_.name)||n.merchantName||"",phone:(v==null?void 0:v.phone)||(_==null?void 0:_.phone)||n.merchantPhone,image:(v==null?void 0:v.storeImage)||(_==null?void 0:_.storeImage)||n.merchantImage},E=()=>{const U=parseFloat(h);if(isNaN(U)||U<=0){b("  ");return}if(n.deliveryFee&&U<n.deliveryFee){b(`         (${n.deliveryFee} .)`);return}b(""),i(n.id,r.id,U)},S=(()=>{try{const U=new Date(n.createdAt);if(isNaN(U.getTime()))return"";const A=U.toLocaleDateString("ar-EG",{weekday:"long"}),V=U.toLocaleDateString("ar-EG",{day:"numeric",month:"numeric"}),Q=U.toLocaleTimeString("ar-EG",{hour:"numeric",minute:"numeric"});return`${A} ${V} - ${Q}`}catch{return""}})(),L=n.type==="shopping_order"&&(!n.items||n.items.length===0);let $=n.notes||"",H="",G=null;if(L&&n.notes){const U=n.notes.split("-----------");if($=U[0].trim(),U.length>1){H=U[1].trim();const A=H.match(/01[0125][0-9]{8}/);A&&(G=A[0])}}const z=n.finalPrice??n.totalPrice??0,P=n.isVodafoneCash||n.paymentStatus==="paid",j=(n.deliveryFee||0)+(P?0:z),O=h!==""&&!isNaN(parseFloat(h))&&parseFloat(h)>0;return s.jsxs("div",{className:"fixed inset-0 flex flex-col bg-[#1A1A1A] text-white overflow-hidden z-[60]",children:[s.jsx("div",{className:"flex-none bg-[#1F1F1F] border-b border-white/5 shadow-sm z-10 pt-safe",children:s.jsxs("div",{className:"px-5 py-3 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:c,className:"p-2 -mr-2 text-gray-300 hover:text-white bg-white/5 hover:bg-white/10 rounded-full transition-colors active:scale-95 clickable",children:s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5 rotate-180",children:[s.jsx("path",{d:"M5 12h14"}),s.jsx("path",{d:"M12 5l7 7-7 7"})]})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-xl font-black text-red-500 font-mono tracking-wider leading-none",children:["#",n.id]}),s.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] text-gray-400 mt-1.5",children:[s.jsx(It,{className:"w-3 h-3 text-gray-500"}),s.jsx("span",{children:S})]})]})]}),n.type==="shopping_order"?s.jsxs("div",{className:"bg-purple-500/10 text-purple-300 px-3 py-1.5 rounded-lg text-[10px] font-bold border border-purple-500/20 flex items-center gap-1.5",children:[s.jsx(en,{className:"w-3.5 h-3.5"}),L?" ":""]}):s.jsxs("div",{className:"bg-blue-500/10 text-blue-300 px-3 py-1.5 rounded-lg text-[10px] font-bold border border-blue-500/20 flex items-center gap-1.5",children:[s.jsx(dr,{className:"w-3.5 h-3.5"})," "]})]})}),s.jsxs("div",{className:`flex-1 overflow-y-auto p-4 space-y-5 custom-scrollbar ${t==="in-transit"?"pb-44":"pb-10"}`,children:[s.jsx("div",{className:"bg-[#252525] rounded-2xl border border-white/5 p-4 shadow-lg relative overflow-hidden",children:s.jsxs("div",{className:"flex items-start gap-4 relative z-10",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-[#1A1A1A] border-2 border-red-500/30 flex items-center justify-center shadow-lg text-red-400 flex-shrink-0",children:s.jsx(fs,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-[10px] text-gray-400 font-bold mb-0.5 uppercase tracking-wider",children:" ( )"}),s.jsx("h3",{className:"text-lg font-bold text-white leading-snug break-words",children:((I=n.customer)==null?void 0:I.address)||"  "}),s.jsx("p",{className:"text-sm text-gray-300 font-medium mt-1",children:((R=n.customer)==null?void 0:R.name)||""})]}),s.jsx("span",{className:"text-xs text-cyan-400 font-bold font-mono bg-black/20 px-2 py-1 rounded text-left mt-1 selectable",dir:"ltr",children:(F=n.customer)==null?void 0:F.phone})]}),s.jsx(A_,{phone:((M=n.customer)==null?void 0:M.phone)||""})]})]})}),L?s.jsxs("div",{className:"bg-[#2A2A2A] rounded-2xl border border-dashed border-purple-500/30 p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(dr,{className:"w-4 h-4 text-purple-400"}),s.jsx("h4",{className:"text-xs font-bold text-gray-300",children:"  "})]}),s.jsx("p",{className:"text-sm text-white leading-relaxed whitespace-pre-wrap font-medium",children:$}),G&&s.jsxs("div",{className:"mt-3 pt-2 border-t border-white/5",children:[s.jsxs("p",{className:"text-[10px] text-green-400 flex items-center gap-1 mb-2",children:[s.jsx(Je,{className:"w-3 h-3"}),"    : ",s.jsx("span",{className:"font-mono text-white ml-1 text-left selectable",dir:"ltr",children:G})]}),s.jsx(A_,{phone:G})]})]}):s.jsxs("div",{className:"bg-[#252525] rounded-2xl border border-white/5 p-4 relative overflow-hidden",children:[(!n.items||n.items.length===0)&&n.notes?s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(dr,{className:"w-4 h-4 text-purple-400"}),s.jsx("h4",{className:"text-xs font-bold text-gray-300",children:"  ( )"})]}),s.jsx("p",{className:"text-sm text-white leading-relaxed whitespace-pre-wrap font-medium bg-[#1A1A1A] p-3 rounded-xl border border-white/5",children:n.notes})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3 relative z-10",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Zu,{className:"w-4 h-4 text-green-400"}),s.jsx("h4",{className:"text-xs font-bold text-gray-300",children:" "})]}),s.jsx("span",{className:`text-xs font-bold ${n.isVodafoneCash?"text-green-400":"text-white"} bg-black/20 px-2 py-0.5 rounded`,children:n.isVodafoneCash||n.paymentStatus==="paid"?" ":`${Math.floor(z)} .`})]}),!n.isCollected&&n.assignedTo&&s.jsx("div",{className:"space-y-3 relative z-10",children:(ne=n.items)==null?void 0:ne.map((U,A)=>s.jsxs("div",{className:"flex justify-between items-center bg-[#1A1A1A] p-2 rounded-lg border border-white/5",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"w-6 h-6 rounded bg-gray-700 flex items-center justify-center text-xs font-bold text-white",children:[U.quantity,"x"]}),s.jsx("span",{className:"text-sm text-gray-200",children:U.name})]}),s.jsx("span",{className:"text-sm font-mono text-gray-400",children:U.price})]},A))})]}),k&&s.jsxs("div",{className:"mt-4 pt-3 border-t border-white/5",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-xs text-purple-400 font-bold flex items-center gap-1",children:[s.jsx(Xl,{className:"w-3 h-3"})," "]}),k.image&&s.jsx("img",{src:k.image,alt:k.name,className:"w-5 h-5 rounded-full object-cover border border-purple-500/30"})]}),s.jsx("span",{className:"text-sm text-white font-bold block mt-1",children:k.name})]}),k.phone&&s.jsx("span",{className:"text-xs text-purple-300 font-bold font-mono bg-black/20 px-2 py-1 rounded text-left mt-1 selectable",dir:"ltr",children:k.phone})]}),s.jsx(A_,{phone:k.phone||""})]})]}),t==="new"&&s.jsxs("div",{className:"bg-[#1F1F1F] p-4 rounded-2xl border border-white/5 shadow-lg mt-2",children:[h&&!isNaN(parseFloat(h))&&s.jsxs("div",{className:"mb-4 bg-black/20 p-3 rounded-xl border border-white/5 flex justify-between items-center animate-fadeIn",children:[s.jsx("span",{className:"text-xs text-gray-400",children:"   "}),s.jsxs("div",{className:"text-right",children:[s.jsxs("span",{className:"text-xl font-black text-green-400 block leading-none",children:[n.isVodafoneCash||n.paymentStatus==="paid"?parseFloat(h):z+parseFloat(h)," ",s.jsx("span",{className:"text-xs font-bold text-gray-500",children:"."})]}),s.jsx("span",{className:"text-[9px] text-gray-500 mt-1 block",children:n.isVodafoneCash||n.paymentStatus==="paid"?"( )":`(${z}  + ${h} )`})]})]}),s.jsxs("div",{className:"flex gap-3 items-center",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("input",{type:"number",inputMode:"decimal",value:h,onChange:U=>{m(U.target.value),b("")},placeholder:"0",className:"w-full bg-[#111] border border-gray-600 rounded-xl px-4 py-3 text-white font-bold text-center text-lg outline-none focus:border-red-500 transition-colors"}),s.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 text-xs font-bold pointer-events-none",children:"."}),p&&s.jsx("div",{className:"absolute -top-8 left-0 right-0 text-red-500 text-xs text-center font-bold bg-[#1F1F1F] py-1 rounded shadow-md border border-red-500/30",children:p})]}),s.jsxs("button",{onClick:E,disabled:!O,className:`flex-[2] text-white font-bold py-3.5 rounded-xl shadow-lg transition-all flex items-center justify-center gap-2 clickable
                                    ${O?"bg-red-600 hover:bg-red-700 active:scale-95":"bg-gray-700 text-gray-400 opacity-50 cursor-not-allowed shadow-none"}`,children:[s.jsx(Je,{className:"w-5 h-5"}),"  "]})]})]})]}),t==="in-transit"&&s.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-[#1F1F1F] border-t border-white/5 z-50 shadow-[0_-5px_20px_rgba(0,0,0,0.4)] transition-all duration-200",style:{paddingBottom:"calc(1rem + env(safe-area-inset-bottom))"},children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between items-center bg-black/20 p-3 rounded-xl border border-white/5",children:[s.jsx("span",{className:"text-xs text-gray-400",children:"  ( )"}),s.jsxs("span",{className:"text-xl font-black text-green-400",children:[j," ",s.jsx("span",{className:"text-xs font-bold text-gray-500",children:"."})]})]}),s.jsxs("button",{onClick:()=>o(n.id,ue.Delivered),className:"w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 rounded-xl shadow-lg active:scale-95 transition-all flex items-center justify-center gap-2 clickable",children:[s.jsx(Je,{className:"w-5 h-5"}),"  "]})]})})]})},rx=({icon:n,label:e,subLabel:t,onClick:r,danger:i,active:o,disabled:c})=>s.jsxs("button",{onClick:c?void 0:r,className:`w-full flex items-center justify-between p-4 rounded-xl border border-transparent transition-all ${c?"cursor-default opacity-80":"active:scale-[0.98]"} ${i?"bg-red-900/10 hover:bg-red-900/20 text-red-500":"bg-[#252525] hover:bg-[#303030] text-white hover:border-[#333]"}`,children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`p-2.5 rounded-full ${i?"bg-red-500/10":o?"bg-green-500/20 text-green-400":"bg-gray-800 text-gray-300"}`,children:Rn.cloneElement(n,{className:`w-5 h-5 ${i?"text-red-500":""}`})}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:`font-bold text-sm ${i?"text-red-400":"text-gray-200"}`,children:e}),t&&s.jsx("p",{className:`text-xs mt-0.5 ${o?"text-green-400":"text-gray-500"}`,children:t})]})]}),!i&&!c&&s.jsx(us,{className:"w-5 h-5 text-gray-600"}),c&&o&&s.jsx(Je,{className:"w-5 h-5 text-green-500"})]}),nte=({driver:n,onClose:e,onLogout:t,onUpdateUser:r,onUpdateTheme:i,currentTheme:o})=>{const[c,u]=w.useState("menu"),[h,m]=w.useState(""),[p,b]=w.useState(""),[v,_]=w.useState(!1),[T,k]=w.useState(n.storeImage||null),[E,S]=w.useState(!1),[L,$]=w.useState(null),H=w.useRef(null),[G,z]=w.useState(!1),[P,j]=w.useState(null),O=n.dailyLogStatus==="active",I=n.dailyLogMode==="always_open",R=()=>{if(!h||h.length<6){$({text:"     6   .",type:"error"});return}if(h!==p){$({text:"   .",type:"error"});return}r(n.id,{password:h}),$({text:"    .",type:"success"}),setTimeout(()=>{u("menu"),m(""),b(""),$(null)},1500)},F=()=>{if(n.dailyLogMode==="always_open")return;const Q=n.dailyLogStatus==="active"?"closed":"active",ae={dailyLogStatus:Q};Q==="active"&&(ae.dailyLogStartedAt=new Date),r(n.id,ae)},M=Q=>{var X;const ae=(X=Q.target.files)==null?void 0:X[0];if(ae){const B=new FileReader;B.onload=()=>{j(B.result),z(!0)},B.readAsDataURL(ae)}},ne=async Q=>{S(!0);try{const ae=new FileReader;ae.readAsDataURL(Q),ae.onloadend=()=>{const X=ae.result;k(X),r(n.id,{storeImage:X}),S(!1),z(!1),j(null)}}catch(ae){console.error("Error processing cropped image:",ae),S(!1)}},U=Q=>{if(Q!=null&&Q.startsWith("data:")||Q!=null&&Q.startsWith("http"))return"p-0";switch(Q){case"gold":return"p-[4px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_15px_rgba(252,246,186,0.5)]";case"neon":return"p-[4px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_15px_rgba(34,211,238,0.6)]";case"royal":return"p-[4px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-xl border border-purple-500/30";case"fire":return"p-[4px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_15px_rgba(239,68,68,0.5)]";default:return"p-0"}},A=Q=>{if(!Q||Q==="none")return null;if(Q!=null&&Q.startsWith("data:")||Q!=null&&Q.startsWith("http"))return s.jsx("div",{className:"w-8 h-8 min-w-[2rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:s.jsx("img",{src:Q,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let ae=null,X="";switch(Q){case"verified":ae=Mo,X="text-blue-400 fill-blue-500/20";break;case"vip":ae=Xi,X="text-yellow-400 fill-yellow-500/20";break;case"star":ae=ti,X="text-purple-400 fill-purple-500/20";break;case"popular":ae=en,X="text-red-400 fill-red-500/20";break}return ae?s.jsx(ae,{className:`w-6 h-6 ml-2 ${X}`}):null},V=Q=>(Q==null?void 0:Q.startsWith("data:"))||(Q==null?void 0:Q.startsWith("http"));return s.jsxs("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm flex justify-center items-end sm:items-center z-50 animate-fadeIn",onClick:e,children:[s.jsxs("div",{className:"bg-[#1a1a1a] w-full sm:max-w-md h-[90vh] sm:h-auto rounded-t-3xl sm:rounded-3xl border-t sm:border border-[#333] shadow-2xl flex flex-col relative overflow-hidden",onClick:Q=>Q.stopPropagation(),children:[s.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-[#333]",children:[c==="settings"?s.jsxs("button",{onClick:()=>u("menu"),className:"text-gray-400 hover:text-white flex items-center gap-1",children:[s.jsx(us,{className:"w-5 h-5 rotate-180"}),s.jsx("span",{className:"text-sm font-bold",children:""})]}):s.jsx("h3",{className:"text-xl font-bold text-white",children:" "}),s.jsx("button",{onClick:e,className:"bg-[#252525] p-2 rounded-full text-gray-400 hover:text-white hover:bg-[#333] transition-colors",children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6 scroll-smooth",children:c==="menu"?s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:`relative w-24 h-24 flex items-center justify-center rounded-full ${V(n.specialFrame)?"":U(n.specialFrame)}`,children:[V(n.specialFrame)&&s.jsx("img",{src:n.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.7] pointer-events-none",alt:"frame"}),s.jsxs("div",{className:`${V(n.specialFrame)?"w-[85%] h-[85%]":"w-24 h-24"} bg-[#252525] rounded-full flex items-center justify-center border-4 border-[#1a1a1a] shadow-xl overflow-hidden relative group z-0`,children:[E&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 z-50 backdrop-blur-sm",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full opacity-75 animate-ping absolute top-0 left-0"}),s.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center relative z-10 shadow-lg shadow-blue-500/50",children:s.jsx(Zr,{className:"w-4 h-4 text-white animate-bounce"})}),s.jsx("div",{className:"w-14 h-14 border-4 border-blue-400/30 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"})]})}),T?s.jsx("img",{src:T,alt:n.name,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-10 h-10 text-gray-500"})]})]}),s.jsx("button",{onClick:()=>{var Q;return!E&&((Q=H.current)==null?void 0:Q.click())},className:"absolute bottom-0 right-0 bg-red-600 text-white p-2 rounded-full border-4 border-[#1a1a1a] shadow-lg active:scale-95 z-20",children:s.jsx(qi,{className:"w-4 h-4"})}),s.jsx("input",{ref:H,type:"file",accept:"image/*",className:"absolute opacity-0 w-0 h-0 pointer-events-none",onChange:M})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-3 justify-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:n.name}),A(n.specialBadge)]}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx("span",{className:"bg-orange-500/10 text-orange-400 text-xs font-bold px-3 py-1 rounded-full border border-orange-500/20",children:" "}),s.jsx("span",{className:"text-gray-500 font-mono text-xs",children:n.phone})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 mr-2 uppercase tracking-wider",children:" "}),I?s.jsx(rx,{icon:s.jsx(ur,{}),label:":  ",subLabel:"    (  )",onClick:()=>{},active:!0,disabled:!0}):s.jsx(rx,{icon:s.jsx(It,{}),label:O?"  ( )":"  ( )",subLabel:" 12  -   ",onClick:F,active:O,danger:O})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-500 mr-2 uppercase tracking-wider",children:""}),s.jsx(rx,{icon:s.jsx($s,{}),label:"  ",onClick:()=>u("settings")}),s.jsx(rx,{icon:s.jsx(c0,{}),label:" ",danger:!0,onClick:()=>{e(),t()}})]})]}):s.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"w-16 h-16 bg-blue-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-blue-500/20",children:s.jsx($s,{className:"w-8 h-8 text-blue-400"})}),s.jsx("h3",{className:"text-lg font-bold text-white",children:"  "})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:"  "}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:v?"text":"password",value:h,onChange:Q=>m(Q.target.value),className:"w-full bg-[#252525] border border-[#333] rounded-xl p-4 text-white focus:border-blue-500 outline-none",placeholder:"******"}),s.jsx("button",{onClick:()=>_(!v),className:"absolute left-4 top-4 text-gray-500 hover:text-white",children:v?s.jsx(Io,{className:"w-5 h-5"}):s.jsx(Yi,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2 mr-1",children:"  "}),s.jsx("input",{type:"password",value:p,onChange:Q=>b(Q.target.value),className:"w-full bg-[#252525] border border-[#333] rounded-xl p-4 text-white focus:border-blue-500 outline-none",placeholder:"******"})]})]}),L&&s.jsx("div",{className:`p-4 rounded-xl text-sm font-bold text-center ${L.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:L.text}),s.jsx("button",{onClick:R,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-xl shadow-lg mt-4",children:" "})]})})]}),G&&P&&s.jsx(h0,{imageSrc:P,onCropComplete:ne,onClose:()=>{z(!1),j(null),H.current&&(H.current.value="")},aspectRatio:1})]})},y4=({onClose:n,currentCount:e,maxLimit:t})=>s.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-md flex justify-center items-center z-[100] p-4 animate-fadeIn",onClick:n,children:s.jsxs("div",{className:"bg-[#1a1a1a] w-full max-w-sm rounded-3xl border border-red-500/30 shadow-2xl overflow-hidden relative flex flex-col items-center p-8 text-center",onClick:r=>r.stopPropagation(),children:[s.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-500 hover:text-white transition-colors bg-gray-800 p-1.5 rounded-full",children:s.jsx(ut,{className:"w-5 h-5"})}),s.jsxs("div",{className:"relative w-24 h-24 mb-6 flex items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-red-500/20 rounded-full animate-ping"}),s.jsx("div",{className:"relative bg-gradient-to-br from-red-600 to-red-800 w-20 h-20 rounded-full flex items-center justify-center shadow-lg border-2 border-red-400/50",children:s.jsx(Yj,{className:"w-10 h-10 text-white animate-pulse"})})]}),s.jsx("h2",{className:"text-2xl font-black text-white mb-2 tracking-tight",children:"   !"}),s.jsxs("p",{className:"text-gray-400 text-sm leading-relaxed mb-6",children:["        .",s.jsx("br",{})," ",s.jsx("span",{className:"text-red-400 font-bold",children:e}),"      ",s.jsx("span",{className:"text-white font-bold bg-gray-700 px-2 rounded",children:t}),"."]}),s.jsxs("div",{className:"w-full bg-gray-800 rounded-xl p-4 border border-gray-700 mb-6",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"  "}),s.jsx("div",{className:"w-full h-2.5 bg-gray-900 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-red-500 rounded-full w-full shadow-[0_0_10px_rgba(239,68,68,0.7)] animate-pulse"})}),s.jsxs("div",{className:"flex justify-between items-center mt-2 text-xs font-mono font-bold",children:[s.jsxs("span",{className:"text-white",children:[e," / ",t]}),s.jsx("span",{className:"text-red-400",children:""})]})]}),s.jsx("button",{onClick:n,className:"w-full bg-white text-black font-bold py-3.5 rounded-xl hover:bg-gray-200 transition-transform active:scale-95 shadow-lg",children:" "})]})}),k_={},v4={water:LO,snake:VO},ste=n=>{if(!n)return null;const e=n.toLowerCase();return e.includes("sort")||e.includes("water")?v4.water:e.includes("snake")?v4.snake:null},rte=({src:n,alt:e,className:t,name:r})=>{const i=ste(r),[o,c]=Rn.useState(i||(n&&!n.startsWith("FIRESTORE_FILE:")?n:k_[n]||"")),[u,h]=Rn.useState(!1);return Rn.useEffect(()=>{if(i)return;let m=!0;if(n&&n.startsWith("FIRESTORE_FILE:")&&!k_[n]){const p=n.replace("FIRESTORE_FILE:","");p&&Ty(p).then(b=>{m&&b&&(k_[n]=b,c(b))}).catch(()=>{m&&h(!0)})}else n&&!o?c(n):n||h(!0);return()=>{m=!1}},[n,o,i]),u||!o?s.jsx("img",{src:FO,alt:e,className:t}):s.jsx("img",{src:o,alt:e,className:t,onError:()=>h(!0),loading:"eager"})},ite=({appConfig:n,onBack:e,onPlayGame:t})=>{var i;Rn.useEffect(()=>{(n==null?void 0:n.isGamesEnabled)===!1&&e&&e()},[n==null?void 0:n.isGamesEnabled,e]);const r=((i=n==null?void 0:n.games)==null?void 0:i.filter(o=>o.isActive))||[];return s.jsxs("div",{className:"flex flex-col h-full bg-[#1A1A1A] text-white animate-fade-in-up pb-24",children:[s.jsx("div",{className:"relative z-50 overflow-hidden shadow-md border-b border-white/5 sticky top-0",children:s.jsxs("div",{className:"relative z-10 flex items-center justify-between py-2 px-3",children:[s.jsx("button",{onClick:e,className:"p-1.5 rounded-full bg-white/5 border border-white/10 hover:bg-white/10 active:scale-90 transition-all focus:outline-none focus:ring-2 focus:ring-red-500/50 flex items-center justify-center cursor-pointer","aria-label":"Back",style:{minWidth:"32px",minHeight:"32px"},children:s.jsx(wi,{className:"w-5 h-5 text-gray-100 rotate-180"})}),s.jsx("div",{className:"flex flex-col items-center",children:s.jsxs("h1",{className:"text-lg font-black tracking-tight text-white drop-shadow-sm",children:[" ",s.jsx("span",{className:"text-red-500 ml-1",children:"."})]})}),s.jsx("div",{className:"w-8"})," "]})}),s.jsx("div",{className:"flex-1",children:r.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center animate-slideUp",children:[s.jsx("div",{className:"w-20 h-20 rounded-3xl bg-gradient-to-br from-gray-800 to-black border border-white/5 flex items-center justify-center mb-6 shadow-2xl shadow-black/50",children:s.jsx(Ah,{className:"w-10 h-10 text-gray-600"})}),s.jsx("h3",{className:"text-lg font-bold text-gray-200",children:"   "}),s.jsx("p",{className:"text-xs text-gray-500 mt-2 max-w-[200px]",children:"    .   ."})]}):s.jsx("div",{className:"grid grid-cols-2 gap-3 pb-safe",children:r.map((o,c)=>s.jsxs("button",{onClick:()=>t(o.url),className:"group relative aspect-[4/5] rounded-2xl overflow-hidden border border-white/5 shadow-lg active:scale-[0.98] transition-all duration-300 animate-fade-in-up hardware-accelerated",style:{animationDelay:`${c*100}ms`},children:[s.jsx("div",{className:"absolute inset-0 z-0",children:s.jsx(rte,{src:o.image,alt:o.name,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110 opacity-100"})}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-white/0 via-white/5 to-white/0 opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"})]},o.id))})})]})},ate=({url:n,onClose:e})=>{const t=w.useRef(null);return w.useEffect(()=>{const r=()=>{e()};return window.history.pushState({gamePlayer:!0},""),window.addEventListener("popstate",r),()=>{window.removeEventListener("popstate",r)}},[e]),s.jsxs("div",{className:"fixed inset-0 z-50 bg-[#111] flex flex-col animate-fadeIn",children:[s.jsxs("div",{className:"absolute top-0 right-0 left-0 flex items-center justify-between p-3 pt-safe z-[60] pointer-events-none",children:[s.jsx("button",{onClick:e,className:"pointer-events-auto p-2 rounded-full bg-red-600 text-white shadow-lg shadow-red-600/40 hover:bg-red-700 active:scale-90 transition-transform duration-200 border border-white/20 z-50 flex items-center justify-center cursor-pointer","aria-label":"Close Game",style:{minWidth:"36px",minHeight:"36px"},children:s.jsx(ut,{className:"w-5 h-5"})}),s.jsx("div",{className:"pointer-events-auto px-4 py-2 rounded-full bg-[#1a1a1a] border border-white/10 shadow-lg",children:s.jsx("span",{className:"text-[10px] font-bold text-gray-200 uppercase tracking-widest",children:"Web Player"})})]}),s.jsx("iframe",{ref:t,src:n,className:"flex-1 w-full h-full border-none bg-transparent",allow:"autoplay; fullscreen; vibration; gyroscope; accelerometer; clipboard-write; encrypted-media"})]})},Ru=n=>n?new Date(n).getTime():0,ote=n=>{var ne;const[e,t]=w.useState("home"),[r,i]=w.useState("home"),[o,c]=w.useState(null),[u,h]=w.useState(!1),[m,p]=w.useState(!1),[b,v]=w.useState(null),[_,T]=w.useState(!1),k=w.useRef(null),E=((ne=n.appConfig)==null?void 0:ne.appName)||"GOO NOW",[S,...L]=E.split(" "),$=L.join(" "),H=E;w.useEffect(()=>{var U,A;if(((U=n.initialRoute)==null?void 0:U.target)==="order"&&n.initialRoute.id){const V=n.orders.find(Q=>{var ae;return Q.id===((ae=n.initialRoute)==null?void 0:ae.id)});V&&(c(V),V.status===ue.InTransit&&i("in-transit"))}else((A=n.initialRoute)==null?void 0:A.target)==="messages"&&T(!0)},[n.initialRoute,n.orders]),w.useEffect(()=>{if(o){const U=n.orders.find(A=>A.id===o.id);if(!U){c(null),n.showNotification("     ","info");return}if(U.driverId&&U.driverId!==n.driver.id){c(null),n.showNotification("      ","info");return}if(U.status===ue.Cancelled){c(null),n.showNotification("   ","info");return}JSON.stringify(o)!==JSON.stringify(U)&&c(U)}},[n.orders,o,n.driver.id]),w.useEffect(()=>{u0("driver",n.driver.id)},[n.driver.id]),w.useEffect(()=>{Pn.reportContext(e)},[e]),w.useEffect(()=>{const U=A=>{k.current&&!k.current.contains(A.target)&&T(!1)};return document.addEventListener("mousedown",U),()=>document.removeEventListener("mousedown",U)},[]);const G=w.useRef(null);w.useEffect(()=>{G.current=b},[b]),sn(()=>_?(T(!1),!0):G.current?(v(null),!0):u?(h(!1),!0):m?(p(!1),!0):o?(c(null),!0):e!=="home"?(t("home"),!0):r!=="home"?(i("home"),!0):!1,[u,m,o,e,r,_]);const{standardNewOrders:z,delinowNewOrders:P,inTransitOrders:j}=w.useMemo(()=>{const U=[],A=[],V=n.driver.id;for(const Q of n.orders)Q.status===ue.Pending&&!Q.driverId?U.push(Q):Q.driverId===V&&Q.status!==ue.Delivered&&Q.status!==ue.Cancelled&&A.push(Q);return U.sort((Q,ae)=>Ru(Q.createdAt)-Ru(ae.createdAt)),A.sort((Q,ae)=>Ru(Q.createdAt)-Ru(ae.createdAt)),{standardNewOrders:U.filter(Q=>Q.type!=="shopping_order"),delinowNewOrders:U.filter(Q=>Q.type==="shopping_order"),inTransitOrders:A}},[n.orders,n.driver.id]),O=w.useMemo(()=>n.messages.filter(U=>{var A;return U.targetRole==="driver"&&(U.targetId==="all"||U.targetId===n.driver.id)&&!n.deletedMessageIds.includes(U.id)&&!((A=U.deletedBy)!=null&&A.includes(n.driver.id))}).sort((U,A)=>Ru(A.createdAt)-Ru(U.createdAt)),[n.messages,n.driver.id,n.deletedMessageIds]),I=w.useMemo(()=>O.filter(U=>{var A;return!((A=U.readBy)!=null&&A.includes(n.driver.id))}).length,[O,n.driver.id]);w.useEffect(()=>{_&&O.forEach(U=>{var A;(A=U.readBy)!=null&&A.includes(n.driver.id)||n.markMessageAsSeen(U.id)})},[_,O,n.driver.id]);const R=U=>{if(!U||U==="none")return null;if(U!=null&&U.startsWith("data:")||U!=null&&U.startsWith("http"))return s.jsx("div",{className:"w-7 h-7 min-w-[1.75rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:s.jsx("img",{src:U,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let A=null,V="";switch(U){case"verified":A=Mo,V="text-blue-400 fill-blue-500/20";break;case"vip":A=Xi,V="text-yellow-400 fill-yellow-500/20";break;case"star":A=ti,V="text-purple-400 fill-purple-500/20";break;case"popular":A=en,V="text-red-400 fill-red-500/20";break}return A?s.jsx(A,{className:`w-4 h-4 ml-1 ${V}`}):null},F=()=>{T(!1)},M=async()=>new Promise(U=>{setTimeout(()=>{U()},1500)});return s.jsxs("div",{className:"fixed inset-0 flex flex-col bg-[#1A1A1A] text-white overflow-hidden",dir:"rtl",children:[u&&s.jsx(nte,{driver:n.driver,onClose:()=>h(!1),onLogout:n.onLogout,onUpdateUser:n.onUpdateUser,currentTheme:n.appTheme,onUpdateTheme:n.onUpdateTheme}),m&&s.jsx(y4,{onClose:()=>p(!1),currentCount:j.length,maxLimit:n.driver.maxConcurrentOrders||0}),m&&s.jsx(y4,{onClose:()=>p(!1),currentCount:j.length,maxLimit:n.driver.maxConcurrentOrders||0}),o?s.jsxs("div",{className:"fixed inset-0 bg-[#1A1A1A] z-50 flex flex-col animate-slide-in-bottom",children:[s.jsxs("header",{className:"flex-none flex bg-[#1A1A1A] border-b border-gray-800 h-14 items-center px-4 pt-safe box-content",children:[s.jsxs("button",{onClick:()=>c(null),className:"text-white flex items-center p-2",children:[s.jsx("span",{className:"text-2xl ml-2 rotate-180",children:""}),s.jsx("span",{className:"font-bold",children:""})]}),s.jsx("div",{className:"flex-1 text-center font-bold",children:" "})]}),s.jsx(tte,{order:o,users:n.users,listType:o.status===ue.InTransit?"in-transit":"new",driver:n.driver,onAcceptOrder:(U,A,V)=>{n.onAcceptOrder(U,A,V),c(null)},onUpdateStatus:(U,A)=>{n.onUpdateOrderStatus(U,A),c(null)},onBack:()=>c(null),theme:n.appTheme})]}):s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:"flex-none bg-[#1A1A1A] z-30 border-b border-gray-800 h-14 flex justify-between items-center px-4 pt-safe box-content relative",children:[s.jsxs("button",{onClick:()=>h(!0),className:"flex items-center gap-2 bg-white/5 py-1 px-3 rounded-full hover:bg-white/10 transition-colors",children:[s.jsx("div",{className:"relative",children:s.jsx(Ji,{frameId:n.driver.specialFrame,size:"sm",className:"scale-90",children:s.jsx("div",{className:"w-full h-full rounded-full overflow-hidden border border-white/20 flex items-center justify-center bg-gray-700",children:n.driver.storeImage?s.jsx("img",{src:n.driver.storeImage,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-5 h-5 mx-1"})})})}),s.jsx("span",{className:"text-sm font-bold truncate max-w-[80px]",children:n.driver.name}),R(n.driver.specialBadge)]}),s.jsxs("h1",{className:"text-xl font-bold",children:[s.jsx("span",{className:"text-red-500",children:S}),s.jsx("span",{className:"text-white ml-1",children:$})]}),s.jsxs("div",{className:"relative",ref:k,children:[s.jsxs("button",{onClick:()=>T(!_),className:`relative p-2 transition-colors ${_?"text-red-500":"text-gray-400 hover:text-white"}`,children:[s.jsx(zs,{className:"w-6 h-6"}),I>0&&s.jsx("span",{className:"absolute top-1 right-1 w-2.5 h-2.5 bg-red-600 rounded-full animate-pulse border border-[#1A1A1A]"})]}),_&&s.jsxs("div",{className:"absolute top-12 left-0 w-80 bg-[#1e1e1e] border border-gray-700/50 rounded-2xl shadow-2xl overflow-hidden z-50 animate-pop-in origin-top-left",children:[s.jsxs("div",{className:"p-3 border-b border-gray-700/50 bg-[#252525] flex justify-between items-center",children:[s.jsx("span",{className:"text-xs font-bold text-white",children:""}),O.length>0&&s.jsx("button",{onClick:F,className:"text-[10px] text-gray-400 hover:text-white transition-colors",children:""})]}),s.jsx("div",{className:"max-h-80 overflow-y-auto custom-scrollbar p-2 space-y-2",children:O.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(zs,{className:"w-8 h-8 mx-auto mb-2 opacity-20"}),s.jsx("p",{className:"text-[10px]",children:"   "})]}):O.map(U=>{const A=(()=>{try{const V=new Date(U.createdAt);return isNaN(V.getTime())?"":V.toLocaleString("ar-EG",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"})}catch{return""}})();return s.jsxs("div",{className:"group relative bg-[#252525] rounded-xl border border-gray-700/50 shadow-sm overflow-hidden p-3 transition-all hover:bg-[#2a2a2a]",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-red-900/20 flex items-center justify-center text-red-500",children:s.jsx(zs,{className:"w-4 h-4"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-xs font-bold text-white leading-tight",children:" "}),s.jsx("span",{className:"text-[9px] text-gray-500 font-mono",children:A})]})]}),s.jsx("button",{onClick:V=>{V.stopPropagation(),n.hideMessage(U.id)},className:"text-gray-600 hover:text-red-400 transition-colors p-1",children:s.jsx(Tt,{className:"w-3.5 h-3.5"})})]}),s.jsxs("div",{children:[U.image&&s.jsx("div",{className:"mb-2 rounded-lg overflow-hidden border border-gray-600/30",children:s.jsx("img",{src:U.image,alt:"",className:"w-full h-32 object-contain bg-black/40"})}),s.jsx("p",{className:"text-gray-300 text-xs leading-relaxed font-medium",children:U.text})]}),s.jsxs("div",{className:"mt-2 flex items-center gap-1 text-[9px] text-gray-500",children:[s.jsx(Je,{className:"w-2.5 h-2.5 text-green-500"}),s.jsx("span",{children:" "})]})]},U.id)})})]})]})]}),e==="home"&&s.jsx("div",{className:"flex-none px-3 py-2",children:s.jsxs("div",{className:"flex bg-[#2A2A2A] rounded-xl p-1 border border-gray-700",children:[s.jsxs("button",{onClick:()=>i("home"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${r==="home"?"bg-red-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[" (",z.length,")"]}),s.jsxs("button",{onClick:()=>i("in-transit"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${r==="in-transit"?"bg-red-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[" (",j.length,")"]}),s.jsxs("button",{onClick:()=>i("delinow"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${r==="delinow"?"bg-red-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[H," (",P.length,")"]})]})}),s.jsx("main",{className:"flex-1 overflow-hidden relative",children:s.jsxs(ln,{onRefresh:M,className:"pb-36",children:[e==="home"&&s.jsx(Jee,{driver:n.driver,users:n.users,standardNewOrders:z,delinowNewOrders:P,inTransitOrders:j,onViewOrder:c,onUpdateUser:n.onUpdateUser,activeTab:r,theme:n.appTheme,isLoading:n.isLoading}),e==="wallet"&&s.jsx(Zee,{driver:n.driver,orders:n.orders,users:n.users}),e==="games"&&s.jsx(ite,{driver:n.driver,appConfig:n.appConfig,onBack:()=>t("home"),onPlayGame:U=>v(U)})]})}),s.jsx(ete,{activePage:e,onNavigate:U=>t(U),messageCount:I,theme:n.appTheme,appConfig:n.appConfig})]}),b&&s.jsx(ate,{url:b,onClose:()=>v(null)})]})},ix=({title:n,description:e,icon:t,colors:r,onClick:i,delay:o=0})=>s.jsxs("button",{onClick:i,className:"relative w-full h-32 sm:h-36 mt-4 group animate-fade-slide-up select-none",style:{animationDelay:`${o}ms`},children:[s.jsx("div",{className:"absolute -top-5 left-1/2 -translate-x-1/2 z-20",children:s.jsx("div",{className:"w-10 h-10 rounded-full p-1 bg-[#252525] shadow-lg group-hover:-translate-y-1 transition-transform duration-300",children:s.jsx("div",{className:`w-full h-full rounded-full flex items-center justify-center ${r.iconBg} border border-white/5`,children:t})})}),s.jsxs("div",{className:"relative w-full h-full transition-all duration-300 active:scale-95 rounded-[1.2rem]",children:[s.jsx("div",{className:"absolute -inset-[1px] rounded-[1.25rem] overflow-hidden z-0",children:s.jsx("div",{className:"absolute top-[-50%] left-[-50%] w-[200%] h-[200%] animate-[spin_3s_linear_infinite] bg-[conic-gradient(transparent,transparent,#ff0000,#ff8000,#ffff00,#00ff00,#00ffff,#0000ff,#ff00ff,#ff0000)] opacity-100"})}),s.jsxs("div",{className:"relative w-full h-full bg-[#252525] rounded-[1.2rem] p-3 pt-8 flex flex-col items-center text-center overflow-hidden z-10 shadow-md group-hover:shadow-xl",children:[s.jsx("div",{className:`absolute top-0 left-0 right-0 h-12 bg-gradient-to-b ${r.accent} to-transparent opacity-10 group-hover:opacity-20 transition-opacity`}),s.jsxs("div",{className:"relative z-10 w-full mt-1",children:[s.jsx("h3",{className:`text-xs font-bold ${r.text} mb-1 leading-tight group-hover:text-white transition-colors`,children:n}),s.jsx("p",{className:"text-[9px] text-gray-500 font-medium line-clamp-2 leading-relaxed px-1",children:e})]}),s.jsx("div",{className:`absolute bottom-0 left-1/2 -translate-x-1/2 w-0 h-0.5 ${r.text.replace("text-","bg-")} transition-all duration-500 group-hover:w-1/2 opacity-50`})]})]})]}),lte=({user:n,onNavigate:e,sliderImages:t=[],sliderConfig:r,adminUser:i,merchants:o=[],messageCount:c=0,onOpenMessages:u,onOpenSupport:h,unreadSupportCount:m=0})=>{const[p,b]=w.useState(0),[v,_]=w.useState(""),[T,k]=w.useState(0),E=w.useRef(null),[S,L]=w.useState(!1),$=w.useRef(null);sn(()=>S?(L(!1),!0):!1,[S]),w.useEffect(()=>{const I=R=>{$.current&&!$.current.contains(R.target)&&L(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]),w.useEffect(()=>{const I=E.current;if(!I)return;const R=()=>{const F=I.scrollTop,M=Math.min(F/80,.95);k(M)};return I.addEventListener("scroll",R,{passive:!0}),()=>I.removeEventListener("scroll",R)},[]);const H=(r==null?void 0:r.isEnabled)!==!1,G=w.useMemo(()=>!t||!Array.isArray(t)?[]:t.filter(I=>I&&I.url&&I.active!==!1),[t]);w.useEffect(()=>{const I=new Date().getHours();I<12?_(" "):I<18?_(" "):_(" ")},[]),w.useEffect(()=>{b(0)},[G.length]),w.useEffect(()=>{if(H&&G.length>1){const I=setInterval(()=>{b(R=>(R+1)%G.length)},4e3);return()=>clearInterval(I)}},[G.length,H]);const z=I=>{if(!I||I==="none")return null;if(I!=null&&I.startsWith("data:")||I!=null&&I.startsWith("http"))return s.jsx("div",{className:"w-6 h-6 min-w-[1.5rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-1 backdrop-blur-sm",children:s.jsx("img",{src:I,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let R=null,F="";switch(I){case"verified":R=Mo,F="text-blue-400 fill-blue-500/20";break;case"vip":R=Xi,F="text-yellow-400 fill-yellow-500/20";break;case"star":R=ti,F="text-purple-400 fill-purple-500/20";break;case"popular":R=en,F="text-red-400 fill-red-500/20";break}return R?s.jsx(R,{className:`w-4 h-4 ml-1 ${F}`}):null},P=(m||0)+(c||0),j=I=>{L(!1),I==="support"?h&&h():u&&u()},O=()=>{L(!1),u&&u()};return s.jsxs("div",{className:"h-full bg-[#1A1A1A] text-white flex flex-col font-sans overflow-hidden",children:[s.jsx("div",{className:"px-5 pt-safe pb-3 absolute top-0 left-0 right-0 z-50 transition-colors duration-200 box-content will-change-transform",style:{backgroundColor:`rgba(26, 26, 26, ${T})`,backdropFilter:`blur(${T*12}px)`,borderBottom:`1px solid rgba(255,255,255,${T*.05})`,boxShadow:`0 4px 20px rgba(0,0,0,${T*.1})`},children:s.jsxs("div",{className:"flex justify-between items-center mt-1",children:[s.jsxs("button",{onClick:()=>e("profile"),className:"bg-white/10 backdrop-blur-md border border-white/10 rounded-full pr-1 pl-4 py-1 flex items-center gap-3 shadow-lg active:scale-95 transition-all",children:[s.jsx("div",{className:"relative",children:s.jsx(Ji,{frameId:n.specialFrame,size:"sm",className:"scale-110",children:s.jsx("div",{className:"w-full h-full rounded-full bg-[#1A1A1A] overflow-hidden relative z-0 flex items-center justify-center",children:n.storeImage?s.jsx("img",{src:n.storeImage,alt:"User",className:"w-full h-full object-cover rounded-full"}):s.jsx("div",{className:"w-full h-full bg-[#252525] flex items-center justify-center",children:s.jsx(_t,{className:"w-4 h-4 text-gray-400"})})})})}),s.jsxs("div",{className:"flex flex-col items-start animate-fade-slide-up",children:[s.jsxs("span",{className:"text-gray-300 text-[9px] font-medium mb-0.5 flex items-center gap-1 opacity-90",children:[v,"",s.jsx("span",{className:"text-yellow-500 animate-pulse",children:""})]}),s.jsxs("h1",{className:"text-xs font-black text-white tracking-wide leading-none flex items-center gap-1",children:[n.name.split(" ")[0],z(n.specialBadge)]})]})]}),s.jsxs("div",{className:"relative pointer-events-auto",ref:$,children:[s.jsxs("button",{onClick:()=>L(!S),className:`relative w-10 h-10 bg-white/5 hover:bg-white/10 backdrop-blur-md rounded-full flex items-center justify-center border border-white/10 transition-all active:scale-90 shadow-sm ${P>0?"animate-swing":""}`,children:[s.jsx(zs,{className:`w-5 h-5 ${P>0?"text-white":"text-gray-300"}`}),P>0&&s.jsx("span",{className:"absolute top-2 right-2 w-2.5 h-2.5 bg-red-600 rounded-full border-2 border-[#1A1A1A] animate-pulse"})]}),S&&s.jsxs("div",{className:"absolute top-12 left-0 w-64 bg-[#1e1e1e] border border-gray-700/50 rounded-2xl shadow-2xl overflow-hidden z-50 animate-pop-in origin-top-left",children:[s.jsxs("div",{className:"p-3 border-b border-gray-700/50 bg-[#252525] flex justify-between items-center",children:[s.jsx("span",{className:"text-xs font-bold text-white",children:""}),P>0&&s.jsx("button",{onClick:O,className:"text-[10px] text-gray-400 hover:text-white transition-colors",children:" "})]}),s.jsx("div",{className:"max-h-60 overflow-y-auto custom-scrollbar p-2 space-y-2",children:P===0?s.jsxs("div",{className:"text-center py-6 text-gray-500",children:[s.jsx(zs,{className:"w-8 h-8 mx-auto mb-2 opacity-20"}),s.jsx("p",{className:"text-[10px]",children:"   "})]}):s.jsxs(s.Fragment,{children:[m!==void 0&&m>0&&s.jsxs("button",{onClick:()=>j("support"),className:"w-full flex items-center gap-3 p-2 rounded-xl hover:bg-white/5 transition-colors group text-right",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center text-green-400 shrink-0 border border-green-500/30",children:s.jsx(Ei,{className:"w-4 h-4"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-xs font-bold text-white mb-0.5",children:"   "}),s.jsxs("p",{className:"text-[10px] text-gray-400 truncate",children:[" ",m,"   "]})]}),s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})]}),c!==void 0&&c>0&&s.jsxs("button",{onClick:()=>j("message"),className:"w-full flex items-center gap-3 p-2 rounded-xl hover:bg-white/5 transition-colors group text-right",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400 shrink-0 border border-blue-500/30",children:s.jsx(Ni,{className:"w-4 h-4"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-xs font-bold text-white mb-0.5",children:" "}),s.jsxs("p",{className:"text-[10px] text-gray-400 truncate",children:[" ",c,"    "]})]}),s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]})]})})]})]})]})}),s.jsxs("div",{ref:E,className:"flex-1 overflow-y-auto pb-20 space-y-4 relative z-0 pt-24",onScroll:I=>{const R=I.currentTarget,F=Math.min(R.scrollTop/80,.95);k(F)},children:[H&&G.length>0&&s.jsx("div",{className:"px-4 mt-3 w-full relative z-10 h-40 sm:h-44",children:s.jsxs("div",{className:"relative w-full h-full rounded-[1.5rem] overflow-hidden shadow-2xl border border-white/5 bg-gray-800",children:[G.map((I,R)=>{const F=I.linkedMerchantId?I.linkedMerchantId===(i==null?void 0:i.id)?i:o.find(M=>M.id===I.linkedMerchantId):null;return s.jsxs("div",{onClick:()=>{I.linkedMerchantId&&e("store-list")},className:`absolute inset-0 w-full h-full transition-opacity duration-700 ease-in-out cursor-pointer ${R===p?"opacity-100 z-10":"opacity-0 z-0"}`,children:[s.jsx("img",{src:I.url,className:"w-full h-full object-cover block",alt:"Offer"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent pointer-events-none"}),F&&s.jsx("div",{className:"absolute bottom-3 right-3 z-20 flex items-center justify-between pointer-events-none",children:s.jsxs("div",{className:"flex items-center gap-2 bg-black/40 backdrop-blur-md border border-white/10 pr-1 pl-3 py-1 rounded-full animate-fade-slide-up",children:[s.jsx("div",{className:"w-7 h-7 rounded-full border border-white/50 overflow-hidden bg-gray-800",children:F.storeImage?s.jsx("img",{src:F.storeImage,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-full h-full p-1 text-gray-400"})}),s.jsx("span",{className:"text-[10px] font-bold text-white max-w-[100px] truncate",children:F.id===(i==null?void 0:i.id)?"DELI NOW":F.name})]})}),I.textOverlay&&s.jsx("div",{className:"absolute bottom-3 left-3 max-w-[50%] z-20 flex flex-col items-start animate-fade-slide-up",children:s.jsx("div",{className:"bg-black/30 backdrop-blur-md border border-white/10 px-3 py-2 rounded-xl shadow-lg",children:s.jsx("p",{className:"text-white font-bold text-xs leading-relaxed drop-shadow-md",children:I.textOverlay})})})]},I.id)}),G.length>1&&s.jsx("div",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 flex gap-1 z-20 pointer-events-none",children:G.map((I,R)=>s.jsx("div",{className:`h-1 rounded-full transition-all duration-300 ${R===p?"bg-white w-4":"bg-white/30 w-1"}`},R))})]})}),s.jsxs("div",{className:"px-4 pb-4 relative z-10",children:[s.jsxs("h2",{className:"text-sm font-bold text-white mb-2 flex items-center gap-2",children:[s.jsx("span",{className:"w-1 h-4 bg-red-600 rounded-full"})," "]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx(ix,{title:"  ",description:"   ",icon:s.jsx(en,{className:"w-5 h-5 text-purple-300"}),colors:{bg:"bg-[#252525]",border:"border-purple-500/20",text:"text-purple-400",iconBg:"bg-purple-500/10",accent:"from-purple-900"},onClick:()=>e("special-request"),delay:100}),s.jsx(ix,{title:" ",description:"   ",icon:s.jsx(Rr,{className:"w-5 h-5 text-orange-300"}),colors:{bg:"bg-[#252525]",border:"border-orange-500/20",text:"text-orange-400",iconBg:"bg-orange-500/10",accent:"from-orange-900"},onClick:()=>e("store-list"),delay:200}),s.jsx(ix,{title:"",description:" -  ",icon:s.jsx(gZ,{className:"w-5 h-5 text-blue-300"}),colors:{bg:"bg-[#252525]",border:"border-blue-500/20",text:"text-blue-400",iconBg:"bg-blue-500/10",accent:"from-blue-900"},onClick:()=>e("ride"),delay:300}),s.jsx(ix,{title:" ",description:" -  ",icon:s.jsx(Zt,{className:"w-5 h-5 text-green-300"}),colors:{bg:"bg-[#252525]",border:"border-green-500/20",text:"text-green-400",iconBg:"bg-green-500/10",accent:"from-green-900"},onClick:()=>e("transport"),delay:400})]})]})]})]})},Tl={All:({className:n})=>s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[s.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),s.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),s.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),s.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),Restaurant:({className:n})=>s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[s.jsx("path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"}),s.jsx("path",{d:"M7 2v20"}),s.jsx("path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"})]}),Market:({className:n})=>s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[s.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),s.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),Pharmacy:({className:n})=>s.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[s.jsx("path",{d:"M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8z"}),s.jsx("path",{d:"M12 7v10"}),s.jsx("path",{d:"M7 12h10"})]})},cte=[{id:"all",key:"cat_all",label:"",Icon:Tl.All},{id:"restaurant",key:"cat_restaurant",label:"",Icon:Tl.Restaurant},{id:"market",key:"cat_market",label:"",Icon:Tl.Market},{id:"pharmacy",key:"cat_pharmacy",label:"",Icon:Tl.Pharmacy}],dte=n=>{if(!n.workingHours||!n.workingHours.start||!n.workingHours.end)return!0;const e=new Date,t=e.getHours()*60+e.getMinutes(),[r,i]=n.workingHours.start.split(":").map(Number),[o,c]=n.workingHours.end.split(":").map(Number);if(isNaN(r)||isNaN(o))return!0;const u=r*60+(i||0),h=o*60+(c||0);return h<u?t>=u||t<h:t>=u&&t<h},ax=()=>s.jsxs("div",{className:"bg-[#252525] rounded-[1.5rem] p-3 flex flex-col items-center border border-white/5 animate-pulse h-36",children:[s.jsx("div",{className:"-mt-6 mb-2",children:s.jsx("div",{className:"w-14 h-14 rounded-full bg-gray-700 border-2 border-[#1A1A1A]"})}),s.jsx("div",{className:"h-3 w-20 bg-gray-700 rounded-full mb-2"}),s.jsx("div",{className:"h-2 w-10 bg-gray-700 rounded-full mb-3"})]}),ute=({merchant:n,onClick:e,theme:t})=>{const r=dte(n),i=(o,c,u)=>{var m,p;const h=(p=(m=t==null?void 0:t.customer)==null?void 0:m.icons)==null?void 0:p[o];return h?s.jsx("img",{src:h,className:`${u} object-contain`,alt:o}):s.jsx(c,{className:u})};return s.jsxs("button",{onClick:e,className:`group relative bg-[#252525] rounded-[1.2rem] p-3 pt-7 flex flex-col items-center text-center transition-all duration-300 hover:-translate-y-1 active:scale-95 shadow-md border ${r?"border-white/5 hover:border-white/10":"border-red-900/20 opacity-80"} overflow-visible h-full`,children:[s.jsx("div",{className:"absolute -top-5",children:s.jsx("div",{className:`w-14 h-14 rounded-full p-0.5 bg-[#252525] shadow-lg ${r?"":"grayscale"}`,children:s.jsxs("div",{className:"w-full h-full rounded-full overflow-hidden border-2 border-[#1A1A1A] relative",children:[n.storeImage?s.jsx("img",{src:n.storeImage,alt:n.name,className:"w-full h-full object-cover transition-transform duration-700 group-hover:rotate-6 group-hover:scale-110"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-800 text-gray-500",children:s.jsx(Si,{className:"w-5 h-5"})}),!r&&s.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:s.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"})})]})})}),s.jsx("h3",{className:"text-white font-bold text-xs mb-0.5 leading-tight line-clamp-1 w-full mt-2",children:n.name}),s.jsx("p",{className:"text-gray-500 text-[9px] mb-2 font-medium",children:n.storeCategory||""}),s.jsxs("div",{className:"flex items-center justify-center gap-1.5 w-full mt-auto",children:[s.jsxs("div",{className:"flex items-center gap-0.5 bg-[#1A1A1A] px-1.5 py-0.5 rounded border border-white/5",children:[s.jsx(It,{className:"w-2.5 h-2.5 text-blue-400"}),s.jsxs("span",{className:"text-gray-300 text-[8px] font-bold",children:[n.responseTime||"30"," "]})]}),s.jsxs("div",{className:"flex items-center gap-0.5 bg-[#1A1A1A] px-1.5 py-0.5 rounded border border-white/5",children:[i("ic_star",ti,"w-2.5 h-2.5 text-yellow-500 fill-current"),s.jsx("span",{className:"text-gray-300 text-[8px] font-bold",children:"4.8"})]})]}),n.hasFreeDelivery&&s.jsx("div",{className:"absolute top-2 right-2",children:s.jsx(Zt,{className:"w-2.5 h-2.5 text-green-500"})})]})},hte=({user:n,merchants:e,onSelectMerchant:t,sliderImages:r=[],sliderConfig:i,onSpecialRequest:o,onOpenFavorites:c,adminUser:u,theme:h,messageCount:m=0,onOpenMessages:p,onOpenSupport:b,unreadSupportCount:v=0})=>{var ge;const[_,T]=w.useState("all"),[k,E]=w.useState(""),[S,L]=w.useState(0),[$,H]=w.useState(""),[G,z]=w.useState(!0),[P,j]=w.useState(0),O=w.useRef(null),[I,R]=w.useState(!1),F=w.useRef(null);sn(()=>I?(R(!1),!0):!1,[I]),w.useEffect(()=>{const Z=te=>{F.current&&!F.current.contains(te.target)&&R(!1)};return document.addEventListener("mousedown",Z),()=>document.removeEventListener("mousedown",Z)},[]),w.useEffect(()=>{const Z=O.current;if(!Z)return;const te=()=>{const me=Z.scrollTop,re=Math.min(me/80,.95);j(re)};return Z.addEventListener("scroll",te,{passive:!0}),()=>Z.removeEventListener("scroll",te)},[]),w.useEffect(()=>{const Z=n.name?n.name.split(" ")[0]:" ";H(` ${Z}`);const te=setTimeout(()=>z(!1),800);return()=>clearTimeout(te)},[n.name]);const M=(i==null?void 0:i.isEnabled)!==!1,ne=w.useMemo(()=>!r||!Array.isArray(r)?[]:r.filter(Z=>Z&&Z.url&&Z.active!==!1&&String(Z.active)!=="false"),[r]),U=w.useMemo(()=>{var Z;return(Z=h==null?void 0:h.customer)!=null&&Z.categories&&h.customer.categories.length>0?[...h.customer.categories].sort((me,re)=>me.sortOrder-re.sortOrder).filter(me=>me.isVisible).map(me=>{let re=Tl.All;return me.key==="cat_restaurant"?re=Tl.Restaurant:me.key==="cat_market"?re=Tl.Market:me.key==="cat_pharmacy"&&(re=Tl.Pharmacy),{id:me.id,label:me.label,Icon:re,customIcon:me.icon}}):cte},[(ge=h==null?void 0:h.customer)==null?void 0:ge.categories]);w.useEffect(()=>{U.length>0&&!U.find(Z=>Z.id===_)&&T(U[0].id)},[U,_]),w.useEffect(()=>{L(0)},[ne.length]),w.useEffect(()=>{if(M&&ne.length>1){const Z=setInterval(()=>{L(te=>(te+1)%ne.length)},4e3);return()=>clearInterval(Z)}},[ne.length,M]);const A=e.filter(Z=>{const te=Z.name.toLowerCase().includes(k.toLowerCase());let me=!0;if(_!=="all"){const re=U.find(ce=>ce.id===_);re&&(me=Z.storeCategory===re.label||Z.storeCategory===re.id,!me&&re.id==="restaurant"&&Z.storeCategory===""&&(me=!0),!me&&re.id==="market"&&Z.storeCategory===" "&&(me=!0),!me&&re.id==="pharmacy"&&Z.storeCategory===""&&(me=!0))}return te&&me}),V=Z=>{if(Z.linkedMerchantId){const te=e.find(me=>me.id===Z.linkedMerchantId);te&&t(te,Z.linkedCategoryId)}},Q=(Z,te,me)=>{var ce,he;const re=(he=(ce=h==null?void 0:h.customer)==null?void 0:ce.icons)==null?void 0:he[Z];return re?s.jsx("img",{src:re,className:`${me} object-contain`,alt:Z}):s.jsx(te,{className:me})},ae=Z=>{if(!Z||Z==="none")return null;if(Z!=null&&Z.startsWith("data:")||Z!=null&&Z.startsWith("http"))return s.jsx("div",{className:"w-6 h-6 min-w-[1.5rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-1 backdrop-blur-sm",children:s.jsx("img",{src:Z,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let te=null,me="";switch(Z){case"verified":te=Mo,me="text-blue-400 fill-blue-500/20";break;case"vip":te=Xi,me="text-yellow-400 fill-yellow-500/20";break;case"star":te=ti,me="text-purple-400 fill-purple-500/20";break;case"popular":te=en,me="text-red-400 fill-red-500/20";break}return te?s.jsx(te,{className:`w-4 h-4 ml-1 ${me}`}):null},X=(v||0)+(m||0),B=Z=>{R(!1),Z==="support"?b&&b():p&&p()},Y=()=>{R(!1),p&&p()};return s.jsxs("div",{className:"h-[100dvh] flex flex-col relative overflow-hidden bg-[#1A1A1A] text-white font-sans",children:[s.jsx("div",{className:"absolute top-0 right-0 w-[200px] h-[200px] bg-red-500/5 rounded-full blur-[80px] -translate-y-1/2 translate-x-1/2 pointer-events-none"}),s.jsxs("div",{className:"px-5 pt-safe pb-3 absolute top-0 left-0 right-0 z-50 transition-colors duration-200 box-content will-change-transform",style:{backgroundColor:`rgba(26, 26, 26, ${P})`,backdropFilter:`blur(${P*12}px)`,borderBottom:`1px solid rgba(255,255,255,${P*.05})`,boxShadow:`0 4px 20px rgba(0,0,0,${P*.1})`},children:[s.jsxs("div",{className:"flex justify-between items-center mb-3 mt-1",children:[s.jsx("div",{className:"flex items-center",children:s.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/10 rounded-full pr-1 pl-4 py-1 flex items-center gap-3 shadow-lg",children:[s.jsx("div",{className:"relative",children:s.jsx(Ji,{frameId:n.specialFrame,size:"sm",className:"scale-110",children:s.jsx("div",{className:"w-full h-full rounded-full bg-[#1A1A1A] overflow-hidden relative z-0 flex items-center justify-center",children:n.storeImage?s.jsx("img",{src:n.storeImage,alt:"User",className:"w-full h-full object-cover rounded-full"}):s.jsx("div",{className:"w-full h-full bg-[#252525] flex items-center justify-center",children:s.jsx(_t,{className:"w-4 h-4 text-gray-400"})})})})}),s.jsxs("div",{className:"flex flex-col items-start animate-fade-slide-up",children:[s.jsxs("span",{className:"text-gray-300 text-[9px] font-medium mb-0.5 flex items-center gap-1 opacity-90",children:[$,"",s.jsx("span",{className:"text-yellow-500 animate-pulse",children:""})]}),s.jsxs("h1",{className:"text-xs font-black text-white tracking-wide leading-none flex items-center gap-1",children:[n.name.split(" ")[0],ae(n.specialBadge)]})]})]})}),s.jsxs("div",{className:"relative",ref:F,children:[s.jsxs("button",{onClick:()=>R(!I),className:`relative w-10 h-10 bg-white/5 hover:bg-white/10 backdrop-blur-md rounded-full flex items-center justify-center border border-white/10 transition-all active:scale-90 shadow-sm ${X>0?"animate-swing":""}`,children:[s.jsx(zs,{className:`w-5 h-5 ${X>0?"text-white":"text-gray-300"}`}),X>0&&s.jsx("span",{className:"absolute top-2 right-2 w-2.5 h-2.5 bg-red-600 rounded-full border-2 border-[#1A1A1A] animate-pulse"})]}),I&&s.jsxs("div",{className:"absolute top-12 left-0 w-64 bg-[#1e1e1e] border border-gray-700/50 rounded-2xl shadow-2xl overflow-hidden z-50 animate-pop-in origin-top-left",children:[s.jsxs("div",{className:"p-3 border-b border-gray-700/50 bg-[#252525] flex justify-between items-center",children:[s.jsx("span",{className:"text-xs font-bold text-white",children:""}),X>0&&s.jsx("button",{onClick:Y,className:"text-[10px] text-gray-400 hover:text-white transition-colors",children:" "})]}),s.jsx("div",{className:"max-h-60 overflow-y-auto custom-scrollbar p-2 space-y-2",children:X===0?s.jsxs("div",{className:"text-center py-6 text-gray-500",children:[s.jsx(zs,{className:"w-8 h-8 mx-auto mb-2 opacity-20"}),s.jsx("p",{className:"text-[10px]",children:"   "})]}):s.jsxs(s.Fragment,{children:[v>0&&s.jsxs("button",{onClick:()=>B("support"),className:"w-full flex items-center gap-3 p-2 rounded-xl hover:bg-white/5 transition-colors group text-right",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center text-green-400 shrink-0 border border-green-500/30",children:s.jsx(Ei,{className:"w-4 h-4"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-xs font-bold text-white mb-0.5",children:"   "}),s.jsxs("p",{className:"text-[10px] text-gray-400 truncate",children:[" ",v,"   "]})]}),s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})]}),m!==void 0&&m>0&&s.jsxs("button",{onClick:()=>B("message"),className:"w-full flex items-center gap-3 p-2 rounded-xl hover:bg-white/5 transition-colors group text-right",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400 shrink-0 border border-blue-500/30",children:s.jsx(Ni,{className:"w-4 h-4"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-xs font-bold text-white mb-0.5",children:" "}),s.jsxs("p",{className:"text-[10px] text-gray-400 truncate",children:[" ",m,"    "]})]}),s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]})]})})]})]})]}),s.jsxs("div",{className:"relative mb-1",children:[s.jsx("div",{className:"absolute inset-y-0 right-3.5 flex items-center pointer-events-none",children:Q("ic_search",mr,"w-3.5 h-3.5 text-gray-500")}),s.jsx("input",{type:"text",className:"w-full bg-[#252525] text-white text-xs rounded-xl py-2.5 pr-9 pl-4 outline-none focus:ring-1 focus:ring-red-500/30 transition-all placeholder-gray-500 border border-white/5 shadow-inner",placeholder:"   ...",value:k,onChange:Z=>E(Z.target.value)})]})]}),s.jsx("div",{ref:O,className:"flex-1 overflow-y-auto pb-28 pt-28 scroll-smooth overscroll-none relative",onScroll:Z=>{const te=Z.currentTarget,me=Math.min(te.scrollTop/80,.95);j(me)},children:s.jsxs("div",{className:"space-y-4 pt-safe",children:[M&&ne.length>0&&s.jsx("div",{className:"px-5 relative z-10 h-36 sm:h-40",children:s.jsxs("div",{className:"relative w-full h-full rounded-2xl overflow-hidden shadow-lg group cursor-pointer border border-white/5 bg-gray-800",children:[ne.map((Z,te)=>{const me=Z.linkedMerchantId?Z.linkedMerchantId===(u==null?void 0:u.id)?u:e.find(ce=>ce.id===Z.linkedMerchantId):null,re=te===S;return s.jsxs("div",{onClick:()=>V(Z),className:`absolute inset-0 w-full h-full transition-opacity duration-1000 ease-in-out cursor-pointer ${re?"opacity-100 z-10":"opacity-0 z-0"}`,children:[s.jsx("img",{src:Z.url,className:`w-full h-full object-cover block transition-transform duration-[10000ms] ease-linear ${re?"scale-110":"scale-100"}`,alt:"Banner"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black/60 via-transparent to-transparent pointer-events-none"}),me&&s.jsx("div",{className:"absolute bottom-3 right-3 z-20 flex items-center justify-between pointer-events-none",children:s.jsxs("div",{className:"flex items-center gap-2 bg-black/40 backdrop-blur-md border border-white/10 pr-1 pl-3 py-1 rounded-full animate-fade-slide-up",children:[s.jsx("div",{className:"w-6 h-6 rounded-full border border-white/50 overflow-hidden bg-gray-800",children:me.storeImage?s.jsx("img",{src:me.storeImage,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-full h-full p-1 text-gray-400"})}),s.jsx("span",{className:"text-[9px] font-bold text-white max-w-[80px] truncate",children:me.name})]})}),Z.textOverlay&&s.jsx("div",{className:"absolute bottom-3 left-3 max-w-[50%] z-20 flex flex-col items-start animate-fade-slide-up",children:s.jsx("div",{className:"bg-black/30 backdrop-blur-md border border-white/10 px-2 py-1.5 rounded-lg shadow-lg",children:s.jsx("p",{className:"text-white font-bold text-[10px] leading-relaxed drop-shadow-md",children:Z.textOverlay})})})]},Z.id)}),s.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1 z-20",children:ne.map((Z,te)=>s.jsx("div",{className:`w-1 h-1 rounded-full transition-all ${te===S?"bg-white w-3":"bg-white/40"}`},te))})]})}),s.jsx("div",{className:"px-5 animate-fade-slide-up",style:{animationDelay:"0.05s"},children:s.jsxs("button",{onClick:o,className:"w-full bg-gradient-to-r from-[#2A1010] to-[#1A0B0B] rounded-2xl border border-red-500/20 p-2.5 flex items-center justify-between group active:scale-98 transition-all",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-red-500/10 flex items-center justify-center text-red-400 group-hover:bg-red-500/20 transition-colors",children:Q("ic_special",en,"w-3.5 h-3.5")}),s.jsxs("div",{className:"text-right",children:[s.jsx("h3",{className:"text-white font-bold text-xs",children:" "}),s.jsx("p",{className:"text-gray-500 text-[9px] mt-0.5",children:"   ."})]})]}),s.jsx("div",{className:"text-gray-600 group-hover:text-red-500 transition-colors",children:s.jsx(us,{className:"w-4 h-4"})})]})}),s.jsxs("div",{className:"px-5 animate-fade-slide-up",style:{animationDelay:"0.1s"},children:[s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsx("h3",{className:"text-xs font-bold text-white flex items-center gap-2",children:""})}),s.jsx("div",{className:"flex gap-2.5 overflow-x-auto pb-1 scrollbar-hide",children:G?[1,2,3,4].map(Z=>s.jsx("div",{className:"h-8 w-16 bg-[#252525] rounded-xl animate-pulse"},Z)):U.map(Z=>{const te=_===Z.id,me=Z.Icon,re=Z.customIcon;return s.jsxs("button",{onClick:()=>T(Z.id),className:`
                                        flex items-center gap-1.5 pl-3 pr-1.5 py-1.5 rounded-xl text-[10px] font-bold whitespace-nowrap transition-all duration-200 border
                                        ${te?"bg-white text-black border-white shadow-sm scale-105 z-10":"bg-[#252525] text-gray-400 border-transparent hover:bg-[#303030]"}
                                    `,children:[s.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center ${te?"bg-black text-white":"bg-white/5 text-gray-500"}`,children:re?s.jsx("div",{className:`w-3 h-3 ${te?"bg-white":"bg-gray-500"}`,style:{maskImage:`url(${re})`,maskSize:"contain",maskRepeat:"no-repeat",maskPosition:"center",WebkitMaskImage:`url(${re})`,WebkitMaskSize:"contain",WebkitMaskRepeat:"no-repeat",WebkitMaskPosition:"center"}}):s.jsx(me,{className:"w-3 h-3"})}),Z.label]},Z.id)})})]}),s.jsx("div",{className:"px-5 pb-10 animate-fade-slide-up",style:{animationDelay:"0.2s"},children:s.jsx("div",{className:"grid grid-cols-2 gap-3 mt-1",children:G?s.jsxs(s.Fragment,{children:[s.jsx(ax,{}),s.jsx(ax,{}),s.jsx(ax,{}),s.jsx(ax,{})]}):A.length>0?A.map(Z=>s.jsx(ute,{merchant:Z,onClick:()=>t(Z),theme:h},Z.id)):s.jsxs("div",{className:"col-span-2 py-12 text-center flex flex-col items-center justify-center bg-[#252525] rounded-2xl border border-white/5 border-dashed",children:[s.jsx(mr,{className:"w-8 h-8 text-gray-600 mb-2 opacity-50"}),s.jsx("p",{className:"text-gray-400 text-[10px] font-bold",children:"   "})]})})})]})})]})},fte=({product:n,onClose:e,onConfirm:t})=>{var r;return s.jsx("div",{className:"fixed inset-0 z-[60] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-2xl border border-gray-700 shadow-2xl overflow-hidden animate-pop-in",onClick:i=>i.stopPropagation(),children:[s.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[s.jsx("h3",{className:"font-bold text-white text-base",children:" "}),s.jsx("button",{onClick:e,className:"p-1 rounded-full bg-gray-700 text-gray-400 hover:text-white clickable",children:s.jsx(ut,{className:"w-4 h-4"})})]}),s.jsx("div",{className:"p-4 space-y-2",children:(r=n.sizes)==null?void 0:r.map((i,o)=>s.jsxs("button",{onClick:()=>t(i),className:"w-full flex justify-between items-center p-3 rounded-xl bg-gray-800 hover:bg-gray-700 border border-gray-700 hover:border-gray-500 transition-all group clickable",children:[s.jsx("span",{className:"font-bold text-gray-200 group-hover:text-white text-sm",children:i.name}),s.jsxs("span",{className:"font-bold text-green-400 text-sm",children:[i.price," ."]})]},o))})]})})},mte=({merchant:n,onBack:e,addToCart:t,cart:r,onViewCart:i,initialCategory:o,toggleFavorite:c,favoriteIds:u,appTheme:h})=>{const[m,p]=w.useState(""),[b,v]=w.useState(null),[_,T]=w.useState(0),[k,E]=w.useState(null),S=w.useRef(null),L=w.useRef(null),$=w.useRef({}),H=w.useRef(!1);w.useEffect(()=>{const M=S.current;if(!M)return;const ne=()=>{const U=M.scrollTop,A=Math.min(U/100,.95);T(A)};return M.addEventListener("scroll",ne),()=>M.removeEventListener("scroll",ne)},[]);const G=w.useMemo(()=>Array.from(new Set((n.products||[]).map(ne=>ne.category||""))),[n.products]);w.useEffect(()=>{const M=S.current;if(!M)return;const ne={root:M,rootMargin:"-80px 0px -70% 0px",threshold:0},U=V=>{H.current||V.forEach(Q=>{if(Q.isIntersecting){const ae=Q.target.getAttribute("data-category");if(ae){p(ae);const X=document.getElementById(`cat-btn-${ae}`);if(X&&L.current){const B=L.current,Y=X.offsetLeft-B.offsetWidth/2+X.offsetWidth/2;B.scrollTo({left:Y,behavior:"smooth"})}}}})},A=new IntersectionObserver(U,ne);return Object.values($.current).forEach(V=>{V&&A.observe(V)}),()=>A.disconnect()},[G]),w.useEffect(()=>{o&&G.includes(o)?setTimeout(()=>F(o),100):G.length>0&&p(G[0])},[o]),sn(()=>k?(E(null),!0):b?(v(null),!0):!1,[b,k]);const z=r.reduce((M,ne)=>M+ne.quantity,0),P=r.reduce((M,ne)=>M+ne.price*ne.quantity,0),j=w.useMemo(()=>{const M={};return(n.products||[]).forEach(U=>{const A=U.category||"";M[A]||(M[A]=[]),M[A].push(U)}),M},[n.products]),O=M=>r.filter(ne=>ne.id===M).reduce((ne,U)=>ne+U.quantity,0),I=M=>{M.sizes&&M.sizes.length>0?E(M):t(M)},R=M=>{if(k){const ne={...k,price:M.price};t(ne,M),E(null)}},F=M=>{H.current=!0,p(M);const ne=$.current[M],U=S.current;if(ne&&U){const V=ne.offsetTop-120;U.scrollTo({top:V,behavior:"smooth"}),setTimeout(()=>{H.current=!1},600)}};return s.jsxs("div",{className:"bg-[#1A1A1A] text-white h-[100dvh] flex flex-col relative animate-page-enter font-sans overflow-hidden",children:[s.jsxs("div",{className:"absolute top-0 left-0 right-0 z-50 pt-safe px-4 pb-2 flex items-center justify-between transition-colors duration-200 pointer-events-none box-content h-12 will-change-transform",style:{backgroundColor:`rgba(26, 26, 26, ${_})`,backdropFilter:`blur(${_*12}px)`,borderBottom:`1px solid rgba(255,255,255,${_*.05})`,boxShadow:`0 4px 20px rgba(0,0,0,${_*.1})`},children:[s.jsx("button",{onClick:e,className:"w-9 h-9 rounded-full flex items-center justify-center text-white transition-all active:scale-95 shadow-lg pointer-events-auto bg-black/40 backdrop-blur-md border border-white/10 clickable",children:s.jsx(wi,{className:"w-5 h-5"})}),s.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 translate-y-1 pt-safe transition-opacity duration-300 pointer-events-none",style:{opacity:_>.8?1:0},children:s.jsx("h1",{className:"text-sm font-bold text-white shadow-sm text-center",children:n.name})})]}),s.jsxs("div",{ref:S,className:"flex-1 overflow-y-auto overflow-x-hidden scroll-smooth pb-safe overscroll-none",onScroll:M=>{const ne=M.currentTarget.scrollTop,U=Math.min(ne/100,.95);T(U)},children:[s.jsxs("div",{className:"relative h-44 w-full flex-shrink-0",children:[n.storeImage?s.jsx("img",{src:n.storeImage,alt:"cover",className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full bg-[#252525] flex items-center justify-center text-gray-600",children:s.jsx(ks,{className:"w-12 h-12 opacity-20"})}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#1A1A1A] via-[#1A1A1A]/40 to-transparent"}),s.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 pt-8 bg-gradient-to-t from-[#1A1A1A] to-transparent",children:[s.jsxs("div",{className:"flex justify-between items-end mb-1",children:[s.jsx("h1",{className:"text-xl font-black text-white leading-tight shadow-sm drop-shadow-md",children:n.name}),s.jsxs("div",{className:"bg-white text-black text-[10px] font-bold px-1.5 py-0.5 rounded mb-1 flex items-center gap-0.5",children:["4.8 ",s.jsx(ti,{className:"w-2.5 h-2.5 inline pb-0.5 fill-current"})]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-300 font-medium opacity-90 mb-2",children:[s.jsx("span",{className:"bg-red-500/20 text-red-300 px-1.5 py-0.5 rounded text-[10px] border border-red-500/30",children:n.storeCategory||""}),n.phone&&s.jsx("span",{className:"text-[10px] text-gray-400 font-mono selectable",children:n.phone})]}),s.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold w-fit",children:[s.jsxs("div",{className:"flex items-center gap-1 text-gray-300 bg-white/5 px-2 py-1 rounded-full backdrop-blur-md border border-white/10",children:[s.jsx(It,{className:"w-3 h-3 text-blue-400"}),s.jsxs("span",{children:[n.responseTime||"30"," "]})]}),n.hasFreeDelivery&&s.jsxs("div",{className:"flex items-center gap-1 text-gray-300 bg-white/5 px-2 py-1 rounded-full backdrop-blur-md border border-white/10",children:[s.jsx(Zt,{className:"w-3 h-3 text-green-400"}),s.jsx("span",{children:""})]})]})]})]}),s.jsx("div",{className:"sticky top-0 z-40 bg-[#1A1A1A] border-b border-white/5 shadow-xl pt-1 pb-1",children:s.jsx("div",{ref:L,className:"flex gap-2 overflow-x-auto px-4 pb-2 scrollbar-hide",children:G.map(M=>s.jsx("button",{id:`cat-btn-${M}`,onClick:()=>F(M),className:`
                            px-4 py-1.5 rounded-full text-[11px] font-bold whitespace-nowrap transition-all duration-300 border clickable
                            ${m===M?"bg-white text-black border-white shadow-sm scale-105":"bg-[#252525] text-gray-400 border-transparent hover:bg-[#303030]"}
                        `,children:M},M))})}),s.jsx("div",{className:"px-4 pt-3 space-y-5 pb-32",children:G.map(M=>{var ne;return s.jsxs("div",{ref:U=>{$.current[M]=U},"data-category":M,className:"min-h-[60px]",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h4",{className:"text-base font-black text-white",children:M}),s.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-gray-800 to-transparent"})]}),s.jsx("div",{className:"grid gap-2",children:(ne=j[M])==null?void 0:ne.map(U=>{var Q;const A=O(U.id),V=U.sizes&&U.sizes.length>0;return s.jsxs("div",{className:"group bg-[#252525] rounded-xl p-2 border border-white/5 flex gap-3 relative overflow-hidden transition-all duration-300 active:bg-[#2a2a2a]",children:[A>0&&s.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-green-500"}),s.jsxs("div",{className:"w-20 h-20 bg-[#1A1A1A] rounded-lg overflow-hidden flex-shrink-0 cursor-pointer relative clickable",onClick:()=>U.image&&v(U.image),children:[U.image?s.jsx("img",{src:U.image,className:"w-full h-full object-cover",alt:U.name}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:s.jsx(ks,{className:"w-5 h-5 opacity-30"})}),!U.available&&s.jsx("div",{className:"absolute inset-0 bg-black/70 flex items-center justify-center backdrop-blur-sm",children:s.jsx("span",{className:"text-[9px] font-bold text-white bg-red-600 px-2 py-0.5 rounded shadow-lg",children:" "})})]}),s.jsxs("div",{className:"flex-1 min-w-0 py-0.5 flex flex-col justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"flex justify-between items-start",children:s.jsx("h4",{className:"font-bold text-white text-xs mb-0.5 truncate",children:U.name})}),s.jsx("p",{className:"text-[9px] text-gray-400 line-clamp-2 leading-tight opacity-80",children:U.description})]}),s.jsxs("div",{className:"flex items-end justify-between mt-1",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("span",{className:"font-black text-white text-sm",children:[U.price>0?U.price:V?(Q=U.sizes)==null?void 0:Q[0].price:0,s.jsx("span",{className:"text-[9px] text-red-500 font-bold ml-0.5",children:"."})]}),V&&s.jsx("span",{className:"text-[8px] text-green-400 font-bold",children:" "})]}),A>0&&!V?s.jsxs("div",{className:"flex items-center bg-[#1A1A1A] rounded-full p-0.5 border border-green-500/30 shadow-lg",children:[s.jsx("div",{className:"px-2 text-xs font-bold text-white",children:A}),s.jsx("button",{onClick:()=>t(U),className:"w-5 h-5 bg-green-500 text-white rounded-full flex items-center justify-center active:scale-90 transition-transform clickable",children:s.jsx(hs,{className:"w-3 h-3"})})]}):s.jsx("button",{onClick:()=>I(U),disabled:!U.available,className:`h-6 px-3 rounded-full flex items-center justify-center transition-all shadow active:scale-90 clickable ${U.available?A>0?"bg-green-600 text-white":"bg-white text-black hover:bg-gray-200":"bg-gray-700 text-gray-500 cursor-not-allowed"}`,children:A>0&&V?s.jsxs("span",{className:"text-[9px] font-bold flex items-center gap-1",children:[s.jsx(hs,{className:"w-2 h-2"})," "]}):s.jsx(hs,{className:"w-3.5 h-3.5"})})]})]})]},U.id)})})]},M)})})]}),z>0&&s.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-[#1A1A1A] via-[#1A1A1A] to-transparent z-50 animate-slide-up",children:s.jsxs("button",{onClick:i,className:"w-full bg-red-600 hover:bg-red-700 text-white py-3.5 rounded-2xl shadow-xl shadow-red-600/30 flex items-center justify-between px-5 transition-all active:scale-[0.98] group border border-red-500/50 clickable",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"bg-white text-red-600 w-6 h-6 rounded-full flex items-center justify-center text-xs font-black shadow-sm",children:z}),s.jsx("span",{className:"font-bold text-base",children:" "})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"font-black text-lg text-white",children:[P," ",s.jsx("span",{className:"text-[10px] font-medium opacity-80",children:"."})]}),s.jsx(wi,{className:"w-4 h-4 rotate-180 opacity-80 group-hover:translate-x-1 transition-transform"})]})]})}),b&&s.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-xl flex items-center justify-center p-4 animate-fadeIn",onClick:()=>v(null),children:[s.jsx("img",{src:b,className:"max-w-full max-h-full object-contain rounded-2xl shadow-2xl animate-pop-in border border-white/10",onClick:M=>M.stopPropagation()}),s.jsx("button",{onClick:()=>v(null),className:"absolute top-6 right-6 p-2 bg-gray-800 rounded-full text-white hover:bg-gray-700 transition-colors border border-white/10 clickable",children:s.jsx(ut,{className:"w-5 h-5"})})]}),k&&s.jsx(fte,{product:k,onClose:()=>E(null),onConfirm:R})]})},gte=({cart:n,onBack:e,onUpdateQuantity:t,onRemoveItem:r,onPlaceOrder:i,savedAddresses:o=[],appTheme:c,promoCodes:u,userPoints:h,pointsConfig:m,userPhone:p,onGoToStores:b})=>{const[v,_]=w.useState("all"),[T,k]=w.useState(!1),[E,S]=w.useState(""),[L,$]=w.useState(""),[H,G]=w.useState(!1),[z,P]=w.useState(""),[j,O]=w.useState(null),[I,R]=w.useState(!1),[F,M]=w.useState(""),[ne,U]=w.useState(0),A=w.useRef(null),V=(m==null?void 0:m.isPointsEnabled)??!0;w.useEffect(()=>{const he=A.current;if(!he)return;const Oe=()=>{const Ue=he.scrollTop,st=Math.min(Ue/60,.95);U(st)};return he.addEventListener("scroll",Oe),()=>he.removeEventListener("scroll",Oe)},[]),w.useEffect(()=>{o.length>0&&_(o[0])},[o]);const Q=n.reduce((he,Oe)=>he+Oe.price*Oe.quantity,0),ae=h*m.currencyPerPoint,X=I&&V?Math.min(ae,Q):0,B=I&&V?Math.ceil(X/m.currencyPerPoint):0;let Y=0;j&&(j.type==="percentage"?Y=Q*j.value/100:Y=j.value);const ge=Math.min(X+Y,Q),Z=Q-ge,te=()=>{if(M(""),!z.trim())return;const he=z.trim().toUpperCase(),Oe=u.find(Ue=>Ue.code===he&&Ue.isActive);if(!Oe){M("     ."),O(null);return}if(Oe.expiryDate&&new Date(Oe.expiryDate)<new Date){M("   ."),O(null);return}if(Oe.maxUsage&&Oe.usageCount>=Oe.maxUsage){M("      ."),O(null);return}O(Oe),P("")},me=()=>{O(null),M("")},re=()=>{E.trim()&&(_(E),k(!1))},ce=()=>{if(T&&E.trim())_(E),k(!1);else if(!v||v==="all"){k(!0);return}G(!0);const he=T&&E.trim()?E:v,Oe={discountAmount:ge,promoCode:j==null?void 0:j.code,pointsUsed:I&&V?B:0,finalPrice:Z};i(L,he,p,Oe)};return s.jsxs("div",{className:"bg-[#1A1A1A] h-full flex flex-col relative animate-page-enter font-sans overflow-hidden fixed inset-0",children:[s.jsxs("div",{className:"absolute top-0 left-0 right-0 z-40 pt-safe px-4 pb-2 flex items-center justify-between transition-all duration-300 pointer-events-none box-content h-12",style:{backgroundColor:`rgba(26, 26, 26, ${ne})`,backdropFilter:ne>.5?"blur(12px)":"none",borderBottom:ne>.5?"1px solid rgba(255,255,255,0.05)":"none"},children:[s.jsxs("div",{className:"flex items-center gap-3 pointer-events-auto",children:[s.jsx("button",{onClick:e,className:"bg-[#252525] hover:opacity-80 p-2 rounded-full text-white transition-colors border border-white/5 active:scale-95 shadow-sm",children:s.jsx(wi,{className:"w-5 h-5"})}),s.jsx("div",{style:{opacity:ne>.2?1:0,transition:"opacity 0.3s"},children:s.jsx("h1",{className:"text-lg font-black text-white leading-none",children:" "})})]}),s.jsxs("div",{className:"bg-red-600/10 text-red-400 px-2 py-1 rounded-lg text-xs font-bold border border-red-500/20 font-mono shadow-sm pointer-events-auto",children:[n.reduce((he,Oe)=>he+Oe.quantity,0)," "]})]}),s.jsxs("div",{ref:A,className:"flex-1 overflow-y-auto pt-20 px-4 space-y-5 pb-48",style:{overscrollBehavior:"none",WebkitOverflowScrolling:"touch"},onScroll:he=>{const Oe=Math.min(he.currentTarget.scrollTop/60,.95);U(Oe)},children:[!ne&&s.jsx("div",{className:"mb-2 transition-opacity duration-300",children:s.jsx("h1",{className:"text-2xl font-black text-white leading-none",children:" "})}),n.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full min-h-[50vh] animate-fadeIn",children:[s.jsx("div",{className:"w-24 h-24 bg-[#252525] rounded-full flex items-center justify-center mb-4 border border-dashed border-gray-700 shadow-inner",children:s.jsx(Rr,{className:"w-10 h-10 text-gray-600 opacity-50"})}),s.jsx("h2",{className:"text-xl font-bold text-white mb-1",children:" "}),s.jsx("p",{className:"text-gray-500 text-xs mb-6",children:"   ."}),s.jsx("button",{onClick:b||e,className:"bg-white text-black font-bold py-3 px-8 rounded-xl hover:bg-gray-200 transition-all shadow-lg active:scale-95 text-sm",children:" "})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-3",children:n.map((he,Oe)=>{var Ue;return s.jsxs("div",{className:"flex gap-3 p-2 bg-[#252525] rounded-2xl border border-white/5 shadow-sm items-center",children:[s.jsx("div",{className:"w-16 h-16 bg-[#1A1A1A] rounded-xl overflow-hidden flex-shrink-0 border border-white/5",children:he.image?s.jsx("img",{src:he.image,className:"w-full h-full object-cover",alt:he.name}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:s.jsx(Rr,{className:"w-6 h-6 opacity-20"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex justify-between items-start mb-1",children:[s.jsx("h4",{className:"font-bold text-white text-sm truncate pl-2",children:he.name}),s.jsx("button",{onClick:()=>r(he.id),className:"text-gray-500 hover:text-red-500 p-1",children:s.jsx(Tt,{className:"w-3.5 h-3.5"})})]}),he.selectedSize&&s.jsx("span",{className:"text-[9px] text-green-400 bg-green-900/20 px-1.5 py-0.5 rounded mb-1 inline-block",children:he.selectedSize.name}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("span",{className:"font-bold text-red-400 text-xs",children:[he.price.toLocaleString("en-US")," ."]}),s.jsxs("div",{className:"flex items-center bg-[#1A1A1A] rounded-lg p-0.5 border border-white/5 h-7",children:[s.jsx("button",{onClick:()=>t(he.id,1),className:"w-7 h-full flex items-center justify-center text-white hover:bg-white/10 rounded",children:s.jsx(hs,{className:"w-2.5 h-2.5"})}),s.jsx("span",{className:"w-6 text-center font-bold text-xs text-white",children:he.quantity}),s.jsx("button",{onClick:()=>t(he.id,-1),className:"w-7 h-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 rounded",children:s.jsx(Xj,{className:"w-2.5 h-2.5"})})]})]})]})]},he.id+(((Ue=he.selectedSize)==null?void 0:Ue.name)||""))})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between px-1",children:[s.jsx("h3",{className:"font-bold text-white text-xs",children:" "}),!T&&o.length>0&&s.jsx("button",{onClick:()=>{k(!0),S("")},className:"text-[10px] text-red-400 font-bold hover:text-red-300 transition-colors",children:"+ "})]}),T?s.jsxs("div",{className:"flex gap-2 items-center animate-fadeIn",children:[s.jsx("input",{type:"text",value:E,onChange:he=>S(he.target.value),placeholder:"    ( ...)",className:"flex-1 bg-[#252525] border border-white/10 rounded-xl px-4 py-3 text-xs text-white outline-none focus:border-red-500 transition-all placeholder-gray-500",autoFocus:!0}),s.jsx("button",{onClick:re,className:"bg-red-600 hover:bg-red-700 text-white p-3 rounded-xl transition-all shadow-lg active:scale-95 flex-shrink-0",children:s.jsx(Je,{className:"w-5 h-5"})}),s.jsx("button",{onClick:()=>k(!1),className:"bg-gray-700 hover:bg-gray-600 text-gray-300 p-3 rounded-xl transition-all active:scale-95 flex-shrink-0",children:s.jsx(ut,{className:"w-5 h-5"})})]}):o.length>0?s.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-1 scrollbar-hide",children:[o.map((he,Oe)=>s.jsx("button",{onClick:()=>_(he),className:`flex-shrink-0 min-w-[200px] p-3 rounded-xl border text-right transition-all text-xs ${v===he?"bg-red-900/20 border-red-500 text-white":"bg-[#252525] text-gray-400 border-white/5"}`,children:s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(fs,{className:`w-3.5 h-3.5 ${v===he?"text-red-500":"text-gray-500"}`}),s.jsx("span",{className:"font-bold line-clamp-1",children:he})]})},Oe)),v&&v!=="all"&&!o.includes(v)&&s.jsx("button",{onClick:()=>_(v),className:"flex-shrink-0 min-w-[200px] p-3 rounded-xl border text-right transition-all text-xs bg-red-900/20 border-red-500 text-white",children:s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(fs,{className:"w-3.5 h-3.5 text-red-500"}),s.jsx("span",{className:"font-bold line-clamp-1",children:v})]})})]}):s.jsxs("button",{onClick:()=>k(!0),className:"w-full p-4 rounded-xl border border-dashed border-gray-600 text-gray-400 text-xs flex items-center justify-center gap-2 hover:border-red-500/50 hover:text-red-400 transition-colors",children:[s.jsx(hs,{className:"w-4 h-4"}),"  "]}),s.jsx("textarea",{value:L,onChange:he=>$(he.target.value),placeholder:" ()...",className:"w-full bg-[#252525] border border-white/5 rounded-xl p-3 text-white text-xs outline-none focus:border-red-500/50 resize-none h-16"})]}),s.jsxs("div",{className:"space-y-2",children:[V&&h>0&&ae>=1&&s.jsxs("div",{className:`p-3 rounded-xl border flex items-center justify-between transition-all ${I?"bg-yellow-900/20 border-yellow-500/30":"bg-[#252525] border-white/5"}`,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ay,{className:"w-4 h-4 text-yellow-500"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-bold text-white",children:" "}),s.jsxs("p",{className:"text-[10px] text-gray-400",children:[" ",s.jsx("span",{className:"text-yellow-400",children:h})," = ",ae.toLocaleString("en-US",{minimumFractionDigits:2})," ."]})]})]}),s.jsx("input",{type:"checkbox",checked:I,onChange:()=>R(!I),className:"w-4 h-4 accent-yellow-500 rounded"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:z,onChange:he=>P(he.target.value),placeholder:" ",className:"flex-1 bg-[#252525] border border-white/5 rounded-xl px-3 py-2 text-xs text-white outline-none focus:border-white/20",disabled:!!j}),j?s.jsxs("button",{onClick:me,className:"bg-green-600/20 text-green-400 px-3 py-2 rounded-xl text-xs font-bold border border-green-500/20",children:[" (",j.code,")"]}):s.jsx("button",{onClick:te,className:"bg-[#252525] text-white px-4 py-2 rounded-xl text-xs font-bold border border-white/10 hover:bg-white/5",children:""})]}),F&&s.jsx("p",{className:"text-red-400 text-[10px] px-1",children:F})]}),s.jsxs("div",{className:"bg-[#eee] text-black rounded-xl p-4 shadow-lg font-mono text-xs space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:""}),s.jsxs("span",{className:"font-bold",children:[Q.toLocaleString("en-US")," ."]})]}),ge>0&&s.jsxs("div",{className:"flex justify-between text-green-700",children:[s.jsx("span",{children:""}),s.jsxs("span",{className:"font-bold",children:["-",ge.toLocaleString("en-US",{minimumFractionDigits:2})]})]}),s.jsxs("div",{className:"border-t border-black/10 pt-2 flex justify-between items-end",children:[s.jsx("span",{className:"font-bold",children:""}),s.jsxs("span",{className:"font-black text-lg",children:[Z.toLocaleString("en-US",{minimumFractionDigits:2})," ",s.jsx("span",{className:"text-[10px]",children:"."})]})]})]})]})]}),n.length>0&&s.jsx("div",{className:"fixed bottom-[74px] left-0 right-0 p-4 bg-[#1A1A1A] border-t border-white/5 z-30",children:s.jsxs("button",{onClick:ce,disabled:H,className:"w-full bg-white text-black hover:bg-gray-200 py-3.5 rounded-xl font-black text-sm transition-all flex justify-between items-center px-5 active:scale-[0.98]",children:[s.jsx("span",{children:H?" ...":" "}),!H&&s.jsxs("span",{className:"text-xs bg-black text-white px-2 py-0.5 rounded",children:[Z.toLocaleString("en-US",{minimumFractionDigits:2})," ."]})]})})]})},w4=n=>{switch(n){case ue.WaitingMerchant:return{color:"text-purple-400",bg:"bg-purple-500/10",border:"border-purple-500/20",icon:It,label:" ",progress:10};case ue.Preparing:return{color:"text-orange-400",bg:"bg-orange-500/10",border:"border-orange-500/20",icon:Si,label:" ",progress:35};case ue.Pending:return{color:"text-yellow-400",bg:"bg-yellow-500/10",border:"border-yellow-500/20",icon:Rr,label:" ",progress:15};case ue.InTransit:return{color:"text-blue-400",bg:"bg-blue-500/10",border:"border-blue-500/20",icon:Zt,label:" ",progress:65};case ue.Delivered:return{color:"text-teal-400",bg:"bg-teal-500/10",border:"border-teal-500/20",icon:Je,label:" ",progress:100};case ue.Cancelled:return{color:"text-red-400",bg:"bg-red-500/10",border:"border-red-500/20",icon:ut,label:"",progress:0};default:return{color:"text-gray-400",bg:"bg-gray-500/10",border:"border-gray-500/20",icon:It,label:n,progress:0}}},pte=({orders:n,onDeleteOrder:e,appTheme:t})=>{const[r,i]=w.useState("current"),[o,c]=w.useState(null),[u,h]=w.useState(0),m=w.useRef(null);w.useEffect(()=>{const k=m.current;if(!k)return;const E=()=>{const S=k.scrollTop,L=Math.min(S/60,.95);h(L)};return k.addEventListener("scroll",E),()=>k.removeEventListener("scroll",E)},[]);const p={cardBg:"bg-[#1e1e1e]",border:"border-white/5",textMain:"text-white",textSub:"text-gray-400"},{currentOrders:b,historyOrders:v}=w.useMemo(()=>{const k=[],E=[];n.forEach(L=>{L.status===ue.Delivered||L.status===ue.Cancelled?E.push(L):k.push(L)});const S=(L,$)=>new Date($.createdAt).getTime()-new Date(L.createdAt).getTime();return{currentOrders:k.sort(S),historyOrders:E.sort(S)}},[n]),_=k=>{var G,z;const E=w4(k.status),S=(k.totalPrice||0)+(k.deliveryFee||0),L=k.type==="shopping_order",$=k.deliveryFee&&k.deliveryFee>0,H=L?"bg-gradient-to-br from-[#2a1b36] to-[#1a1a1a] border-purple-500/30":`${p.cardBg} ${p.border}`;return s.jsxs("div",{className:"rounded-2xl p-0.5 relative overflow-hidden group shadow-lg transition-all duration-300 active:scale-[0.99] mb-3",children:[k.status===ue.InTransit&&s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-blue-500/20 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000 z-10 pointer-events-none"}),s.jsxs("div",{className:`${H} rounded-[20px] p-4 relative z-0 flex flex-col border`,children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[s.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center shadow-inner flex-shrink-0 ${L?"bg-purple-500/20 text-purple-300":`${E.bg} ${E.color}`}`,children:L?s.jsx(en,{className:"w-5 h-5 animate-pulse"}):s.jsx(E.icon,{className:"w-5 h-5"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("h3",{className:`font-bold text-base truncate ${L?"text-purple-100":p.textMain}`,children:L?" ":k.merchantName}),s.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[s.jsxs("span",{className:`text-[10px] font-mono tracking-wider px-1.5 py-0.5 rounded ${L?"bg-purple-500/10 text-purple-300":"bg-white/5 text-gray-500"}`,children:["#",k.id]}),s.jsx("span",{className:"text-[10px] text-gray-500 font-medium",children:new Date(k.createdAt).toLocaleTimeString("ar-EG-u-nu-latn",{hour:"2-digit",minute:"2-digit"})})]})]})]}),s.jsxs("div",{className:`px-2.5 py-1 rounded-lg text-[10px] font-bold border backdrop-blur-md flex items-center gap-1 flex-shrink-0 ${L?"bg-purple-500/10 border-purple-500/30 text-purple-300":`${E.bg} ${E.border} ${E.color}`}`,children:[k.status===ue.InTransit&&s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-current animate-ping"}),E.label]})]}),L?s.jsx("div",{className:"bg-purple-900/10 border border-purple-500/10 rounded-lg p-2.5 mb-3",children:s.jsxs("p",{className:"text-xs text-gray-300 leading-relaxed line-clamp-2 italic",children:['"',k.notes,'"']})}):s.jsxs("div",{className:"flex items-center gap-2 mb-3 px-1",children:[s.jsx(Rr,{className:"w-3.5 h-3.5 text-gray-500"}),s.jsxs("span",{className:"text-xs text-gray-300",children:[((G=k.items)==null?void 0:G.length)||0," "]})]}),s.jsxs("div",{className:"flex justify-between items-end border-t border-white/5 pt-2 mt-auto",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[9px] text-gray-500 font-bold mb-0.5",children:" "}),$?s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:`text-lg font-black ${L?"text-purple-400":"text-white"}`,children:S>0?S.toLocaleString("en-US"):(z=k.totalPrice)==null?void 0:z.toLocaleString("en-US")}),s.jsx("span",{className:"text-[10px] text-gray-500 font-bold",children:"."})]}):s.jsxs("span",{className:"text-xs text-yellow-500 font-bold flex items-center gap-1",children:[s.jsx(It,{className:"w-3 h-3"}),"  "]})]}),k.driverId&&k.status===ue.InTransit&&s.jsxs("div",{className:"flex items-center gap-1 bg-blue-500/10 px-2 py-1 rounded border border-blue-500/20 text-blue-400",children:[s.jsx(Zt,{className:"w-3.5 h-3.5"}),s.jsx("span",{className:"text-[10px] font-bold",children:"  "})]})]})]})]},k.id)},T=k=>{const E=w4(k.status),S=(k.totalPrice||0)+(k.deliveryFee||0),L=k.type==="shopping_order";return s.jsxs("div",{className:`${p.cardBg} rounded-xl p-3 border ${p.border} shadow-sm flex items-center justify-between gap-3 mb-2`,children:[s.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[s.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 ${L?"bg-purple-500/10 text-purple-400":k.status===ue.Cancelled?"bg-red-500/10 text-red-500":"bg-teal-500/10 text-teal-500"}`,children:L?s.jsx(en,{className:"w-5 h-5"}):k.status===ue.Cancelled?s.jsx(ut,{className:"w-5 h-5"}):s.jsx(Je,{className:"w-5 h-5"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("h4",{className:`font-bold text-sm truncate ${p.textMain}`,children:L?" ":k.merchantName}),s.jsxs("div",{className:"flex items-center gap-2 text-[10px]",children:[s.jsx("span",{className:p.textSub,children:new Date(k.createdAt).toLocaleDateString("ar-EG-u-nu-latn")}),s.jsx("span",{className:`px-1.5 rounded border ${E.border} ${E.color} bg-transparent font-bold`,children:E.label})]})]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-1 flex-shrink-0",children:[s.jsx("span",{className:`font-mono text-sm font-black ${p.textMain}`,children:S>0?`${S.toLocaleString("en-US")} .`:"--"}),s.jsx("button",{onClick:()=>c(k.id),className:"text-gray-600 hover:text-red-400 transition-colors p-1.5",children:s.jsx(Tt,{className:"w-4 h-4"})})]})]},k.id)};return s.jsxs("div",{className:"bg-[#1A1A1A] h-[100dvh] flex flex-col font-sans overflow-hidden",children:[s.jsxs("div",{className:"absolute top-0 left-0 right-0 z-40 pt-safe px-4 pb-3 transition-all duration-300 box-content",style:{backgroundColor:`rgba(26, 26, 26, ${u})`,backdropFilter:u>.5?"blur(12px)":"none",borderBottom:u>.5?"1px solid rgba(255,255,255,0.05)":"none",boxShadow:u>.5?"0 4px 30px rgba(0,0,0,0.1)":"none"},children:[s.jsx("div",{className:"flex justify-between items-center mb-3 mt-1",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`p-2 ${p.cardBg} rounded-full border ${p.border} shadow-sm`,children:s.jsx(dr,{className:"w-5 h-5 text-gray-200"})}),s.jsxs("div",{children:[s.jsx("h1",{className:`text-lg font-black ${p.textMain} leading-none`,children:""}),s.jsx("p",{className:`text-[10px] ${p.textSub} font-medium mt-0.5`,children:"  "})]})]})}),s.jsxs("div",{className:`flex ${p.cardBg} p-1 rounded-lg shadow-inner border ${p.border}`,children:[s.jsxs("button",{onClick:()=>i("current"),className:`flex-1 py-2 text-xs font-bold rounded-md transition-all ${r==="current"?"bg-[#333] text-white shadow-sm border border-white/10":"text-gray-500 hover:text-gray-400"}`,children:[" (",b.length,")"]}),s.jsxs("button",{onClick:()=>i("history"),className:`flex-1 py-2 text-xs font-bold rounded-md transition-all ${r==="history"?"bg-[#333] text-white shadow-sm border border-white/10":"text-gray-500 hover:text-gray-400"}`,children:[" (",v.length,")"]})]})]}),s.jsx("div",{ref:m,className:"flex-1 overflow-y-auto p-4 space-y-2 pb-24 pt-36 scroll-smooth overscroll-none",onScroll:k=>{const E=Math.min(k.currentTarget.scrollTop/60,.95);h(E)},children:r==="current"?b.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-600 min-h-[40vh]",children:[s.jsx(Cy,{className:"w-16 h-16 mb-4 opacity-10"}),s.jsx("p",{className:"text-sm font-bold text-gray-500",children:"   "})]}):s.jsx("div",{className:"animate-fadeIn pb-4",children:b.map(k=>_(k))}):v.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-600 min-h-[40vh]",children:[s.jsx(It,{className:"w-16 h-16 mb-4 opacity-10"}),s.jsx("p",{className:"text-sm font-bold text-gray-500",children:" "})]}):s.jsx("div",{className:"animate-fadeIn pb-4",children:v.map(k=>T(k))})}),o&&s.jsx(jn,{title:" ",message:"        ",onClose:()=>c(null),onConfirm:()=>{o&&(e(o),c(null))},confirmButtonText:"",confirmVariant:"danger"})]})},xte=({messages:n,onMarkAsSeen:e,hideMessage:t,appTheme:r})=>{var v;const[i,o]=w.useState(null),[c,u]=w.useState(0),h=w.useRef(null);w.useEffect(()=>{const _=h.current;if(!_)return;const T=()=>{const k=_.scrollTop,E=Math.min(k/60,.95);u(E)};return _.addEventListener("scroll",T),()=>_.removeEventListener("scroll",T)},[]);const m=((v=r==null?void 0:r.customer)==null?void 0:v.mode)!=="light",p={bg:m?"bg-[#0f172a]":"bg-gray-50",text:m?"text-white":"text-gray-900",subText:m?"text-gray-400":"text-gray-500",card:m?"bg-[#1e293b]":"bg-white",border:m?"border-white/5":"border-gray-200",footerBg:m?"bg-[#181818]":"bg-gray-50",footerBorder:m?"border-[#2a2a2a]":"border-gray-200"};w.useEffect(()=>{n.forEach(_=>{e(_.id)})},[n,e]);const b=()=>{i&&(t(i),o(null))};return s.jsxs("div",{className:`h-[100dvh] ${p.bg} flex flex-col animate-fadeIn overflow-hidden relative`,children:[s.jsx("div",{className:`absolute top-0 left-0 right-0 z-40 pt-safe px-4 pb-4 flex items-center justify-between transition-all duration-300 pointer-events-none border-b box-content h-14 ${c>.5?p.border:"border-transparent"}`,style:{backgroundColor:m?`rgba(15, 23, 42, ${c})`:`rgba(255, 255, 255, ${c})`,backdropFilter:c>.5?"blur(12px)":"none",boxShadow:c>.5?"0 4px 30px rgba(0,0,0,0.1)":"none"},children:s.jsxs("div",{className:"flex items-center gap-3 mt-2 pointer-events-auto",children:[s.jsx("div",{className:"p-2.5 bg-gradient-to-br from-red-600 to-red-800 rounded-2xl shadow-lg shadow-red-900/30",children:s.jsx(Ni,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:`text-xl font-black ${p.text} leading-none`,children:" "}),s.jsx("p",{className:`text-xs ${p.subText} font-medium mt-1`,children:"   "})]})]})}),s.jsx("div",{ref:h,className:`flex-1 overflow-y-auto p-4 space-y-5 pb-24 pt-24 ${p.bg} overscroll-none`,onScroll:_=>{const T=Math.min(_.currentTarget.scrollTop/60,.95);u(T)},children:n.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 h-[70vh]",children:[s.jsx("div",{className:`w-24 h-24 ${m?"bg-[#1E1E1E]":"bg-white"} rounded-full flex items-center justify-center mb-6 border ${m?"border-[#333]":"border-gray-200"} shadow-xl`,children:s.jsx(zs,{className:"w-10 h-10 text-gray-400"})}),s.jsx("h3",{className:`text-xl font-bold ${p.text} mb-2`,children:"   "}),s.jsx("p",{className:`text-sm ${p.subText} max-w-xs leading-relaxed`,children:"          ."})]}):n.map(_=>{const T=new Date(_.createdAt).toLocaleDateString("ar-EG-u-nu-latn",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("div",{className:"self-center",children:s.jsx("span",{className:`text-[10px] ${p.subText} ${m?"bg-[#1E1E1E] border-[#333]":"bg-gray-200 border-gray-300"} px-2 py-0.5 rounded-full border`,children:T})}),s.jsxs("div",{className:`${p.card} rounded-2xl rounded-tr-sm border ${p.border} shadow-lg overflow-hidden relative group`,children:[s.jsxs("div",{className:"p-5",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-red-600 flex items-center justify-center shadow-md",children:s.jsx(zs,{className:"w-3 h-3 text-white"})}),s.jsx("span",{className:`text-xs font-bold ${m?"text-gray-300":"text-gray-600"}`,children:"  "})]}),_.image&&s.jsx("div",{className:`mb-4 rounded-xl overflow-hidden border ${m?"border-[#444]":"border-gray-200"} shadow-inner`,children:s.jsx("img",{src:_.image,alt:"",className:"w-full h-auto"})}),s.jsx("p",{className:`${p.text} text-sm leading-relaxed whitespace-pre-wrap font-medium`,children:_.text})]}),s.jsxs("div",{className:`${p.footerBg} p-2 flex justify-between items-center border-t ${p.footerBorder}`,children:[s.jsx("span",{className:`text-[10px] ${p.subText} px-2`,children:" "}),s.jsx("button",{onClick:()=>o(_.id),className:`p-2 text-gray-500 hover:text-red-500 ${m?"hover:bg-red-500/10":"hover:bg-red-100"} rounded-full transition-all`,title:"",children:s.jsx(Tt,{className:"w-4 h-4"})})]})]})]},_.id)})}),i&&s.jsx(jn,{title:" ",message:"      ",onClose:()=>o(null),onConfirm:b,confirmButtonText:"",confirmVariant:"danger"})]})},bte=({user:n,onBack:e,onPlaceOrder:t,appTheme:r})=>{const[i,o]=w.useState(""),c=w.useMemo(()=>((n==null?void 0:n.addresses)||[]).filter(R=>!R.includes("")&&!R.includes("")&&!R.includes("Pickup")),[n==null?void 0:n.addresses]),u=c.length>0?c[0]:"",[h,m]=w.useState(u),[p,b]=w.useState(!u),v=(n==null?void 0:n.phone)||"",[_,T]=w.useState(v),[k,E]=w.useState(!v),[S,L]=w.useState(!1),[$,H]=w.useState(0),G=w.useRef(null);w.useEffect(()=>{const R=G.current;if(!R)return;const F=()=>{const M=R.scrollTop,ne=Math.min(M/100,.95);H(ne)};return R.addEventListener("scroll",F),()=>R.removeEventListener("scroll",F)},[]);const z=()=>{if(!i.trim())return;if(!h.trim()){alert("   ");return}if(!_.trim()){alert("   ");return}if(_.length<11){alert("   ");return}L(!0);const R=i;setTimeout(()=>{t(R,h,_)},1500)},P=R=>{m(R),b(!1)},j=()=>{m(""),b(!0)},O=R=>{T(R),E(!1)},I=()=>{T(""),E(!0)};return s.jsxs("div",{className:"bg-[#0f0f13] h-[100dvh] flex flex-col relative animate-page-enter font-sans overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 inset-x-0 h-[500px] bg-gradient-to-b from-[#2D1B36] via-[#15101a] to-[#0f0f13] pointer-events-none"}),s.jsx("div",{className:"absolute -top-40 -right-20 w-96 h-96 bg-purple-600/20 rounded-full blur-[100px] pointer-events-none animate-pulse-slow"}),s.jsx("div",{className:"absolute top-20 -left-20 w-72 h-72 bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"}),s.jsxs("div",{className:"absolute top-0 left-0 right-0 z-40 pt-safe px-4 pb-4 flex items-center justify-between transition-all duration-500 pointer-events-none box-content h-14",style:{backgroundColor:`rgba(15, 15, 19, ${$})`,backdropFilter:$>.5?"blur(16px)":"none",borderBottom:$>.5?"1px solid rgba(255,255,255,0.05)":"none",boxShadow:$>.5?"0 10px 40px rgba(0,0,0,0.2)":"none"},children:[s.jsx("button",{onClick:e,className:"bg-white/5 hover:bg-white/10 backdrop-blur-md p-3 rounded-full text-white transition-all border border-white/10 active:scale-95 pointer-events-auto group",children:s.jsx(wi,{className:"w-5 h-5 group-hover:-translate-x-0.5 transition-transform"})}),s.jsxs("div",{className:`flex items-center gap-2 bg-white/5 backdrop-blur-xl px-4 py-2 rounded-full border border-white/10 pointer-events-auto transition-all duration-500 ${$>.5?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}`,children:[s.jsx(en,{className:"w-4 h-4 text-purple-400"}),s.jsx("span",{className:"text-sm font-bold text-white tracking-wide",children:" "})]}),s.jsx("div",{className:"w-10"})]}),s.jsxs("div",{ref:G,className:"flex-1 overflow-y-auto pt-28 px-5 space-y-8 pb-44 scroll-smooth relative z-10 overscroll-none",onScroll:R=>{const F=Math.min(R.currentTarget.scrollTop/100,.95);H(F)},children:[s.jsxs("div",{className:"text-center space-y-4 mt-2 mb-8 relative",style:{opacity:Math.max(0,1-$*2),transform:`translateY(${$*-20}px)`,transition:"all 0.1s"},children:[s.jsxs("div",{className:"inline-flex items-center justify-center p-4 bg-gradient-to-tr from-purple-500/20 to-blue-500/20 rounded-3xl border border-white/10 shadow-2xl shadow-purple-900/20 mb-2 relative group",children:[s.jsx("div",{className:"absolute inset-0 bg-white/5 blur-xl rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-1000"}),s.jsx(en,{className:"w-10 h-10 text-purple-300 animate-pulse"})]}),s.jsxs("h1",{className:"text-4xl font-black text-white leading-tight tracking-tight",children:[" ",s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-purple-400 via-pink-400 to-orange-400",children:" "}),"",s.jsx("br",{})," ",s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-300",children:" "}),"."]}),s.jsx("p",{className:"text-sm text-gray-400 max-w-[280px] mx-auto leading-relaxed font-medium",children:"     .     ."})]}),s.jsxs("div",{className:"group relative",children:[s.jsx("div",{className:"absolute -inset-0.5 bg-gradient-to-r from-purple-600 to-blue-600 rounded-[2.2rem] opacity-30 blur group-hover:opacity-60 transition duration-1000"}),s.jsx("div",{className:"relative bg-[#18181b] border border-white/10 rounded-[2rem] p-1 shadow-2xl",children:s.jsxs("div",{className:"bg-[#131316] rounded-[1.8rem] p-6 space-y-5",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-purple-600 to-indigo-600 flex items-center justify-center text-white shadow-lg shadow-purple-900/30",children:s.jsx(Js,{className:"w-5 h-5"})}),s.jsx("h3",{className:"font-bold text-white text-lg tracking-wide",children:" "})]}),s.jsxs("div",{className:"relative",children:[s.jsx("textarea",{value:i,onChange:R=>o(R.target.value),placeholder:`   ...
: '     '  '      '...`,className:"w-full h-44 bg-[#0a0a0c] border border-white/5 rounded-2xl p-5 text-white placeholder-gray-600 focus:border-purple-500/50 focus:ring-1 focus:ring-purple-500/20 outline-none transition-all resize-none text-base leading-relaxed shadow-inner",autoFocus:!0}),s.jsx("div",{className:"absolute bottom-4 left-4 pointer-events-none",children:s.jsx(Ju,{className:`w-5 h-5 text-purple-500 transition-opacity duration-500 ${i?"opacity-100":"opacity-0"}`})})]})]})})]}),s.jsxs("div",{className:"space-y-4 pt-2",children:[s.jsxs("h3",{className:"text-sm font-bold text-gray-400 px-4 flex items-center gap-2 uppercase tracking-wider",children:[s.jsx(fs,{className:"w-4 h-4 text-purple-500"})," "]}),s.jsxs("div",{className:"grid gap-3",children:[c.map((R,F)=>s.jsxs("button",{onClick:()=>P(R),className:`w-full text-right p-4 rounded-2xl border transition-all duration-300 flex items-center justify-between group relative overflow-hidden ${h===R&&!p?"bg-gradient-to-r from-purple-900/30 to-[#18181b] border-purple-500/50 shadow-lg shadow-purple-900/10 scale-[1.02]":"bg-[#18181b] border-white/5 hover:border-white/10 hover:bg-[#1f1f22]"}`,children:[s.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[s.jsx("div",{className:`p-2.5 rounded-full transition-colors ${h===R&&!p?"bg-purple-600 text-white shadow-md":"bg-[#27272a] text-gray-500"}`,children:s.jsx(ti,{className:"w-4 h-4"})}),s.jsx("span",{className:`text-sm font-bold line-clamp-1 ${h===R&&!p?"text-white":"text-gray-400 group-hover:text-gray-300"}`,children:R})]}),h===R&&!p&&s.jsx("div",{className:"bg-purple-500 rounded-full p-1",children:s.jsx(Je,{className:"w-4 h-4 text-white"})})]},F)),s.jsxs("button",{onClick:j,className:`w-full text-right p-4 rounded-2xl border border-dashed transition-all duration-300 flex items-center gap-4 group ${p?"border-blue-500 bg-blue-900/10":"border-gray-700 bg-transparent hover:bg-white/5 hover:border-gray-500"}`,children:[s.jsx("div",{className:`p-2.5 rounded-full transition-colors ${p?"bg-blue-600 text-white shadow-md":"bg-[#27272a] text-gray-500 group-hover:text-white"}`,children:s.jsx(hs,{className:"w-4 h-4"})}),p?s.jsx("input",{type:"text",value:h,onChange:R=>m(R.target.value),placeholder:"  ...",className:"bg-transparent text-white text-sm font-bold outline-none w-full placeholder-blue-300/50",autoFocus:!0}):s.jsx("span",{className:"text-sm font-bold text-gray-400 group-hover:text-gray-300",children:"  ..."})]})]})]}),s.jsxs("div",{className:"space-y-4 pt-2",children:[s.jsxs("h3",{className:"text-sm font-bold text-gray-400 px-4 flex items-center gap-2 uppercase tracking-wider",children:[s.jsx(zn,{className:"w-4 h-4 text-green-500"})," "]}),s.jsxs("div",{className:"grid gap-3",children:[(n==null?void 0:n.phone)&&s.jsxs("button",{onClick:()=>O(n.phone||""),className:`w-full text-right p-4 rounded-2xl border transition-all duration-300 flex items-center justify-between group relative overflow-hidden ${_===n.phone&&!k?"bg-gradient-to-r from-green-900/30 to-[#18181b] border-green-500/50 shadow-lg shadow-green-900/10 scale-[1.02]":"bg-[#18181b] border-white/5 hover:border-white/10 hover:bg-[#1f1f22]"}`,children:[s.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[s.jsx("div",{className:`p-2.5 rounded-full transition-colors ${_===n.phone&&!k?"bg-green-600 text-white shadow-md":"bg-[#27272a] text-gray-500"}`,children:s.jsx(zn,{className:"w-4 h-4"})}),s.jsxs("span",{className:`text-sm font-bold font-mono tracking-wide ${_===n.phone&&!k?"text-white":"text-gray-400 group-hover:text-gray-300"}`,children:[n.phone," ()"]})]}),_===n.phone&&!k&&s.jsx("div",{className:"bg-green-500 rounded-full p-1",children:s.jsx(Je,{className:"w-4 h-4 text-white"})})]}),s.jsxs("button",{onClick:I,className:`w-full text-right p-4 rounded-2xl border border-dashed transition-all duration-300 flex items-center gap-4 group ${k?"border-green-500 bg-green-900/10":"border-gray-700 bg-transparent hover:bg-white/5 hover:border-gray-500"}`,children:[s.jsx("div",{className:`p-2.5 rounded-full transition-colors ${k?"bg-green-600 text-white shadow-md":"bg-[#27272a] text-gray-500 group-hover:text-white"}`,children:s.jsx(hs,{className:"w-4 h-4"})}),k?s.jsx("input",{type:"tel",value:_,onChange:R=>T(R.target.value),placeholder:"  ...",className:"bg-transparent text-white text-sm font-bold outline-none w-full placeholder-green-300/50 font-mono",autoFocus:!0,dir:"ltr"}):s.jsx("span",{className:"text-sm font-bold text-gray-400 group-hover:text-gray-300",children:"  ..."})]})]})]})]}),s.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-6 pb-8 bg-gradient-to-t from-[#0f0f13] via-[#0f0f13] to-transparent z-30",children:s.jsxs("button",{onClick:z,disabled:S||!i,className:"group relative w-full bg-white text-black hover:bg-gray-100 py-4 rounded-[2rem] font-black text-lg transition-all disabled:bg-gray-800 disabled:text-gray-600 disabled:cursor-not-allowed shadow-2xl shadow-white/10 active:scale-[0.98] overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-gray-200/50 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000"}),s.jsxs("div",{className:"relative z-10 flex justify-between items-center px-6",children:[s.jsx("span",{className:"flex items-center gap-3",children:S?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-5 h-5 border-2 border-black/30 border-t-black rounded-full animate-spin"})," ..."]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"bg-black text-white p-1.5 rounded-full",children:s.jsx(en,{className:"w-4 h-4"})})," "]})}),!S&&s.jsx("span",{className:"text-xs font-bold bg-black/5 px-3 py-1 rounded-lg border border-black/10",children:"  "})]})]})})]})},yte=({merchants:n,favoriteIds:e,toggleFavorite:t,addToCart:r,onBack:i,appTheme:o})=>{const[c,u]=w.useState(0),h=w.useRef(null);w.useEffect(()=>{const b=h.current;if(!b)return;const v=()=>{const _=b.scrollTop,T=Math.min(_/60,.95);u(T)};return b.addEventListener("scroll",v),()=>b.removeEventListener("scroll",v)},[]);const m=w.useMemo(()=>{const b=[];return n.forEach(v=>{v.products&&v.products.forEach(_=>{e.includes(_.id)&&b.push({product:_,merchant:v})})}),b},[n,e]),p=b=>{r(b.product,b.merchant)};return s.jsxs("div",{className:"bg-[#1A1A1A] h-[100dvh] flex flex-col relative animate-page-enter font-sans overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 left-0 right-0 z-40 pt-safe px-4 pb-4 flex items-center justify-between transition-all duration-300 pointer-events-none box-content h-14",style:{backgroundColor:`rgba(26, 26, 26, ${c})`,backdropFilter:c>.5?"blur(12px)":"none",borderBottom:c>.5?"1px solid rgba(255,255,255,0.05)":"none",boxShadow:c>.5?"0 4px 30px rgba(0,0,0,0.1)":"none"},children:s.jsxs("div",{className:"flex items-center gap-3 pointer-events-auto",children:[s.jsx("button",{onClick:i,className:"bg-[#252525] hover:opacity-80 p-2.5 rounded-full text-white transition-colors border border-white/5 active:scale-95 shadow-sm",children:s.jsx(wi,{className:"w-5 h-5"})}),s.jsxs("div",{style:{opacity:c>.2?1:0,transition:"opacity 0.3s"},children:[s.jsxs("h1",{className:"text-xl font-black text-white leading-none flex items-center gap-2",children:["",s.jsx(Sm,{className:"w-5 h-5 text-red-500 fill-current animate-pulse"})]}),s.jsxs("p",{className:"text-xs text-gray-400 font-medium mt-1",children:["  (",m.length,")"]})]})]})}),s.jsxs("div",{ref:h,className:"flex-1 overflow-y-auto pt-24 px-4 pb-24 scroll-smooth overscroll-none",onScroll:b=>{const v=Math.min(b.currentTarget.scrollTop/60,.95);u(v)},children:[!c&&s.jsxs("div",{className:"mb-4 transition-opacity duration-300",children:[s.jsxs("h1",{className:"text-2xl font-black text-white leading-none flex items-center gap-2",children:["",s.jsx(Sm,{className:"w-6 h-6 text-red-500 fill-current"})]}),s.jsxs("p",{className:"text-sm text-gray-400 font-medium mt-2",children:["  (",m.length,")"]})]}),m.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-[60vh] text-center animate-fadeIn",children:[s.jsxs("div",{className:"relative mb-6",children:[s.jsx("div",{className:"absolute inset-0 bg-red-500/10 rounded-full blur-xl"}),s.jsx("div",{className:"w-24 h-24 bg-[#252525] rounded-full flex items-center justify-center relative z-10 shadow-inner border border-white/5",children:s.jsx(Sm,{className:"w-10 h-10 text-gray-500"})})]}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),s.jsxs("p",{className:"text-sm text-gray-400 max-w-[200px] leading-relaxed",children:["    ",s.jsx(Sm,{className:"w-3 h-3 inline text-red-500"}),"      ."]})]}):s.jsx("div",{className:"grid grid-cols-2 gap-4",children:m.map(({product:b,merchant:v},_)=>s.jsxs("div",{className:"group bg-[#252525] rounded-[1.5rem] overflow-hidden border border-white/5 shadow-md hover:shadow-xl hover:border-gray-600 transition-all duration-300 flex flex-col animate-fade-slide-up",style:{animationDelay:`${_*50}ms`},children:[s.jsxs("div",{className:"relative aspect-square w-full bg-[#1A1A1A] overflow-hidden",children:[b.image?s.jsx("img",{src:b.image,alt:b.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:s.jsx(ks,{className:"w-8 h-8 opacity-20"})}),s.jsx("button",{onClick:()=>t(b.id),className:"absolute top-2 right-2 p-1.5 rounded-full bg-black/40 backdrop-blur-md text-white hover:bg-red-500 hover:text-white transition-all z-20 shadow-sm",children:s.jsx(ut,{className:"w-3 h-3"})}),s.jsxs("div",{className:"absolute bottom-2 left-2 bg-black/60 backdrop-blur-md px-2 py-1 rounded-lg flex items-center gap-1 max-w-[80%]",children:[s.jsx(Ar,{className:"w-3 h-3 text-gray-300"}),s.jsx("span",{className:"text-[9px] text-white font-bold truncate",children:v.name})]})]}),s.jsxs("div",{className:"p-3 flex-1 flex flex-col",children:[s.jsx("h3",{className:"font-bold text-white text-sm mb-1 line-clamp-1 leading-snug",children:b.name}),s.jsx("p",{className:"text-[10px] text-gray-400 line-clamp-2 leading-relaxed mb-3 flex-1 opacity-80",children:b.description}),s.jsxs("div",{className:"flex justify-between items-center mt-auto pt-2 border-t border-white/5",children:[s.jsxs("div",{className:"flex items-baseline gap-0.5",children:[s.jsx("span",{className:"text-white font-black text-sm",children:b.price}),s.jsx("span",{className:"text-red-500 text-[9px] font-bold",children:"."})]}),s.jsx("button",{onClick:()=>p({product:b,merchant:v}),className:"w-8 h-8 bg-white text-black rounded-full flex items-center justify-center hover:bg-gray-200 active:scale-90 transition-all shadow-lg",children:s.jsx(hs,{className:"w-4 h-4"})})]})]})]},b.id))})]})]})},vte=({onBack:n,title:e,description:t})=>{const[r,i]=w.useState(!1);return w.useEffect(()=>{i(!0)},[]),s.jsxs("div",{className:"fixed inset-0 bg-[#1A1A1A] z-50 flex flex-col items-center justify-center p-6 text-white overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 w-[300px] h-[300px] bg-red-600/10 rounded-full blur-[100px] pointer-events-none"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-[300px] h-[300px] bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"}),s.jsx("button",{onClick:n,className:"absolute top-safe-offset right-5 p-3 bg-white/5 rounded-full text-white hover:bg-white/10 transition-colors z-20 backdrop-blur-md border border-white/10",style:{top:"calc(var(--safe-area-top) + 20px)"},children:s.jsx(wi,{className:"w-6 h-6"})}),s.jsxs("div",{className:`flex flex-col items-center text-center max-w-sm transition-all duration-700 transform ${r?"translate-y-0 opacity-100":"translate-y-10 opacity-0"}`,children:[s.jsxs("div",{className:"relative mb-10",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-red-500 to-orange-500 rounded-full blur-2xl opacity-40 animate-pulse"}),s.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-[#2a2a2a] to-[#1a1a1a] rounded-full flex items-center justify-center border-4 border-[#333] shadow-2xl relative z-10",children:s.jsx(en,{className:"w-16 h-16 text-red-500 animate-bounce"})}),s.jsx("div",{className:"absolute -top-2 -right-4 bg-[#252525] p-2 rounded-xl border border-white/5 shadow-lg animate-bounce delay-100",children:s.jsx(It,{className:"w-6 h-6 text-blue-400"})})]}),s.jsx("h1",{className:"text-4xl font-black mb-4 bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-400",children:e}),s.jsxs("p",{className:"text-gray-400 text-lg leading-relaxed mb-8",children:[t,s.jsx("br",{}),s.jsx("span",{className:"text-red-400 text-sm font-bold mt-2 block",children:"   !"})]}),s.jsx("div",{className:"w-full h-1.5 bg-gray-800 rounded-full overflow-hidden mb-2",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-red-600 to-orange-500 w-[75%] rounded-full animate-pulse"})}),s.jsx("p",{className:"text-xs text-gray-500 font-mono tracking-widest uppercase",children:"Work in progress"})]})]})},_4=["https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Grinning%20Face%20with%20Big%20Eyes.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Face%20with%20Tears%20of%20Joy.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Smiling%20Face%20with%20Heart-Eyes.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Smiling%20Face%20with%20Hearts.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Star-Struck.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Red%20Heart.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Hand%20gestures/Thumbs%20Up.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Thinking%20Face.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Winking%20Face.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Hand%20gestures/Waving%20Hand.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Face%20Screaming%20in%20Fear.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Pleading%20Face.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Angry%20Face.png","https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Face%20Blowing%20a%20Kiss.png"],wte=({onClose:n,onOpenChat:e,onOpenWhatsapp:t,config:r})=>s.jsx("div",{className:"fixed inset-0 z-[80] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:n,children:s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-[2rem] border border-gray-700 shadow-2xl p-6 animate-pop-in",onClick:i=>i.stopPropagation(),children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"w-16 h-16 bg-blue-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-blue-500/20",children:s.jsx(Ei,{className:"w-8 h-8 text-blue-400"})}),s.jsx("h3",{className:"text-xl font-bold text-white",children:" "}),s.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"   "})]}),s.jsxs("div",{className:"space-y-3",children:[(r==null?void 0:r.isChatEnabled)!==!1&&s.jsxs("button",{onClick:()=>{n(),e()},className:"w-full flex items-center gap-4 p-4 rounded-2xl bg-gray-800 hover:bg-gray-700 transition-colors border border-gray-700",children:[s.jsx("div",{className:"p-2 bg-blue-500/20 rounded-full text-blue-400",children:s.jsx(Zj,{className:"w-6 h-6"})}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-bold text-white",children:" "}),s.jsx("p",{className:"text-xs text-gray-400",children:"    "})]})]}),(r==null?void 0:r.isWhatsappEnabled)!==!1&&s.jsxs("button",{onClick:()=>{n(),t()},className:"w-full flex items-center gap-4 p-4 rounded-2xl bg-green-900/20 hover:bg-green-900/30 transition-colors border border-green-500/20",children:[s.jsx("div",{className:"p-2 bg-green-500/20 rounded-full text-green-400",children:s.jsx(nd,{className:"w-6 h-6"})}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-bold text-white",children:""}),s.jsx("p",{className:"text-xs text-gray-400",children:"   "})]})]}),(r==null?void 0:r.isChatEnabled)===!1&&(r==null?void 0:r.isWhatsappEnabled)===!1&&s.jsx("div",{className:"text-center text-gray-500 py-4 bg-gray-900/50 rounded-xl border border-dashed border-gray-700",children:s.jsx("p",{className:"text-sm",children:"     ."})})]}),s.jsx("button",{onClick:n,className:"mt-6 w-full py-3 text-gray-400 font-bold hover:text-white transition-colors",children:""})]})}),_te=({user:n,onClose:e,config:t})=>{const[r,i]=w.useState([]),[o,c]=w.useState(""),[u,h]=w.useState(null),m=w.useRef(null),p=w.useRef(null),b=w.useRef(null),[v,_]=w.useState(null),[T,k]=w.useState(null),[E,S]=w.useState(null),[L,$]=w.useState(!1),H=w.useRef(null);sn(()=>E?(S(null),!0):v?(_(null),!0):T?(k(null),!0):L?($(!1),!0):(e(),!0),[E,v,T,L]),w.useEffect(()=>{const U=Ir("support_chats",V=>{const Q=V.find(ae=>ae.id===n.id);Q?Q.messages&&i(Q.messages):r.length>0&&(i([]),alert("     ."),e())});xt("support_chats",n.id,{lastUpdated:new Date});const A=setInterval(()=>{xt("support_chats",n.id,{lastUpdated:new Date})},6e4);return()=>{U(),clearInterval(A)}},[n.id]),w.useEffect(()=>{if(r.filter(A=>A.sender==="admin"&&!A.isRead).length>0){const A=r.map(V=>V.sender==="admin"?{...V,isRead:!0}:V);xt("support_chats",n.id,{messages:A})}m.current&&(m.current.scrollTop=m.current.scrollHeight)},[r.length]);const G=async()=>{if(!o.trim()&&!u)return;let U=o;T&&(U=`[ : ${T.text.substring(0,50)+(T.text.length>50?"...":"")}]
${o}`);const A=r.reduce((X,B)=>{const Y=parseInt(B.id);return isNaN(Y)?X:Math.max(X,Y)},0),Q={id:String(A+1),text:U,image:u||void 0,sender:"user",createdAt:new Date,isRead:!1},ae=[...r,Q];i(ae),c(""),h(null),k(null),$(!1),await xt("support_chats",n.id,{id:n.id,userId:n.id,userName:n.name,userPhone:n.phone,lastMessage:u?" ":Q.text,lastUpdated:new Date,unreadCount:1,messages:ae}),Kt("admin",{title:"  ",body:`${n.name}: ${u?" ":U}`,url:"/?target=support"})},z=U=>{var V;const A=(V=U.target.files)==null?void 0:V[0];if(A){const Q=new FileReader;Q.onloadend=()=>{const ae=new Image;ae.src=Q.result,ae.onload=()=>{const X=document.createElement("canvas"),B=600/ae.width;X.width=600,X.height=ae.height*B;const Y=X.getContext("2d");Y==null||Y.drawImage(ae,0,0,X.width,X.height),h(X.toDataURL("image/jpeg",.7))}},Q.readAsDataURL(A)}p.current&&(p.current.value="")},P=U=>{_(U)},j=U=>{H.current=setTimeout(()=>P(U),500)},O=()=>{H.current&&clearTimeout(H.current)},I=async U=>{if(!v)return;const A=v.reactions||[],V=A.includes(U)?A.filter(ae=>ae!==U):[...A,U],Q=r.map(ae=>ae.id===v.id?{...ae,reactions:V}:ae);i(Q),_(null),await xt("support_chats",n.id,{messages:Q})},R=U=>{var V,Q;const A=document.querySelectorAll(".message-text");for(let ae=0;ae<A.length;ae++)if((V=A[ae].textContent)!=null&&V.includes(U)){A[ae].scrollIntoView({behavior:"smooth",block:"center"}),(Q=A[ae].parentElement)==null||Q.classList.add("ring-2","ring-teal-400"),setTimeout(()=>{var X;return(X=A[ae].parentElement)==null?void 0:X.classList.remove("ring-2","ring-teal-400")},1500);break}},F=U=>{const A=U.match(/^\[ : (.*?)\]\n(.*)/s);if(A){const V=A[1],Q=A[2];return s.jsxs(s.Fragment,{children:[" ",s.jsxs("div",{onClick:ae=>{ae.stopPropagation(),R(V)},className:"mb-1 pb-1 border-b border-white/10 cursor-pointer active:opacity-70",children:[" ",s.jsxs("p",{className:"text-[10px] text-white/50 line-clamp-1 italic flex items-center gap-1",children:[" ",s.jsx(eh,{className:"w-3 h-3"})," ",V," "]})," "]})," ",s.jsx("span",{className:"message-text",children:Q})," "]})}return s.jsx("span",{className:"message-text",children:U})},M=U=>{U.currentTarget.style.display="none"},ne=U=>U.startsWith("http");return s.jsxs("div",{className:"fixed inset-0 z-[90] bg-[#0b141a] flex flex-col animate-slide-up select-none touch-callout-none font-sans",onContextMenu:U=>U.preventDefault(),children:[s.jsx("div",{className:"absolute inset-0 z-0 opacity-[0.06] pointer-events-none",style:{backgroundImage:"url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png')"}}),s.jsx("style",{children:".touch-callout-none { -webkit-touch-callout: none; } .select-none { -webkit-user-select: none; user-select: none; }"}),s.jsx("div",{className:"flex-none bg-[#202c33] border-b border-[#2f3b43] z-20 pt-safe shadow-sm",children:s.jsxs("div",{className:"flex items-center gap-2 px-2 py-2 h-14",children:[s.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-white/10 text-[#aebac1] transition-colors flex items-center justify-center",children:s.jsx(wi,{className:"w-6 h-6 rotate-180"})}),s.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[s.jsx("div",{className:"relative flex-shrink-0",children:s.jsx("div",{className:"w-10 h-10 bg-teal-600 rounded-full flex items-center justify-center text-white",children:s.jsx(Ei,{className:"w-6 h-6"})})}),s.jsxs("div",{className:"flex flex-col justify-center flex-1",children:[s.jsx("h3",{className:"font-bold text-[#e9edef] text-base leading-tight truncate",children:" "}),s.jsx("p",{className:"text-xs text-[#8696a0] truncate",children:"  "})]})]})]})}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-1 relative z-10 custom-scrollbar",ref:m,children:[r.length===0&&s.jsxs("div",{className:"text-center text-[#8696a0] py-4 bg-[#202c33]/80 rounded-lg mx-4 mt-4 shadow-sm text-xs border border-[#2f3b43]",children:[s.jsx("p",{className:"text-[#ffd279] mb-1 font-bold",children:"  "}),s.jsx("p",{children:" !    "})]}),r.map(U=>{const A=U.sender==="user",V=U.image&&ne(U.image);return s.jsxs("div",{className:`flex w-full relative z-10 ${A?"justify-end":"justify-start"} mb-1`,children:[" ",s.jsxs("div",{onTouchStart:()=>j(U),onTouchEnd:O,onMouseDown:()=>j(U),onMouseUp:O,className:`relative max-w-[80%] rounded-lg p-2 px-3 shadow-sm text-sm ${V?"bg-transparent shadow-none":A?"bg-[#005c4b] text-[#e9edef] rounded-tr-none":"bg-[#202c33] text-[#e9edef] rounded-tl-none"}`,children:[" ",U.image&&s.jsxs("div",{className:"mb-1.5 rounded-lg overflow-hidden relative group",children:[" ",s.jsx("img",{src:U.image,alt:"attached",className:V?"w-28 h-28 object-contain cursor-pointer drop-shadow-lg":"w-full h-auto object-cover max-h-64 pointer-events-auto cursor-pointer",onClick:Q=>{Q.stopPropagation(),S(U.image)}})," "]})," ",U.text&&s.jsx("div",{className:"leading-relaxed whitespace-pre-wrap dir-rtl pt-0.5",children:F(U.text)})," ",s.jsxs("div",{className:`flex items-end justify-between gap-4 mt-1 -mb-1 ml-[-4px] ${V?"text-gray-300":"text-[#8696a0]"}`,children:[" ",s.jsxs("button",{onClick:Q=>{Q.stopPropagation(),k(U)},className:"opacity-50 hover:opacity-100 transition-opacity p-0.5",children:[" ",s.jsx(eh,{className:"w-3.5 h-3.5"})," "]})," ",s.jsxs("div",{className:"flex items-center gap-1",children:[" ",s.jsx("span",{className:"text-[10px] min-w-fit",children:new Date(U.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})," ",A&&s.jsx("div",{className:"flex -space-x-1 space-x-reverse",children:s.jsx(Je,{className:`w-3.5 h-3.5 ${U.isRead?"text-[#53bdeb]":"text-[#8696a0]"}`})})," "]})," "]})," ",U.reactions&&U.reactions.length>0&&s.jsxs("div",{className:`absolute -bottom-2.5 ${A?"left-0":"right-0"} flex items-center -space-x-1 space-x-reverse`,children:[" ",U.reactions.map((Q,ae)=>s.jsx("div",{className:"w-5 h-5 rounded-full bg-[#202c33] border border-[#0b141a] shadow-sm flex items-center justify-center p-0.5 scale-110",children:s.jsx("img",{src:Q,className:"w-full h-full object-contain"})},ae))," "]})," "]})," "]},U.id)})]}),E&&s.jsxs("div",{className:"fixed inset-0 z-[200] bg-black/95 backdrop-blur-md flex items-center justify-center p-4 animate-fadeIn",onClick:()=>S(null),children:[s.jsx("img",{src:E,className:"max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl animate-pop-in",onClick:U=>U.stopPropagation()}),s.jsx("button",{onClick:()=>S(null),className:"absolute top-4 right-4 bg-white/10 text-white p-3 rounded-full hover:bg-white/20 transition-colors",children:s.jsx(ut,{className:"w-6 h-6"})})]}),v&&s.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fadeIn",onClick:()=>_(null),children:[" ",s.jsxs("div",{className:"bg-[#202c33] w-full max-w-sm rounded-2xl border border-[#2f3b43] shadow-2xl p-6 animate-sheet-up",onClick:U=>U.stopPropagation(),children:[" ",s.jsxs("div",{className:"mb-4",children:[" ",s.jsx("p",{className:"text-xs font-bold text-[#8696a0] mb-3 text-center",children:"  "})," ",s.jsxs("div",{className:"flex justify-between gap-2 bg-[#111b21] p-3 rounded-xl border border-[#2f3b43]",children:[" ",_4.slice(0,5).map((U,A)=>s.jsx("button",{onClick:()=>I(U),className:"hover:scale-125 transition-transform p-1",children:s.jsx("img",{src:U,className:"w-8 h-8 object-contain drop-shadow-md"})},A))," "]})," "]})," ",s.jsxs("button",{onClick:()=>{k(v),_(null)},className:"w-full flex items-center gap-3 p-4 bg-[#111b21] hover:bg-[#2a3942] rounded-xl transition-colors border border-[#2f3b43]",children:[" ",s.jsx(eh,{className:"w-5 h-5 text-blue-400"})," ",s.jsx("span",{className:"font-bold text-sm text-[#e9edef]",children:"  "})," "]})," "]})," "]}),s.jsxs("div",{className:"bg-[#202c33] py-2 px-2 z-20 pb-safe relative border-t border-[#2f3b43]",children:[T&&s.jsxs("div",{className:"flex justify-between items-center bg-[#1e2a30] p-2 border-r-4 border-teal-500 mb-2 rounded-lg mx-1",children:[" ",s.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden pr-2",children:[" ",s.jsx("span",{className:"text-teal-500 text-xs font-bold mb-0.5",children:"  "})," ",s.jsx("p",{className:"text-[#aebac1] text-xs truncate",children:T.image?ne(T.image)?"":" ":T.text})," "]})," ",s.jsx("button",{onClick:()=>k(null),className:"p-1 text-[#8696a0] hover:text-white",children:s.jsx(ut,{className:"w-4 h-4"})})," "]}),s.jsxs("div",{className:"flex items-end gap-2 px-1",children:[s.jsxs("div",{className:"flex-1 bg-[#2a3942] rounded-3xl flex items-center px-3 py-1.5 min-h-[45px] border border-transparent focus-within:border-[#00a884] transition-colors",children:[s.jsx("button",{onClick:()=>$(!L),className:"text-[#8696a0] hover:text-[#e9edef] transition-colors p-1",children:s.jsx("span",{className:"text-xl grayscale opacity-70 hover:opacity-100 transition-all",children:""})}),s.jsx("textarea",{ref:b,value:o,onChange:U=>c(U.target.value),placeholder:"",rows:1,className:"flex-1 bg-transparent text-[#e9edef] text-base outline-none resize-none max-h-24 py-1.5 px-2 placeholder-[#8696a0] leading-relaxed",style:{minHeight:"24px"}}),(t==null?void 0:t.allowImageSending)!==!1&&s.jsx("button",{onClick:()=>{var U;return(U=p.current)==null?void 0:U.click()},className:"text-[#8696a0] hover:text-[#e9edef] p-1.5 -rotate-45 transform",children:s.jsx(Jl,{className:"w-6 h-6"})}),s.jsx("input",{ref:p,type:"file",accept:"image/*",className:"hidden",onChange:z})]}),(o.trim()||u)&&s.jsxs("button",{onClick:()=>{(o.trim()||u)&&G()},className:"w-12 h-12 rounded-full flex items-center justify-center shadow-lg active:scale-90 transition-all z-20 bg-[#00a884] hover:bg-[#008f6f] text-white",children:[" ",s.jsx(yO,{className:"w-5 h-5 ml-0.5"})," "]})]}),u&&s.jsx("div",{className:"absolute bottom-20 right-4 bg-[#202c33] p-2 rounded-xl border border-[#2f3b43] shadow-xl animate-pop-in",children:s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:u,className:"h-20 w-20 rounded-lg object-cover"}),s.jsx("button",{onClick:()=>h(null),className:"absolute -top-2 -right-2 bg-[#2a3942] text-[#e9edef] p-1 rounded-full border border-[#8696a0]",children:s.jsx(ut,{className:"w-3 h-3"})})]})}),L&&s.jsxs("div",{className:"mt-2 bg-[#202c33] border border-[#2f3b43] rounded-t-2xl p-3 shadow-2xl grid grid-cols-6 gap-2 h-60 overflow-y-auto custom-scrollbar",children:[" ",_4.map((U,A)=>s.jsx("button",{onClick:()=>{const V=r.reduce((B,Y)=>{const ge=parseInt(Y.id);return isNaN(ge)?B:Math.max(B,ge)},0),ae={id:String(V+1),text:"",image:U,sender:"user",createdAt:new Date,isRead:!1},X=[...r,ae];i(X),$(!1),xt("support_chats",n.id,{messages:X,lastMessage:"  ",lastUpdated:new Date,unreadCount:1}),Kt("admin",{title:"  ",body:`${n.name}  `,url:"/?target=support"})},className:"hover:bg-white/5 p-1.5 rounded-xl transition-colors",children:s.jsx("img",{src:U,className:"w-8 h-8 object-contain",onError:M})},A))," "]})]})]})},Du=({icon:n,label:e,subLabel:t,onClick:r,danger:i,hasArrow:o=!0})=>s.jsxs("button",{onClick:r,className:`w-full flex items-center justify-between p-3 transition-all active:bg-black/5 group ${i?"text-red-500":"text-white"}`,children:[" ",s.jsxs("div",{className:"flex items-center gap-4",children:[" ",s.jsxs("div",{className:`p-2 rounded-xl ${i?"bg-red-500/10":"bg-gray-800 text-gray-400 group-hover:text-white transition-colors"}`,children:[" ",n," "]})," ",s.jsxs("div",{className:"text-right",children:[" ",s.jsx("p",{className:`font-bold text-sm ${i?"text-red-500":"text-gray-200"}`,children:e})," ",t&&s.jsx("p",{className:"text-[10px] text-gray-500 mt-0.5",children:t})," "]})," "]})," ",!i&&o&&s.jsx(us,{className:"w-4 h-4 text-gray-600 group-hover:text-gray-400 group-hover:-translate-x-1 transition-all"})," "]}),Nte=({title:n,content:e,onClose:t})=>s.jsxs("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:t,children:[" ",s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-3xl border border-gray-700 shadow-2xl overflow-hidden animate-pop-in flex flex-col max-h-[80vh]",onClick:r=>r.stopPropagation(),children:[" ",s.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[" ",s.jsx("h3",{className:"text-lg font-bold text-white",children:n})," ",s.jsx("button",{onClick:t,className:"p-2 rounded-full bg-gray-800 text-gray-400 hover:text-white transition-colors",children:s.jsx(ut,{className:"w-5 h-5"})})," "]})," ",s.jsxs("div",{className:"p-6 overflow-y-auto text-gray-300 text-sm leading-relaxed whitespace-pre-wrap",children:[" ",e," "]})," "]})," "]}),jte=({user:n,onClose:e,onUpdate:t})=>{const r=n.addresses&&n.addresses.length>0?n.addresses[0]:n.address||"",[i,o]=w.useState(r),[c,u]=w.useState(!1),[h,m]=w.useState(""),p=()=>{h.trim()&&(o(h),t([h]),u(!1))};return s.jsxs("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:[" ",s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-md rounded-[2rem] border border-gray-700 shadow-2xl overflow-hidden animate-pop-in flex flex-col",onClick:b=>b.stopPropagation(),children:[" ",s.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[" ",s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[s.jsx(fs,{className:"w-5 h-5 text-red-500"})," "]})," ",s.jsx("button",{onClick:e,className:"p-2 rounded-full bg-gray-800 text-gray-400 hover:text-white transition-colors",children:s.jsx(ut,{className:"w-5 h-5"})})," "]})," ",s.jsxs("div",{className:"p-6",children:[" ",s.jsx("p",{className:"text-xs text-gray-400 mb-3 font-medium",children:"  (  )"})," ",s.jsxs("div",{className:"bg-[#0f172a] rounded-xl p-4 border border-gray-700 group transition-all hover:border-gray-600 shadow-inner",children:[" ",c?s.jsxs("div",{className:"space-y-3 animate-fade-slide-up",children:[" ",s.jsx("textarea",{value:h,onChange:b=>m(b.target.value),className:"w-full bg-[#1e293b] border border-gray-600 rounded-lg p-3 text-white text-sm focus:border-red-500 outline-none resize-none h-28 leading-relaxed",placeholder:" ...",autoFocus:!0})," ",s.jsxs("div",{className:"flex gap-2",children:[" ",s.jsx("button",{onClick:p,className:"flex-1 bg-green-600 text-white py-2.5 rounded-lg text-xs font-bold hover:bg-green-700 transition-colors shadow-lg",children:" "})," ",s.jsx("button",{onClick:()=>u(!1),className:"flex-1 bg-gray-700 text-gray-300 py-2.5 rounded-lg text-xs font-bold hover:bg-gray-600 transition-colors",children:""})," "]})," "]}):s.jsxs("div",{className:"flex justify-between items-start gap-3",children:[" ",s.jsxs("div",{className:"flex-1",children:[" ",i?s.jsx("p",{className:"text-sm text-gray-200 leading-relaxed font-medium",children:i}):s.jsxs("p",{className:"text-sm text-red-400 italic font-medium flex items-center gap-2",children:[s.jsx(Yj,{className:"w-4 h-4"}),"   "]})," "]})," ",s.jsx("button",{onClick:()=>{u(!0),m(i)},className:"p-2 bg-blue-500/10 text-blue-400 rounded-lg hover:bg-blue-500/20 transition-colors flex-shrink-0",title:" ",children:s.jsx(Js,{className:"w-4 h-4"})})," "]})," "]})," "]})," "]})," "]})},Ste=({onClose:n,onSave:e})=>{const[t,r]=w.useState(""),[i,o]=w.useState(""),[c,u]=w.useState(!1),[h,m]=w.useState(""),p=()=>{if(t.length<6){m("     6   ");return}if(t!==i){m("   ");return}e(t),n()};return s.jsxs("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:n,children:[" ",s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-3xl border border-gray-700 shadow-2xl p-6 animate-pop-in",onClick:b=>b.stopPropagation(),children:[" ",s.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"  "})," ",s.jsxs("div",{className:"space-y-3",children:[" ",s.jsxs("div",{className:"relative",children:[" ",s.jsx("input",{type:c?"text":"password",value:t,onChange:b=>r(b.target.value),placeholder:"  ",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3 text-white outline-none focus:border-red-500"})," ",s.jsx("button",{onClick:()=>u(!c),className:"absolute left-3 top-3.5 text-gray-500",children:c?s.jsx(Io,{className:"w-5 h-5"}):s.jsx(Yi,{className:"w-5 h-5"})})," "]})," ",s.jsx("input",{type:"password",value:i,onChange:b=>o(b.target.value),placeholder:"  ",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3 text-white outline-none focus:border-red-500"})," ",h&&s.jsx("p",{className:"text-red-400 text-xs font-bold",children:h})," ",s.jsx("button",{onClick:p,className:"w-full bg-red-600 text-white font-bold py-3 rounded-xl hover:bg-red-700 transition-colors",children:""})," "]})," "]})," "]})},Ete=({user:n,onClose:e,onSave:t})=>{const[r,i]=w.useState(n.name),[o,c]=w.useState(n.phone||""),[u,h]=w.useState(n.storeImage||null),[m,p]=w.useState(!1),[b,v]=w.useState(null),_=w.useRef(null),T=E=>{var L;const S=(L=E.target.files)==null?void 0:L[0];if(S){const $=new FileReader;$.onload=()=>{v($.result),p(!0)},$.readAsDataURL(S)}},k=async E=>{const S=new FileReader;S.readAsDataURL(E),S.onloadend=()=>{h(S.result),p(!1),v(null)}};return s.jsxs("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:[s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-[2rem] border border-gray-700 shadow-2xl overflow-hidden animate-pop-in",onClick:E=>E.stopPropagation(),children:[s.jsxs("div",{className:"p-5 border-b border-gray-700 flex justify-between items-center bg-[#151e2d]",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[s.jsx($s,{className:"w-5 h-5 text-blue-500"})," "]}),s.jsx("button",{onClick:e,className:"p-1.5 rounded-full bg-gray-800 text-gray-400 hover:text-white transition-colors",children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-6 space-y-5",children:[s.jsxs("div",{className:"flex flex-col items-center mb-2",children:[s.jsxs("div",{className:"relative cursor-pointer group",onClick:()=>{var E;return(E=_.current)==null?void 0:E.click()},children:[s.jsxs("div",{className:"w-24 h-24 rounded-full overflow-hidden border-4 border-[#0f172a] shadow-lg relative bg-gray-800 flex items-center justify-center",children:[u?s.jsx("img",{src:u,alt:"Profile",className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-10 h-10 text-gray-500"}),s.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx(qi,{className:"w-8 h-8 text-white"})})]}),s.jsx("div",{className:"absolute bottom-0 right-0 bg-blue-600 rounded-full p-1.5 border-2 border-[#1e293b] shadow-md",children:s.jsx(qi,{className:"w-4 h-4 text-white"})})]}),s.jsx("input",{ref:_,type:"file",accept:"image/*",className:"hidden",onChange:T}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"  "})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2",children:" "}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",value:r,onChange:E=>i(E.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3 text-white outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all pl-10"}),s.jsx(_t,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2",children:" "}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"tel",value:o,onChange:E=>c(E.target.value),className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl px-4 py-3 text-white outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all pl-10 text-right placeholder:text-right font-mono",dir:"rtl"}),s.jsx(zn,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500"})]}),s.jsx("p",{className:"text-[10px] text-yellow-500/80 mt-2 bg-yellow-500/10 p-2 rounded-lg border border-yellow-500/20",children:":         ."})]}),s.jsx("button",{onClick:()=>t(r,o,u||void 0),className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white font-bold py-3.5 rounded-xl shadow-lg active:scale-95 transition-all mt-2",children:" "})]})]}),m&&b&&s.jsx(h0,{imageSrc:b,onCropComplete:k,onClose:()=>{p(!1),v(null),_.current&&(_.current.value="")},aspectRatio:1})]})},Tte=({type:n,onClose:e})=>s.jsxs("div",{className:"fixed inset-0 z-[80] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn",onClick:e,children:[" ",s.jsxs("div",{className:"bg-[#1e293b] w-full max-w-sm rounded-[2rem] border border-gray-700 shadow-2xl p-8 text-center animate-pop-in",onClick:t=>t.stopPropagation(),children:[" ",s.jsxs("div",{className:`w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg ${n==="success"?"bg-green-500/20 text-green-500 ring-4 ring-green-500/10":"bg-yellow-500/20 text-yellow-500 ring-4 ring-yellow-500/10"}`,children:[" ",n==="success"?s.jsx(Je,{className:"w-10 h-10 animate-pulse"}):s.jsx(It,{className:"w-10 h-10 animate-pulse"})," "]})," ",s.jsx("h3",{className:"text-xl font-black text-white mb-2",children:n==="success"?"  ":"  "})," ",s.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-8",children:n==="success"?"      .":"        .      ."})," ",s.jsx("button",{onClick:e,className:`w-full font-bold py-3.5 rounded-xl shadow-lg active:scale-95 transition-all text-white ${n==="success"?"bg-green-600 hover:bg-green-500":"bg-gray-700 hover:bg-gray-600"}`,children:" "})," "]})," "]}),Ite=({user:n,merchants:e,orders:t,onPlaceOrder:r,onLogout:i,onDeleteOrder:o,sliderImages:c,sliderConfig:u,messages:h,markMessageAsSeen:m,hideMessage:p,seenMessageIds:b,deletedMessageIds:v,onUpdateUser:_,adminUser:T,appTheme:k,onUpdateTheme:E,promoCodes:S,pointsConfig:L,initialRoute:$,appConfig:H})=>{const[G,z]=w.useState("landing"),[P,j]=w.useState(null),[O,I]=w.useState([]),[R,F]=w.useState(()=>{try{return JSON.parse(localStorage.getItem("favoriteProductIds")||"[]")}catch{return[]}}),[M,ne]=w.useState(!1),[U,A]=w.useState(!1),[V,Q]=w.useState({title:"",desc:""}),[ae,X]=w.useState(null),[B,Y]=w.useState(!1),[ge,Z]=w.useState(null),[te,me]=w.useState(!1),re=w.useRef(null),[ce,he]=w.useState(!1),[Oe,Ue]=w.useState(!1),[st,fe]=w.useState(void 0),[K,ie]=w.useState(void 0),[J,le]=w.useState([]),[ee,we]=w.useState(!1),[pe,ye]=w.useState(null),Ae=(H==null?void 0:H.appVersion)||"VERSION 1.0.5",xe=(H==null?void 0:H.appName)||"GOO NOW";w.useEffect(()=>{const Ve=Ir("support_chats",tt=>{const rt=tt.find(ft=>ft.id===n.id);if(rt&&rt.messages){const ft=rt.messages.filter($t=>$t.sender==="admin"&&!$t.isRead);le(ft)}}),$e=Ir("settings",tt=>{const rt=tt.find(ft=>ft.id==="support_config");rt&&fe(rt)});return()=>{Ve(),$e()}},[n.id]),w.useEffect(()=>{Pn.reportContext(G)},[G]);const Pe={bg:"bg-[#1A1A1A]",text:"text-white",navBg:"bg-[#1A1A1A]/90",navBorder:"border-white/10"};w.useEffect(()=>{u0("user",n.id)},[n.id]),sn(()=>Oe?(Ue(!1),!0):ce?(he(!1),!0):ge?(Z(null),!0):B?(Y(!1),!0):te?(me(!1),!0):ae?(X(null),!0):M?(ne(!1),!0):U?(A(!1),!0):G==="store"?(j(null),z("store-list"),!0):G==="cart"||G==="favorites"||G==="messages"||G==="special-request"||G==="coming-soon"||G==="store-list"||G==="profile"?(z("landing"),!0):G==="landing"?!1:(z("landing"),!0),[G,M,U,ae,B,te,ge,Oe,ce]);const gt=w.useMemo(()=>{if(!n.phone)return[];const Ve=n.phone.trim();return t.filter($e=>{var rt,ft;return((ft=(rt=$e.customer)==null?void 0:rt.phone)==null?void 0:ft.trim())===Ve})},[t,n.phone]),Ee=(Ve,$e)=>{j(Ve),$e&&ie($e),z("store")},Be=(Ve,$e)=>{const tt=$e?`${Ve.id}-${$e.name}`:Ve.id;I(rt=>rt.find($t=>$t.id===tt)?rt.map($t=>$t.id===tt?{...$t,quantity:$t.quantity+1}:$t):[...rt,{...Ve,id:tt,quantity:1,merchantId:P==null?void 0:P.id,selectedSize:$e}])},ht=Ve=>{F($e=>{const tt=$e.includes(Ve)?$e.filter(rt=>rt!==Ve):[...$e,Ve];return localStorage.setItem("favoriteProductIds",JSON.stringify(tt)),tt})},Me=(Ve,$e,tt,rt)=>{var Dn;const ft=O.length===0,$t={id:Date.now().toString(),customer:{phone:tt||n.phone||"",address:$e,name:n.name},merchantId:ft?"delinow":O[0].merchantId||"",merchantName:ft?" ":((Dn=e.find(Zn=>Zn.id===O[0].merchantId))==null?void 0:Dn.name)||"",status:ft?ue.Pending:ue.WaitingMerchant,createdAt:new Date,notes:Ve,type:"shopping_order"};ft||($t.items=[...O],$t.totalPrice=O.reduce((Zn,Ii)=>Zn+Ii.price*Ii.quantity,0),rt&&Object.assign($t,rt)),r($t),I([]),z("orders")},Ze=(Ve,$e)=>{Ve==="ride"?(Q({title:" ",desc:"           ."}),z("coming-soon")):Ve==="transport"?(Q({title:" ",desc:"       ."}),z("coming-soon")):z(Ve)},at=Ve=>{var tt;const $e=(tt=Ve.target.files)==null?void 0:tt[0];if($e){const rt=new FileReader;rt.onload=()=>{ye(rt.result),we(!0)},rt.readAsDataURL($e)}},yt=async Ve=>{const $e=new FileReader;$e.readAsDataURL(Ve),$e.onloadend=()=>{const tt=$e.result;_(n.id,{storeImage:tt}),we(!1),ye(null)}},St=(Ve,$e,tt)=>{if($e!==n.phone)Kt("admin",{title:"   ",body:` ${n.name}     ${n.phone}  ${$e}`,url:"/?target=users"}),Kt("supervisor",{title:"   ",body:` ${n.name}     ${n.phone}  ${$e}`,url:"/?target=users"}),Z("pending");else if(Ve!==n.name||tt&&tt!==n.storeImage){const rt={name:Ve};tt&&(rt.storeImage=tt),_(n.id,rt),Z("success")}ne(!1)},ve=()=>{const Ve=(st==null?void 0:st.whatsappNumber)||"201000000000";window.open(`https://wa.me/${Ve}`,"_blank")},Ge=()=>s.jsx("nav",{className:`fixed left-4 right-4 ${Pe.navBg} backdrop-blur-xl border ${Pe.navBorder} rounded-[2rem] flex justify-between items-center h-[60px] z-50 shadow-2xl px-4`,style:{bottom:"calc(3rem + env(safe-area-inset-bottom))"},children:[{id:"landing",icon:Qj,label:""},{id:"orders",icon:dr,label:""},{id:"cart",icon:Rr,label:"",badge:O.length},{id:"profile",icon:_t,label:""}].map(Ve=>s.jsxs("button",{onClick:()=>z(Ve.id),className:`relative flex flex-col items-center transition-all ${G===Ve.id?"text-red-500 -translate-y-2":"text-gray-400"}`,children:[s.jsx("div",{className:`p-2 rounded-full ${G===Ve.id?"bg-[#1A1A1A] ring-4 ring-[#252525]":""}`,children:s.jsx(Ve.icon,{className:"w-5 h-5"})}),Ve.badge?s.jsx("span",{className:"absolute -top-1 -right-1 bg-red-600 text-white text-[8px] rounded-full w-3.5 h-3.5 flex items-center justify-center",children:Ve.badge}):null]},Ve.id))}),We=Ve=>{if(!Ve||Ve==="none")return null;if(Ve!=null&&Ve.startsWith("data:")||Ve!=null&&Ve.startsWith("http"))return s.jsx("div",{className:"w-8 h-8 min-w-[2rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:s.jsx("img",{src:Ve,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let $e=null,tt="";switch(Ve){case"verified":$e=Mo,tt="text-blue-400 fill-blue-500/20";break;case"vip":$e=Xi,tt="text-yellow-400 fill-yellow-500/20";break;case"star":$e=ti,tt="text-purple-400 fill-purple-500/20";break;case"popular":$e=en,tt="text-red-400 fill-red-500/20";break}return $e?s.jsx($e,{className:`w-4 h-4 ml-1 ${tt}`}):null},dt=w.useMemo(()=>h.filter(Ve=>!v.includes(Ve.id)&&!b.includes(Ve.id)&&(Ve.targetId==="all"||Ve.targetId===n.id)).length,[h,b,v,n.id]);return s.jsxs("div",{className:`fixed inset-0 h-[100dvh] ${Pe.bg} ${Pe.text} flex flex-col transition-colors duration-300`,dir:"rtl",children:[s.jsx("div",{className:"flex-1 relative flex flex-col overflow-hidden bg-[#1A1A1A]",children:s.jsxs("div",{className:"flex-1 flex flex-col h-full animate-page-enter",children:[G==="landing"&&s.jsx(lte,{user:n,onNavigate:Ze,sliderImages:c,sliderConfig:u,adminUser:T,merchants:e,messageCount:dt,onOpenMessages:()=>z("messages"),onOpenSupport:()=>Ue(!0),unreadSupportCount:J.length}),G==="store-list"&&s.jsx(hte,{user:n,merchants:e,onSelectMerchant:Ee,sliderImages:c,sliderConfig:u,onSpecialRequest:()=>z("special-request"),onOpenFavorites:()=>z("favorites"),adminUser:T,theme:k,messageCount:dt,onOpenMessages:()=>z("messages"),onOpenSupport:()=>Ue(!0),unreadSupportCount:J.length}),G==="store"&&P&&s.jsx(mte,{merchant:P,onBack:()=>z("store-list"),addToCart:Be,cart:O,onViewCart:()=>z("cart"),toggleFavorite:ht,favoriteIds:R,appTheme:k,initialCategory:K}),G==="cart"&&s.jsx(gte,{cart:O,onBack:()=>z("landing"),onGoToStores:()=>z("store-list"),onUpdateQuantity:(Ve,$e)=>I(tt=>tt.map(rt=>rt.id===Ve?{...rt,quantity:Math.max(1,rt.quantity+$e)}:rt)),onRemoveItem:Ve=>I($e=>$e.filter(tt=>tt.id!==Ve)),onPlaceOrder:Me,userPhone:n.phone||"",savedAddresses:n.addresses,appTheme:k,promoCodes:S,userPoints:n.pointsBalance||0,pointsConfig:L}),G==="profile"&&s.jsxs("div",{className:"h-full overflow-y-auto bg-[#121212] pb-24",children:[s.jsxs("div",{className:"relative h-36 bg-gradient-to-br from-[#1e1e1e] to-[#121212]",children:[s.jsx("div",{className:"absolute inset-0 bg-pattern opacity-10"}),s.jsx("div",{className:"absolute -bottom-10 left-1/2 -translate-x-1/2",children:s.jsx("div",{className:"relative",children:s.jsx(Ji,{frameId:n.specialFrame,size:"lg",children:s.jsxs("div",{className:"w-full h-full rounded-full overflow-hidden bg-[#252525] border-4 border-[#121212] flex items-center justify-center shadow-2xl relative z-0",children:[n.storeImage?s.jsx("img",{src:n.storeImage,alt:n.name,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-8 h-8 text-gray-500"}),s.jsx("button",{onClick:()=>{var Ve;return(Ve=re.current)==null?void 0:Ve.click()},className:"absolute bottom-1 right-1 bg-[#252525] p-1.5 rounded-full border-2 border-[#121212] text-gray-400 active:scale-90 hover:text-white transition-all shadow-lg z-30",children:s.jsx(qi,{className:"w-4 h-4"})}),s.jsx("input",{ref:re,type:"file",accept:"image/*",className:"hidden",onChange:at})]})})})})]}),s.jsxs("div",{className:"pt-12 px-5 text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-2 mb-0.5",children:[s.jsx("h2",{className:"text-lg font-bold text-white",children:n.name}),We(n.specialBadge)]}),s.jsx("p",{className:"text-gray-500 text-xs font-mono mb-4",children:n.phone}),s.jsxs("div",{className:"flex justify-center gap-2 mb-6",children:[s.jsxs("div",{className:`bg-[#1E1E1E] rounded-xl p-2 border border-white/5 shadow-sm ${(L==null?void 0:L.isPointsEnabled)===!0?"flex-1":"w-full"}`,children:[s.jsx("p",{className:"text-[9px] text-gray-500 mb-0.5",children:""}),s.jsx("p",{className:"text-base font-black text-white",children:gt.filter(Ve=>Ve.status===ue.Delivered).length})]}),(L==null?void 0:L.isPointsEnabled)===!0&&s.jsxs("div",{className:"flex-1 bg-[#1E1E1E] rounded-xl p-2 border border-white/5 shadow-sm",children:[s.jsx("p",{className:"text-[9px] text-gray-500 mb-0.5",children:""}),s.jsx("p",{className:"text-base font-black text-yellow-500",children:n.pointsBalance||0})]})]}),s.jsxs("div",{className:"space-y-3 text-right",children:[s.jsxs("button",{onClick:()=>he(!0),className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white font-bold p-3 rounded-2xl shadow-lg shadow-blue-900/20 flex items-center justify-between mb-3 active:scale-[0.98] transition-all",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-1.5 rounded-lg bg-white/20 text-white",children:s.jsx(Ei,{className:"w-5 h-5"})}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-bold text-sm",children:" "}),s.jsx("p",{className:"text-[9px] text-blue-200",children:"  "})]})]}),s.jsx(us,{className:"w-4 h-4 text-blue-200"})]}),s.jsxs("div",{className:"bg-[#1E1E1E] rounded-2xl overflow-hidden border border-white/5",children:[s.jsx(Du,{icon:s.jsx($s,{className:"w-4 h-4"}),label:" ",onClick:()=>ne(!0)}),s.jsx("div",{className:"h-px bg-white/5 mx-4"}),s.jsx(Du,{icon:s.jsx(Yi,{className:"w-4 h-4"}),label:"  ",onClick:()=>me(!0)}),s.jsx("div",{className:"h-px bg-white/5 mx-4"}),s.jsx(Du,{icon:s.jsx(fs,{className:"w-4 h-4"}),label:" ",onClick:()=>A(!0)})]}),s.jsxs("div",{className:"bg-[#1E1E1E] rounded-2xl overflow-hidden border border-white/5",children:[s.jsx(Du,{icon:s.jsx(ur,{className:"w-4 h-4"}),label:" ",onClick:()=>X({title:" ",content:"..."})}),s.jsx("div",{className:"h-px bg-white/5 mx-4"}),s.jsx(Du,{icon:s.jsx(dr,{className:"w-4 h-4"}),label:" ",onClick:()=>X({title:" ",content:"..."})})]}),s.jsx("div",{className:"bg-[#1E1E1E] rounded-2xl overflow-hidden border border-white/5 mt-4",children:s.jsx(Du,{icon:s.jsx(c0,{className:"w-4 h-4"}),label:" ",danger:!0,onClick:()=>Y(!0)})}),s.jsxs("p",{className:"text-center text-[9px] text-gray-700 mt-4 font-mono",children:[xe," ",Ae]})]})]})]}),G==="orders"&&s.jsx(pte,{orders:gt,onDeleteOrder:o,appTheme:k}),G==="messages"&&s.jsx(xte,{messages:h.filter(Ve=>!v.includes(Ve.id)&&(Ve.targetId==="all"||Ve.targetId===n.id)),onMarkAsSeen:m,hideMessage:p,appTheme:k}),G==="special-request"&&s.jsx(bte,{user:n,onBack:()=>z("landing"),onPlaceOrder:Me,appTheme:k}),G==="favorites"&&s.jsx(yte,{merchants:e,favoriteIds:R,toggleFavorite:ht,addToCart:(Ve,$e)=>{j($e),Be(Ve)},onBack:()=>z("store-list"),appTheme:k}),G==="coming-soon"&&s.jsx(vte,{title:V.title,description:V.desc,onBack:()=>z("landing")})]},G)}),ae&&s.jsx(Nte,{title:ae.title,content:ae.content,onClose:()=>X(null)}),M&&s.jsx(Ete,{user:n,onClose:()=>ne(!1),onSave:St}),ge&&s.jsx(Tte,{type:ge,onClose:()=>Z(null)}),te&&s.jsx(Ste,{onClose:()=>me(!1),onSave:Ve=>_(n.id,{password:Ve})}),U&&s.jsx(jte,{user:n,onClose:()=>A(!1),onUpdate:Ve=>_(n.id,{addresses:Ve})}),ce&&s.jsx(wte,{onClose:()=>he(!1),onOpenChat:()=>Ue(!0),onOpenWhatsapp:ve,config:st}),Oe&&s.jsx(_te,{user:n,onClose:()=>Ue(!1),config:st}),B&&s.jsx(jn,{title:" ",message:"      ",onClose:()=>Y(!1),onConfirm:()=>{Y(!1),i()},confirmButtonText:" ",cancelButtonText:"",confirmVariant:"danger"}),G!=="store"&&G!=="special-request"&&G!=="coming-soon"&&Ge(),ee&&pe&&s.jsx(h0,{imageSrc:pe,onCropComplete:yt,onClose:()=>{we(!1),ye(null),re.current&&(re.current.value="")},aspectRatio:1})]})},ya=({icon:n,label:e,onClick:t,isActive:r,danger:i})=>s.jsxs("button",{onClick:t,className:`w-full flex items-center gap-4 p-4 rounded-2xl transition-all duration-300 group relative overflow-hidden active:scale-95 mb-2 ${i?"text-red-400 hover:bg-red-500/10":r?"bg-cyan-600/20 text-white border border-cyan-500/30 shadow-[0_0_15px_rgba(6,182,212,0.1)]":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[r&&s.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 bg-cyan-500 rounded-l-full"}),s.jsx("div",{className:`relative z-10 transition-transform group-hover:scale-110 duration-300 ${r?"text-cyan-400":""}`,children:n}),s.jsx("span",{className:`relative z-10 font-bold text-sm ${r?"translate-x-1":""} transition-transform duration-300`,children:e})]}),Cte=n=>{var ae;const e=n.user.permissions||[],[t,r]=w.useState(!1),[i,o]=w.useState(null),[c,u]=w.useState(null),[h,m]=w.useState(null),[p,b]=w.useState(null),[v,_]=w.useState(null),T=w.useMemo(()=>n.users.filter(X=>X.role==="merchant"),[n.users]),k=w.useMemo(()=>n.users.filter(X=>X.role==="driver"),[n.users]),[E,S]=w.useState(!0),L=n.users.filter(X=>X.status==="pending"&&X.role!=="admin").length,$=n.orders.filter(X=>X.status===ue.Pending&&!X.driverId).length,H=L+n.passwordResetRequests.length+$,G=()=>e.includes("manage_orders")||e.includes("view_orders")?"orders":e.includes("view_reports")?"reports":e.includes("view_users")?"users":e.includes("send_messages")?"messages":e.includes("manage_support")?"support":e.includes("manage_decorations")?"customizer":"orders",[z,P]=w.useState(G());sn(()=>t?(r(!1),!0):c?(u(null),!0):h?(m(null),!0):p?(b(null),!0):v?(_(null),!0):i?(o(null),!0):z==="add_order"||z==="notifications"||z!=="orders"&&(e.includes("view_orders")||e.includes("manage_orders"))?(P("orders"),!0):!1,[z,i,c,h,p,v,e,t]);const j=async(X,B)=>{if(!e.includes("manage_orders"))return;const Y=n.orders.filter(Z=>Z.status===ue.Pending&&!Z.driverId);if(Y.length===0)return;const ge=Y.map(Z=>({...Z,driverId:X,deliveryFee:B,status:ue.InTransit}));await n.onBulkUpdate(ge),n.showNotification(`  ${ge.length}   `,"success")},O=async X=>{if(!e.includes("delete_orders"))return;const B=X==="all"?n.orders:n.orders.filter(Y=>Y.status===X);if(B.length!==0){for(const Y of B)await n.deleteOrder(Y.id);n.showNotification(`  ${B.length}  `,"success")}},I=async()=>{window.location.reload()},R=[{id:"shopping",condition:e.includes("view_orders")||e.includes("manage_orders")},{id:"special",condition:e.includes("view_orders")||e.includes("manage_orders")},{id:"orders",condition:e.includes("view_orders")||e.includes("manage_orders")},{id:"users",condition:e.includes("view_users")||e.includes("manage_users")},{id:"wallet",condition:e.includes("view_wallet")},{id:"stores",condition:e.includes("manage_stores")},{id:"slider",condition:e.includes("manage_slider")},{id:"messages",condition:e.includes("send_messages")},{id:"support",condition:e.includes("manage_support")},{id:"customizer",condition:e.includes("manage_decorations")}].filter(X=>X.condition).map(X=>X.id),F=((ae=n.appConfig)==null?void 0:ae.appName)||"GOO NOW",[M,...ne]=F.split(" "),U=ne.join(" "),A=X=>{if(X!=null&&X.startsWith("data:")||X!=null&&X.startsWith("http"))return"p-0";switch(X){case"gold":return"p-[3px] bg-gradient-to-tr from-[#BF953F] via-[#FCF6BA] to-[#B38728] shadow-[0_0_8px_rgba(252,246,186,0.4)]";case"neon":return"p-[3px] bg-gradient-to-r from-cyan-400 to-blue-500 shadow-[0_0_8px_rgba(34,211,238,0.5)]";case"royal":return"p-[3px] bg-gradient-to-bl from-indigo-900 via-purple-500 to-indigo-900 shadow-sm border border-purple-500/30";case"fire":return"p-[3px] bg-gradient-to-t from-yellow-500 via-red-500 to-yellow-500 animate-pulse shadow-[0_0_10px_rgba(239,68,68,0.4)]";default:return"p-[2px] bg-gradient-to-br from-cyan-500 to-blue-600"}},V=X=>(X==null?void 0:X.startsWith("data:"))||(X==null?void 0:X.startsWith("http")),Q=X=>{if(!X||X==="none")return null;if(X!=null&&X.startsWith("data:")||X!=null&&X.startsWith("http"))return s.jsx("div",{className:"w-8 h-8 min-w-[2rem] rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shadow-sm overflow-hidden p-0.5 ml-2 backdrop-blur-sm",children:s.jsx("img",{src:X,className:"w-full h-full object-contain drop-shadow-sm",alt:"badge"})});let B=null,Y="";switch(X){case"verified":B=Mo,Y="text-blue-400 fill-blue-500/20";break;case"vip":B=Xi,Y="text-yellow-400 fill-yellow-500/20";break;case"star":B=ti,Y="text-purple-400 fill-purple-500/20";break;case"popular":B=en,Y="text-red-400 fill-red-500/20";break;case"admin-badge":B=$s,Y="text-red-500";break;case"mod-badge":B=ur,Y="text-green-500";break}return B?s.jsx(B,{className:`w-5 h-5 ${Y}`}):null};return s.jsxs("div",{className:"flex flex-col h-screen bg-gray-900 text-white overflow-hidden",children:[t&&s.jsxs("div",{className:"fixed inset-0 z-[60] flex justify-start animate-fadeIn",dir:"rtl",children:[s.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-md transition-all duration-500",onClick:()=>r(!1)}),s.jsxs("div",{className:"w-[290px] h-full bg-[#111827]/60 backdrop-blur-3xl border-l border-white/10 shadow-2xl relative flex flex-col z-10 pt-safe rounded-l-[40px] overflow-hidden transform animate-slide-in-right",children:[s.jsxs("div",{className:"p-8 border-b border-white/5 relative flex flex-col items-center",children:[s.jsx("button",{onClick:()=>r(!1),className:"absolute top-4 left-4 p-2 rounded-full bg-white/5 hover:bg-white/10 text-gray-400 active:scale-90",children:s.jsx(ut,{className:"w-5 h-5"})}),s.jsxs("button",{onClick:()=>{o(n.user),r(!1)},className:`w-24 h-24 rounded-full flex items-center justify-center shadow-2xl mb-4 relative group/avatar cursor-pointer transition-transform active:scale-95 ${V(n.user.specialFrame)?"":A(n.user.specialFrame)}`,children:[V(n.user.specialFrame)&&s.jsx("img",{src:n.user.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.65] pointer-events-none",alt:"frame"}),s.jsxs("div",{className:`${V(n.user.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-gray-900 overflow-hidden border-2 border-white/10 flex items-center justify-center relative z-0`,children:[n.user.storeImage?s.jsx("img",{src:n.user.storeImage,className:"w-full h-full object-cover"}):s.jsx(_t,{className:"w-10 h-10 text-gray-500"}),s.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover/avatar:opacity-100 transition-opacity",children:s.jsx($s,{className:"w-6 h-6 text-white"})})]})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx("h3",{className:"font-black text-xl tracking-tight text-white",children:n.user.name}),Q(n.user.specialBadge)]}),s.jsx("p",{className:"text-[10px] font-bold text-cyan-400 uppercase tracking-[0.2em] mt-1",children:"Supervisor"})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-1 custom-scrollbar",children:[e.includes("view_reports")&&s.jsx(ya,{icon:s.jsx(d0,{className:"w-5 h-5"}),label:" ",onClick:()=>{P("reports"),r(!1)},isActive:z==="reports"}),e.includes("manage_support")&&s.jsx(ya,{icon:s.jsx(Ei,{className:"w-5 h-5"}),label:" ",onClick:()=>{P("support"),r(!1)},isActive:z==="support"}),e.includes("view_users")&&s.jsx(ya,{icon:s.jsx(Md,{className:"w-5 h-5"}),label:"",onClick:()=>{P("users"),r(!1)},isActive:z==="users"}),e.includes("manage_stores")&&s.jsx(ya,{icon:s.jsx(Ar,{className:"w-5 h-5"}),label:" ",onClick:()=>{P("stores"),r(!1)},isActive:z==="stores"}),e.includes("manage_slider")&&s.jsx(ya,{icon:s.jsx(Qr,{className:"w-5 h-5"}),label:" ",onClick:()=>{P("slider"),r(!1)},isActive:z==="slider"}),e.includes("send_messages")&&s.jsx(ya,{icon:s.jsx(Ni,{className:"w-5 h-5"}),label:"",onClick:()=>{P("messages"),r(!1)},isActive:z==="messages"}),e.includes("view_logs")&&s.jsx(ya,{icon:s.jsx(ur,{className:"w-5 h-5"}),label:" ",onClick:()=>{P("logs"),r(!1)},isActive:z==="logs"}),e.includes("manage_promo")&&s.jsx(ya,{icon:s.jsx(Ay,{className:"w-5 h-5"}),label:"",onClick:()=>{P("loyalty"),r(!1)},isActive:z==="loyalty"}),e.includes("manage_decorations")&&s.jsx(ya,{icon:s.jsx(Jj,{className:"w-5 h-5"}),label:" ",onClick:()=>{P("customizer"),r(!1)},isActive:z==="customizer"})]}),s.jsx("div",{className:"p-6 border-t border-white/5 bg-black/20 pb-safe",children:s.jsx(ya,{icon:s.jsx(c0,{className:"w-5 h-5"}),label:" ",onClick:n.onLogout,danger:!0})})]})]}),z!=="add_order"&&s.jsx("header",{className:"bg-gray-800/95 backdrop-blur-md border-b border-cyan-500/30 sticky top-0 z-30 shadow-lg transition-all duration-300 pt-safe rounded-b-[35px] mx-2 mt-1",children:s.jsxs("div",{className:"max-w-7xl mx-auto py-3 px-4 flex justify-between items-center relative h-14",children:[s.jsx("button",{onClick:()=>r(!0),className:"flex items-center gap-3 active:scale-90 transition-transform",children:s.jsxs("div",{className:`relative w-10 h-10 flex items-center justify-center rounded-full shadow-lg ${V(n.user.specialFrame)?"":A(n.user.specialFrame)}`,children:[V(n.user.specialFrame)&&s.jsx("img",{src:n.user.specialFrame,className:"absolute inset-0 w-full h-full z-10 object-contain scale-[1.5] pointer-events-none",alt:"frame"}),s.jsx("div",{className:`${V(n.user.specialFrame)?"w-[85%] h-[85%]":"w-full h-full"} rounded-full bg-gray-900 flex items-center justify-center overflow-hidden relative z-0`,children:n.user.storeImage?s.jsx("img",{src:n.user.storeImage,className:"w-full h-full object-cover"}):s.jsx("div",{className:"text-cyan-500 font-bold text-sm",children:n.user.name.charAt(0)})})]})}),s.jsxs("h1",{className:"text-2xl font-black absolute left-1/2 -translate-x-1/2 select-none",children:[s.jsx("span",{className:"text-red-600",children:M}),s.jsx("span",{className:"text-white ml-1",children:U})]}),s.jsx("div",{className:"flex items-center gap-1",children:s.jsxs("button",{onClick:()=>P("notifications"),className:"relative p-2.5 rounded-xl bg-cyan-500/10 hover:bg-cyan-500/20 transition-colors",children:[s.jsx(zs,{className:`w-6 h-6 ${H>0?"text-yellow-500":"text-gray-400"}`}),H>0&&s.jsx("span",{className:"absolute top-1.5 right-1.5 w-4 h-4 flex items-center justify-center bg-red-600 text-[9px] font-bold text-white rounded-full ring-2 ring-gray-800 animate-pulse",children:H})]})})]})}),s.jsxs("main",{className:z==="add_order"?"flex-1 bg-[#111] h-full":"flex-1 overflow-hidden relative pb-24",children:[s.jsx("div",{className:`h-full ${z==="orders"?"block":"hidden"}`,children:s.jsx(ln,{onRefresh:I,children:(e.includes("view_orders")||e.includes("manage_orders"))&&s.jsx(th,{...n,currentUser:n.user,permissions:e,onNavigateToAdd:()=>P("add_order"),onOpenStatusModal:e.includes("manage_orders")?u:void 0,onOpenPaymentModal:e.includes("manage_advanced_financials")?n.onOpenPaymentModal:void 0,onBulkAssign:e.includes("manage_orders")?j:void 0,onBulkDelete:e.includes("delete_orders")?O:void 0})})}),z==="users"&&s.jsx("div",{className:"h-full animate-fadeIn",children:s.jsx(ln,{onRefresh:I,children:s.jsx(_O,{...n,users:n.users.filter(X=>X.role!=="admin"),onAdminAddUser:n.adminAddUser,onDeleteUser:n.deleteUser,permissions:e,setEditingUser:o,currentUser:n.user})})}),z==="reports"&&e.includes("view_reports")&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:I,children:s.jsx(IO,{orders:n.orders,users:n.users,payments:n.payments,currentUser:n.user})})}),z==="shopping"&&(e.includes("view_orders")||e.includes("manage_orders"))&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:I,children:s.jsx(th,{...n,currentUser:n.user,permissions:e,viewMode:"shopping",onNavigateToAdd:()=>P("add_order"),onOpenStatusModal:e.includes("manage_orders")?u:void 0,onOpenPaymentModal:e.includes("manage_advanced_financials")?n.onOpenPaymentModal:void 0,onBulkAssign:e.includes("manage_orders")?j:void 0,onBulkDelete:e.includes("delete_orders")?O:void 0})})}),z==="special"&&(e.includes("view_orders")||e.includes("manage_orders"))&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:I,children:s.jsx(th,{...n,currentUser:n.user,permissions:e,viewMode:"special",onNavigateToAdd:()=>P("add_order"),onOpenStatusModal:e.includes("manage_orders")?u:void 0,onOpenPaymentModal:e.includes("manage_advanced_financials")?n.onOpenPaymentModal:void 0,onBulkAssign:e.includes("manage_orders")?j:void 0,onBulkDelete:e.includes("delete_orders")?O:void 0})})}),z==="add_order"&&s.jsx(AO,{merchants:T,onClose:()=>P("orders"),onSave:async X=>{await n.adminAddOrder(X)},getNewId:n.getNewId}),z==="notifications"&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:I,children:s.jsx(SO,{users:n.users.filter(X=>X.role!=="admin"),updateUser:n.updateUser,onDeleteUser:n.deleteUser,passwordResetRequests:n.passwordResetRequests,resolvePasswordResetRequest:n.resolvePasswordResetRequest,setEditingUser:o,pendingOrders:n.orders.filter(X=>X.status===ue.Pending&&!X.driverId),onNavigateToOrders:()=>P("orders")})})}),z==="stores"&&e.includes("manage_stores")&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:I,children:s.jsx(jO,{users:n.users,orders:n.orders,updateUser:n.updateUser})})}),z==="messages"&&e.includes("send_messages")&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:I,children:s.jsx(TO,{users:n.users.filter(X=>X.role!=="admin"),onSendMessage:n.sendMessage,messages:n.messages,deleteMessage:n.deleteMessage})})}),z==="support"&&e.includes("manage_support")&&s.jsx("div",{className:"h-full",children:s.jsx(MO,{users:n.users,isRestricted:!0,currentUser:n.user})}),z==="slider"&&e.includes("manage_slider")&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:I,children:s.jsx(CO,{images:n.sliderImages,isEnabled:n.sliderConfig.isEnabled,onAddImage:n.onAddSliderImage,onDeleteImage:n.onDeleteSliderImage,onUpdateImage:n.onUpdateSliderImage,onToggleSlider:n.onToggleSlider,merchants:T,adminUser:void 0})})}),z==="wallet"&&e.includes("view_wallet")&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:I,children:s.jsx(EO,{...n,currentUser:n.user,onDeletePayment:()=>{}})})}),z==="logs"&&e.includes("view_logs")&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:I,children:s.jsx(PO,{logs:n.auditLogs,onClearLogs:()=>{}})})}),z==="loyalty"&&e.includes("manage_promo")&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:I,children:s.jsx(OO,{promoCodes:n.promoCodes,pointsConfig:n.pointsConfig,onAddPromo:n.onAddPromo,onDeletePromo:n.onDeletePromo,onUpdatePointsConfig:n.onUpdatePointsConfig})})}),z==="customizer"&&e.includes("manage_decorations")&&n.currentTheme&&n.onUpdateTheme&&s.jsx("div",{className:"h-full",children:s.jsx(ln,{onRefresh:I,children:s.jsx(DO,{onClose:()=>P("orders"),currentTheme:n.currentTheme,onUpdateTheme:n.onUpdateTheme,users:n.users,onUpdateUser:n.updateUser,sendNotification:Kt,currentUser:n.user})})})]}),z!=="add_order"&&R.length>0&&s.jsx(kO,{activeView:z,onNavigate:X=>P(X),availableViews:R,isVisible:E}),i&&s.jsx(e5,{user:i,onClose:()=>o(null),onSave:(X,B)=>{n.updateUser(X,B),o(null)},isLastAdmin:!1,currentUser:n.user}),c&&s.jsx(RO,{order:c,onClose:()=>u(null),onSelectStatus:(X,B)=>{u(null),setTimeout(()=>{B===ue.InTransit?m(X):_({order:X,newStatus:B})},150)},onTransferOrder:X=>{u(null),setTimeout(()=>{b(X)},100)}}),h&&s.jsx(mb,{order:h,drivers:k,targetStatus:ue.InTransit,onClose:()=>m(null),onSave:(X,B)=>{n.assignDriverAndSetStatus(h.id,X,B,ue.InTransit),m(null)}}),p&&s.jsx(mb,{order:p,drivers:k,targetStatus:ue.InTransit,onClose:()=>b(null),onSave:(X,B)=>{n.assignDriverAndSetStatus(p.id,X,B,ue.InTransit),b(null)}}),v&&s.jsx(jn,{title:"  ",message:"    ",onClose:()=>_(null),onConfirm:()=>{n.updateOrderStatus(v.order.id,v.newStatus),_(null)},confirmVariant:"primary"})]})},Ate=({onClose:n,onRequestReset:e})=>{sn(()=>(n(),!0));const[t,r]=w.useState(""),[i,o]=w.useState(""),[c,u]=w.useState(!1),[h,m]=w.useState(""),[p,b]=w.useState(!1),v=async _=>{if(_.preventDefault(),m(""),o(""),!t){m("   .");return}b(!0);const T=await e(t);b(!1),T.success?(u(!0),o(T.message)):m(T.message)};return s.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-md flex justify-center items-center z-[60] p-4 animate-fadeIn",onClick:n,children:s.jsxs("div",{className:"bg-[#1e293b] rounded-[2rem] shadow-2xl w-full max-w-sm text-white border border-white/10 overflow-hidden relative",onClick:_=>_.stopPropagation(),children:[s.jsxs("div",{className:"p-5 border-b border-white/5 flex justify-between items-center bg-[#151e2d]",children:[s.jsx("h3",{className:"text-lg font-bold text-white tracking-wide",children:"   "}),s.jsx("button",{onClick:n,className:"w-8 h-8 flex items-center justify-center rounded-full bg-white/5 text-gray-400 hover:text-white hover:bg-white/10 transition-colors",children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"p-6",children:c?s.jsxs("div",{className:"text-center py-6 animate-fade-slide-up",children:[s.jsx("div",{className:"w-20 h-20 bg-green-500/10 rounded-full flex items-center justify-center mx-auto mb-4 ring-1 ring-green-500/30",children:s.jsx(zn,{className:"w-10 h-10 text-green-500"})}),s.jsx("h4",{className:"text-xl font-bold text-white mb-2",children:" "}),s.jsx("p",{className:"text-green-400 font-medium text-sm leading-relaxed",children:i}),s.jsx("button",{onClick:n,className:"mt-6 w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 rounded-xl transition-all",children:""})]}):s.jsxs("form",{onSubmit:v,className:"space-y-5 animate-fade-slide-up",children:[s.jsx("p",{className:"text-sm text-gray-400 leading-relaxed text-center px-2",children:"   .         ."}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"reset-phone",className:"block text-xs font-bold text-gray-400 mr-1",children:" "}),s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-4 text-gray-500 group-focus-within:text-red-500 transition-colors z-10 pointer-events-none",children:s.jsx(zn,{className:"w-5 h-5"})}),s.jsx("input",{type:"tel",inputMode:"numeric",id:"reset-phone",value:t,onChange:_=>r(_.target.value.replace(/\D/g,"")),placeholder:"01xxxxxxxxx",className:"w-full bg-[#0f172a] border border-gray-600 rounded-xl py-4 pl-12 pr-4 text-white placeholder-gray-600 focus:border-red-500 focus:ring-1 focus:ring-red-500/50 outline-none transition-all text-right font-mono text-lg shadow-inner",required:!0,dir:"rtl",disabled:p})]})]}),h&&s.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-3 flex items-center justify-center animate-pulse",children:s.jsx("p",{className:"text-red-400 text-xs font-bold",children:h})}),s.jsx("button",{type:"submit",disabled:p,className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-red-900/20 active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed flex justify-center items-center",children:p?s.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):" "})]})})]})})},kte=({onPasswordLogin:n,onGoToSignUp:e,onPasswordResetRequest:t,appConfig:r})=>{const[i,o]=w.useState(""),[c,u]=w.useState(""),[h,m]=w.useState(""),[p,b]=w.useState(!1),[v,_]=w.useState(!1),[T,k]=w.useState(!1),E=r||{appName:"GOO NOW",appVersion:"VERSION 1.0.5"},S=E.appName.split(" "),L=S[0],$=S.slice(1).join(" ");w.useEffect(()=>{Pn.reportContext("login")},[]),sn(()=>p?(b(!1),!0):!1,[p]);const H=()=>{b(!0)},G=()=>{b(!1)},z=async P=>{if(P.preventDefault(),m(""),!i){m("   .");return}if(!c){m("   .");return}k(!0),await new Promise(O=>setTimeout(O,300));const j=await n(i,c);k(!1),j.success||m(j.message)};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-black h-dvh flex flex-col items-center justify-center p-6 pt-safe text-white relative overflow-hidden",dir:"rtl",style:{fontFamily:E!=null&&E.customFont?"'AppCustomFont', 'Cairo', sans-serif":void 0},children:[s.jsx("div",{className:"absolute top-[-20%] left-[-20%] w-[70%] h-[50%] bg-red-600/10 rounded-full blur-[120px] pointer-events-none animate-pulse-slow"}),s.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[60%] h-[50%] bg-blue-600/5 rounded-full blur-[100px] pointer-events-none"}),s.jsxs("div",{className:"w-full max-w-sm relative z-10 flex flex-col justify-center h-full max-h-[800px]",children:[s.jsxs("div",{className:"text-center mb-10 transform transition-all duration-700 animate-slide-down",children:[s.jsxs("div",{className:"inline-block relative",children:[s.jsxs("h1",{className:"text-5xl md:text-6xl font-black tracking-tighter mb-2 drop-shadow-2xl relative z-10",children:[s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-red-500 to-red-600",children:L}),$&&s.jsx("span",{className:"text-white ml-2",children:$})]}),s.jsx("div",{className:"absolute -bottom-2 left-1/2 -translate-x-1/2 w-1/2 h-1 bg-gradient-to-r from-transparent via-red-500 to-transparent opacity-50 rounded-full blur-[1px]"})]}),s.jsx("p",{className:"text-gray-400 text-sm font-medium tracking-widest uppercase opacity-80 mt-2",children:"   "})]}),s.jsxs("form",{onSubmit:z,className:"space-y-6 w-full animate-fade-slide-up",style:{animationDelay:"0.1s"},children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"identifier",className:"block text-xs font-bold text-gray-400 mr-1 transition-colors",children:" "}),s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-4 text-gray-500 group-focus-within:text-red-500 transition-colors z-10 pointer-events-none",children:s.jsx(zn,{className:"w-5 h-5"})}),s.jsx("input",{type:"tel",inputMode:"numeric",id:"identifier",value:i,onChange:P=>o(P.target.value.replace(/\D/g,"")),placeholder:"01xxxxxxxxx",className:"w-full bg-[#1e293b]/80 border border-gray-700 rounded-2xl py-4 pl-12 pr-5 text-white placeholder-gray-600 focus:border-red-500 focus:ring-1 focus:ring-red-500/50 focus:bg-[#1e293b] outline-none transition-all duration-300 shadow-sm text-right font-mono text-lg tracking-wide",required:!0,maxLength:11,dir:"rtl",disabled:T})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"password",className:"block text-xs font-bold text-gray-400 mr-1 transition-colors",children:" "}),s.jsxs("div",{className:"relative group",children:[s.jsx("button",{type:"button",onClick:()=>_(!v),className:"absolute top-1/2 -translate-y-1/2 left-0 p-4 text-gray-500 hover:text-white transition-colors z-20 outline-none",tabIndex:-1,children:v?s.jsx(Io,{className:"w-5 h-5"}):s.jsx(Yi,{className:"w-5 h-5"})}),s.jsx("input",{type:v?"text":"password",id:"password",value:c,onChange:P=>u(P.target.value),className:"w-full bg-[#1e293b]/80 border border-gray-700 rounded-2xl py-4 pl-12 pr-5 text-white placeholder-gray-600 focus:border-red-500 focus:ring-1 focus:ring-red-500/50 focus:bg-[#1e293b] outline-none transition-all duration-300 shadow-sm text-lg",required:!0,minLength:6,placeholder:"",disabled:T})]})]}),s.jsx("div",{className:"flex justify-end pt-1",children:s.jsx("button",{type:"button",onClick:H,className:"text-xs font-bold text-gray-400 hover:text-red-400 transition-colors focus:outline-none",children:"   "})}),h&&s.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-3 flex items-center justify-center gap-2 animate-pulse",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-red-500"}),s.jsx("p",{className:"text-red-400 text-xs font-bold",children:h})]}),s.jsx("button",{type:"submit",disabled:T,className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-bold py-4 rounded-2xl transition-all shadow-lg shadow-red-900/30 active:scale-[0.98] flex justify-center items-center text-lg mt-6 group relative overflow-hidden disabled:opacity-70 disabled:cursor-not-allowed",children:T?s.jsx("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"relative z-10",children:" "}),s.jsx("div",{className:"absolute inset-0 bg-white/10 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"})]})})]}),s.jsx("div",{className:"text-center mt-10 animate-fade-slide-up",style:{animationDelay:"0.2s"},children:s.jsxs("p",{className:"text-sm text-gray-500 font-medium",children:["  ",s.jsx("button",{onClick:e,className:"text-white font-bold hover:text-red-500 transition-colors mr-2 hover:underline decoration-red-500 underline-offset-4",children:"  "})]})})]}),s.jsx("div",{className:"absolute bottom-6 left-0 right-0 text-center opacity-40",children:s.jsx("p",{className:"text-[10px] text-gray-500 font-mono tracking-widest",children:E.appVersion})})]}),p&&s.jsx(Ate,{onClose:G,onRequestReset:t})]})},R_=[{id:"restaurant",label:"",icon:Si,color:"text-orange-500",bg:"bg-orange-500/10",border:"border-orange-500/20"},{id:"market",label:" ",icon:Rr,color:"text-green-500",bg:"bg-green-500/10",border:"border-green-500/20"},{id:"pharmacy",label:"",icon:hs,color:"text-blue-500",bg:"bg-blue-500/10",border:"border-blue-500/20"},{id:"bakery",label:"/",icon:ks,color:"text-yellow-500",bg:"bg-yellow-500/10",border:"border-yellow-500/20"},{id:"electronics",label:"",icon:Jl,color:"text-cyan-500",bg:"bg-cyan-500/10",border:"border-cyan-500/20"},{id:"fashion",label:"",icon:_Z,color:"text-purple-500",bg:"bg-purple-500/10",border:"border-purple-500/20"},{id:"logistics",label:" ",icon:Zt,color:"text-indigo-500",bg:"bg-indigo-500/10",border:"border-indigo-500/20"},{id:"other",label:"",icon:ks,color:"text-gray-400",bg:"bg-gray-800",border:"border-gray-700"}],gm=({icon:n,iconColor:e,colSpan:t="col-span-1",...r})=>s.jsxs("div",{className:`relative group ${t}`,children:[s.jsx("div",{className:`absolute top-1/2 -translate-y-1/2 left-3 transition-colors pointer-events-none z-10 ${e||"text-gray-500"} group-focus-within:text-white`,children:s.jsx(n,{className:"w-5 h-5"})}),s.jsx("input",{...r,className:`w-full bg-[#1F2937]/50 border border-gray-700 rounded-xl py-3.5 pl-10 pr-4 text-sm text-white placeholder-gray-500 focus:border-red-500 focus:ring-1 focus:ring-red-500 focus:bg-[#1F2937] outline-none transition-all duration-300 ${r.className||""}`})]}),Rte=({onSignUp:n,onBackToLogin:e})=>{const[t,r]=w.useState("role-selection"),[i,o]=w.useState(null),[c,u]=w.useState(""),[h,m]=w.useState(60),p=w.useRef(null);w.useEffect(()=>{Pn.reportContext("signup")},[]),w.useEffect(()=>{let xe;return t==="otp"&&h>0&&(xe=setInterval(()=>m(Pe=>Pe-1),1e3)),()=>clearInterval(xe)},[t,h]),sn(()=>ae?(X(!1),!0):t==="form"?(r("role-selection"),!0):(e(),!0),[t,e]);const[b,v]=w.useState(""),[_,T]=w.useState(""),[k,E]=w.useState(""),[S,L]=w.useState(""),[$,H]=w.useState("customer"),[G,z]=w.useState(""),[P,j]=w.useState(""),[O,I]=w.useState(null),[R,F]=w.useState("restaurant"),[M,ne]=w.useState(""),[U,A]=w.useState("09:00"),[V,Q]=w.useState("23:00"),[ae,X]=w.useState(!1),[B,Y]=w.useState(!1),[ge,Z]=w.useState(""),[te,me]=w.useState(!1),[re,ce]=w.useState(!1),[he,Oe]=w.useState(!1),[Ue,st]=w.useState(!1),[fe,K]=w.useState(null),ie=w.useRef(null),J=xe=>{H(xe),r("form"),Z("")},le=xe=>{var gt;const Pe=(gt=xe.target.files)==null?void 0:gt[0];if(Pe){const Ee=new FileReader;Ee.onload=()=>{K(Ee.result),st(!0)},Ee.readAsDataURL(Pe)}},ee=async xe=>{ce(!0);try{const Pe=new FileReader;Pe.readAsDataURL(xe),Pe.onloadend=()=>{const gt=Pe.result;I(gt),ce(!1)}}catch(Pe){console.error("Error processing cropped image:",Pe),ce(!1),Z("     .")}},we=async()=>{Z(""),me(!0);try{if(!p.current){const{setupRecaptcha:gt}=await Z1(async()=>{const{setupRecaptcha:Ee}=await Promise.resolve().then(()=>Y1);return{setupRecaptcha:Ee}},void 0,import.meta.url);p.current=gt("recaptcha-container")}const{signInWithPhone:xe}=await Z1(async()=>{const{signInWithPhone:gt}=await Promise.resolve().then(()=>Y1);return{signInWithPhone:gt}},void 0,import.meta.url),Pe=await xe(_,p.current);Pe.success?(o(Pe.confirmationResult),r("otp"),m(60)):(Z(Pe.error||"   ."),p.current&&(p.current.clear(),p.current=null))}catch(xe){console.error("SignUp Error:",xe);const Pe=xe.error||xe.message||JSON.stringify(xe);Z(`: ${Pe}`)}finally{me(!1)}},pe=async xe=>{if(Z(""),!c||c.length<6){Z("      6 .");return}me(!0);try{await i.confirm(c);const Pe={name:b,phone:_,password:k,role:$,storeImage:O,email:G||void 0,address:P||void 0};$==="merchant"&&(Pe.storeCategory=R==="other"?M.trim():R,Pe.storeName=b,Pe.workingHours={start:U,end:V});const gt=await n(Pe);gt.success?(Oe(!0),setTimeout(()=>e(),4e3)):Z(gt.message)}catch(Pe){console.error("OTP Error:",Pe),Z("      .")}finally{me(!1)}},ye=async xe=>{if(xe.preventDefault(),Z(""),!b||!_||!k||!S){Z("    .");return}if($!=="driver"&&!P.trim()){Z("  .");return}if(!O){Z($==="merchant"?"  .":"  .");return}if(!/^\d{11}$/.test(_)){Z("      11 .");return}if(k.length<6){Z("     6   .");return}if(k!==S){Z("   .");return}if($==="merchant"&&R==="other"){if(!M.trim()){Z("     .");return}M.trim()}me(!0),await we()},Ae=R_.find(xe=>xe.id===R)||R_[0];return t==="role-selection"?s.jsxs("div",{className:"h-dvh flex flex-col items-center justify-center p-6 pt-safe bg-black relative overflow-hidden",dir:"rtl",children:[s.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-red-600/10 rounded-full blur-[100px] pointer-events-none"}),s.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"}),s.jsxs("div",{className:"w-full max-w-sm space-y-8 relative z-10",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h1",{className:"text-3xl font-black text-white",children:"  "}),s.jsx("p",{className:"text-gray-400 text-sm",children:"   "})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("button",{onClick:()=>J("customer"),className:"w-full group bg-[#1e293b] hover:bg-[#253347] border border-gray-700/50 hover:border-cyan-500/50 p-4 rounded-2xl flex items-center justify-between transition-all duration-300 shadow-lg hover:shadow-cyan-900/20 active:scale-95",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-cyan-500/10 flex items-center justify-center group-hover:bg-cyan-500/20 transition-colors",children:s.jsx(_t,{className:"w-6 h-6 text-cyan-400"})}),s.jsxs("div",{className:"text-right",children:[s.jsx("h3",{className:"font-bold text-white text-lg group-hover:text-cyan-400 transition-colors",children:""}),s.jsx("p",{className:"text-xs text-gray-500",children:" "})]})]}),s.jsx(wi,{className:"w-5 h-5 text-gray-600 group-hover:text-cyan-400 rotate-180 transition-colors"})]}),s.jsxs("button",{onClick:()=>J("driver"),className:"w-full group bg-[#1e293b] hover:bg-[#253347] border border-gray-700/50 hover:border-red-500/50 p-4 rounded-2xl flex items-center justify-between transition-all duration-300 shadow-lg hover:shadow-red-900/20 active:scale-95",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-red-500/10 flex items-center justify-center group-hover:bg-red-500/20 transition-colors",children:s.jsx(Zt,{className:"w-6 h-6 text-red-500"})}),s.jsxs("div",{className:"text-right",children:[s.jsx("h3",{className:"font-bold text-white text-lg group-hover:text-red-500 transition-colors",children:" "}),s.jsx("p",{className:"text-xs text-gray-500",children:"  "})]})]}),s.jsx(wi,{className:"w-5 h-5 text-gray-600 group-hover:text-red-500 rotate-180 transition-colors"})]}),s.jsxs("button",{onClick:()=>J("merchant"),className:"w-full group bg-[#1e293b] hover:bg-[#253347] border border-gray-700/50 hover:border-purple-500/50 p-4 rounded-2xl flex items-center justify-between transition-all duration-300 shadow-lg hover:shadow-purple-900/20 active:scale-95",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-500/10 flex items-center justify-center group-hover:bg-purple-500/20 transition-colors",children:s.jsx(Xl,{className:"w-6 h-6 text-purple-400"})}),s.jsxs("div",{className:"text-right",children:[s.jsx("h3",{className:"font-bold text-white text-lg group-hover:text-purple-400 transition-colors",children:" / "}),s.jsx("p",{className:"text-xs text-gray-500",children:"  "})]})]}),s.jsx(wi,{className:"w-5 h-5 text-gray-600 group-hover:text-purple-400 rotate-180 transition-colors"})]})]}),s.jsx("div",{className:"text-center pt-6",children:s.jsxs("button",{onClick:e,className:"text-sm text-gray-500 hover:text-white transition-colors",children:["   ",s.jsx("span",{className:"text-red-500 font-bold hover:underline",children:" "})]})})]})]}):s.jsxs("div",{className:"h-dvh flex flex-col text-white relative bg-black overflow-hidden",dir:"rtl",children:[s.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[s.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-red-600/10 rounded-full blur-[100px]"}),s.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-blue-600/10 rounded-full blur-[100px]"})]}),Ue&&fe&&s.jsx(h0,{imageSrc:fe,onCropComplete:ee,onClose:()=>{st(!1),K(null),ie.current&&(ie.current.value="")},aspectRatio:1}),ae&&s.jsx("div",{className:"fixed inset-0 z-[60] flex items-end sm:items-center justify-center bg-black/80 backdrop-blur-sm animate-fadeIn p-0 sm:p-4",onClick:()=>X(!1),children:s.jsxs("div",{className:"bg-[#1e293b] w-full sm:max-w-lg rounded-t-3xl sm:rounded-3xl border-t sm:border border-gray-700 shadow-2xl overflow-hidden flex flex-col max-h-[80vh]",onClick:xe=>xe.stopPropagation(),children:[s.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center bg-[#0f172a]",children:[s.jsx("h3",{className:"text-lg font-bold text-white",children:"  "}),s.jsx("button",{onClick:()=>X(!1),className:"text-gray-400 hover:text-white p-1 rounded-full hover:bg-gray-800",children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"p-4 overflow-y-auto bg-[#0f172a]",children:s.jsx("div",{className:"grid grid-cols-2 gap-3",children:R_.map(xe=>s.jsxs("button",{type:"button",onClick:()=>{F(xe.id),X(!1)},className:`flex flex-col items-center justify-center p-3 rounded-xl border transition-all duration-200 ${R===xe.id?"bg-[#1e293b] border-red-500 shadow-lg shadow-red-900/20":"bg-[#1e293b]/50 border-gray-700 hover:bg-[#1e293b]"}`,children:[s.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center mb-2 ${R===xe.id?"bg-red-600 text-white":`${xe.bg} ${xe.color}`}`,children:s.jsx(xe.icon,{className:"w-5 h-5"})}),s.jsx("span",{className:`text-xs font-bold ${R===xe.id?"text-white":"text-gray-400"}`,children:xe.label})]},xe.id))})})]})}),he&&s.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/90 backdrop-blur-md animate-fadeIn p-4",children:s.jsxs("div",{className:"bg-[#1e293b] p-8 rounded-3xl shadow-2xl flex flex-col items-center text-center max-w-sm border border-gray-700 w-full transform transition-all scale-100",children:[s.jsx("div",{className:"w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mb-6 ring-2 ring-green-500/50 shadow-lg shadow-green-900/20 animate-bounce",children:s.jsx(Je,{className:"w-10 h-10 text-green-400"})}),s.jsx("h3",{className:"text-2xl font-black text-white mb-2",children:"   !"}),s.jsxs("div",{className:"space-y-3 mb-6 bg-yellow-500/10 p-4 rounded-xl border border-yellow-500/20",children:[s.jsxs("p",{className:"text-gray-300 text-sm font-medium",children:["  ",s.jsx("span",{className:"text-yellow-400 font-bold text-base",children:" "}),"   ."]}),s.jsx("p",{className:"text-gray-400 text-xs",children:"       .   ."})]}),s.jsx("div",{className:"w-full bg-gray-800 h-1.5 rounded-full overflow-hidden mb-2",children:s.jsx("div",{className:"h-full bg-green-500 rounded-full animate-progress",style:{animationDuration:"4s"}})}),s.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"   ..."})]})}),s.jsxs("div",{className:"px-5 pt-safe pb-2 flex-none relative",children:[s.jsx("button",{onClick:()=>r(t==="otp"?"form":"role-selection"),className:"absolute top-safe-offset right-5 p-1 bg-gray-800 rounded-full text-gray-400 hover:text-white transition-colors z-20",style:{top:"calc(var(--safe-area-top) + 1.25rem)"},children:s.jsx(wi,{className:"w-5 h-5"})}),s.jsx("div",{className:"text-center",children:s.jsxs("h1",{className:"text-2xl font-black text-white tracking-tight",children:[t==="otp"?" ":$==="driver"?" ":$==="merchant"?" ":" ",s.jsx("span",{className:"text-red-500",children:"."})]})})]}),s.jsx("div",{className:"flex-1 px-5 flex flex-col relative z-10 min-h-0 pt-2",children:t==="otp"?s.jsxs("div",{className:"flex-1 flex flex-col justify-center animate-fadeIn",children:[s.jsxs("div",{className:"text-center mb-8 space-y-3",children:[s.jsx("div",{className:"w-20 h-20 bg-emerald-500/10 rounded-full flex items-center justify-center mx-auto border border-emerald-500/20",children:s.jsx(zn,{className:"w-10 h-10 text-emerald-500"})}),s.jsx("h2",{className:"text-xl font-bold text-white",children:"  "}),s.jsxs("p",{className:"text-gray-400 text-sm leading-relaxed",children:["    6    ",s.jsx("br",{}),s.jsx("span",{className:"text-white font-mono dir-ltr",children:_})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-3 text-emerald-500",children:s.jsx(Je,{className:"w-5 h-5"})}),s.jsx("input",{type:"tel",value:c,onChange:xe=>u(xe.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"w-full bg-[#1F2937]/50 border border-gray-700 rounded-xl py-4 pl-10 pr-4 text-center text-2xl font-black text-white tracking-[0.5em] placeholder-gray-600 focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500 outline-none transition-all",maxLength:6})]}),ge&&s.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3 flex items-center justify-center",children:s.jsx("p",{className:"text-red-400 text-xs font-bold",children:ge})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("button",{onClick:()=>pe(),disabled:te||c.length<6,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-4 rounded-xl transition-all shadow-lg shadow-emerald-900/20 active:scale-95 disabled:opacity-50 flex items-center justify-center text-lg",children:te?s.jsx("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"}):" "}),s.jsx("div",{className:"text-center",children:h>0?s.jsxs("p",{className:"text-xs text-gray-500",children:["    ",s.jsx("span",{className:"text-emerald-500 font-bold",children:h})," "]}):s.jsx("button",{type:"button",onClick:we,className:"text-xs text-emerald-500 font-bold hover:underline",children:"   "})})]})]})]}):s.jsx("form",{onSubmit:ye,className:"flex-1 flex flex-col h-full",children:s.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-hide",children:[s.jsxs("div",{className:"flex justify-center mb-6 mt-4",children:[$==="merchant"?s.jsxs("div",{onClick:()=>{var xe;return!re&&((xe=ie.current)==null?void 0:xe.click())},className:`relative w-full h-36 rounded-2xl border border-dashed cursor-pointer overflow-hidden group flex items-center justify-center shadow-lg transition-all ${O?"border-transparent":"border-gray-600 bg-[#1e293b] hover:border-red-500"}`,children:[re&&s.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:s.jsxs("div",{className:"grid place-items-center",children:[s.jsx("div",{className:"col-start-1 row-start-1 w-20 h-20 border-4 border-blue-400/30 rounded-full animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"}),s.jsx("div",{className:"col-start-1 row-start-1 w-12 h-12 bg-blue-500 rounded-full opacity-75 animate-ping"}),s.jsx("div",{className:"col-start-1 row-start-1 w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center z-10 shadow-lg shadow-blue-500/50",children:s.jsx(Zr,{className:"w-6 h-6 text-white animate-bounce"})})]})}),O?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:O,alt:"Store",className:"w-full h-full object-cover opacity-70"}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30",children:s.jsx(qi,{className:"w-8 h-8 text-white p-1.5 bg-black/50 rounded-full"})})]}):s.jsxs("div",{className:"flex flex-col items-center text-gray-400 group-hover:text-white transition-colors",children:[s.jsx(qi,{className:"w-8 h-8 mb-2"}),s.jsx("span",{className:"text-xs font-bold",children:"  "})]})]}):s.jsxs("div",{onClick:()=>{var xe;return!re&&((xe=ie.current)==null?void 0:xe.click())},className:`w-28 h-28 rounded-full border-2 border-dashed flex items-center justify-center cursor-pointer overflow-hidden relative shadow-lg group hover:border-red-500 transition-all ${O?"border-red-500":"border-gray-600 bg-[#1e293b]"}`,children:[re&&s.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:s.jsxs("div",{className:"grid place-items-center",children:[s.jsx("div",{className:"col-start-1 row-start-1 w-14 h-14 border-4 border-blue-400/30 rounded-full animate-[ping_2s_cubic-bezier(0,0,0.2,1)_infinite]"}),s.jsx("div",{className:"col-start-1 row-start-1 w-8 h-8 bg-blue-500 rounded-full opacity-75 animate-ping"}),s.jsx("div",{className:"col-start-1 row-start-1 w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center z-10 shadow-lg shadow-blue-500/50",children:s.jsx(Zr,{className:"w-4 h-4 text-white animate-bounce"})})]})}),O?s.jsx("img",{src:O,className:"w-full h-full object-cover"}):s.jsxs("div",{className:"flex flex-col items-center text-gray-400 group-hover:text-white",children:[s.jsx(qi,{className:"w-8 h-8 mb-1"}),s.jsx("span",{className:"text-[10px]",children:" "})]}),s.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx(qi,{className:"w-6 h-6 text-white"})})]}),s.jsx("input",{ref:ie,type:"file",accept:"image/*",className:"hidden",onChange:le})]}),s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsx(gm,{icon:_t,iconColor:"text-cyan-500",type:"text",value:b,onChange:xe=>v(xe.target.value),placeholder:$==="merchant"?" ":" "}),s.jsx(gm,{icon:zn,iconColor:"text-emerald-500",type:"tel",value:_,onChange:xe=>T(xe.target.value),placeholder:"  (11 )",maxLength:11,className:"text-right placeholder:text-right",dir:"rtl"}),$!=="driver"&&s.jsxs(s.Fragment,{children:[s.jsx(gm,{icon:fs,iconColor:"text-rose-500",type:"text",value:P,onChange:xe=>j(xe.target.value),placeholder:" "}),s.jsx(gm,{icon:J1,iconColor:"text-purple-500",type:"email",value:G,onChange:xe=>z(xe.target.value),placeholder:"  ()"})]}),$==="driver"&&s.jsx(gm,{icon:J1,iconColor:"text-purple-500",type:"email",value:G,onChange:xe=>z(xe.target.value),placeholder:"  ()"}),$==="merchant"&&s.jsxs("div",{className:"flex flex-col gap-3 bg-[#1e293b]/50 p-3 rounded-xl border border-gray-700/50",children:[s.jsxs("button",{type:"button",onClick:()=>X(!0),className:"bg-[#0f172a] border border-gray-700 rounded-xl py-3.5 px-4 text-white flex justify-between items-center text-sm hover:border-gray-500 transition-colors w-full",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ae.icon,{className:`w-4 h-4 ${Ae.color}`}),s.jsx("span",{children:Ae.label})]}),s.jsx(Iy,{className:"w-4 h-4 text-gray-500"})]}),R==="other"&&s.jsx("input",{type:"text",value:M,onChange:xe=>ne(xe.target.value),placeholder:"  ...",className:"bg-[#0f172a] border border-gray-700 rounded-xl py-3 px-4 text-sm text-white outline-none focus:border-red-500 w-full"}),s.jsxs("div",{className:"flex items-center gap-2 bg-[#0f172a] border border-gray-700 rounded-xl px-3 py-2",children:[s.jsx(It,{className:"w-4 h-4 text-orange-500 flex-shrink-0"}),s.jsx("span",{className:"text-xs text-gray-400",children:" :"}),s.jsx("input",{type:"time",value:U,onChange:xe=>A(xe.target.value),className:"bg-transparent text-white text-xs flex-1 text-center outline-none"}),s.jsx("span",{className:"text-gray-500",children:"-"}),s.jsx("input",{type:"time",value:V,onChange:xe=>Q(xe.target.value),className:"bg-transparent text-white text-xs flex-1 text-center outline-none"})]})]}),s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-3 z-20 text-gray-500",children:s.jsx("button",{type:"button",onClick:()=>Y(!B),children:B?s.jsx(Io,{className:"w-5 h-5"}):s.jsx(Yi,{className:"w-5 h-5"})})}),s.jsx("input",{type:B?"text":"password",value:k,onChange:xe=>E(xe.target.value),placeholder:"  (6   )",className:"w-full bg-[#1F2937]/50 border border-gray-700 rounded-xl py-3.5 pl-4 pr-4 text-sm text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all"})]}),s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-3 z-20 text-gray-500",children:s.jsx("button",{type:"button",onClick:()=>Y(!B),children:B?s.jsx(Io,{className:"w-5 h-5"}):s.jsx(Yi,{className:"w-5 h-5"})})}),s.jsx("input",{type:B?"text":"password",value:S,onChange:xe=>L(xe.target.value),placeholder:"  ",className:"w-full bg-[#1F2937]/50 border border-gray-700 rounded-xl py-3.5 pl-4 pr-4 text-sm text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition-all"})]}),ge&&s.jsx("div",{className:"mt-2 text-center",children:s.jsx("p",{className:"text-red-500 text-xs font-bold",children:ge})})]}),s.jsxs("div",{className:"pt-8 pb-10",children:[s.jsx("button",{type:"submit",disabled:te,className:"w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3.5 rounded-xl transition-all shadow-lg active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center text-base",children:te?s.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):" "}),s.jsx("div",{className:"text-center mt-4",children:s.jsxs("button",{type:"button",onClick:e,className:"text-xs text-gray-500 hover:text-white transition-colors",children:["   ",s.jsx("span",{className:"text-red-500 font-bold hover:underline",children:" "})]})})]})]})})}),s.jsx("div",{id:"recaptcha-container"})]})},Dte=({message:n,type:e,onClose:t})=>{const r=w.useRef(t);w.useEffect(()=>{r.current=t},[t]),w.useEffect(()=>{const c=setTimeout(()=>{r.current()},4e3);return()=>clearTimeout(c)},[]);const o=(()=>{const c=(n==null?void 0:n.toLowerCase())||"";return c.includes(" ")||c.includes("new order")||c.includes("")?{icon:s.jsx(Rr,{className:"h-5 w-5 text-amber-900"}),bgClass:"bg-gradient-to-r from-amber-200 via-yellow-400 to-amber-500",textClass:"text-amber-950",borderClass:"border-amber-300/50",shadowClass:"shadow-[0_8px_30px_rgb(251,191,36,0.4)]",glowClass:"bg-yellow-400",title:" "}:c.includes(" ")||c.includes("preparing")?{icon:s.jsx(Si,{className:"h-5 w-5 text-indigo-100"}),bgClass:"bg-gradient-to-r from-indigo-500 via-purple-500 to-purple-600",textClass:"text-white",borderClass:"border-indigo-400/50",shadowClass:"shadow-[0_8px_30px_rgb(99,102,241,0.4)]",glowClass:"bg-indigo-400",title:" "}:c.includes("")||c.includes("admin")||c.includes("")?{icon:s.jsx(Ni,{className:"h-5 w-5 text-rose-100"}),bgClass:"bg-gradient-to-r from-rose-500 via-red-500 to-red-600",textClass:"text-white",borderClass:"border-rose-400/50",shadowClass:"shadow-[0_8px_30px_rgb(244,63,94,0.4)]",glowClass:"bg-rose-400",title:" "}:c.includes("")||c.includes("")||c.includes("transit")?{icon:s.jsx(Zt,{className:"h-5 w-5 text-cyan-900"}),bgClass:"bg-gradient-to-r from-cyan-300 via-sky-400 to-blue-500",textClass:"text-cyan-950",borderClass:"border-cyan-300/50",shadowClass:"shadow-[0_8px_30px_rgb(34,211,238,0.4)]",glowClass:"bg-cyan-400",title:" "}:e==="success"?{icon:s.jsx(Je,{className:"h-5 w-5 text-emerald-900"}),bgClass:"bg-gradient-to-r from-emerald-300 via-green-400 to-green-500",textClass:"text-emerald-950",borderClass:"border-emerald-300/50",shadowClass:"shadow-[0_8px_30px_rgb(52,211,153,0.4)]",glowClass:"bg-emerald-400",title:" "}:e==="error"?{icon:s.jsx(ut,{className:"h-5 w-5 text-white"}),bgClass:"bg-gradient-to-r from-red-500 to-red-700",textClass:"text-white",borderClass:"border-red-400/50",shadowClass:"shadow-[0_8px_30px_rgb(239,68,68,0.4)]",glowClass:"bg-red-500",title:""}:{icon:s.jsx(zs,{className:"h-5 w-5 text-white"}),bgClass:"bg-[#1a1a1a]/90 backdrop-blur-xl",textClass:"text-white",borderClass:"border-white/10",shadowClass:"shadow-2xl",glowClass:"bg-white",title:""}})();return s.jsxs("div",{dir:"rtl",className:"fixed top-6 left-0 right-0 mx-auto z-[9999] w-fit max-w-[92%] min-w-[320px] sm:min-w-[350px] animate-fadeInDown",children:[s.jsx("style",{children:`
                @keyframes fadeInDown {
                    from { opacity: 0; transform: translateY(-20px); }
                    to { opacity: 1; transform: translateY(0); }
                }
                .animate-fadeInDown {
                    animation: fadeInDown 0.3s ease-out forwards;
                }
            `}),s.jsxs("div",{className:`
                relative flex items-center justify-between gap-4 p-1.5 pr-2 rounded-full 
                ${o.bgClass} ${o.borderClass} border ${o.shadowClass}
                shadow-2xl cursor-pointer
            `,onClick:t,children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[s.jsx("div",{className:"relative flex-shrink-0",children:s.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center bg-white/20 backdrop-blur-sm shadow-inner",children:o.icon})}),s.jsxs("div",{className:`flex flex-col ${o.textClass}`,children:[s.jsx("span",{className:"text-[10px] font-black uppercase tracking-wider opacity-80 leading-none mb-0.5",children:o.title}),s.jsx("span",{className:"text-sm font-bold leading-tight line-clamp-2",children:n})]})]}),s.jsx("button",{onClick:c=>{c.stopPropagation(),t()},className:`
                        w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0
                        bg-black/10 hover:bg-black/20 transition-colors backdrop-blur-sm
                        ${o.textClass}
                    `,children:s.jsx(ut,{className:"h-4 w-4"})})]}),s.jsx("div",{className:"absolute bottom-1 left-4 right-4 h-0.5 bg-white/20 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-white/80 animate-progress origin-left",style:{animationDuration:"4s"}})}),s.jsx("style",{children:`
                @keyframes progress {
                    from { transform: scaleX(1); }
                    to { transform: scaleX(0); }
                }
                .animate-progress {
                    animation: progress linear forwards;
                }
            `})]})},Pte=({onEnable:n,onDismiss:e})=>s.jsxs("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:w-96 z-[9999] animate-slide-up",children:[s.jsxs("div",{className:"bg-gray-900/95 backdrop-blur-xl border border-gray-700 rounded-2xl p-4 shadow-2xl flex flex-col gap-3",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-600/20 flex items-center justify-center flex-shrink-0",children:s.jsx(zs,{className:"w-5 h-5 text-blue-500"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-white font-bold text-sm mb-1",children:" "}),s.jsx("p",{className:"text-gray-400 text-xs leading-relaxed",children:"            ."})]}),s.jsx("button",{onClick:e,className:"text-gray-500 hover:text-white transition-colors",children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex gap-2 mr-12",children:[s.jsx("button",{onClick:n,className:"bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg text-xs font-bold transition-colors flex-1",children:" "}),s.jsx("button",{onClick:e,className:"bg-gray-800 hover:bg-gray-700 text-gray-300 px-4 py-2 rounded-lg text-xs font-bold transition-colors flex-1",children:" "})]})]}),s.jsx("style",{children:`
                @keyframes slideUp {
                    from { transform: translateY(100px); opacity: 0; }
                    to { transform: translateY(0); opacity: 1; }
                }
                .animate-slide-up {
                    animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
                }
            `})]}),Ote=()=>{w.useEffect(()=>{const e=setInterval(()=>{navigator.onLine&&(clearInterval(e),window.AndroidSplash&&window.AndroidSplash.showSplash&&window.AndroidSplash.showSplash(),setTimeout(()=>{window.location.reload()},500))},2e3),t=()=>{window.AndroidSplash&&window.AndroidSplash.showSplash&&window.AndroidSplash.showSplash(),setTimeout(()=>{window.location.reload()},300)};return window.addEventListener("online",t),()=>{clearInterval(e),window.removeEventListener("online",t)}},[]);const n=()=>{navigator.onLine&&(window.AndroidSplash&&window.AndroidSplash.showSplash&&window.AndroidSplash.showSplash(),window.location.reload())};return s.jsxs("div",{dir:"rtl",className:"fixed inset-0 z-[9999] bg-[#0f172a] flex flex-col items-center justify-center p-6 pt-safe text-white overflow-hidden font-sans",children:[s.jsx("style",{children:`
        @keyframes ripple {
          0% { transform: scale(0.8); opacity: 1; }
          100% { transform: scale(2.4); opacity: 0; }
        }
        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .ripple-container {
            position: relative;
            width: 140px;
            height: 140px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .ripple-circle {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 2px solid rgba(239, 68, 68, 0.5); /* Red-500 */
            animation: ripple 2s infinite cubic-bezier(0, 0.2, 0.8, 1);
        }
        .ripple-circle:nth-child(2) { animation-delay: -0.5s; }
        .ripple-circle:nth-child(3) { animation-delay: -1s; }
        
        .wifi-icon-container {
            animation: floating 3s ease-in-out infinite;
        }
      `}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-[#0f172a] via-[#1e293b] to-[#0f172a] pointer-events-none"}),s.jsx("div",{className:"absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] pointer-events-none"}),s.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center max-w-sm w-full",children:[s.jsxs("div",{className:"mb-10 ripple-container",children:[s.jsx("div",{className:"ripple-circle"}),s.jsx("div",{className:"ripple-circle"}),s.jsx("div",{className:"ripple-circle"}),s.jsx("div",{className:"w-24 h-24 bg-[#1e293b] rounded-full flex items-center justify-center border-4 border-[#334155] shadow-2xl z-10 wifi-icon-container",children:s.jsx(wZ,{className:"w-12 h-12 text-red-500 drop-shadow-[0_0_10px_rgba(239,68,68,0.5)]"})})]}),s.jsx("h1",{className:"text-4xl font-black mb-2 tracking-tight text-white drop-shadow-lg",children:" "}),s.jsx("p",{className:"text-red-400 font-bold text-lg mb-6 uppercase tracking-widest opacity-90",children:"No Internet Connection"}),s.jsx("p",{className:"text-gray-400 text-sm leading-relaxed mb-10 max-w-[280px] mx-auto border-t border-gray-700/50 pt-6",children:"  .         .       ."}),s.jsxs("button",{onClick:n,className:"group relative w-full overflow-hidden rounded-2xl bg-red-600 p-[2px] focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-2 focus:ring-offset-slate-900",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600 via-orange-500 to-red-600 opacity-100 transition-opacity duration-500 group-hover:opacity-100"}),s.jsxs("div",{className:"relative flex items-center justify-center gap-3 rounded-2xl bg-[#0f172a] px-8 py-4 transition-all duration-200 group-hover:bg-transparent group-hover:text-white",children:[s.jsx(Ml,{className:`w-5 h-5 ${navigator.onLine?"animate-spin":""} text-red-500 group-hover:text-white transition-colors`}),s.jsx("span",{className:"font-bold text-lg text-white",children:" "})]})]}),s.jsxs("div",{className:"mt-12 flex flex-col items-center gap-2 opacity-30 hover:opacity-100 transition-opacity duration-500",children:[s.jsx("div",{className:"h-1 w-12 bg-gray-500 rounded-full mb-2"}),s.jsx("p",{className:"text-[10px] uppercase font-mono tracking-[0.2em] text-gray-500",children:"System Offline Mode"})]})]})]})},N4=({config:n,onDismiss:e})=>{const[t,r]=w.useState(!1),[i,o]=w.useState(0),[c,u]=w.useState(""),[h,m]=w.useState(!1),[p,b]=w.useState([]),v=k=>{b(E=>[...E.slice(-4),k]),console.log(`[UpdateScreen] ${k}`)},_=async()=>{if(!n.url){v("Error: No URL provided"),u(":   ");return}r(!0),o(0),v("Starting update process...");try{let k=n.url;if(n.url.startsWith("FIRESTORE_FILE:")){u("   ..."),v("Fetching firestore chunks...");const $=n.url.split(":")[1];k=await Ty($),o(30),u(" !  ..."),v("Firestore file assembled.")}const E=window.Android,S=typeof E<"u"&&typeof E.downloadAndInstallApk=="function",L=n.type==="apk"||n.url.endsWith(".apk")||n.url.includes(".apk");if(S&&L){v("Using Native Android Installer"),u("  ...");const $=setInterval(()=>{o(G=>G>=90?(clearInterval($),90):G+10)},400),H=`GOO_NOW_v${n.version}.apk`;setTimeout(()=>{try{v(`Invoking native: ${H}`),E.downloadAndInstallApk(k,H),clearInterval($),o(100),u("   !"),v("Native intent sent.")}catch(G){v(`Native Error: ${G}`),console.error("Native Install Error",G),T(k,H)}},500)}else v("Native bridge missing or not APK. Using Browser."),T(k,`GOO_NOW_v${n.version}.apk`);setTimeout(()=>{S||r(!1)},5e3)}catch(k){v(`Update Failed: ${k}`),console.error("Update failed:",k),u("  "),setTimeout(()=>r(!1),2e3)}},T=(k,E)=>{u("   ...");const S=document.createElement("a");S.href=k,S.target="_blank",S.download=E,document.body.appendChild(S),S.click(),document.body.removeChild(S),o(100),u("   !")};return s.jsxs("div",{className:"fixed inset-0 z-[200] bg-[#0f172a] flex flex-col items-center justify-center p-6 animate-fadeIn font-sans text-white overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-blue-600/10 rounded-full blur-[120px] pointer-events-none -translate-y-1/2 translate-x-1/2"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-[500px] h-[500px] bg-purple-600/10 rounded-full blur-[120px] pointer-events-none translate-y-1/2 -translate-x-1/2"}),s.jsxs("div",{className:"relative z-10 w-full max-w-sm text-center",children:[s.jsxs("div",{className:"relative mb-8 flex justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-blue-500 rounded-full blur-2xl opacity-20 animate-pulse"}),s.jsxs("div",{className:"w-24 h-24 bg-[#1e293b] rounded-[1.5rem] flex items-center justify-center border-4 border-gray-700 shadow-2xl relative z-10 animate-bounce-slow overflow-hidden",children:[h?s.jsx("div",{className:"flex flex-col items-center justify-center bg-gradient-to-br from-blue-900 to-slate-900 w-full h-full",children:s.jsx(en,{className:"w-10 h-10 text-blue-400 mb-1"})}):s.jsx("img",{src:"file:///android_asset/app-icon.png",alt:"GOO NOW",className:"w-full h-full object-cover",onError:k=>{const E=k.target;E.src.includes("file:///android_asset")?E.src="/app-icon.png":m(!0)}}),s.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 w-6 h-6 rounded-full flex items-center justify-center border-2 border-[#0f172a] animate-ping"}),s.jsx("div",{className:"absolute -top-1 -right-1 bg-red-600 w-6 h-6 rounded-full flex items-center justify-center border-2 border-[#0f172a] text-[10px] font-bold shadow-lg",children:"!"})]})]}),s.jsxs("div",{className:"bg-[#1e293b]/90 backdrop-blur-xl border border-white/10 rounded-2xl p-6 shadow-2xl animate-slide-up",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 bg-blue-500/10 border border-blue-500/20 px-3 py-1 rounded-full mb-4",children:[s.jsx(Mte,{className:"w-3 h-3 text-blue-400 animate-spin-slow"}),s.jsx("span",{className:"text-[10px] font-bold text-blue-300 tracking-wider uppercase",children:"Update Available"})]}),s.jsxs("h2",{className:"text-2xl font-black mb-2 text-white",children:[" ",n.version]}),s.jsx("p",{className:"text-gray-400 text-xs leading-relaxed mb-6",children:n.notes||"         ."}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:_,disabled:t,className:`group relative w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-6 rounded-xl shadow-lg shadow-blue-600/20 active:scale-95 transition-all overflow-hidden ${t?"cursor-wait opacity-80":""}`,children:[s.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),s.jsx("div",{className:"relative flex flex-col items-center justify-center gap-1",children:t?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"w-full flex items-center justify-between text-xs mb-1 px-1",children:[s.jsx("span",{className:"text-blue-100 opacity-80",children:c}),s.jsxs("span",{className:"font-bold",children:[i,"%"]})]}),s.jsx("div",{className:"w-full bg-black/20 rounded-full h-1.5 overflow-hidden",children:s.jsx("div",{className:"bg-white h-full rounded-full transition-all duration-300 ease-out",style:{width:`${i}%`}})})]}):s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx(TZ,{className:"w-5 h-5"}),s.jsx("span",{className:"text-sm",children:" "})]})})]}),!t&&s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:e,className:"flex-1 bg-transparent hover:bg-white/5 text-gray-500 hover:text-gray-300 font-medium py-3 rounded-xl transition-colors text-xs border border-white/5",children:" "}),s.jsx("a",{href:n.url,target:"_blank",className:"px-4 py-3 bg-white/5 hover:bg-white/10 text-gray-400 hover:text-white rounded-xl transition-colors border border-white/5 flex items-center justify-center",title:"  (  )",download:!0,children:s.jsx(hb,{className:"w-4 h-4"})})]})]})]}),p.length>0&&s.jsx("div",{className:"mt-4 p-2 bg-black/50 rounded text-[10px] text-left font-mono text-gray-400 w-full overflow-hidden",children:p.map((k,E)=>s.jsx("div",{children:k},E))}),s.jsx("div",{className:"mt-8 text-xs text-gray-600 font-mono",children:"GOO NOW UPDATE CENTER"})]})]})},Mte=({className:n})=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:s.jsx("path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"})}),Lte=({message:n,onLogout:e})=>s.jsxs("div",{dir:"rtl",className:"fixed inset-0 z-[100] bg-[#0f172a] flex flex-col items-center justify-center p-6 pt-safe text-white overflow-hidden font-sans",children:[s.jsx("style",{children:`
        @keyframes pulse-ring {
          0% { transform: scale(0.33); }
          80%, 100% { opacity: 0; }
        }
        @keyframes circle-anim {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
        .ring-container {
            position: relative;
        }
        .ring-container::before {
            content: '';
            position: absolute;
            left: 0; top: 0;
            width: 100%; height: 100%;
            background-color: rgba(239, 68, 68, 0.3);
            border-radius: 50%;
            z-index: -1;
            animation: pulse-ring 2s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
        }
        .loader-ring {
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-left-color: #ef4444;
            border-radius: 50%;
            width: 120px;
            height: 120px;
            animation: circle-anim 1.2s linear infinite;
        }
      `}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-[#0f172a] to-[#1e293b] pointer-events-none"}),s.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-red-500 to-transparent opacity-50"}),s.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center max-w-lg w-full",children:[s.jsxs("div",{className:"relative mb-10 ring-container flex justify-center items-center",children:[s.jsx("div",{className:"loader-ring absolute"}),s.jsx("div",{className:"w-24 h-24 bg-[#1e293b] rounded-full flex items-center justify-center border border-gray-700 shadow-2xl",children:s.jsx(vZ,{className:"w-12 h-12 text-red-500"})}),s.jsxs("div",{className:"absolute -bottom-4 bg-[#0f172a] border border-red-500/30 px-4 py-1 rounded-full flex items-center space-x-2 space-x-reverse shadow-lg",children:[s.jsxs("span",{className:"relative flex h-2.5 w-2.5",children:[s.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),s.jsx("span",{className:"relative inline-flex rounded-full h-2.5 w-2.5 bg-red-500"})]}),s.jsx("span",{className:"text-xs font-mono text-red-200 font-bold tracking-wider",children:"OFFLINE"})]})]}),s.jsxs("h1",{className:"text-4xl font-black mb-4 tracking-tight",children:[s.jsx("span",{className:"text-red-500",children:"GOO"}),s.jsx("span",{className:"text-white",children:" NOW"})]}),s.jsxs("div",{className:"bg-[#1e293b]/80 backdrop-blur-md border border-gray-700/50 p-8 rounded-2xl shadow-2xl w-full transform transition-all hover:border-red-500/20",children:[s.jsx("h2",{className:"text-2xl font-bold text-white mb-3",children:"   "}),s.jsxs("p",{className:"text-gray-400 text-base leading-relaxed mb-6",children:[n||"            .",s.jsx("br",{}),s.jsx("span",{className:"text-red-400 font-medium block mt-2",children:"     ."})]}),e&&s.jsx("button",{onClick:e,className:"w-full py-3 mb-6 bg-gray-800 hover:bg-gray-700 text-white rounded-xl font-bold transition-all border border-gray-700 active:scale-95 text-sm",children:" "}),s.jsxs("div",{className:"bg-black/40 rounded-lg p-4 text-right font-mono text-xs text-gray-500 space-y-2 border border-white/5",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"CONNECTION:"}),s.jsx("span",{className:"text-red-500",children:"PAUSED"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"DATABASE:"}),s.jsx("span",{className:"text-yellow-500",children:"SYNC_PENDING..."})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"RETRY:"}),s.jsx("span",{className:"text-blue-400 animate-pulse",children:"AUTO (LISTENING)"})]})]})]}),s.jsxs("div",{className:"mt-8 flex items-center text-gray-500 text-sm",children:[s.jsx(pO,{className:"w-4 h-4 ml-2 animate-pulse"}),s.jsx("span",{children:"   "})]})]})]}),UO={apiKey:"AIzaSyCzclhrtHAI4lNfqHaKJ6wh-Qr-skoPaZQ",authDomain:"goo-now3.firebaseapp.com",databaseURL:"https://goo-now3-default-rtdb.firebaseio.com",projectId:"goo-now3",storageBucket:"goo-now3.firebasestorage.app",messagingSenderId:"966566737002",appId:"1:966566737002:android:7ef09d74e85403d3154613"},Vte=()=>{try{const n=localStorage.getItem("firebase_config");if(n){const e=JSON.parse(n);if(e&&e.apiKey&&e.projectId)return e}}catch(n){console.warn("Failed to load custom firebase config, using default.",n)}return UO};typeof document<"u"&&document.addEventListener("visibilitychange",()=>{if(document.visibilityState==="visible"){const n=new Date().toISOString();console.log(`[InstantSync] App Resumed at ${n} - Forcing Sync...`)}});cO(Vte());const Fte=n=>{const[e,t]=w.useState([]),[r,i]=w.useState([]),[o,c]=w.useState([]),[u,h]=w.useState([]),[m,p]=w.useState([]),[b,v]=w.useState([]),[_,T]=w.useState([]),[k,E]=w.useState([]),[S,L]=w.useState({isEnabled:!0}),[$,H]=w.useState({}),[G,z]=w.useState({pointsPerCurrency:1,currencyPerPoint:.1,isPointsEnabled:!0}),[P,j]=w.useState(()=>Ui.get("app_config_cache",{appName:"GOO NOW",appVersion:`VERSION ${Gm}`})),[O,I]=w.useState(null),[R,F]=w.useState(!1),[M,ne]=w.useState(!0),U=w.useRef(0),[A,V]=w.useState(()=>Ui.get("currentUser",null)),[Q,ae]=w.useState(()=>Ui.get("app_theme",{driver:{icons:{}},merchant:{icons:{}},admin:{mode:"dark"},customer:{icons:{},mode:"dark"}})),[X,B]=w.useState(!1);w.useEffect(()=>{(async()=>{const[te,me,re,ce]=await Promise.all([Ls.get("cache_users",[]),Ls.get("cache_orders",[]),Ls.get("cache_messages",[]),Ls.get("cache_slider",[])]);if(te.length&&t(te),me.length){const he=Ui.get("currentUser",null),Oe=he==null?void 0:he.role;Oe==="admin"||Oe==="supervisor"?(i(me),B(!0)):console.log("[Cache] Skipping stale orders cache for non-admin role to prevent zombie data.")}re.length&&c(re),ce.length&&h(ce),te.length>0&&ne(!1)})()},[]),w.useEffect(()=>{const Z="custom-app-font";let te=document.getElementById(Z);P.customFont?(te||(te=document.createElement("style"),te.id=Z,document.head.appendChild(te)),te.innerHTML=`
                @font-face {
                    font-family: 'AppCustomFont';
                    src: url('${P.customFont}') format('truetype');
                    font-weight: normal;
                    font-style: normal;
                }
                :root, body, html, * {
                    font-family: 'AppCustomFont', 'Cairo', sans-serif !important;
                }
                input, textarea, select, button, h1, h2, h3, h4, h5, h6, span, p, div, a {
                    font-family: 'AppCustomFont', 'Cairo', sans-serif !important;
                }
            `):te&&te.remove()},[P.customFont]),w.useEffect(()=>{const Z=Ir("users",fe=>{if(t(fe),Ls.set("cache_users",fe),ne(!1),A){const K=fe.find(ie=>ie.id===A.id);if(K&&K.status==="blocked"){V(null),Ui.remove("currentUser"),Fc(),n("      .     .","error");return}if(K&&K.status==="suspended"){V(K),Ui.set("currentUser",kr(K)),i([]),t([]),c([]);return}K&&fb(K)!==fb(A)&&(V(K),Ui.set("currentUser",kr(K)))}});if((A==null?void 0:A.status)==="suspended")return i([]),c([]),v([]),h([]),T([]),Ls.set("cache_orders",[]),Ls.set("cache_messages",[]),Ls.set("cache_slider",[]),()=>{Z()};let te=()=>{};if(!A)te=yl("orders",[],fe=>{i(fe),Ls.set("cache_orders",fe),B(!0)},{orderBy:{field:"createdAt",direction:"desc"},limit:500});else if(A.role==="admin"||A.role==="supervisor")te=yl("orders",[],fe=>{i(fe),Ls.set("cache_orders",fe),B(!0)},{orderBy:{field:"createdAt",direction:"desc"},limit:500});else if(A.role==="merchant")U.current===0&&(i([]),Ls.set("cache_orders",[])),te=yl("orders",[{field:"merchantId",op:"==",value:A.id}],fe=>{i(fe),Ls.set("cache_orders",fe),B(!0)});else if(A.role==="customer")te=yl("orders",[{field:"customer.phone",op:"==",value:A.phone}],fe=>{i(fe),Ls.set("cache_orders",fe),B(!0)});else if(A.role==="driver"){i([]),Ls.set("cache_orders",[]);const fe=new Map,K=new Map,ie=()=>{const ee=[...Array.from(fe.values()),...Array.from(K.values())];let we=Array.from(new Map(ee.map(pe=>[pe.id,pe])).values());Y.current.forEach((pe,ye)=>{pe.fallbackOrder&&!we.find(Ae=>Ae.id===ye)&&we.push({...pe.fallbackOrder,...pe.updates})}),we=we.map(pe=>{const ye=Y.current.get(pe.id);if(ye){if(Date.now()-ye.timestamp<5e3)return{...pe,...ye.updates};Y.current.delete(pe.id)}return pe}),i(we),Ls.set("cache_orders",we),B(!0),we.length>U.current&&U.current!==0&&console.log("[InstantSync]  New Order Detected!"),U.current=we.length},J=yl("orders",[{field:"status",op:"==",value:ue.Pending}],ee=>{fe.clear(),ee.forEach(we=>fe.set(we.id,we)),ie()}),le=yl("orders",[{field:"driverId",op:"==",value:A.id}],ee=>{K.clear(),ee.forEach(we=>K.set(we.id,we)),ie()});te=()=>{J(),le()}}else i([]),B(!0);let me=()=>{};if(A){const fe=[];A.role!=="admin"&&fe.push({field:"targetId",op:"in",value:[A.id,"all","multiple"]}),me=yl("messages",fe,K=>{c(K),Ls.set("cache_messages",K)},{orderBy:{field:"createdAt",direction:"desc"},limit:100})}const re=G1("payments",fe=>v(fe)),ce=Ir("reset_requests",fe=>p(fe)),he=Ir("slider_images",fe=>{h(fe),Ls.set("cache_slider",fe)}),Oe=hO(fe=>T(fe)),Ue=G1("manual_dailies",fe=>E(fe),{sortByDate:!0,limit:100}),st=Ir("settings",fe=>{var we;const K=fe.find(pe=>pe.id==="slider_config");L(K||{isEnabled:!0});const ie=fe.find(pe=>pe.id==="counters");ie&&H(ie);const J=fe.find(pe=>pe.id==="points_config");J&&z(pe=>({pointsPerCurrency:J.pointsPerCurrency??1,currencyPerPoint:J.currencyPerPoint??.1,isPointsEnabled:J.isPointsEnabled??!0}));const le=fe.find(pe=>pe.id==="app_config");if(le){const pe={appName:le.appName||"GOO NOW",appVersion:le.appVersion||`VERSION ${Gm}`,customFont:le.customFont,games:le.games||[],isGamesEnabled:le.isGamesEnabled};j(pe),Ui.set("app_config_cache",pe)}const ee=fe.find(pe=>pe.id==="app_update");if(ee){const pe=ee;I(pe);const ye=Gm,Ae=`
  :

  : ${ye}
  : ${pe.version}

  : ${pe.isActive?"":""}
  : ${pe.forceUpdate?"":""}

  : ${((we=pe.target_roles)==null?void 0:we.join(", "))||""}
  : ${(A==null?void 0:A.role)||" "}
                `.trim();if(console.log("[UPDATE CHECK]",Ae),!Pn.isAndroid()){console.log("[UPDATE CHECK]  Not Android (Web/iOS). Skipping update check.");return}if(pe.isActive&&pe.version!==ye){if(pe.target_roles&&Array.isArray(pe.target_roles)&&pe.target_roles.length>0){const Me=A==null?void 0:A.role;if(!Me||!pe.target_roles.includes(Me)){console.log("[UPDATE CHECK]  User role not in target roles. Skipping update.");return}}const xe=pe.version.replace(/[^0-9.]/g,""),Pe=ye.replace(/[^0-9.]/g,""),gt=xe.split(".").map(Number),Ee=Pe.split(".").map(Number);let Be=!1;const ht=Math.max(gt.length,Ee.length);for(let Me=0;Me<ht;Me++){const Ze=gt[Me]||0,at=Ee[Me]||0;if(Ze>at){Be=!0;break}if(Ze<at){Be=!1;break}}if(Be){const Me=localStorage.getItem("skipped_update_version");pe.forceUpdate||Me!==pe.version?(console.log("[UPDATE CHECK]  New version found. Showing update screen."),F(!0)):(console.log("[UPDATE CHECK]  User skipped this version."),F(!1))}else console.log("[UPDATE CHECK]  App is up to date."),F(!1)}else F(!1)}});return()=>{Z(),te(),me(),re(),ce(),he(),st(),Oe(),Ue()}},[A==null?void 0:A.id,A==null?void 0:A.role,A==null?void 0:A.status,P.appVersion]),w.useEffect(()=>{A&&u0(A.role,A.id)},[A==null?void 0:A.id]),w.useEffect(()=>{const Z=setTimeout(()=>{M&&(console.warn("Loading timeout reached."),ne(!1))},3e4);return()=>clearTimeout(Z)},[M]);const Y=w.useRef(new Map);return{users:e,orders:r,messages:o,payments:b,sliderImages:u,auditLogs:_,manualDailies:k,passwordResetRequests:m,sliderConfig:S,pointsConfig:G,appConfig:P,updateConfig:O,showUpdate:R,setShowUpdate:F,globalCounters:$,isLoading:M,setIsLoading:ne,isOrdersLoaded:X,currentUser:A,setCurrentUser:V,appTheme:Q,setAppTheme:ae,setOrders:i,setUsers:t,setMessages:c,setPayments:v,setAuditLogs:T,setManualDailies:E,registerOptimisticUpdate:(Z,te,me)=>{Y.current.set(Z,{updates:te,timestamp:Date.now(),fallbackOrder:me}),setTimeout(()=>{Y.current.has(Z)&&Y.current.delete(Z)},5e3)},pendingWrites:Y}},Ute=({users:n,orders:e,messages:t,payments:r=[],manualDailies:i=[],currentUser:o,showNotify:c})=>{const u=k=>{let E="",S=!1;for(;!S;)E="ID:"+Math.floor(1e7+Math.random()*9e7).toString(),k.some($=>$.id===E)||(S=!0);return E},h=(k,E,S,L,$,H)=>{if(!o)return;const G={id:`LOG-${Date.now()}-${Math.floor(Math.random()*1e3)}`,actorId:o.id,actorName:o.name,actionType:k,target:E,targetId:$,collection:L,details:S,previousData:H,createdAt:new Date};dO(G)};return{logAction:h,handleUndo:async k=>{try{return await mO(k),await uO(k.id,{isUndone:!0}),c("    ","success"),!0}catch(E){return c(` : ${E.message}`,"error"),!1}},handleDriverPayment:async k=>{const E=n.find(U=>U.id===k);if(!E)return;const S=e.filter(U=>String(U.driverId)===String(k)&&U.status===ue.Delivered&&!U.reconciled),L=i.filter(U=>String(U.driverId)===String(k)&&!U.reconciled),$=U=>Math.round((U+Number.EPSILON)*100)/100,H=U=>typeof U=="number"?U:typeof U=="string"&&parseFloat(U)||0,G=S.reduce((U,A)=>U+H(A.deliveryFee),0);let z=0;const P=H(E.commissionRate),j=L.reduce((U,A)=>U+(A.amount||0),0);E.commissionType==="fixed"?z=S.length*P:z=G*(P/100),z+=j;const O=$(z),I=$(G);let R=new Date;const F=[...S].sort((U,A)=>{const V=U.deliveredAt?new Date(U.deliveredAt).getTime():0;return(A.deliveredAt?new Date(A.deliveredAt).getTime():0)-V});if(F.length>0&&F[0].deliveredAt){const U=new Date(F[0].deliveredAt),A=new Date,V=A.getDate()!==U.getDate()||A.getMonth()!==U.getMonth(),Q=A.getHours()<6;V&&Q&&(R=new Date(U.getFullYear(),U.getMonth(),U.getDate(),23,59,59))}const M=`PAY-${Date.now()}`,ne={id:M,driverId:k,amount:O,totalCollected:I,ordersCount:S.length,createdAt:R,reconciledOrderIds:S.map(U=>U.id),reconciledManualDailyIds:L.map(U=>U.id)};try{const U=S.map(V=>({...V,reconciled:!0})),A=L.map(V=>({...V,reconciled:!0}));U.length>0&&await gi("orders",U),A.length>0&&await W1("manual_dailies",A),await Hj("payments",M,ne),h("financial"," ",`    ${E.name}. : ${O} . (: ${S.length}, : ${L.length}).`),c(`  ${S.length}   ${L.length}     `,"success"),Kt("driver",{title:"  ",body:`   .     ${S.length}   ${L.length} .`,targetId:k,url:"/?target=wallet"})}catch(U){console.error("Payment Error",U),c("   ","error")}},handleSignUp:async k=>{if(n.find($=>$.phone===k.phone))return{success:!1,message:"   ."};const S=u(n),L={...k,id:S,status:"pending",createdAt:new Date,pointsBalance:0};L.role==="driver"&&(L.commissionRate=25,L.commissionType="percentage",L.dailyLogMode="always_open");try{await xt("users",S,L);const $=`LOG-${Date.now()}`;xt("audit_logs",$,{id:$,actorId:S,actorName:L.name,actionType:"create",target:" ",details:`  : ${L.name} (${L.role})`,createdAt:new Date});const H=L.role==="driver"?"":L.role==="merchant"?"":"",G={title:"  ",body:`   : ${L.name} (${H}).  .`,url:"/?target=users"};return await Kt("admin",G),{success:!0,message:"   "}}catch{return{success:!1,message:"    "}}},handleHideMessage:async(k,E,S)=>{const L=[...E,k];if(S(L),localStorage.setItem("deleted_msgs",JSON.stringify(L)),o){const $=t.find(H=>H.id===k);if($){const H=$.deletedBy||[];if(!H.includes(o.id)){const G=[...H,o.id];await xt("messages",k,{deletedBy:G})}}}c("  ","success",!0)},handleClearAuditLogs:async()=>{try{await fO(),h("delete","","      RTDB  "),c("    ","success")}catch(k){console.error("Failed to clear logs:",k),c("   ","error")}},generateNextUserId:u,deletePayment:async k=>{const E=r==null?void 0:r.find(S=>S.id===k);if(E&&E.reconciledOrderIds&&E.reconciledOrderIds.length>0){const S=E.reconciledOrderIds.map(L=>({id:L,reconciled:!1}));try{await gi("orders",S),console.log(`Un-reconciled ${S.length} orders for payment ${k}`)}catch(L){console.error("Failed to un-reconcile orders:",L),c("       ","error")}}if(E&&E.reconciledManualDailyIds&&E.reconciledManualDailyIds.length>0){const S=E.reconciledManualDailyIds.map(L=>({id:L,reconciled:!1}));try{await W1("manual_dailies",S),console.log(`Un-reconciled ${S.length} dailies for payment ${k}`)}catch(L){console.error("Failed to un-reconcile dailies:",L)}}Gj("payments",k),h("financial","",`     ${k}`),c("       ","success")}}},Bte=()=>{const[n,e]=w.useState(navigator.onLine),[t,r]=w.useState(!1),[i,o]=w.useState(null),[c,u]=w.useState(()=>{try{const K=localStorage.getItem("deleted_msgs");return K?JSON.parse(K):[]}catch{return[]}}),h=(K,ie="info",J=!1)=>{o({message:K,type:ie,id:Date.now()}),J||(Pn.showNotification("",K),Pn.playSound())},{users:m,orders:p,messages:b,payments:v,sliderImages:_,auditLogs:T,passwordResetRequests:k,sliderConfig:E,pointsConfig:S,appConfig:L,updateConfig:$,showUpdate:H,setShowUpdate:G,isLoading:z,isOrdersLoaded:P,currentUser:j,setCurrentUser:O,appTheme:I,setAppTheme:R,setOrders:F,setMessages:M,setPayments:ne,setAuditLogs:U,setManualDailies:A,registerOptimisticUpdate:V,manualDailies:Q}=Fte(h),ae=()=>{F([]),M([]),ne([]),U([]),A([]),h("    ","success")},{logAction:X,handleUndo:B,handleDriverPayment:Y,handleSignUp:ge,handleHideMessage:Z,handleClearAuditLogs:te,generateNextUserId:me,deletePayment:re}=Ute({users:m,orders:p,messages:b,payments:v,manualDailies:Q,currentUser:j,showNotify:h});w.useEffect(()=>{window.handleDeepLink=K=>{try{const ie=new URL(K,window.location.origin),J=new URLSearchParams(ie.search),le=J.get("target"),ee=J.get("id");le&&window.dispatchEvent(new CustomEvent("app-navigation",{detail:{target:le,id:ee}}))}catch(ie){console.error(ie)}}},[]),w.useEffect(()=>{const K=()=>e(navigator.onLine);return window.addEventListener("online",K),window.addEventListener("offline",K),()=>{window.removeEventListener("online",K),window.removeEventListener("offline",K)}},[]),w.useEffect(()=>{const K=()=>{const ie=document.getElementById("keep-alive-audio");ie&&ie.play().catch(()=>{console.log("Audio keep-alive waiting for interaction")})};j&&(K(),window.addEventListener("click",K,{once:!0}))},[j]),w.useEffect(()=>{const ie=Date.now();return z?setTimeout(()=>{Pn.hideSplashScreen()},4e3):(()=>{const le=Date.now()-ie;if(le>=4e3)console.log("[SplashStrategy] 4 seconds elapsed, hiding splash."),Pn.hideSplashScreen();else{const ee=4e3-le;console.log(`[SplashStrategy] Waiting ${ee}ms more before hiding.`),setTimeout(()=>{Pn.hideSplashScreen()},ee)}})(),()=>{}},[z]);const[ce,he]=w.useState(!1);w.useEffect(()=>{if(j)if(Pn.isAndroid())u0(j.role,j.id,j.status);else{let K=function(){const ie=j.role==="customer"?"user":j.role;let J=`${ie}s_v2`;ie==="admin"&&(J="admin_v2"),K1(J),j.id&&(K1(`${ie}_${j.id}_v2`),oO(j.id))};if(j.status==="suspended")return;window.Notification&&Notification.permission==="default"?localStorage.getItem("notification_dismissed")||he(!0):window.Notification&&Notification.permission==="granted"&&K()}},[j]);const Oe=()=>{Notification.requestPermission().then(K=>{he(!1),K==="granted"&&(h("   ","success"),window.location.reload())})},Ue=()=>{he(!1),localStorage.setItem("notification_dismissed","true")};if(!n)return s.jsx(Ote,{});if(!j)return t?s.jsx(Rte,{onSignUp:ge,onBackToLogin:()=>r(!1)}):s.jsxs(s.Fragment,{children:[s.jsx(kte,{appConfig:L,onPasswordLogin:async(K,ie)=>{let J=m.find(le=>(le.phone===K||le.id===K)&&le.password===ie);if(!J){const le=await Cg(K);if(le.success&&le.data){const ee=le.data;if(ee.password===ie)J=ee;else return{success:!1,message:"   "}}else if(le.error==="network_error")return{success:!1,message:"   .    ."}}if(!J&&K==="5"&&ie==="5"&&(J={id:"5",name:" ",role:"admin",phone:"5",password:"5",status:"active",createdAt:new Date,specialBadge:"verified",specialFrame:"gold"},xt("users","5",J)),J){if(J.status==="blocked")return{success:!1,message:"      .     ."};if(J.status==="pending")return{success:!1,message:"      .     ."};const le=kr(J);O(le),localStorage.setItem("currentUser",fb(le)),Pn.loginSuccess(le);const ee=`LOGIN-${Date.now()}`;return xt("audit_logs",ee,{id:ee,actorId:J.id,actorName:J.name,actionType:"login",target:"",details:`    ${J.name} (${J.role})`,createdAt:new Date}),{success:!0,message:""}}return{success:!1,message:"    (   )"}},onGoToSignUp:()=>r(!0),onPasswordResetRequest:async K=>(await xt("reset_requests",K,{phone:K,requestedAt:new Date}),await Kt("admin",{title:"   ",body:`       ${K}`,url:"/?target=notifications"}),await Kt("supervisor",{title:"   ",body:`       ${K}`,url:"/?target=notifications"}),{success:!0,message:"  "})}),H&&$&&s.jsx(N4,{config:$,onDismiss:()=>{G(!1)}})]});const st=L==null?void 0:L.isMaintenanceMode,fe=(j==null?void 0:j.role)==="admin"||(j==null?void 0:j.role)==="supervisor";return st&&!fe&&j?s.jsx(Lte,{message:L==null?void 0:L.maintenanceMessage,onLogout:()=>{Fc(j.id,j.role),O(null),localStorage.removeItem("currentUser")}}):s.jsxs("div",{className:"h-full w-full hardware-accelerated relative",children:[z&&j&&s.jsx("div",{className:"absolute top-4 left-4 z-50 pointer-events-none fade-in",children:s.jsxs("div",{className:"bg-black/80 backdrop-blur-md text-white text-xs px-3 py-1.5 rounded-full flex items-center gap-2 shadow-lg border border-white/10",children:[s.jsx("div",{className:"w-3 h-3 border-2 border-red-500 border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:" ..."})]})}),i&&s.jsx(Dte,{...i,onClose:()=>o(null)},i.id),ce&&s.jsx(Pte,{onEnable:Oe,onDismiss:Ue}),H&&$&&s.jsx(N4,{config:$,onDismiss:()=>{G(!1)}}),j.role==="admin"&&s.jsx(Fee,{logAction:X,user:j,users:m,orders:p,messages:b,payments:v,manualDailies:Q,passwordResetRequests:k,resolvePasswordResetRequest:K=>{rr("reset_requests",K),X("update"," ",`       ${K}`)},updateUser:(K,ie)=>{const J=m.find(ee=>ee.id===K);xt("users",K,ie);const le=(J==null?void 0:J.name)||K;ie.status==="blocked"?X("update","",`   : ${le}`,"users",K,J):ie.status==="active"&&(J==null?void 0:J.status)==="blocked"?X("update","",`    : ${le}`,"users",K,J):X("update","",`   : ${le}`,"users",K,J)},deleteUser:K=>{const ie=m.find(le=>le.id===K),J=(ie==null?void 0:ie.name)||K;rr("users",K),X("delete","",`  : ${J}`,"users",K,ie)},deleteOrder:K=>{const ie=p.find(J=>J.id===K);rr("orders",K),X("delete","",`    ${K}`,"orders",K,ie)},updateOrderStatus:(K,ie)=>{const J=p.find(ee=>ee.id===K);V(K,{status:ie},J),F(ee=>ee.map(we=>{if(we.id===K){const pe={...we,status:ie};return ie===ue.Delivered&&(pe.deliveredAt=new Date),ie===ue.Pending&&(pe.driverId=void 0,pe.deliveryFee=void 0,pe.driverName=void 0,pe.driverPhone=void 0,pe.driverImage=void 0),pe}return we}));const le={status:ie};ie===ue.Delivered&&(le.deliveredAt=new Date),ie===ue.Pending&&(le.driverId=null,le.deliveryFee=null,le.driverName=null,le.driverPhone=null,le.driverImage=null),xt("orders",K,le).catch(ee=>{console.error("Status update failed:",ee),h("      ","error")}),J&&J.driverId&&ie!==ue.Pending&&Kt("driver",{title:" ",body:` ${K}  ${ie}`,targetId:J.driverId,url:`/?target=order&id=${K}`})},editOrder:(K,ie)=>{const J=p.find(ee=>ee.id===K);if(!J)return;F(ee=>ee.map(we=>we.id===K?{...we,...ie,status:ie.status||we.status}:we));const le={...ie};xt("orders",K,le).catch(ee=>{console.error("Edit order failed:",ee),h("      ","error")}),X("update","",`     ${K}`,"orders",K,J),ie.driverId&&ie.driverId!==J.driverId&&(ie.deliveryFee!==void 0?ie.deliveryFee:J.deliveryFee,Kt("driver",{title:"   ",body:`   ${K} .   .`,targetId:ie.driverId,url:`/?target=order&id=${K}`}))},assignDriverAndSetStatus:(K,ie,J,le)=>{const ee=m.find(xe=>xe.id===ie),we=(ee==null?void 0:ee.name)||ie,pe=ee==null?void 0:ee.phone,ye=ee==null?void 0:ee.storeImage,Ae={driverId:ie,deliveryFee:J,status:le,driverName:we};pe&&(Ae.driverPhone=pe),ye&&(Ae.driverImage=ye),V(K,Ae),F(xe=>xe.map(Pe=>Pe.id===K?{...Pe,...Ae}:Pe)),xt("orders",K,Ae).catch(xe=>h("  ","error")),X("update","",`   ${we}  ${K}  ${J}`,"orders",K,p.find(xe=>xe.id===K)),Kt("driver",{title:"   ",body:`   ${K}   ${J} .`,targetId:ie,url:`/?target=order&id=${K}`})},adminAddOrder:async K=>{var ee;const ie=Array.isArray(K)?K:[K],J=[],le="ORD-";try{const we=ie.length,pe=ie.filter(xe=>!xe.id).length;let ye=[];pe>0&&(ye=await Q1(le,pe));let Ae=0;ie.forEach((xe,Pe)=>{const gt=xe.id||ye[Ae++];J.push({...xe,id:gt,status:ue.Pending,createdAt:new Date,type:"delivery_request"})}),J.forEach(xe=>{Kt("driver",{title:"  ",body:`    #${xe.id}   `,url:`/?target=order&id=${xe.id}`})})}catch(we){console.error("Batch add failed",we),h("  ","error")}J.length>0&&(F(we=>[...we,...J]),await gi("orders",J),X("create","",`  ${J.length}   ( )`,"orders",(ee=J[0])==null?void 0:ee.id))},adminAddUser:async K=>{const ie=me(m);await xt("users",ie,{...K,id:ie,status:"active",createdAt:new Date}),X("create","",`   : ${K.name} (${K.role}) ID: ${ie}`,"users",ie)},onLogout:()=>{Fc(j.id,j.role),O(null),localStorage.removeItem("currentUser")},sendMessage:K=>{let ie=b.reduce((le,ee)=>{const we=parseInt(ee.id);return isNaN(we)?le:Math.max(le,we)},0);const J=K.targetIds.map((le,ee)=>(ie++,{...K,id:String(ie),targetId:le,createdAt:new Date,readBy:[]}));gi("messages",J),K.targetIds.forEach((le,ee)=>{setTimeout(()=>{const we=le!=="all"&&le!=="multiple";Kt(K.targetRole,{title:"  ",body:K.text.length>50?K.text.substring(0,50)+"...":K.text,targetId:we?le:void 0,url:"/?target=messages"})},ee*50)}),X("create","",`    ${K.targetIds.length}    ${K.targetRole}`)},deleteMessage:K=>rr("messages",K),handleDriverPayment:Y,sliderImages:_,sliderConfig:E,onAddSliderImage:K=>{xt("slider_images",K.id,K),X("create","","    ")},onDeleteSliderImage:K=>rr("slider_images",K),onUpdateSliderImage:(K,ie)=>xt("slider_images",K,ie),onToggleSlider:K=>xt("settings","slider_config",{id:"slider_config",isEnabled:K}),onBulkUpdate:async K=>gi("orders",K),auditLogs:T,onClearLogs:te,onUndo:B,onDeletePayment:re,promoCodes:[],pointsConfig:S,onUpdatePointsConfig:K=>{xt("settings","points_config",{id:"points_config",...K}),X("update","","    ")},onAddPromo:()=>{},onDeletePromo:()=>{},currentTheme:I,onUpdateTheme:(K,ie)=>{R(J=>({...J,[K]:ie})),Ui.set("app_theme",{...I,[K]:ie})},showNotification:h,appConfig:L,onUpdateAppConfig:K=>{xt("settings","app_config",{id:"app_config",...K}),X("update"," ","    ")},onFactoryReset:ae}),j.role==="supervisor"&&s.jsx(Cte,{user:j,users:m,orders:p,payments:v,manualDailies:Q,logAction:X,passwordResetRequests:k,resolvePasswordResetRequest:K=>{rr("reset_requests",K),X("update"," ",`       ${K}`)},updateUser:(K,ie)=>{var le,ee;xt("users",K,ie);const J=((le=m.find(we=>we.id===K))==null?void 0:le.name)||K;ie.status==="blocked"?X("update","",`   : ${J}`):ie.status==="active"&&((ee=m.find(we=>we.id===K))==null?void 0:ee.status)==="blocked"?X("update","",`    : ${J}`):X("update","",`    : ${J}`)},deleteUser:K=>{var J;const ie=((J=m.find(le=>le.id===K))==null?void 0:J.name)||K;rr("users",K),X("delete","",`   : ${ie}`)},deleteOrder:K=>{rr("orders",K),X("delete","",`     ${K}`)},updateOrderStatus:(K,ie)=>{V(K,{status:ie}),F(ee=>ee.map(we=>{if(we.id===K){const pe={...we,status:ie};return ie===ue.Delivered&&(pe.deliveredAt=new Date),ie===ue.Pending&&(pe.driverId=void 0,pe.deliveryFee=void 0,pe.driverName=void 0,pe.driverPhone=void 0,pe.driverImage=void 0),pe}return we}));const J=p.find(ee=>ee.id===K),le={status:ie};ie===ue.Delivered&&(le.deliveredAt=new Date),ie===ue.Pending&&(le.driverId=null,le.deliveryFee=null,le.driverName=null,le.driverPhone=null,le.driverImage=null),xt("orders",K,le).catch(ee=>{console.error("Status update failed:",ee),h("  ","error")}),J&&J.driverId&&ie!==ue.Pending&&Kt("driver",{title:" ",body:` ${K}  ${ie}`,targetId:J.driverId,url:`/?target=order&id=${K}`})},editOrder:(K,ie)=>{const J={...ie};if(J.driverId){const le=m.find(ee=>ee.id===J.driverId);le&&(J.driverName=le.name,J.driverPhone=le.phone,J.driverImage=le.storeImage)}if(J.merchantId&&J.merchantId!=="delinow"){const le=m.find(ee=>ee.id===J.merchantId);le&&(J.merchantName=le.name,J.merchantPhone=le.phone,J.merchantImage=le.storeImage)}xt("orders",K,J),X("update","",`      ${K}`)},assignDriverAndSetStatus:(K,ie,J,le)=>{const ee=m.find(xe=>xe.id===ie),we=(ee==null?void 0:ee.name)||ie,pe=ee==null?void 0:ee.phone,ye=ee==null?void 0:ee.storeImage,Ae={driverId:ie,deliveryFee:J,status:le,driverName:we};pe&&(Ae.driverPhone=pe),ye&&(Ae.driverImage=ye),V(K,Ae),F(xe=>xe.map(Pe=>Pe.id===K?{...Pe,...Ae}:Pe)),xt("orders",K,Ae).catch(xe=>h("  ","error")),X("update","",`    ${we}  ${K}  ${J}`),Kt("driver",{title:"   ",body:`   ${K}   ${J} .`,targetId:ie,url:`/?target=order&id=${K}`})},adminAddOrder:async K=>{const ie=Array.isArray(K)?K:[K],J=[],le="ORD-";try{const ee=ie.length,we=await Q1(le,ee);ie.forEach((pe,ye)=>{const Ae=we[ye];J.push({...pe,id:Ae,status:ue.Pending,createdAt:new Date,type:"delivery_request"})})}catch(ee){console.error("Supervisor Batched Add Failed",ee),h("      ","error")}J.length>0&&(F(ee=>[...ee,...J]),await gi("orders",J),X("create","",`   ${J.length}  `),J.forEach(ee=>{Kt("driver",{title:"  ",body:`    #${ee.id}   `,url:`/?target=order&id=${ee.id}`})}))},adminAddUser:async K=>{const ie=me(m);await xt("users",ie,{...K,id:ie,status:"active",createdAt:new Date}),X("create","",`    : ${K.name} (${K.role}) ID: ${ie}`)},onLogout:()=>{Fc(j.id,j.role),O(null),localStorage.removeItem("currentUser")},onBulkUpdate:async K=>gi("orders",K),auditLogs:T,promoCodes:[],pointsConfig:S,onUpdatePointsConfig:K=>{xt("settings","points_config",{id:"points_config",...K}),X("update","","     ")},onAddPromo:()=>{},onDeletePromo:()=>{},showNotification:h,handleDriverPayment:Y,sliderImages:_,sliderConfig:E,onAddSliderImage:K=>{xt("slider_images",K.id,K),X("create","","     ")},onDeleteSliderImage:K=>rr("slider_images",K),onUpdateSliderImage:(K,ie)=>xt("slider_images",K,ie),onToggleSlider:K=>xt("settings","slider_config",{id:"slider_config",isEnabled:K}),messages:b,sendMessage:K=>{let ie=b.reduce((le,ee)=>{const we=parseInt(ee.id);return isNaN(we)?le:Math.max(le,we)},0);const J=K.targetIds.map((le,ee)=>(ie++,{...K,id:String(ie),targetId:le,createdAt:new Date,readBy:[]}));gi("messages",J),K.targetIds.forEach((le,ee)=>{setTimeout(()=>{const we=le!=="all"&&le!=="multiple";Kt(K.targetRole,{title:"   ",body:K.text.length>50?K.text.substring(0,50)+"...":K.text,targetId:we?le:void 0,url:"/?target=messages"})},ee*50)}),X("create","",`     ${K.targetIds.length} `)},deleteMessage:K=>rr("messages",K),appConfig:L,getNewId:()=>jm("ORD-")}),j.role==="driver"&&s.jsx(ote,{driver:j,users:m,orders:p,messages:b,isLoading:!P,onUpdateOrderStatus:(K,ie)=>{const J=p.find(ee=>ee.id===K);V(K,{status:ie},J),F(ee=>ee.map(we=>{if(we.id===K){const pe={...we,status:ie};return ie===ue.Delivered&&(pe.deliveredAt=new Date),ie===ue.Pending&&(pe.driverId=void 0,pe.deliveryFee=void 0,pe.driverName=void 0,pe.driverPhone=void 0,pe.driverImage=void 0),pe}return we}));const le={status:ie};ie===ue.Delivered&&(le.deliveredAt=new Date),ie===ue.Pending&&(le.driverId=null,le.deliveryFee=null,le.driverName=null,le.driverPhone=null,le.driverImage=null),xt("orders",K,le).catch(ee=>{console.error("Status update failed:",ee),h("  .   .","error")})},onAcceptOrder:(K,ie,J)=>{var we,pe,ye,Ae,xe,Pe,gt;const le=p.find(Ee=>Ee.id===K);if(!le)return;V(K,{status:ue.InTransit,driverId:ie,driverName:((we=m.find(Ee=>Ee.id===ie))==null?void 0:we.name)||"",driverPhone:(pe=m.find(Ee=>Ee.id===ie))==null?void 0:pe.phone,driverImage:(ye=m.find(Ee=>Ee.id===ie))==null?void 0:ye.storeImage},le),F(Ee=>Ee.map(Be=>{if(Be.id===K){const ht=m.find(Me=>Me.id===ie);return{...Be,driverId:ie,deliveryFee:J,status:ue.InTransit,driverName:(ht==null?void 0:ht.name)||"",driverPhone:ht==null?void 0:ht.phone,driverImage:ht==null?void 0:ht.storeImage}}return Be}));const ee={driverId:ie,deliveryFee:J,status:ue.InTransit,driverName:((Ae=m.find(Ee=>Ee.id===ie))==null?void 0:Ae.name)||"",driverPhone:(xe=m.find(Ee=>Ee.id===ie))==null?void 0:xe.phone,driverImage:(Pe=m.find(Ee=>Ee.id===ie))==null?void 0:Pe.storeImage};if(xt("orders",K,ee).then(()=>{console.log(`Order ${K} accepted successfully.`)}).catch(Ee=>{console.error("Failed to accept order:",Ee),h("  .    .","error")}),(le==null?void 0:le.type)==="shopping_order"&&((gt=le.customer)!=null&&gt.phone)){const Ee=m.find(Be=>Be.phone===le.customer.phone&&Be.role==="customer");Ee&&Kt("customer",{title:"  ! ",body:`  ${j.name}      `,targetId:Ee.id,url:"/?target=orders"})}},onUpdateUser:(K,ie)=>xt("users",K,ie),onLogout:()=>{Fc(j.id,j.role),O(null),localStorage.removeItem("currentUser")},showNotification:h,seenMessageIds:[],markMessageAsSeen:()=>{},hideMessage:K=>Z(K,c,u),deletedMessageIds:c,appTheme:I,appConfig:L}),j.role==="merchant"&&s.jsx(Kee,{merchant:j,users:m,orders:p,messages:b,addOrder:async(K,ie)=>{try{const J=ie||await jm("ORD-"),le={...K,id:J,merchantId:j.id,merchantName:j.name,status:ue.Pending,createdAt:new Date,type:"delivery_request",merchantPhone:j.phone,merchantImage:j.storeImage};F(ee=>[le,...ee]),xt("orders",J,le).then(()=>{Kt("admin",{title:"   ",body:` ${j.name}    #${J}`,url:"/?target=orders"}),Kt("supervisor",{title:"   ",body:` ${j.name}    #${J}`,url:"/?target=orders"}),Kt("driver",{title:"  ",body:`:   #${J}  `,url:`/?target=order&id=${J}`})}).catch(ee=>{console.error("Async save failed",ee),h(":          ","error")})}catch(J){throw console.error("Merchant addOrder error:",J),h("   .    .","error"),J}},onLogout:()=>{Fc(j.id,j.role),O(null),localStorage.removeItem("currentUser")},seenMessageIds:[],markMessageAsSeen:K=>{},hideMessage:K=>{},deletedMessageIds:[],appTheme:I,onUpdateUser:(K,ie)=>xt("users",K,ie),onUpdateOrder:(K,ie)=>xt("orders",K,ie),getNewId:()=>jm("ORD-"),appConfig:L}),j.role==="customer"&&s.jsx(Ite,{user:j,merchants:m.filter(K=>K.role==="merchant"),orders:p,messages:b,onPlaceOrder:async K=>{const ie=K.type==="shopping_order",J=await jm(ie?"S-":"ORD-");await xt("orders",J,{...K,id:J}),await xt("orders",J,{...K,id:J}),Kt("admin",{title:ie?"   ":"  ",body:`  #${J}  ${K.customer.name}`,url:"/?target=orders"}),Kt("supervisor",{title:ie?"   ":"  ",body:`  #${J}  ${K.customer.name}`,url:"/?target=orders"}),Kt("driver",{title:"  ",body:`   #${J}  `,url:`/?target=order&id=${J}`}),!ie&&K.merchantId&&K.merchantId},onLogout:()=>{Fc(j.id,j.role),O(null),localStorage.removeItem("currentUser")},onDeleteOrder:K=>rr("orders",K),markMessageAsSeen:()=>{},hideMessage:()=>{},seenMessageIds:[],deletedMessageIds:[],onUpdateUser:(K,ie)=>xt("users",K,ie),appTheme:I,promoCodes:[],pointsConfig:S,sliderImages:_,sliderConfig:E,adminUser:m.find(K=>K.role==="admin"),appConfig:L})]})},BO=()=>Pn.handleBackPress();window.handleAndroidBack=BO;window.onBackPressed=BO;document.addEventListener("click",n=>{const e=n.target;(e.closest("button")||e.closest("a")||e.closest(".clickable"))&&navigator.vibrate&&navigator.vibrate(5)},{passive:!0});const zO=document.getElementById("root");if(!zO)throw new Error("Could not find root element to mount to");"serviceWorker"in navigator&&window.addEventListener("load",()=>{if(window.location.protocol==="blob:"||window.location.protocol==="file:")return;navigator.serviceWorker.register("/firebase-messaging-sw.js").then(e=>{const r=(()=>{try{const i=localStorage.getItem("firebase_config");if(i)return JSON.parse(i)}catch{}return UO})();e.active?e.active.postMessage({type:"FIREBASE_CONFIG",config:r}):e.installing&&e.installing.addEventListener("statechange",i=>{i.target.state==="activated"&&e.active&&e.active.postMessage({type:"FIREBASE_CONFIG",config:r})})}).catch(e=>console.log("[SW] Error:",e));let n=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{n||(n=!0,window.location.reload())})});window.onerror=function(n,e,t,r,i){const o=document.createElement("div");return o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.backgroundColor="#990000",o.style.color="#ffffff",o.style.zIndex="999999",o.style.padding="20px",o.style.overflow="scroll",o.style.fontFamily="monospace",o.style.fontSize="14px",o.style.direction="ltr",o.style.textAlign="left",o.innerHTML=`
        <h2 style="border-bottom: 2px solid white; padding-bottom: 10px;"> APP CRASH </h2>
        <p><strong>Error:</strong> ${n}</p>
        <p><strong>Source:</strong> ${e}</p>
        <p><strong>Line:</strong> ${t}:${r}</p>
        <pre style="background: rgba(0,0,0,0.3); padding: 10px; white-space: pre-wrap;">${(i==null?void 0:i.stack)||"No stack trace"}</pre>
    `,document.body.appendChild(o),!1};window.addEventListener("unhandledrejection",function(n){const e=document.createElement("div");e.style.position="fixed",e.style.bottom="0",e.style.left="0",e.style.width="100%",e.style.height="50%",e.style.backgroundColor="#990000",e.style.color="#ffffff",e.style.zIndex="999999",e.style.padding="20px",e.style.borderTop="2px solid white",e.style.overflow="scroll",e.innerHTML=`
        <h3> UNHANDLED PROMISE </h3>
        <p>${n.reason}</p>
    `,document.body.appendChild(e)});const zte=TL.createRoot(zO);zte.render(s.jsx(Rn.StrictMode,{children:s.jsx(Bte,{})}));
